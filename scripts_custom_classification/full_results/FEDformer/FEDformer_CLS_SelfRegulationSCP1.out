Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 27.68442463874817
Epoch: 1, Steps: 17 | Train Loss: 0.738 Vali Loss: 0.929 Vali Acc: 0.580 Test Loss: 0.929 Test Acc: 0.580
Validation loss decreased (inf --> -0.580195).  Saving model ...
Epoch: 2 cost time: 24.518614053726196
Epoch: 2, Steps: 17 | Train Loss: 0.559 Vali Loss: 1.230 Vali Acc: 0.703 Test Loss: 1.230 Test Acc: 0.703
Validation loss decreased (-0.580195 --> -0.703059).  Saving model ...
Epoch: 3 cost time: 24.567599534988403
Epoch: 3, Steps: 17 | Train Loss: 0.499 Vali Loss: 1.948 Vali Acc: 0.655 Test Loss: 1.948 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.44078016281128
Epoch: 4, Steps: 17 | Train Loss: 0.793 Vali Loss: 2.832 Vali Acc: 0.584 Test Loss: 2.832 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 24.506566524505615
Epoch: 5, Steps: 17 | Train Loss: 1.123 Vali Loss: 2.676 Vali Acc: 0.659 Test Loss: 2.676 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 23.982076406478882
Epoch: 6, Steps: 17 | Train Loss: 0.683 Vali Loss: 4.563 Vali Acc: 0.648 Test Loss: 4.563 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 24.33327054977417
Epoch: 7, Steps: 17 | Train Loss: 1.009 Vali Loss: 5.012 Vali Acc: 0.573 Test Loss: 5.012 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 25.948321104049683
Epoch: 8, Steps: 17 | Train Loss: 2.093 Vali Loss: 5.361 Vali Acc: 0.611 Test Loss: 5.361 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 24.585618257522583
Epoch: 9, Steps: 17 | Train Loss: 2.786 Vali Loss: 10.500 Vali Acc: 0.597 Test Loss: 10.500 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 23.284486055374146
Epoch: 10, Steps: 17 | Train Loss: 0.293 Vali Loss: 8.619 Vali Acc: 0.655 Test Loss: 8.619 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 25.580815315246582
Epoch: 11, Steps: 17 | Train Loss: 0.813 Vali Loss: 12.242 Vali Acc: 0.631 Test Loss: 12.242 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 27.700693607330322
Epoch: 12, Steps: 17 | Train Loss: 0.542 Vali Loss: 7.958 Vali Acc: 0.631 Test Loss: 7.958 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7030716723549488
model parameter : 17729026
model size : 87.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 22.220207452774048
Epoch: 1, Steps: 17 | Train Loss: 0.754 Vali Loss: 1.036 Vali Acc: 0.573 Test Loss: 1.036 Test Acc: 0.573
Validation loss decreased (inf --> -0.573368).  Saving model ...
Epoch: 2 cost time: 16.474079132080078
Epoch: 2, Steps: 17 | Train Loss: 0.538 Vali Loss: 1.169 Vali Acc: 0.631 Test Loss: 1.169 Test Acc: 0.631
Validation loss decreased (-0.573368 --> -0.631388).  Saving model ...
Epoch: 3 cost time: 23.336571216583252
Epoch: 3, Steps: 17 | Train Loss: 0.406 Vali Loss: 1.516 Vali Acc: 0.638 Test Loss: 1.516 Test Acc: 0.638
Validation loss decreased (-0.631388 --> -0.638210).  Saving model ...
Epoch: 4 cost time: 23.621306896209717
Epoch: 4, Steps: 17 | Train Loss: 0.748 Vali Loss: 2.629 Vali Acc: 0.625 Test Loss: 2.629 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.51206135749817
Epoch: 5, Steps: 17 | Train Loss: 0.474 Vali Loss: 4.940 Vali Acc: 0.580 Test Loss: 4.940 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.714855909347534
Epoch: 6, Steps: 17 | Train Loss: 0.749 Vali Loss: 9.815 Vali Acc: 0.515 Test Loss: 9.815 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.34748411178589
Epoch: 7, Steps: 17 | Train Loss: 2.936 Vali Loss: 10.022 Vali Acc: 0.539 Test Loss: 10.022 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 24.471110582351685
Epoch: 8, Steps: 17 | Train Loss: 0.554 Vali Loss: 6.024 Vali Acc: 0.614 Test Loss: 6.024 Test Acc: 0.614
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.963167190551758
Epoch: 9, Steps: 17 | Train Loss: 1.313 Vali Loss: 7.655 Vali Acc: 0.604 Test Loss: 7.655 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 21.969669580459595
Epoch: 10, Steps: 17 | Train Loss: 0.910 Vali Loss: 6.225 Vali Acc: 0.628 Test Loss: 6.225 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 19.956292867660522
Epoch: 11, Steps: 17 | Train Loss: 0.987 Vali Loss: 7.234 Vali Acc: 0.676 Test Loss: 7.234 Test Acc: 0.676
Validation loss decreased (-0.638210 --> -0.675696).  Saving model ...
Epoch: 12 cost time: 24.860290050506592
Epoch: 12, Steps: 17 | Train Loss: 2.037 Vali Loss: 10.400 Vali Acc: 0.611 Test Loss: 10.400 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 22.932477474212646
Epoch: 13, Steps: 17 | Train Loss: 0.541 Vali Loss: 10.413 Vali Acc: 0.635 Test Loss: 10.413 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.658287048339844
Epoch: 14, Steps: 17 | Train Loss: 0.303 Vali Loss: 18.520 Vali Acc: 0.556 Test Loss: 18.520 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 21.441551446914673
Epoch: 15, Steps: 17 | Train Loss: 0.939 Vali Loss: 13.844 Vali Acc: 0.631 Test Loss: 13.844 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 24.641261339187622
Epoch: 16, Steps: 17 | Train Loss: 0.795 Vali Loss: 9.625 Vali Acc: 0.608 Test Loss: 9.625 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 25.328686475753784
Epoch: 17, Steps: 17 | Train Loss: 1.648 Vali Loss: 25.011 Vali Acc: 0.553 Test Loss: 25.011 Test Acc: 0.553
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 25.20997381210327
Epoch: 18, Steps: 17 | Train Loss: 1.811 Vali Loss: 12.136 Vali Acc: 0.628 Test Loss: 12.136 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 16.174787282943726
Epoch: 19, Steps: 17 | Train Loss: 1.136 Vali Loss: 17.190 Vali Acc: 0.584 Test Loss: 17.190 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 22.99215531349182
Epoch: 20, Steps: 17 | Train Loss: 0.565 Vali Loss: 15.392 Vali Acc: 0.659 Test Loss: 15.392 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 26.056700706481934
Epoch: 21, Steps: 17 | Train Loss: 0.695 Vali Loss: 17.816 Vali Acc: 0.628 Test Loss: 17.816 Test Acc: 0.628
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6757679180887372
model parameter : 17729026
model size : 87.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 19.13943648338318
Epoch: 1, Steps: 17 | Train Loss: 0.781 Vali Loss: 0.993 Vali Acc: 0.642 Test Loss: 0.993 Test Acc: 0.642
Validation loss decreased (inf --> -0.641628).  Saving model ...
Epoch: 2 cost time: 14.604156970977783
Epoch: 2, Steps: 17 | Train Loss: 0.930 Vali Loss: 1.538 Vali Acc: 0.621 Test Loss: 1.538 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.569437503814697
Epoch: 3, Steps: 17 | Train Loss: 1.021 Vali Loss: 2.744 Vali Acc: 0.601 Test Loss: 2.744 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.81241750717163
Epoch: 4, Steps: 17 | Train Loss: 1.806 Vali Loss: 4.129 Vali Acc: 0.556 Test Loss: 4.129 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.984938621520996
Epoch: 5, Steps: 17 | Train Loss: 1.122 Vali Loss: 3.821 Vali Acc: 0.608 Test Loss: 3.821 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.103010654449463
Epoch: 6, Steps: 17 | Train Loss: 0.825 Vali Loss: 6.886 Vali Acc: 0.580 Test Loss: 6.886 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 18.97995352745056
Epoch: 7, Steps: 17 | Train Loss: 1.378 Vali Loss: 4.028 Vali Acc: 0.604 Test Loss: 4.028 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 21.501468658447266
Epoch: 8, Steps: 17 | Train Loss: 0.881 Vali Loss: 6.624 Vali Acc: 0.584 Test Loss: 6.624 Test Acc: 0.584
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 19.20657229423523
Epoch: 9, Steps: 17 | Train Loss: 0.341 Vali Loss: 8.567 Vali Acc: 0.611 Test Loss: 8.567 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 20.114848136901855
Epoch: 10, Steps: 17 | Train Loss: 0.719 Vali Loss: 6.851 Vali Acc: 0.618 Test Loss: 6.851 Test Acc: 0.618
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 15.027177095413208
Epoch: 11, Steps: 17 | Train Loss: 0.771 Vali Loss: 7.041 Vali Acc: 0.652 Test Loss: 7.041 Test Acc: 0.652
Validation loss decreased (-0.641628 --> -0.651807).  Saving model ...
Epoch: 12 cost time: 17.282403469085693
Epoch: 12, Steps: 17 | Train Loss: 0.328 Vali Loss: 12.504 Vali Acc: 0.594 Test Loss: 12.504 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 19.978360414505005
Epoch: 13, Steps: 17 | Train Loss: 0.796 Vali Loss: 15.359 Vali Acc: 0.584 Test Loss: 15.359 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.11076331138611
Epoch: 14, Steps: 17 | Train Loss: 0.910 Vali Loss: 9.953 Vali Acc: 0.635 Test Loss: 9.953 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 20.740772247314453
Epoch: 15, Steps: 17 | Train Loss: 0.665 Vali Loss: 8.763 Vali Acc: 0.631 Test Loss: 8.763 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 19.52858066558838
Epoch: 16, Steps: 17 | Train Loss: 0.969 Vali Loss: 9.140 Vali Acc: 0.631 Test Loss: 9.140 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 20.176586866378784
Epoch: 17, Steps: 17 | Train Loss: 0.757 Vali Loss: 16.357 Vali Acc: 0.604 Test Loss: 16.357 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 20.508583545684814
Epoch: 18, Steps: 17 | Train Loss: 0.681 Vali Loss: 16.686 Vali Acc: 0.608 Test Loss: 16.686 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 23.45473289489746
Epoch: 19, Steps: 17 | Train Loss: 0.592 Vali Loss: 17.095 Vali Acc: 0.597 Test Loss: 17.095 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 19.150675296783447
Epoch: 20, Steps: 17 | Train Loss: 0.613 Vali Loss: 15.941 Vali Acc: 0.604 Test Loss: 15.941 Test Acc: 0.604
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 20.54192805290222
Epoch: 21, Steps: 17 | Train Loss: 1.853 Vali Loss: 19.087 Vali Acc: 0.608 Test Loss: 19.087 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6518771331058021
model parameter : 17729026
model size : 87.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 19.482996940612793
Epoch: 1, Steps: 17 | Train Loss: 0.702 Vali Loss: 1.020 Vali Acc: 0.549 Test Loss: 1.020 Test Acc: 0.549
Validation loss decreased (inf --> -0.549478).  Saving model ...
Epoch: 2 cost time: 17.756316900253296
Epoch: 2, Steps: 17 | Train Loss: 0.832 Vali Loss: 1.503 Vali Acc: 0.601 Test Loss: 1.503 Test Acc: 0.601
Validation loss decreased (-0.549478 --> -0.600668).  Saving model ...
Epoch: 3 cost time: 15.508632183074951
Epoch: 3, Steps: 17 | Train Loss: 0.909 Vali Loss: 2.343 Vali Acc: 0.614 Test Loss: 2.343 Test Acc: 0.614
Validation loss decreased (-0.600668 --> -0.614311).  Saving model ...
Epoch: 4 cost time: 14.22292947769165
Epoch: 4, Steps: 17 | Train Loss: 0.822 Vali Loss: 5.187 Vali Acc: 0.580 Test Loss: 5.187 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.43431305885315
Epoch: 5, Steps: 17 | Train Loss: 1.450 Vali Loss: 11.445 Vali Acc: 0.522 Test Loss: 11.445 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.40352511405945
Epoch: 6, Steps: 17 | Train Loss: 2.678 Vali Loss: 3.806 Vali Acc: 0.618 Test Loss: 3.806 Test Acc: 0.618
Validation loss decreased (-0.614311 --> -0.617709).  Saving model ...
Epoch: 7 cost time: 18.339199781417847
Epoch: 7, Steps: 17 | Train Loss: 1.369 Vali Loss: 5.322 Vali Acc: 0.577 Test Loss: 5.322 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.826518774032593
Epoch: 8, Steps: 17 | Train Loss: 2.047 Vali Loss: 19.804 Vali Acc: 0.515 Test Loss: 19.804 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.884532928466797
Epoch: 9, Steps: 17 | Train Loss: 1.175 Vali Loss: 9.267 Vali Acc: 0.590 Test Loss: 9.267 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 15.984204530715942
Epoch: 10, Steps: 17 | Train Loss: 2.674 Vali Loss: 9.767 Vali Acc: 0.567 Test Loss: 9.767 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 18.70728087425232
Epoch: 11, Steps: 17 | Train Loss: 1.614 Vali Loss: 14.118 Vali Acc: 0.577 Test Loss: 14.118 Test Acc: 0.577
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 17.92163395881653
Epoch: 12, Steps: 17 | Train Loss: 0.599 Vali Loss: 13.911 Vali Acc: 0.604 Test Loss: 13.911 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 18.15295696258545
Epoch: 13, Steps: 17 | Train Loss: 0.842 Vali Loss: 13.883 Vali Acc: 0.608 Test Loss: 13.883 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 13.695692300796509
Epoch: 14, Steps: 17 | Train Loss: 1.644 Vali Loss: 8.643 Vali Acc: 0.621 Test Loss: 8.643 Test Acc: 0.621
Validation loss decreased (-0.617709 --> -0.621074).  Saving model ...
Epoch: 15 cost time: 20.52823257446289
Epoch: 15, Steps: 17 | Train Loss: 3.030 Vali Loss: 18.134 Vali Acc: 0.587 Test Loss: 18.134 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 19.900944709777832
Epoch: 16, Steps: 17 | Train Loss: 1.173 Vali Loss: 11.843 Vali Acc: 0.625 Test Loss: 11.843 Test Acc: 0.625
Validation loss decreased (-0.621074 --> -0.624455).  Saving model ...
Epoch: 17 cost time: 19.035146236419678
Epoch: 17, Steps: 17 | Train Loss: 0.812 Vali Loss: 28.823 Vali Acc: 0.560 Test Loss: 28.823 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 17.908621072769165
Epoch: 18, Steps: 17 | Train Loss: 0.782 Vali Loss: 13.270 Vali Acc: 0.625 Test Loss: 13.270 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 16.870742559432983
Epoch: 19, Steps: 17 | Train Loss: 0.637 Vali Loss: 13.408 Vali Acc: 0.618 Test Loss: 13.408 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 18.6671404838562
Epoch: 20, Steps: 17 | Train Loss: 1.624 Vali Loss: 27.373 Vali Acc: 0.539 Test Loss: 27.373 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 19.97781229019165
Epoch: 21, Steps: 17 | Train Loss: 0.925 Vali Loss: 15.251 Vali Acc: 0.625 Test Loss: 15.251 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 19.86926031112671
Epoch: 22, Steps: 17 | Train Loss: 0.854 Vali Loss: 23.040 Vali Acc: 0.594 Test Loss: 23.040 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 16.533153533935547
Epoch: 23, Steps: 17 | Train Loss: 1.351 Vali Loss: 15.749 Vali Acc: 0.618 Test Loss: 15.749 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 16.48520040512085
Epoch: 24, Steps: 17 | Train Loss: 0.804 Vali Loss: 21.340 Vali Acc: 0.567 Test Loss: 21.340 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 21.06719732284546
Epoch: 25, Steps: 17 | Train Loss: 0.599 Vali Loss: 25.142 Vali Acc: 0.604 Test Loss: 25.142 Test Acc: 0.604
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 21.274032592773438
Epoch: 26, Steps: 17 | Train Loss: 0.785 Vali Loss: 16.943 Vali Acc: 0.625 Test Loss: 16.943 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 17729026
model size : 87.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 16.26690411567688
Epoch: 1, Steps: 17 | Train Loss: 0.790 Vali Loss: 1.008 Vali Acc: 0.556 Test Loss: 1.008 Test Acc: 0.556
Validation loss decreased (inf --> -0.556304).  Saving model ...
Epoch: 2 cost time: 14.585386753082275
Epoch: 2, Steps: 17 | Train Loss: 0.595 Vali Loss: 4.123 Vali Acc: 0.522 Test Loss: 4.123 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.4096040725708
Epoch: 3, Steps: 17 | Train Loss: 0.487 Vali Loss: 5.543 Vali Acc: 0.522 Test Loss: 5.543 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.68156623840332
Epoch: 4, Steps: 17 | Train Loss: 0.622 Vali Loss: 3.144 Vali Acc: 0.611 Test Loss: 3.144 Test Acc: 0.611
Validation loss decreased (-0.556304 --> -0.610890).  Saving model ...
Epoch: 5 cost time: 16.100477695465088
Epoch: 5, Steps: 17 | Train Loss: 0.275 Vali Loss: 3.538 Vali Acc: 0.584 Test Loss: 3.538 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.54937744140625
Epoch: 6, Steps: 17 | Train Loss: 0.557 Vali Loss: 4.651 Vali Acc: 0.618 Test Loss: 4.651 Test Acc: 0.618
Validation loss decreased (-0.610890 --> -0.617701).  Saving model ...
Epoch: 7 cost time: 13.395880460739136
Epoch: 7, Steps: 17 | Train Loss: 1.156 Vali Loss: 7.503 Vali Acc: 0.556 Test Loss: 7.503 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.644825458526611
Epoch: 8, Steps: 17 | Train Loss: 0.763 Vali Loss: 11.384 Vali Acc: 0.536 Test Loss: 11.384 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.236059665679932
Epoch: 9, Steps: 17 | Train Loss: 1.209 Vali Loss: 7.302 Vali Acc: 0.594 Test Loss: 7.302 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.273958921432495
Epoch: 10, Steps: 17 | Train Loss: 2.151 Vali Loss: 6.005 Vali Acc: 0.594 Test Loss: 6.005 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 14.2464759349823
Epoch: 11, Steps: 17 | Train Loss: 1.631 Vali Loss: 17.649 Vali Acc: 0.532 Test Loss: 17.649 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.905001878738403
Epoch: 12, Steps: 17 | Train Loss: 0.418 Vali Loss: 13.499 Vali Acc: 0.597 Test Loss: 13.499 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.81354594230652
Epoch: 13, Steps: 17 | Train Loss: 0.989 Vali Loss: 11.011 Vali Acc: 0.618 Test Loss: 11.011 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 15.569732904434204
Epoch: 14, Steps: 17 | Train Loss: 1.072 Vali Loss: 18.065 Vali Acc: 0.546 Test Loss: 18.065 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 15.654625415802002
Epoch: 15, Steps: 17 | Train Loss: 0.375 Vali Loss: 11.343 Vali Acc: 0.635 Test Loss: 11.343 Test Acc: 0.635
Validation loss decreased (-0.617701 --> -0.634699).  Saving model ...
Epoch: 16 cost time: 14.267707586288452
Epoch: 16, Steps: 17 | Train Loss: 0.549 Vali Loss: 9.560 Vali Acc: 0.608 Test Loss: 9.560 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.833274364471436
Epoch: 17, Steps: 17 | Train Loss: 0.545 Vali Loss: 12.042 Vali Acc: 0.608 Test Loss: 12.042 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 15.885105848312378
Epoch: 18, Steps: 17 | Train Loss: 2.492 Vali Loss: 25.158 Vali Acc: 0.560 Test Loss: 25.158 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 16.967297315597534
Epoch: 19, Steps: 17 | Train Loss: 1.378 Vali Loss: 26.090 Vali Acc: 0.573 Test Loss: 26.090 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 17.20427370071411
Epoch: 20, Steps: 17 | Train Loss: 3.981 Vali Loss: 15.165 Vali Acc: 0.638 Test Loss: 15.165 Test Acc: 0.638
Validation loss decreased (-0.634699 --> -0.638074).  Saving model ...
Epoch: 21 cost time: 13.478956460952759
Epoch: 21, Steps: 17 | Train Loss: 1.036 Vali Loss: 25.452 Vali Acc: 0.546 Test Loss: 25.452 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 14.515466690063477
Epoch: 22, Steps: 17 | Train Loss: 0.468 Vali Loss: 14.627 Vali Acc: 0.655 Test Loss: 14.627 Test Acc: 0.655
Validation loss decreased (-0.638074 --> -0.655144).  Saving model ...
Epoch: 23 cost time: 15.996343612670898
Epoch: 23, Steps: 17 | Train Loss: 1.707 Vali Loss: 24.832 Vali Acc: 0.604 Test Loss: 24.832 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 18.679092168807983
Epoch: 24, Steps: 17 | Train Loss: 0.758 Vali Loss: 16.951 Vali Acc: 0.570 Test Loss: 16.951 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 17.297362565994263
Epoch: 25, Steps: 17 | Train Loss: 0.654 Vali Loss: 18.631 Vali Acc: 0.631 Test Loss: 18.631 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 16.494481563568115
Epoch: 26, Steps: 17 | Train Loss: 0.910 Vali Loss: 25.225 Vali Acc: 0.597 Test Loss: 25.225 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 14.88144063949585
Epoch: 27, Steps: 17 | Train Loss: 1.688 Vali Loss: 20.924 Vali Acc: 0.597 Test Loss: 20.924 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 16.661184310913086
Epoch: 28, Steps: 17 | Train Loss: 2.105 Vali Loss: 37.895 Vali Acc: 0.553 Test Loss: 37.895 Test Acc: 0.553
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 16.578866958618164
Epoch: 29, Steps: 17 | Train Loss: 1.330 Vali Loss: 16.127 Vali Acc: 0.621 Test Loss: 16.127 Test Acc: 0.621
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 15.393007516860962
Epoch: 30, Steps: 17 | Train Loss: 2.299 Vali Loss: 33.648 Vali Acc: 0.580 Test Loss: 33.648 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 17.11108136177063
Epoch: 31, Steps: 17 | Train Loss: 1.704 Vali Loss: 24.375 Vali Acc: 0.597 Test Loss: 24.375 Test Acc: 0.597
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 15.100540161132812
Epoch: 32, Steps: 17 | Train Loss: 0.291 Vali Loss: 23.552 Vali Acc: 0.563 Test Loss: 23.552 Test Acc: 0.563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6552901023890785
model parameter : 17729026
model size : 87.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 16.772928953170776
Epoch: 1, Steps: 17 | Train Loss: 0.778 Vali Loss: 0.823 Vali Acc: 0.618 Test Loss: 0.823 Test Acc: 0.618
Validation loss decreased (inf --> -0.617739).  Saving model ...
Epoch: 2 cost time: 15.894694566726685
Epoch: 2, Steps: 17 | Train Loss: 0.736 Vali Loss: 1.324 Vali Acc: 0.631 Test Loss: 1.324 Test Acc: 0.631
Validation loss decreased (-0.617739 --> -0.631386).  Saving model ...
Epoch: 3 cost time: 14.306828737258911
Epoch: 3, Steps: 17 | Train Loss: 0.856 Vali Loss: 2.961 Vali Acc: 0.543 Test Loss: 2.961 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.631141185760498
Epoch: 4, Steps: 17 | Train Loss: 0.920 Vali Loss: 2.619 Vali Acc: 0.580 Test Loss: 2.619 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.298766374588013
Epoch: 5, Steps: 17 | Train Loss: 0.974 Vali Loss: 4.021 Vali Acc: 0.532 Test Loss: 4.021 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.012789249420166
Epoch: 6, Steps: 17 | Train Loss: 0.464 Vali Loss: 2.895 Vali Acc: 0.625 Test Loss: 2.895 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.975869417190552
Epoch: 7, Steps: 17 | Train Loss: 1.920 Vali Loss: 5.775 Vali Acc: 0.546 Test Loss: 5.775 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.072097539901733
Epoch: 8, Steps: 17 | Train Loss: 0.535 Vali Loss: 4.594 Vali Acc: 0.573 Test Loss: 4.594 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 15.567862272262573
Epoch: 9, Steps: 17 | Train Loss: 0.784 Vali Loss: 5.431 Vali Acc: 0.570 Test Loss: 5.431 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.576109170913696
Epoch: 10, Steps: 17 | Train Loss: 0.674 Vali Loss: 5.723 Vali Acc: 0.590 Test Loss: 5.723 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.772314548492432
Epoch: 11, Steps: 17 | Train Loss: 1.092 Vali Loss: 10.613 Vali Acc: 0.563 Test Loss: 10.613 Test Acc: 0.563
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 12.711590766906738
Epoch: 12, Steps: 17 | Train Loss: 0.955 Vali Loss: 10.213 Vali Acc: 0.567 Test Loss: 10.213 Test Acc: 0.567
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6313993174061433
model parameter : 17729026
model size : 87.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 15.727104663848877
Epoch: 1, Steps: 17 | Train Loss: 0.751 Vali Loss: 1.139 Vali Acc: 0.577 Test Loss: 1.139 Test Acc: 0.577
Validation loss decreased (inf --> -0.576780).  Saving model ...
Epoch: 2 cost time: 14.265444040298462
Epoch: 2, Steps: 17 | Train Loss: 0.761 Vali Loss: 2.995 Vali Acc: 0.556 Test Loss: 2.995 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.052402019500732
Epoch: 3, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.164 Vali Acc: 0.563 Test Loss: 2.164 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.760114192962646
Epoch: 4, Steps: 17 | Train Loss: 0.557 Vali Loss: 2.279 Vali Acc: 0.539 Test Loss: 2.279 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.045471906661987
Epoch: 5, Steps: 17 | Train Loss: 0.640 Vali Loss: 3.092 Vali Acc: 0.577 Test Loss: 3.092 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.18244218826294
Epoch: 6, Steps: 17 | Train Loss: 0.390 Vali Loss: 2.834 Vali Acc: 0.546 Test Loss: 2.834 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.964075803756714
Epoch: 7, Steps: 17 | Train Loss: 2.196 Vali Loss: 3.830 Vali Acc: 0.563 Test Loss: 3.830 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.343136310577393
Epoch: 8, Steps: 17 | Train Loss: 0.343 Vali Loss: 4.791 Vali Acc: 0.556 Test Loss: 4.791 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.289344072341919
Epoch: 9, Steps: 17 | Train Loss: 0.973 Vali Loss: 4.948 Vali Acc: 0.573 Test Loss: 4.948 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.743513584136963
Epoch: 10, Steps: 17 | Train Loss: 1.145 Vali Loss: 7.590 Vali Acc: 0.560 Test Loss: 7.590 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.535565376281738
Epoch: 11, Steps: 17 | Train Loss: 4.687 Vali Loss: 20.645 Vali Acc: 0.519 Test Loss: 20.645 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5767918088737202
model parameter : 17729026
model size : 87.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 13.805262565612793
Epoch: 1, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.876 Vali Acc: 0.526 Test Loss: 0.876 Test Acc: 0.526
Validation loss decreased (inf --> -0.525589).  Saving model ...
Epoch: 2 cost time: 13.59040880203247
Epoch: 2, Steps: 17 | Train Loss: 0.656 Vali Loss: 2.168 Vali Acc: 0.536 Test Loss: 2.168 Test Acc: 0.536
Validation loss decreased (-0.525589 --> -0.535814).  Saving model ...
Epoch: 3 cost time: 13.532286882400513
Epoch: 3, Steps: 17 | Train Loss: 0.550 Vali Loss: 2.595 Vali Acc: 0.519 Test Loss: 2.595 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.146703004837036
Epoch: 4, Steps: 17 | Train Loss: 0.473 Vali Loss: 1.999 Vali Acc: 0.556 Test Loss: 1.999 Test Acc: 0.556
Validation loss decreased (-0.535814 --> -0.556294).  Saving model ...
Epoch: 5 cost time: 12.62327265739441
Epoch: 5, Steps: 17 | Train Loss: 0.329 Vali Loss: 2.661 Vali Acc: 0.539 Test Loss: 2.661 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.948112964630127
Epoch: 6, Steps: 17 | Train Loss: 0.740 Vali Loss: 3.145 Vali Acc: 0.539 Test Loss: 3.145 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.241448879241943
Epoch: 7, Steps: 17 | Train Loss: 0.271 Vali Loss: 3.679 Vali Acc: 0.546 Test Loss: 3.679 Test Acc: 0.546
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.46322751045227
Epoch: 8, Steps: 17 | Train Loss: 0.623 Vali Loss: 4.224 Vali Acc: 0.532 Test Loss: 4.224 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 15.318374633789062
Epoch: 9, Steps: 17 | Train Loss: 0.799 Vali Loss: 5.407 Vali Acc: 0.515 Test Loss: 5.407 Test Acc: 0.515
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.248114585876465
Epoch: 10, Steps: 17 | Train Loss: 0.474 Vali Loss: 5.686 Vali Acc: 0.526 Test Loss: 5.686 Test Acc: 0.526
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.469414710998535
Epoch: 11, Steps: 17 | Train Loss: 0.825 Vali Loss: 7.646 Vali Acc: 0.546 Test Loss: 7.646 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 13.121232271194458
Epoch: 12, Steps: 17 | Train Loss: 0.325 Vali Loss: 8.390 Vali Acc: 0.495 Test Loss: 8.390 Test Acc: 0.495
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.246942043304443
Epoch: 13, Steps: 17 | Train Loss: 0.413 Vali Loss: 8.406 Vali Acc: 0.495 Test Loss: 8.406 Test Acc: 0.495
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.30451226234436
Epoch: 14, Steps: 17 | Train Loss: 0.587 Vali Loss: 15.692 Vali Acc: 0.515 Test Loss: 15.692 Test Acc: 0.515
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5563139931740614
model parameter : 17729026
model size : 87.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 14.735758543014526
Epoch: 1, Steps: 17 | Train Loss: 0.679 Vali Loss: 1.236 Vali Acc: 0.502 Test Loss: 1.236 Test Acc: 0.502
Validation loss decreased (inf --> -0.501694).  Saving model ...
Epoch: 2 cost time: 14.098395347595215
Epoch: 2, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.948 Vali Acc: 0.498 Test Loss: 0.948 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.74896764755249
Epoch: 3, Steps: 17 | Train Loss: 0.545 Vali Loss: 1.128 Vali Acc: 0.505 Test Loss: 1.128 Test Acc: 0.505
Validation loss decreased (-0.501694 --> -0.505108).  Saving model ...
Epoch: 4 cost time: 11.574914455413818
Epoch: 4, Steps: 17 | Train Loss: 0.506 Vali Loss: 1.122 Vali Acc: 0.563 Test Loss: 1.122 Test Acc: 0.563
Validation loss decreased (-0.505108 --> -0.563129).  Saving model ...
Epoch: 5 cost time: 11.678963661193848
Epoch: 5, Steps: 17 | Train Loss: 0.366 Vali Loss: 1.595 Vali Acc: 0.529 Test Loss: 1.595 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.96461296081543
Epoch: 6, Steps: 17 | Train Loss: 0.478 Vali Loss: 1.358 Vali Acc: 0.601 Test Loss: 1.358 Test Acc: 0.601
Validation loss decreased (-0.563129 --> -0.600669).  Saving model ...
Epoch: 7 cost time: 13.794436931610107
Epoch: 7, Steps: 17 | Train Loss: 0.544 Vali Loss: 1.695 Vali Acc: 0.563 Test Loss: 1.695 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.289084911346436
Epoch: 8, Steps: 17 | Train Loss: 0.534 Vali Loss: 2.251 Vali Acc: 0.532 Test Loss: 2.251 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.108150005340576
Epoch: 9, Steps: 17 | Train Loss: 0.291 Vali Loss: 3.326 Vali Acc: 0.536 Test Loss: 3.326 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.118764638900757
Epoch: 10, Steps: 17 | Train Loss: 0.598 Vali Loss: 5.629 Vali Acc: 0.515 Test Loss: 5.629 Test Acc: 0.515
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.302720785140991
Epoch: 11, Steps: 17 | Train Loss: 0.888 Vali Loss: 4.182 Vali Acc: 0.563 Test Loss: 4.182 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.705379009246826
Epoch: 12, Steps: 17 | Train Loss: 1.266 Vali Loss: 8.491 Vali Acc: 0.519 Test Loss: 8.491 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 13.51839542388916
Epoch: 13, Steps: 17 | Train Loss: 1.316 Vali Loss: 5.383 Vali Acc: 0.573 Test Loss: 5.383 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 14.509795427322388
Epoch: 14, Steps: 17 | Train Loss: 0.888 Vali Loss: 5.429 Vali Acc: 0.529 Test Loss: 5.429 Test Acc: 0.529
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 13.054210186004639
Epoch: 15, Steps: 17 | Train Loss: 0.487 Vali Loss: 8.388 Vali Acc: 0.546 Test Loss: 8.388 Test Acc: 0.546
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.184879541397095
Epoch: 16, Steps: 17 | Train Loss: 1.231 Vali Loss: 8.771 Vali Acc: 0.549 Test Loss: 8.771 Test Acc: 0.549
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6006825938566553
model parameter : 17729026
model size : 87.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 12.900246381759644
Epoch: 1, Steps: 17 | Train Loss: 0.735 Vali Loss: 2.066 Vali Acc: 0.502 Test Loss: 2.066 Test Acc: 0.502
Validation loss decreased (inf --> -0.501686).  Saving model ...
Epoch: 2 cost time: 19.75899600982666
Epoch: 2, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.792 Vali Acc: 0.509 Test Loss: 0.792 Test Acc: 0.509
Validation loss decreased (-0.501686 --> -0.508525).  Saving model ...
Epoch: 3 cost time: 19.096233129501343
Epoch: 3, Steps: 17 | Train Loss: 0.507 Vali Loss: 2.120 Vali Acc: 0.505 Test Loss: 2.120 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.849822759628296
Epoch: 4, Steps: 17 | Train Loss: 0.555 Vali Loss: 1.429 Vali Acc: 0.590 Test Loss: 1.429 Test Acc: 0.590
Validation loss decreased (-0.508525 --> -0.590429).  Saving model ...
Epoch: 5 cost time: 18.178767681121826
Epoch: 5, Steps: 17 | Train Loss: 0.614 Vali Loss: 3.461 Vali Acc: 0.577 Test Loss: 3.461 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.91502332687378
Epoch: 6, Steps: 17 | Train Loss: 0.511 Vali Loss: 4.615 Vali Acc: 0.597 Test Loss: 4.615 Test Acc: 0.597
Validation loss decreased (-0.590429 --> -0.597223).  Saving model ...
Epoch: 7 cost time: 17.510436296463013
Epoch: 7, Steps: 17 | Train Loss: 0.443 Vali Loss: 4.645 Vali Acc: 0.546 Test Loss: 4.645 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.01039695739746
Epoch: 8, Steps: 17 | Train Loss: 0.445 Vali Loss: 3.897 Vali Acc: 0.532 Test Loss: 3.897 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.454565286636353
Epoch: 9, Steps: 17 | Train Loss: 0.606 Vali Loss: 5.293 Vali Acc: 0.584 Test Loss: 5.293 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 19.9769549369812
Epoch: 10, Steps: 17 | Train Loss: 0.772 Vali Loss: 7.290 Vali Acc: 0.553 Test Loss: 7.290 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 18.108500242233276
Epoch: 11, Steps: 17 | Train Loss: 1.298 Vali Loss: 8.166 Vali Acc: 0.580 Test Loss: 8.166 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.915574789047241
Epoch: 12, Steps: 17 | Train Loss: 1.069 Vali Loss: 9.369 Vali Acc: 0.560 Test Loss: 9.369 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 17.870888471603394
Epoch: 13, Steps: 17 | Train Loss: 0.611 Vali Loss: 8.916 Vali Acc: 0.570 Test Loss: 8.916 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 16.69015383720398
Epoch: 14, Steps: 17 | Train Loss: 0.754 Vali Loss: 12.332 Vali Acc: 0.563 Test Loss: 12.332 Test Acc: 0.563
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 18.412453413009644
Epoch: 15, Steps: 17 | Train Loss: 1.507 Vali Loss: 18.527 Vali Acc: 0.522 Test Loss: 18.527 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 18.60511565208435
Epoch: 16, Steps: 17 | Train Loss: 1.444 Vali Loss: 11.623 Vali Acc: 0.560 Test Loss: 11.623 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5972696245733788
model parameter : 17729026
model size : 87.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 31.367802619934082
Epoch: 1, Steps: 17 | Train Loss: 0.749 Vali Loss: 1.391 Vali Acc: 0.604 Test Loss: 1.391 Test Acc: 0.604
Validation loss decreased (inf --> -0.604082).  Saving model ...
Epoch: 2 cost time: 25.278055667877197
Epoch: 2, Steps: 17 | Train Loss: 0.603 Vali Loss: 3.327 Vali Acc: 0.543 Test Loss: 3.327 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 28.4976007938385
Epoch: 3, Steps: 17 | Train Loss: 0.697 Vali Loss: 3.376 Vali Acc: 0.587 Test Loss: 3.376 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 28.89191770553589
Epoch: 4, Steps: 17 | Train Loss: 0.473 Vali Loss: 3.701 Vali Acc: 0.549 Test Loss: 3.701 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 29.05185031890869
Epoch: 5, Steps: 17 | Train Loss: 1.171 Vali Loss: 3.283 Vali Acc: 0.645 Test Loss: 3.283 Test Acc: 0.645
Validation loss decreased (-0.604082 --> -0.645018).  Saving model ...
Epoch: 6 cost time: 28.200201988220215
Epoch: 6, Steps: 17 | Train Loss: 0.992 Vali Loss: 3.808 Vali Acc: 0.645 Test Loss: 3.808 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 27.958470821380615
Epoch: 7, Steps: 17 | Train Loss: 1.884 Vali Loss: 11.161 Vali Acc: 0.560 Test Loss: 11.161 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 26.850419521331787
Epoch: 8, Steps: 17 | Train Loss: 0.932 Vali Loss: 7.982 Vali Acc: 0.621 Test Loss: 7.982 Test Acc: 0.621
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 30.36437726020813
Epoch: 9, Steps: 17 | Train Loss: 1.010 Vali Loss: 10.093 Vali Acc: 0.601 Test Loss: 10.093 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 26.812968969345093
Epoch: 10, Steps: 17 | Train Loss: 0.543 Vali Loss: 13.672 Vali Acc: 0.567 Test Loss: 13.672 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 28.987550497055054
Epoch: 11, Steps: 17 | Train Loss: 1.258 Vali Loss: 5.288 Vali Acc: 0.662 Test Loss: 5.288 Test Acc: 0.662
Validation loss decreased (-0.645018 --> -0.662063).  Saving model ...
Epoch: 12 cost time: 28.73365306854248
Epoch: 12, Steps: 17 | Train Loss: 0.560 Vali Loss: 5.232 Vali Acc: 0.696 Test Loss: 5.232 Test Acc: 0.696
Validation loss decreased (-0.662063 --> -0.696193).  Saving model ...
Epoch: 13 cost time: 26.948712825775146
Epoch: 13, Steps: 17 | Train Loss: 0.478 Vali Loss: 7.884 Vali Acc: 0.686 Test Loss: 7.884 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 29.862183809280396
Epoch: 14, Steps: 17 | Train Loss: 0.739 Vali Loss: 8.353 Vali Acc: 0.611 Test Loss: 8.353 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 30.930134773254395
Epoch: 15, Steps: 17 | Train Loss: 0.676 Vali Loss: 23.087 Vali Acc: 0.543 Test Loss: 23.087 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 34.59081792831421
Epoch: 16, Steps: 17 | Train Loss: 1.751 Vali Loss: 9.839 Vali Acc: 0.652 Test Loss: 9.839 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 32.08900690078735
Epoch: 17, Steps: 17 | Train Loss: 0.637 Vali Loss: 21.643 Vali Acc: 0.601 Test Loss: 21.643 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 36.04158043861389
Epoch: 18, Steps: 17 | Train Loss: 0.510 Vali Loss: 13.110 Vali Acc: 0.611 Test Loss: 13.110 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 35.767144203186035
Epoch: 19, Steps: 17 | Train Loss: 0.568 Vali Loss: 15.745 Vali Acc: 0.635 Test Loss: 15.745 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 33.94566011428833
Epoch: 20, Steps: 17 | Train Loss: 0.127 Vali Loss: 16.468 Vali Acc: 0.635 Test Loss: 16.468 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 35.64182257652283
Epoch: 21, Steps: 17 | Train Loss: 0.958 Vali Loss: 16.262 Vali Acc: 0.652 Test Loss: 16.262 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 38.03004336357117
Epoch: 22, Steps: 17 | Train Loss: 0.746 Vali Loss: 13.674 Vali Acc: 0.635 Test Loss: 13.674 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6962457337883959
model parameter : 14583298
model size : 75.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 26.99529719352722
Epoch: 1, Steps: 17 | Train Loss: 0.763 Vali Loss: 1.224 Vali Acc: 0.580 Test Loss: 1.224 Test Acc: 0.580
Validation loss decreased (inf --> -0.580193).  Saving model ...
Epoch: 2 cost time: 22.266592264175415
Epoch: 2, Steps: 17 | Train Loss: 0.800 Vali Loss: 1.541 Vali Acc: 0.614 Test Loss: 1.541 Test Acc: 0.614
Validation loss decreased (-0.580193 --> -0.614319).  Saving model ...
Epoch: 3 cost time: 27.02758812904358
Epoch: 3, Steps: 17 | Train Loss: 1.238 Vali Loss: 3.433 Vali Acc: 0.570 Test Loss: 3.433 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.78983426094055
Epoch: 4, Steps: 17 | Train Loss: 0.519 Vali Loss: 2.853 Vali Acc: 0.631 Test Loss: 2.853 Test Acc: 0.631
Validation loss decreased (-0.614319 --> -0.631371).  Saving model ...
Epoch: 5 cost time: 26.387043952941895
Epoch: 5, Steps: 17 | Train Loss: 0.801 Vali Loss: 4.630 Vali Acc: 0.604 Test Loss: 4.630 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.641519784927368
Epoch: 6, Steps: 17 | Train Loss: 2.499 Vali Loss: 6.933 Vali Acc: 0.590 Test Loss: 6.933 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 27.494338035583496
Epoch: 7, Steps: 17 | Train Loss: 1.261 Vali Loss: 4.206 Vali Acc: 0.618 Test Loss: 4.206 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 28.32964277267456
Epoch: 8, Steps: 17 | Train Loss: 0.654 Vali Loss: 8.547 Vali Acc: 0.577 Test Loss: 8.547 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 25.70601177215576
Epoch: 9, Steps: 17 | Train Loss: 0.902 Vali Loss: 10.594 Vali Acc: 0.567 Test Loss: 10.594 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 24.745099782943726
Epoch: 10, Steps: 17 | Train Loss: 0.760 Vali Loss: 22.150 Vali Acc: 0.519 Test Loss: 22.150 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 26.751819849014282
Epoch: 11, Steps: 17 | Train Loss: 0.766 Vali Loss: 10.308 Vali Acc: 0.604 Test Loss: 10.308 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 22.72638487815857
Epoch: 12, Steps: 17 | Train Loss: 1.020 Vali Loss: 18.646 Vali Acc: 0.532 Test Loss: 18.646 Test Acc: 0.532
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 28.711125135421753
Epoch: 13, Steps: 17 | Train Loss: 0.576 Vali Loss: 11.029 Vali Acc: 0.584 Test Loss: 11.029 Test Acc: 0.584
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 26.61283040046692
Epoch: 14, Steps: 17 | Train Loss: 0.500 Vali Loss: 7.721 Vali Acc: 0.666 Test Loss: 7.721 Test Acc: 0.666
Validation loss decreased (-0.631371 --> -0.665452).  Saving model ...
Epoch: 15 cost time: 29.894156217575073
Epoch: 15, Steps: 17 | Train Loss: 0.825 Vali Loss: 10.520 Vali Acc: 0.672 Test Loss: 10.520 Test Acc: 0.672
Validation loss decreased (-0.665452 --> -0.672250).  Saving model ...
Epoch: 16 cost time: 30.796653270721436
Epoch: 16, Steps: 17 | Train Loss: 0.238 Vali Loss: 8.906 Vali Acc: 0.638 Test Loss: 8.906 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 29.1186740398407
Epoch: 17, Steps: 17 | Train Loss: 0.750 Vali Loss: 11.911 Vali Acc: 0.625 Test Loss: 11.911 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 29.939921379089355
Epoch: 18, Steps: 17 | Train Loss: 0.789 Vali Loss: 20.565 Vali Acc: 0.597 Test Loss: 20.565 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 30.456502676010132
Epoch: 19, Steps: 17 | Train Loss: 0.232 Vali Loss: 23.126 Vali Acc: 0.577 Test Loss: 23.126 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 32.72864603996277
Epoch: 20, Steps: 17 | Train Loss: 3.681 Vali Loss: 11.090 Vali Acc: 0.645 Test Loss: 11.090 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 30.810694217681885
Epoch: 21, Steps: 17 | Train Loss: 0.856 Vali Loss: 19.390 Vali Acc: 0.618 Test Loss: 19.390 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 22.731976985931396
Epoch: 22, Steps: 17 | Train Loss: 1.083 Vali Loss: 17.881 Vali Acc: 0.604 Test Loss: 17.881 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 32.013155698776245
Epoch: 23, Steps: 17 | Train Loss: 0.532 Vali Loss: 16.078 Vali Acc: 0.628 Test Loss: 16.078 Test Acc: 0.628
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 32.96075940132141
Epoch: 24, Steps: 17 | Train Loss: 0.138 Vali Loss: 15.059 Vali Acc: 0.669 Test Loss: 15.059 Test Acc: 0.669
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 29.464165687561035
Epoch: 25, Steps: 17 | Train Loss: 0.436 Vali Loss: 17.255 Vali Acc: 0.628 Test Loss: 17.255 Test Acc: 0.628
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6723549488054608
model parameter : 14583298
model size : 75.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 24.801671028137207
Epoch: 1, Steps: 17 | Train Loss: 0.768 Vali Loss: 1.237 Vali Acc: 0.597 Test Loss: 1.237 Test Acc: 0.597
Validation loss decreased (inf --> -0.597257).  Saving model ...
Epoch: 2 cost time: 21.995038986206055
Epoch: 2, Steps: 17 | Train Loss: 0.628 Vali Loss: 3.105 Vali Acc: 0.526 Test Loss: 3.105 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.613814115524292
Epoch: 3, Steps: 17 | Train Loss: 1.112 Vali Loss: 8.593 Vali Acc: 0.502 Test Loss: 8.593 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 22.492472410202026
Epoch: 4, Steps: 17 | Train Loss: 1.345 Vali Loss: 2.567 Vali Acc: 0.614 Test Loss: 2.567 Test Acc: 0.614
Validation loss decreased (-0.597257 --> -0.614309).  Saving model ...
Epoch: 5 cost time: 22.62268352508545
Epoch: 5, Steps: 17 | Train Loss: 0.398 Vali Loss: 3.036 Vali Acc: 0.604 Test Loss: 3.036 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.417343854904175
Epoch: 6, Steps: 17 | Train Loss: 0.387 Vali Loss: 4.224 Vali Acc: 0.631 Test Loss: 4.224 Test Acc: 0.631
Validation loss decreased (-0.614309 --> -0.631357).  Saving model ...
Epoch: 7 cost time: 24.778714179992676
Epoch: 7, Steps: 17 | Train Loss: 0.327 Vali Loss: 3.462 Vali Acc: 0.604 Test Loss: 3.462 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.757441759109497
Epoch: 8, Steps: 17 | Train Loss: 1.266 Vali Loss: 7.574 Vali Acc: 0.597 Test Loss: 7.574 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.768476247787476
Epoch: 9, Steps: 17 | Train Loss: 0.717 Vali Loss: 10.798 Vali Acc: 0.590 Test Loss: 10.798 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.745474576950073
Epoch: 10, Steps: 17 | Train Loss: 0.857 Vali Loss: 14.667 Vali Acc: 0.553 Test Loss: 14.667 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 20.582486867904663
Epoch: 11, Steps: 17 | Train Loss: 0.350 Vali Loss: 9.792 Vali Acc: 0.601 Test Loss: 9.792 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 25.827102184295654
Epoch: 12, Steps: 17 | Train Loss: 0.815 Vali Loss: 12.498 Vali Acc: 0.573 Test Loss: 12.498 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 23.147321462631226
Epoch: 13, Steps: 17 | Train Loss: 0.520 Vali Loss: 7.710 Vali Acc: 0.597 Test Loss: 7.710 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 22.890679597854614
Epoch: 14, Steps: 17 | Train Loss: 0.932 Vali Loss: 14.174 Vali Acc: 0.587 Test Loss: 14.174 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 23.286536693572998
Epoch: 15, Steps: 17 | Train Loss: 1.232 Vali Loss: 13.128 Vali Acc: 0.570 Test Loss: 13.128 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 26.36021375656128
Epoch: 16, Steps: 17 | Train Loss: 1.654 Vali Loss: 11.039 Vali Acc: 0.621 Test Loss: 11.039 Test Acc: 0.621
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6313993174061433
model parameter : 14583298
model size : 75.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 21.215548038482666
Epoch: 1, Steps: 17 | Train Loss: 0.805 Vali Loss: 2.132 Vali Acc: 0.515 Test Loss: 2.132 Test Acc: 0.515
Validation loss decreased (inf --> -0.515337).  Saving model ...
Epoch: 2 cost time: 19.81937074661255
Epoch: 2, Steps: 17 | Train Loss: 0.623 Vali Loss: 4.750 Vali Acc: 0.512 Test Loss: 4.750 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.314945220947266
Epoch: 3, Steps: 17 | Train Loss: 0.647 Vali Loss: 2.377 Vali Acc: 0.560 Test Loss: 2.377 Test Acc: 0.560
Validation loss decreased (-0.515337 --> -0.559703).  Saving model ...
Epoch: 4 cost time: 19.842170238494873
Epoch: 4, Steps: 17 | Train Loss: 0.840 Vali Loss: 2.851 Vali Acc: 0.539 Test Loss: 2.851 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.29615330696106
Epoch: 5, Steps: 17 | Train Loss: 1.184 Vali Loss: 2.832 Vali Acc: 0.621 Test Loss: 2.832 Test Acc: 0.621
Validation loss decreased (-0.559703 --> -0.621132).  Saving model ...
Epoch: 6 cost time: 18.779468297958374
Epoch: 6, Steps: 17 | Train Loss: 0.849 Vali Loss: 4.277 Vali Acc: 0.580 Test Loss: 4.277 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.26407027244568
Epoch: 7, Steps: 17 | Train Loss: 0.593 Vali Loss: 6.335 Vali Acc: 0.553 Test Loss: 6.335 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.231773614883423
Epoch: 8, Steps: 17 | Train Loss: 0.663 Vali Loss: 5.703 Vali Acc: 0.587 Test Loss: 5.703 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 20.040679216384888
Epoch: 9, Steps: 17 | Train Loss: 0.418 Vali Loss: 8.358 Vali Acc: 0.563 Test Loss: 8.358 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 19.480445384979248
Epoch: 10, Steps: 17 | Train Loss: 0.372 Vali Loss: 12.141 Vali Acc: 0.563 Test Loss: 12.141 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 19.220159769058228
Epoch: 11, Steps: 17 | Train Loss: 0.669 Vali Loss: 14.460 Vali Acc: 0.539 Test Loss: 14.460 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 20.500658988952637
Epoch: 12, Steps: 17 | Train Loss: 1.110 Vali Loss: 20.640 Vali Acc: 0.529 Test Loss: 20.640 Test Acc: 0.529
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 22.39540123939514
Epoch: 13, Steps: 17 | Train Loss: 1.200 Vali Loss: 14.130 Vali Acc: 0.570 Test Loss: 14.130 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 21.967962980270386
Epoch: 14, Steps: 17 | Train Loss: 0.402 Vali Loss: 13.565 Vali Acc: 0.590 Test Loss: 13.565 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 21.974075078964233
Epoch: 15, Steps: 17 | Train Loss: 0.571 Vali Loss: 15.660 Vali Acc: 0.590 Test Loss: 15.660 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.621160409556314
model parameter : 14583298
model size : 75.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 19.62207055091858
Epoch: 1, Steps: 17 | Train Loss: 0.767 Vali Loss: 2.651 Vali Acc: 0.502 Test Loss: 2.651 Test Acc: 0.502
Validation loss decreased (inf --> -0.501680).  Saving model ...
Epoch: 2 cost time: 16.282533168792725
Epoch: 2, Steps: 17 | Train Loss: 0.620 Vali Loss: 2.175 Vali Acc: 0.560 Test Loss: 2.175 Test Acc: 0.560
Validation loss decreased (-0.501680 --> -0.559705).  Saving model ...
Epoch: 3 cost time: 15.924776077270508
Epoch: 3, Steps: 17 | Train Loss: 0.793 Vali Loss: 2.555 Vali Acc: 0.594 Test Loss: 2.555 Test Acc: 0.594
Validation loss decreased (-0.559705 --> -0.593831).  Saving model ...
Epoch: 4 cost time: 14.483476877212524
Epoch: 4, Steps: 17 | Train Loss: 2.102 Vali Loss: 7.148 Vali Acc: 0.536 Test Loss: 7.148 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.502749919891357
Epoch: 5, Steps: 17 | Train Loss: 1.539 Vali Loss: 2.930 Vali Acc: 0.648 Test Loss: 2.930 Test Acc: 0.648
Validation loss decreased (-0.593831 --> -0.648435).  Saving model ...
Epoch: 6 cost time: 18.545267820358276
Epoch: 6, Steps: 17 | Train Loss: 0.595 Vali Loss: 8.829 Vali Acc: 0.543 Test Loss: 8.829 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.04366397857666
Epoch: 7, Steps: 17 | Train Loss: 0.963 Vali Loss: 4.915 Vali Acc: 0.608 Test Loss: 4.915 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.921489715576172
Epoch: 8, Steps: 17 | Train Loss: 0.432 Vali Loss: 15.491 Vali Acc: 0.515 Test Loss: 15.491 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 17.373228073120117
Epoch: 9, Steps: 17 | Train Loss: 1.317 Vali Loss: 6.994 Vali Acc: 0.597 Test Loss: 6.994 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 18.455400466918945
Epoch: 10, Steps: 17 | Train Loss: 1.009 Vali Loss: 7.806 Vali Acc: 0.614 Test Loss: 7.806 Test Acc: 0.614
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 18.67396569252014
Epoch: 11, Steps: 17 | Train Loss: 0.281 Vali Loss: 8.245 Vali Acc: 0.608 Test Loss: 8.245 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 16.169791221618652
Epoch: 12, Steps: 17 | Train Loss: 0.606 Vali Loss: 11.672 Vali Acc: 0.590 Test Loss: 11.672 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 16.210352659225464
Epoch: 13, Steps: 17 | Train Loss: 0.559 Vali Loss: 9.449 Vali Acc: 0.611 Test Loss: 9.449 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 17.203990936279297
Epoch: 14, Steps: 17 | Train Loss: 0.415 Vali Loss: 9.795 Vali Acc: 0.621 Test Loss: 9.795 Test Acc: 0.621
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 16.912347316741943
Epoch: 15, Steps: 17 | Train Loss: 0.498 Vali Loss: 10.921 Vali Acc: 0.611 Test Loss: 10.921 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6484641638225256
model parameter : 14583298
model size : 75.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 20.0190908908844
Epoch: 1, Steps: 17 | Train Loss: 0.801 Vali Loss: 2.314 Vali Acc: 0.502 Test Loss: 2.314 Test Acc: 0.502
Validation loss decreased (inf --> -0.501683).  Saving model ...
Epoch: 2 cost time: 13.390451669692993
Epoch: 2, Steps: 17 | Train Loss: 0.924 Vali Loss: 2.726 Vali Acc: 0.515 Test Loss: 2.726 Test Acc: 0.515
Validation loss decreased (-0.501683 --> -0.515331).  Saving model ...
Epoch: 3 cost time: 15.18598747253418
Epoch: 3, Steps: 17 | Train Loss: 0.888 Vali Loss: 3.222 Vali Acc: 0.556 Test Loss: 3.222 Test Acc: 0.556
Validation loss decreased (-0.515331 --> -0.556282).  Saving model ...
Epoch: 4 cost time: 14.520116090774536
Epoch: 4, Steps: 17 | Train Loss: 1.864 Vali Loss: 4.964 Vali Acc: 0.529 Test Loss: 4.964 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.962290287017822
Epoch: 5, Steps: 17 | Train Loss: 0.647 Vali Loss: 3.283 Vali Acc: 0.584 Test Loss: 3.283 Test Acc: 0.584
Validation loss decreased (-0.556282 --> -0.583585).  Saving model ...
Epoch: 6 cost time: 14.806403636932373
Epoch: 6, Steps: 17 | Train Loss: 0.557 Vali Loss: 3.255 Vali Acc: 0.642 Test Loss: 3.255 Test Acc: 0.642
Validation loss decreased (-0.583585 --> -0.641606).  Saving model ...
Epoch: 7 cost time: 17.632860898971558
Epoch: 7, Steps: 17 | Train Loss: 0.786 Vali Loss: 4.202 Vali Acc: 0.584 Test Loss: 4.202 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.62235403060913
Epoch: 8, Steps: 17 | Train Loss: 0.524 Vali Loss: 4.570 Vali Acc: 0.597 Test Loss: 4.570 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.301252126693726
Epoch: 9, Steps: 17 | Train Loss: 0.670 Vali Loss: 5.618 Vali Acc: 0.587 Test Loss: 5.618 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.78873562812805
Epoch: 10, Steps: 17 | Train Loss: 0.891 Vali Loss: 13.642 Vali Acc: 0.519 Test Loss: 13.642 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 15.57923674583435
Epoch: 11, Steps: 17 | Train Loss: 1.196 Vali Loss: 8.445 Vali Acc: 0.570 Test Loss: 8.445 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.573103904724121
Epoch: 12, Steps: 17 | Train Loss: 0.275 Vali Loss: 8.526 Vali Acc: 0.580 Test Loss: 8.526 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.57922053337097
Epoch: 13, Steps: 17 | Train Loss: 0.638 Vali Loss: 7.332 Vali Acc: 0.594 Test Loss: 7.332 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 15.9195396900177
Epoch: 14, Steps: 17 | Train Loss: 0.759 Vali Loss: 9.226 Vali Acc: 0.546 Test Loss: 9.226 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 17.680643558502197
Epoch: 15, Steps: 17 | Train Loss: 1.174 Vali Loss: 9.550 Vali Acc: 0.549 Test Loss: 9.550 Test Acc: 0.549
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 18.244386196136475
Epoch: 16, Steps: 17 | Train Loss: 1.141 Vali Loss: 11.720 Vali Acc: 0.549 Test Loss: 11.720 Test Acc: 0.549
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 14583298
model size : 75.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 16.47303795814514
Epoch: 1, Steps: 17 | Train Loss: 0.785 Vali Loss: 1.846 Vali Acc: 0.502 Test Loss: 1.846 Test Acc: 0.502
Validation loss decreased (inf --> -0.501688).  Saving model ...
Epoch: 2 cost time: 15.62356185913086
Epoch: 2, Steps: 17 | Train Loss: 0.796 Vali Loss: 2.412 Vali Acc: 0.529 Test Loss: 2.412 Test Acc: 0.529
Validation loss decreased (-0.501688 --> -0.528986).  Saving model ...
Epoch: 3 cost time: 17.439815521240234
Epoch: 3, Steps: 17 | Train Loss: 0.847 Vali Loss: 1.920 Vali Acc: 0.608 Test Loss: 1.920 Test Acc: 0.608
Validation loss decreased (-0.528986 --> -0.607489).  Saving model ...
Epoch: 4 cost time: 13.623139142990112
Epoch: 4, Steps: 17 | Train Loss: 1.653 Vali Loss: 6.129 Vali Acc: 0.512 Test Loss: 6.129 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.38356614112854
Epoch: 5, Steps: 17 | Train Loss: 1.138 Vali Loss: 4.146 Vali Acc: 0.549 Test Loss: 4.146 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.31076741218567
Epoch: 6, Steps: 17 | Train Loss: 0.534 Vali Loss: 4.125 Vali Acc: 0.567 Test Loss: 4.125 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.388177633285522
Epoch: 7, Steps: 17 | Train Loss: 0.794 Vali Loss: 5.744 Vali Acc: 0.536 Test Loss: 5.744 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.033576726913452
Epoch: 8, Steps: 17 | Train Loss: 0.997 Vali Loss: 5.348 Vali Acc: 0.567 Test Loss: 5.348 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.452168464660645
Epoch: 9, Steps: 17 | Train Loss: 0.588 Vali Loss: 5.000 Vali Acc: 0.570 Test Loss: 5.000 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 17.00071954727173
Epoch: 10, Steps: 17 | Train Loss: 0.639 Vali Loss: 4.379 Vali Acc: 0.563 Test Loss: 4.379 Test Acc: 0.563
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 17.319477081298828
Epoch: 11, Steps: 17 | Train Loss: 1.273 Vali Loss: 4.850 Vali Acc: 0.597 Test Loss: 4.850 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 17.751558542251587
Epoch: 12, Steps: 17 | Train Loss: 0.494 Vali Loss: 7.959 Vali Acc: 0.563 Test Loss: 7.959 Test Acc: 0.563
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 16.44053864479065
Epoch: 13, Steps: 17 | Train Loss: 0.377 Vali Loss: 8.892 Vali Acc: 0.556 Test Loss: 8.892 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6075085324232082
model parameter : 14583298
model size : 75.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 15.21329116821289
Epoch: 1, Steps: 17 | Train Loss: 0.766 Vali Loss: 1.766 Vali Acc: 0.498 Test Loss: 1.766 Test Acc: 0.498
Validation loss decreased (inf --> -0.498276).  Saving model ...
Epoch: 2 cost time: 15.08310604095459
Epoch: 2, Steps: 17 | Train Loss: 0.681 Vali Loss: 1.072 Vali Acc: 0.621 Test Loss: 1.072 Test Acc: 0.621
Validation loss decreased (-0.498276 --> -0.621150).  Saving model ...
Epoch: 3 cost time: 16.727171421051025
Epoch: 3, Steps: 17 | Train Loss: 0.591 Vali Loss: 2.780 Vali Acc: 0.515 Test Loss: 2.780 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.804048538208008
Epoch: 4, Steps: 17 | Train Loss: 0.662 Vali Loss: 2.813 Vali Acc: 0.543 Test Loss: 2.813 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.17824935913086
Epoch: 5, Steps: 17 | Train Loss: 0.764 Vali Loss: 3.701 Vali Acc: 0.543 Test Loss: 3.701 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.269529342651367
Epoch: 6, Steps: 17 | Train Loss: 0.439 Vali Loss: 3.614 Vali Acc: 0.546 Test Loss: 3.614 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.354074478149414
Epoch: 7, Steps: 17 | Train Loss: 0.526 Vali Loss: 4.703 Vali Acc: 0.549 Test Loss: 4.703 Test Acc: 0.549
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.385541439056396
Epoch: 8, Steps: 17 | Train Loss: 0.460 Vali Loss: 7.302 Vali Acc: 0.532 Test Loss: 7.302 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 16.047384023666382
Epoch: 9, Steps: 17 | Train Loss: 0.868 Vali Loss: 6.592 Vali Acc: 0.526 Test Loss: 6.592 Test Acc: 0.526
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 15.468450784683228
Epoch: 10, Steps: 17 | Train Loss: 0.294 Vali Loss: 7.398 Vali Acc: 0.549 Test Loss: 7.398 Test Acc: 0.549
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 17.08132839202881
Epoch: 11, Steps: 17 | Train Loss: 0.522 Vali Loss: 6.181 Vali Acc: 0.560 Test Loss: 6.181 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 16.849918842315674
Epoch: 12, Steps: 17 | Train Loss: 1.017 Vali Loss: 9.126 Vali Acc: 0.529 Test Loss: 9.126 Test Acc: 0.529
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.621160409556314
model parameter : 14583298
model size : 75.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 16.258721351623535
Epoch: 1, Steps: 17 | Train Loss: 0.726 Vali Loss: 1.362 Vali Acc: 0.502 Test Loss: 1.362 Test Acc: 0.502
Validation loss decreased (inf --> -0.501693).  Saving model ...
Epoch: 2 cost time: 15.010137796401978
Epoch: 2, Steps: 17 | Train Loss: 0.619 Vali Loss: 1.097 Vali Acc: 0.498 Test Loss: 1.097 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.86534094810486
Epoch: 3, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.862 Vali Acc: 0.618 Test Loss: 0.862 Test Acc: 0.618
Validation loss decreased (-0.501693 --> -0.617739).  Saving model ...
Epoch: 4 cost time: 15.032636165618896
Epoch: 4, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.794 Vali Acc: 0.611 Test Loss: 0.794 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.954657316207886
Epoch: 5, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.927 Vali Acc: 0.594 Test Loss: 0.927 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.19747519493103
Epoch: 6, Steps: 17 | Train Loss: 0.822 Vali Loss: 1.446 Vali Acc: 0.556 Test Loss: 1.446 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.551723718643188
Epoch: 7, Steps: 17 | Train Loss: 0.527 Vali Loss: 2.646 Vali Acc: 0.519 Test Loss: 2.646 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 14.651769876480103
Epoch: 8, Steps: 17 | Train Loss: 0.527 Vali Loss: 1.501 Vali Acc: 0.590 Test Loss: 1.501 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.029355764389038
Epoch: 9, Steps: 17 | Train Loss: 0.531 Vali Loss: 1.977 Vali Acc: 0.543 Test Loss: 1.977 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 16.861183881759644
Epoch: 10, Steps: 17 | Train Loss: 0.318 Vali Loss: 4.745 Vali Acc: 0.505 Test Loss: 4.745 Test Acc: 0.505
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 15.98459768295288
Epoch: 11, Steps: 17 | Train Loss: 0.305 Vali Loss: 2.802 Vali Acc: 0.563 Test Loss: 2.802 Test Acc: 0.563
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 16.016671895980835
Epoch: 12, Steps: 17 | Train Loss: 0.592 Vali Loss: 2.371 Vali Acc: 0.577 Test Loss: 2.371 Test Acc: 0.577
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 16.190587520599365
Epoch: 13, Steps: 17 | Train Loss: 0.508 Vali Loss: 3.157 Vali Acc: 0.584 Test Loss: 3.157 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6177474402730375
model parameter : 14583298
model size : 75.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 13.866272211074829
Epoch: 1, Steps: 17 | Train Loss: 0.753 Vali Loss: 2.788 Vali Acc: 0.502 Test Loss: 2.788 Test Acc: 0.502
Validation loss decreased (inf --> -0.501679).  Saving model ...
Epoch: 2 cost time: 14.742069721221924
Epoch: 2, Steps: 17 | Train Loss: 0.797 Vali Loss: 2.698 Vali Acc: 0.502 Test Loss: 2.698 Test Acc: 0.502
Validation loss decreased (-0.501679 --> -0.501680).  Saving model ...
Epoch: 3 cost time: 15.431079149246216
Epoch: 3, Steps: 17 | Train Loss: 0.982 Vali Loss: 4.618 Vali Acc: 0.502 Test Loss: 4.618 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.955235958099365
Epoch: 4, Steps: 17 | Train Loss: 0.771 Vali Loss: 1.341 Vali Acc: 0.553 Test Loss: 1.341 Test Acc: 0.553
Validation loss decreased (-0.501680 --> -0.552888).  Saving model ...
Epoch: 5 cost time: 15.863610744476318
Epoch: 5, Steps: 17 | Train Loss: 0.695 Vali Loss: 3.230 Vali Acc: 0.536 Test Loss: 3.230 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.14949345588684
Epoch: 6, Steps: 17 | Train Loss: 0.602 Vali Loss: 4.936 Vali Acc: 0.526 Test Loss: 4.936 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.392773389816284
Epoch: 7, Steps: 17 | Train Loss: 0.526 Vali Loss: 2.937 Vali Acc: 0.611 Test Loss: 2.937 Test Acc: 0.611
Validation loss decreased (-0.552888 --> -0.610892).  Saving model ...
Epoch: 8 cost time: 15.292938947677612
Epoch: 8, Steps: 17 | Train Loss: 0.429 Vali Loss: 5.921 Vali Acc: 0.573 Test Loss: 5.921 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.38988184928894
Epoch: 9, Steps: 17 | Train Loss: 0.573 Vali Loss: 6.573 Vali Acc: 0.560 Test Loss: 6.573 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.98769783973694
Epoch: 10, Steps: 17 | Train Loss: 0.446 Vali Loss: 5.002 Vali Acc: 0.549 Test Loss: 5.002 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.724967002868652
Epoch: 11, Steps: 17 | Train Loss: 0.558 Vali Loss: 5.944 Vali Acc: 0.577 Test Loss: 5.944 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 16.252676010131836
Epoch: 12, Steps: 17 | Train Loss: 1.345 Vali Loss: 8.558 Vali Acc: 0.594 Test Loss: 8.558 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 14.027419567108154
Epoch: 13, Steps: 17 | Train Loss: 1.221 Vali Loss: 7.812 Vali Acc: 0.556 Test Loss: 7.812 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 16.15850067138672
Epoch: 14, Steps: 17 | Train Loss: 0.492 Vali Loss: 6.828 Vali Acc: 0.563 Test Loss: 6.828 Test Acc: 0.563
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 15.290495872497559
Epoch: 15, Steps: 17 | Train Loss: 1.571 Vali Loss: 7.120 Vali Acc: 0.587 Test Loss: 7.120 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 16.820695161819458
Epoch: 16, Steps: 17 | Train Loss: 0.671 Vali Loss: 12.739 Vali Acc: 0.546 Test Loss: 12.739 Test Acc: 0.546
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 15.09224009513855
Epoch: 17, Steps: 17 | Train Loss: 0.504 Vali Loss: 15.942 Vali Acc: 0.519 Test Loss: 15.942 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6109215017064846
model parameter : 14583298
model size : 75.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 27.818105936050415
Epoch: 1, Steps: 17 | Train Loss: 0.770 Vali Loss: 1.842 Vali Acc: 0.549 Test Loss: 1.842 Test Acc: 0.549
Validation loss decreased (inf --> -0.549470).  Saving model ...
Epoch: 2 cost time: 25.764198064804077
Epoch: 2, Steps: 17 | Train Loss: 0.584 Vali Loss: 1.872 Vali Acc: 0.642 Test Loss: 1.872 Test Acc: 0.642
Validation loss decreased (-0.549470 --> -0.641620).  Saving model ...
Epoch: 3 cost time: 27.902904748916626
Epoch: 3, Steps: 17 | Train Loss: 0.741 Vali Loss: 2.064 Vali Acc: 0.686 Test Loss: 2.064 Test Acc: 0.686
Validation loss decreased (-0.641620 --> -0.685986).  Saving model ...
Epoch: 4 cost time: 27.756303787231445
Epoch: 4, Steps: 17 | Train Loss: 1.054 Vali Loss: 5.954 Vali Acc: 0.560 Test Loss: 5.954 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.664246082305908
Epoch: 5, Steps: 17 | Train Loss: 1.699 Vali Loss: 3.108 Vali Acc: 0.597 Test Loss: 3.108 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.778335094451904
Epoch: 6, Steps: 17 | Train Loss: 2.892 Vali Loss: 8.200 Vali Acc: 0.604 Test Loss: 8.200 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 27.62571954727173
Epoch: 7, Steps: 17 | Train Loss: 1.441 Vali Loss: 16.190 Vali Acc: 0.529 Test Loss: 16.190 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 30.24492907524109
Epoch: 8, Steps: 17 | Train Loss: 4.477 Vali Loss: 18.330 Vali Acc: 0.526 Test Loss: 18.330 Test Acc: 0.526
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 26.38817310333252
Epoch: 9, Steps: 17 | Train Loss: 1.503 Vali Loss: 13.984 Vali Acc: 0.546 Test Loss: 13.984 Test Acc: 0.546
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 26.10104727745056
Epoch: 10, Steps: 17 | Train Loss: 0.550 Vali Loss: 5.999 Vali Acc: 0.659 Test Loss: 5.999 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 29.220940113067627
Epoch: 11, Steps: 17 | Train Loss: 0.509 Vali Loss: 8.225 Vali Acc: 0.638 Test Loss: 8.225 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 29.96963357925415
Epoch: 12, Steps: 17 | Train Loss: 0.274 Vali Loss: 7.267 Vali Acc: 0.645 Test Loss: 7.267 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 28.170058488845825
Epoch: 13, Steps: 17 | Train Loss: 0.589 Vali Loss: 9.775 Vali Acc: 0.645 Test Loss: 9.775 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6860068259385665
model parameter : 13010434
model size : 69.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 26.306716442108154
Epoch: 1, Steps: 17 | Train Loss: 0.834 Vali Loss: 0.895 Vali Acc: 0.604 Test Loss: 0.895 Test Acc: 0.604
Validation loss decreased (inf --> -0.604087).  Saving model ...
Epoch: 2 cost time: 23.936389446258545
Epoch: 2, Steps: 17 | Train Loss: 0.538 Vali Loss: 1.242 Vali Acc: 0.645 Test Loss: 1.242 Test Acc: 0.645
Validation loss decreased (-0.604087 --> -0.645039).  Saving model ...
Epoch: 3 cost time: 17.6816885471344
Epoch: 3, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.936 Vali Acc: 0.590 Test Loss: 2.936 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.872796297073364
Epoch: 4, Steps: 17 | Train Loss: 0.462 Vali Loss: 8.365 Vali Acc: 0.519 Test Loss: 8.365 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.066625356674194
Epoch: 5, Steps: 17 | Train Loss: 3.290 Vali Loss: 2.359 Vali Acc: 0.659 Test Loss: 2.359 Test Acc: 0.659
Validation loss decreased (-0.645039 --> -0.658679).  Saving model ...
Epoch: 6 cost time: 24.307328701019287
Epoch: 6, Steps: 17 | Train Loss: 1.415 Vali Loss: 6.175 Vali Acc: 0.597 Test Loss: 6.175 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 25.515188217163086
Epoch: 7, Steps: 17 | Train Loss: 1.036 Vali Loss: 10.823 Vali Acc: 0.529 Test Loss: 10.823 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.912925481796265
Epoch: 8, Steps: 17 | Train Loss: 0.483 Vali Loss: 8.010 Vali Acc: 0.587 Test Loss: 8.010 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 22.86254334449768
Epoch: 9, Steps: 17 | Train Loss: 0.962 Vali Loss: 5.127 Vali Acc: 0.597 Test Loss: 5.127 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 24.94598150253296
Epoch: 10, Steps: 17 | Train Loss: 0.669 Vali Loss: 7.079 Vali Acc: 0.645 Test Loss: 7.079 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 24.51950430870056
Epoch: 11, Steps: 17 | Train Loss: 1.066 Vali Loss: 6.459 Vali Acc: 0.604 Test Loss: 6.459 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 25.544561624526978
Epoch: 12, Steps: 17 | Train Loss: 0.780 Vali Loss: 12.474 Vali Acc: 0.590 Test Loss: 12.474 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 24.60492753982544
Epoch: 13, Steps: 17 | Train Loss: 1.644 Vali Loss: 11.790 Vali Acc: 0.618 Test Loss: 11.790 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 26.54069995880127
Epoch: 14, Steps: 17 | Train Loss: 0.600 Vali Loss: 12.241 Vali Acc: 0.635 Test Loss: 12.241 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 28.03264546394348
Epoch: 15, Steps: 17 | Train Loss: 0.419 Vali Loss: 14.502 Vali Acc: 0.628 Test Loss: 14.502 Test Acc: 0.628
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.658703071672355
model parameter : 13010434
model size : 69.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 20.952645301818848
Epoch: 1, Steps: 17 | Train Loss: 0.815 Vali Loss: 1.452 Vali Acc: 0.549 Test Loss: 1.452 Test Acc: 0.549
Validation loss decreased (inf --> -0.549474).  Saving model ...
Epoch: 2 cost time: 20.270909309387207
Epoch: 2, Steps: 17 | Train Loss: 0.481 Vali Loss: 2.250 Vali Acc: 0.553 Test Loss: 2.250 Test Acc: 0.553
Validation loss decreased (-0.549474 --> -0.552879).  Saving model ...
Epoch: 3 cost time: 22.100489616394043
Epoch: 3, Steps: 17 | Train Loss: 0.514 Vali Loss: 1.962 Vali Acc: 0.587 Test Loss: 1.962 Test Acc: 0.587
Validation loss decreased (-0.552879 --> -0.587011).  Saving model ...
Epoch: 4 cost time: 19.752803564071655
Epoch: 4, Steps: 17 | Train Loss: 0.777 Vali Loss: 8.809 Vali Acc: 0.505 Test Loss: 8.809 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.22545862197876
Epoch: 5, Steps: 17 | Train Loss: 1.902 Vali Loss: 3.270 Vali Acc: 0.628 Test Loss: 3.270 Test Acc: 0.628
Validation loss decreased (-0.587011 --> -0.627954).  Saving model ...
Epoch: 6 cost time: 20.72545075416565
Epoch: 6, Steps: 17 | Train Loss: 0.811 Vali Loss: 4.094 Vali Acc: 0.652 Test Loss: 4.094 Test Acc: 0.652
Validation loss decreased (-0.627954 --> -0.651836).  Saving model ...
Epoch: 7 cost time: 20.165589094161987
Epoch: 7, Steps: 17 | Train Loss: 0.575 Vali Loss: 8.455 Vali Acc: 0.580 Test Loss: 8.455 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.39468264579773
Epoch: 8, Steps: 17 | Train Loss: 0.544 Vali Loss: 5.806 Vali Acc: 0.539 Test Loss: 5.806 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 21.996063709259033
Epoch: 9, Steps: 17 | Train Loss: 0.750 Vali Loss: 12.088 Vali Acc: 0.563 Test Loss: 12.088 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 21.719637632369995
Epoch: 10, Steps: 17 | Train Loss: 0.535 Vali Loss: 7.414 Vali Acc: 0.625 Test Loss: 7.414 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 20.27737784385681
Epoch: 11, Steps: 17 | Train Loss: 0.811 Vali Loss: 7.486 Vali Acc: 0.594 Test Loss: 7.486 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 20.192425966262817
Epoch: 12, Steps: 17 | Train Loss: 0.413 Vali Loss: 15.289 Vali Acc: 0.573 Test Loss: 15.289 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 23.318618535995483
Epoch: 13, Steps: 17 | Train Loss: 0.869 Vali Loss: 11.640 Vali Acc: 0.625 Test Loss: 11.640 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 23.375917196273804
Epoch: 14, Steps: 17 | Train Loss: 0.469 Vali Loss: 11.102 Vali Acc: 0.611 Test Loss: 11.102 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 23.60661220550537
Epoch: 15, Steps: 17 | Train Loss: 0.615 Vali Loss: 21.476 Vali Acc: 0.546 Test Loss: 21.476 Test Acc: 0.546
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 21.485792875289917
Epoch: 16, Steps: 17 | Train Loss: 0.940 Vali Loss: 14.457 Vali Acc: 0.601 Test Loss: 14.457 Test Acc: 0.601
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6518771331058021
model parameter : 13010434
model size : 69.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 15.928327322006226
Epoch: 1, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.265 Vali Acc: 0.536 Test Loss: 1.265 Test Acc: 0.536
Validation loss decreased (inf --> -0.535824).  Saving model ...
Epoch: 2 cost time: 18.438918828964233
Epoch: 2, Steps: 17 | Train Loss: 0.537 Vali Loss: 2.957 Vali Acc: 0.543 Test Loss: 2.957 Test Acc: 0.543
Validation loss decreased (-0.535824 --> -0.542633).  Saving model ...
Epoch: 3 cost time: 19.28919792175293
Epoch: 3, Steps: 17 | Train Loss: 0.600 Vali Loss: 2.334 Vali Acc: 0.546 Test Loss: 2.334 Test Acc: 0.546
Validation loss decreased (-0.542633 --> -0.546052).  Saving model ...
Epoch: 4 cost time: 17.197062253952026
Epoch: 4, Steps: 17 | Train Loss: 0.829 Vali Loss: 5.079 Vali Acc: 0.539 Test Loss: 5.079 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.631298542022705
Epoch: 5, Steps: 17 | Train Loss: 0.386 Vali Loss: 7.442 Vali Acc: 0.529 Test Loss: 7.442 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.265552520751953
Epoch: 6, Steps: 17 | Train Loss: 0.456 Vali Loss: 4.999 Vali Acc: 0.580 Test Loss: 4.999 Test Acc: 0.580
Validation loss decreased (-0.546052 --> -0.580155).  Saving model ...
Epoch: 7 cost time: 20.137938737869263
Epoch: 7, Steps: 17 | Train Loss: 0.238 Vali Loss: 9.680 Vali Acc: 0.539 Test Loss: 9.680 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.854800939559937
Epoch: 8, Steps: 17 | Train Loss: 0.463 Vali Loss: 5.903 Vali Acc: 0.573 Test Loss: 5.903 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.42457127571106
Epoch: 9, Steps: 17 | Train Loss: 0.240 Vali Loss: 5.733 Vali Acc: 0.618 Test Loss: 5.733 Test Acc: 0.618
Validation loss decreased (-0.580155 --> -0.617690).  Saving model ...
Epoch: 10 cost time: 18.8633816242218
Epoch: 10, Steps: 17 | Train Loss: 0.629 Vali Loss: 6.519 Vali Acc: 0.608 Test Loss: 6.519 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.456823110580444
Epoch: 11, Steps: 17 | Train Loss: 0.763 Vali Loss: 7.223 Vali Acc: 0.573 Test Loss: 7.223 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 20.12685775756836
Epoch: 12, Steps: 17 | Train Loss: 0.303 Vali Loss: 8.170 Vali Acc: 0.584 Test Loss: 8.170 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 19.535930633544922
Epoch: 13, Steps: 17 | Train Loss: 0.301 Vali Loss: 12.132 Vali Acc: 0.573 Test Loss: 12.132 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 20.66824769973755
Epoch: 14, Steps: 17 | Train Loss: 0.563 Vali Loss: 10.409 Vali Acc: 0.597 Test Loss: 10.409 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.227839708328247
Epoch: 15, Steps: 17 | Train Loss: 0.768 Vali Loss: 11.592 Vali Acc: 0.597 Test Loss: 11.592 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 18.477388858795166
Epoch: 16, Steps: 17 | Train Loss: 0.431 Vali Loss: 10.029 Vali Acc: 0.628 Test Loss: 10.029 Test Acc: 0.628
Validation loss decreased (-0.617690 --> -0.627886).  Saving model ...
Epoch: 17 cost time: 20.026694774627686
Epoch: 17, Steps: 17 | Train Loss: 0.649 Vali Loss: 17.020 Vali Acc: 0.577 Test Loss: 17.020 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 22.278721570968628
Epoch: 18, Steps: 17 | Train Loss: 1.123 Vali Loss: 26.620 Vali Acc: 0.549 Test Loss: 26.620 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 20.06274938583374
Epoch: 19, Steps: 17 | Train Loss: 0.807 Vali Loss: 14.169 Vali Acc: 0.590 Test Loss: 14.169 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 21.172364473342896
Epoch: 20, Steps: 17 | Train Loss: 0.945 Vali Loss: 19.531 Vali Acc: 0.580 Test Loss: 19.531 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 19.564008474349976
Epoch: 21, Steps: 17 | Train Loss: 0.315 Vali Loss: 38.054 Vali Acc: 0.532 Test Loss: 38.054 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 21.918683290481567
Epoch: 22, Steps: 17 | Train Loss: 0.739 Vali Loss: 16.759 Vali Acc: 0.621 Test Loss: 16.759 Test Acc: 0.621
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 21.173977851867676
Epoch: 23, Steps: 17 | Train Loss: 1.381 Vali Loss: 40.275 Vali Acc: 0.549 Test Loss: 40.275 Test Acc: 0.549
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 19.65194845199585
Epoch: 24, Steps: 17 | Train Loss: 1.007 Vali Loss: 19.037 Vali Acc: 0.608 Test Loss: 19.037 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 20.84917140007019
Epoch: 25, Steps: 17 | Train Loss: 0.715 Vali Loss: 37.077 Vali Acc: 0.529 Test Loss: 37.077 Test Acc: 0.529
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 18.67322540283203
Epoch: 26, Steps: 17 | Train Loss: 1.034 Vali Loss: 21.690 Vali Acc: 0.556 Test Loss: 21.690 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6279863481228669
model parameter : 13010434
model size : 69.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 17.6999089717865
Epoch: 1, Steps: 17 | Train Loss: 0.778 Vali Loss: 1.520 Vali Acc: 0.532 Test Loss: 1.520 Test Acc: 0.532
Validation loss decreased (inf --> -0.532408).  Saving model ...
Epoch: 2 cost time: 14.608001708984375
Epoch: 2, Steps: 17 | Train Loss: 0.615 Vali Loss: 3.547 Vali Acc: 0.532 Test Loss: 3.547 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.58608865737915
Epoch: 3, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.918 Vali Acc: 0.611 Test Loss: 1.918 Test Acc: 0.611
Validation loss decreased (-0.532408 --> -0.610902).  Saving model ...
Epoch: 4 cost time: 15.034704446792603
Epoch: 4, Steps: 17 | Train Loss: 1.651 Vali Loss: 3.173 Vali Acc: 0.631 Test Loss: 3.173 Test Acc: 0.631
Validation loss decreased (-0.610902 --> -0.631368).  Saving model ...
Epoch: 5 cost time: 16.005406618118286
Epoch: 5, Steps: 17 | Train Loss: 0.873 Vali Loss: 6.440 Vali Acc: 0.546 Test Loss: 6.440 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.765951156616211
Epoch: 6, Steps: 17 | Train Loss: 0.404 Vali Loss: 4.302 Vali Acc: 0.611 Test Loss: 4.302 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.907257318496704
Epoch: 7, Steps: 17 | Train Loss: 0.601 Vali Loss: 4.241 Vali Acc: 0.573 Test Loss: 4.241 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 16.412973880767822
Epoch: 8, Steps: 17 | Train Loss: 0.928 Vali Loss: 4.498 Vali Acc: 0.625 Test Loss: 4.498 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 17.03855609893799
Epoch: 9, Steps: 17 | Train Loss: 1.183 Vali Loss: 8.636 Vali Acc: 0.573 Test Loss: 8.636 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 15.15797758102417
Epoch: 10, Steps: 17 | Train Loss: 0.378 Vali Loss: 7.004 Vali Acc: 0.628 Test Loss: 7.004 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 15.257915258407593
Epoch: 11, Steps: 17 | Train Loss: 0.796 Vali Loss: 10.039 Vali Acc: 0.594 Test Loss: 10.039 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 15.609807968139648
Epoch: 12, Steps: 17 | Train Loss: 0.804 Vali Loss: 22.832 Vali Acc: 0.536 Test Loss: 22.832 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 16.922552824020386
Epoch: 13, Steps: 17 | Train Loss: 1.318 Vali Loss: 9.138 Vali Acc: 0.614 Test Loss: 9.138 Test Acc: 0.614
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 16.4767062664032
Epoch: 14, Steps: 17 | Train Loss: 1.453 Vali Loss: 12.459 Vali Acc: 0.608 Test Loss: 12.459 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6313993174061433
model parameter : 13010434
model size : 69.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 16.314242601394653
Epoch: 1, Steps: 17 | Train Loss: 0.767 Vali Loss: 1.782 Vali Acc: 0.522 Test Loss: 1.782 Test Acc: 0.522
Validation loss decreased (inf --> -0.522166).  Saving model ...
Epoch: 2 cost time: 14.435601949691772
Epoch: 2, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.463 Vali Acc: 0.614 Test Loss: 1.463 Test Acc: 0.614
Validation loss decreased (-0.522166 --> -0.614320).  Saving model ...
Epoch: 3 cost time: 13.899336338043213
Epoch: 3, Steps: 17 | Train Loss: 0.530 Vali Loss: 2.652 Vali Acc: 0.529 Test Loss: 2.652 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.343982458114624
Epoch: 4, Steps: 17 | Train Loss: 0.571 Vali Loss: 2.577 Vali Acc: 0.604 Test Loss: 2.577 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.497066974639893
Epoch: 5, Steps: 17 | Train Loss: 0.537 Vali Loss: 5.219 Vali Acc: 0.539 Test Loss: 5.219 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.17285919189453
Epoch: 6, Steps: 17 | Train Loss: 0.584 Vali Loss: 4.471 Vali Acc: 0.590 Test Loss: 4.471 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.6942138671875
Epoch: 7, Steps: 17 | Train Loss: 1.793 Vali Loss: 11.939 Vali Acc: 0.502 Test Loss: 11.939 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.38167929649353
Epoch: 8, Steps: 17 | Train Loss: 0.829 Vali Loss: 8.521 Vali Acc: 0.536 Test Loss: 8.521 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 14.353358745574951
Epoch: 9, Steps: 17 | Train Loss: 0.313 Vali Loss: 7.303 Vali Acc: 0.570 Test Loss: 7.303 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.817342042922974
Epoch: 10, Steps: 17 | Train Loss: 0.401 Vali Loss: 6.087 Vali Acc: 0.597 Test Loss: 6.087 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 15.71084475517273
Epoch: 11, Steps: 17 | Train Loss: 0.861 Vali Loss: 8.751 Vali Acc: 0.567 Test Loss: 8.751 Test Acc: 0.567
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 15.230366945266724
Epoch: 12, Steps: 17 | Train Loss: 0.924 Vali Loss: 16.972 Vali Acc: 0.519 Test Loss: 16.972 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6143344709897611
model parameter : 13010434
model size : 69.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 17.64259123802185
Epoch: 1, Steps: 17 | Train Loss: 0.755 Vali Loss: 1.580 Vali Acc: 0.515 Test Loss: 1.580 Test Acc: 0.515
Validation loss decreased (inf --> -0.515343).  Saving model ...
Epoch: 2 cost time: 12.773763418197632
Epoch: 2, Steps: 17 | Train Loss: 0.725 Vali Loss: 3.203 Vali Acc: 0.519 Test Loss: 3.203 Test Acc: 0.519
Validation loss decreased (-0.515343 --> -0.518739).  Saving model ...
Epoch: 3 cost time: 14.24939227104187
Epoch: 3, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.340 Vali Acc: 0.580 Test Loss: 2.340 Test Acc: 0.580
Validation loss decreased (-0.518739 --> -0.580181).  Saving model ...
Epoch: 4 cost time: 13.815829515457153
Epoch: 4, Steps: 17 | Train Loss: 0.869 Vali Loss: 2.901 Vali Acc: 0.556 Test Loss: 2.901 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.376847505569458
Epoch: 5, Steps: 17 | Train Loss: 0.385 Vali Loss: 2.905 Vali Acc: 0.584 Test Loss: 2.905 Test Acc: 0.584
Validation loss decreased (-0.580181 --> -0.583589).  Saving model ...
Epoch: 6 cost time: 13.471435308456421
Epoch: 6, Steps: 17 | Train Loss: 2.350 Vali Loss: 5.145 Vali Acc: 0.539 Test Loss: 5.145 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.876975059509277
Epoch: 7, Steps: 17 | Train Loss: 1.413 Vali Loss: 6.891 Vali Acc: 0.543 Test Loss: 6.891 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.822427749633789
Epoch: 8, Steps: 17 | Train Loss: 0.981 Vali Loss: 5.511 Vali Acc: 0.543 Test Loss: 5.511 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.529791831970215
Epoch: 9, Steps: 17 | Train Loss: 0.527 Vali Loss: 6.533 Vali Acc: 0.529 Test Loss: 6.533 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.303391218185425
Epoch: 10, Steps: 17 | Train Loss: 0.425 Vali Loss: 5.676 Vali Acc: 0.570 Test Loss: 5.676 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 14.090123653411865
Epoch: 11, Steps: 17 | Train Loss: 0.824 Vali Loss: 7.616 Vali Acc: 0.556 Test Loss: 7.616 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.629814863204956
Epoch: 12, Steps: 17 | Train Loss: 1.231 Vali Loss: 9.175 Vali Acc: 0.560 Test Loss: 9.175 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 13.201936721801758
Epoch: 13, Steps: 17 | Train Loss: 0.602 Vali Loss: 12.261 Vali Acc: 0.567 Test Loss: 12.261 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.183897972106934
Epoch: 14, Steps: 17 | Train Loss: 0.701 Vali Loss: 12.576 Vali Acc: 0.553 Test Loss: 12.576 Test Acc: 0.553
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 14.653733015060425
Epoch: 15, Steps: 17 | Train Loss: 0.380 Vali Loss: 13.111 Vali Acc: 0.553 Test Loss: 13.111 Test Acc: 0.553
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5836177474402731
model parameter : 13010434
model size : 69.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 16.533456325531006
Epoch: 1, Steps: 17 | Train Loss: 0.727 Vali Loss: 1.456 Vali Acc: 0.498 Test Loss: 1.456 Test Acc: 0.498
Validation loss decreased (inf --> -0.498279).  Saving model ...
Epoch: 2 cost time: 13.607060432434082
Epoch: 2, Steps: 17 | Train Loss: 0.591 Vali Loss: 1.498 Vali Acc: 0.536 Test Loss: 1.498 Test Acc: 0.536
Validation loss decreased (-0.498279 --> -0.535821).  Saving model ...
Epoch: 3 cost time: 12.703019618988037
Epoch: 3, Steps: 17 | Train Loss: 0.410 Vali Loss: 2.041 Vali Acc: 0.529 Test Loss: 2.041 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.023059368133545
Epoch: 4, Steps: 17 | Train Loss: 1.480 Vali Loss: 2.342 Vali Acc: 0.553 Test Loss: 2.342 Test Acc: 0.553
Validation loss decreased (-0.535821 --> -0.552878).  Saving model ...
Epoch: 5 cost time: 13.242634296417236
Epoch: 5, Steps: 17 | Train Loss: 1.660 Vali Loss: 3.057 Vali Acc: 0.543 Test Loss: 3.057 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.55609655380249
Epoch: 6, Steps: 17 | Train Loss: 1.316 Vali Loss: 4.604 Vali Acc: 0.539 Test Loss: 4.604 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.063417673110962
Epoch: 7, Steps: 17 | Train Loss: 0.700 Vali Loss: 5.347 Vali Acc: 0.522 Test Loss: 5.347 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.58274793624878
Epoch: 8, Steps: 17 | Train Loss: 0.561 Vali Loss: 4.915 Vali Acc: 0.529 Test Loss: 4.915 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.9794282913208
Epoch: 9, Steps: 17 | Train Loss: 0.262 Vali Loss: 8.436 Vali Acc: 0.519 Test Loss: 8.436 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.144384622573853
Epoch: 10, Steps: 17 | Train Loss: 0.388 Vali Loss: 5.075 Vali Acc: 0.549 Test Loss: 5.075 Test Acc: 0.549
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.762698411941528
Epoch: 11, Steps: 17 | Train Loss: 0.662 Vali Loss: 8.788 Vali Acc: 0.522 Test Loss: 8.788 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 13.32146406173706
Epoch: 12, Steps: 17 | Train Loss: 1.218 Vali Loss: 8.809 Vali Acc: 0.512 Test Loss: 8.809 Test Acc: 0.512
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 15.097656726837158
Epoch: 13, Steps: 17 | Train Loss: 1.021 Vali Loss: 10.058 Vali Acc: 0.526 Test Loss: 10.058 Test Acc: 0.526
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 14.673737049102783
Epoch: 14, Steps: 17 | Train Loss: 0.573 Vali Loss: 12.889 Vali Acc: 0.529 Test Loss: 12.889 Test Acc: 0.529
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.552901023890785
model parameter : 13010434
model size : 69.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 14.344453573226929
Epoch: 1, Steps: 17 | Train Loss: 0.702 Vali Loss: 2.415 Vali Acc: 0.502 Test Loss: 2.415 Test Acc: 0.502
Validation loss decreased (inf --> -0.501682).  Saving model ...
Epoch: 2 cost time: 14.954830169677734
Epoch: 2, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.793 Vali Acc: 0.536 Test Loss: 0.793 Test Acc: 0.536
Validation loss decreased (-0.501682 --> -0.535828).  Saving model ...
Epoch: 3 cost time: 13.991429567337036
Epoch: 3, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.845 Vali Acc: 0.570 Test Loss: 0.845 Test Acc: 0.570
Validation loss decreased (-0.535828 --> -0.569957).  Saving model ...
Epoch: 4 cost time: 12.902709484100342
Epoch: 4, Steps: 17 | Train Loss: 0.382 Vali Loss: 1.437 Vali Acc: 0.539 Test Loss: 1.437 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.264241933822632
Epoch: 5, Steps: 17 | Train Loss: 0.831 Vali Loss: 1.636 Vali Acc: 0.563 Test Loss: 1.636 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.237152576446533
Epoch: 6, Steps: 17 | Train Loss: 0.446 Vali Loss: 1.181 Vali Acc: 0.597 Test Loss: 1.181 Test Acc: 0.597
Validation loss decreased (-0.569957 --> -0.597258).  Saving model ...
Epoch: 7 cost time: 15.218189239501953
Epoch: 7, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.392 Vali Acc: 0.590 Test Loss: 1.392 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.524839162826538
Epoch: 8, Steps: 17 | Train Loss: 0.424 Vali Loss: 2.402 Vali Acc: 0.536 Test Loss: 2.402 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.301374673843384
Epoch: 9, Steps: 17 | Train Loss: 1.465 Vali Loss: 2.980 Vali Acc: 0.509 Test Loss: 2.980 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 15.034589529037476
Epoch: 10, Steps: 17 | Train Loss: 1.197 Vali Loss: 3.286 Vali Acc: 0.563 Test Loss: 3.286 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.65549111366272
Epoch: 11, Steps: 17 | Train Loss: 1.661 Vali Loss: 4.646 Vali Acc: 0.532 Test Loss: 4.646 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.592763662338257
Epoch: 12, Steps: 17 | Train Loss: 1.860 Vali Loss: 11.435 Vali Acc: 0.498 Test Loss: 11.435 Test Acc: 0.498
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 14.524291276931763
Epoch: 13, Steps: 17 | Train Loss: 0.752 Vali Loss: 2.849 Vali Acc: 0.577 Test Loss: 2.849 Test Acc: 0.577
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 14.778870582580566
Epoch: 14, Steps: 17 | Train Loss: 0.744 Vali Loss: 3.706 Vali Acc: 0.580 Test Loss: 3.706 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 15.516819953918457
Epoch: 15, Steps: 17 | Train Loss: 0.336 Vali Loss: 8.238 Vali Acc: 0.522 Test Loss: 8.238 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 14.85779333114624
Epoch: 16, Steps: 17 | Train Loss: 0.831 Vali Loss: 5.729 Vali Acc: 0.515 Test Loss: 5.729 Test Acc: 0.515
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5972696245733788
model parameter : 13010434
model size : 69.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 15.634639263153076
Epoch: 1, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.027 Vali Acc: 0.502 Test Loss: 2.027 Test Acc: 0.502
Validation loss decreased (inf --> -0.501686).  Saving model ...
Epoch: 2 cost time: 15.64993143081665
Epoch: 2, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.901 Vali Acc: 0.549 Test Loss: 0.901 Test Acc: 0.549
Validation loss decreased (-0.501686 --> -0.549479).  Saving model ...
Epoch: 3 cost time: 15.008687257766724
Epoch: 3, Steps: 17 | Train Loss: 0.533 Vali Loss: 1.015 Vali Acc: 0.543 Test Loss: 1.015 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.191339254379272
Epoch: 4, Steps: 17 | Train Loss: 0.839 Vali Loss: 4.706 Vali Acc: 0.509 Test Loss: 4.706 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.679954051971436
Epoch: 5, Steps: 17 | Train Loss: 1.511 Vali Loss: 3.338 Vali Acc: 0.587 Test Loss: 3.338 Test Acc: 0.587
Validation loss decreased (-0.549479 --> -0.586997).  Saving model ...
Epoch: 6 cost time: 14.537131071090698
Epoch: 6, Steps: 17 | Train Loss: 0.796 Vali Loss: 4.028 Vali Acc: 0.560 Test Loss: 4.028 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.253274202346802
Epoch: 7, Steps: 17 | Train Loss: 0.599 Vali Loss: 3.343 Vali Acc: 0.577 Test Loss: 3.343 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.115599393844604
Epoch: 8, Steps: 17 | Train Loss: 0.522 Vali Loss: 4.927 Vali Acc: 0.560 Test Loss: 4.927 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.658442497253418
Epoch: 9, Steps: 17 | Train Loss: 0.454 Vali Loss: 6.714 Vali Acc: 0.505 Test Loss: 6.714 Test Acc: 0.505
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.864230871200562
Epoch: 10, Steps: 17 | Train Loss: 0.402 Vali Loss: 6.253 Vali Acc: 0.512 Test Loss: 6.253 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.492766857147217
Epoch: 11, Steps: 17 | Train Loss: 0.818 Vali Loss: 6.512 Vali Acc: 0.549 Test Loss: 6.512 Test Acc: 0.549
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.782705545425415
Epoch: 12, Steps: 17 | Train Loss: 0.384 Vali Loss: 7.096 Vali Acc: 0.570 Test Loss: 7.096 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.434905052185059
Epoch: 13, Steps: 17 | Train Loss: 0.663 Vali Loss: 8.187 Vali Acc: 0.563 Test Loss: 8.187 Test Acc: 0.563
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.886414766311646
Epoch: 14, Steps: 17 | Train Loss: 0.593 Vali Loss: 9.681 Vali Acc: 0.570 Test Loss: 9.681 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 14.539042949676514
Epoch: 15, Steps: 17 | Train Loss: 0.896 Vali Loss: 9.203 Vali Acc: 0.549 Test Loss: 9.203 Test Acc: 0.549
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5870307167235495
model parameter : 13010434
model size : 69.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 29.788103818893433
Epoch: 1, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.079 Vali Acc: 0.604 Test Loss: 1.079 Test Acc: 0.604
Validation loss decreased (inf --> -0.604085).  Saving model ...
Epoch: 2 cost time: 25.92965817451477
Epoch: 2, Steps: 17 | Train Loss: 0.849 Vali Loss: 1.756 Vali Acc: 0.638 Test Loss: 1.756 Test Acc: 0.638
Validation loss decreased (-0.604085 --> -0.638208).  Saving model ...
Epoch: 3 cost time: 24.529764413833618
Epoch: 3, Steps: 17 | Train Loss: 0.552 Vali Loss: 2.479 Vali Acc: 0.594 Test Loss: 2.479 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.87773036956787
Epoch: 4, Steps: 17 | Train Loss: 0.937 Vali Loss: 3.208 Vali Acc: 0.601 Test Loss: 3.208 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 28.851669788360596
Epoch: 5, Steps: 17 | Train Loss: 0.906 Vali Loss: 7.246 Vali Acc: 0.546 Test Loss: 7.246 Test Acc: 0.546
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 26.63253402709961
Epoch: 6, Steps: 17 | Train Loss: 2.627 Vali Loss: 3.873 Vali Acc: 0.669 Test Loss: 3.873 Test Acc: 0.669
Validation loss decreased (-0.638208 --> -0.668903).  Saving model ...
Epoch: 7 cost time: 23.486951112747192
Epoch: 7, Steps: 17 | Train Loss: 0.782 Vali Loss: 4.542 Vali Acc: 0.679 Test Loss: 4.542 Test Acc: 0.679
Validation loss decreased (-0.668903 --> -0.679135).  Saving model ...
Epoch: 8 cost time: 26.70512056350708
Epoch: 8, Steps: 17 | Train Loss: 0.635 Vali Loss: 4.954 Vali Acc: 0.590 Test Loss: 4.954 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 27.402791261672974
Epoch: 9, Steps: 17 | Train Loss: 0.446 Vali Loss: 7.348 Vali Acc: 0.594 Test Loss: 7.348 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 26.368404626846313
Epoch: 10, Steps: 17 | Train Loss: 0.848 Vali Loss: 4.354 Vali Acc: 0.666 Test Loss: 4.354 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 23.8375883102417
Epoch: 11, Steps: 17 | Train Loss: 0.878 Vali Loss: 7.713 Vali Acc: 0.625 Test Loss: 7.713 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 28.12397027015686
Epoch: 12, Steps: 17 | Train Loss: 0.621 Vali Loss: 13.664 Vali Acc: 0.570 Test Loss: 13.664 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 22.611513376235962
Epoch: 13, Steps: 17 | Train Loss: 0.164 Vali Loss: 9.474 Vali Acc: 0.648 Test Loss: 9.474 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 27.27312970161438
Epoch: 14, Steps: 17 | Train Loss: 0.539 Vali Loss: 11.792 Vali Acc: 0.628 Test Loss: 11.792 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 27.508365392684937
Epoch: 15, Steps: 17 | Train Loss: 0.344 Vali Loss: 12.237 Vali Acc: 0.594 Test Loss: 12.237 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 25.404452323913574
Epoch: 16, Steps: 17 | Train Loss: 0.235 Vali Loss: 9.217 Vali Acc: 0.648 Test Loss: 9.217 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 28.46356463432312
Epoch: 17, Steps: 17 | Train Loss: 0.243 Vali Loss: 10.141 Vali Acc: 0.659 Test Loss: 10.141 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6791808873720137
model parameter : 12224002
model size : 66.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 25.17323613166809
Epoch: 1, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.316 Vali Acc: 0.556 Test Loss: 1.316 Test Acc: 0.556
Validation loss decreased (inf --> -0.556301).  Saving model ...
Epoch: 2 cost time: 20.679609775543213
Epoch: 2, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.486 Vali Acc: 0.648 Test Loss: 1.486 Test Acc: 0.648
Validation loss decreased (-0.556301 --> -0.648449).  Saving model ...
Epoch: 3 cost time: 22.96028709411621
Epoch: 3, Steps: 17 | Train Loss: 0.518 Vali Loss: 2.772 Vali Acc: 0.587 Test Loss: 2.772 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.981794595718384
Epoch: 4, Steps: 17 | Train Loss: 0.683 Vali Loss: 2.323 Vali Acc: 0.570 Test Loss: 2.323 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.478841543197632
Epoch: 5, Steps: 17 | Train Loss: 0.837 Vali Loss: 4.477 Vali Acc: 0.608 Test Loss: 4.477 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 21.800657987594604
Epoch: 6, Steps: 17 | Train Loss: 0.967 Vali Loss: 4.596 Vali Acc: 0.611 Test Loss: 4.596 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 19.411513090133667
Epoch: 7, Steps: 17 | Train Loss: 1.621 Vali Loss: 4.263 Vali Acc: 0.608 Test Loss: 4.263 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 23.032567501068115
Epoch: 8, Steps: 17 | Train Loss: 1.894 Vali Loss: 9.431 Vali Acc: 0.611 Test Loss: 9.431 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 22.93789052963257
Epoch: 9, Steps: 17 | Train Loss: 0.488 Vali Loss: 6.655 Vali Acc: 0.625 Test Loss: 6.655 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 22.53482747077942
Epoch: 10, Steps: 17 | Train Loss: 0.562 Vali Loss: 8.871 Vali Acc: 0.618 Test Loss: 8.871 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 20.972171545028687
Epoch: 11, Steps: 17 | Train Loss: 0.515 Vali Loss: 13.048 Vali Acc: 0.604 Test Loss: 13.048 Test Acc: 0.604
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 22.044646978378296
Epoch: 12, Steps: 17 | Train Loss: 0.453 Vali Loss: 13.362 Vali Acc: 0.580 Test Loss: 13.362 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6484641638225256
model parameter : 12224002
model size : 66.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 22.650476694107056
Epoch: 1, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.253 Vali Acc: 0.512 Test Loss: 1.253 Test Acc: 0.512
Validation loss decreased (inf --> -0.511933).  Saving model ...
Epoch: 2 cost time: 17.317594289779663
Epoch: 2, Steps: 17 | Train Loss: 0.642 Vali Loss: 3.300 Vali Acc: 0.536 Test Loss: 3.300 Test Acc: 0.536
Validation loss decreased (-0.511933 --> -0.535803).  Saving model ...
Epoch: 3 cost time: 20.509880781173706
Epoch: 3, Steps: 17 | Train Loss: 2.071 Vali Loss: 2.040 Vali Acc: 0.601 Test Loss: 2.040 Test Acc: 0.601
Validation loss decreased (-0.535803 --> -0.600662).  Saving model ...
Epoch: 4 cost time: 16.637160539627075
Epoch: 4, Steps: 17 | Train Loss: 1.769 Vali Loss: 6.273 Vali Acc: 0.509 Test Loss: 6.273 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.61036443710327
Epoch: 5, Steps: 17 | Train Loss: 3.044 Vali Loss: 11.367 Vali Acc: 0.519 Test Loss: 11.367 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.62100052833557
Epoch: 6, Steps: 17 | Train Loss: 1.600 Vali Loss: 3.871 Vali Acc: 0.594 Test Loss: 3.871 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 21.717912197113037
Epoch: 7, Steps: 17 | Train Loss: 2.618 Vali Loss: 11.822 Vali Acc: 0.536 Test Loss: 11.822 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 20.074243783950806
Epoch: 8, Steps: 17 | Train Loss: 1.049 Vali Loss: 12.007 Vali Acc: 0.539 Test Loss: 12.007 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 19.266316175460815
Epoch: 9, Steps: 17 | Train Loss: 0.928 Vali Loss: 8.204 Vali Acc: 0.567 Test Loss: 8.204 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 15.832410335540771
Epoch: 10, Steps: 17 | Train Loss: 1.390 Vali Loss: 6.442 Vali Acc: 0.597 Test Loss: 6.442 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 22.814836025238037
Epoch: 11, Steps: 17 | Train Loss: 2.283 Vali Loss: 20.495 Vali Acc: 0.536 Test Loss: 20.495 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 22.030747175216675
Epoch: 12, Steps: 17 | Train Loss: 2.851 Vali Loss: 8.397 Vali Acc: 0.614 Test Loss: 8.397 Test Acc: 0.614
Validation loss decreased (-0.600662 --> -0.614250).  Saving model ...
Epoch: 13 cost time: 21.36304807662964
Epoch: 13, Steps: 17 | Train Loss: 2.117 Vali Loss: 8.456 Vali Acc: 0.618 Test Loss: 8.456 Test Acc: 0.618
Validation loss decreased (-0.614250 --> -0.617663).  Saving model ...
Epoch: 14 cost time: 22.204713582992554
Epoch: 14, Steps: 17 | Train Loss: 0.371 Vali Loss: 11.827 Vali Acc: 0.621 Test Loss: 11.827 Test Acc: 0.621
Validation loss decreased (-0.617663 --> -0.621042).  Saving model ...
Epoch: 15 cost time: 20.626429796218872
Epoch: 15, Steps: 17 | Train Loss: 0.179 Vali Loss: 9.850 Vali Acc: 0.604 Test Loss: 9.850 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 22.48701786994934
Epoch: 16, Steps: 17 | Train Loss: 0.449 Vali Loss: 10.238 Vali Acc: 0.590 Test Loss: 10.238 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 20.539199829101562
Epoch: 17, Steps: 17 | Train Loss: 1.613 Vali Loss: 17.073 Vali Acc: 0.597 Test Loss: 17.073 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 22.724831342697144
Epoch: 18, Steps: 17 | Train Loss: 0.582 Vali Loss: 15.138 Vali Acc: 0.618 Test Loss: 15.138 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 22.289499044418335
Epoch: 19, Steps: 17 | Train Loss: 0.571 Vali Loss: 16.776 Vali Acc: 0.611 Test Loss: 16.776 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 25.02224063873291
Epoch: 20, Steps: 17 | Train Loss: 0.870 Vali Loss: 18.233 Vali Acc: 0.604 Test Loss: 18.233 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 24.49985957145691
Epoch: 21, Steps: 17 | Train Loss: 0.550 Vali Loss: 28.586 Vali Acc: 0.587 Test Loss: 28.586 Test Acc: 0.587
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 20.89663052558899
Epoch: 22, Steps: 17 | Train Loss: 0.730 Vali Loss: 23.059 Vali Acc: 0.635 Test Loss: 23.059 Test Acc: 0.635
Validation loss decreased (-0.621042 --> -0.634582).  Saving model ...
Epoch: 23 cost time: 23.4233980178833
Epoch: 23, Steps: 17 | Train Loss: 0.889 Vali Loss: 17.541 Vali Acc: 0.628 Test Loss: 17.541 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 18.57225012779236
Epoch: 24, Steps: 17 | Train Loss: 0.050 Vali Loss: 24.334 Vali Acc: 0.625 Test Loss: 24.334 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 24.17780351638794
Epoch: 25, Steps: 17 | Train Loss: 0.274 Vali Loss: 18.190 Vali Acc: 0.655 Test Loss: 18.190 Test Acc: 0.655
Validation loss decreased (-0.634582 --> -0.655108).  Saving model ...
Epoch: 26 cost time: 22.035430908203125
Epoch: 26, Steps: 17 | Train Loss: 0.374 Vali Loss: 16.255 Vali Acc: 0.642 Test Loss: 16.255 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 18.907220363616943
Epoch: 27, Steps: 17 | Train Loss: 0.230 Vali Loss: 17.429 Vali Acc: 0.642 Test Loss: 17.429 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 23.074811220169067
Epoch: 28, Steps: 17 | Train Loss: 0.405 Vali Loss: 23.107 Vali Acc: 0.536 Test Loss: 23.107 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 25.29565167427063
Epoch: 29, Steps: 17 | Train Loss: 1.312 Vali Loss: 47.108 Vali Acc: 0.543 Test Loss: 47.108 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 23.361705541610718
Epoch: 30, Steps: 17 | Train Loss: 3.173 Vali Loss: 25.088 Vali Acc: 0.618 Test Loss: 25.088 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 20.37355351448059
Epoch: 31, Steps: 17 | Train Loss: 4.832 Vali Loss: 21.087 Vali Acc: 0.645 Test Loss: 21.087 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 20.42190647125244
Epoch: 32, Steps: 17 | Train Loss: 0.168 Vali Loss: 24.592 Vali Acc: 0.628 Test Loss: 24.592 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 23.951672315597534
Epoch: 33, Steps: 17 | Train Loss: 0.996 Vali Loss: 43.793 Vali Acc: 0.587 Test Loss: 43.793 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 23.542285919189453
Epoch: 34, Steps: 17 | Train Loss: 1.642 Vali Loss: 25.079 Vali Acc: 0.604 Test Loss: 25.079 Test Acc: 0.604
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 21.57570195198059
Epoch: 35, Steps: 17 | Train Loss: 1.207 Vali Loss: 23.817 Vali Acc: 0.597 Test Loss: 23.817 Test Acc: 0.597
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6552901023890785
model parameter : 12224002
model size : 66.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 16.55013155937195
Epoch: 1, Steps: 17 | Train Loss: 1.188 Vali Loss: 0.865 Vali Acc: 0.608 Test Loss: 0.865 Test Acc: 0.608
Validation loss decreased (inf --> -0.607500).  Saving model ...
Epoch: 2 cost time: 17.600252389907837
Epoch: 2, Steps: 17 | Train Loss: 0.489 Vali Loss: 2.536 Vali Acc: 0.580 Test Loss: 2.536 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.63312005996704
Epoch: 3, Steps: 17 | Train Loss: 0.819 Vali Loss: 3.668 Vali Acc: 0.573 Test Loss: 3.668 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.832791328430176
Epoch: 4, Steps: 17 | Train Loss: 0.687 Vali Loss: 3.593 Vali Acc: 0.549 Test Loss: 3.593 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.863126516342163
Epoch: 5, Steps: 17 | Train Loss: 0.537 Vali Loss: 5.735 Vali Acc: 0.563 Test Loss: 5.735 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 16.441072940826416
Epoch: 6, Steps: 17 | Train Loss: 0.386 Vali Loss: 4.460 Vali Acc: 0.587 Test Loss: 4.460 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.204378604888916
Epoch: 7, Steps: 17 | Train Loss: 0.235 Vali Loss: 4.814 Vali Acc: 0.590 Test Loss: 4.814 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.76235580444336
Epoch: 8, Steps: 17 | Train Loss: 0.479 Vali Loss: 7.069 Vali Acc: 0.573 Test Loss: 7.069 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.615164756774902
Epoch: 9, Steps: 17 | Train Loss: 0.545 Vali Loss: 6.330 Vali Acc: 0.546 Test Loss: 6.330 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 18.948753595352173
Epoch: 10, Steps: 17 | Train Loss: 0.347 Vali Loss: 6.683 Vali Acc: 0.608 Test Loss: 6.683 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 18.66032338142395
Epoch: 11, Steps: 17 | Train Loss: 0.343 Vali Loss: 8.517 Vali Acc: 0.594 Test Loss: 8.517 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6075085324232082
model parameter : 12224002
model size : 66.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 15.274146318435669
Epoch: 1, Steps: 17 | Train Loss: 1.181 Vali Loss: 0.924 Vali Acc: 0.597 Test Loss: 0.924 Test Acc: 0.597
Validation loss decreased (inf --> -0.597260).  Saving model ...
Epoch: 2 cost time: 13.367871284484863
Epoch: 2, Steps: 17 | Train Loss: 0.576 Vali Loss: 2.226 Vali Acc: 0.573 Test Loss: 2.226 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.71461033821106
Epoch: 3, Steps: 17 | Train Loss: 0.529 Vali Loss: 2.086 Vali Acc: 0.577 Test Loss: 2.086 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.74804425239563
Epoch: 4, Steps: 17 | Train Loss: 1.342 Vali Loss: 2.324 Vali Acc: 0.631 Test Loss: 2.324 Test Acc: 0.631
Validation loss decreased (-0.597260 --> -0.631376).  Saving model ...
Epoch: 5 cost time: 16.02363395690918
Epoch: 5, Steps: 17 | Train Loss: 0.672 Vali Loss: 5.545 Vali Acc: 0.580 Test Loss: 5.545 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.583009719848633
Epoch: 6, Steps: 17 | Train Loss: 0.469 Vali Loss: 5.020 Vali Acc: 0.567 Test Loss: 5.020 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.479384660720825
Epoch: 7, Steps: 17 | Train Loss: 0.371 Vali Loss: 3.267 Vali Acc: 0.642 Test Loss: 3.267 Test Acc: 0.642
Validation loss decreased (-0.631376 --> -0.641606).  Saving model ...
Epoch: 8 cost time: 13.98194932937622
Epoch: 8, Steps: 17 | Train Loss: 0.790 Vali Loss: 8.564 Vali Acc: 0.577 Test Loss: 8.564 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.722370862960815
Epoch: 9, Steps: 17 | Train Loss: 0.536 Vali Loss: 9.236 Vali Acc: 0.560 Test Loss: 9.236 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.138093709945679
Epoch: 10, Steps: 17 | Train Loss: 0.697 Vali Loss: 6.562 Vali Acc: 0.604 Test Loss: 6.562 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.936673641204834
Epoch: 11, Steps: 17 | Train Loss: 0.157 Vali Loss: 10.227 Vali Acc: 0.553 Test Loss: 10.227 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 15.217774391174316
Epoch: 12, Steps: 17 | Train Loss: 0.421 Vali Loss: 7.501 Vali Acc: 0.628 Test Loss: 7.501 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 15.568791627883911
Epoch: 13, Steps: 17 | Train Loss: 1.125 Vali Loss: 6.303 Vali Acc: 0.642 Test Loss: 6.303 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 14.351064205169678
Epoch: 14, Steps: 17 | Train Loss: 2.753 Vali Loss: 12.507 Vali Acc: 0.584 Test Loss: 12.507 Test Acc: 0.584
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 14.373830318450928
Epoch: 15, Steps: 17 | Train Loss: 0.582 Vali Loss: 11.929 Vali Acc: 0.567 Test Loss: 11.929 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 15.400660276412964
Epoch: 16, Steps: 17 | Train Loss: 0.369 Vali Loss: 18.160 Vali Acc: 0.570 Test Loss: 18.160 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 14.297369718551636
Epoch: 17, Steps: 17 | Train Loss: 0.291 Vali Loss: 18.353 Vali Acc: 0.573 Test Loss: 18.353 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 12224002
model size : 66.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 16.49657893180847
Epoch: 1, Steps: 17 | Train Loss: 1.138 Vali Loss: 0.977 Vali Acc: 0.570 Test Loss: 0.977 Test Acc: 0.570
Validation loss decreased (inf --> -0.569956).  Saving model ...
Epoch: 2 cost time: 14.040563106536865
Epoch: 2, Steps: 17 | Train Loss: 0.783 Vali Loss: 2.223 Vali Acc: 0.543 Test Loss: 2.223 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.434818744659424
Epoch: 3, Steps: 17 | Train Loss: 0.739 Vali Loss: 3.934 Vali Acc: 0.505 Test Loss: 3.934 Test Acc: 0.505
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.416825771331787
Epoch: 4, Steps: 17 | Train Loss: 0.871 Vali Loss: 2.721 Vali Acc: 0.577 Test Loss: 2.721 Test Acc: 0.577
Validation loss decreased (-0.569956 --> -0.576765).  Saving model ...
Epoch: 5 cost time: 12.314477443695068
Epoch: 5, Steps: 17 | Train Loss: 0.926 Vali Loss: 4.394 Vali Acc: 0.553 Test Loss: 4.394 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.524519681930542
Epoch: 6, Steps: 17 | Train Loss: 0.792 Vali Loss: 6.602 Vali Acc: 0.549 Test Loss: 6.602 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.218829870223999
Epoch: 7, Steps: 17 | Train Loss: 1.002 Vali Loss: 4.126 Vali Acc: 0.587 Test Loss: 4.126 Test Acc: 0.587
Validation loss decreased (-0.576765 --> -0.586989).  Saving model ...
Epoch: 8 cost time: 14.708491802215576
Epoch: 8, Steps: 17 | Train Loss: 0.969 Vali Loss: 6.170 Vali Acc: 0.567 Test Loss: 6.170 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.653864860534668
Epoch: 9, Steps: 17 | Train Loss: 0.695 Vali Loss: 5.003 Vali Acc: 0.573 Test Loss: 5.003 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.561995267868042
Epoch: 10, Steps: 17 | Train Loss: 0.686 Vali Loss: 7.288 Vali Acc: 0.543 Test Loss: 7.288 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.666539669036865
Epoch: 11, Steps: 17 | Train Loss: 0.741 Vali Loss: 6.661 Vali Acc: 0.587 Test Loss: 6.661 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.229657173156738
Epoch: 12, Steps: 17 | Train Loss: 0.840 Vali Loss: 13.395 Vali Acc: 0.526 Test Loss: 13.395 Test Acc: 0.526
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 14.110787153244019
Epoch: 13, Steps: 17 | Train Loss: 0.621 Vali Loss: 9.887 Vali Acc: 0.553 Test Loss: 9.887 Test Acc: 0.553
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 15.173827171325684
Epoch: 14, Steps: 17 | Train Loss: 0.611 Vali Loss: 15.611 Vali Acc: 0.526 Test Loss: 15.611 Test Acc: 0.526
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 14.453835487365723
Epoch: 15, Steps: 17 | Train Loss: 1.457 Vali Loss: 13.222 Vali Acc: 0.529 Test Loss: 13.222 Test Acc: 0.529
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 14.966444253921509
Epoch: 16, Steps: 17 | Train Loss: 0.912 Vali Loss: 11.016 Vali Acc: 0.594 Test Loss: 11.016 Test Acc: 0.594
Validation loss decreased (-0.586989 --> -0.593746).  Saving model ...
Epoch: 17 cost time: 12.618762016296387
Epoch: 17, Steps: 17 | Train Loss: 0.503 Vali Loss: 10.123 Vali Acc: 0.604 Test Loss: 10.123 Test Acc: 0.604
Validation loss decreased (-0.593746 --> -0.603994).  Saving model ...
Epoch: 18 cost time: 12.96873664855957
Epoch: 18, Steps: 17 | Train Loss: 0.621 Vali Loss: 11.349 Vali Acc: 0.577 Test Loss: 11.349 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 14.070841550827026
Epoch: 19, Steps: 17 | Train Loss: 0.488 Vali Loss: 24.683 Vali Acc: 0.529 Test Loss: 24.683 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 14.956135511398315
Epoch: 20, Steps: 17 | Train Loss: 2.037 Vali Loss: 11.648 Vali Acc: 0.621 Test Loss: 11.648 Test Acc: 0.621
Validation loss decreased (-0.603994 --> -0.621044).  Saving model ...
Epoch: 21 cost time: 15.01050329208374
Epoch: 21, Steps: 17 | Train Loss: 0.760 Vali Loss: 22.229 Vali Acc: 0.577 Test Loss: 22.229 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 14.659498453140259
Epoch: 22, Steps: 17 | Train Loss: 0.683 Vali Loss: 16.340 Vali Acc: 0.590 Test Loss: 16.340 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 15.476154088973999
Epoch: 23, Steps: 17 | Train Loss: 0.879 Vali Loss: 15.853 Vali Acc: 0.573 Test Loss: 15.853 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 15.08586573600769
Epoch: 24, Steps: 17 | Train Loss: 0.382 Vali Loss: 18.261 Vali Acc: 0.549 Test Loss: 18.261 Test Acc: 0.549
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 12.712616920471191
Epoch: 25, Steps: 17 | Train Loss: 0.526 Vali Loss: 17.934 Vali Acc: 0.625 Test Loss: 17.934 Test Acc: 0.625
Validation loss decreased (-0.621044 --> -0.624394).  Saving model ...
Epoch: 26 cost time: 12.529184103012085
Epoch: 26, Steps: 17 | Train Loss: 0.352 Vali Loss: 17.260 Vali Acc: 0.611 Test Loss: 17.260 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 14.27932095527649
Epoch: 27, Steps: 17 | Train Loss: 0.576 Vali Loss: 27.343 Vali Acc: 0.546 Test Loss: 27.343 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 14.175324201583862
Epoch: 28, Steps: 17 | Train Loss: 0.177 Vali Loss: 18.878 Vali Acc: 0.590 Test Loss: 18.878 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 10.005317687988281
Epoch: 29, Steps: 17 | Train Loss: 0.851 Vali Loss: 32.673 Vali Acc: 0.543 Test Loss: 32.673 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 16.044848203659058
Epoch: 30, Steps: 17 | Train Loss: 0.363 Vali Loss: 18.964 Vali Acc: 0.590 Test Loss: 18.964 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 14.526824951171875
Epoch: 31, Steps: 17 | Train Loss: 0.250 Vali Loss: 23.978 Vali Acc: 0.594 Test Loss: 23.978 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 15.665068626403809
Epoch: 32, Steps: 17 | Train Loss: 0.058 Vali Loss: 22.812 Vali Acc: 0.597 Test Loss: 22.812 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 15.188400745391846
Epoch: 33, Steps: 17 | Train Loss: 0.391 Vali Loss: 28.110 Vali Acc: 0.567 Test Loss: 28.110 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 14.528167486190796
Epoch: 34, Steps: 17 | Train Loss: 0.275 Vali Loss: 29.813 Vali Acc: 0.577 Test Loss: 29.813 Test Acc: 0.577
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 16.10789918899536
Epoch: 35, Steps: 17 | Train Loss: 0.397 Vali Loss: 25.989 Vali Acc: 0.577 Test Loss: 25.989 Test Acc: 0.577
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 12224002
model size : 66.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 16.583558797836304
Epoch: 1, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.543 Vali Acc: 0.519 Test Loss: 1.543 Test Acc: 0.519
Validation loss decreased (inf --> -0.518756).  Saving model ...
Epoch: 2 cost time: 14.85628366470337
Epoch: 2, Steps: 17 | Train Loss: 0.897 Vali Loss: 3.436 Vali Acc: 0.519 Test Loss: 3.436 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.631978750228882
Epoch: 3, Steps: 17 | Train Loss: 1.076 Vali Loss: 3.607 Vali Acc: 0.515 Test Loss: 3.607 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.262946367263794
Epoch: 4, Steps: 17 | Train Loss: 0.920 Vali Loss: 4.356 Vali Acc: 0.539 Test Loss: 4.356 Test Acc: 0.539
Validation loss decreased (-0.518756 --> -0.539206).  Saving model ...
Epoch: 5 cost time: 15.251223802566528
Epoch: 5, Steps: 17 | Train Loss: 1.884 Vali Loss: 5.016 Vali Acc: 0.536 Test Loss: 5.016 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.43714189529419
Epoch: 6, Steps: 17 | Train Loss: 1.435 Vali Loss: 3.540 Vali Acc: 0.597 Test Loss: 3.540 Test Acc: 0.597
Validation loss decreased (-0.539206 --> -0.597234).  Saving model ...
Epoch: 7 cost time: 14.717864990234375
Epoch: 7, Steps: 17 | Train Loss: 0.865 Vali Loss: 3.969 Vali Acc: 0.577 Test Loss: 3.969 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.259726762771606
Epoch: 8, Steps: 17 | Train Loss: 0.683 Vali Loss: 5.904 Vali Acc: 0.532 Test Loss: 5.904 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.13422179222107
Epoch: 9, Steps: 17 | Train Loss: 0.921 Vali Loss: 5.047 Vali Acc: 0.587 Test Loss: 5.047 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.798011779785156
Epoch: 10, Steps: 17 | Train Loss: 0.421 Vali Loss: 9.320 Vali Acc: 0.522 Test Loss: 9.320 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 14.134782791137695
Epoch: 11, Steps: 17 | Train Loss: 0.834 Vali Loss: 6.433 Vali Acc: 0.560 Test Loss: 6.433 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.184930801391602
Epoch: 12, Steps: 17 | Train Loss: 1.448 Vali Loss: 12.344 Vali Acc: 0.532 Test Loss: 12.344 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 14.862698793411255
Epoch: 13, Steps: 17 | Train Loss: 0.970 Vali Loss: 8.054 Vali Acc: 0.549 Test Loss: 8.054 Test Acc: 0.549
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 15.080245971679688
Epoch: 14, Steps: 17 | Train Loss: 1.052 Vali Loss: 8.445 Vali Acc: 0.567 Test Loss: 8.445 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 13.827156066894531
Epoch: 15, Steps: 17 | Train Loss: 1.004 Vali Loss: 7.930 Vali Acc: 0.580 Test Loss: 7.930 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 14.243038415908813
Epoch: 16, Steps: 17 | Train Loss: 0.523 Vali Loss: 10.400 Vali Acc: 0.556 Test Loss: 10.400 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5972696245733788
model parameter : 12224002
model size : 66.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 14.545766830444336
Epoch: 1, Steps: 17 | Train Loss: 1.076 Vali Loss: 0.949 Vali Acc: 0.546 Test Loss: 0.949 Test Acc: 0.546
Validation loss decreased (inf --> -0.546066).  Saving model ...
Epoch: 2 cost time: 11.313172578811646
Epoch: 2, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.343 Vali Acc: 0.539 Test Loss: 1.343 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.501867294311523
Epoch: 3, Steps: 17 | Train Loss: 0.533 Vali Loss: 2.080 Vali Acc: 0.549 Test Loss: 2.080 Test Acc: 0.549
Validation loss decreased (-0.546066 --> -0.549467).  Saving model ...
Epoch: 4 cost time: 14.077102661132812
Epoch: 4, Steps: 17 | Train Loss: 0.512 Vali Loss: 2.555 Vali Acc: 0.536 Test Loss: 2.555 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.910898208618164
Epoch: 5, Steps: 17 | Train Loss: 0.518 Vali Loss: 3.230 Vali Acc: 0.526 Test Loss: 3.230 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.55596375465393
Epoch: 6, Steps: 17 | Train Loss: 0.950 Vali Loss: 3.613 Vali Acc: 0.570 Test Loss: 3.613 Test Acc: 0.570
Validation loss decreased (-0.549467 --> -0.569930).  Saving model ...
Epoch: 7 cost time: 12.493348121643066
Epoch: 7, Steps: 17 | Train Loss: 0.568 Vali Loss: 3.471 Vali Acc: 0.546 Test Loss: 3.471 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.575437784194946
Epoch: 8, Steps: 17 | Train Loss: 0.434 Vali Loss: 4.922 Vali Acc: 0.560 Test Loss: 4.922 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.871777772903442
Epoch: 9, Steps: 17 | Train Loss: 0.517 Vali Loss: 5.113 Vali Acc: 0.563 Test Loss: 5.113 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.88594388961792
Epoch: 10, Steps: 17 | Train Loss: 0.971 Vali Loss: 9.356 Vali Acc: 0.509 Test Loss: 9.356 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 14.548737525939941
Epoch: 11, Steps: 17 | Train Loss: 0.515 Vali Loss: 6.934 Vali Acc: 0.546 Test Loss: 6.934 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.002504348754883
Epoch: 12, Steps: 17 | Train Loss: 0.442 Vali Loss: 7.667 Vali Acc: 0.563 Test Loss: 7.667 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.820698976516724
Epoch: 13, Steps: 17 | Train Loss: 0.746 Vali Loss: 7.817 Vali Acc: 0.546 Test Loss: 7.817 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 15.426963329315186
Epoch: 14, Steps: 17 | Train Loss: 0.210 Vali Loss: 7.367 Vali Acc: 0.529 Test Loss: 7.367 Test Acc: 0.529
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.932918071746826
Epoch: 15, Steps: 17 | Train Loss: 0.621 Vali Loss: 8.691 Vali Acc: 0.529 Test Loss: 8.691 Test Acc: 0.529
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.965544700622559
Epoch: 16, Steps: 17 | Train Loss: 0.127 Vali Loss: 11.166 Vali Acc: 0.556 Test Loss: 11.166 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5699658703071673
model parameter : 12224002
model size : 66.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 15.602355003356934
Epoch: 1, Steps: 17 | Train Loss: 1.022 Vali Loss: 2.118 Vali Acc: 0.502 Test Loss: 2.118 Test Acc: 0.502
Validation loss decreased (inf --> -0.501685).  Saving model ...
Epoch: 2 cost time: 10.45920729637146
Epoch: 2, Steps: 17 | Train Loss: 0.802 Vali Loss: 1.155 Vali Acc: 0.502 Test Loss: 1.155 Test Acc: 0.502
Validation loss decreased (-0.501685 --> -0.501695).  Saving model ...
Epoch: 3 cost time: 14.405183792114258
Epoch: 3, Steps: 17 | Train Loss: 0.988 Vali Loss: 2.484 Vali Acc: 0.502 Test Loss: 2.484 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.147571086883545
Epoch: 4, Steps: 17 | Train Loss: 0.704 Vali Loss: 1.887 Vali Acc: 0.498 Test Loss: 1.887 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.137787103652954
Epoch: 5, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.921 Vali Acc: 0.608 Test Loss: 0.921 Test Acc: 0.608
Validation loss decreased (-0.501695 --> -0.607499).  Saving model ...
Epoch: 6 cost time: 14.793734788894653
Epoch: 6, Steps: 17 | Train Loss: 1.480 Vali Loss: 2.717 Vali Acc: 0.536 Test Loss: 2.717 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.302774667739868
Epoch: 7, Steps: 17 | Train Loss: 0.756 Vali Loss: 5.183 Vali Acc: 0.498 Test Loss: 5.183 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.576221227645874
Epoch: 8, Steps: 17 | Train Loss: 1.084 Vali Loss: 2.515 Vali Acc: 0.519 Test Loss: 2.515 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.632213354110718
Epoch: 9, Steps: 17 | Train Loss: 0.672 Vali Loss: 3.282 Vali Acc: 0.509 Test Loss: 3.282 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.746361494064331
Epoch: 10, Steps: 17 | Train Loss: 0.679 Vali Loss: 2.678 Vali Acc: 0.546 Test Loss: 2.678 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 14.032824754714966
Epoch: 11, Steps: 17 | Train Loss: 1.141 Vali Loss: 2.209 Vali Acc: 0.563 Test Loss: 2.209 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 14.201472520828247
Epoch: 12, Steps: 17 | Train Loss: 1.674 Vali Loss: 4.088 Vali Acc: 0.539 Test Loss: 4.088 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 14.66205883026123
Epoch: 13, Steps: 17 | Train Loss: 0.800 Vali Loss: 7.605 Vali Acc: 0.505 Test Loss: 7.605 Test Acc: 0.505
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.292060375213623
Epoch: 14, Steps: 17 | Train Loss: 0.696 Vali Loss: 7.243 Vali Acc: 0.519 Test Loss: 7.243 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.985399961471558
Epoch: 15, Steps: 17 | Train Loss: 0.478 Vali Loss: 6.385 Vali Acc: 0.495 Test Loss: 6.385 Test Acc: 0.495
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6075085324232082
model parameter : 12224002
model size : 66.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 13.816047430038452
Epoch: 1, Steps: 17 | Train Loss: 0.815 Vali Loss: 1.707 Vali Acc: 0.502 Test Loss: 1.707 Test Acc: 0.502
Validation loss decreased (inf --> -0.501689).  Saving model ...
Epoch: 2 cost time: 13.276891231536865
Epoch: 2, Steps: 17 | Train Loss: 0.711 Vali Loss: 1.138 Vali Acc: 0.502 Test Loss: 1.138 Test Acc: 0.502
Validation loss decreased (-0.501689 --> -0.501695).  Saving model ...
Epoch: 3 cost time: 14.672504186630249
Epoch: 3, Steps: 17 | Train Loss: 0.726 Vali Loss: 2.595 Vali Acc: 0.502 Test Loss: 2.595 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.09678316116333
Epoch: 4, Steps: 17 | Train Loss: 0.574 Vali Loss: 1.219 Vali Acc: 0.570 Test Loss: 1.219 Test Acc: 0.570
Validation loss decreased (-0.501695 --> -0.569954).  Saving model ...
Epoch: 5 cost time: 13.98866581916809
Epoch: 5, Steps: 17 | Train Loss: 0.436 Vali Loss: 2.026 Vali Acc: 0.567 Test Loss: 2.026 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.995503187179565
Epoch: 6, Steps: 17 | Train Loss: 0.756 Vali Loss: 4.976 Vali Acc: 0.529 Test Loss: 4.976 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.714186429977417
Epoch: 7, Steps: 17 | Train Loss: 0.739 Vali Loss: 4.439 Vali Acc: 0.543 Test Loss: 4.439 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.285629749298096
Epoch: 8, Steps: 17 | Train Loss: 1.094 Vali Loss: 5.816 Vali Acc: 0.505 Test Loss: 5.816 Test Acc: 0.505
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.69048261642456
Epoch: 9, Steps: 17 | Train Loss: 0.628 Vali Loss: 4.693 Vali Acc: 0.560 Test Loss: 4.693 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.30595588684082
Epoch: 10, Steps: 17 | Train Loss: 0.485 Vali Loss: 7.617 Vali Acc: 0.563 Test Loss: 7.617 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 14.5817391872406
Epoch: 11, Steps: 17 | Train Loss: 1.419 Vali Loss: 10.821 Vali Acc: 0.570 Test Loss: 10.821 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.318104028701782
Epoch: 12, Steps: 17 | Train Loss: 1.031 Vali Loss: 7.933 Vali Acc: 0.522 Test Loss: 7.933 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 14.200867414474487
Epoch: 13, Steps: 17 | Train Loss: 0.810 Vali Loss: 7.172 Vali Acc: 0.577 Test Loss: 7.172 Test Acc: 0.577
Validation loss decreased (-0.569954 --> -0.576720).  Saving model ...
Epoch: 14 cost time: 14.041470527648926
Epoch: 14, Steps: 17 | Train Loss: 0.596 Vali Loss: 6.978 Vali Acc: 0.567 Test Loss: 6.978 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.135645627975464
Epoch: 15, Steps: 17 | Train Loss: 0.412 Vali Loss: 6.647 Vali Acc: 0.590 Test Loss: 6.647 Test Acc: 0.590
Validation loss decreased (-0.576720 --> -0.590377).  Saving model ...
Epoch: 16 cost time: 12.710095643997192
Epoch: 16, Steps: 17 | Train Loss: 0.838 Vali Loss: 5.995 Vali Acc: 0.614 Test Loss: 5.995 Test Acc: 0.614
Validation loss decreased (-0.590377 --> -0.614275).  Saving model ...
Epoch: 17 cost time: 9.436594009399414
Epoch: 17, Steps: 17 | Train Loss: 1.822 Vali Loss: 8.783 Vali Acc: 0.567 Test Loss: 8.783 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 13.980219602584839
Epoch: 18, Steps: 17 | Train Loss: 0.507 Vali Loss: 9.209 Vali Acc: 0.584 Test Loss: 9.209 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.92503046989441
Epoch: 19, Steps: 17 | Train Loss: 0.525 Vali Loss: 16.748 Vali Acc: 0.509 Test Loss: 16.748 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 13.954540967941284
Epoch: 20, Steps: 17 | Train Loss: 0.755 Vali Loss: 9.947 Vali Acc: 0.556 Test Loss: 9.947 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 13.956015825271606
Epoch: 21, Steps: 17 | Train Loss: 0.683 Vali Loss: 9.946 Vali Acc: 0.601 Test Loss: 9.946 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 13.187793254852295
Epoch: 22, Steps: 17 | Train Loss: 0.935 Vali Loss: 18.802 Vali Acc: 0.543 Test Loss: 18.802 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 13.30664849281311
Epoch: 23, Steps: 17 | Train Loss: 0.581 Vali Loss: 12.183 Vali Acc: 0.522 Test Loss: 12.183 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 14.743399620056152
Epoch: 24, Steps: 17 | Train Loss: 0.724 Vali Loss: 11.500 Vali Acc: 0.631 Test Loss: 11.500 Test Acc: 0.631
Validation loss decreased (-0.614275 --> -0.631284).  Saving model ...
Epoch: 25 cost time: 13.648922443389893
Epoch: 25, Steps: 17 | Train Loss: 2.507 Vali Loss: 31.913 Vali Acc: 0.539 Test Loss: 31.913 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 13.218902349472046
Epoch: 26, Steps: 17 | Train Loss: 2.234 Vali Loss: 12.999 Vali Acc: 0.614 Test Loss: 12.999 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 13.557241678237915
Epoch: 27, Steps: 17 | Train Loss: 1.660 Vali Loss: 13.115 Vali Acc: 0.577 Test Loss: 13.115 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 13.330451488494873
Epoch: 28, Steps: 17 | Train Loss: 0.542 Vali Loss: 16.978 Vali Acc: 0.567 Test Loss: 16.978 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 13.331901550292969
Epoch: 29, Steps: 17 | Train Loss: 0.790 Vali Loss: 33.446 Vali Acc: 0.539 Test Loss: 33.446 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 12.915506601333618
Epoch: 30, Steps: 17 | Train Loss: 2.094 Vali Loss: 14.519 Vali Acc: 0.563 Test Loss: 14.519 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 13.461112022399902
Epoch: 31, Steps: 17 | Train Loss: 0.358 Vali Loss: 14.551 Vali Acc: 0.570 Test Loss: 14.551 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 14.846154689788818
Epoch: 32, Steps: 17 | Train Loss: 0.627 Vali Loss: 24.631 Vali Acc: 0.532 Test Loss: 24.631 Test Acc: 0.532
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 14.216012001037598
Epoch: 33, Steps: 17 | Train Loss: 1.366 Vali Loss: 31.479 Vali Acc: 0.529 Test Loss: 31.479 Test Acc: 0.529
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 13.518797636032104
Epoch: 34, Steps: 17 | Train Loss: 1.076 Vali Loss: 17.171 Vali Acc: 0.536 Test Loss: 17.171 Test Acc: 0.536
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6313993174061433
model parameter : 12224002
model size : 66.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 26.496237754821777
Epoch: 1, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.772 Vali Acc: 0.567 Test Loss: 1.772 Test Acc: 0.567
Validation loss decreased (inf --> -0.566535).  Saving model ...
Epoch: 2 cost time: 25.954258680343628
Epoch: 2, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.319 Vali Acc: 0.659 Test Loss: 1.319 Test Acc: 0.659
Validation loss decreased (-0.566535 --> -0.658690).  Saving model ...
Epoch: 3 cost time: 22.272165060043335
Epoch: 3, Steps: 17 | Train Loss: 0.847 Vali Loss: 4.913 Vali Acc: 0.549 Test Loss: 4.913 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.121691942214966
Epoch: 4, Steps: 17 | Train Loss: 0.972 Vali Loss: 4.947 Vali Acc: 0.570 Test Loss: 4.947 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 22.003689527511597
Epoch: 5, Steps: 17 | Train Loss: 0.539 Vali Loss: 4.661 Vali Acc: 0.655 Test Loss: 4.661 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 23.563305854797363
Epoch: 6, Steps: 17 | Train Loss: 0.461 Vali Loss: 3.997 Vali Acc: 0.573 Test Loss: 3.997 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 26.52554178237915
Epoch: 7, Steps: 17 | Train Loss: 1.054 Vali Loss: 3.005 Vali Acc: 0.696 Test Loss: 3.005 Test Acc: 0.696
Validation loss decreased (-0.658690 --> -0.696216).  Saving model ...
Epoch: 8 cost time: 25.24993348121643
Epoch: 8, Steps: 17 | Train Loss: 0.605 Vali Loss: 7.639 Vali Acc: 0.621 Test Loss: 7.639 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.493346691131592
Epoch: 9, Steps: 17 | Train Loss: 0.300 Vali Loss: 7.273 Vali Acc: 0.652 Test Loss: 7.273 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 22.346734046936035
Epoch: 10, Steps: 17 | Train Loss: 0.466 Vali Loss: 5.955 Vali Acc: 0.590 Test Loss: 5.955 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 26.84491467475891
Epoch: 11, Steps: 17 | Train Loss: 0.539 Vali Loss: 7.748 Vali Acc: 0.635 Test Loss: 7.748 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 19.68453311920166
Epoch: 12, Steps: 17 | Train Loss: 0.191 Vali Loss: 7.247 Vali Acc: 0.608 Test Loss: 7.247 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 23.470200061798096
Epoch: 13, Steps: 17 | Train Loss: 0.716 Vali Loss: 9.560 Vali Acc: 0.635 Test Loss: 9.560 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 24.03966450691223
Epoch: 14, Steps: 17 | Train Loss: 0.391 Vali Loss: 15.896 Vali Acc: 0.604 Test Loss: 15.896 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 26.674872398376465
Epoch: 15, Steps: 17 | Train Loss: 0.739 Vali Loss: 8.693 Vali Acc: 0.604 Test Loss: 8.693 Test Acc: 0.604
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 30.235435009002686
Epoch: 16, Steps: 17 | Train Loss: 1.102 Vali Loss: 9.031 Vali Acc: 0.672 Test Loss: 9.031 Test Acc: 0.672
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 26.40477228164673
Epoch: 17, Steps: 17 | Train Loss: 0.493 Vali Loss: 17.217 Vali Acc: 0.625 Test Loss: 17.217 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6962457337883959
model parameter : 11830786
model size : 64.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 24.442561149597168
Epoch: 1, Steps: 17 | Train Loss: 0.743 Vali Loss: 1.382 Vali Acc: 0.587 Test Loss: 1.382 Test Acc: 0.587
Validation loss decreased (inf --> -0.587017).  Saving model ...
Epoch: 2 cost time: 23.517741203308105
Epoch: 2, Steps: 17 | Train Loss: 0.525 Vali Loss: 1.399 Vali Acc: 0.631 Test Loss: 1.399 Test Acc: 0.631
Validation loss decreased (-0.587017 --> -0.631385).  Saving model ...
Epoch: 3 cost time: 22.886449575424194
Epoch: 3, Steps: 17 | Train Loss: 0.447 Vali Loss: 3.059 Vali Acc: 0.594 Test Loss: 3.059 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.76604390144348
Epoch: 4, Steps: 17 | Train Loss: 0.950 Vali Loss: 4.631 Vali Acc: 0.556 Test Loss: 4.631 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.871403694152832
Epoch: 5, Steps: 17 | Train Loss: 0.683 Vali Loss: 3.458 Vali Acc: 0.604 Test Loss: 3.458 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 22.69121789932251
Epoch: 6, Steps: 17 | Train Loss: 0.540 Vali Loss: 6.859 Vali Acc: 0.594 Test Loss: 6.859 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 21.65236520767212
Epoch: 7, Steps: 17 | Train Loss: 0.433 Vali Loss: 3.321 Vali Acc: 0.635 Test Loss: 3.321 Test Acc: 0.635
Validation loss decreased (-0.631385 --> -0.634779).  Saving model ...
Epoch: 8 cost time: 21.849336624145508
Epoch: 8, Steps: 17 | Train Loss: 0.444 Vali Loss: 7.278 Vali Acc: 0.614 Test Loss: 7.278 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.816973209381104
Epoch: 9, Steps: 17 | Train Loss: 0.350 Vali Loss: 16.602 Vali Acc: 0.529 Test Loss: 16.602 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.453017711639404
Epoch: 10, Steps: 17 | Train Loss: 1.178 Vali Loss: 7.564 Vali Acc: 0.604 Test Loss: 7.564 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.616928815841675
Epoch: 11, Steps: 17 | Train Loss: 0.471 Vali Loss: 6.643 Vali Acc: 0.628 Test Loss: 6.643 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 21.583711862564087
Epoch: 12, Steps: 17 | Train Loss: 0.733 Vali Loss: 10.372 Vali Acc: 0.608 Test Loss: 10.372 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 21.07651925086975
Epoch: 13, Steps: 17 | Train Loss: 0.785 Vali Loss: 8.919 Vali Acc: 0.652 Test Loss: 8.919 Test Acc: 0.652
Validation loss decreased (-0.634779 --> -0.651788).  Saving model ...
Epoch: 14 cost time: 17.932148933410645
Epoch: 14, Steps: 17 | Train Loss: 0.410 Vali Loss: 8.605 Vali Acc: 0.662 Test Loss: 8.605 Test Acc: 0.662
Validation loss decreased (-0.651788 --> -0.662030).  Saving model ...
Epoch: 15 cost time: 25.211384534835815
Epoch: 15, Steps: 17 | Train Loss: 0.150 Vali Loss: 9.453 Vali Acc: 0.662 Test Loss: 9.453 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 22.973217964172363
Epoch: 16, Steps: 17 | Train Loss: 0.661 Vali Loss: 11.601 Vali Acc: 0.662 Test Loss: 11.601 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 22.704137086868286
Epoch: 17, Steps: 17 | Train Loss: 0.481 Vali Loss: 15.639 Vali Acc: 0.601 Test Loss: 15.639 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 22.09856939315796
Epoch: 18, Steps: 17 | Train Loss: 0.726 Vali Loss: 20.682 Vali Acc: 0.556 Test Loss: 20.682 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 25.96407389640808
Epoch: 19, Steps: 17 | Train Loss: 0.270 Vali Loss: 11.640 Vali Acc: 0.625 Test Loss: 11.640 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 26.826701164245605
Epoch: 20, Steps: 17 | Train Loss: 0.734 Vali Loss: 20.140 Vali Acc: 0.601 Test Loss: 20.140 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 23.07581353187561
Epoch: 21, Steps: 17 | Train Loss: 0.241 Vali Loss: 16.907 Vali Acc: 0.642 Test Loss: 16.907 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 24.544291973114014
Epoch: 22, Steps: 17 | Train Loss: 0.022 Vali Loss: 11.226 Vali Acc: 0.700 Test Loss: 11.226 Test Acc: 0.700
Validation loss decreased (-0.662030 --> -0.699546).  Saving model ...
Epoch: 23 cost time: 23.8134503364563
Epoch: 23, Steps: 17 | Train Loss: 0.663 Vali Loss: 15.501 Vali Acc: 0.662 Test Loss: 15.501 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 26.63596773147583
Epoch: 24, Steps: 17 | Train Loss: 0.094 Vali Loss: 15.991 Vali Acc: 0.693 Test Loss: 15.991 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 26.274172067642212
Epoch: 25, Steps: 17 | Train Loss: 0.204 Vali Loss: 16.893 Vali Acc: 0.669 Test Loss: 16.893 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 22.992347955703735
Epoch: 26, Steps: 17 | Train Loss: 0.318 Vali Loss: 12.430 Vali Acc: 0.659 Test Loss: 12.430 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 26.09489870071411
Epoch: 27, Steps: 17 | Train Loss: 0.434 Vali Loss: 17.782 Vali Acc: 0.631 Test Loss: 17.782 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 27.324888706207275
Epoch: 28, Steps: 17 | Train Loss: 0.475 Vali Loss: 25.921 Vali Acc: 0.631 Test Loss: 25.921 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 25.905912160873413
Epoch: 29, Steps: 17 | Train Loss: 0.380 Vali Loss: 15.376 Vali Acc: 0.594 Test Loss: 15.376 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 24.48806071281433
Epoch: 30, Steps: 17 | Train Loss: 0.859 Vali Loss: 28.727 Vali Acc: 0.580 Test Loss: 28.727 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 24.65906023979187
Epoch: 31, Steps: 17 | Train Loss: 0.978 Vali Loss: 17.146 Vali Acc: 0.618 Test Loss: 17.146 Test Acc: 0.618
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 24.11233615875244
Epoch: 32, Steps: 17 | Train Loss: 0.494 Vali Loss: 25.421 Vali Acc: 0.652 Test Loss: 25.421 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6996587030716723
model parameter : 11830786
model size : 64.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 18.449668407440186
Epoch: 1, Steps: 17 | Train Loss: 0.804 Vali Loss: 1.162 Vali Acc: 0.567 Test Loss: 1.162 Test Acc: 0.567
Validation loss decreased (inf --> -0.566541).  Saving model ...
Epoch: 2 cost time: 17.341317892074585
Epoch: 2, Steps: 17 | Train Loss: 0.860 Vali Loss: 2.021 Vali Acc: 0.597 Test Loss: 2.021 Test Acc: 0.597
Validation loss decreased (-0.566541 --> -0.597249).  Saving model ...
Epoch: 3 cost time: 19.90245485305786
Epoch: 3, Steps: 17 | Train Loss: 0.892 Vali Loss: 5.811 Vali Acc: 0.529 Test Loss: 5.811 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.739477157592773
Epoch: 4, Steps: 17 | Train Loss: 0.742 Vali Loss: 2.258 Vali Acc: 0.614 Test Loss: 2.258 Test Acc: 0.614
Validation loss decreased (-0.597249 --> -0.614312).  Saving model ...
Epoch: 5 cost time: 19.67891788482666
Epoch: 5, Steps: 17 | Train Loss: 0.535 Vali Loss: 4.191 Vali Acc: 0.614 Test Loss: 4.191 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.52732515335083
Epoch: 6, Steps: 17 | Train Loss: 0.941 Vali Loss: 4.437 Vali Acc: 0.631 Test Loss: 4.437 Test Acc: 0.631
Validation loss decreased (-0.614312 --> -0.631355).  Saving model ...
Epoch: 7 cost time: 13.007858753204346
Epoch: 7, Steps: 17 | Train Loss: 1.406 Vali Loss: 6.745 Vali Acc: 0.546 Test Loss: 6.745 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.815996170043945
Epoch: 8, Steps: 17 | Train Loss: 3.040 Vali Loss: 4.085 Vali Acc: 0.618 Test Loss: 4.085 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.502833604812622
Epoch: 9, Steps: 17 | Train Loss: 2.606 Vali Loss: 15.800 Vali Acc: 0.532 Test Loss: 15.800 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 19.496684074401855
Epoch: 10, Steps: 17 | Train Loss: 1.305 Vali Loss: 8.663 Vali Acc: 0.618 Test Loss: 8.663 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 17.537224769592285
Epoch: 11, Steps: 17 | Train Loss: 0.701 Vali Loss: 9.980 Vali Acc: 0.614 Test Loss: 9.980 Test Acc: 0.614
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 17.43868613243103
Epoch: 12, Steps: 17 | Train Loss: 1.074 Vali Loss: 20.766 Vali Acc: 0.546 Test Loss: 20.766 Test Acc: 0.546
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 17.32525944709778
Epoch: 13, Steps: 17 | Train Loss: 2.037 Vali Loss: 8.214 Vali Acc: 0.601 Test Loss: 8.214 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 21.19456434249878
Epoch: 14, Steps: 17 | Train Loss: 0.397 Vali Loss: 12.936 Vali Acc: 0.625 Test Loss: 12.936 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 18.612110137939453
Epoch: 15, Steps: 17 | Train Loss: 0.303 Vali Loss: 11.869 Vali Acc: 0.611 Test Loss: 11.869 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 20.618432998657227
Epoch: 16, Steps: 17 | Train Loss: 0.162 Vali Loss: 10.597 Vali Acc: 0.608 Test Loss: 10.597 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6313993174061433
model parameter : 11830786
model size : 64.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 15.426061630249023
Epoch: 1, Steps: 17 | Train Loss: 0.825 Vali Loss: 1.196 Vali Acc: 0.529 Test Loss: 1.196 Test Acc: 0.529
Validation loss decreased (inf --> -0.528998).  Saving model ...
Epoch: 2 cost time: 15.613078832626343
Epoch: 2, Steps: 17 | Train Loss: 0.675 Vali Loss: 3.262 Vali Acc: 0.522 Test Loss: 3.262 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.32522225379944
Epoch: 3, Steps: 17 | Train Loss: 0.587 Vali Loss: 4.479 Vali Acc: 0.536 Test Loss: 4.479 Test Acc: 0.536
Validation loss decreased (-0.528998 --> -0.535791).  Saving model ...
Epoch: 4 cost time: 15.97510552406311
Epoch: 4, Steps: 17 | Train Loss: 1.050 Vali Loss: 4.396 Vali Acc: 0.573 Test Loss: 4.396 Test Acc: 0.573
Validation loss decreased (-0.535791 --> -0.573335).  Saving model ...
Epoch: 5 cost time: 14.524487257003784
Epoch: 5, Steps: 17 | Train Loss: 0.719 Vali Loss: 9.530 Vali Acc: 0.529 Test Loss: 9.530 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.49098014831543
Epoch: 6, Steps: 17 | Train Loss: 0.868 Vali Loss: 7.137 Vali Acc: 0.549 Test Loss: 7.137 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.239196300506592
Epoch: 7, Steps: 17 | Train Loss: 0.831 Vali Loss: 10.155 Vali Acc: 0.536 Test Loss: 10.155 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.305065155029297
Epoch: 8, Steps: 17 | Train Loss: 0.740 Vali Loss: 7.614 Vali Acc: 0.584 Test Loss: 7.614 Test Acc: 0.584
Validation loss decreased (-0.573335 --> -0.583542).  Saving model ...
Epoch: 9 cost time: 15.860205173492432
Epoch: 9, Steps: 17 | Train Loss: 1.195 Vali Loss: 6.071 Vali Acc: 0.618 Test Loss: 6.071 Test Acc: 0.618
Validation loss decreased (-0.583542 --> -0.617687).  Saving model ...
Epoch: 10 cost time: 17.451061725616455
Epoch: 10, Steps: 17 | Train Loss: 0.674 Vali Loss: 7.785 Vali Acc: 0.580 Test Loss: 7.785 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.7240469455719
Epoch: 11, Steps: 17 | Train Loss: 0.508 Vali Loss: 16.261 Vali Acc: 0.549 Test Loss: 16.261 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.683122158050537
Epoch: 12, Steps: 17 | Train Loss: 1.064 Vali Loss: 9.693 Vali Acc: 0.597 Test Loss: 9.693 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 16.934834480285645
Epoch: 13, Steps: 17 | Train Loss: 0.436 Vali Loss: 8.732 Vali Acc: 0.611 Test Loss: 8.732 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 23.643342971801758
Epoch: 14, Steps: 17 | Train Loss: 0.478 Vali Loss: 9.863 Vali Acc: 0.611 Test Loss: 9.863 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 21.595062971115112
Epoch: 15, Steps: 17 | Train Loss: 0.838 Vali Loss: 12.419 Vali Acc: 0.573 Test Loss: 12.419 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 20.412841796875
Epoch: 16, Steps: 17 | Train Loss: 0.145 Vali Loss: 12.333 Vali Acc: 0.590 Test Loss: 12.333 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 18.61363697052002
Epoch: 17, Steps: 17 | Train Loss: 0.408 Vali Loss: 17.253 Vali Acc: 0.549 Test Loss: 17.253 Test Acc: 0.549
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 18.34660243988037
Epoch: 18, Steps: 17 | Train Loss: 0.308 Vali Loss: 24.135 Vali Acc: 0.532 Test Loss: 24.135 Test Acc: 0.532
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 19.03650164604187
Epoch: 19, Steps: 17 | Train Loss: 1.837 Vali Loss: 10.658 Vali Acc: 0.625 Test Loss: 10.658 Test Acc: 0.625
Validation loss decreased (-0.617687 --> -0.624467).  Saving model ...
Epoch: 20 cost time: 19.18800973892212
Epoch: 20, Steps: 17 | Train Loss: 0.578 Vali Loss: 25.364 Vali Acc: 0.556 Test Loss: 25.364 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 18.659125566482544
Epoch: 21, Steps: 17 | Train Loss: 0.328 Vali Loss: 15.324 Vali Acc: 0.580 Test Loss: 15.324 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 17.52639651298523
Epoch: 22, Steps: 17 | Train Loss: 0.162 Vali Loss: 13.052 Vali Acc: 0.614 Test Loss: 13.052 Test Acc: 0.614
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 18.992782592773438
Epoch: 23, Steps: 17 | Train Loss: 0.794 Vali Loss: 27.533 Vali Acc: 0.556 Test Loss: 27.533 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 21.225968599319458
Epoch: 24, Steps: 17 | Train Loss: 0.660 Vali Loss: 21.203 Vali Acc: 0.587 Test Loss: 21.203 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 19.90343689918518
Epoch: 25, Steps: 17 | Train Loss: 0.209 Vali Loss: 15.255 Vali Acc: 0.611 Test Loss: 15.255 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 18.948241472244263
Epoch: 26, Steps: 17 | Train Loss: 2.051 Vali Loss: 28.418 Vali Acc: 0.563 Test Loss: 28.418 Test Acc: 0.563
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 17.552523374557495
Epoch: 27, Steps: 17 | Train Loss: 0.450 Vali Loss: 27.619 Vali Acc: 0.567 Test Loss: 27.619 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 19.317622423171997
Epoch: 28, Steps: 17 | Train Loss: 0.479 Vali Loss: 42.602 Vali Acc: 0.536 Test Loss: 42.602 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 19.863744974136353
Epoch: 29, Steps: 17 | Train Loss: 0.922 Vali Loss: 17.593 Vali Acc: 0.614 Test Loss: 17.593 Test Acc: 0.614
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 11830786
model size : 64.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 17.44970941543579
Epoch: 1, Steps: 17 | Train Loss: 0.848 Vali Loss: 0.926 Vali Acc: 0.604 Test Loss: 0.926 Test Acc: 0.604
Validation loss decreased (inf --> -0.604086).  Saving model ...
Epoch: 2 cost time: 15.16991400718689
Epoch: 2, Steps: 17 | Train Loss: 0.905 Vali Loss: 2.787 Vali Acc: 0.570 Test Loss: 2.787 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.703187465667725
Epoch: 3, Steps: 17 | Train Loss: 0.871 Vali Loss: 5.131 Vali Acc: 0.519 Test Loss: 5.131 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.680007219314575
Epoch: 4, Steps: 17 | Train Loss: 0.656 Vali Loss: 2.899 Vali Acc: 0.625 Test Loss: 2.899 Test Acc: 0.625
Validation loss decreased (-0.604086 --> -0.624544).  Saving model ...
Epoch: 5 cost time: 14.96327018737793
Epoch: 5, Steps: 17 | Train Loss: 0.386 Vali Loss: 3.227 Vali Acc: 0.611 Test Loss: 3.227 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.908702611923218
Epoch: 6, Steps: 17 | Train Loss: 1.074 Vali Loss: 8.881 Vali Acc: 0.532 Test Loss: 8.881 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.738592624664307
Epoch: 7, Steps: 17 | Train Loss: 1.707 Vali Loss: 4.386 Vali Acc: 0.604 Test Loss: 4.386 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.982506275177002
Epoch: 8, Steps: 17 | Train Loss: 0.659 Vali Loss: 8.565 Vali Acc: 0.563 Test Loss: 8.565 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.329170227050781
Epoch: 9, Steps: 17 | Train Loss: 1.782 Vali Loss: 5.985 Vali Acc: 0.625 Test Loss: 5.985 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.36966848373413
Epoch: 10, Steps: 17 | Train Loss: 0.583 Vali Loss: 7.016 Vali Acc: 0.618 Test Loss: 7.016 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.821970701217651
Epoch: 11, Steps: 17 | Train Loss: 0.983 Vali Loss: 13.822 Vali Acc: 0.546 Test Loss: 13.822 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 15.265280723571777
Epoch: 12, Steps: 17 | Train Loss: 1.453 Vali Loss: 11.371 Vali Acc: 0.590 Test Loss: 11.371 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 15.687339305877686
Epoch: 13, Steps: 17 | Train Loss: 1.124 Vali Loss: 7.521 Vali Acc: 0.611 Test Loss: 7.521 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 15.651841402053833
Epoch: 14, Steps: 17 | Train Loss: 0.383 Vali Loss: 16.592 Vali Acc: 0.560 Test Loss: 16.592 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 11830786
model size : 64.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 15.81413459777832
Epoch: 1, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.220 Vali Acc: 0.556 Test Loss: 1.220 Test Acc: 0.556
Validation loss decreased (inf --> -0.556302).  Saving model ...
Epoch: 2 cost time: 12.237971782684326
Epoch: 2, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.699 Vali Acc: 0.577 Test Loss: 1.699 Test Acc: 0.577
Validation loss decreased (-0.556302 --> -0.576775).  Saving model ...
Epoch: 3 cost time: 13.237672328948975
Epoch: 3, Steps: 17 | Train Loss: 0.832 Vali Loss: 3.459 Vali Acc: 0.539 Test Loss: 3.459 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.75790786743164
Epoch: 4, Steps: 17 | Train Loss: 0.988 Vali Loss: 5.320 Vali Acc: 0.532 Test Loss: 5.320 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.533488273620605
Epoch: 5, Steps: 17 | Train Loss: 0.638 Vali Loss: 3.227 Vali Acc: 0.601 Test Loss: 3.227 Test Acc: 0.601
Validation loss decreased (-0.576775 --> -0.600650).  Saving model ...
Epoch: 6 cost time: 14.300816297531128
Epoch: 6, Steps: 17 | Train Loss: 0.999 Vali Loss: 3.821 Vali Acc: 0.567 Test Loss: 3.821 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.884814739227295
Epoch: 7, Steps: 17 | Train Loss: 0.625 Vali Loss: 4.579 Vali Acc: 0.587 Test Loss: 4.579 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.854135274887085
Epoch: 8, Steps: 17 | Train Loss: 0.797 Vali Loss: 4.947 Vali Acc: 0.587 Test Loss: 4.947 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.418378353118896
Epoch: 9, Steps: 17 | Train Loss: 0.395 Vali Loss: 7.534 Vali Acc: 0.543 Test Loss: 7.534 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.868733644485474
Epoch: 10, Steps: 17 | Train Loss: 0.383 Vali Loss: 6.890 Vali Acc: 0.546 Test Loss: 6.890 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.565248250961304
Epoch: 11, Steps: 17 | Train Loss: 0.962 Vali Loss: 12.610 Vali Acc: 0.532 Test Loss: 12.610 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 14.527515172958374
Epoch: 12, Steps: 17 | Train Loss: 1.243 Vali Loss: 6.618 Vali Acc: 0.611 Test Loss: 6.618 Test Acc: 0.611
Validation loss decreased (-0.600650 --> -0.610855).  Saving model ...
Epoch: 13 cost time: 13.865647077560425
Epoch: 13, Steps: 17 | Train Loss: 0.661 Vali Loss: 7.326 Vali Acc: 0.587 Test Loss: 7.326 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.331928730010986
Epoch: 14, Steps: 17 | Train Loss: 0.509 Vali Loss: 15.875 Vali Acc: 0.522 Test Loss: 15.875 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.602341413497925
Epoch: 15, Steps: 17 | Train Loss: 1.137 Vali Loss: 9.451 Vali Acc: 0.590 Test Loss: 9.451 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.835479974746704
Epoch: 16, Steps: 17 | Train Loss: 0.540 Vali Loss: 8.880 Vali Acc: 0.590 Test Loss: 8.880 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 13.408785343170166
Epoch: 17, Steps: 17 | Train Loss: 0.353 Vali Loss: 11.649 Vali Acc: 0.577 Test Loss: 11.649 Test Acc: 0.577
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.98745059967041
Epoch: 18, Steps: 17 | Train Loss: 0.310 Vali Loss: 14.137 Vali Acc: 0.567 Test Loss: 14.137 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 14.72159481048584
Epoch: 19, Steps: 17 | Train Loss: 0.571 Vali Loss: 11.907 Vali Acc: 0.573 Test Loss: 11.907 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 14.373400211334229
Epoch: 20, Steps: 17 | Train Loss: 0.308 Vali Loss: 10.168 Vali Acc: 0.628 Test Loss: 10.168 Test Acc: 0.628
Validation loss decreased (-0.610855 --> -0.627885).  Saving model ...
Epoch: 21 cost time: 14.369190692901611
Epoch: 21, Steps: 17 | Train Loss: 0.699 Vali Loss: 12.453 Vali Acc: 0.584 Test Loss: 12.453 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 12.48690915107727
Epoch: 22, Steps: 17 | Train Loss: 0.504 Vali Loss: 13.842 Vali Acc: 0.546 Test Loss: 13.842 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 11.948630332946777
Epoch: 23, Steps: 17 | Train Loss: 0.382 Vali Loss: 15.205 Vali Acc: 0.567 Test Loss: 15.205 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 13.864405393600464
Epoch: 24, Steps: 17 | Train Loss: 0.747 Vali Loss: 13.212 Vali Acc: 0.594 Test Loss: 13.212 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 14.871673345565796
Epoch: 25, Steps: 17 | Train Loss: 0.737 Vali Loss: 15.512 Vali Acc: 0.594 Test Loss: 15.512 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 14.674116134643555
Epoch: 26, Steps: 17 | Train Loss: 1.068 Vali Loss: 19.433 Vali Acc: 0.584 Test Loss: 19.433 Test Acc: 0.584
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 14.309427738189697
Epoch: 27, Steps: 17 | Train Loss: 0.436 Vali Loss: 24.124 Vali Acc: 0.560 Test Loss: 24.124 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 13.243309736251831
Epoch: 28, Steps: 17 | Train Loss: 0.295 Vali Loss: 17.858 Vali Acc: 0.590 Test Loss: 17.858 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 13.873191356658936
Epoch: 29, Steps: 17 | Train Loss: 0.560 Vali Loss: 25.973 Vali Acc: 0.556 Test Loss: 25.973 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 13.839641809463501
Epoch: 30, Steps: 17 | Train Loss: 0.795 Vali Loss: 22.028 Vali Acc: 0.584 Test Loss: 22.028 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6279863481228669
model parameter : 11830786
model size : 64.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 15.654359579086304
Epoch: 1, Steps: 17 | Train Loss: 0.830 Vali Loss: 1.491 Vali Acc: 0.529 Test Loss: 1.491 Test Acc: 0.529
Validation loss decreased (inf --> -0.528995).  Saving model ...
Epoch: 2 cost time: 13.164014339447021
Epoch: 2, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.629 Vali Acc: 0.529 Test Loss: 2.629 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.981036186218262
Epoch: 3, Steps: 17 | Train Loss: 0.662 Vali Loss: 3.786 Vali Acc: 0.532 Test Loss: 3.786 Test Acc: 0.532
Validation loss decreased (-0.528995 --> -0.532385).  Saving model ...
Epoch: 4 cost time: 14.666264057159424
Epoch: 4, Steps: 17 | Train Loss: 0.668 Vali Loss: 2.756 Vali Acc: 0.570 Test Loss: 2.756 Test Acc: 0.570
Validation loss decreased (-0.532385 --> -0.569938).  Saving model ...
Epoch: 5 cost time: 11.5781569480896
Epoch: 5, Steps: 17 | Train Loss: 0.674 Vali Loss: 3.614 Vali Acc: 0.597 Test Loss: 3.614 Test Acc: 0.597
Validation loss decreased (-0.569938 --> -0.597233).  Saving model ...
Epoch: 6 cost time: 10.640610218048096
Epoch: 6, Steps: 17 | Train Loss: 0.837 Vali Loss: 3.541 Vali Acc: 0.608 Test Loss: 3.541 Test Acc: 0.608
Validation loss decreased (-0.597233 --> -0.607473).  Saving model ...
Epoch: 7 cost time: 13.166728973388672
Epoch: 7, Steps: 17 | Train Loss: 0.817 Vali Loss: 4.464 Vali Acc: 0.563 Test Loss: 4.464 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.619610071182251
Epoch: 8, Steps: 17 | Train Loss: 0.548 Vali Loss: 8.443 Vali Acc: 0.529 Test Loss: 8.443 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.121459484100342
Epoch: 9, Steps: 17 | Train Loss: 1.549 Vali Loss: 6.519 Vali Acc: 0.526 Test Loss: 6.519 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.148919343948364
Epoch: 10, Steps: 17 | Train Loss: 0.583 Vali Loss: 9.339 Vali Acc: 0.532 Test Loss: 9.339 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.551244258880615
Epoch: 11, Steps: 17 | Train Loss: 1.113 Vali Loss: 9.221 Vali Acc: 0.549 Test Loss: 9.221 Test Acc: 0.549
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.121052503585815
Epoch: 12, Steps: 17 | Train Loss: 0.814 Vali Loss: 10.343 Vali Acc: 0.532 Test Loss: 10.343 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.180083513259888
Epoch: 13, Steps: 17 | Train Loss: 0.905 Vali Loss: 14.586 Vali Acc: 0.543 Test Loss: 14.586 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.666080951690674
Epoch: 14, Steps: 17 | Train Loss: 0.767 Vali Loss: 11.289 Vali Acc: 0.522 Test Loss: 11.289 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 13.166958093643188
Epoch: 15, Steps: 17 | Train Loss: 0.495 Vali Loss: 9.716 Vali Acc: 0.532 Test Loss: 9.716 Test Acc: 0.532
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 13.761011600494385
Epoch: 16, Steps: 17 | Train Loss: 0.318 Vali Loss: 10.620 Vali Acc: 0.546 Test Loss: 10.620 Test Acc: 0.546
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6075085324232082
model parameter : 11830786
model size : 64.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 13.969203233718872
Epoch: 1, Steps: 17 | Train Loss: 0.758 Vali Loss: 1.135 Vali Acc: 0.532 Test Loss: 1.135 Test Acc: 0.532
Validation loss decreased (inf --> -0.532412).  Saving model ...
Epoch: 2 cost time: 12.546267986297607
Epoch: 2, Steps: 17 | Train Loss: 0.738 Vali Loss: 1.384 Vali Acc: 0.560 Test Loss: 1.384 Test Acc: 0.560
Validation loss decreased (-0.532412 --> -0.559713).  Saving model ...
Epoch: 3 cost time: 11.3765287399292
Epoch: 3, Steps: 17 | Train Loss: 0.629 Vali Loss: 2.569 Vali Acc: 0.526 Test Loss: 2.569 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.4560227394104
Epoch: 4, Steps: 17 | Train Loss: 0.883 Vali Loss: 4.442 Vali Acc: 0.532 Test Loss: 4.442 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.559303522109985
Epoch: 5, Steps: 17 | Train Loss: 0.865 Vali Loss: 2.721 Vali Acc: 0.529 Test Loss: 2.721 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.98835039138794
Epoch: 6, Steps: 17 | Train Loss: 0.817 Vali Loss: 3.016 Vali Acc: 0.539 Test Loss: 3.016 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.630014657974243
Epoch: 7, Steps: 17 | Train Loss: 0.744 Vali Loss: 4.516 Vali Acc: 0.556 Test Loss: 4.516 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.71644926071167
Epoch: 8, Steps: 17 | Train Loss: 0.735 Vali Loss: 8.410 Vali Acc: 0.509 Test Loss: 8.410 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.508397579193115
Epoch: 9, Steps: 17 | Train Loss: 0.660 Vali Loss: 5.381 Vali Acc: 0.543 Test Loss: 5.381 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.684116840362549
Epoch: 10, Steps: 17 | Train Loss: 1.068 Vali Loss: 8.102 Vali Acc: 0.549 Test Loss: 8.102 Test Acc: 0.549
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.470897912979126
Epoch: 11, Steps: 17 | Train Loss: 1.187 Vali Loss: 7.740 Vali Acc: 0.556 Test Loss: 7.740 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 12.258587121963501
Epoch: 12, Steps: 17 | Train Loss: 0.538 Vali Loss: 8.113 Vali Acc: 0.526 Test Loss: 8.113 Test Acc: 0.526
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5597269624573379
model parameter : 11830786
model size : 64.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 14.334640264511108
Epoch: 1, Steps: 17 | Train Loss: 0.729 Vali Loss: 3.354 Vali Acc: 0.502 Test Loss: 3.354 Test Acc: 0.502
Validation loss decreased (inf --> -0.501673).  Saving model ...
Epoch: 2 cost time: 12.78713846206665
Epoch: 2, Steps: 17 | Train Loss: 0.728 Vali Loss: 0.644 Vali Acc: 0.642 Test Loss: 0.644 Test Acc: 0.642
Validation loss decreased (-0.501673 --> -0.641632).  Saving model ...
Epoch: 3 cost time: 11.235642910003662
Epoch: 3, Steps: 17 | Train Loss: 0.570 Vali Loss: 1.692 Vali Acc: 0.502 Test Loss: 1.692 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.894909620285034
Epoch: 4, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.787 Vali Acc: 0.604 Test Loss: 0.787 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.442327499389648
Epoch: 5, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.984 Vali Acc: 0.560 Test Loss: 0.984 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.778648138046265
Epoch: 6, Steps: 17 | Train Loss: 0.542 Vali Loss: 2.442 Vali Acc: 0.498 Test Loss: 2.442 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.800785541534424
Epoch: 7, Steps: 17 | Train Loss: 0.364 Vali Loss: 3.229 Vali Acc: 0.491 Test Loss: 3.229 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.756537437438965
Epoch: 8, Steps: 17 | Train Loss: 0.312 Vali Loss: 2.410 Vali Acc: 0.539 Test Loss: 2.410 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.009546518325806
Epoch: 9, Steps: 17 | Train Loss: 0.334 Vali Loss: 2.623 Vali Acc: 0.539 Test Loss: 2.623 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.061824321746826
Epoch: 10, Steps: 17 | Train Loss: 0.986 Vali Loss: 9.415 Vali Acc: 0.498 Test Loss: 9.415 Test Acc: 0.498
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.880802869796753
Epoch: 11, Steps: 17 | Train Loss: 0.746 Vali Loss: 4.540 Vali Acc: 0.515 Test Loss: 4.540 Test Acc: 0.515
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.21617078781128
Epoch: 12, Steps: 17 | Train Loss: 0.370 Vali Loss: 3.841 Vali Acc: 0.553 Test Loss: 3.841 Test Acc: 0.553
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 11830786
model size : 64.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 13.128735542297363
Epoch: 1, Steps: 17 | Train Loss: 0.732 Vali Loss: 2.992 Vali Acc: 0.502 Test Loss: 2.992 Test Acc: 0.502
Validation loss decreased (inf --> -0.501677).  Saving model ...
Epoch: 2 cost time: 12.495113134384155
Epoch: 2, Steps: 17 | Train Loss: 0.738 Vali Loss: 1.797 Vali Acc: 0.502 Test Loss: 1.797 Test Acc: 0.502
Validation loss decreased (-0.501677 --> -0.501689).  Saving model ...
Epoch: 3 cost time: 12.91016435623169
Epoch: 3, Steps: 17 | Train Loss: 0.526 Vali Loss: 2.682 Vali Acc: 0.502 Test Loss: 2.682 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.932816743850708
Epoch: 4, Steps: 17 | Train Loss: 0.813 Vali Loss: 3.064 Vali Acc: 0.560 Test Loss: 3.064 Test Acc: 0.560
Validation loss decreased (-0.501689 --> -0.559696).  Saving model ...
Epoch: 5 cost time: 12.349305629730225
Epoch: 5, Steps: 17 | Train Loss: 0.586 Vali Loss: 2.739 Vali Acc: 0.601 Test Loss: 2.739 Test Acc: 0.601
Validation loss decreased (-0.559696 --> -0.600655).  Saving model ...
Epoch: 6 cost time: 12.236451625823975
Epoch: 6, Steps: 17 | Train Loss: 0.775 Vali Loss: 4.719 Vali Acc: 0.577 Test Loss: 4.719 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.10373306274414
Epoch: 7, Steps: 17 | Train Loss: 0.463 Vali Loss: 3.633 Vali Acc: 0.577 Test Loss: 3.633 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.194175243377686
Epoch: 8, Steps: 17 | Train Loss: 0.433 Vali Loss: 3.868 Vali Acc: 0.567 Test Loss: 3.868 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.372556686401367
Epoch: 9, Steps: 17 | Train Loss: 0.422 Vali Loss: 4.528 Vali Acc: 0.553 Test Loss: 4.528 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.90548300743103
Epoch: 10, Steps: 17 | Train Loss: 0.538 Vali Loss: 5.616 Vali Acc: 0.611 Test Loss: 5.616 Test Acc: 0.611
Validation loss decreased (-0.600655 --> -0.610865).  Saving model ...
Epoch: 11 cost time: 13.382513761520386
Epoch: 11, Steps: 17 | Train Loss: 1.527 Vali Loss: 5.362 Vali Acc: 0.577 Test Loss: 5.362 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.925252676010132
Epoch: 12, Steps: 17 | Train Loss: 0.919 Vali Loss: 5.064 Vali Acc: 0.567 Test Loss: 5.064 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.723203897476196
Epoch: 13, Steps: 17 | Train Loss: 0.917 Vali Loss: 9.264 Vali Acc: 0.573 Test Loss: 9.264 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.334444284439087
Epoch: 14, Steps: 17 | Train Loss: 0.896 Vali Loss: 13.462 Vali Acc: 0.567 Test Loss: 13.462 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.405833005905151
Epoch: 15, Steps: 17 | Train Loss: 0.794 Vali Loss: 8.106 Vali Acc: 0.590 Test Loss: 8.106 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.5311439037323
Epoch: 16, Steps: 17 | Train Loss: 0.619 Vali Loss: 6.452 Vali Acc: 0.590 Test Loss: 6.452 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.257092237472534
Epoch: 17, Steps: 17 | Train Loss: 0.426 Vali Loss: 11.124 Vali Acc: 0.594 Test Loss: 11.124 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.097692489624023
Epoch: 18, Steps: 17 | Train Loss: 0.761 Vali Loss: 8.666 Vali Acc: 0.573 Test Loss: 8.666 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 13.584439516067505
Epoch: 19, Steps: 17 | Train Loss: 1.258 Vali Loss: 13.215 Vali Acc: 0.570 Test Loss: 13.215 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 13.404879570007324
Epoch: 20, Steps: 17 | Train Loss: 0.362 Vali Loss: 11.338 Vali Acc: 0.601 Test Loss: 11.338 Test Acc: 0.601
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6109215017064846
model parameter : 11830786
model size : 64.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 14.57929539680481
Epoch: 1, Steps: 17 | Train Loss: 0.694 Vali Loss: 1.086 Vali Acc: 0.556 Test Loss: 1.086 Test Acc: 0.556
Validation loss decreased (inf --> -0.556303).  Saving model ...
Epoch: 2 cost time: 13.358916521072388
Epoch: 2, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.984 Vali Acc: 0.652 Test Loss: 0.984 Test Acc: 0.652
Validation loss decreased (-0.556303 --> -0.651867).  Saving model ...
Epoch: 3 cost time: 15.201558351516724
Epoch: 3, Steps: 17 | Train Loss: 0.320 Vali Loss: 1.118 Vali Acc: 0.611 Test Loss: 1.118 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.490495204925537
Epoch: 4, Steps: 17 | Train Loss: 0.474 Vali Loss: 1.509 Vali Acc: 0.662 Test Loss: 1.509 Test Acc: 0.662
Validation loss decreased (-0.651867 --> -0.662101).  Saving model ...
Epoch: 5 cost time: 14.5581533908844
Epoch: 5, Steps: 17 | Train Loss: 0.507 Vali Loss: 3.012 Vali Acc: 0.642 Test Loss: 3.012 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.455120325088501
Epoch: 6, Steps: 17 | Train Loss: 0.344 Vali Loss: 3.031 Vali Acc: 0.611 Test Loss: 3.031 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.078673124313354
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 3.276 Vali Acc: 0.628 Test Loss: 3.276 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.102905988693237
Epoch: 8, Steps: 17 | Train Loss: 0.853 Vali Loss: 3.854 Vali Acc: 0.573 Test Loss: 3.854 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.27449655532837
Epoch: 9, Steps: 17 | Train Loss: 1.524 Vali Loss: 7.986 Vali Acc: 0.567 Test Loss: 7.986 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.438480615615845
Epoch: 10, Steps: 17 | Train Loss: 0.334 Vali Loss: 9.731 Vali Acc: 0.577 Test Loss: 9.731 Test Acc: 0.577
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.711626052856445
Epoch: 11, Steps: 17 | Train Loss: 0.499 Vali Loss: 4.433 Vali Acc: 0.608 Test Loss: 4.433 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.003568887710571
Epoch: 12, Steps: 17 | Train Loss: 0.214 Vali Loss: 10.154 Vali Acc: 0.570 Test Loss: 10.154 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 9.853045463562012
Epoch: 13, Steps: 17 | Train Loss: 0.519 Vali Loss: 6.735 Vali Acc: 0.608 Test Loss: 6.735 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 13.558865070343018
Epoch: 14, Steps: 17 | Train Loss: 0.167 Vali Loss: 5.994 Vali Acc: 0.580 Test Loss: 5.994 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6621160409556314
model parameter : 6243074
model size : 33.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 14.818928718566895
Epoch: 1, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.970 Vali Acc: 0.584 Test Loss: 0.970 Test Acc: 0.584
Validation loss decreased (inf --> -0.583608).  Saving model ...
Epoch: 2 cost time: 12.001087427139282
Epoch: 2, Steps: 17 | Train Loss: 0.470 Vali Loss: 1.209 Vali Acc: 0.625 Test Loss: 1.209 Test Acc: 0.625
Validation loss decreased (-0.583608 --> -0.624561).  Saving model ...
Epoch: 3 cost time: 13.225870609283447
Epoch: 3, Steps: 17 | Train Loss: 0.371 Vali Loss: 1.106 Vali Acc: 0.618 Test Loss: 1.106 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.087251663208008
Epoch: 4, Steps: 17 | Train Loss: 0.364 Vali Loss: 3.200 Vali Acc: 0.577 Test Loss: 3.200 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.063106775283813
Epoch: 5, Steps: 17 | Train Loss: 0.375 Vali Loss: 4.728 Vali Acc: 0.543 Test Loss: 4.728 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.254889488220215
Epoch: 6, Steps: 17 | Train Loss: 0.212 Vali Loss: 3.397 Vali Acc: 0.543 Test Loss: 3.397 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.452462911605835
Epoch: 7, Steps: 17 | Train Loss: 0.266 Vali Loss: 3.269 Vali Acc: 0.587 Test Loss: 3.269 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.306127548217773
Epoch: 8, Steps: 17 | Train Loss: 0.421 Vali Loss: 3.550 Vali Acc: 0.587 Test Loss: 3.550 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 11.905288219451904
Epoch: 9, Steps: 17 | Train Loss: 0.870 Vali Loss: 4.653 Vali Acc: 0.594 Test Loss: 4.653 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 15.236175537109375
Epoch: 10, Steps: 17 | Train Loss: 0.501 Vali Loss: 11.191 Vali Acc: 0.522 Test Loss: 11.191 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 16.752427577972412
Epoch: 11, Steps: 17 | Train Loss: 0.460 Vali Loss: 5.360 Vali Acc: 0.597 Test Loss: 5.360 Test Acc: 0.597
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 16.45776057243347
Epoch: 12, Steps: 17 | Train Loss: 0.370 Vali Loss: 6.296 Vali Acc: 0.618 Test Loss: 6.296 Test Acc: 0.618
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 6243074
model size : 33.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 17.27026057243347
Epoch: 1, Steps: 17 | Train Loss: 0.707 Vali Loss: 1.043 Vali Acc: 0.556 Test Loss: 1.043 Test Acc: 0.556
Validation loss decreased (inf --> -0.556304).  Saving model ...
Epoch: 2 cost time: 16.212023973464966
Epoch: 2, Steps: 17 | Train Loss: 0.616 Vali Loss: 2.230 Vali Acc: 0.539 Test Loss: 2.230 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.261126041412354
Epoch: 3, Steps: 17 | Train Loss: 1.062 Vali Loss: 2.405 Vali Acc: 0.577 Test Loss: 2.405 Test Acc: 0.577
Validation loss decreased (-0.556304 --> -0.576768).  Saving model ...
Epoch: 4 cost time: 13.591036796569824
Epoch: 4, Steps: 17 | Train Loss: 0.355 Vali Loss: 2.641 Vali Acc: 0.543 Test Loss: 2.641 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.537896156311035
Epoch: 5, Steps: 17 | Train Loss: 0.502 Vali Loss: 3.160 Vali Acc: 0.563 Test Loss: 3.160 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.07198452949524
Epoch: 6, Steps: 17 | Train Loss: 0.630 Vali Loss: 2.932 Vali Acc: 0.577 Test Loss: 2.932 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.651141166687012
Epoch: 7, Steps: 17 | Train Loss: 0.247 Vali Loss: 3.540 Vali Acc: 0.604 Test Loss: 3.540 Test Acc: 0.604
Validation loss decreased (-0.576768 --> -0.604060).  Saving model ...
Epoch: 8 cost time: 15.684412240982056
Epoch: 8, Steps: 17 | Train Loss: 0.187 Vali Loss: 3.094 Vali Acc: 0.642 Test Loss: 3.094 Test Acc: 0.642
Validation loss decreased (-0.604060 --> -0.641607).  Saving model ...
Epoch: 9 cost time: 14.40776538848877
Epoch: 9, Steps: 17 | Train Loss: 0.368 Vali Loss: 3.693 Vali Acc: 0.573 Test Loss: 3.693 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.24157428741455
Epoch: 10, Steps: 17 | Train Loss: 0.324 Vali Loss: 4.208 Vali Acc: 0.621 Test Loss: 4.208 Test Acc: 0.621
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 15.325388431549072
Epoch: 11, Steps: 17 | Train Loss: 0.188 Vali Loss: 4.299 Vali Acc: 0.655 Test Loss: 4.299 Test Acc: 0.655
Validation loss decreased (-0.641607 --> -0.655247).  Saving model ...
Epoch: 12 cost time: 15.660297393798828
Epoch: 12, Steps: 17 | Train Loss: 1.147 Vali Loss: 9.190 Vali Acc: 0.577 Test Loss: 9.190 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.308758974075317
Epoch: 13, Steps: 17 | Train Loss: 0.948 Vali Loss: 4.925 Vali Acc: 0.628 Test Loss: 4.925 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 14.417757034301758
Epoch: 14, Steps: 17 | Train Loss: 1.054 Vali Loss: 8.823 Vali Acc: 0.580 Test Loss: 8.823 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 13.803516387939453
Epoch: 15, Steps: 17 | Train Loss: 0.138 Vali Loss: 6.944 Vali Acc: 0.590 Test Loss: 6.944 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 14.790873527526855
Epoch: 16, Steps: 17 | Train Loss: 0.851 Vali Loss: 6.988 Vali Acc: 0.604 Test Loss: 6.988 Test Acc: 0.604
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 12.527114868164062
Epoch: 17, Steps: 17 | Train Loss: 0.467 Vali Loss: 9.564 Vali Acc: 0.625 Test Loss: 9.564 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 15.830774307250977
Epoch: 18, Steps: 17 | Train Loss: 0.252 Vali Loss: 10.095 Vali Acc: 0.594 Test Loss: 10.095 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 16.046741485595703
Epoch: 19, Steps: 17 | Train Loss: 0.174 Vali Loss: 9.809 Vali Acc: 0.611 Test Loss: 9.809 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 16.240626335144043
Epoch: 20, Steps: 17 | Train Loss: 0.334 Vali Loss: 13.713 Vali Acc: 0.577 Test Loss: 13.713 Test Acc: 0.577
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 14.711733102798462
Epoch: 21, Steps: 17 | Train Loss: 1.553 Vali Loss: 8.249 Vali Acc: 0.580 Test Loss: 8.249 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6552901023890785
model parameter : 6243074
model size : 33.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 14.622922897338867
Epoch: 1, Steps: 17 | Train Loss: 0.702 Vali Loss: 0.959 Vali Acc: 0.584 Test Loss: 0.959 Test Acc: 0.584
Validation loss decreased (inf --> -0.583608).  Saving model ...
Epoch: 2 cost time: 14.251277208328247
Epoch: 2, Steps: 17 | Train Loss: 0.502 Vali Loss: 1.973 Vali Acc: 0.553 Test Loss: 1.973 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.28806757926941
Epoch: 3, Steps: 17 | Train Loss: 0.873 Vali Loss: 2.054 Vali Acc: 0.584 Test Loss: 2.054 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.954469919204712
Epoch: 4, Steps: 17 | Train Loss: 0.383 Vali Loss: 2.651 Vali Acc: 0.563 Test Loss: 2.651 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.581581354141235
Epoch: 5, Steps: 17 | Train Loss: 0.266 Vali Loss: 2.443 Vali Acc: 0.573 Test Loss: 2.443 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.609172821044922
Epoch: 6, Steps: 17 | Train Loss: 0.423 Vali Loss: 3.940 Vali Acc: 0.570 Test Loss: 3.940 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.573505163192749
Epoch: 7, Steps: 17 | Train Loss: 0.150 Vali Loss: 2.769 Vali Acc: 0.597 Test Loss: 2.769 Test Acc: 0.597
Validation loss decreased (-0.583608 --> -0.597242).  Saving model ...
Epoch: 8 cost time: 13.713768243789673
Epoch: 8, Steps: 17 | Train Loss: 0.326 Vali Loss: 3.009 Vali Acc: 0.611 Test Loss: 3.009 Test Acc: 0.611
Validation loss decreased (-0.597242 --> -0.610891).  Saving model ...
Epoch: 9 cost time: 11.924921035766602
Epoch: 9, Steps: 17 | Train Loss: 0.905 Vali Loss: 7.273 Vali Acc: 0.563 Test Loss: 7.273 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.543705224990845
Epoch: 10, Steps: 17 | Train Loss: 1.104 Vali Loss: 6.804 Vali Acc: 0.539 Test Loss: 6.804 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.626041650772095
Epoch: 11, Steps: 17 | Train Loss: 0.557 Vali Loss: 5.097 Vali Acc: 0.618 Test Loss: 5.097 Test Acc: 0.618
Validation loss decreased (-0.610891 --> -0.617696).  Saving model ...
Epoch: 12 cost time: 13.813820838928223
Epoch: 12, Steps: 17 | Train Loss: 0.255 Vali Loss: 5.423 Vali Acc: 0.608 Test Loss: 5.423 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.80342721939087
Epoch: 13, Steps: 17 | Train Loss: 0.063 Vali Loss: 5.801 Vali Acc: 0.645 Test Loss: 5.801 Test Acc: 0.645
Validation loss decreased (-0.617696 --> -0.644993).  Saving model ...
Epoch: 14 cost time: 14.743906021118164
Epoch: 14, Steps: 17 | Train Loss: 0.906 Vali Loss: 7.242 Vali Acc: 0.580 Test Loss: 7.242 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.251457929611206
Epoch: 15, Steps: 17 | Train Loss: 0.414 Vali Loss: 9.915 Vali Acc: 0.543 Test Loss: 9.915 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.863807201385498
Epoch: 16, Steps: 17 | Train Loss: 0.124 Vali Loss: 9.240 Vali Acc: 0.563 Test Loss: 9.240 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.635446310043335
Epoch: 17, Steps: 17 | Train Loss: 0.288 Vali Loss: 7.066 Vali Acc: 0.577 Test Loss: 7.066 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 13.969361066818237
Epoch: 18, Steps: 17 | Train Loss: 0.379 Vali Loss: 8.742 Vali Acc: 0.590 Test Loss: 8.742 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 12.325531721115112
Epoch: 19, Steps: 17 | Train Loss: 0.235 Vali Loss: 10.775 Vali Acc: 0.556 Test Loss: 10.775 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 14.639378547668457
Epoch: 20, Steps: 17 | Train Loss: 0.344 Vali Loss: 9.058 Vali Acc: 0.597 Test Loss: 9.058 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 13.988569259643555
Epoch: 21, Steps: 17 | Train Loss: 0.286 Vali Loss: 16.896 Vali Acc: 0.553 Test Loss: 16.896 Test Acc: 0.553
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 13.585772275924683
Epoch: 22, Steps: 17 | Train Loss: 0.536 Vali Loss: 8.788 Vali Acc: 0.594 Test Loss: 8.788 Test Acc: 0.594
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 12.170934915542603
Epoch: 23, Steps: 17 | Train Loss: 0.251 Vali Loss: 14.803 Vali Acc: 0.563 Test Loss: 14.803 Test Acc: 0.563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6450511945392492
model parameter : 6243074
model size : 33.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 12.672683000564575
Epoch: 1, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.817 Vali Acc: 0.573 Test Loss: 0.817 Test Acc: 0.573
Validation loss decreased (inf --> -0.573371).  Saving model ...
Epoch: 2 cost time: 12.229362964630127
Epoch: 2, Steps: 17 | Train Loss: 0.595 Vali Loss: 1.962 Vali Acc: 0.526 Test Loss: 1.962 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.090132236480713
Epoch: 3, Steps: 17 | Train Loss: 0.556 Vali Loss: 4.098 Vali Acc: 0.512 Test Loss: 4.098 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.654309749603271
Epoch: 4, Steps: 17 | Train Loss: 0.755 Vali Loss: 2.349 Vali Acc: 0.570 Test Loss: 2.349 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.689112663269043
Epoch: 5, Steps: 17 | Train Loss: 0.465 Vali Loss: 3.102 Vali Acc: 0.573 Test Loss: 3.102 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.918159008026123
Epoch: 6, Steps: 17 | Train Loss: 0.517 Vali Loss: 5.913 Vali Acc: 0.526 Test Loss: 5.913 Test Acc: 0.526
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.285163402557373
Epoch: 7, Steps: 17 | Train Loss: 0.458 Vali Loss: 3.191 Vali Acc: 0.611 Test Loss: 3.191 Test Acc: 0.611
Validation loss decreased (-0.573371 --> -0.610890).  Saving model ...
Epoch: 8 cost time: 11.796711444854736
Epoch: 8, Steps: 17 | Train Loss: 0.567 Vali Loss: 3.602 Vali Acc: 0.635 Test Loss: 3.602 Test Acc: 0.635
Validation loss decreased (-0.610890 --> -0.634776).  Saving model ...
Epoch: 9 cost time: 12.976945638656616
Epoch: 9, Steps: 17 | Train Loss: 0.367 Vali Loss: 3.932 Vali Acc: 0.604 Test Loss: 3.932 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.286510705947876
Epoch: 10, Steps: 17 | Train Loss: 0.292 Vali Loss: 5.850 Vali Acc: 0.570 Test Loss: 5.850 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.497109651565552
Epoch: 11, Steps: 17 | Train Loss: 0.317 Vali Loss: 4.326 Vali Acc: 0.604 Test Loss: 4.326 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.331564903259277
Epoch: 12, Steps: 17 | Train Loss: 0.600 Vali Loss: 5.380 Vali Acc: 0.628 Test Loss: 5.380 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 13.462451457977295
Epoch: 13, Steps: 17 | Train Loss: 0.356 Vali Loss: 6.419 Vali Acc: 0.608 Test Loss: 6.419 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 13.254311323165894
Epoch: 14, Steps: 17 | Train Loss: 0.519 Vali Loss: 5.504 Vali Acc: 0.618 Test Loss: 5.504 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 13.273912191390991
Epoch: 15, Steps: 17 | Train Loss: 1.129 Vali Loss: 10.580 Vali Acc: 0.570 Test Loss: 10.580 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.329431056976318
Epoch: 16, Steps: 17 | Train Loss: 0.565 Vali Loss: 7.969 Vali Acc: 0.597 Test Loss: 7.969 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.776724338531494
Epoch: 17, Steps: 17 | Train Loss: 0.622 Vali Loss: 8.470 Vali Acc: 0.604 Test Loss: 8.470 Test Acc: 0.604
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.386854410171509
Epoch: 18, Steps: 17 | Train Loss: 0.109 Vali Loss: 9.917 Vali Acc: 0.614 Test Loss: 9.917 Test Acc: 0.614
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6348122866894198
model parameter : 6243074
model size : 33.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 13.849398612976074
Epoch: 1, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.904 Vali Acc: 0.536 Test Loss: 0.904 Test Acc: 0.536
Validation loss decreased (inf --> -0.535827).  Saving model ...
Epoch: 2 cost time: 12.210776090621948
Epoch: 2, Steps: 17 | Train Loss: 0.559 Vali Loss: 2.404 Vali Acc: 0.502 Test Loss: 2.404 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.246160984039307
Epoch: 3, Steps: 17 | Train Loss: 0.855 Vali Loss: 1.470 Vali Acc: 0.604 Test Loss: 1.470 Test Acc: 0.604
Validation loss decreased (-0.535827 --> -0.604081).  Saving model ...
Epoch: 4 cost time: 12.179309368133545
Epoch: 4, Steps: 17 | Train Loss: 0.467 Vali Loss: 3.377 Vali Acc: 0.509 Test Loss: 3.377 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.216397523880005
Epoch: 5, Steps: 17 | Train Loss: 0.512 Vali Loss: 1.727 Vali Acc: 0.597 Test Loss: 1.727 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.07030463218689
Epoch: 6, Steps: 17 | Train Loss: 0.230 Vali Loss: 2.187 Vali Acc: 0.563 Test Loss: 2.187 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.040689706802368
Epoch: 7, Steps: 17 | Train Loss: 0.502 Vali Loss: 2.403 Vali Acc: 0.614 Test Loss: 2.403 Test Acc: 0.614
Validation loss decreased (-0.604081 --> -0.614310).  Saving model ...
Epoch: 8 cost time: 11.727090835571289
Epoch: 8, Steps: 17 | Train Loss: 0.222 Vali Loss: 3.603 Vali Acc: 0.580 Test Loss: 3.603 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.344238042831421
Epoch: 9, Steps: 17 | Train Loss: 0.181 Vali Loss: 5.040 Vali Acc: 0.546 Test Loss: 5.040 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.168037414550781
Epoch: 10, Steps: 17 | Train Loss: 0.223 Vali Loss: 5.019 Vali Acc: 0.536 Test Loss: 5.019 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.248560667037964
Epoch: 11, Steps: 17 | Train Loss: 0.462 Vali Loss: 5.690 Vali Acc: 0.573 Test Loss: 5.690 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.140975713729858
Epoch: 12, Steps: 17 | Train Loss: 0.202 Vali Loss: 9.283 Vali Acc: 0.515 Test Loss: 9.283 Test Acc: 0.515
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.649162769317627
Epoch: 13, Steps: 17 | Train Loss: 0.888 Vali Loss: 6.541 Vali Acc: 0.573 Test Loss: 6.541 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.926921367645264
Epoch: 14, Steps: 17 | Train Loss: 0.502 Vali Loss: 4.936 Vali Acc: 0.604 Test Loss: 4.936 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.701559066772461
Epoch: 15, Steps: 17 | Train Loss: 0.946 Vali Loss: 10.045 Vali Acc: 0.563 Test Loss: 10.045 Test Acc: 0.563
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.336516857147217
Epoch: 16, Steps: 17 | Train Loss: 0.339 Vali Loss: 10.004 Vali Acc: 0.553 Test Loss: 10.004 Test Acc: 0.553
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.213186025619507
Epoch: 17, Steps: 17 | Train Loss: 0.319 Vali Loss: 6.322 Vali Acc: 0.601 Test Loss: 6.322 Test Acc: 0.601
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6143344709897611
model parameter : 6243074
model size : 33.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 12.627767562866211
Epoch: 1, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.788 Vali Acc: 0.560 Test Loss: 0.788 Test Acc: 0.560
Validation loss decreased (inf --> -0.559719).  Saving model ...
Epoch: 2 cost time: 11.222067594528198
Epoch: 2, Steps: 17 | Train Loss: 0.523 Vali Loss: 1.860 Vali Acc: 0.522 Test Loss: 1.860 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.076788187026978
Epoch: 3, Steps: 17 | Train Loss: 0.784 Vali Loss: 2.106 Vali Acc: 0.539 Test Loss: 2.106 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.036412477493286
Epoch: 4, Steps: 17 | Train Loss: 0.530 Vali Loss: 1.363 Vali Acc: 0.594 Test Loss: 1.363 Test Acc: 0.594
Validation loss decreased (-0.559719 --> -0.593843).  Saving model ...
Epoch: 5 cost time: 10.294025897979736
Epoch: 5, Steps: 17 | Train Loss: 0.423 Vali Loss: 2.154 Vali Acc: 0.539 Test Loss: 2.154 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.423124074935913
Epoch: 6, Steps: 17 | Train Loss: 0.648 Vali Loss: 2.513 Vali Acc: 0.556 Test Loss: 2.513 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.637415647506714
Epoch: 7, Steps: 17 | Train Loss: 0.279 Vali Loss: 2.445 Vali Acc: 0.587 Test Loss: 2.445 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.450095891952515
Epoch: 8, Steps: 17 | Train Loss: 0.799 Vali Loss: 3.183 Vali Acc: 0.573 Test Loss: 3.183 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.794543504714966
Epoch: 9, Steps: 17 | Train Loss: 1.063 Vali Loss: 3.592 Vali Acc: 0.549 Test Loss: 3.592 Test Acc: 0.549
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.343533515930176
Epoch: 10, Steps: 17 | Train Loss: 0.486 Vali Loss: 8.516 Vali Acc: 0.526 Test Loss: 8.516 Test Acc: 0.526
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.784968137741089
Epoch: 11, Steps: 17 | Train Loss: 0.610 Vali Loss: 4.084 Vali Acc: 0.553 Test Loss: 4.084 Test Acc: 0.553
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.12758731842041
Epoch: 12, Steps: 17 | Train Loss: 0.248 Vali Loss: 4.473 Vali Acc: 0.567 Test Loss: 4.473 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.873932123184204
Epoch: 13, Steps: 17 | Train Loss: 0.380 Vali Loss: 5.989 Vali Acc: 0.549 Test Loss: 5.989 Test Acc: 0.549
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.382740259170532
Epoch: 14, Steps: 17 | Train Loss: 0.478 Vali Loss: 9.177 Vali Acc: 0.560 Test Loss: 9.177 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5938566552901023
model parameter : 6243074
model size : 33.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.343889236450195
Epoch: 1, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.743 Vali Acc: 0.529 Test Loss: 0.743 Test Acc: 0.529
Validation loss decreased (inf --> -0.529003).  Saving model ...
Epoch: 2 cost time: 7.354653596878052
Epoch: 2, Steps: 17 | Train Loss: 0.586 Vali Loss: 1.641 Vali Acc: 0.532 Test Loss: 1.641 Test Acc: 0.532
Validation loss decreased (-0.529003 --> -0.532407).  Saving model ...
Epoch: 3 cost time: 9.847246646881104
Epoch: 3, Steps: 17 | Train Loss: 0.560 Vali Loss: 3.003 Vali Acc: 0.522 Test Loss: 3.003 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.415487289428711
Epoch: 4, Steps: 17 | Train Loss: 0.427 Vali Loss: 2.138 Vali Acc: 0.532 Test Loss: 2.138 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.873346328735352
Epoch: 5, Steps: 17 | Train Loss: 0.617 Vali Loss: 2.516 Vali Acc: 0.546 Test Loss: 2.516 Test Acc: 0.546
Validation loss decreased (-0.532407 --> -0.546050).  Saving model ...
Epoch: 6 cost time: 11.23513150215149
Epoch: 6, Steps: 17 | Train Loss: 0.648 Vali Loss: 3.377 Vali Acc: 0.512 Test Loss: 3.377 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.435700416564941
Epoch: 7, Steps: 17 | Train Loss: 0.580 Vali Loss: 3.297 Vali Acc: 0.515 Test Loss: 3.297 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.64552092552185
Epoch: 8, Steps: 17 | Train Loss: 0.458 Vali Loss: 3.249 Vali Acc: 0.498 Test Loss: 3.249 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.507388830184937
Epoch: 9, Steps: 17 | Train Loss: 0.580 Vali Loss: 3.760 Vali Acc: 0.519 Test Loss: 3.760 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.072073698043823
Epoch: 10, Steps: 17 | Train Loss: 0.409 Vali Loss: 5.246 Vali Acc: 0.539 Test Loss: 5.246 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.402585506439209
Epoch: 11, Steps: 17 | Train Loss: 0.666 Vali Loss: 9.954 Vali Acc: 0.509 Test Loss: 9.954 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.283096551895142
Epoch: 12, Steps: 17 | Train Loss: 0.602 Vali Loss: 7.988 Vali Acc: 0.515 Test Loss: 7.988 Test Acc: 0.515
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.144946575164795
Epoch: 13, Steps: 17 | Train Loss: 0.533 Vali Loss: 6.021 Vali Acc: 0.532 Test Loss: 6.021 Test Acc: 0.532
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.493017673492432
Epoch: 14, Steps: 17 | Train Loss: 0.309 Vali Loss: 6.328 Vali Acc: 0.543 Test Loss: 6.328 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.31782603263855
Epoch: 15, Steps: 17 | Train Loss: 0.849 Vali Loss: 8.355 Vali Acc: 0.546 Test Loss: 8.355 Test Acc: 0.546
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5460750853242321
model parameter : 6243074
model size : 33.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 12.768534660339355
Epoch: 1, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.833 Vali Acc: 0.502 Test Loss: 0.833 Test Acc: 0.502
Validation loss decreased (inf --> -0.501698).  Saving model ...
Epoch: 2 cost time: 10.753058433532715
Epoch: 2, Steps: 17 | Train Loss: 0.663 Vali Loss: 1.257 Vali Acc: 0.502 Test Loss: 1.257 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.263330936431885
Epoch: 3, Steps: 17 | Train Loss: 0.689 Vali Loss: 1.379 Vali Acc: 0.502 Test Loss: 1.379 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.825451612472534
Epoch: 4, Steps: 17 | Train Loss: 0.599 Vali Loss: 1.589 Vali Acc: 0.498 Test Loss: 1.589 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.688955307006836
Epoch: 5, Steps: 17 | Train Loss: 0.560 Vali Loss: 1.185 Vali Acc: 0.536 Test Loss: 1.185 Test Acc: 0.536
Validation loss decreased (-0.501698 --> -0.535824).  Saving model ...
Epoch: 6 cost time: 10.375306606292725
Epoch: 6, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.929 Vali Acc: 0.573 Test Loss: 0.929 Test Acc: 0.573
Validation loss decreased (-0.535824 --> -0.573370).  Saving model ...
Epoch: 7 cost time: 11.370294332504272
Epoch: 7, Steps: 17 | Train Loss: 0.358 Vali Loss: 1.823 Vali Acc: 0.532 Test Loss: 1.823 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.356119871139526
Epoch: 8, Steps: 17 | Train Loss: 0.502 Vali Loss: 1.637 Vali Acc: 0.546 Test Loss: 1.637 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.566368103027344
Epoch: 9, Steps: 17 | Train Loss: 0.710 Vali Loss: 1.544 Vali Acc: 0.608 Test Loss: 1.544 Test Acc: 0.608
Validation loss decreased (-0.573370 --> -0.607493).  Saving model ...
Epoch: 10 cost time: 9.507946968078613
Epoch: 10, Steps: 17 | Train Loss: 0.384 Vali Loss: 1.963 Vali Acc: 0.560 Test Loss: 1.963 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.047095775604248
Epoch: 11, Steps: 17 | Train Loss: 0.413 Vali Loss: 3.833 Vali Acc: 0.519 Test Loss: 3.833 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.56478500366211
Epoch: 12, Steps: 17 | Train Loss: 0.461 Vali Loss: 1.985 Vali Acc: 0.597 Test Loss: 1.985 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.12547755241394
Epoch: 13, Steps: 17 | Train Loss: 0.789 Vali Loss: 2.203 Vali Acc: 0.543 Test Loss: 2.203 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.533191204071045
Epoch: 14, Steps: 17 | Train Loss: 0.381 Vali Loss: 3.468 Vali Acc: 0.549 Test Loss: 3.468 Test Acc: 0.549
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.229723691940308
Epoch: 15, Steps: 17 | Train Loss: 0.906 Vali Loss: 4.268 Vali Acc: 0.563 Test Loss: 4.268 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.889453172683716
Epoch: 16, Steps: 17 | Train Loss: 0.981 Vali Loss: 4.142 Vali Acc: 0.546 Test Loss: 4.142 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.779170989990234
Epoch: 17, Steps: 17 | Train Loss: 0.537 Vali Loss: 5.253 Vali Acc: 0.536 Test Loss: 5.253 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 11.11515474319458
Epoch: 18, Steps: 17 | Train Loss: 0.611 Vali Loss: 4.027 Vali Acc: 0.563 Test Loss: 4.027 Test Acc: 0.563
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.501453876495361
Epoch: 19, Steps: 17 | Train Loss: 0.680 Vali Loss: 5.326 Vali Acc: 0.549 Test Loss: 5.326 Test Acc: 0.549
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6075085324232082
model parameter : 6243074
model size : 33.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 11.317815065383911
Epoch: 1, Steps: 17 | Train Loss: 0.673 Vali Loss: 1.109 Vali Acc: 0.502 Test Loss: 1.109 Test Acc: 0.502
Validation loss decreased (inf --> -0.501695).  Saving model ...
Epoch: 2 cost time: 8.731414794921875
Epoch: 2, Steps: 17 | Train Loss: 0.668 Vali Loss: 1.291 Vali Acc: 0.502 Test Loss: 1.291 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.2687318325042725
Epoch: 3, Steps: 17 | Train Loss: 0.520 Vali Loss: 1.037 Vali Acc: 0.522 Test Loss: 1.037 Test Acc: 0.522
Validation loss decreased (-0.501695 --> -0.522174).  Saving model ...
Epoch: 4 cost time: 9.839658975601196
Epoch: 4, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.908 Vali Acc: 0.560 Test Loss: 0.908 Test Acc: 0.560
Validation loss decreased (-0.522174 --> -0.559718).  Saving model ...
Epoch: 5 cost time: 9.18459415435791
Epoch: 5, Steps: 17 | Train Loss: 0.523 Vali Loss: 1.094 Vali Acc: 0.573 Test Loss: 1.094 Test Acc: 0.573
Validation loss decreased (-0.559718 --> -0.573368).  Saving model ...
Epoch: 6 cost time: 9.902350664138794
Epoch: 6, Steps: 17 | Train Loss: 0.531 Vali Loss: 2.774 Vali Acc: 0.543 Test Loss: 2.774 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.010641098022461
Epoch: 7, Steps: 17 | Train Loss: 0.423 Vali Loss: 2.061 Vali Acc: 0.587 Test Loss: 2.061 Test Acc: 0.587
Validation loss decreased (-0.573368 --> -0.587010).  Saving model ...
Epoch: 8 cost time: 8.18112850189209
Epoch: 8, Steps: 17 | Train Loss: 0.434 Vali Loss: 3.011 Vali Acc: 0.567 Test Loss: 3.011 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.632572650909424
Epoch: 9, Steps: 17 | Train Loss: 0.540 Vali Loss: 3.551 Vali Acc: 0.590 Test Loss: 3.551 Test Acc: 0.590
Validation loss decreased (-0.587010 --> -0.590408).  Saving model ...
Epoch: 10 cost time: 10.03378963470459
Epoch: 10, Steps: 17 | Train Loss: 0.701 Vali Loss: 2.667 Vali Acc: 0.580 Test Loss: 2.667 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.41935920715332
Epoch: 11, Steps: 17 | Train Loss: 0.718 Vali Loss: 3.102 Vali Acc: 0.543 Test Loss: 3.102 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.504424095153809
Epoch: 12, Steps: 17 | Train Loss: 0.479 Vali Loss: 4.085 Vali Acc: 0.560 Test Loss: 4.085 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.96921706199646
Epoch: 13, Steps: 17 | Train Loss: 0.370 Vali Loss: 3.190 Vali Acc: 0.556 Test Loss: 3.190 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.699113607406616
Epoch: 14, Steps: 17 | Train Loss: 0.514 Vali Loss: 4.704 Vali Acc: 0.522 Test Loss: 4.704 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.47500491142273
Epoch: 15, Steps: 17 | Train Loss: 0.494 Vali Loss: 6.283 Vali Acc: 0.587 Test Loss: 6.283 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.753007888793945
Epoch: 16, Steps: 17 | Train Loss: 0.529 Vali Loss: 8.085 Vali Acc: 0.573 Test Loss: 8.085 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.374894142150879
Epoch: 17, Steps: 17 | Train Loss: 0.461 Vali Loss: 5.669 Vali Acc: 0.560 Test Loss: 5.669 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.59401273727417
Epoch: 18, Steps: 17 | Train Loss: 1.052 Vali Loss: 5.449 Vali Acc: 0.553 Test Loss: 5.449 Test Acc: 0.553
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.297438144683838
Epoch: 19, Steps: 17 | Train Loss: 0.991 Vali Loss: 7.563 Vali Acc: 0.573 Test Loss: 7.563 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.590443686006826
model parameter : 6243074
model size : 33.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 17.551173448562622
Epoch: 1, Steps: 17 | Train Loss: 0.837 Vali Loss: 0.748 Vali Acc: 0.601 Test Loss: 0.748 Test Acc: 0.601
Validation loss decreased (inf --> -0.600675).  Saving model ...
Epoch: 2 cost time: 16.41387963294983
Epoch: 2, Steps: 17 | Train Loss: 0.504 Vali Loss: 1.006 Vali Acc: 0.570 Test Loss: 1.006 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.642159461975098
Epoch: 3, Steps: 17 | Train Loss: 0.882 Vali Loss: 1.332 Vali Acc: 0.666 Test Loss: 1.332 Test Acc: 0.666
Validation loss decreased (-0.600675 --> -0.665516).  Saving model ...
Epoch: 4 cost time: 17.17349600791931
Epoch: 4, Steps: 17 | Train Loss: 0.599 Vali Loss: 7.468 Vali Acc: 0.502 Test Loss: 7.468 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.896897315979004
Epoch: 5, Steps: 17 | Train Loss: 0.923 Vali Loss: 2.509 Vali Acc: 0.608 Test Loss: 2.509 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.24691128730774
Epoch: 6, Steps: 17 | Train Loss: 0.305 Vali Loss: 3.518 Vali Acc: 0.645 Test Loss: 3.518 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.610384702682495
Epoch: 7, Steps: 17 | Train Loss: 0.495 Vali Loss: 3.610 Vali Acc: 0.628 Test Loss: 3.610 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.051264524459839
Epoch: 8, Steps: 17 | Train Loss: 0.463 Vali Loss: 5.662 Vali Acc: 0.594 Test Loss: 5.662 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.289281368255615
Epoch: 9, Steps: 17 | Train Loss: 0.135 Vali Loss: 3.766 Vali Acc: 0.645 Test Loss: 3.766 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 17.689653635025024
Epoch: 10, Steps: 17 | Train Loss: 0.639 Vali Loss: 9.421 Vali Acc: 0.539 Test Loss: 9.421 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 16.372169971466064
Epoch: 11, Steps: 17 | Train Loss: 0.612 Vali Loss: 5.863 Vali Acc: 0.642 Test Loss: 5.863 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 14.507548570632935
Epoch: 12, Steps: 17 | Train Loss: 0.249 Vali Loss: 4.889 Vali Acc: 0.662 Test Loss: 4.889 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 16.835976123809814
Epoch: 13, Steps: 17 | Train Loss: 0.131 Vali Loss: 5.490 Vali Acc: 0.662 Test Loss: 5.490 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6655290102389079
model parameter : 4670210
model size : 27.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 16.970094680786133
Epoch: 1, Steps: 17 | Train Loss: 0.903 Vali Loss: 0.729 Vali Acc: 0.614 Test Loss: 0.729 Test Acc: 0.614
Validation loss decreased (inf --> -0.614327).  Saving model ...
Epoch: 2 cost time: 14.441308736801147
Epoch: 2, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.932 Vali Acc: 0.645 Test Loss: 0.932 Test Acc: 0.645
Validation loss decreased (-0.614327 --> -0.645042).  Saving model ...
Epoch: 3 cost time: 10.127412557601929
Epoch: 3, Steps: 17 | Train Loss: 0.433 Vali Loss: 1.324 Vali Acc: 0.597 Test Loss: 1.324 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.394598007202148
Epoch: 4, Steps: 17 | Train Loss: 0.484 Vali Loss: 5.154 Vali Acc: 0.532 Test Loss: 5.154 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.049610614776611
Epoch: 5, Steps: 17 | Train Loss: 0.440 Vali Loss: 3.174 Vali Acc: 0.577 Test Loss: 3.174 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.481581926345825
Epoch: 6, Steps: 17 | Train Loss: 0.411 Vali Loss: 2.753 Vali Acc: 0.628 Test Loss: 2.753 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.309272766113281
Epoch: 7, Steps: 17 | Train Loss: 0.331 Vali Loss: 2.011 Vali Acc: 0.597 Test Loss: 2.011 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.049659490585327
Epoch: 8, Steps: 17 | Train Loss: 0.539 Vali Loss: 3.026 Vali Acc: 0.625 Test Loss: 3.026 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.577897787094116
Epoch: 9, Steps: 17 | Train Loss: 0.276 Vali Loss: 4.272 Vali Acc: 0.608 Test Loss: 4.272 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 14.401512861251831
Epoch: 10, Steps: 17 | Train Loss: 0.136 Vali Loss: 3.262 Vali Acc: 0.618 Test Loss: 3.262 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 15.279401779174805
Epoch: 11, Steps: 17 | Train Loss: 0.263 Vali Loss: 6.175 Vali Acc: 0.621 Test Loss: 6.175 Test Acc: 0.621
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 15.120109558105469
Epoch: 12, Steps: 17 | Train Loss: 0.323 Vali Loss: 4.602 Vali Acc: 0.587 Test Loss: 4.602 Test Acc: 0.587
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6450511945392492
model parameter : 4670210
model size : 27.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 14.836596250534058
Epoch: 1, Steps: 17 | Train Loss: 0.965 Vali Loss: 0.796 Vali Acc: 0.543 Test Loss: 0.796 Test Acc: 0.543
Validation loss decreased (inf --> -0.542654).  Saving model ...
Epoch: 2 cost time: 12.787737369537354
Epoch: 2, Steps: 17 | Train Loss: 0.601 Vali Loss: 1.100 Vali Acc: 0.601 Test Loss: 1.100 Test Acc: 0.601
Validation loss decreased (-0.542654 --> -0.600672).  Saving model ...
Epoch: 3 cost time: 11.88857126235962
Epoch: 3, Steps: 17 | Train Loss: 0.484 Vali Loss: 1.614 Vali Acc: 0.556 Test Loss: 1.614 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.656055212020874
Epoch: 4, Steps: 17 | Train Loss: 0.419 Vali Loss: 2.101 Vali Acc: 0.567 Test Loss: 2.101 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.970377922058105
Epoch: 5, Steps: 17 | Train Loss: 0.468 Vali Loss: 1.715 Vali Acc: 0.625 Test Loss: 1.715 Test Acc: 0.625
Validation loss decreased (-0.600672 --> -0.624556).  Saving model ...
Epoch: 6 cost time: 10.178203582763672
Epoch: 6, Steps: 17 | Train Loss: 0.318 Vali Loss: 2.292 Vali Acc: 0.594 Test Loss: 2.292 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.410916566848755
Epoch: 7, Steps: 17 | Train Loss: 0.373 Vali Loss: 2.652 Vali Acc: 0.621 Test Loss: 2.652 Test Acc: 0.621
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.361278772354126
Epoch: 8, Steps: 17 | Train Loss: 0.522 Vali Loss: 3.544 Vali Acc: 0.648 Test Loss: 3.544 Test Acc: 0.648
Validation loss decreased (-0.624556 --> -0.648429).  Saving model ...
Epoch: 9 cost time: 13.739722728729248
Epoch: 9, Steps: 17 | Train Loss: 0.292 Vali Loss: 4.694 Vali Acc: 0.608 Test Loss: 4.694 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.048314809799194
Epoch: 10, Steps: 17 | Train Loss: 0.163 Vali Loss: 4.009 Vali Acc: 0.638 Test Loss: 4.009 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.785105466842651
Epoch: 11, Steps: 17 | Train Loss: 0.427 Vali Loss: 9.482 Vali Acc: 0.549 Test Loss: 9.482 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.10917592048645
Epoch: 12, Steps: 17 | Train Loss: 0.400 Vali Loss: 5.521 Vali Acc: 0.625 Test Loss: 5.521 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 14.184615135192871
Epoch: 13, Steps: 17 | Train Loss: 0.232 Vali Loss: 10.403 Vali Acc: 0.553 Test Loss: 10.403 Test Acc: 0.553
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 13.369361162185669
Epoch: 14, Steps: 17 | Train Loss: 0.430 Vali Loss: 12.105 Vali Acc: 0.560 Test Loss: 12.105 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 13.536391019821167
Epoch: 15, Steps: 17 | Train Loss: 0.729 Vali Loss: 5.674 Vali Acc: 0.631 Test Loss: 5.674 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 13.853929996490479
Epoch: 16, Steps: 17 | Train Loss: 0.526 Vali Loss: 7.649 Vali Acc: 0.597 Test Loss: 7.649 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.15874981880188
Epoch: 17, Steps: 17 | Train Loss: 0.262 Vali Loss: 7.209 Vali Acc: 0.604 Test Loss: 7.209 Test Acc: 0.604
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 14.428873777389526
Epoch: 18, Steps: 17 | Train Loss: 0.390 Vali Loss: 13.596 Vali Acc: 0.601 Test Loss: 13.596 Test Acc: 0.601
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6484641638225256
model parameter : 4670210
model size : 27.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 11.374656677246094
Epoch: 1, Steps: 17 | Train Loss: 0.924 Vali Loss: 0.763 Vali Acc: 0.594 Test Loss: 0.763 Test Acc: 0.594
Validation loss decreased (inf --> -0.593849).  Saving model ...
Epoch: 2 cost time: 13.247389316558838
Epoch: 2, Steps: 17 | Train Loss: 0.531 Vali Loss: 1.024 Vali Acc: 0.570 Test Loss: 1.024 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.264652729034424
Epoch: 3, Steps: 17 | Train Loss: 0.452 Vali Loss: 1.557 Vali Acc: 0.549 Test Loss: 1.557 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.831070899963379
Epoch: 4, Steps: 17 | Train Loss: 0.388 Vali Loss: 1.760 Vali Acc: 0.604 Test Loss: 1.760 Test Acc: 0.604
Validation loss decreased (-0.593849 --> -0.604078).  Saving model ...
Epoch: 5 cost time: 12.765807390213013
Epoch: 5, Steps: 17 | Train Loss: 0.296 Vali Loss: 2.169 Vali Acc: 0.590 Test Loss: 2.169 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.016870737075806
Epoch: 6, Steps: 17 | Train Loss: 0.269 Vali Loss: 2.568 Vali Acc: 0.584 Test Loss: 2.568 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.043123960494995
Epoch: 7, Steps: 17 | Train Loss: 0.208 Vali Loss: 2.786 Vali Acc: 0.594 Test Loss: 2.786 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.61702561378479
Epoch: 8, Steps: 17 | Train Loss: 0.152 Vali Loss: 4.767 Vali Acc: 0.590 Test Loss: 4.767 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.029143571853638
Epoch: 9, Steps: 17 | Train Loss: 0.355 Vali Loss: 7.632 Vali Acc: 0.539 Test Loss: 7.632 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.750363111495972
Epoch: 10, Steps: 17 | Train Loss: 0.617 Vali Loss: 4.768 Vali Acc: 0.567 Test Loss: 4.768 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.8536696434021
Epoch: 11, Steps: 17 | Train Loss: 0.307 Vali Loss: 9.161 Vali Acc: 0.539 Test Loss: 9.161 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 13.841423034667969
Epoch: 12, Steps: 17 | Train Loss: 0.487 Vali Loss: 5.719 Vali Acc: 0.577 Test Loss: 5.719 Test Acc: 0.577
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 13.203583002090454
Epoch: 13, Steps: 17 | Train Loss: 0.549 Vali Loss: 5.320 Vali Acc: 0.580 Test Loss: 5.320 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.932837009429932
Epoch: 14, Steps: 17 | Train Loss: 0.759 Vali Loss: 8.781 Vali Acc: 0.584 Test Loss: 8.781 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6040955631399317
model parameter : 4670210
model size : 27.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.150142669677734
Epoch: 1, Steps: 17 | Train Loss: 0.898 Vali Loss: 0.736 Vali Acc: 0.556 Test Loss: 0.736 Test Acc: 0.556
Validation loss decreased (inf --> -0.556307).  Saving model ...
Epoch: 2 cost time: 10.271839618682861
Epoch: 2, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.963 Vali Acc: 0.570 Test Loss: 0.963 Test Acc: 0.570
Validation loss decreased (-0.556307 --> -0.569956).  Saving model ...
Epoch: 3 cost time: 10.502722263336182
Epoch: 3, Steps: 17 | Train Loss: 0.783 Vali Loss: 4.193 Vali Acc: 0.505 Test Loss: 4.193 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.284706830978394
Epoch: 4, Steps: 17 | Train Loss: 0.868 Vali Loss: 3.216 Vali Acc: 0.546 Test Loss: 3.216 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.730303049087524
Epoch: 5, Steps: 17 | Train Loss: 0.336 Vali Loss: 3.599 Vali Acc: 0.590 Test Loss: 3.599 Test Acc: 0.590
Validation loss decreased (-0.569956 --> -0.590408).  Saving model ...
Epoch: 6 cost time: 11.22760534286499
Epoch: 6, Steps: 17 | Train Loss: 0.451 Vali Loss: 2.001 Vali Acc: 0.655 Test Loss: 2.001 Test Acc: 0.655
Validation loss decreased (-0.590408 --> -0.655270).  Saving model ...
Epoch: 7 cost time: 11.407664060592651
Epoch: 7, Steps: 17 | Train Loss: 0.616 Vali Loss: 2.350 Vali Acc: 0.655 Test Loss: 2.350 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.971997261047363
Epoch: 8, Steps: 17 | Train Loss: 0.510 Vali Loss: 4.725 Vali Acc: 0.608 Test Loss: 4.725 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.163450002670288
Epoch: 9, Steps: 17 | Train Loss: 0.386 Vali Loss: 7.029 Vali Acc: 0.556 Test Loss: 7.029 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.276074647903442
Epoch: 10, Steps: 17 | Train Loss: 0.411 Vali Loss: 7.176 Vali Acc: 0.549 Test Loss: 7.176 Test Acc: 0.549
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.841310977935791
Epoch: 11, Steps: 17 | Train Loss: 0.253 Vali Loss: 7.235 Vali Acc: 0.587 Test Loss: 7.235 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.495386123657227
Epoch: 12, Steps: 17 | Train Loss: 0.302 Vali Loss: 7.097 Vali Acc: 0.590 Test Loss: 7.097 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.83829402923584
Epoch: 13, Steps: 17 | Train Loss: 0.108 Vali Loss: 5.571 Vali Acc: 0.648 Test Loss: 5.571 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.461219549179077
Epoch: 14, Steps: 17 | Train Loss: 0.344 Vali Loss: 4.934 Vali Acc: 0.621 Test Loss: 4.934 Test Acc: 0.621
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.491608619689941
Epoch: 15, Steps: 17 | Train Loss: 0.311 Vali Loss: 16.374 Vali Acc: 0.526 Test Loss: 16.374 Test Acc: 0.526
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.347354888916016
Epoch: 16, Steps: 17 | Train Loss: 0.915 Vali Loss: 5.270 Vali Acc: 0.604 Test Loss: 5.270 Test Acc: 0.604
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6552901023890785
model parameter : 4670210
model size : 27.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 11.885537385940552
Epoch: 1, Steps: 17 | Train Loss: 0.860 Vali Loss: 0.763 Vali Acc: 0.567 Test Loss: 0.763 Test Acc: 0.567
Validation loss decreased (inf --> -0.566545).  Saving model ...
Epoch: 2 cost time: 9.729701519012451
Epoch: 2, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.900 Vali Acc: 0.604 Test Loss: 0.900 Test Acc: 0.604
Validation loss decreased (-0.566545 --> -0.604087).  Saving model ...
Epoch: 3 cost time: 8.527125120162964
Epoch: 3, Steps: 17 | Train Loss: 0.589 Vali Loss: 1.300 Vali Acc: 0.597 Test Loss: 1.300 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.164413690567017
Epoch: 4, Steps: 17 | Train Loss: 0.456 Vali Loss: 1.320 Vali Acc: 0.594 Test Loss: 1.320 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.995626449584961
Epoch: 5, Steps: 17 | Train Loss: 0.303 Vali Loss: 3.054 Vali Acc: 0.546 Test Loss: 3.054 Test Acc: 0.546
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.929786682128906
Epoch: 6, Steps: 17 | Train Loss: 0.268 Vali Loss: 2.289 Vali Acc: 0.597 Test Loss: 2.289 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.061286449432373
Epoch: 7, Steps: 17 | Train Loss: 0.235 Vali Loss: 2.082 Vali Acc: 0.621 Test Loss: 2.082 Test Acc: 0.621
Validation loss decreased (-0.604087 --> -0.621140).  Saving model ...
Epoch: 8 cost time: 8.214304447174072
Epoch: 8, Steps: 17 | Train Loss: 0.421 Vali Loss: 2.565 Vali Acc: 0.594 Test Loss: 2.565 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.284533262252808
Epoch: 9, Steps: 17 | Train Loss: 0.301 Vali Loss: 4.383 Vali Acc: 0.587 Test Loss: 4.383 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.677393913269043
Epoch: 10, Steps: 17 | Train Loss: 0.435 Vali Loss: 5.287 Vali Acc: 0.556 Test Loss: 5.287 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.090293645858765
Epoch: 11, Steps: 17 | Train Loss: 0.304 Vali Loss: 4.027 Vali Acc: 0.590 Test Loss: 4.027 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.432068824768066
Epoch: 12, Steps: 17 | Train Loss: 0.219 Vali Loss: 4.018 Vali Acc: 0.621 Test Loss: 4.018 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.856087684631348
Epoch: 13, Steps: 17 | Train Loss: 0.357 Vali Loss: 5.541 Vali Acc: 0.608 Test Loss: 5.541 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.839028358459473
Epoch: 14, Steps: 17 | Train Loss: 0.107 Vali Loss: 5.642 Vali Acc: 0.577 Test Loss: 5.642 Test Acc: 0.577
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.601463079452515
Epoch: 15, Steps: 17 | Train Loss: 0.129 Vali Loss: 5.959 Vali Acc: 0.584 Test Loss: 5.959 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.48801302909851
Epoch: 16, Steps: 17 | Train Loss: 0.203 Vali Loss: 8.968 Vali Acc: 0.553 Test Loss: 8.968 Test Acc: 0.553
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.173918962478638
Epoch: 17, Steps: 17 | Train Loss: 0.306 Vali Loss: 6.131 Vali Acc: 0.625 Test Loss: 6.131 Test Acc: 0.625
Validation loss decreased (-0.621140 --> -0.624512).  Saving model ...
Epoch: 18 cost time: 8.55049991607666
Epoch: 18, Steps: 17 | Train Loss: 0.521 Vali Loss: 9.105 Vali Acc: 0.553 Test Loss: 9.105 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.072257041931152
Epoch: 19, Steps: 17 | Train Loss: 0.109 Vali Loss: 11.872 Vali Acc: 0.539 Test Loss: 11.872 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.23414158821106
Epoch: 20, Steps: 17 | Train Loss: 0.229 Vali Loss: 17.679 Vali Acc: 0.526 Test Loss: 17.679 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 8.562932252883911
Epoch: 21, Steps: 17 | Train Loss: 0.418 Vali Loss: 8.900 Vali Acc: 0.584 Test Loss: 8.900 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 8.808164834976196
Epoch: 22, Steps: 17 | Train Loss: 0.465 Vali Loss: 8.860 Vali Acc: 0.580 Test Loss: 8.860 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 9.610139846801758
Epoch: 23, Steps: 17 | Train Loss: 0.839 Vali Loss: 13.523 Vali Acc: 0.563 Test Loss: 13.523 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 9.468993186950684
Epoch: 24, Steps: 17 | Train Loss: 0.586 Vali Loss: 10.743 Vali Acc: 0.594 Test Loss: 10.743 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 8.531740665435791
Epoch: 25, Steps: 17 | Train Loss: 0.257 Vali Loss: 21.724 Vali Acc: 0.515 Test Loss: 21.724 Test Acc: 0.515
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.998393774032593
Epoch: 26, Steps: 17 | Train Loss: 0.787 Vali Loss: 9.817 Vali Acc: 0.590 Test Loss: 9.817 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 9.46455454826355
Epoch: 27, Steps: 17 | Train Loss: 0.627 Vali Loss: 17.834 Vali Acc: 0.546 Test Loss: 17.834 Test Acc: 0.546
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 4670210
model size : 27.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 11.277785539627075
Epoch: 1, Steps: 17 | Train Loss: 0.813 Vali Loss: 0.786 Vali Acc: 0.570 Test Loss: 0.786 Test Acc: 0.570
Validation loss decreased (inf --> -0.569958).  Saving model ...
Epoch: 2 cost time: 10.33832573890686
Epoch: 2, Steps: 17 | Train Loss: 0.628 Vali Loss: 1.083 Vali Acc: 0.594 Test Loss: 1.083 Test Acc: 0.594
Validation loss decreased (-0.569958 --> -0.593846).  Saving model ...
Epoch: 3 cost time: 8.917326927185059
Epoch: 3, Steps: 17 | Train Loss: 0.586 Vali Loss: 1.373 Vali Acc: 0.580 Test Loss: 1.373 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.207297086715698
Epoch: 4, Steps: 17 | Train Loss: 0.539 Vali Loss: 2.274 Vali Acc: 0.546 Test Loss: 2.274 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.195088624954224
Epoch: 5, Steps: 17 | Train Loss: 0.378 Vali Loss: 1.489 Vali Acc: 0.608 Test Loss: 1.489 Test Acc: 0.608
Validation loss decreased (-0.593846 --> -0.607494).  Saving model ...
Epoch: 6 cost time: 9.130550384521484
Epoch: 6, Steps: 17 | Train Loss: 0.356 Vali Loss: 2.416 Vali Acc: 0.549 Test Loss: 2.416 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.975087404251099
Epoch: 7, Steps: 17 | Train Loss: 0.414 Vali Loss: 2.086 Vali Acc: 0.563 Test Loss: 2.086 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.540163040161133
Epoch: 8, Steps: 17 | Train Loss: 0.382 Vali Loss: 2.393 Vali Acc: 0.573 Test Loss: 2.393 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.946847200393677
Epoch: 9, Steps: 17 | Train Loss: 0.930 Vali Loss: 4.957 Vali Acc: 0.536 Test Loss: 4.957 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.476691961288452
Epoch: 10, Steps: 17 | Train Loss: 1.140 Vali Loss: 3.809 Vali Acc: 0.536 Test Loss: 3.809 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.77403450012207
Epoch: 11, Steps: 17 | Train Loss: 0.437 Vali Loss: 3.952 Vali Acc: 0.512 Test Loss: 3.952 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.796501874923706
Epoch: 12, Steps: 17 | Train Loss: 0.455 Vali Loss: 7.516 Vali Acc: 0.529 Test Loss: 7.516 Test Acc: 0.529
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.097127914428711
Epoch: 13, Steps: 17 | Train Loss: 0.730 Vali Loss: 4.445 Vali Acc: 0.553 Test Loss: 4.445 Test Acc: 0.553
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.07821536064148
Epoch: 14, Steps: 17 | Train Loss: 0.343 Vali Loss: 5.560 Vali Acc: 0.536 Test Loss: 5.560 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.689432621002197
Epoch: 15, Steps: 17 | Train Loss: 0.460 Vali Loss: 6.051 Vali Acc: 0.549 Test Loss: 6.051 Test Acc: 0.549
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6075085324232082
model parameter : 4670210
model size : 27.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.704473733901978
Epoch: 1, Steps: 17 | Train Loss: 0.757 Vali Loss: 0.707 Vali Acc: 0.553 Test Loss: 0.707 Test Acc: 0.553
Validation loss decreased (inf --> -0.552894).  Saving model ...
Epoch: 2 cost time: 7.856647253036499
Epoch: 2, Steps: 17 | Train Loss: 0.522 Vali Loss: 1.019 Vali Acc: 0.549 Test Loss: 1.019 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.398911714553833
Epoch: 3, Steps: 17 | Train Loss: 0.533 Vali Loss: 1.235 Vali Acc: 0.567 Test Loss: 1.235 Test Acc: 0.567
Validation loss decreased (-0.552894 --> -0.566541).  Saving model ...
Epoch: 4 cost time: 8.210855960845947
Epoch: 4, Steps: 17 | Train Loss: 0.640 Vali Loss: 2.232 Vali Acc: 0.532 Test Loss: 2.232 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.88818097114563
Epoch: 5, Steps: 17 | Train Loss: 0.298 Vali Loss: 1.835 Vali Acc: 0.536 Test Loss: 1.835 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.508684158325195
Epoch: 6, Steps: 17 | Train Loss: 0.269 Vali Loss: 2.703 Vali Acc: 0.532 Test Loss: 2.703 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.679379940032959
Epoch: 7, Steps: 17 | Train Loss: 0.223 Vali Loss: 2.427 Vali Acc: 0.553 Test Loss: 2.427 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.477169513702393
Epoch: 8, Steps: 17 | Train Loss: 0.353 Vali Loss: 2.931 Vali Acc: 0.509 Test Loss: 2.931 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.780855417251587
Epoch: 9, Steps: 17 | Train Loss: 0.232 Vali Loss: 5.357 Vali Acc: 0.495 Test Loss: 5.357 Test Acc: 0.495
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.578433275222778
Epoch: 10, Steps: 17 | Train Loss: 0.183 Vali Loss: 3.394 Vali Acc: 0.529 Test Loss: 3.394 Test Acc: 0.529
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.83292555809021
Epoch: 11, Steps: 17 | Train Loss: 0.510 Vali Loss: 7.058 Vali Acc: 0.529 Test Loss: 7.058 Test Acc: 0.529
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.343684911727905
Epoch: 12, Steps: 17 | Train Loss: 0.403 Vali Loss: 7.400 Vali Acc: 0.526 Test Loss: 7.400 Test Acc: 0.526
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.567659139633179
Epoch: 13, Steps: 17 | Train Loss: 0.712 Vali Loss: 6.766 Vali Acc: 0.563 Test Loss: 6.766 Test Acc: 0.563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5665529010238908
model parameter : 4670210
model size : 27.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.02518105506897
Epoch: 1, Steps: 17 | Train Loss: 0.723 Vali Loss: 1.132 Vali Acc: 0.502 Test Loss: 1.132 Test Acc: 0.502
Validation loss decreased (inf --> -0.501695).  Saving model ...
Epoch: 2 cost time: 8.922748327255249
Epoch: 2, Steps: 17 | Train Loss: 0.616 Vali Loss: 1.009 Vali Acc: 0.498 Test Loss: 1.009 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.682190656661987
Epoch: 3, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.854 Vali Acc: 0.509 Test Loss: 0.854 Test Acc: 0.509
Validation loss decreased (-0.501695 --> -0.508524).  Saving model ...
Epoch: 4 cost time: 8.570984125137329
Epoch: 4, Steps: 17 | Train Loss: 0.457 Vali Loss: 1.492 Vali Acc: 0.498 Test Loss: 1.492 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.97731065750122
Epoch: 5, Steps: 17 | Train Loss: 0.499 Vali Loss: 1.635 Vali Acc: 0.498 Test Loss: 1.635 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.213566303253174
Epoch: 6, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.865 Vali Acc: 0.563 Test Loss: 0.865 Test Acc: 0.563
Validation loss decreased (-0.508524 --> -0.563131).  Saving model ...
Epoch: 7 cost time: 8.424592733383179
Epoch: 7, Steps: 17 | Train Loss: 0.362 Vali Loss: 2.474 Vali Acc: 0.495 Test Loss: 2.474 Test Acc: 0.495
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.112767219543457
Epoch: 8, Steps: 17 | Train Loss: 0.469 Vali Loss: 2.419 Vali Acc: 0.498 Test Loss: 2.419 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.061234712600708
Epoch: 9, Steps: 17 | Train Loss: 0.445 Vali Loss: 1.403 Vali Acc: 0.567 Test Loss: 1.403 Test Acc: 0.567
Validation loss decreased (-0.563131 --> -0.566539).  Saving model ...
Epoch: 10 cost time: 7.863782644271851
Epoch: 10, Steps: 17 | Train Loss: 0.313 Vali Loss: 2.799 Vali Acc: 0.515 Test Loss: 2.799 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.87000298500061
Epoch: 11, Steps: 17 | Train Loss: 0.566 Vali Loss: 4.108 Vali Acc: 0.505 Test Loss: 4.108 Test Acc: 0.505
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.621518850326538
Epoch: 12, Steps: 17 | Train Loss: 0.510 Vali Loss: 2.913 Vali Acc: 0.543 Test Loss: 2.913 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.11877179145813
Epoch: 13, Steps: 17 | Train Loss: 0.842 Vali Loss: 8.227 Vali Acc: 0.498 Test Loss: 8.227 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.854355812072754
Epoch: 14, Steps: 17 | Train Loss: 0.611 Vali Loss: 3.368 Vali Acc: 0.519 Test Loss: 3.368 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.236879348754883
Epoch: 15, Steps: 17 | Train Loss: 0.319 Vali Loss: 5.166 Vali Acc: 0.529 Test Loss: 5.166 Test Acc: 0.529
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.71804690361023
Epoch: 16, Steps: 17 | Train Loss: 0.504 Vali Loss: 7.612 Vali Acc: 0.505 Test Loss: 7.612 Test Acc: 0.505
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.601612091064453
Epoch: 17, Steps: 17 | Train Loss: 1.110 Vali Loss: 3.482 Vali Acc: 0.563 Test Loss: 3.482 Test Acc: 0.563
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.459618091583252
Epoch: 18, Steps: 17 | Train Loss: 0.416 Vali Loss: 3.085 Vali Acc: 0.580 Test Loss: 3.085 Test Acc: 0.580
Validation loss decreased (-0.566539 --> -0.580174).  Saving model ...
Epoch: 19 cost time: 7.698177337646484
Epoch: 19, Steps: 17 | Train Loss: 0.970 Vali Loss: 5.491 Vali Acc: 0.563 Test Loss: 5.491 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.994768381118774
Epoch: 20, Steps: 17 | Train Loss: 0.927 Vali Loss: 4.516 Vali Acc: 0.563 Test Loss: 4.516 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.114065170288086
Epoch: 21, Steps: 17 | Train Loss: 0.669 Vali Loss: 7.171 Vali Acc: 0.543 Test Loss: 7.171 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 9.24543571472168
Epoch: 22, Steps: 17 | Train Loss: 0.377 Vali Loss: 6.171 Vali Acc: 0.536 Test Loss: 6.171 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 9.01053237915039
Epoch: 23, Steps: 17 | Train Loss: 0.348 Vali Loss: 5.935 Vali Acc: 0.539 Test Loss: 5.935 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 9.179782390594482
Epoch: 24, Steps: 17 | Train Loss: 1.234 Vali Loss: 8.735 Vali Acc: 0.543 Test Loss: 8.735 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 8.115774869918823
Epoch: 25, Steps: 17 | Train Loss: 1.082 Vali Loss: 8.257 Vali Acc: 0.522 Test Loss: 8.257 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 9.261361837387085
Epoch: 26, Steps: 17 | Train Loss: 0.268 Vali Loss: 7.169 Vali Acc: 0.570 Test Loss: 7.169 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 8.859921932220459
Epoch: 27, Steps: 17 | Train Loss: 0.841 Vali Loss: 5.581 Vali Acc: 0.573 Test Loss: 5.581 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 8.720670700073242
Epoch: 28, Steps: 17 | Train Loss: 0.487 Vali Loss: 6.288 Vali Acc: 0.573 Test Loss: 6.288 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5802047781569966
model parameter : 4670210
model size : 27.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.261393547058105
Epoch: 1, Steps: 17 | Train Loss: 0.679 Vali Loss: 0.844 Vali Acc: 0.495 Test Loss: 0.844 Test Acc: 0.495
Validation loss decreased (inf --> -0.494872).  Saving model ...
Epoch: 2 cost time: 7.525381803512573
Epoch: 2, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.767 Vali Acc: 0.539 Test Loss: 0.767 Test Acc: 0.539
Validation loss decreased (-0.494872 --> -0.539241).  Saving model ...
Epoch: 3 cost time: 6.935857057571411
Epoch: 3, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.741 Vali Acc: 0.597 Test Loss: 0.741 Test Acc: 0.597
Validation loss decreased (-0.539241 --> -0.597262).  Saving model ...
Epoch: 4 cost time: 8.95690631866455
Epoch: 4, Steps: 17 | Train Loss: 0.550 Vali Loss: 1.730 Vali Acc: 0.505 Test Loss: 1.730 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.667611837387085
Epoch: 5, Steps: 17 | Train Loss: 0.512 Vali Loss: 1.005 Vali Acc: 0.597 Test Loss: 1.005 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.583022832870483
Epoch: 6, Steps: 17 | Train Loss: 0.483 Vali Loss: 1.924 Vali Acc: 0.577 Test Loss: 1.924 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.870099067687988
Epoch: 7, Steps: 17 | Train Loss: 0.763 Vali Loss: 2.742 Vali Acc: 0.553 Test Loss: 2.742 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.782365322113037
Epoch: 8, Steps: 17 | Train Loss: 0.673 Vali Loss: 3.545 Vali Acc: 0.563 Test Loss: 3.545 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.728674173355103
Epoch: 9, Steps: 17 | Train Loss: 0.302 Vali Loss: 3.137 Vali Acc: 0.573 Test Loss: 3.137 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.149080991744995
Epoch: 10, Steps: 17 | Train Loss: 0.394 Vali Loss: 2.651 Vali Acc: 0.570 Test Loss: 2.651 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.8736045360565186
Epoch: 11, Steps: 17 | Train Loss: 0.456 Vali Loss: 4.398 Vali Acc: 0.522 Test Loss: 4.398 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.957687854766846
Epoch: 12, Steps: 17 | Train Loss: 0.386 Vali Loss: 3.768 Vali Acc: 0.590 Test Loss: 3.768 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.520846366882324
Epoch: 13, Steps: 17 | Train Loss: 0.443 Vali Loss: 3.962 Vali Acc: 0.577 Test Loss: 3.962 Test Acc: 0.577
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5972696245733788
model parameter : 4670210
model size : 27.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 14.827088117599487
Epoch: 1, Steps: 17 | Train Loss: 0.669 Vali Loss: 0.699 Vali Acc: 0.618 Test Loss: 0.699 Test Acc: 0.618
Validation loss decreased (inf --> -0.617740).  Saving model ...
Epoch: 2 cost time: 15.044328212738037
Epoch: 2, Steps: 17 | Train Loss: 0.453 Vali Loss: 2.211 Vali Acc: 0.536 Test Loss: 2.211 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.909401178359985
Epoch: 3, Steps: 17 | Train Loss: 0.395 Vali Loss: 1.044 Vali Acc: 0.635 Test Loss: 1.044 Test Acc: 0.635
Validation loss decreased (-0.617740 --> -0.634802).  Saving model ...
Epoch: 4 cost time: 13.624645471572876
Epoch: 4, Steps: 17 | Train Loss: 0.368 Vali Loss: 1.226 Vali Acc: 0.638 Test Loss: 1.226 Test Acc: 0.638
Validation loss decreased (-0.634802 --> -0.638213).  Saving model ...
Epoch: 5 cost time: 12.066731452941895
Epoch: 5, Steps: 17 | Train Loss: 0.287 Vali Loss: 1.933 Vali Acc: 0.628 Test Loss: 1.933 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.09297227859497
Epoch: 6, Steps: 17 | Train Loss: 0.532 Vali Loss: 3.030 Vali Acc: 0.645 Test Loss: 3.030 Test Acc: 0.645
Validation loss decreased (-0.638213 --> -0.645021).  Saving model ...
Epoch: 7 cost time: 14.10805892944336
Epoch: 7, Steps: 17 | Train Loss: 0.239 Vali Loss: 2.860 Vali Acc: 0.642 Test Loss: 2.860 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.531729698181152
Epoch: 8, Steps: 17 | Train Loss: 0.149 Vali Loss: 6.377 Vali Acc: 0.563 Test Loss: 6.377 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.427281856536865
Epoch: 9, Steps: 17 | Train Loss: 0.400 Vali Loss: 6.178 Vali Acc: 0.573 Test Loss: 6.178 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.79354977607727
Epoch: 10, Steps: 17 | Train Loss: 0.207 Vali Loss: 3.847 Vali Acc: 0.614 Test Loss: 3.847 Test Acc: 0.614
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 15.870549201965332
Epoch: 11, Steps: 17 | Train Loss: 0.271 Vali Loss: 4.837 Vali Acc: 0.645 Test Loss: 4.837 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.57261848449707
Epoch: 12, Steps: 17 | Train Loss: 0.415 Vali Loss: 5.163 Vali Acc: 0.666 Test Loss: 5.163 Test Acc: 0.666
Validation loss decreased (-0.645021 --> -0.665477).  Saving model ...
Epoch: 13 cost time: 16.070223331451416
Epoch: 13, Steps: 17 | Train Loss: 0.097 Vali Loss: 4.607 Vali Acc: 0.679 Test Loss: 4.607 Test Acc: 0.679
Validation loss decreased (-0.665477 --> -0.679135).  Saving model ...
Epoch: 14 cost time: 15.979031562805176
Epoch: 14, Steps: 17 | Train Loss: 0.280 Vali Loss: 4.346 Vali Acc: 0.618 Test Loss: 4.346 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.009150743484497
Epoch: 15, Steps: 17 | Train Loss: 0.416 Vali Loss: 7.481 Vali Acc: 0.638 Test Loss: 7.481 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 16.29124116897583
Epoch: 16, Steps: 17 | Train Loss: 0.066 Vali Loss: 8.642 Vali Acc: 0.590 Test Loss: 8.642 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 16.410406351089478
Epoch: 17, Steps: 17 | Train Loss: 0.223 Vali Loss: 5.839 Vali Acc: 0.635 Test Loss: 5.839 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 13.3196280002594
Epoch: 18, Steps: 17 | Train Loss: 0.197 Vali Loss: 11.891 Vali Acc: 0.570 Test Loss: 11.891 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 16.017096519470215
Epoch: 19, Steps: 17 | Train Loss: 0.192 Vali Loss: 6.927 Vali Acc: 0.645 Test Loss: 6.927 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 16.041152000427246
Epoch: 20, Steps: 17 | Train Loss: 0.284 Vali Loss: 11.015 Vali Acc: 0.618 Test Loss: 11.015 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 16.483070850372314
Epoch: 21, Steps: 17 | Train Loss: 0.163 Vali Loss: 9.696 Vali Acc: 0.621 Test Loss: 9.696 Test Acc: 0.621
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 14.267830848693848
Epoch: 22, Steps: 17 | Train Loss: 0.285 Vali Loss: 8.679 Vali Acc: 0.621 Test Loss: 8.679 Test Acc: 0.621
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 16.373288869857788
Epoch: 23, Steps: 17 | Train Loss: 1.044 Vali Loss: 7.287 Vali Acc: 0.693 Test Loss: 7.287 Test Acc: 0.693
Validation loss decreased (-0.679135 --> -0.692760).  Saving model ...
Epoch: 24 cost time: 15.72566843032837
Epoch: 24, Steps: 17 | Train Loss: 0.258 Vali Loss: 15.006 Vali Acc: 0.601 Test Loss: 15.006 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 13.96139407157898
Epoch: 25, Steps: 17 | Train Loss: 0.111 Vali Loss: 9.161 Vali Acc: 0.676 Test Loss: 9.161 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 15.161738157272339
Epoch: 26, Steps: 17 | Train Loss: 0.038 Vali Loss: 8.143 Vali Acc: 0.652 Test Loss: 8.143 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 17.357284545898438
Epoch: 27, Steps: 17 | Train Loss: 0.187 Vali Loss: 19.094 Vali Acc: 0.587 Test Loss: 19.094 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 13.18842077255249
Epoch: 28, Steps: 17 | Train Loss: 2.141 Vali Loss: 12.340 Vali Acc: 0.642 Test Loss: 12.340 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 16.698384761810303
Epoch: 29, Steps: 17 | Train Loss: 1.211 Vali Loss: 8.811 Vali Acc: 0.703 Test Loss: 8.811 Test Acc: 0.703
Validation loss decreased (-0.692760 --> -0.702984).  Saving model ...
Epoch: 30 cost time: 16.38034749031067
Epoch: 30, Steps: 17 | Train Loss: 0.618 Vali Loss: 10.883 Vali Acc: 0.645 Test Loss: 10.883 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 14.252771854400635
Epoch: 31, Steps: 17 | Train Loss: 0.130 Vali Loss: 11.060 Vali Acc: 0.631 Test Loss: 11.060 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 16.519065380096436
Epoch: 32, Steps: 17 | Train Loss: 0.044 Vali Loss: 10.004 Vali Acc: 0.689 Test Loss: 10.004 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 17.92958164215088
Epoch: 33, Steps: 17 | Train Loss: 0.303 Vali Loss: 12.509 Vali Acc: 0.666 Test Loss: 12.509 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 16.294381141662598
Epoch: 34, Steps: 17 | Train Loss: 0.721 Vali Loss: 12.728 Vali Acc: 0.655 Test Loss: 12.728 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 17.50787878036499
Epoch: 35, Steps: 17 | Train Loss: 0.115 Vali Loss: 10.857 Vali Acc: 0.662 Test Loss: 10.857 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 11.472235918045044
Epoch: 36, Steps: 17 | Train Loss: 0.062 Vali Loss: 10.260 Vali Acc: 0.689 Test Loss: 10.260 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 15.581420421600342
Epoch: 37, Steps: 17 | Train Loss: 0.015 Vali Loss: 11.335 Vali Acc: 0.706 Test Loss: 11.335 Test Acc: 0.706
Validation loss decreased (-0.702984 --> -0.706371).  Saving model ...
Epoch: 38 cost time: 19.85951590538025
Epoch: 38, Steps: 17 | Train Loss: 0.034 Vali Loss: 10.897 Vali Acc: 0.713 Test Loss: 10.897 Test Acc: 0.713
Validation loss decreased (-0.706371 --> -0.713202).  Saving model ...
Epoch: 39 cost time: 19.754039525985718
Epoch: 39, Steps: 17 | Train Loss: 0.281 Vali Loss: 10.681 Vali Acc: 0.700 Test Loss: 10.681 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 21.674652338027954
Epoch: 40, Steps: 17 | Train Loss: 0.172 Vali Loss: 13.105 Vali Acc: 0.683 Test Loss: 13.105 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 19.81265163421631
Epoch: 41, Steps: 17 | Train Loss: 0.380 Vali Loss: 14.526 Vali Acc: 0.666 Test Loss: 14.526 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 17.328503608703613
Epoch: 42, Steps: 17 | Train Loss: 0.529 Vali Loss: 11.764 Vali Acc: 0.645 Test Loss: 11.764 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 18.80877447128296
Epoch: 43, Steps: 17 | Train Loss: 0.184 Vali Loss: 13.174 Vali Acc: 0.662 Test Loss: 13.174 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 19.26086401939392
Epoch: 44, Steps: 17 | Train Loss: 0.061 Vali Loss: 20.195 Vali Acc: 0.621 Test Loss: 20.195 Test Acc: 0.621
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 17.814023971557617
Epoch: 45, Steps: 17 | Train Loss: 0.373 Vali Loss: 24.602 Vali Acc: 0.597 Test Loss: 24.602 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 18.816125631332397
Epoch: 46, Steps: 17 | Train Loss: 0.828 Vali Loss: 14.358 Vali Acc: 0.638 Test Loss: 14.358 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 19.972532510757446
Epoch: 47, Steps: 17 | Train Loss: 0.060 Vali Loss: 15.321 Vali Acc: 0.635 Test Loss: 15.321 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 16.496199131011963
Epoch: 48, Steps: 17 | Train Loss: 0.183 Vali Loss: 18.134 Vali Acc: 0.594 Test Loss: 18.134 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7133105802047781
model parameter : 3883778
model size : 24.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 14.199396133422852
Epoch: 1, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.742 Vali Acc: 0.580 Test Loss: 0.742 Test Acc: 0.580
Validation loss decreased (inf --> -0.580197).  Saving model ...
Epoch: 2 cost time: 11.04927921295166
Epoch: 2, Steps: 17 | Train Loss: 0.440 Vali Loss: 2.125 Vali Acc: 0.526 Test Loss: 2.125 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.662834167480469
Epoch: 3, Steps: 17 | Train Loss: 0.308 Vali Loss: 1.105 Vali Acc: 0.662 Test Loss: 1.105 Test Acc: 0.662
Validation loss decreased (-0.580197 --> -0.662105).  Saving model ...
Epoch: 4 cost time: 12.193711280822754
Epoch: 4, Steps: 17 | Train Loss: 0.317 Vali Loss: 1.336 Vali Acc: 0.642 Test Loss: 1.336 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.070471048355103
Epoch: 5, Steps: 17 | Train Loss: 0.347 Vali Loss: 3.588 Vali Acc: 0.590 Test Loss: 3.588 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.106825113296509
Epoch: 6, Steps: 17 | Train Loss: 0.292 Vali Loss: 2.073 Vali Acc: 0.648 Test Loss: 2.073 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.414128303527832
Epoch: 7, Steps: 17 | Train Loss: 0.224 Vali Loss: 2.250 Vali Acc: 0.621 Test Loss: 2.250 Test Acc: 0.621
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.15847897529602
Epoch: 8, Steps: 17 | Train Loss: 0.264 Vali Loss: 6.526 Vali Acc: 0.536 Test Loss: 6.526 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.864088773727417
Epoch: 9, Steps: 17 | Train Loss: 0.332 Vali Loss: 5.295 Vali Acc: 0.608 Test Loss: 5.295 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.640180826187134
Epoch: 10, Steps: 17 | Train Loss: 0.135 Vali Loss: 5.195 Vali Acc: 0.628 Test Loss: 5.195 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.147721290588379
Epoch: 11, Steps: 17 | Train Loss: 0.510 Vali Loss: 4.054 Vali Acc: 0.587 Test Loss: 4.054 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.528665542602539
Epoch: 12, Steps: 17 | Train Loss: 0.180 Vali Loss: 6.207 Vali Acc: 0.625 Test Loss: 6.207 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.039361238479614
Epoch: 13, Steps: 17 | Train Loss: 0.160 Vali Loss: 4.028 Vali Acc: 0.587 Test Loss: 4.028 Test Acc: 0.587
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6621160409556314
model parameter : 3883778
model size : 24.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 11.155596733093262
Epoch: 1, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.756 Vali Acc: 0.526 Test Loss: 0.756 Test Acc: 0.526
Validation loss decreased (inf --> -0.525590).  Saving model ...
Epoch: 2 cost time: 9.258874654769897
Epoch: 2, Steps: 17 | Train Loss: 0.433 Vali Loss: 1.520 Vali Acc: 0.556 Test Loss: 1.520 Test Acc: 0.556
Validation loss decreased (-0.525590 --> -0.556299).  Saving model ...
Epoch: 3 cost time: 10.238816738128662
Epoch: 3, Steps: 17 | Train Loss: 0.308 Vali Loss: 1.302 Vali Acc: 0.601 Test Loss: 1.302 Test Acc: 0.601
Validation loss decreased (-0.556299 --> -0.600670).  Saving model ...
Epoch: 4 cost time: 9.711318492889404
Epoch: 4, Steps: 17 | Train Loss: 0.311 Vali Loss: 2.494 Vali Acc: 0.580 Test Loss: 2.494 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.855414867401123
Epoch: 5, Steps: 17 | Train Loss: 0.396 Vali Loss: 3.690 Vali Acc: 0.556 Test Loss: 3.690 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.705929279327393
Epoch: 6, Steps: 17 | Train Loss: 1.013 Vali Loss: 2.260 Vali Acc: 0.635 Test Loss: 2.260 Test Acc: 0.635
Validation loss decreased (-0.600670 --> -0.634790).  Saving model ...
Epoch: 7 cost time: 13.284961700439453
Epoch: 7, Steps: 17 | Train Loss: 0.765 Vali Loss: 3.602 Vali Acc: 0.580 Test Loss: 3.602 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.739121198654175
Epoch: 8, Steps: 17 | Train Loss: 1.415 Vali Loss: 3.518 Vali Acc: 0.625 Test Loss: 3.518 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.900143384933472
Epoch: 9, Steps: 17 | Train Loss: 0.921 Vali Loss: 7.146 Vali Acc: 0.567 Test Loss: 7.146 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.312346696853638
Epoch: 10, Steps: 17 | Train Loss: 0.379 Vali Loss: 4.848 Vali Acc: 0.597 Test Loss: 4.848 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.85979413986206
Epoch: 11, Steps: 17 | Train Loss: 0.211 Vali Loss: 4.224 Vali Acc: 0.631 Test Loss: 4.224 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.276342391967773
Epoch: 12, Steps: 17 | Train Loss: 0.579 Vali Loss: 8.501 Vali Acc: 0.549 Test Loss: 8.501 Test Acc: 0.549
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 13.206585168838501
Epoch: 13, Steps: 17 | Train Loss: 0.220 Vali Loss: 5.664 Vali Acc: 0.642 Test Loss: 5.664 Test Acc: 0.642
Validation loss decreased (-0.634790 --> -0.641582).  Saving model ...
Epoch: 14 cost time: 10.112292528152466
Epoch: 14, Steps: 17 | Train Loss: 0.247 Vali Loss: 5.445 Vali Acc: 0.618 Test Loss: 5.445 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.630669832229614
Epoch: 15, Steps: 17 | Train Loss: 0.244 Vali Loss: 5.928 Vali Acc: 0.621 Test Loss: 5.928 Test Acc: 0.621
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 13.146127223968506
Epoch: 16, Steps: 17 | Train Loss: 0.224 Vali Loss: 11.073 Vali Acc: 0.567 Test Loss: 11.073 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 12.117468118667603
Epoch: 17, Steps: 17 | Train Loss: 0.436 Vali Loss: 8.500 Vali Acc: 0.601 Test Loss: 8.500 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.349049806594849
Epoch: 18, Steps: 17 | Train Loss: 0.231 Vali Loss: 9.037 Vali Acc: 0.594 Test Loss: 9.037 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.550543546676636
Epoch: 19, Steps: 17 | Train Loss: 0.117 Vali Loss: 7.436 Vali Acc: 0.597 Test Loss: 7.436 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 11.455857276916504
Epoch: 20, Steps: 17 | Train Loss: 0.103 Vali Loss: 9.941 Vali Acc: 0.590 Test Loss: 9.941 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 11.308196067810059
Epoch: 21, Steps: 17 | Train Loss: 0.932 Vali Loss: 9.153 Vali Acc: 0.645 Test Loss: 9.153 Test Acc: 0.645
Validation loss decreased (-0.641582 --> -0.644960).  Saving model ...
Epoch: 22 cost time: 11.96885085105896
Epoch: 22, Steps: 17 | Train Loss: 0.634 Vali Loss: 11.263 Vali Acc: 0.590 Test Loss: 11.263 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 10.709157228469849
Epoch: 23, Steps: 17 | Train Loss: 0.636 Vali Loss: 11.306 Vali Acc: 0.601 Test Loss: 11.306 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 12.832147598266602
Epoch: 24, Steps: 17 | Train Loss: 0.155 Vali Loss: 11.037 Vali Acc: 0.584 Test Loss: 11.037 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 10.169165134429932
Epoch: 25, Steps: 17 | Train Loss: 0.161 Vali Loss: 14.550 Vali Acc: 0.594 Test Loss: 14.550 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 11.609078884124756
Epoch: 26, Steps: 17 | Train Loss: 0.096 Vali Loss: 14.271 Vali Acc: 0.618 Test Loss: 14.271 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 9.109247922897339
Epoch: 27, Steps: 17 | Train Loss: 0.083 Vali Loss: 10.273 Vali Acc: 0.570 Test Loss: 10.273 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 10.408786296844482
Epoch: 28, Steps: 17 | Train Loss: 0.170 Vali Loss: 17.710 Vali Acc: 0.604 Test Loss: 17.710 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 12.164269208908081
Epoch: 29, Steps: 17 | Train Loss: 0.174 Vali Loss: 12.266 Vali Acc: 0.573 Test Loss: 12.266 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 10.737082481384277
Epoch: 30, Steps: 17 | Train Loss: 0.123 Vali Loss: 12.615 Vali Acc: 0.614 Test Loss: 12.615 Test Acc: 0.614
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 12.01942753791809
Epoch: 31, Steps: 17 | Train Loss: 0.063 Vali Loss: 14.837 Vali Acc: 0.587 Test Loss: 14.837 Test Acc: 0.587
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6450511945392492
model parameter : 3883778
model size : 24.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.037496089935303
Epoch: 1, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.809 Vali Acc: 0.546 Test Loss: 0.809 Test Acc: 0.546
Validation loss decreased (inf --> -0.546067).  Saving model ...
Epoch: 2 cost time: 7.471154451370239
Epoch: 2, Steps: 17 | Train Loss: 0.460 Vali Loss: 1.792 Vali Acc: 0.549 Test Loss: 1.792 Test Acc: 0.549
Validation loss decreased (-0.546067 --> -0.549470).  Saving model ...
Epoch: 3 cost time: 9.649605989456177
Epoch: 3, Steps: 17 | Train Loss: 0.555 Vali Loss: 2.613 Vali Acc: 0.532 Test Loss: 2.613 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.090216636657715
Epoch: 4, Steps: 17 | Train Loss: 0.457 Vali Loss: 1.689 Vali Acc: 0.584 Test Loss: 1.689 Test Acc: 0.584
Validation loss decreased (-0.549470 --> -0.583601).  Saving model ...
Epoch: 5 cost time: 8.247328519821167
Epoch: 5, Steps: 17 | Train Loss: 0.202 Vali Loss: 2.109 Vali Acc: 0.584 Test Loss: 2.109 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.345351934432983
Epoch: 6, Steps: 17 | Train Loss: 0.223 Vali Loss: 4.047 Vali Acc: 0.556 Test Loss: 4.047 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.512343645095825
Epoch: 7, Steps: 17 | Train Loss: 0.998 Vali Loss: 3.326 Vali Acc: 0.549 Test Loss: 3.326 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.889293193817139
Epoch: 8, Steps: 17 | Train Loss: 0.383 Vali Loss: 7.522 Vali Acc: 0.539 Test Loss: 7.522 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.130139112472534
Epoch: 9, Steps: 17 | Train Loss: 0.290 Vali Loss: 4.517 Vali Acc: 0.567 Test Loss: 4.517 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.816854000091553
Epoch: 10, Steps: 17 | Train Loss: 0.159 Vali Loss: 3.835 Vali Acc: 0.621 Test Loss: 3.835 Test Acc: 0.621
Validation loss decreased (-0.583601 --> -0.621122).  Saving model ...
Epoch: 11 cost time: 10.617449283599854
Epoch: 11, Steps: 17 | Train Loss: 0.195 Vali Loss: 6.323 Vali Acc: 0.584 Test Loss: 6.323 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.003865718841553
Epoch: 12, Steps: 17 | Train Loss: 0.100 Vali Loss: 6.081 Vali Acc: 0.580 Test Loss: 6.081 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.215883016586304
Epoch: 13, Steps: 17 | Train Loss: 0.218 Vali Loss: 5.517 Vali Acc: 0.608 Test Loss: 5.517 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.547695159912109
Epoch: 14, Steps: 17 | Train Loss: 0.457 Vali Loss: 6.209 Vali Acc: 0.556 Test Loss: 6.209 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.315879821777344
Epoch: 15, Steps: 17 | Train Loss: 0.454 Vali Loss: 7.661 Vali Acc: 0.604 Test Loss: 7.661 Test Acc: 0.604
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.426284313201904
Epoch: 16, Steps: 17 | Train Loss: 0.077 Vali Loss: 8.967 Vali Acc: 0.597 Test Loss: 8.967 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.396116256713867
Epoch: 17, Steps: 17 | Train Loss: 0.128 Vali Loss: 5.836 Vali Acc: 0.645 Test Loss: 5.836 Test Acc: 0.645
Validation loss decreased (-0.621122 --> -0.644993).  Saving model ...
Epoch: 18 cost time: 10.820575714111328
Epoch: 18, Steps: 17 | Train Loss: 0.146 Vali Loss: 9.011 Vali Acc: 0.597 Test Loss: 9.011 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.579550743103027
Epoch: 19, Steps: 17 | Train Loss: 0.060 Vali Loss: 12.388 Vali Acc: 0.570 Test Loss: 12.388 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.211220026016235
Epoch: 20, Steps: 17 | Train Loss: 0.116 Vali Loss: 10.370 Vali Acc: 0.597 Test Loss: 10.370 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.713561534881592
Epoch: 21, Steps: 17 | Train Loss: 0.120 Vali Loss: 14.553 Vali Acc: 0.556 Test Loss: 14.553 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.975864410400391
Epoch: 22, Steps: 17 | Train Loss: 0.187 Vali Loss: 9.660 Vali Acc: 0.618 Test Loss: 9.660 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 10.261321067810059
Epoch: 23, Steps: 17 | Train Loss: 0.175 Vali Loss: 10.714 Vali Acc: 0.601 Test Loss: 10.714 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 11.720975399017334
Epoch: 24, Steps: 17 | Train Loss: 0.876 Vali Loss: 17.674 Vali Acc: 0.553 Test Loss: 17.674 Test Acc: 0.553
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 11.483271360397339
Epoch: 25, Steps: 17 | Train Loss: 0.388 Vali Loss: 9.346 Vali Acc: 0.621 Test Loss: 9.346 Test Acc: 0.621
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 11.324863910675049
Epoch: 26, Steps: 17 | Train Loss: 0.290 Vali Loss: 15.981 Vali Acc: 0.590 Test Loss: 15.981 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 11.947088479995728
Epoch: 27, Steps: 17 | Train Loss: 0.157 Vali Loss: 15.633 Vali Acc: 0.594 Test Loss: 15.633 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6450511945392492
model parameter : 3883778
model size : 24.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.018077850341797
Epoch: 1, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.730 Vali Acc: 0.556 Test Loss: 0.730 Test Acc: 0.556
Validation loss decreased (inf --> -0.556307).  Saving model ...
Epoch: 2 cost time: 9.242503643035889
Epoch: 2, Steps: 17 | Train Loss: 0.471 Vali Loss: 1.843 Vali Acc: 0.532 Test Loss: 1.843 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.761157751083374
Epoch: 3, Steps: 17 | Train Loss: 0.356 Vali Loss: 1.419 Vali Acc: 0.625 Test Loss: 1.419 Test Acc: 0.625
Validation loss decreased (-0.556307 --> -0.624559).  Saving model ...
Epoch: 4 cost time: 8.958247900009155
Epoch: 4, Steps: 17 | Train Loss: 0.301 Vali Loss: 1.461 Vali Acc: 0.642 Test Loss: 1.461 Test Acc: 0.642
Validation loss decreased (-0.624559 --> -0.641624).  Saving model ...
Epoch: 5 cost time: 8.805484056472778
Epoch: 5, Steps: 17 | Train Loss: 0.377 Vali Loss: 5.139 Vali Acc: 0.515 Test Loss: 5.139 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.422314167022705
Epoch: 6, Steps: 17 | Train Loss: 0.327 Vali Loss: 2.301 Vali Acc: 0.611 Test Loss: 2.301 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.835413932800293
Epoch: 7, Steps: 17 | Train Loss: 0.328 Vali Loss: 2.136 Vali Acc: 0.625 Test Loss: 2.136 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.19546890258789
Epoch: 8, Steps: 17 | Train Loss: 0.336 Vali Loss: 6.771 Vali Acc: 0.539 Test Loss: 6.771 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.196075201034546
Epoch: 9, Steps: 17 | Train Loss: 0.478 Vali Loss: 7.230 Vali Acc: 0.536 Test Loss: 7.230 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.250248670578003
Epoch: 10, Steps: 17 | Train Loss: 0.275 Vali Loss: 5.536 Vali Acc: 0.594 Test Loss: 5.536 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.803331851959229
Epoch: 11, Steps: 17 | Train Loss: 0.154 Vali Loss: 4.506 Vali Acc: 0.608 Test Loss: 4.506 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.9629545211792
Epoch: 12, Steps: 17 | Train Loss: 0.172 Vali Loss: 3.656 Vali Acc: 0.635 Test Loss: 3.656 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.462138175964355
Epoch: 13, Steps: 17 | Train Loss: 0.388 Vali Loss: 7.041 Vali Acc: 0.587 Test Loss: 7.041 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.66161298751831
Epoch: 14, Steps: 17 | Train Loss: 0.473 Vali Loss: 4.893 Vali Acc: 0.614 Test Loss: 4.893 Test Acc: 0.614
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 3883778
model size : 24.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.08317756652832
Epoch: 1, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.743 Vali Acc: 0.584 Test Loss: 0.743 Test Acc: 0.584
Validation loss decreased (inf --> -0.583610).  Saving model ...
Epoch: 2 cost time: 6.758774995803833
Epoch: 2, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.908 Vali Acc: 0.580 Test Loss: 0.908 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.650063753128052
Epoch: 3, Steps: 17 | Train Loss: 0.521 Vali Loss: 1.291 Vali Acc: 0.577 Test Loss: 1.291 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.348591089248657
Epoch: 4, Steps: 17 | Train Loss: 0.346 Vali Loss: 1.695 Vali Acc: 0.590 Test Loss: 1.695 Test Acc: 0.590
Validation loss decreased (-0.583610 --> -0.590427).  Saving model ...
Epoch: 5 cost time: 9.118448495864868
Epoch: 5, Steps: 17 | Train Loss: 0.333 Vali Loss: 1.524 Vali Acc: 0.625 Test Loss: 1.524 Test Acc: 0.625
Validation loss decreased (-0.590427 --> -0.624558).  Saving model ...
Epoch: 6 cost time: 9.67327070236206
Epoch: 6, Steps: 17 | Train Loss: 0.407 Vali Loss: 1.963 Vali Acc: 0.594 Test Loss: 1.963 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.41939926147461
Epoch: 7, Steps: 17 | Train Loss: 0.581 Vali Loss: 3.137 Vali Acc: 0.553 Test Loss: 3.137 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.548340320587158
Epoch: 8, Steps: 17 | Train Loss: 0.460 Vali Loss: 2.855 Vali Acc: 0.584 Test Loss: 2.855 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.972347021102905
Epoch: 9, Steps: 17 | Train Loss: 0.446 Vali Loss: 3.529 Vali Acc: 0.580 Test Loss: 3.529 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.6130759716033936
Epoch: 10, Steps: 17 | Train Loss: 0.440 Vali Loss: 4.458 Vali Acc: 0.573 Test Loss: 4.458 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.392966747283936
Epoch: 11, Steps: 17 | Train Loss: 0.322 Vali Loss: 9.247 Vali Acc: 0.522 Test Loss: 9.247 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.007234811782837
Epoch: 12, Steps: 17 | Train Loss: 0.330 Vali Loss: 6.564 Vali Acc: 0.526 Test Loss: 6.564 Test Acc: 0.526
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.230488061904907
Epoch: 13, Steps: 17 | Train Loss: 0.313 Vali Loss: 5.797 Vali Acc: 0.577 Test Loss: 5.797 Test Acc: 0.577
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.59715461730957
Epoch: 14, Steps: 17 | Train Loss: 0.122 Vali Loss: 5.184 Vali Acc: 0.563 Test Loss: 5.184 Test Acc: 0.563
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.313056230545044
Epoch: 15, Steps: 17 | Train Loss: 0.301 Vali Loss: 5.794 Vali Acc: 0.577 Test Loss: 5.794 Test Acc: 0.577
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 3883778
model size : 24.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.862398862838745
Epoch: 1, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.790 Vali Acc: 0.556 Test Loss: 0.790 Test Acc: 0.556
Validation loss decreased (inf --> -0.556306).  Saving model ...
Epoch: 2 cost time: 6.711793422698975
Epoch: 2, Steps: 17 | Train Loss: 0.525 Vali Loss: 1.324 Vali Acc: 0.539 Test Loss: 1.324 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.954745292663574
Epoch: 3, Steps: 17 | Train Loss: 0.455 Vali Loss: 1.275 Vali Acc: 0.597 Test Loss: 1.275 Test Acc: 0.597
Validation loss decreased (-0.556306 --> -0.597257).  Saving model ...
Epoch: 4 cost time: 7.962876319885254
Epoch: 4, Steps: 17 | Train Loss: 0.746 Vali Loss: 1.441 Vali Acc: 0.577 Test Loss: 1.441 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.6266350746154785
Epoch: 5, Steps: 17 | Train Loss: 0.345 Vali Loss: 1.877 Vali Acc: 0.584 Test Loss: 1.877 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.12872052192688
Epoch: 6, Steps: 17 | Train Loss: 0.393 Vali Loss: 1.490 Vali Acc: 0.601 Test Loss: 1.490 Test Acc: 0.601
Validation loss decreased (-0.597257 --> -0.600668).  Saving model ...
Epoch: 7 cost time: 8.299459218978882
Epoch: 7, Steps: 17 | Train Loss: 0.366 Vali Loss: 3.727 Vali Acc: 0.519 Test Loss: 3.727 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.321333169937134
Epoch: 8, Steps: 17 | Train Loss: 0.529 Vali Loss: 2.965 Vali Acc: 0.570 Test Loss: 2.965 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.911065101623535
Epoch: 9, Steps: 17 | Train Loss: 0.236 Vali Loss: 2.951 Vali Acc: 0.560 Test Loss: 2.951 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.26347541809082
Epoch: 10, Steps: 17 | Train Loss: 0.207 Vali Loss: 3.457 Vali Acc: 0.539 Test Loss: 3.457 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.962809801101685
Epoch: 11, Steps: 17 | Train Loss: 0.336 Vali Loss: 4.506 Vali Acc: 0.556 Test Loss: 4.506 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.252185344696045
Epoch: 12, Steps: 17 | Train Loss: 0.263 Vali Loss: 3.519 Vali Acc: 0.590 Test Loss: 3.519 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.051284313201904
Epoch: 13, Steps: 17 | Train Loss: 0.364 Vali Loss: 3.762 Vali Acc: 0.570 Test Loss: 3.762 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.702882289886475
Epoch: 14, Steps: 17 | Train Loss: 0.139 Vali Loss: 4.474 Vali Acc: 0.543 Test Loss: 4.474 Test Acc: 0.543
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.89502477645874
Epoch: 15, Steps: 17 | Train Loss: 0.286 Vali Loss: 5.226 Vali Acc: 0.553 Test Loss: 5.226 Test Acc: 0.553
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.43432354927063
Epoch: 16, Steps: 17 | Train Loss: 0.374 Vali Loss: 5.306 Vali Acc: 0.543 Test Loss: 5.306 Test Acc: 0.543
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6006825938566553
model parameter : 3883778
model size : 24.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.342831134796143
Epoch: 1, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.881 Vali Acc: 0.509 Test Loss: 0.881 Test Acc: 0.509
Validation loss decreased (inf --> -0.508524).  Saving model ...
Epoch: 2 cost time: 8.392820596694946
Epoch: 2, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.926 Vali Acc: 0.543 Test Loss: 0.926 Test Acc: 0.543
Validation loss decreased (-0.508524 --> -0.542653).  Saving model ...
Epoch: 3 cost time: 7.871943950653076
Epoch: 3, Steps: 17 | Train Loss: 0.416 Vali Loss: 1.131 Vali Acc: 0.587 Test Loss: 1.131 Test Acc: 0.587
Validation loss decreased (-0.542653 --> -0.587019).  Saving model ...
Epoch: 4 cost time: 8.097084999084473
Epoch: 4, Steps: 17 | Train Loss: 0.562 Vali Loss: 1.832 Vali Acc: 0.498 Test Loss: 1.832 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.265320777893066
Epoch: 5, Steps: 17 | Train Loss: 0.424 Vali Loss: 2.548 Vali Acc: 0.522 Test Loss: 2.548 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.776401996612549
Epoch: 6, Steps: 17 | Train Loss: 0.352 Vali Loss: 2.327 Vali Acc: 0.567 Test Loss: 2.327 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.264459609985352
Epoch: 7, Steps: 17 | Train Loss: 0.257 Vali Loss: 3.261 Vali Acc: 0.491 Test Loss: 3.261 Test Acc: 0.491
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.963848114013672
Epoch: 8, Steps: 17 | Train Loss: 0.229 Vali Loss: 3.953 Vali Acc: 0.522 Test Loss: 3.953 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.868502140045166
Epoch: 9, Steps: 17 | Train Loss: 0.513 Vali Loss: 3.634 Vali Acc: 0.539 Test Loss: 3.634 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.543347120285034
Epoch: 10, Steps: 17 | Train Loss: 0.298 Vali Loss: 3.493 Vali Acc: 0.532 Test Loss: 3.493 Test Acc: 0.532
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.443957328796387
Epoch: 11, Steps: 17 | Train Loss: 0.243 Vali Loss: 6.244 Vali Acc: 0.509 Test Loss: 6.244 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.948807239532471
Epoch: 12, Steps: 17 | Train Loss: 0.603 Vali Loss: 4.671 Vali Acc: 0.519 Test Loss: 4.671 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.06195068359375
Epoch: 13, Steps: 17 | Train Loss: 0.378 Vali Loss: 5.249 Vali Acc: 0.515 Test Loss: 5.249 Test Acc: 0.515
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5870307167235495
model parameter : 3883778
model size : 24.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.851795196533203
Epoch: 1, Steps: 17 | Train Loss: 0.659 Vali Loss: 1.225 Vali Acc: 0.502 Test Loss: 1.225 Test Acc: 0.502
Validation loss decreased (inf --> -0.501694).  Saving model ...
Epoch: 2 cost time: 8.851802349090576
Epoch: 2, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.738 Vali Acc: 0.495 Test Loss: 0.738 Test Acc: 0.495
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.528059482574463
Epoch: 3, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.901 Vali Acc: 0.498 Test Loss: 0.901 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.700281143188477
Epoch: 4, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.814 Vali Acc: 0.570 Test Loss: 0.814 Test Acc: 0.570
Validation loss decreased (-0.501694 --> -0.569958).  Saving model ...
Epoch: 5 cost time: 8.651841402053833
Epoch: 5, Steps: 17 | Train Loss: 0.346 Vali Loss: 1.341 Vali Acc: 0.502 Test Loss: 1.341 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.971633672714233
Epoch: 6, Steps: 17 | Train Loss: 0.385 Vali Loss: 1.700 Vali Acc: 0.498 Test Loss: 1.700 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.895549058914185
Epoch: 7, Steps: 17 | Train Loss: 0.354 Vali Loss: 2.195 Vali Acc: 0.502 Test Loss: 2.195 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.352445602416992
Epoch: 8, Steps: 17 | Train Loss: 0.391 Vali Loss: 1.134 Vali Acc: 0.573 Test Loss: 1.134 Test Acc: 0.573
Validation loss decreased (-0.569958 --> -0.573368).  Saving model ...
Epoch: 9 cost time: 7.6050543785095215
Epoch: 9, Steps: 17 | Train Loss: 0.659 Vali Loss: 1.270 Vali Acc: 0.563 Test Loss: 1.270 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.75223684310913
Epoch: 10, Steps: 17 | Train Loss: 0.234 Vali Loss: 5.076 Vali Acc: 0.498 Test Loss: 5.076 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.63054871559143
Epoch: 11, Steps: 17 | Train Loss: 0.243 Vali Loss: 5.331 Vali Acc: 0.498 Test Loss: 5.331 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.910144329071045
Epoch: 12, Steps: 17 | Train Loss: 0.590 Vali Loss: 5.456 Vali Acc: 0.498 Test Loss: 5.456 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.741132497787476
Epoch: 13, Steps: 17 | Train Loss: 0.236 Vali Loss: 2.993 Vali Acc: 0.556 Test Loss: 2.993 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.205203056335449
Epoch: 14, Steps: 17 | Train Loss: 0.167 Vali Loss: 2.496 Vali Acc: 0.563 Test Loss: 2.496 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.139760255813599
Epoch: 15, Steps: 17 | Train Loss: 0.217 Vali Loss: 4.006 Vali Acc: 0.553 Test Loss: 4.006 Test Acc: 0.553
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.337629079818726
Epoch: 16, Steps: 17 | Train Loss: 0.255 Vali Loss: 5.786 Vali Acc: 0.509 Test Loss: 5.786 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.93913197517395
Epoch: 17, Steps: 17 | Train Loss: 0.312 Vali Loss: 4.990 Vali Acc: 0.536 Test Loss: 4.990 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.127032279968262
Epoch: 18, Steps: 17 | Train Loss: 0.389 Vali Loss: 7.223 Vali Acc: 0.515 Test Loss: 7.223 Test Acc: 0.515
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5733788395904437
model parameter : 3883778
model size : 24.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.34489369392395
Epoch: 1, Steps: 17 | Train Loss: 0.690 Vali Loss: 2.140 Vali Acc: 0.502 Test Loss: 2.140 Test Acc: 0.502
Validation loss decreased (inf --> -0.501685).  Saving model ...
Epoch: 2 cost time: 6.859925270080566
Epoch: 2, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.748 Vali Acc: 0.512 Test Loss: 0.748 Test Acc: 0.512
Validation loss decreased (-0.501685 --> -0.511938).  Saving model ...
Epoch: 3 cost time: 8.020216464996338
Epoch: 3, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.849 Vali Acc: 0.539 Test Loss: 0.849 Test Acc: 0.539
Validation loss decreased (-0.511938 --> -0.539241).  Saving model ...
Epoch: 4 cost time: 8.058137893676758
Epoch: 4, Steps: 17 | Train Loss: 0.413 Vali Loss: 1.200 Vali Acc: 0.543 Test Loss: 1.200 Test Acc: 0.543
Validation loss decreased (-0.539241 --> -0.542650).  Saving model ...
Epoch: 5 cost time: 7.674870014190674
Epoch: 5, Steps: 17 | Train Loss: 0.392 Vali Loss: 1.118 Vali Acc: 0.584 Test Loss: 1.118 Test Acc: 0.584
Validation loss decreased (-0.542650 --> -0.583607).  Saving model ...
Epoch: 6 cost time: 6.0389885902404785
Epoch: 6, Steps: 17 | Train Loss: 0.408 Vali Loss: 2.048 Vali Acc: 0.567 Test Loss: 2.048 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.463349342346191
Epoch: 7, Steps: 17 | Train Loss: 0.392 Vali Loss: 2.920 Vali Acc: 0.587 Test Loss: 2.920 Test Acc: 0.587
Validation loss decreased (-0.583607 --> -0.587002).  Saving model ...
Epoch: 8 cost time: 6.715928792953491
Epoch: 8, Steps: 17 | Train Loss: 0.363 Vali Loss: 2.815 Vali Acc: 0.580 Test Loss: 2.815 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.269551515579224
Epoch: 9, Steps: 17 | Train Loss: 0.397 Vali Loss: 2.730 Vali Acc: 0.587 Test Loss: 2.730 Test Acc: 0.587
Validation loss decreased (-0.587002 --> -0.587003).  Saving model ...
Epoch: 10 cost time: 7.79007625579834
Epoch: 10, Steps: 17 | Train Loss: 0.349 Vali Loss: 3.144 Vali Acc: 0.590 Test Loss: 3.144 Test Acc: 0.590
Validation loss decreased (-0.587003 --> -0.590412).  Saving model ...
Epoch: 11 cost time: 7.8859381675720215
Epoch: 11, Steps: 17 | Train Loss: 0.342 Vali Loss: 2.758 Vali Acc: 0.590 Test Loss: 2.758 Test Acc: 0.590
Validation loss decreased (-0.590412 --> -0.590416).  Saving model ...
Epoch: 12 cost time: 7.4243175983428955
Epoch: 12, Steps: 17 | Train Loss: 0.402 Vali Loss: 4.011 Vali Acc: 0.601 Test Loss: 4.011 Test Acc: 0.601
Validation loss decreased (-0.590416 --> -0.600642).  Saving model ...
Epoch: 13 cost time: 7.5078089237213135
Epoch: 13, Steps: 17 | Train Loss: 0.961 Vali Loss: 6.890 Vali Acc: 0.532 Test Loss: 6.890 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.50822377204895
Epoch: 14, Steps: 17 | Train Loss: 0.717 Vali Loss: 5.578 Vali Acc: 0.580 Test Loss: 5.578 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.872389316558838
Epoch: 15, Steps: 17 | Train Loss: 0.835 Vali Loss: 7.175 Vali Acc: 0.526 Test Loss: 7.175 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.848970174789429
Epoch: 16, Steps: 17 | Train Loss: 0.353 Vali Loss: 6.020 Vali Acc: 0.529 Test Loss: 6.020 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.688980340957642
Epoch: 17, Steps: 17 | Train Loss: 0.523 Vali Loss: 6.020 Vali Acc: 0.546 Test Loss: 6.020 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.433699369430542
Epoch: 18, Steps: 17 | Train Loss: 0.418 Vali Loss: 8.512 Vali Acc: 0.539 Test Loss: 8.512 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.80472731590271
Epoch: 19, Steps: 17 | Train Loss: 0.714 Vali Loss: 8.318 Vali Acc: 0.543 Test Loss: 8.318 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.803412675857544
Epoch: 20, Steps: 17 | Train Loss: 0.491 Vali Loss: 5.520 Vali Acc: 0.580 Test Loss: 5.520 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.82844614982605
Epoch: 21, Steps: 17 | Train Loss: 0.481 Vali Loss: 5.297 Vali Acc: 0.546 Test Loss: 5.297 Test Acc: 0.546
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.991892099380493
Epoch: 22, Steps: 17 | Train Loss: 0.379 Vali Loss: 7.796 Vali Acc: 0.584 Test Loss: 7.796 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6006825938566553
model parameter : 3883778
model size : 24.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 15.542034387588501
Epoch: 1, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.831 Vali Acc: 0.594 Test Loss: 0.831 Test Acc: 0.594
Validation loss decreased (inf --> -0.593848).  Saving model ...
Epoch: 2 cost time: 10.88947606086731
Epoch: 2, Steps: 17 | Train Loss: 0.438 Vali Loss: 2.044 Vali Acc: 0.567 Test Loss: 2.044 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.884461641311646
Epoch: 3, Steps: 17 | Train Loss: 0.385 Vali Loss: 1.369 Vali Acc: 0.625 Test Loss: 1.369 Test Acc: 0.625
Validation loss decreased (-0.593848 --> -0.624560).  Saving model ...
Epoch: 4 cost time: 10.523569345474243
Epoch: 4, Steps: 17 | Train Loss: 0.458 Vali Loss: 1.402 Vali Acc: 0.631 Test Loss: 1.402 Test Acc: 0.631
Validation loss decreased (-0.624560 --> -0.631385).  Saving model ...
Epoch: 5 cost time: 13.683784008026123
Epoch: 5, Steps: 17 | Train Loss: 0.651 Vali Loss: 1.721 Vali Acc: 0.676 Test Loss: 1.721 Test Acc: 0.676
Validation loss decreased (-0.631385 --> -0.675751).  Saving model ...
Epoch: 6 cost time: 14.360953092575073
Epoch: 6, Steps: 17 | Train Loss: 0.421 Vali Loss: 3.776 Vali Acc: 0.601 Test Loss: 3.776 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.630968809127808
Epoch: 7, Steps: 17 | Train Loss: 0.321 Vali Loss: 4.743 Vali Acc: 0.584 Test Loss: 4.743 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.907630920410156
Epoch: 8, Steps: 17 | Train Loss: 0.915 Vali Loss: 2.220 Vali Acc: 0.659 Test Loss: 2.220 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.422509670257568
Epoch: 9, Steps: 17 | Train Loss: 0.258 Vali Loss: 6.362 Vali Acc: 0.577 Test Loss: 6.362 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.08701229095459
Epoch: 10, Steps: 17 | Train Loss: 0.348 Vali Loss: 2.983 Vali Acc: 0.672 Test Loss: 2.983 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.986514568328857
Epoch: 11, Steps: 17 | Train Loss: 0.198 Vali Loss: 3.952 Vali Acc: 0.608 Test Loss: 3.952 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.713484525680542
Epoch: 12, Steps: 17 | Train Loss: 0.263 Vali Loss: 3.598 Vali Acc: 0.638 Test Loss: 3.598 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.395650148391724
Epoch: 13, Steps: 17 | Train Loss: 0.174 Vali Loss: 6.865 Vali Acc: 0.611 Test Loss: 6.865 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.671011209487915
Epoch: 14, Steps: 17 | Train Loss: 0.122 Vali Loss: 4.729 Vali Acc: 0.631 Test Loss: 4.729 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.971424579620361
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 6.449 Vali Acc: 0.618 Test Loss: 6.449 Test Acc: 0.618
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6757679180887372
model parameter : 3490562
model size : 23.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 11.601736307144165
Epoch: 1, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.818 Vali Acc: 0.567 Test Loss: 0.818 Test Acc: 0.567
Validation loss decreased (inf --> -0.566545).  Saving model ...
Epoch: 2 cost time: 9.091817378997803
Epoch: 2, Steps: 17 | Train Loss: 0.466 Vali Loss: 2.494 Vali Acc: 0.543 Test Loss: 2.494 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.857563972473145
Epoch: 3, Steps: 17 | Train Loss: 0.399 Vali Loss: 1.334 Vali Acc: 0.590 Test Loss: 1.334 Test Acc: 0.590
Validation loss decreased (-0.566545 --> -0.590430).  Saving model ...
Epoch: 4 cost time: 11.455893278121948
Epoch: 4, Steps: 17 | Train Loss: 0.404 Vali Loss: 4.205 Vali Acc: 0.526 Test Loss: 4.205 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.63367509841919
Epoch: 5, Steps: 17 | Train Loss: 0.455 Vali Loss: 2.322 Vali Acc: 0.590 Test Loss: 2.322 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.141719341278076
Epoch: 6, Steps: 17 | Train Loss: 0.348 Vali Loss: 4.665 Vali Acc: 0.560 Test Loss: 4.665 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.991683959960938
Epoch: 7, Steps: 17 | Train Loss: 0.283 Vali Loss: 2.173 Vali Acc: 0.621 Test Loss: 2.173 Test Acc: 0.621
Validation loss decreased (-0.590430 --> -0.621139).  Saving model ...
Epoch: 8 cost time: 10.1710946559906
Epoch: 8, Steps: 17 | Train Loss: 0.193 Vali Loss: 2.065 Vali Acc: 0.638 Test Loss: 2.065 Test Acc: 0.638
Validation loss decreased (-0.621139 --> -0.638205).  Saving model ...
Epoch: 9 cost time: 12.67535948753357
Epoch: 9, Steps: 17 | Train Loss: 0.224 Vali Loss: 5.843 Vali Acc: 0.570 Test Loss: 5.843 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.424042224884033
Epoch: 10, Steps: 17 | Train Loss: 0.221 Vali Loss: 2.651 Vali Acc: 0.642 Test Loss: 2.651 Test Acc: 0.642
Validation loss decreased (-0.638205 --> -0.641612).  Saving model ...
Epoch: 11 cost time: 11.102508306503296
Epoch: 11, Steps: 17 | Train Loss: 0.435 Vali Loss: 3.892 Vali Acc: 0.597 Test Loss: 3.892 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.409613132476807
Epoch: 12, Steps: 17 | Train Loss: 0.256 Vali Loss: 5.518 Vali Acc: 0.635 Test Loss: 5.518 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.78137755393982
Epoch: 13, Steps: 17 | Train Loss: 0.196 Vali Loss: 4.718 Vali Acc: 0.618 Test Loss: 4.718 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 13.628776788711548
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 9.951 Vali Acc: 0.549 Test Loss: 9.951 Test Acc: 0.549
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.008463621139526
Epoch: 15, Steps: 17 | Train Loss: 0.376 Vali Loss: 4.873 Vali Acc: 0.625 Test Loss: 4.873 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.408595085144043
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 9.784 Vali Acc: 0.597 Test Loss: 9.784 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.126460552215576
Epoch: 17, Steps: 17 | Train Loss: 0.321 Vali Loss: 7.510 Vali Acc: 0.608 Test Loss: 7.510 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.476456880569458
Epoch: 18, Steps: 17 | Train Loss: 0.317 Vali Loss: 5.037 Vali Acc: 0.618 Test Loss: 5.037 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 12.258502721786499
Epoch: 19, Steps: 17 | Train Loss: 0.098 Vali Loss: 7.224 Vali Acc: 0.608 Test Loss: 7.224 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.223920822143555
Epoch: 20, Steps: 17 | Train Loss: 0.094 Vali Loss: 7.448 Vali Acc: 0.635 Test Loss: 7.448 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 3490562
model size : 23.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.434306144714355
Epoch: 1, Steps: 17 | Train Loss: 0.759 Vali Loss: 0.803 Vali Acc: 0.587 Test Loss: 0.803 Test Acc: 0.587
Validation loss decreased (inf --> -0.587023).  Saving model ...
Epoch: 2 cost time: 9.74379849433899
Epoch: 2, Steps: 17 | Train Loss: 0.537 Vali Loss: 1.907 Vali Acc: 0.553 Test Loss: 1.907 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.896190643310547
Epoch: 3, Steps: 17 | Train Loss: 0.361 Vali Loss: 1.841 Vali Acc: 0.601 Test Loss: 1.841 Test Acc: 0.601
Validation loss decreased (-0.587023 --> -0.600664).  Saving model ...
Epoch: 4 cost time: 9.979397773742676
Epoch: 4, Steps: 17 | Train Loss: 0.212 Vali Loss: 2.084 Vali Acc: 0.625 Test Loss: 2.084 Test Acc: 0.625
Validation loss decreased (-0.600664 --> -0.624553).  Saving model ...
Epoch: 5 cost time: 11.695814609527588
Epoch: 5, Steps: 17 | Train Loss: 0.335 Vali Loss: 1.443 Vali Acc: 0.611 Test Loss: 1.443 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.380339622497559
Epoch: 6, Steps: 17 | Train Loss: 0.247 Vali Loss: 2.978 Vali Acc: 0.563 Test Loss: 2.978 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.375513792037964
Epoch: 7, Steps: 17 | Train Loss: 1.447 Vali Loss: 9.006 Vali Acc: 0.515 Test Loss: 9.006 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.615970134735107
Epoch: 8, Steps: 17 | Train Loss: 1.553 Vali Loss: 2.973 Vali Acc: 0.604 Test Loss: 2.973 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.40406084060669
Epoch: 9, Steps: 17 | Train Loss: 0.533 Vali Loss: 7.059 Vali Acc: 0.536 Test Loss: 7.059 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.526017189025879
Epoch: 10, Steps: 17 | Train Loss: 0.226 Vali Loss: 4.689 Vali Acc: 0.567 Test Loss: 4.689 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.535064935684204
Epoch: 11, Steps: 17 | Train Loss: 0.530 Vali Loss: 7.564 Vali Acc: 0.560 Test Loss: 7.564 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.893585205078125
Epoch: 12, Steps: 17 | Train Loss: 0.385 Vali Loss: 4.680 Vali Acc: 0.597 Test Loss: 4.680 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.209979057312012
Epoch: 13, Steps: 17 | Train Loss: 0.412 Vali Loss: 10.751 Vali Acc: 0.563 Test Loss: 10.751 Test Acc: 0.563
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 12.437198162078857
Epoch: 14, Steps: 17 | Train Loss: 0.705 Vali Loss: 7.070 Vali Acc: 0.584 Test Loss: 7.070 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 3490562
model size : 23.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 12.769760847091675
Epoch: 1, Steps: 17 | Train Loss: 0.765 Vali Loss: 0.891 Vali Acc: 0.556 Test Loss: 0.891 Test Acc: 0.556
Validation loss decreased (inf --> -0.556305).  Saving model ...
Epoch: 2 cost time: 9.516955614089966
Epoch: 2, Steps: 17 | Train Loss: 0.461 Vali Loss: 1.687 Vali Acc: 0.570 Test Loss: 1.687 Test Acc: 0.570
Validation loss decreased (-0.556305 --> -0.569949).  Saving model ...
Epoch: 3 cost time: 10.098220109939575
Epoch: 3, Steps: 17 | Train Loss: 0.356 Vali Loss: 1.380 Vali Acc: 0.577 Test Loss: 1.380 Test Acc: 0.577
Validation loss decreased (-0.569949 --> -0.576778).  Saving model ...
Epoch: 4 cost time: 9.83739972114563
Epoch: 4, Steps: 17 | Train Loss: 0.378 Vali Loss: 1.459 Vali Acc: 0.584 Test Loss: 1.459 Test Acc: 0.584
Validation loss decreased (-0.576778 --> -0.583603).  Saving model ...
Epoch: 5 cost time: 8.771308183670044
Epoch: 5, Steps: 17 | Train Loss: 0.202 Vali Loss: 2.960 Vali Acc: 0.563 Test Loss: 2.960 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.229160070419312
Epoch: 6, Steps: 17 | Train Loss: 0.333 Vali Loss: 2.705 Vali Acc: 0.601 Test Loss: 2.705 Test Acc: 0.601
Validation loss decreased (-0.583603 --> -0.600656).  Saving model ...
Epoch: 7 cost time: 10.534760475158691
Epoch: 7, Steps: 17 | Train Loss: 0.211 Vali Loss: 2.824 Vali Acc: 0.594 Test Loss: 2.824 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.167211771011353
Epoch: 8, Steps: 17 | Train Loss: 0.273 Vali Loss: 4.118 Vali Acc: 0.594 Test Loss: 4.118 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.91596007347107
Epoch: 9, Steps: 17 | Train Loss: 0.415 Vali Loss: 7.247 Vali Acc: 0.539 Test Loss: 7.247 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.422956943511963
Epoch: 10, Steps: 17 | Train Loss: 0.359 Vali Loss: 4.013 Vali Acc: 0.614 Test Loss: 4.013 Test Acc: 0.614
Validation loss decreased (-0.600656 --> -0.614294).  Saving model ...
Epoch: 11 cost time: 10.982486248016357
Epoch: 11, Steps: 17 | Train Loss: 0.173 Vali Loss: 7.047 Vali Acc: 0.553 Test Loss: 7.047 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.22513222694397
Epoch: 12, Steps: 17 | Train Loss: 0.445 Vali Loss: 4.906 Vali Acc: 0.580 Test Loss: 4.906 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.755157470703125
Epoch: 13, Steps: 17 | Train Loss: 0.379 Vali Loss: 4.585 Vali Acc: 0.621 Test Loss: 4.585 Test Acc: 0.621
Validation loss decreased (-0.614294 --> -0.621115).  Saving model ...
Epoch: 14 cost time: 8.401041030883789
Epoch: 14, Steps: 17 | Train Loss: 0.144 Vali Loss: 8.927 Vali Acc: 0.570 Test Loss: 8.927 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.090901136398315
Epoch: 15, Steps: 17 | Train Loss: 0.095 Vali Loss: 8.202 Vali Acc: 0.570 Test Loss: 8.202 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.181628704071045
Epoch: 16, Steps: 17 | Train Loss: 0.376 Vali Loss: 11.587 Vali Acc: 0.539 Test Loss: 11.587 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.056341171264648
Epoch: 17, Steps: 17 | Train Loss: 0.624 Vali Loss: 6.489 Vali Acc: 0.604 Test Loss: 6.489 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.29841947555542
Epoch: 18, Steps: 17 | Train Loss: 0.054 Vali Loss: 8.050 Vali Acc: 0.590 Test Loss: 8.050 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.258265256881714
Epoch: 19, Steps: 17 | Train Loss: 0.051 Vali Loss: 7.603 Vali Acc: 0.621 Test Loss: 7.603 Test Acc: 0.621
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.728727340698242
Epoch: 20, Steps: 17 | Train Loss: 0.095 Vali Loss: 10.860 Vali Acc: 0.573 Test Loss: 10.860 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.358870029449463
Epoch: 21, Steps: 17 | Train Loss: 0.122 Vali Loss: 6.607 Vali Acc: 0.635 Test Loss: 6.607 Test Acc: 0.635
Validation loss decreased (-0.621115 --> -0.634746).  Saving model ...
Epoch: 22 cost time: 9.552433252334595
Epoch: 22, Steps: 17 | Train Loss: 0.234 Vali Loss: 9.553 Vali Acc: 0.642 Test Loss: 9.553 Test Acc: 0.642
Validation loss decreased (-0.634746 --> -0.641543).  Saving model ...
Epoch: 23 cost time: 9.752605676651001
Epoch: 23, Steps: 17 | Train Loss: 0.208 Vali Loss: 10.387 Vali Acc: 0.628 Test Loss: 10.387 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.901740789413452
Epoch: 24, Steps: 17 | Train Loss: 0.444 Vali Loss: 9.338 Vali Acc: 0.601 Test Loss: 9.338 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.843673706054688
Epoch: 25, Steps: 17 | Train Loss: 0.230 Vali Loss: 16.061 Vali Acc: 0.556 Test Loss: 16.061 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 9.822645664215088
Epoch: 26, Steps: 17 | Train Loss: 0.130 Vali Loss: 13.105 Vali Acc: 0.604 Test Loss: 13.105 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 10.382243871688843
Epoch: 27, Steps: 17 | Train Loss: 0.247 Vali Loss: 15.809 Vali Acc: 0.546 Test Loss: 15.809 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 10.453442811965942
Epoch: 28, Steps: 17 | Train Loss: 0.306 Vali Loss: 10.677 Vali Acc: 0.604 Test Loss: 10.677 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 10.519334077835083
Epoch: 29, Steps: 17 | Train Loss: 0.230 Vali Loss: 12.701 Vali Acc: 0.570 Test Loss: 12.701 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 9.118238925933838
Epoch: 30, Steps: 17 | Train Loss: 0.139 Vali Loss: 11.396 Vali Acc: 0.584 Test Loss: 11.396 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.985859394073486
Epoch: 31, Steps: 17 | Train Loss: 0.076 Vali Loss: 13.903 Vali Acc: 0.597 Test Loss: 13.903 Test Acc: 0.597
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 9.933732271194458
Epoch: 32, Steps: 17 | Train Loss: 0.041 Vali Loss: 20.225 Vali Acc: 0.549 Test Loss: 20.225 Test Acc: 0.549
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 3490562
model size : 23.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.27219533920288
Epoch: 1, Steps: 17 | Train Loss: 0.778 Vali Loss: 0.820 Vali Acc: 0.580 Test Loss: 0.820 Test Acc: 0.580
Validation loss decreased (inf --> -0.580197).  Saving model ...
Epoch: 2 cost time: 7.082580089569092
Epoch: 2, Steps: 17 | Train Loss: 0.569 Vali Loss: 1.981 Vali Acc: 0.539 Test Loss: 1.981 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.934319972991943
Epoch: 3, Steps: 17 | Train Loss: 0.397 Vali Loss: 2.624 Vali Acc: 0.536 Test Loss: 2.624 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.005897521972656
Epoch: 4, Steps: 17 | Train Loss: 0.356 Vali Loss: 1.400 Vali Acc: 0.648 Test Loss: 1.400 Test Acc: 0.648
Validation loss decreased (-0.580197 --> -0.648450).  Saving model ...
Epoch: 5 cost time: 7.697902202606201
Epoch: 5, Steps: 17 | Train Loss: 0.248 Vali Loss: 2.578 Vali Acc: 0.587 Test Loss: 2.578 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.251183271408081
Epoch: 6, Steps: 17 | Train Loss: 0.355 Vali Loss: 4.539 Vali Acc: 0.553 Test Loss: 4.539 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.539819478988647
Epoch: 7, Steps: 17 | Train Loss: 0.284 Vali Loss: 4.460 Vali Acc: 0.556 Test Loss: 4.460 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.266916751861572
Epoch: 8, Steps: 17 | Train Loss: 0.256 Vali Loss: 2.553 Vali Acc: 0.601 Test Loss: 2.553 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.583230257034302
Epoch: 9, Steps: 17 | Train Loss: 0.142 Vali Loss: 4.340 Vali Acc: 0.628 Test Loss: 4.340 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.065521240234375
Epoch: 10, Steps: 17 | Train Loss: 0.231 Vali Loss: 3.794 Vali Acc: 0.608 Test Loss: 3.794 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.9844255447387695
Epoch: 11, Steps: 17 | Train Loss: 0.258 Vali Loss: 3.300 Vali Acc: 0.662 Test Loss: 3.300 Test Acc: 0.662
Validation loss decreased (-0.648450 --> -0.662083).  Saving model ...
Epoch: 12 cost time: 6.8668012619018555
Epoch: 12, Steps: 17 | Train Loss: 0.402 Vali Loss: 7.038 Vali Acc: 0.573 Test Loss: 7.038 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.550559997558594
Epoch: 13, Steps: 17 | Train Loss: 0.112 Vali Loss: 7.528 Vali Acc: 0.556 Test Loss: 7.528 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.57959532737732
Epoch: 14, Steps: 17 | Train Loss: 0.143 Vali Loss: 4.794 Vali Acc: 0.628 Test Loss: 4.794 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.42480731010437
Epoch: 15, Steps: 17 | Train Loss: 0.089 Vali Loss: 5.352 Vali Acc: 0.614 Test Loss: 5.352 Test Acc: 0.614
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.566441297531128
Epoch: 16, Steps: 17 | Train Loss: 0.089 Vali Loss: 7.540 Vali Acc: 0.608 Test Loss: 7.540 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.703938007354736
Epoch: 17, Steps: 17 | Train Loss: 0.118 Vali Loss: 7.774 Vali Acc: 0.601 Test Loss: 7.774 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.687198162078857
Epoch: 18, Steps: 17 | Train Loss: 0.075 Vali Loss: 7.433 Vali Acc: 0.608 Test Loss: 7.433 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.69163990020752
Epoch: 19, Steps: 17 | Train Loss: 0.164 Vali Loss: 9.706 Vali Acc: 0.590 Test Loss: 9.706 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.002053737640381
Epoch: 20, Steps: 17 | Train Loss: 0.125 Vali Loss: 9.076 Vali Acc: 0.621 Test Loss: 9.076 Test Acc: 0.621
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.974942922592163
Epoch: 21, Steps: 17 | Train Loss: 0.052 Vali Loss: 8.231 Vali Acc: 0.635 Test Loss: 8.231 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6621160409556314
model parameter : 3490562
model size : 23.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 8.099488735198975
Epoch: 1, Steps: 17 | Train Loss: 0.856 Vali Loss: 1.446 Vali Acc: 0.502 Test Loss: 1.446 Test Acc: 0.502
Validation loss decreased (inf --> -0.501692).  Saving model ...
Epoch: 2 cost time: 7.173377275466919
Epoch: 2, Steps: 17 | Train Loss: 0.611 Vali Loss: 1.492 Vali Acc: 0.522 Test Loss: 1.492 Test Acc: 0.522
Validation loss decreased (-0.501692 --> -0.522169).  Saving model ...
Epoch: 3 cost time: 7.701258659362793
Epoch: 3, Steps: 17 | Train Loss: 0.444 Vali Loss: 2.139 Vali Acc: 0.526 Test Loss: 2.139 Test Acc: 0.526
Validation loss decreased (-0.522169 --> -0.525576).  Saving model ...
Epoch: 4 cost time: 6.859217882156372
Epoch: 4, Steps: 17 | Train Loss: 0.299 Vali Loss: 2.741 Vali Acc: 0.502 Test Loss: 2.741 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.2796196937561035
Epoch: 5, Steps: 17 | Train Loss: 0.291 Vali Loss: 1.763 Vali Acc: 0.584 Test Loss: 1.763 Test Acc: 0.584
Validation loss decreased (-0.525576 --> -0.583600).  Saving model ...
Epoch: 6 cost time: 7.198977708816528
Epoch: 6, Steps: 17 | Train Loss: 0.622 Vali Loss: 3.595 Vali Acc: 0.539 Test Loss: 3.595 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.283990144729614
Epoch: 7, Steps: 17 | Train Loss: 0.284 Vali Loss: 3.672 Vali Acc: 0.543 Test Loss: 3.672 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.571845293045044
Epoch: 8, Steps: 17 | Train Loss: 0.275 Vali Loss: 2.446 Vali Acc: 0.584 Test Loss: 2.446 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.268773317337036
Epoch: 9, Steps: 17 | Train Loss: 0.199 Vali Loss: 3.112 Vali Acc: 0.587 Test Loss: 3.112 Test Acc: 0.587
Validation loss decreased (-0.583600 --> -0.587000).  Saving model ...
Epoch: 10 cost time: 6.61439847946167
Epoch: 10, Steps: 17 | Train Loss: 0.282 Vali Loss: 2.753 Vali Acc: 0.608 Test Loss: 2.753 Test Acc: 0.608
Validation loss decreased (-0.587000 --> -0.607481).  Saving model ...
Epoch: 11 cost time: 6.870153427124023
Epoch: 11, Steps: 17 | Train Loss: 0.165 Vali Loss: 3.017 Vali Acc: 0.628 Test Loss: 3.017 Test Acc: 0.628
Validation loss decreased (-0.607481 --> -0.627956).  Saving model ...
Epoch: 12 cost time: 6.316910743713379
Epoch: 12, Steps: 17 | Train Loss: 0.194 Vali Loss: 5.330 Vali Acc: 0.543 Test Loss: 5.330 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.914024591445923
Epoch: 13, Steps: 17 | Train Loss: 0.379 Vali Loss: 9.754 Vali Acc: 0.512 Test Loss: 9.754 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.665397882461548
Epoch: 14, Steps: 17 | Train Loss: 0.613 Vali Loss: 6.556 Vali Acc: 0.556 Test Loss: 6.556 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.64705491065979
Epoch: 15, Steps: 17 | Train Loss: 0.264 Vali Loss: 6.727 Vali Acc: 0.563 Test Loss: 6.727 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.711596727371216
Epoch: 16, Steps: 17 | Train Loss: 0.089 Vali Loss: 7.049 Vali Acc: 0.573 Test Loss: 7.049 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.007568120956421
Epoch: 17, Steps: 17 | Train Loss: 0.231 Vali Loss: 12.601 Vali Acc: 0.532 Test Loss: 12.601 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.775030136108398
Epoch: 18, Steps: 17 | Train Loss: 0.556 Vali Loss: 6.469 Vali Acc: 0.580 Test Loss: 6.469 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.912677764892578
Epoch: 19, Steps: 17 | Train Loss: 0.244 Vali Loss: 10.597 Vali Acc: 0.539 Test Loss: 10.597 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.9453723430633545
Epoch: 20, Steps: 17 | Train Loss: 0.294 Vali Loss: 7.092 Vali Acc: 0.590 Test Loss: 7.092 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.319949150085449
Epoch: 21, Steps: 17 | Train Loss: 0.288 Vali Loss: 7.727 Vali Acc: 0.567 Test Loss: 7.727 Test Acc: 0.567
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6279863481228669
model parameter : 3490562
model size : 23.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.315825939178467
Epoch: 1, Steps: 17 | Train Loss: 0.811 Vali Loss: 1.370 Vali Acc: 0.498 Test Loss: 1.370 Test Acc: 0.498
Validation loss decreased (inf --> -0.498280).  Saving model ...
Epoch: 2 cost time: 7.842700004577637
Epoch: 2, Steps: 17 | Train Loss: 0.574 Vali Loss: 1.505 Vali Acc: 0.549 Test Loss: 1.505 Test Acc: 0.549
Validation loss decreased (-0.498280 --> -0.549473).  Saving model ...
Epoch: 3 cost time: 7.1625657081604
Epoch: 3, Steps: 17 | Train Loss: 0.555 Vali Loss: 1.592 Vali Acc: 0.584 Test Loss: 1.592 Test Acc: 0.584
Validation loss decreased (-0.549473 --> -0.583602).  Saving model ...
Epoch: 4 cost time: 7.7039711475372314
Epoch: 4, Steps: 17 | Train Loss: 0.379 Vali Loss: 1.759 Vali Acc: 0.584 Test Loss: 1.759 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.087367057800293
Epoch: 5, Steps: 17 | Train Loss: 0.392 Vali Loss: 1.622 Vali Acc: 0.587 Test Loss: 1.622 Test Acc: 0.587
Validation loss decreased (-0.583602 --> -0.587014).  Saving model ...
Epoch: 6 cost time: 7.569349527359009
Epoch: 6, Steps: 17 | Train Loss: 0.419 Vali Loss: 2.782 Vali Acc: 0.529 Test Loss: 2.782 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.434173583984375
Epoch: 7, Steps: 17 | Train Loss: 0.639 Vali Loss: 6.016 Vali Acc: 0.509 Test Loss: 6.016 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.879142999649048
Epoch: 8, Steps: 17 | Train Loss: 0.804 Vali Loss: 2.298 Vali Acc: 0.584 Test Loss: 2.298 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.496453523635864
Epoch: 9, Steps: 17 | Train Loss: 0.474 Vali Loss: 4.255 Vali Acc: 0.515 Test Loss: 4.255 Test Acc: 0.515
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.905282497406006
Epoch: 10, Steps: 17 | Train Loss: 0.410 Vali Loss: 3.050 Vali Acc: 0.577 Test Loss: 3.050 Test Acc: 0.577
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.187302589416504
Epoch: 11, Steps: 17 | Train Loss: 0.661 Vali Loss: 5.275 Vali Acc: 0.532 Test Loss: 5.275 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.240686893463135
Epoch: 12, Steps: 17 | Train Loss: 0.790 Vali Loss: 4.445 Vali Acc: 0.522 Test Loss: 4.445 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.233509302139282
Epoch: 13, Steps: 17 | Train Loss: 0.783 Vali Loss: 8.162 Vali Acc: 0.536 Test Loss: 8.162 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.833605051040649
Epoch: 14, Steps: 17 | Train Loss: 0.890 Vali Loss: 5.679 Vali Acc: 0.563 Test Loss: 5.679 Test Acc: 0.563
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.175260305404663
Epoch: 15, Steps: 17 | Train Loss: 0.402 Vali Loss: 5.563 Vali Acc: 0.563 Test Loss: 5.563 Test Acc: 0.563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5870307167235495
model parameter : 3490562
model size : 23.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 8.17695140838623
Epoch: 1, Steps: 17 | Train Loss: 0.803 Vali Loss: 1.407 Vali Acc: 0.502 Test Loss: 1.407 Test Acc: 0.502
Validation loss decreased (inf --> -0.501692).  Saving model ...
Epoch: 2 cost time: 6.991660118103027
Epoch: 2, Steps: 17 | Train Loss: 0.574 Vali Loss: 1.180 Vali Acc: 0.546 Test Loss: 1.180 Test Acc: 0.546
Validation loss decreased (-0.501692 --> -0.546063).  Saving model ...
Epoch: 3 cost time: 6.384159564971924
Epoch: 3, Steps: 17 | Train Loss: 0.369 Vali Loss: 1.586 Vali Acc: 0.529 Test Loss: 1.586 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.939913034439087
Epoch: 4, Steps: 17 | Train Loss: 0.312 Vali Loss: 1.740 Vali Acc: 0.549 Test Loss: 1.740 Test Acc: 0.549
Validation loss decreased (-0.546063 --> -0.549471).  Saving model ...
Epoch: 5 cost time: 6.73275351524353
Epoch: 5, Steps: 17 | Train Loss: 0.370 Vali Loss: 2.164 Vali Acc: 0.522 Test Loss: 2.164 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.277688264846802
Epoch: 6, Steps: 17 | Train Loss: 0.317 Vali Loss: 1.978 Vali Acc: 0.543 Test Loss: 1.978 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.3060009479522705
Epoch: 7, Steps: 17 | Train Loss: 0.290 Vali Loss: 4.384 Vali Acc: 0.529 Test Loss: 4.384 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.4510626792907715
Epoch: 8, Steps: 17 | Train Loss: 0.348 Vali Loss: 2.758 Vali Acc: 0.532 Test Loss: 2.758 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.685505628585815
Epoch: 9, Steps: 17 | Train Loss: 0.249 Vali Loss: 4.805 Vali Acc: 0.512 Test Loss: 4.805 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.1799280643463135
Epoch: 10, Steps: 17 | Train Loss: 0.319 Vali Loss: 3.261 Vali Acc: 0.553 Test Loss: 3.261 Test Acc: 0.553
Validation loss decreased (-0.549471 --> -0.552868).  Saving model ...
Epoch: 11 cost time: 8.096272468566895
Epoch: 11, Steps: 17 | Train Loss: 0.242 Vali Loss: 3.579 Vali Acc: 0.549 Test Loss: 3.579 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.466683387756348
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 3.859 Vali Acc: 0.526 Test Loss: 3.859 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.237079381942749
Epoch: 13, Steps: 17 | Train Loss: 0.140 Vali Loss: 4.141 Vali Acc: 0.526 Test Loss: 4.141 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.787541627883911
Epoch: 14, Steps: 17 | Train Loss: 0.279 Vali Loss: 4.764 Vali Acc: 0.536 Test Loss: 4.764 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.89423942565918
Epoch: 15, Steps: 17 | Train Loss: 0.643 Vali Loss: 5.935 Vali Acc: 0.498 Test Loss: 5.935 Test Acc: 0.498
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.484820604324341
Epoch: 16, Steps: 17 | Train Loss: 0.169 Vali Loss: 6.399 Vali Acc: 0.485 Test Loss: 6.399 Test Acc: 0.485
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.626162767410278
Epoch: 17, Steps: 17 | Train Loss: 0.053 Vali Loss: 5.960 Vali Acc: 0.498 Test Loss: 5.960 Test Acc: 0.498
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.191511631011963
Epoch: 18, Steps: 17 | Train Loss: 0.136 Vali Loss: 7.882 Vali Acc: 0.502 Test Loss: 7.882 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.595468521118164
Epoch: 19, Steps: 17 | Train Loss: 0.148 Vali Loss: 7.843 Vali Acc: 0.512 Test Loss: 7.843 Test Acc: 0.512
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.458515167236328
Epoch: 20, Steps: 17 | Train Loss: 0.345 Vali Loss: 7.257 Vali Acc: 0.529 Test Loss: 7.257 Test Acc: 0.529
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.552901023890785
model parameter : 3490562
model size : 23.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.469116926193237
Epoch: 1, Steps: 17 | Train Loss: 0.752 Vali Loss: 1.550 Vali Acc: 0.502 Test Loss: 1.550 Test Acc: 0.502
Validation loss decreased (inf --> -0.501691).  Saving model ...
Epoch: 2 cost time: 6.964820623397827
Epoch: 2, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.978 Vali Acc: 0.502 Test Loss: 0.978 Test Acc: 0.502
Validation loss decreased (-0.501691 --> -0.501697).  Saving model ...
Epoch: 3 cost time: 7.428229808807373
Epoch: 3, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.678 Vali Acc: 0.580 Test Loss: 0.678 Test Acc: 0.580
Validation loss decreased (-0.501697 --> -0.580198).  Saving model ...
Epoch: 4 cost time: 6.087787628173828
Epoch: 4, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.930 Vali Acc: 0.519 Test Loss: 0.930 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.035762071609497
Epoch: 5, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.866 Vali Acc: 0.556 Test Loss: 0.866 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.324498891830444
Epoch: 6, Steps: 17 | Train Loss: 0.371 Vali Loss: 1.498 Vali Acc: 0.509 Test Loss: 1.498 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.835727691650391
Epoch: 7, Steps: 17 | Train Loss: 0.339 Vali Loss: 2.152 Vali Acc: 0.502 Test Loss: 2.152 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.3856892585754395
Epoch: 8, Steps: 17 | Train Loss: 0.389 Vali Loss: 1.059 Vali Acc: 0.567 Test Loss: 1.059 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.333980321884155
Epoch: 9, Steps: 17 | Train Loss: 0.488 Vali Loss: 2.319 Vali Acc: 0.532 Test Loss: 2.319 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.979839324951172
Epoch: 10, Steps: 17 | Train Loss: 0.698 Vali Loss: 3.304 Vali Acc: 0.491 Test Loss: 3.304 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.821413516998291
Epoch: 11, Steps: 17 | Train Loss: 0.516 Vali Loss: 4.328 Vali Acc: 0.498 Test Loss: 4.328 Test Acc: 0.498
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.1552650928497314
Epoch: 12, Steps: 17 | Train Loss: 0.205 Vali Loss: 2.285 Vali Acc: 0.549 Test Loss: 2.285 Test Acc: 0.549
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.424967527389526
Epoch: 13, Steps: 17 | Train Loss: 0.257 Vali Loss: 1.504 Vali Acc: 0.553 Test Loss: 1.504 Test Acc: 0.553
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5802047781569966
model parameter : 3490562
model size : 23.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 8.26693844795227
Epoch: 1, Steps: 17 | Train Loss: 0.702 Vali Loss: 1.121 Vali Acc: 0.502 Test Loss: 1.121 Test Acc: 0.502
Validation loss decreased (inf --> -0.501695).  Saving model ...
Epoch: 2 cost time: 7.53044867515564
Epoch: 2, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.950 Vali Acc: 0.502 Test Loss: 0.950 Test Acc: 0.502
Validation loss decreased (-0.501695 --> -0.501697).  Saving model ...
Epoch: 3 cost time: 6.875748872756958
Epoch: 3, Steps: 17 | Train Loss: 0.495 Vali Loss: 1.110 Vali Acc: 0.519 Test Loss: 1.110 Test Acc: 0.519
Validation loss decreased (-0.501697 --> -0.518760).  Saving model ...
Epoch: 4 cost time: 7.561691999435425
Epoch: 4, Steps: 17 | Train Loss: 0.451 Vali Loss: 1.729 Vali Acc: 0.515 Test Loss: 1.729 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.1736063957214355
Epoch: 5, Steps: 17 | Train Loss: 0.408 Vali Loss: 1.014 Vali Acc: 0.611 Test Loss: 1.014 Test Acc: 0.611
Validation loss decreased (-0.518760 --> -0.610911).  Saving model ...
Epoch: 6 cost time: 7.13833212852478
Epoch: 6, Steps: 17 | Train Loss: 0.542 Vali Loss: 2.292 Vali Acc: 0.549 Test Loss: 2.292 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.905853986740112
Epoch: 7, Steps: 17 | Train Loss: 0.468 Vali Loss: 1.650 Vali Acc: 0.601 Test Loss: 1.650 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.5810463428497314
Epoch: 8, Steps: 17 | Train Loss: 0.318 Vali Loss: 2.506 Vali Acc: 0.597 Test Loss: 2.506 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.518243312835693
Epoch: 9, Steps: 17 | Train Loss: 0.487 Vali Loss: 2.492 Vali Acc: 0.597 Test Loss: 2.492 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.243208408355713
Epoch: 10, Steps: 17 | Train Loss: 0.401 Vali Loss: 3.443 Vali Acc: 0.563 Test Loss: 3.443 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.677091598510742
Epoch: 11, Steps: 17 | Train Loss: 0.567 Vali Loss: 2.994 Vali Acc: 0.611 Test Loss: 2.994 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.983008861541748
Epoch: 12, Steps: 17 | Train Loss: 0.248 Vali Loss: 3.554 Vali Acc: 0.546 Test Loss: 3.554 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.356122255325317
Epoch: 13, Steps: 17 | Train Loss: 0.328 Vali Loss: 2.719 Vali Acc: 0.553 Test Loss: 2.719 Test Acc: 0.553
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.618788242340088
Epoch: 14, Steps: 17 | Train Loss: 0.284 Vali Loss: 3.839 Vali Acc: 0.594 Test Loss: 3.839 Test Acc: 0.594
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.029044151306152
Epoch: 15, Steps: 17 | Train Loss: 0.409 Vali Loss: 5.831 Vali Acc: 0.611 Test Loss: 5.831 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6109215017064846
model parameter : 3490562
model size : 23.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 14.878292083740234
Epoch: 1, Steps: 17 | Train Loss: 0.765 Vali Loss: 0.838 Vali Acc: 0.567 Test Loss: 0.838 Test Acc: 0.567
Validation loss decreased (inf --> -0.566545).  Saving model ...
Epoch: 2 cost time: 11.19814920425415
Epoch: 2, Steps: 17 | Train Loss: 0.734 Vali Loss: 1.076 Vali Acc: 0.642 Test Loss: 1.076 Test Acc: 0.642
Validation loss decreased (-0.566545 --> -0.641627).  Saving model ...
Epoch: 3 cost time: 12.551042079925537
Epoch: 3, Steps: 17 | Train Loss: 0.648 Vali Loss: 1.663 Vali Acc: 0.601 Test Loss: 1.663 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.52661418914795
Epoch: 4, Steps: 17 | Train Loss: 0.494 Vali Loss: 1.377 Vali Acc: 0.638 Test Loss: 1.377 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.04003357887268
Epoch: 5, Steps: 17 | Train Loss: 0.473 Vali Loss: 1.906 Vali Acc: 0.631 Test Loss: 1.906 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.495589256286621
Epoch: 6, Steps: 17 | Train Loss: 0.533 Vali Loss: 2.817 Vali Acc: 0.621 Test Loss: 2.817 Test Acc: 0.621
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.544852256774902
Epoch: 7, Steps: 17 | Train Loss: 0.251 Vali Loss: 3.526 Vali Acc: 0.638 Test Loss: 3.526 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.64798355102539
Epoch: 8, Steps: 17 | Train Loss: 0.417 Vali Loss: 2.149 Vali Acc: 0.679 Test Loss: 2.149 Test Acc: 0.679
Validation loss decreased (-0.641627 --> -0.679159).  Saving model ...
Epoch: 9 cost time: 11.386155128479004
Epoch: 9, Steps: 17 | Train Loss: 0.622 Vali Loss: 3.164 Vali Acc: 0.608 Test Loss: 3.164 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.47074294090271
Epoch: 10, Steps: 17 | Train Loss: 0.226 Vali Loss: 3.457 Vali Acc: 0.655 Test Loss: 3.457 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.649742126464844
Epoch: 11, Steps: 17 | Train Loss: 0.098 Vali Loss: 6.533 Vali Acc: 0.601 Test Loss: 6.533 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.676488399505615
Epoch: 12, Steps: 17 | Train Loss: 0.155 Vali Loss: 7.656 Vali Acc: 0.597 Test Loss: 7.656 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.025294065475464
Epoch: 13, Steps: 17 | Train Loss: 0.224 Vali Loss: 7.187 Vali Acc: 0.621 Test Loss: 7.187 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.676875829696655
Epoch: 14, Steps: 17 | Train Loss: 0.247 Vali Loss: 5.323 Vali Acc: 0.614 Test Loss: 5.323 Test Acc: 0.614
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.546895503997803
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 8.897 Vali Acc: 0.587 Test Loss: 8.897 Test Acc: 0.587
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.191110134124756
Epoch: 16, Steps: 17 | Train Loss: 0.172 Vali Loss: 5.691 Vali Acc: 0.672 Test Loss: 5.691 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.148669481277466
Epoch: 17, Steps: 17 | Train Loss: 0.158 Vali Loss: 6.473 Vali Acc: 0.608 Test Loss: 6.473 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.608304977416992
Epoch: 18, Steps: 17 | Train Loss: 0.080 Vali Loss: 5.291 Vali Acc: 0.659 Test Loss: 5.291 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6791808873720137
model parameter : 3293954
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 11.790167093276978
Epoch: 1, Steps: 17 | Train Loss: 0.776 Vali Loss: 0.803 Vali Acc: 0.563 Test Loss: 0.803 Test Acc: 0.563
Validation loss decreased (inf --> -0.563132).  Saving model ...
Epoch: 2 cost time: 10.944257974624634
Epoch: 2, Steps: 17 | Train Loss: 0.632 Vali Loss: 1.106 Vali Acc: 0.648 Test Loss: 1.106 Test Acc: 0.648
Validation loss decreased (-0.563132 --> -0.648453).  Saving model ...
Epoch: 3 cost time: 8.284162759780884
Epoch: 3, Steps: 17 | Train Loss: 0.851 Vali Loss: 4.388 Vali Acc: 0.509 Test Loss: 4.388 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.154942035675049
Epoch: 4, Steps: 17 | Train Loss: 0.845 Vali Loss: 1.994 Vali Acc: 0.618 Test Loss: 1.994 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.258499383926392
Epoch: 5, Steps: 17 | Train Loss: 1.214 Vali Loss: 2.671 Vali Acc: 0.628 Test Loss: 2.671 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.460363864898682
Epoch: 6, Steps: 17 | Train Loss: 0.650 Vali Loss: 4.482 Vali Acc: 0.577 Test Loss: 4.482 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.493064880371094
Epoch: 7, Steps: 17 | Train Loss: 0.812 Vali Loss: 4.424 Vali Acc: 0.621 Test Loss: 4.424 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.10616135597229
Epoch: 8, Steps: 17 | Train Loss: 0.577 Vali Loss: 2.878 Vali Acc: 0.628 Test Loss: 2.878 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.069620609283447
Epoch: 9, Steps: 17 | Train Loss: 0.486 Vali Loss: 2.727 Vali Acc: 0.645 Test Loss: 2.727 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.765489101409912
Epoch: 10, Steps: 17 | Train Loss: 0.266 Vali Loss: 2.462 Vali Acc: 0.686 Test Loss: 2.462 Test Acc: 0.686
Validation loss decreased (-0.648453 --> -0.685982).  Saving model ...
Epoch: 11 cost time: 9.315690279006958
Epoch: 11, Steps: 17 | Train Loss: 0.333 Vali Loss: 3.320 Vali Acc: 0.601 Test Loss: 3.320 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.090989112854004
Epoch: 12, Steps: 17 | Train Loss: 0.165 Vali Loss: 6.196 Vali Acc: 0.608 Test Loss: 6.196 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.784449815750122
Epoch: 13, Steps: 17 | Train Loss: 0.276 Vali Loss: 7.760 Vali Acc: 0.594 Test Loss: 7.760 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.04815936088562
Epoch: 14, Steps: 17 | Train Loss: 0.277 Vali Loss: 6.011 Vali Acc: 0.618 Test Loss: 6.011 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.382752180099487
Epoch: 15, Steps: 17 | Train Loss: 0.133 Vali Loss: 5.220 Vali Acc: 0.645 Test Loss: 5.220 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.072707653045654
Epoch: 16, Steps: 17 | Train Loss: 0.059 Vali Loss: 6.831 Vali Acc: 0.631 Test Loss: 6.831 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.578689813613892
Epoch: 17, Steps: 17 | Train Loss: 0.235 Vali Loss: 9.359 Vali Acc: 0.608 Test Loss: 9.359 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.274908304214478
Epoch: 18, Steps: 17 | Train Loss: 0.088 Vali Loss: 6.533 Vali Acc: 0.648 Test Loss: 6.533 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.851196765899658
Epoch: 19, Steps: 17 | Train Loss: 0.108 Vali Loss: 5.849 Vali Acc: 0.621 Test Loss: 5.849 Test Acc: 0.621
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.087296485900879
Epoch: 20, Steps: 17 | Train Loss: 0.195 Vali Loss: 9.110 Vali Acc: 0.590 Test Loss: 9.110 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6860068259385665
model parameter : 3293954
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.83150315284729
Epoch: 1, Steps: 17 | Train Loss: 0.781 Vali Loss: 0.876 Vali Acc: 0.512 Test Loss: 0.876 Test Acc: 0.512
Validation loss decreased (inf --> -0.511937).  Saving model ...
Epoch: 2 cost time: 8.505053520202637
Epoch: 2, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.991 Vali Acc: 0.604 Test Loss: 0.991 Test Acc: 0.604
Validation loss decreased (-0.511937 --> -0.604086).  Saving model ...
Epoch: 3 cost time: 8.956746339797974
Epoch: 3, Steps: 17 | Train Loss: 0.487 Vali Loss: 1.176 Vali Acc: 0.614 Test Loss: 1.176 Test Acc: 0.614
Validation loss decreased (-0.604086 --> -0.614323).  Saving model ...
Epoch: 4 cost time: 8.340392827987671
Epoch: 4, Steps: 17 | Train Loss: 0.438 Vali Loss: 1.584 Vali Acc: 0.614 Test Loss: 1.584 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.986932277679443
Epoch: 5, Steps: 17 | Train Loss: 0.402 Vali Loss: 2.774 Vali Acc: 0.580 Test Loss: 2.774 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.061477422714233
Epoch: 6, Steps: 17 | Train Loss: 0.408 Vali Loss: 2.091 Vali Acc: 0.621 Test Loss: 2.091 Test Acc: 0.621
Validation loss decreased (-0.614323 --> -0.621140).  Saving model ...
Epoch: 7 cost time: 8.901534080505371
Epoch: 7, Steps: 17 | Train Loss: 0.175 Vali Loss: 4.057 Vali Acc: 0.590 Test Loss: 4.057 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.49268102645874
Epoch: 8, Steps: 17 | Train Loss: 0.187 Vali Loss: 2.867 Vali Acc: 0.577 Test Loss: 2.867 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.17217493057251
Epoch: 9, Steps: 17 | Train Loss: 1.007 Vali Loss: 3.939 Vali Acc: 0.594 Test Loss: 3.939 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.058188438415527
Epoch: 10, Steps: 17 | Train Loss: 0.143 Vali Loss: 4.576 Vali Acc: 0.580 Test Loss: 4.576 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.820155143737793
Epoch: 11, Steps: 17 | Train Loss: 0.088 Vali Loss: 4.430 Vali Acc: 0.590 Test Loss: 4.430 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.838535785675049
Epoch: 12, Steps: 17 | Train Loss: 0.142 Vali Loss: 6.377 Vali Acc: 0.553 Test Loss: 6.377 Test Acc: 0.553
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.062286853790283
Epoch: 13, Steps: 17 | Train Loss: 0.623 Vali Loss: 4.490 Vali Acc: 0.580 Test Loss: 4.490 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.262886047363281
Epoch: 14, Steps: 17 | Train Loss: 0.096 Vali Loss: 5.744 Vali Acc: 0.584 Test Loss: 5.744 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.977657556533813
Epoch: 15, Steps: 17 | Train Loss: 0.290 Vali Loss: 4.575 Vali Acc: 0.628 Test Loss: 4.575 Test Acc: 0.628
Validation loss decreased (-0.621140 --> -0.627941).  Saving model ...
Epoch: 16 cost time: 9.083749055862427
Epoch: 16, Steps: 17 | Train Loss: 0.312 Vali Loss: 10.401 Vali Acc: 0.567 Test Loss: 10.401 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.229809045791626
Epoch: 17, Steps: 17 | Train Loss: 0.117 Vali Loss: 7.230 Vali Acc: 0.608 Test Loss: 7.230 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.548532009124756
Epoch: 18, Steps: 17 | Train Loss: 0.168 Vali Loss: 7.659 Vali Acc: 0.611 Test Loss: 7.659 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.811185359954834
Epoch: 19, Steps: 17 | Train Loss: 0.467 Vali Loss: 7.466 Vali Acc: 0.635 Test Loss: 7.466 Test Acc: 0.635
Validation loss decreased (-0.627941 --> -0.634738).  Saving model ...
Epoch: 20 cost time: 8.757132768630981
Epoch: 20, Steps: 17 | Train Loss: 0.113 Vali Loss: 11.523 Vali Acc: 0.577 Test Loss: 11.523 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.667965173721313
Epoch: 21, Steps: 17 | Train Loss: 0.075 Vali Loss: 6.828 Vali Acc: 0.638 Test Loss: 6.828 Test Acc: 0.638
Validation loss decreased (-0.634738 --> -0.638157).  Saving model ...
Epoch: 22 cost time: 9.385793447494507
Epoch: 22, Steps: 17 | Train Loss: 0.072 Vali Loss: 9.994 Vali Acc: 0.604 Test Loss: 9.994 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 9.876834154129028
Epoch: 23, Steps: 17 | Train Loss: 0.075 Vali Loss: 13.317 Vali Acc: 0.567 Test Loss: 13.317 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 9.81521725654602
Epoch: 24, Steps: 17 | Train Loss: 0.125 Vali Loss: 7.566 Vali Acc: 0.604 Test Loss: 7.566 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 9.310538053512573
Epoch: 25, Steps: 17 | Train Loss: 0.294 Vali Loss: 11.234 Vali Acc: 0.597 Test Loss: 11.234 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 8.958142757415771
Epoch: 26, Steps: 17 | Train Loss: 0.056 Vali Loss: 8.086 Vali Acc: 0.662 Test Loss: 8.086 Test Acc: 0.662
Validation loss decreased (-0.638157 --> -0.662035).  Saving model ...
Epoch: 27 cost time: 8.219359874725342
Epoch: 27, Steps: 17 | Train Loss: 0.128 Vali Loss: 13.995 Vali Acc: 0.570 Test Loss: 13.995 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 9.676748991012573
Epoch: 28, Steps: 17 | Train Loss: 0.105 Vali Loss: 9.704 Vali Acc: 0.638 Test Loss: 9.704 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 8.092896699905396
Epoch: 29, Steps: 17 | Train Loss: 0.170 Vali Loss: 12.949 Vali Acc: 0.604 Test Loss: 12.949 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 8.235003471374512
Epoch: 30, Steps: 17 | Train Loss: 0.196 Vali Loss: 12.312 Vali Acc: 0.638 Test Loss: 12.312 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 9.27491021156311
Epoch: 31, Steps: 17 | Train Loss: 0.130 Vali Loss: 11.268 Vali Acc: 0.642 Test Loss: 11.268 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 9.575456619262695
Epoch: 32, Steps: 17 | Train Loss: 0.086 Vali Loss: 15.941 Vali Acc: 0.570 Test Loss: 15.941 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 10.05985975265503
Epoch: 33, Steps: 17 | Train Loss: 0.023 Vali Loss: 14.475 Vali Acc: 0.604 Test Loss: 14.475 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 9.107191801071167
Epoch: 34, Steps: 17 | Train Loss: 0.105 Vali Loss: 10.924 Vali Acc: 0.652 Test Loss: 10.924 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 10.525983810424805
Epoch: 35, Steps: 17 | Train Loss: 0.135 Vali Loss: 11.331 Vali Acc: 0.628 Test Loss: 11.331 Test Acc: 0.628
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 8.462273359298706
Epoch: 36, Steps: 17 | Train Loss: 0.142 Vali Loss: 17.446 Vali Acc: 0.614 Test Loss: 17.446 Test Acc: 0.614
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6621160409556314
model parameter : 3293954
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.251343250274658
Epoch: 1, Steps: 17 | Train Loss: 0.783 Vali Loss: 0.794 Vali Acc: 0.515 Test Loss: 0.794 Test Acc: 0.515
Validation loss decreased (inf --> -0.515350).  Saving model ...
Epoch: 2 cost time: 8.30457592010498
Epoch: 2, Steps: 17 | Train Loss: 0.640 Vali Loss: 1.097 Vali Acc: 0.590 Test Loss: 1.097 Test Acc: 0.590
Validation loss decreased (-0.515350 --> -0.590433).  Saving model ...
Epoch: 3 cost time: 8.48818850517273
Epoch: 3, Steps: 17 | Train Loss: 0.363 Vali Loss: 1.853 Vali Acc: 0.539 Test Loss: 1.853 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.140814065933228
Epoch: 4, Steps: 17 | Train Loss: 0.533 Vali Loss: 1.719 Vali Acc: 0.604 Test Loss: 1.719 Test Acc: 0.604
Validation loss decreased (-0.590433 --> -0.604078).  Saving model ...
Epoch: 5 cost time: 8.880615472793579
Epoch: 5, Steps: 17 | Train Loss: 0.530 Vali Loss: 2.683 Vali Acc: 0.529 Test Loss: 2.683 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.670464515686035
Epoch: 6, Steps: 17 | Train Loss: 0.298 Vali Loss: 1.909 Vali Acc: 0.618 Test Loss: 1.909 Test Acc: 0.618
Validation loss decreased (-0.604078 --> -0.617728).  Saving model ...
Epoch: 7 cost time: 8.713177680969238
Epoch: 7, Steps: 17 | Train Loss: 0.300 Vali Loss: 7.014 Vali Acc: 0.529 Test Loss: 7.014 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.732757568359375
Epoch: 8, Steps: 17 | Train Loss: 0.580 Vali Loss: 5.503 Vali Acc: 0.536 Test Loss: 5.503 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.031426191329956
Epoch: 9, Steps: 17 | Train Loss: 0.525 Vali Loss: 4.251 Vali Acc: 0.584 Test Loss: 4.251 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.910642147064209
Epoch: 10, Steps: 17 | Train Loss: 0.774 Vali Loss: 3.714 Vali Acc: 0.604 Test Loss: 3.714 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.717931509017944
Epoch: 11, Steps: 17 | Train Loss: 0.929 Vali Loss: 6.563 Vali Acc: 0.580 Test Loss: 6.563 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.891979932785034
Epoch: 12, Steps: 17 | Train Loss: 0.179 Vali Loss: 5.230 Vali Acc: 0.625 Test Loss: 5.230 Test Acc: 0.625
Validation loss decreased (-0.617728 --> -0.624521).  Saving model ...
Epoch: 13 cost time: 9.420657396316528
Epoch: 13, Steps: 17 | Train Loss: 0.101 Vali Loss: 5.372 Vali Acc: 0.594 Test Loss: 5.372 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.772876739501953
Epoch: 14, Steps: 17 | Train Loss: 0.118 Vali Loss: 9.608 Vali Acc: 0.526 Test Loss: 9.608 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.895771026611328
Epoch: 15, Steps: 17 | Train Loss: 0.189 Vali Loss: 6.568 Vali Acc: 0.584 Test Loss: 6.568 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.918612957000732
Epoch: 16, Steps: 17 | Train Loss: 0.075 Vali Loss: 5.862 Vali Acc: 0.597 Test Loss: 5.862 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.313714265823364
Epoch: 17, Steps: 17 | Train Loss: 0.527 Vali Loss: 9.736 Vali Acc: 0.560 Test Loss: 9.736 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.017242431640625
Epoch: 18, Steps: 17 | Train Loss: 0.908 Vali Loss: 11.560 Vali Acc: 0.549 Test Loss: 11.560 Test Acc: 0.549
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.944127321243286
Epoch: 19, Steps: 17 | Train Loss: 0.285 Vali Loss: 7.962 Vali Acc: 0.618 Test Loss: 7.962 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.908061504364014
Epoch: 20, Steps: 17 | Train Loss: 0.171 Vali Loss: 12.253 Vali Acc: 0.584 Test Loss: 12.253 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.690393209457397
Epoch: 21, Steps: 17 | Train Loss: 0.369 Vali Loss: 11.146 Vali Acc: 0.587 Test Loss: 11.146 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.57926082611084
Epoch: 22, Steps: 17 | Train Loss: 0.476 Vali Loss: 8.136 Vali Acc: 0.587 Test Loss: 8.136 Test Acc: 0.587
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 3293954
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.07493281364441
Epoch: 1, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.807 Vali Acc: 0.505 Test Loss: 0.807 Test Acc: 0.505
Validation loss decreased (inf --> -0.505111).  Saving model ...
Epoch: 2 cost time: 7.889335632324219
Epoch: 2, Steps: 17 | Train Loss: 0.648 Vali Loss: 1.028 Vali Acc: 0.631 Test Loss: 1.028 Test Acc: 0.631
Validation loss decreased (-0.505111 --> -0.631389).  Saving model ...
Epoch: 3 cost time: 8.103296756744385
Epoch: 3, Steps: 17 | Train Loss: 0.361 Vali Loss: 1.127 Vali Acc: 0.642 Test Loss: 1.127 Test Acc: 0.642
Validation loss decreased (-0.631389 --> -0.641627).  Saving model ...
Epoch: 4 cost time: 7.959670066833496
Epoch: 4, Steps: 17 | Train Loss: 0.464 Vali Loss: 1.640 Vali Acc: 0.638 Test Loss: 1.640 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.691917896270752
Epoch: 5, Steps: 17 | Train Loss: 0.504 Vali Loss: 2.885 Vali Acc: 0.577 Test Loss: 2.885 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.713218450546265
Epoch: 6, Steps: 17 | Train Loss: 0.305 Vali Loss: 3.415 Vali Acc: 0.580 Test Loss: 3.415 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.855907917022705
Epoch: 7, Steps: 17 | Train Loss: 0.513 Vali Loss: 6.199 Vali Acc: 0.529 Test Loss: 6.199 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.078275203704834
Epoch: 8, Steps: 17 | Train Loss: 0.405 Vali Loss: 4.725 Vali Acc: 0.570 Test Loss: 4.725 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.461003303527832
Epoch: 9, Steps: 17 | Train Loss: 0.388 Vali Loss: 3.064 Vali Acc: 0.608 Test Loss: 3.064 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.2156946659088135
Epoch: 10, Steps: 17 | Train Loss: 0.274 Vali Loss: 3.888 Vali Acc: 0.621 Test Loss: 3.888 Test Acc: 0.621
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.926755905151367
Epoch: 11, Steps: 17 | Train Loss: 0.294 Vali Loss: 3.654 Vali Acc: 0.648 Test Loss: 3.654 Test Acc: 0.648
Validation loss decreased (-0.641627 --> -0.648428).  Saving model ...
Epoch: 12 cost time: 7.978474855422974
Epoch: 12, Steps: 17 | Train Loss: 0.460 Vali Loss: 4.428 Vali Acc: 0.625 Test Loss: 4.428 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.054883241653442
Epoch: 13, Steps: 17 | Train Loss: 0.214 Vali Loss: 9.803 Vali Acc: 0.549 Test Loss: 9.803 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.565004587173462
Epoch: 14, Steps: 17 | Train Loss: 0.546 Vali Loss: 5.409 Vali Acc: 0.611 Test Loss: 5.409 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.623015403747559
Epoch: 15, Steps: 17 | Train Loss: 0.132 Vali Loss: 6.525 Vali Acc: 0.594 Test Loss: 6.525 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.518584728240967
Epoch: 16, Steps: 17 | Train Loss: 0.090 Vali Loss: 9.080 Vali Acc: 0.584 Test Loss: 9.080 Test Acc: 0.584
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.0517578125
Epoch: 17, Steps: 17 | Train Loss: 0.111 Vali Loss: 7.252 Vali Acc: 0.614 Test Loss: 7.252 Test Acc: 0.614
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.4975199699401855
Epoch: 18, Steps: 17 | Train Loss: 0.138 Vali Loss: 8.177 Vali Acc: 0.621 Test Loss: 8.177 Test Acc: 0.621
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.961418151855469
Epoch: 19, Steps: 17 | Train Loss: 0.289 Vali Loss: 6.866 Vali Acc: 0.638 Test Loss: 6.866 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.939190149307251
Epoch: 20, Steps: 17 | Train Loss: 0.112 Vali Loss: 12.538 Vali Acc: 0.553 Test Loss: 12.538 Test Acc: 0.553
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.554909944534302
Epoch: 21, Steps: 17 | Train Loss: 0.243 Vali Loss: 8.000 Vali Acc: 0.608 Test Loss: 8.000 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6484641638225256
model parameter : 3293954
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 8.867247581481934
Epoch: 1, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.809 Vali Acc: 0.573 Test Loss: 0.809 Test Acc: 0.573
Validation loss decreased (inf --> -0.573371).  Saving model ...
Epoch: 2 cost time: 7.330920934677124
Epoch: 2, Steps: 17 | Train Loss: 0.666 Vali Loss: 1.167 Vali Acc: 0.573 Test Loss: 1.167 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.306900501251221
Epoch: 3, Steps: 17 | Train Loss: 0.507 Vali Loss: 1.107 Vali Acc: 0.584 Test Loss: 1.107 Test Acc: 0.584
Validation loss decreased (-0.573371 --> -0.583607).  Saving model ...
Epoch: 4 cost time: 7.116533994674683
Epoch: 4, Steps: 17 | Train Loss: 0.478 Vali Loss: 2.101 Vali Acc: 0.556 Test Loss: 2.101 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.811342000961304
Epoch: 5, Steps: 17 | Train Loss: 0.379 Vali Loss: 2.640 Vali Acc: 0.580 Test Loss: 2.640 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.27147102355957
Epoch: 6, Steps: 17 | Train Loss: 0.320 Vali Loss: 2.156 Vali Acc: 0.594 Test Loss: 2.156 Test Acc: 0.594
Validation loss decreased (-0.583607 --> -0.593835).  Saving model ...
Epoch: 7 cost time: 6.797592639923096
Epoch: 7, Steps: 17 | Train Loss: 0.491 Vali Loss: 3.224 Vali Acc: 0.570 Test Loss: 3.224 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.029395580291748
Epoch: 8, Steps: 17 | Train Loss: 0.852 Vali Loss: 4.347 Vali Acc: 0.549 Test Loss: 4.347 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.54656457901001
Epoch: 9, Steps: 17 | Train Loss: 1.210 Vali Loss: 5.790 Vali Acc: 0.536 Test Loss: 5.790 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.962485074996948
Epoch: 10, Steps: 17 | Train Loss: 0.450 Vali Loss: 3.352 Vali Acc: 0.635 Test Loss: 3.352 Test Acc: 0.635
Validation loss decreased (-0.593835 --> -0.634779).  Saving model ...
Epoch: 11 cost time: 7.222667932510376
Epoch: 11, Steps: 17 | Train Loss: 0.436 Vali Loss: 3.404 Vali Acc: 0.618 Test Loss: 3.404 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.363729953765869
Epoch: 12, Steps: 17 | Train Loss: 0.366 Vali Loss: 3.733 Vali Acc: 0.604 Test Loss: 3.733 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.585061550140381
Epoch: 13, Steps: 17 | Train Loss: 0.267 Vali Loss: 4.695 Vali Acc: 0.573 Test Loss: 4.695 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.196903944015503
Epoch: 14, Steps: 17 | Train Loss: 0.199 Vali Loss: 4.301 Vali Acc: 0.577 Test Loss: 4.301 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.654083967208862
Epoch: 15, Steps: 17 | Train Loss: 0.271 Vali Loss: 4.270 Vali Acc: 0.608 Test Loss: 4.270 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.647610425949097
Epoch: 16, Steps: 17 | Train Loss: 0.131 Vali Loss: 5.529 Vali Acc: 0.563 Test Loss: 5.529 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.394080400466919
Epoch: 17, Steps: 17 | Train Loss: 0.064 Vali Loss: 5.796 Vali Acc: 0.587 Test Loss: 5.796 Test Acc: 0.587
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.95484471321106
Epoch: 18, Steps: 17 | Train Loss: 0.103 Vali Loss: 6.952 Vali Acc: 0.573 Test Loss: 6.952 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.761008977890015
Epoch: 19, Steps: 17 | Train Loss: 0.093 Vali Loss: 7.918 Vali Acc: 0.608 Test Loss: 7.918 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.050504446029663
Epoch: 20, Steps: 17 | Train Loss: 0.127 Vali Loss: 13.421 Vali Acc: 0.539 Test Loss: 13.421 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6348122866894198
model parameter : 3293954
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.737980127334595
Epoch: 1, Steps: 17 | Train Loss: 0.738 Vali Loss: 0.927 Vali Acc: 0.553 Test Loss: 0.927 Test Acc: 0.553
Validation loss decreased (inf --> -0.552892).  Saving model ...
Epoch: 2 cost time: 6.14506196975708
Epoch: 2, Steps: 17 | Train Loss: 0.643 Vali Loss: 1.194 Vali Acc: 0.567 Test Loss: 1.194 Test Acc: 0.567
Validation loss decreased (-0.552892 --> -0.566541).  Saving model ...
Epoch: 3 cost time: 5.896597146987915
Epoch: 3, Steps: 17 | Train Loss: 0.476 Vali Loss: 1.159 Vali Acc: 0.594 Test Loss: 1.159 Test Acc: 0.594
Validation loss decreased (-0.566541 --> -0.593845).  Saving model ...
Epoch: 4 cost time: 6.205841302871704
Epoch: 4, Steps: 17 | Train Loss: 0.649 Vali Loss: 2.791 Vali Acc: 0.526 Test Loss: 2.791 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.128849983215332
Epoch: 5, Steps: 17 | Train Loss: 0.691 Vali Loss: 1.950 Vali Acc: 0.570 Test Loss: 1.950 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.126107454299927
Epoch: 6, Steps: 17 | Train Loss: 0.717 Vali Loss: 2.593 Vali Acc: 0.597 Test Loss: 2.593 Test Acc: 0.597
Validation loss decreased (-0.593845 --> -0.597244).  Saving model ...
Epoch: 7 cost time: 6.326615810394287
Epoch: 7, Steps: 17 | Train Loss: 0.904 Vali Loss: 3.994 Vali Acc: 0.543 Test Loss: 3.994 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.592507362365723
Epoch: 8, Steps: 17 | Train Loss: 0.533 Vali Loss: 3.016 Vali Acc: 0.597 Test Loss: 3.016 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.615580797195435
Epoch: 9, Steps: 17 | Train Loss: 0.603 Vali Loss: 2.980 Vali Acc: 0.594 Test Loss: 2.980 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.297156572341919
Epoch: 10, Steps: 17 | Train Loss: 0.362 Vali Loss: 4.309 Vali Acc: 0.567 Test Loss: 4.309 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.715886831283569
Epoch: 11, Steps: 17 | Train Loss: 0.458 Vali Loss: 3.441 Vali Acc: 0.618 Test Loss: 3.441 Test Acc: 0.618
Validation loss decreased (-0.597244 --> -0.617713).  Saving model ...
Epoch: 12 cost time: 7.8882155418396
Epoch: 12, Steps: 17 | Train Loss: 0.630 Vali Loss: 3.968 Vali Acc: 0.573 Test Loss: 3.968 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.190984487533569
Epoch: 13, Steps: 17 | Train Loss: 0.254 Vali Loss: 5.033 Vali Acc: 0.522 Test Loss: 5.033 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.53313422203064
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 5.467 Vali Acc: 0.570 Test Loss: 5.467 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.263380765914917
Epoch: 15, Steps: 17 | Train Loss: 0.200 Vali Loss: 6.122 Vali Acc: 0.570 Test Loss: 6.122 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.654397964477539
Epoch: 16, Steps: 17 | Train Loss: 0.320 Vali Loss: 5.854 Vali Acc: 0.570 Test Loss: 5.854 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.910900831222534
Epoch: 17, Steps: 17 | Train Loss: 0.727 Vali Loss: 6.506 Vali Acc: 0.580 Test Loss: 6.506 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.3978190422058105
Epoch: 18, Steps: 17 | Train Loss: 0.276 Vali Loss: 8.699 Vali Acc: 0.539 Test Loss: 8.699 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.491236925125122
Epoch: 19, Steps: 17 | Train Loss: 0.512 Vali Loss: 6.697 Vali Acc: 0.567 Test Loss: 6.697 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.4143455028533936
Epoch: 20, Steps: 17 | Train Loss: 0.120 Vali Loss: 9.467 Vali Acc: 0.543 Test Loss: 9.467 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.983657360076904
Epoch: 21, Steps: 17 | Train Loss: 0.076 Vali Loss: 8.673 Vali Acc: 0.539 Test Loss: 8.673 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6177474402730375
model parameter : 3293954
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.74338698387146
Epoch: 1, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.749 Vali Acc: 0.553 Test Loss: 0.749 Test Acc: 0.553
Validation loss decreased (inf --> -0.552894).  Saving model ...
Epoch: 2 cost time: 6.572870969772339
Epoch: 2, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.928 Vali Acc: 0.567 Test Loss: 0.928 Test Acc: 0.567
Validation loss decreased (-0.552894 --> -0.566544).  Saving model ...
Epoch: 3 cost time: 6.606786727905273
Epoch: 3, Steps: 17 | Train Loss: 0.482 Vali Loss: 1.321 Vali Acc: 0.539 Test Loss: 1.321 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.093238353729248
Epoch: 4, Steps: 17 | Train Loss: 0.456 Vali Loss: 1.708 Vali Acc: 0.549 Test Loss: 1.708 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.654488563537598
Epoch: 5, Steps: 17 | Train Loss: 0.560 Vali Loss: 1.656 Vali Acc: 0.532 Test Loss: 1.656 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.589908123016357
Epoch: 6, Steps: 17 | Train Loss: 0.269 Vali Loss: 2.226 Vali Acc: 0.519 Test Loss: 2.226 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.988089084625244
Epoch: 7, Steps: 17 | Train Loss: 0.294 Vali Loss: 3.049 Vali Acc: 0.512 Test Loss: 3.049 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.721418142318726
Epoch: 8, Steps: 17 | Train Loss: 0.206 Vali Loss: 2.931 Vali Acc: 0.512 Test Loss: 2.931 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.505121231079102
Epoch: 9, Steps: 17 | Train Loss: 0.250 Vali Loss: 3.429 Vali Acc: 0.515 Test Loss: 3.429 Test Acc: 0.515
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.610558271408081
Epoch: 10, Steps: 17 | Train Loss: 0.267 Vali Loss: 3.628 Vali Acc: 0.512 Test Loss: 3.628 Test Acc: 0.512
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.540526628494263
Epoch: 11, Steps: 17 | Train Loss: 0.196 Vali Loss: 3.891 Vali Acc: 0.522 Test Loss: 3.891 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.818426609039307
Epoch: 12, Steps: 17 | Train Loss: 0.587 Vali Loss: 4.177 Vali Acc: 0.532 Test Loss: 4.177 Test Acc: 0.532
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5665529010238908
model parameter : 3293954
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.712212800979614
Epoch: 1, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.799 Vali Acc: 0.502 Test Loss: 0.799 Test Acc: 0.502
Validation loss decreased (inf --> -0.501698).  Saving model ...
Epoch: 2 cost time: 6.167834043502808
Epoch: 2, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.726 Vali Acc: 0.498 Test Loss: 0.726 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.98926043510437
Epoch: 3, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.720 Vali Acc: 0.553 Test Loss: 0.720 Test Acc: 0.553
Validation loss decreased (-0.501698 --> -0.552894).  Saving model ...
Epoch: 4 cost time: 6.366050958633423
Epoch: 4, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.723 Vali Acc: 0.580 Test Loss: 0.723 Test Acc: 0.580
Validation loss decreased (-0.552894 --> -0.580198).  Saving model ...
Epoch: 5 cost time: 6.522010326385498
Epoch: 5, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.761 Vali Acc: 0.580 Test Loss: 0.761 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.8682780265808105
Epoch: 6, Steps: 17 | Train Loss: 0.361 Vali Loss: 2.051 Vali Acc: 0.498 Test Loss: 2.051 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.4142115116119385
Epoch: 7, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.970 Vali Acc: 0.587 Test Loss: 0.970 Test Acc: 0.587
Validation loss decreased (-0.580198 --> -0.587021).  Saving model ...
Epoch: 8 cost time: 6.839807510375977
Epoch: 8, Steps: 17 | Train Loss: 0.311 Vali Loss: 1.614 Vali Acc: 0.536 Test Loss: 1.614 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.144787549972534
Epoch: 9, Steps: 17 | Train Loss: 0.232 Vali Loss: 1.192 Vali Acc: 0.553 Test Loss: 1.192 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.231450080871582
Epoch: 10, Steps: 17 | Train Loss: 0.359 Vali Loss: 3.282 Vali Acc: 0.498 Test Loss: 3.282 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.965908050537109
Epoch: 11, Steps: 17 | Train Loss: 0.468 Vali Loss: 2.898 Vali Acc: 0.505 Test Loss: 2.898 Test Acc: 0.505
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.390612363815308
Epoch: 12, Steps: 17 | Train Loss: 0.256 Vali Loss: 1.822 Vali Acc: 0.560 Test Loss: 1.822 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.191589117050171
Epoch: 13, Steps: 17 | Train Loss: 0.462 Vali Loss: 2.220 Vali Acc: 0.546 Test Loss: 2.220 Test Acc: 0.546
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.797173023223877
Epoch: 14, Steps: 17 | Train Loss: 0.537 Vali Loss: 1.989 Vali Acc: 0.543 Test Loss: 1.989 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.5665082931518555
Epoch: 15, Steps: 17 | Train Loss: 0.326 Vali Loss: 3.974 Vali Acc: 0.502 Test Loss: 3.974 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.854708671569824
Epoch: 16, Steps: 17 | Train Loss: 0.268 Vali Loss: 6.150 Vali Acc: 0.498 Test Loss: 6.150 Test Acc: 0.498
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.68523383140564
Epoch: 17, Steps: 17 | Train Loss: 0.241 Vali Loss: 3.248 Vali Acc: 0.532 Test Loss: 3.248 Test Acc: 0.532
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5870307167235495
model parameter : 3293954
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.2309980392456055
Epoch: 1, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.788 Vali Acc: 0.488 Test Loss: 0.788 Test Acc: 0.488
Validation loss decreased (inf --> -0.488047).  Saving model ...
Epoch: 2 cost time: 6.811415433883667
Epoch: 2, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.988 Vali Acc: 0.509 Test Loss: 0.988 Test Acc: 0.509
Validation loss decreased (-0.488047 --> -0.508523).  Saving model ...
Epoch: 3 cost time: 7.147987604141235
Epoch: 3, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.813 Vali Acc: 0.539 Test Loss: 0.813 Test Acc: 0.539
Validation loss decreased (-0.508523 --> -0.539241).  Saving model ...
Epoch: 4 cost time: 6.537286043167114
Epoch: 4, Steps: 17 | Train Loss: 0.508 Vali Loss: 1.271 Vali Acc: 0.539 Test Loss: 1.271 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.684097528457642
Epoch: 5, Steps: 17 | Train Loss: 0.530 Vali Loss: 1.399 Vali Acc: 0.563 Test Loss: 1.399 Test Acc: 0.563
Validation loss decreased (-0.539241 --> -0.563126).  Saving model ...
Epoch: 6 cost time: 7.111881732940674
Epoch: 6, Steps: 17 | Train Loss: 0.357 Vali Loss: 1.285 Vali Acc: 0.614 Test Loss: 1.285 Test Acc: 0.614
Validation loss decreased (-0.563126 --> -0.614322).  Saving model ...
Epoch: 7 cost time: 7.310997247695923
Epoch: 7, Steps: 17 | Train Loss: 0.449 Vali Loss: 2.753 Vali Acc: 0.543 Test Loss: 2.753 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.028805494308472
Epoch: 8, Steps: 17 | Train Loss: 0.421 Vali Loss: 2.850 Vali Acc: 0.577 Test Loss: 2.850 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.3259971141815186
Epoch: 9, Steps: 17 | Train Loss: 0.398 Vali Loss: 2.757 Vali Acc: 0.597 Test Loss: 2.757 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.1205503940582275
Epoch: 10, Steps: 17 | Train Loss: 0.303 Vali Loss: 2.707 Vali Acc: 0.584 Test Loss: 2.707 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.130101919174194
Epoch: 11, Steps: 17 | Train Loss: 0.590 Vali Loss: 3.292 Vali Acc: 0.573 Test Loss: 3.292 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.368871212005615
Epoch: 12, Steps: 17 | Train Loss: 0.539 Vali Loss: 3.308 Vali Acc: 0.604 Test Loss: 3.308 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.500950813293457
Epoch: 13, Steps: 17 | Train Loss: 0.379 Vali Loss: 4.722 Vali Acc: 0.570 Test Loss: 4.722 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.733999252319336
Epoch: 14, Steps: 17 | Train Loss: 0.246 Vali Loss: 5.224 Vali Acc: 0.584 Test Loss: 5.224 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.795718431472778
Epoch: 15, Steps: 17 | Train Loss: 0.402 Vali Loss: 4.526 Vali Acc: 0.590 Test Loss: 4.526 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.51399040222168
Epoch: 16, Steps: 17 | Train Loss: 0.342 Vali Loss: 5.809 Vali Acc: 0.580 Test Loss: 5.809 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6143344709897611
model parameter : 3293954
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.143720626831055
Epoch: 1, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.740 Vali Acc: 0.594 Test Loss: 0.740 Test Acc: 0.594
Validation loss decreased (inf --> -0.593849).  Saving model ...
Epoch: 2 cost time: 8.565203428268433
Epoch: 2, Steps: 17 | Train Loss: 0.478 Vali Loss: 1.150 Vali Acc: 0.611 Test Loss: 1.150 Test Acc: 0.611
Validation loss decreased (-0.593849 --> -0.610910).  Saving model ...
Epoch: 3 cost time: 8.35713529586792
Epoch: 3, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.936 Vali Acc: 0.642 Test Loss: 0.936 Test Acc: 0.642
Validation loss decreased (-0.610910 --> -0.641629).  Saving model ...
Epoch: 4 cost time: 9.16467809677124
Epoch: 4, Steps: 17 | Train Loss: 0.508 Vali Loss: 3.049 Vali Acc: 0.536 Test Loss: 3.049 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.14143443107605
Epoch: 5, Steps: 17 | Train Loss: 0.391 Vali Loss: 1.319 Vali Acc: 0.611 Test Loss: 1.319 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.523137092590332
Epoch: 6, Steps: 17 | Train Loss: 0.343 Vali Loss: 1.386 Vali Acc: 0.679 Test Loss: 1.386 Test Acc: 0.679
Validation loss decreased (-0.641629 --> -0.679167).  Saving model ...
Epoch: 7 cost time: 8.02385663986206
Epoch: 7, Steps: 17 | Train Loss: 0.599 Vali Loss: 2.291 Vali Acc: 0.628 Test Loss: 2.291 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.824286937713623
Epoch: 8, Steps: 17 | Train Loss: 0.559 Vali Loss: 1.946 Vali Acc: 0.635 Test Loss: 1.946 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.937462568283081
Epoch: 9, Steps: 17 | Train Loss: 0.506 Vali Loss: 2.299 Vali Acc: 0.648 Test Loss: 2.299 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.628615379333496
Epoch: 10, Steps: 17 | Train Loss: 0.282 Vali Loss: 3.001 Vali Acc: 0.631 Test Loss: 3.001 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.01530909538269
Epoch: 11, Steps: 17 | Train Loss: 0.282 Vali Loss: 4.228 Vali Acc: 0.621 Test Loss: 4.228 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.748879194259644
Epoch: 12, Steps: 17 | Train Loss: 0.395 Vali Loss: 2.186 Vali Acc: 0.625 Test Loss: 2.186 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.029037237167358
Epoch: 13, Steps: 17 | Train Loss: 0.269 Vali Loss: 5.733 Vali Acc: 0.590 Test Loss: 5.733 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.075182676315308
Epoch: 14, Steps: 17 | Train Loss: 0.202 Vali Loss: 2.713 Vali Acc: 0.631 Test Loss: 2.713 Test Acc: 0.631
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.0216805934906
Epoch: 15, Steps: 17 | Train Loss: 0.246 Vali Loss: 3.799 Vali Acc: 0.611 Test Loss: 3.799 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.831311941146851
Epoch: 16, Steps: 17 | Train Loss: 0.152 Vali Loss: 3.424 Vali Acc: 0.669 Test Loss: 3.424 Test Acc: 0.669
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6791808873720137
model parameter : 2466178
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.454415559768677
Epoch: 1, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.711 Vali Acc: 0.560 Test Loss: 0.711 Test Acc: 0.560
Validation loss decreased (inf --> -0.559720).  Saving model ...
Epoch: 2 cost time: 7.313335180282593
Epoch: 2, Steps: 17 | Train Loss: 0.477 Vali Loss: 1.027 Vali Acc: 0.601 Test Loss: 1.027 Test Acc: 0.601
Validation loss decreased (-0.559720 --> -0.600672).  Saving model ...
Epoch: 3 cost time: 7.66157078742981
Epoch: 3, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.789 Vali Acc: 0.652 Test Loss: 0.789 Test Acc: 0.652
Validation loss decreased (-0.600672 --> -0.651869).  Saving model ...
Epoch: 4 cost time: 6.724521636962891
Epoch: 4, Steps: 17 | Train Loss: 0.304 Vali Loss: 1.788 Vali Acc: 0.590 Test Loss: 1.788 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.974887371063232
Epoch: 5, Steps: 17 | Train Loss: 0.317 Vali Loss: 1.197 Vali Acc: 0.597 Test Loss: 1.197 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.180585622787476
Epoch: 6, Steps: 17 | Train Loss: 0.218 Vali Loss: 1.436 Vali Acc: 0.669 Test Loss: 1.436 Test Acc: 0.669
Validation loss decreased (-0.651869 --> -0.668928).  Saving model ...
Epoch: 7 cost time: 7.0298027992248535
Epoch: 7, Steps: 17 | Train Loss: 0.096 Vali Loss: 2.234 Vali Acc: 0.635 Test Loss: 2.234 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.888089895248413
Epoch: 8, Steps: 17 | Train Loss: 0.191 Vali Loss: 2.774 Vali Acc: 0.597 Test Loss: 2.774 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.236987590789795
Epoch: 9, Steps: 17 | Train Loss: 0.109 Vali Loss: 3.298 Vali Acc: 0.597 Test Loss: 3.298 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.387869596481323
Epoch: 10, Steps: 17 | Train Loss: 0.143 Vali Loss: 2.571 Vali Acc: 0.590 Test Loss: 2.571 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.541676998138428
Epoch: 11, Steps: 17 | Train Loss: 0.155 Vali Loss: 3.407 Vali Acc: 0.611 Test Loss: 3.407 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.810821056365967
Epoch: 12, Steps: 17 | Train Loss: 0.145 Vali Loss: 2.704 Vali Acc: 0.642 Test Loss: 2.704 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.512354612350464
Epoch: 13, Steps: 17 | Train Loss: 0.149 Vali Loss: 2.124 Vali Acc: 0.679 Test Loss: 2.124 Test Acc: 0.679
Validation loss decreased (-0.668928 --> -0.679160).  Saving model ...
Epoch: 14 cost time: 7.014587163925171
Epoch: 14, Steps: 17 | Train Loss: 0.174 Vali Loss: 2.985 Vali Acc: 0.652 Test Loss: 2.985 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.578359603881836
Epoch: 15, Steps: 17 | Train Loss: 0.334 Vali Loss: 4.339 Vali Acc: 0.597 Test Loss: 4.339 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.675405502319336
Epoch: 16, Steps: 17 | Train Loss: 0.158 Vali Loss: 3.706 Vali Acc: 0.618 Test Loss: 3.706 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.096757650375366
Epoch: 17, Steps: 17 | Train Loss: 0.070 Vali Loss: 4.073 Vali Acc: 0.638 Test Loss: 4.073 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.13596510887146
Epoch: 18, Steps: 17 | Train Loss: 0.056 Vali Loss: 3.791 Vali Acc: 0.631 Test Loss: 3.791 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.530195236206055
Epoch: 19, Steps: 17 | Train Loss: 0.133 Vali Loss: 3.941 Vali Acc: 0.597 Test Loss: 3.941 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.796010494232178
Epoch: 20, Steps: 17 | Train Loss: 0.070 Vali Loss: 4.967 Vali Acc: 0.618 Test Loss: 4.967 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.761363506317139
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 6.473 Vali Acc: 0.573 Test Loss: 6.473 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.270634651184082
Epoch: 22, Steps: 17 | Train Loss: 0.119 Vali Loss: 6.037 Vali Acc: 0.621 Test Loss: 6.037 Test Acc: 0.621
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.839893579483032
Epoch: 23, Steps: 17 | Train Loss: 0.440 Vali Loss: 4.554 Vali Acc: 0.604 Test Loss: 4.554 Test Acc: 0.604
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6791808873720137
model parameter : 2466178
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.978624105453491
Epoch: 1, Steps: 17 | Train Loss: 0.711 Vali Loss: 0.748 Vali Acc: 0.526 Test Loss: 0.748 Test Acc: 0.526
Validation loss decreased (inf --> -0.525590).  Saving model ...
Epoch: 2 cost time: 6.412386894226074
Epoch: 2, Steps: 17 | Train Loss: 0.502 Vali Loss: 1.295 Vali Acc: 0.556 Test Loss: 1.295 Test Acc: 0.556
Validation loss decreased (-0.525590 --> -0.556301).  Saving model ...
Epoch: 3 cost time: 6.362134695053101
Epoch: 3, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.961 Vali Acc: 0.580 Test Loss: 0.961 Test Acc: 0.580
Validation loss decreased (-0.556301 --> -0.580195).  Saving model ...
Epoch: 4 cost time: 6.38550066947937
Epoch: 4, Steps: 17 | Train Loss: 0.371 Vali Loss: 1.243 Vali Acc: 0.618 Test Loss: 1.243 Test Acc: 0.618
Validation loss decreased (-0.580195 --> -0.617735).  Saving model ...
Epoch: 5 cost time: 6.950585842132568
Epoch: 5, Steps: 17 | Train Loss: 0.342 Vali Loss: 1.590 Vali Acc: 0.608 Test Loss: 1.590 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.956892251968384
Epoch: 6, Steps: 17 | Train Loss: 0.171 Vali Loss: 2.737 Vali Acc: 0.543 Test Loss: 2.737 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.553757190704346
Epoch: 7, Steps: 17 | Train Loss: 0.296 Vali Loss: 2.203 Vali Acc: 0.625 Test Loss: 2.203 Test Acc: 0.625
Validation loss decreased (-0.617735 --> -0.624551).  Saving model ...
Epoch: 8 cost time: 7.121835947036743
Epoch: 8, Steps: 17 | Train Loss: 0.215 Vali Loss: 2.170 Vali Acc: 0.601 Test Loss: 2.170 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.079488754272461
Epoch: 9, Steps: 17 | Train Loss: 0.240 Vali Loss: 2.453 Vali Acc: 0.631 Test Loss: 2.453 Test Acc: 0.631
Validation loss decreased (-0.624551 --> -0.631375).  Saving model ...
Epoch: 10 cost time: 6.230920314788818
Epoch: 10, Steps: 17 | Train Loss: 0.149 Vali Loss: 2.538 Vali Acc: 0.621 Test Loss: 2.538 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.635763883590698
Epoch: 11, Steps: 17 | Train Loss: 0.110 Vali Loss: 3.389 Vali Acc: 0.597 Test Loss: 3.389 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.762827396392822
Epoch: 12, Steps: 17 | Train Loss: 0.093 Vali Loss: 2.967 Vali Acc: 0.614 Test Loss: 2.967 Test Acc: 0.614
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.8280158042907715
Epoch: 13, Steps: 17 | Train Loss: 0.082 Vali Loss: 4.804 Vali Acc: 0.590 Test Loss: 4.804 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.452937602996826
Epoch: 14, Steps: 17 | Train Loss: 0.102 Vali Loss: 3.717 Vali Acc: 0.590 Test Loss: 3.717 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.822530746459961
Epoch: 15, Steps: 17 | Train Loss: 0.097 Vali Loss: 3.670 Vali Acc: 0.608 Test Loss: 3.670 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.779895782470703
Epoch: 16, Steps: 17 | Train Loss: 0.107 Vali Loss: 6.220 Vali Acc: 0.580 Test Loss: 6.220 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.259342432022095
Epoch: 17, Steps: 17 | Train Loss: 0.114 Vali Loss: 6.140 Vali Acc: 0.563 Test Loss: 6.140 Test Acc: 0.563
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.926087379455566
Epoch: 18, Steps: 17 | Train Loss: 0.230 Vali Loss: 4.612 Vali Acc: 0.614 Test Loss: 4.612 Test Acc: 0.614
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.747241973876953
Epoch: 19, Steps: 17 | Train Loss: 0.074 Vali Loss: 5.021 Vali Acc: 0.597 Test Loss: 5.021 Test Acc: 0.597
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6313993174061433
model parameter : 2466178
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.203911542892456
Epoch: 1, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.761 Vali Acc: 0.519 Test Loss: 0.761 Test Acc: 0.519
Validation loss decreased (inf --> -0.518764).  Saving model ...
Epoch: 2 cost time: 5.598641633987427
Epoch: 2, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.979 Vali Acc: 0.584 Test Loss: 0.979 Test Acc: 0.584
Validation loss decreased (-0.518764 --> -0.583608).  Saving model ...
Epoch: 3 cost time: 6.10971736907959
Epoch: 3, Steps: 17 | Train Loss: 0.435 Vali Loss: 1.040 Vali Acc: 0.570 Test Loss: 1.040 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.57538914680481
Epoch: 4, Steps: 17 | Train Loss: 0.450 Vali Loss: 2.786 Vali Acc: 0.526 Test Loss: 2.786 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.866140127182007
Epoch: 5, Steps: 17 | Train Loss: 0.325 Vali Loss: 1.788 Vali Acc: 0.573 Test Loss: 1.788 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.722715377807617
Epoch: 6, Steps: 17 | Train Loss: 0.225 Vali Loss: 2.128 Vali Acc: 0.549 Test Loss: 2.128 Test Acc: 0.549
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.921072959899902
Epoch: 7, Steps: 17 | Train Loss: 0.223 Vali Loss: 1.536 Vali Acc: 0.638 Test Loss: 1.536 Test Acc: 0.638
Validation loss decreased (-0.583608 --> -0.638210).  Saving model ...
Epoch: 8 cost time: 6.3021721839904785
Epoch: 8, Steps: 17 | Train Loss: 0.368 Vali Loss: 2.329 Vali Acc: 0.577 Test Loss: 2.329 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.331274509429932
Epoch: 9, Steps: 17 | Train Loss: 0.251 Vali Loss: 2.788 Vali Acc: 0.587 Test Loss: 2.788 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.800612926483154
Epoch: 10, Steps: 17 | Train Loss: 0.202 Vali Loss: 3.198 Vali Acc: 0.573 Test Loss: 3.198 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.284881353378296
Epoch: 11, Steps: 17 | Train Loss: 0.098 Vali Loss: 4.317 Vali Acc: 0.546 Test Loss: 4.317 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.197302579879761
Epoch: 12, Steps: 17 | Train Loss: 0.116 Vali Loss: 3.084 Vali Acc: 0.621 Test Loss: 3.084 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.405214786529541
Epoch: 13, Steps: 17 | Train Loss: 0.086 Vali Loss: 2.869 Vali Acc: 0.604 Test Loss: 2.869 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.25947380065918
Epoch: 14, Steps: 17 | Train Loss: 0.486 Vali Loss: 4.606 Vali Acc: 0.597 Test Loss: 4.606 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.407384634017944
Epoch: 15, Steps: 17 | Train Loss: 0.110 Vali Loss: 4.069 Vali Acc: 0.618 Test Loss: 4.069 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.634166717529297
Epoch: 16, Steps: 17 | Train Loss: 0.094 Vali Loss: 5.101 Vali Acc: 0.601 Test Loss: 5.101 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.139194965362549
Epoch: 17, Steps: 17 | Train Loss: 0.177 Vali Loss: 4.716 Vali Acc: 0.601 Test Loss: 4.716 Test Acc: 0.601
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6382252559726962
model parameter : 2466178
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.53857159614563
Epoch: 1, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.736 Vali Acc: 0.519 Test Loss: 0.736 Test Acc: 0.519
Validation loss decreased (inf --> -0.518764).  Saving model ...
Epoch: 2 cost time: 5.837749004364014
Epoch: 2, Steps: 17 | Train Loss: 0.563 Vali Loss: 1.702 Vali Acc: 0.519 Test Loss: 1.702 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.814250469207764
Epoch: 3, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.856 Vali Acc: 0.642 Test Loss: 0.856 Test Acc: 0.642
Validation loss decreased (-0.518764 --> -0.641630).  Saving model ...
Epoch: 4 cost time: 5.839867115020752
Epoch: 4, Steps: 17 | Train Loss: 0.382 Vali Loss: 1.093 Vali Acc: 0.611 Test Loss: 1.093 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.372441053390503
Epoch: 5, Steps: 17 | Train Loss: 0.498 Vali Loss: 3.272 Vali Acc: 0.522 Test Loss: 3.272 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.00181245803833
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 2.077 Vali Acc: 0.594 Test Loss: 2.077 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.1287126541137695
Epoch: 7, Steps: 17 | Train Loss: 0.194 Vali Loss: 1.470 Vali Acc: 0.662 Test Loss: 1.470 Test Acc: 0.662
Validation loss decreased (-0.641630 --> -0.662101).  Saving model ...
Epoch: 8 cost time: 6.4547059535980225
Epoch: 8, Steps: 17 | Train Loss: 0.270 Vali Loss: 3.472 Vali Acc: 0.573 Test Loss: 3.472 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.319214820861816
Epoch: 9, Steps: 17 | Train Loss: 0.169 Vali Loss: 4.574 Vali Acc: 0.553 Test Loss: 4.574 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.986274719238281
Epoch: 10, Steps: 17 | Train Loss: 0.144 Vali Loss: 2.186 Vali Acc: 0.645 Test Loss: 2.186 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.3416454792022705
Epoch: 11, Steps: 17 | Train Loss: 0.235 Vali Loss: 4.071 Vali Acc: 0.604 Test Loss: 4.071 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.824634552001953
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 3.599 Vali Acc: 0.611 Test Loss: 3.599 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.410671949386597
Epoch: 13, Steps: 17 | Train Loss: 0.095 Vali Loss: 3.634 Vali Acc: 0.611 Test Loss: 3.634 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.12456202507019
Epoch: 14, Steps: 17 | Train Loss: 0.206 Vali Loss: 3.842 Vali Acc: 0.604 Test Loss: 3.842 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.8184874057769775
Epoch: 15, Steps: 17 | Train Loss: 0.158 Vali Loss: 4.317 Vali Acc: 0.608 Test Loss: 4.317 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.160472631454468
Epoch: 16, Steps: 17 | Train Loss: 0.119 Vali Loss: 7.988 Vali Acc: 0.539 Test Loss: 7.988 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.430094003677368
Epoch: 17, Steps: 17 | Train Loss: 0.165 Vali Loss: 4.550 Vali Acc: 0.580 Test Loss: 4.550 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6621160409556314
model parameter : 2466178
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.280395746231079
Epoch: 1, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.707 Vali Acc: 0.529 Test Loss: 0.707 Test Acc: 0.529
Validation loss decreased (inf --> -0.529003).  Saving model ...
Epoch: 2 cost time: 5.744068145751953
Epoch: 2, Steps: 17 | Train Loss: 0.614 Vali Loss: 1.981 Vali Acc: 0.505 Test Loss: 1.981 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.142253637313843
Epoch: 3, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.975 Vali Acc: 0.584 Test Loss: 0.975 Test Acc: 0.584
Validation loss decreased (-0.529003 --> -0.583608).  Saving model ...
Epoch: 4 cost time: 5.810160160064697
Epoch: 4, Steps: 17 | Train Loss: 0.359 Vali Loss: 1.124 Vali Acc: 0.577 Test Loss: 1.124 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.631553411483765
Epoch: 5, Steps: 17 | Train Loss: 0.555 Vali Loss: 2.711 Vali Acc: 0.512 Test Loss: 2.711 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.556960821151733
Epoch: 6, Steps: 17 | Train Loss: 0.341 Vali Loss: 2.731 Vali Acc: 0.529 Test Loss: 2.731 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.745469331741333
Epoch: 7, Steps: 17 | Train Loss: 0.269 Vali Loss: 2.124 Vali Acc: 0.546 Test Loss: 2.124 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.313623428344727
Epoch: 8, Steps: 17 | Train Loss: 0.201 Vali Loss: 3.335 Vali Acc: 0.515 Test Loss: 3.335 Test Acc: 0.515
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.760155200958252
Epoch: 9, Steps: 17 | Train Loss: 0.197 Vali Loss: 2.334 Vali Acc: 0.563 Test Loss: 2.334 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.458359241485596
Epoch: 10, Steps: 17 | Train Loss: 0.173 Vali Loss: 2.118 Vali Acc: 0.611 Test Loss: 2.118 Test Acc: 0.611
Validation loss decreased (-0.583608 --> -0.610900).  Saving model ...
Epoch: 11 cost time: 6.6367926597595215
Epoch: 11, Steps: 17 | Train Loss: 0.265 Vali Loss: 2.758 Vali Acc: 0.573 Test Loss: 2.758 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.408506155014038
Epoch: 12, Steps: 17 | Train Loss: 0.215 Vali Loss: 3.547 Vali Acc: 0.584 Test Loss: 3.547 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.869488954544067
Epoch: 13, Steps: 17 | Train Loss: 0.361 Vali Loss: 3.143 Vali Acc: 0.611 Test Loss: 3.143 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.8997907638549805
Epoch: 14, Steps: 17 | Train Loss: 0.216 Vali Loss: 3.269 Vali Acc: 0.601 Test Loss: 3.269 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.886972665786743
Epoch: 15, Steps: 17 | Train Loss: 0.097 Vali Loss: 3.516 Vali Acc: 0.611 Test Loss: 3.516 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.067752361297607
Epoch: 16, Steps: 17 | Train Loss: 0.069 Vali Loss: 4.306 Vali Acc: 0.597 Test Loss: 4.306 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.2473485469818115
Epoch: 17, Steps: 17 | Train Loss: 0.176 Vali Loss: 5.039 Vali Acc: 0.573 Test Loss: 5.039 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.197964906692505
Epoch: 18, Steps: 17 | Train Loss: 0.072 Vali Loss: 4.984 Vali Acc: 0.594 Test Loss: 4.984 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.026239395141602
Epoch: 19, Steps: 17 | Train Loss: 0.035 Vali Loss: 7.077 Vali Acc: 0.546 Test Loss: 7.077 Test Acc: 0.546
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.793001174926758
Epoch: 20, Steps: 17 | Train Loss: 0.316 Vali Loss: 4.782 Vali Acc: 0.553 Test Loss: 4.782 Test Acc: 0.553
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6109215017064846
model parameter : 2466178
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.669849157333374
Epoch: 1, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.742 Vali Acc: 0.515 Test Loss: 0.742 Test Acc: 0.515
Validation loss decreased (inf --> -0.515351).  Saving model ...
Epoch: 2 cost time: 5.117687225341797
Epoch: 2, Steps: 17 | Train Loss: 0.585 Vali Loss: 2.052 Vali Acc: 0.509 Test Loss: 2.052 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.11746883392334
Epoch: 3, Steps: 17 | Train Loss: 0.444 Vali Loss: 1.002 Vali Acc: 0.584 Test Loss: 1.002 Test Acc: 0.584
Validation loss decreased (-0.515351 --> -0.583608).  Saving model ...
Epoch: 4 cost time: 5.608194589614868
Epoch: 4, Steps: 17 | Train Loss: 0.501 Vali Loss: 2.571 Vali Acc: 0.512 Test Loss: 2.571 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.033341884613037
Epoch: 5, Steps: 17 | Train Loss: 0.491 Vali Loss: 1.871 Vali Acc: 0.553 Test Loss: 1.871 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.135279178619385
Epoch: 6, Steps: 17 | Train Loss: 0.361 Vali Loss: 1.566 Vali Acc: 0.539 Test Loss: 1.566 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.19828987121582
Epoch: 7, Steps: 17 | Train Loss: 0.288 Vali Loss: 2.013 Vali Acc: 0.556 Test Loss: 2.013 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.263166904449463
Epoch: 8, Steps: 17 | Train Loss: 0.212 Vali Loss: 2.739 Vali Acc: 0.532 Test Loss: 2.739 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.919616222381592
Epoch: 9, Steps: 17 | Train Loss: 0.290 Vali Loss: 1.970 Vali Acc: 0.553 Test Loss: 1.970 Test Acc: 0.553
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.35428786277771
Epoch: 10, Steps: 17 | Train Loss: 0.344 Vali Loss: 2.491 Vali Acc: 0.536 Test Loss: 2.491 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.1506288051605225
Epoch: 11, Steps: 17 | Train Loss: 0.439 Vali Loss: 5.361 Vali Acc: 0.532 Test Loss: 5.361 Test Acc: 0.532
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.252221345901489
Epoch: 12, Steps: 17 | Train Loss: 0.332 Vali Loss: 3.599 Vali Acc: 0.532 Test Loss: 3.599 Test Acc: 0.532
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.787035942077637
Epoch: 13, Steps: 17 | Train Loss: 0.260 Vali Loss: 3.854 Vali Acc: 0.556 Test Loss: 3.854 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5836177474402731
model parameter : 2466178
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.268529891967773
Epoch: 1, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.790 Vali Acc: 0.509 Test Loss: 0.790 Test Acc: 0.509
Validation loss decreased (inf --> -0.508525).  Saving model ...
Epoch: 2 cost time: 5.7483320236206055
Epoch: 2, Steps: 17 | Train Loss: 0.598 Vali Loss: 1.654 Vali Acc: 0.502 Test Loss: 1.654 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.2498743534088135
Epoch: 3, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.955 Vali Acc: 0.529 Test Loss: 0.955 Test Acc: 0.529
Validation loss decreased (-0.508525 --> -0.529001).  Saving model ...
Epoch: 4 cost time: 5.681508779525757
Epoch: 4, Steps: 17 | Train Loss: 0.418 Vali Loss: 2.091 Vali Acc: 0.529 Test Loss: 2.091 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.018508195877075
Epoch: 5, Steps: 17 | Train Loss: 0.457 Vali Loss: 1.753 Vali Acc: 0.532 Test Loss: 1.753 Test Acc: 0.532
Validation loss decreased (-0.529001 --> -0.532406).  Saving model ...
Epoch: 6 cost time: 6.119765520095825
Epoch: 6, Steps: 17 | Train Loss: 0.309 Vali Loss: 1.542 Vali Acc: 0.536 Test Loss: 1.542 Test Acc: 0.536
Validation loss decreased (-0.532406 --> -0.535821).  Saving model ...
Epoch: 7 cost time: 6.274981737136841
Epoch: 7, Steps: 17 | Train Loss: 0.387 Vali Loss: 2.363 Vali Acc: 0.505 Test Loss: 2.363 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.039456367492676
Epoch: 8, Steps: 17 | Train Loss: 0.274 Vali Loss: 2.333 Vali Acc: 0.522 Test Loss: 2.333 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.695201873779297
Epoch: 9, Steps: 17 | Train Loss: 0.223 Vali Loss: 2.220 Vali Acc: 0.526 Test Loss: 2.220 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.8841023445129395
Epoch: 10, Steps: 17 | Train Loss: 0.275 Vali Loss: 2.438 Vali Acc: 0.543 Test Loss: 2.438 Test Acc: 0.543
Validation loss decreased (-0.535821 --> -0.542638).  Saving model ...
Epoch: 11 cost time: 5.30215311050415
Epoch: 11, Steps: 17 | Train Loss: 0.133 Vali Loss: 2.899 Vali Acc: 0.522 Test Loss: 2.899 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.83299994468689
Epoch: 12, Steps: 17 | Train Loss: 0.205 Vali Loss: 3.632 Vali Acc: 0.519 Test Loss: 3.632 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.994693756103516
Epoch: 13, Steps: 17 | Train Loss: 0.148 Vali Loss: 3.269 Vali Acc: 0.543 Test Loss: 3.269 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.905409812927246
Epoch: 14, Steps: 17 | Train Loss: 0.231 Vali Loss: 4.303 Vali Acc: 0.532 Test Loss: 4.303 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.975816965103149
Epoch: 15, Steps: 17 | Train Loss: 0.122 Vali Loss: 5.550 Vali Acc: 0.536 Test Loss: 5.550 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.3083655834198
Epoch: 16, Steps: 17 | Train Loss: 0.553 Vali Loss: 4.906 Vali Acc: 0.567 Test Loss: 4.906 Test Acc: 0.567
Validation loss decreased (-0.542638 --> -0.566504).  Saving model ...
Epoch: 17 cost time: 6.075595378875732
Epoch: 17, Steps: 17 | Train Loss: 0.435 Vali Loss: 5.183 Vali Acc: 0.543 Test Loss: 5.183 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.020463943481445
Epoch: 18, Steps: 17 | Train Loss: 0.182 Vali Loss: 5.510 Vali Acc: 0.539 Test Loss: 5.510 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.2274391651153564
Epoch: 19, Steps: 17 | Train Loss: 0.113 Vali Loss: 8.090 Vali Acc: 0.512 Test Loss: 8.090 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.4946019649505615
Epoch: 20, Steps: 17 | Train Loss: 0.270 Vali Loss: 5.589 Vali Acc: 0.546 Test Loss: 5.589 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.2457685470581055
Epoch: 21, Steps: 17 | Train Loss: 0.436 Vali Loss: 7.325 Vali Acc: 0.532 Test Loss: 7.325 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.47245717048645
Epoch: 22, Steps: 17 | Train Loss: 0.146 Vali Loss: 8.832 Vali Acc: 0.529 Test Loss: 8.832 Test Acc: 0.529
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.901131629943848
Epoch: 23, Steps: 17 | Train Loss: 0.197 Vali Loss: 5.924 Vali Acc: 0.543 Test Loss: 5.924 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.340912103652954
Epoch: 24, Steps: 17 | Train Loss: 0.198 Vali Loss: 11.297 Vali Acc: 0.509 Test Loss: 11.297 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.404162168502808
Epoch: 25, Steps: 17 | Train Loss: 0.159 Vali Loss: 6.841 Vali Acc: 0.546 Test Loss: 6.841 Test Acc: 0.546
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.829304933547974
Epoch: 26, Steps: 17 | Train Loss: 0.137 Vali Loss: 6.605 Vali Acc: 0.532 Test Loss: 6.605 Test Acc: 0.532
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5665529010238908
model parameter : 2466178
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.647526264190674
Epoch: 1, Steps: 17 | Train Loss: 0.700 Vali Loss: 1.123 Vali Acc: 0.502 Test Loss: 1.123 Test Acc: 0.502
Validation loss decreased (inf --> -0.501695).  Saving model ...
Epoch: 2 cost time: 6.138637542724609
Epoch: 2, Steps: 17 | Train Loss: 0.611 Vali Loss: 1.536 Vali Acc: 0.502 Test Loss: 1.536 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.483729124069214
Epoch: 3, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.671 Vali Acc: 0.563 Test Loss: 0.671 Test Acc: 0.563
Validation loss decreased (-0.501695 --> -0.563133).  Saving model ...
Epoch: 4 cost time: 5.845850229263306
Epoch: 4, Steps: 17 | Train Loss: 0.560 Vali Loss: 2.077 Vali Acc: 0.502 Test Loss: 2.077 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.5978686809539795
Epoch: 5, Steps: 17 | Train Loss: 0.518 Vali Loss: 1.465 Vali Acc: 0.502 Test Loss: 1.465 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.916653871536255
Epoch: 6, Steps: 17 | Train Loss: 0.447 Vali Loss: 2.091 Vali Acc: 0.502 Test Loss: 2.091 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.334090709686279
Epoch: 7, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.714 Vali Acc: 0.587 Test Loss: 0.714 Test Acc: 0.587
Validation loss decreased (-0.563133 --> -0.587024).  Saving model ...
Epoch: 8 cost time: 5.768444299697876
Epoch: 8, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.779 Vali Acc: 0.584 Test Loss: 0.779 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.259453296661377
Epoch: 9, Steps: 17 | Train Loss: 0.347 Vali Loss: 1.026 Vali Acc: 0.563 Test Loss: 1.026 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.958597183227539
Epoch: 10, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.985 Vali Acc: 0.577 Test Loss: 0.985 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.810765743255615
Epoch: 11, Steps: 17 | Train Loss: 0.617 Vali Loss: 1.579 Vali Acc: 0.570 Test Loss: 1.579 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.53131628036499
Epoch: 12, Steps: 17 | Train Loss: 0.412 Vali Loss: 1.243 Vali Acc: 0.563 Test Loss: 1.243 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.7802393436431885
Epoch: 13, Steps: 17 | Train Loss: 0.263 Vali Loss: 1.341 Vali Acc: 0.543 Test Loss: 1.341 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.93121862411499
Epoch: 14, Steps: 17 | Train Loss: 0.276 Vali Loss: 1.369 Vali Acc: 0.567 Test Loss: 1.369 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.934493780136108
Epoch: 15, Steps: 17 | Train Loss: 0.249 Vali Loss: 1.460 Vali Acc: 0.573 Test Loss: 1.460 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.661732912063599
Epoch: 16, Steps: 17 | Train Loss: 0.255 Vali Loss: 1.752 Vali Acc: 0.567 Test Loss: 1.752 Test Acc: 0.567
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.580369234085083
Epoch: 17, Steps: 17 | Train Loss: 0.277 Vali Loss: 1.925 Vali Acc: 0.563 Test Loss: 1.925 Test Acc: 0.563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5870307167235495
model parameter : 2466178
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.608932018280029
Epoch: 1, Steps: 17 | Train Loss: 0.687 Vali Loss: 1.154 Vali Acc: 0.502 Test Loss: 1.154 Test Acc: 0.502
Validation loss decreased (inf --> -0.501695).  Saving model ...
Epoch: 2 cost time: 5.990569114685059
Epoch: 2, Steps: 17 | Train Loss: 0.599 Vali Loss: 2.083 Vali Acc: 0.502 Test Loss: 2.083 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.617785453796387
Epoch: 3, Steps: 17 | Train Loss: 0.597 Vali Loss: 1.036 Vali Acc: 0.498 Test Loss: 1.036 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.279569625854492
Epoch: 4, Steps: 17 | Train Loss: 0.594 Vali Loss: 2.423 Vali Acc: 0.502 Test Loss: 2.423 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.059430360794067
Epoch: 5, Steps: 17 | Train Loss: 0.502 Vali Loss: 1.913 Vali Acc: 0.502 Test Loss: 1.913 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.877003192901611
Epoch: 6, Steps: 17 | Train Loss: 0.468 Vali Loss: 2.871 Vali Acc: 0.502 Test Loss: 2.871 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.643400192260742
Epoch: 7, Steps: 17 | Train Loss: 0.490 Vali Loss: 1.378 Vali Acc: 0.577 Test Loss: 1.378 Test Acc: 0.577
Validation loss decreased (-0.501695 --> -0.576778).  Saving model ...
Epoch: 8 cost time: 5.487905025482178
Epoch: 8, Steps: 17 | Train Loss: 0.429 Vali Loss: 2.574 Vali Acc: 0.553 Test Loss: 2.574 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.55380916595459
Epoch: 9, Steps: 17 | Train Loss: 0.402 Vali Loss: 2.752 Vali Acc: 0.587 Test Loss: 2.752 Test Acc: 0.587
Validation loss decreased (-0.576778 --> -0.587003).  Saving model ...
Epoch: 10 cost time: 5.998454570770264
Epoch: 10, Steps: 17 | Train Loss: 0.539 Vali Loss: 1.896 Vali Acc: 0.584 Test Loss: 1.896 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.84650993347168
Epoch: 11, Steps: 17 | Train Loss: 0.649 Vali Loss: 3.416 Vali Acc: 0.543 Test Loss: 3.416 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.6389336585998535
Epoch: 12, Steps: 17 | Train Loss: 0.429 Vali Loss: 1.914 Vali Acc: 0.577 Test Loss: 1.914 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.612139463424683
Epoch: 13, Steps: 17 | Train Loss: 0.436 Vali Loss: 2.311 Vali Acc: 0.587 Test Loss: 2.311 Test Acc: 0.587
Validation loss decreased (-0.587003 --> -0.587008).  Saving model ...
Epoch: 14 cost time: 6.672362565994263
Epoch: 14, Steps: 17 | Train Loss: 0.456 Vali Loss: 2.654 Vali Acc: 0.594 Test Loss: 2.654 Test Acc: 0.594
Validation loss decreased (-0.587008 --> -0.593830).  Saving model ...
Epoch: 15 cost time: 6.352020263671875
Epoch: 15, Steps: 17 | Train Loss: 0.460 Vali Loss: 3.247 Vali Acc: 0.587 Test Loss: 3.247 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.9058167934417725
Epoch: 16, Steps: 17 | Train Loss: 0.647 Vali Loss: 3.905 Vali Acc: 0.553 Test Loss: 3.905 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.6434619426727295
Epoch: 17, Steps: 17 | Train Loss: 0.477 Vali Loss: 3.735 Vali Acc: 0.556 Test Loss: 3.735 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.828559875488281
Epoch: 18, Steps: 17 | Train Loss: 0.375 Vali Loss: 3.778 Vali Acc: 0.577 Test Loss: 3.778 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.11353063583374
Epoch: 19, Steps: 17 | Train Loss: 0.378 Vali Loss: 4.816 Vali Acc: 0.563 Test Loss: 4.816 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.2461371421813965
Epoch: 20, Steps: 17 | Train Loss: 0.523 Vali Loss: 4.810 Vali Acc: 0.549 Test Loss: 4.810 Test Acc: 0.549
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.7558770179748535
Epoch: 21, Steps: 17 | Train Loss: 0.604 Vali Loss: 4.545 Vali Acc: 0.580 Test Loss: 4.545 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.720674514770508
Epoch: 22, Steps: 17 | Train Loss: 0.541 Vali Loss: 3.528 Vali Acc: 0.563 Test Loss: 3.528 Test Acc: 0.563
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.079148530960083
Epoch: 23, Steps: 17 | Train Loss: 0.553 Vali Loss: 4.302 Vali Acc: 0.560 Test Loss: 4.302 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.207050561904907
Epoch: 24, Steps: 17 | Train Loss: 0.609 Vali Loss: 4.467 Vali Acc: 0.584 Test Loss: 4.467 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5938566552901023
model parameter : 2466178
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 8.543061017990112
Epoch: 1, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.735 Vali Acc: 0.597 Test Loss: 0.735 Test Acc: 0.597
Validation loss decreased (inf --> -0.597262).  Saving model ...
Epoch: 2 cost time: 6.842346906661987
Epoch: 2, Steps: 17 | Train Loss: 0.575 Vali Loss: 1.537 Vali Acc: 0.543 Test Loss: 1.537 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.757604360580444
Epoch: 3, Steps: 17 | Train Loss: 0.354 Vali Loss: 2.034 Vali Acc: 0.539 Test Loss: 2.034 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.469416379928589
Epoch: 4, Steps: 17 | Train Loss: 0.435 Vali Loss: 1.108 Vali Acc: 0.655 Test Loss: 1.108 Test Acc: 0.655
Validation loss decreased (-0.597262 --> -0.655279).  Saving model ...
Epoch: 5 cost time: 6.5352747440338135
Epoch: 5, Steps: 17 | Train Loss: 0.280 Vali Loss: 1.236 Vali Acc: 0.659 Test Loss: 1.236 Test Acc: 0.659
Validation loss decreased (-0.655279 --> -0.658691).  Saving model ...
Epoch: 6 cost time: 6.796247243881226
Epoch: 6, Steps: 17 | Train Loss: 0.292 Vali Loss: 1.647 Vali Acc: 0.635 Test Loss: 1.647 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.096495628356934
Epoch: 7, Steps: 17 | Train Loss: 0.141 Vali Loss: 1.611 Vali Acc: 0.594 Test Loss: 1.611 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.16250205039978
Epoch: 8, Steps: 17 | Train Loss: 0.144 Vali Loss: 2.390 Vali Acc: 0.625 Test Loss: 2.390 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.448886156082153
Epoch: 9, Steps: 17 | Train Loss: 0.182 Vali Loss: 2.460 Vali Acc: 0.580 Test Loss: 2.460 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.060786724090576
Epoch: 10, Steps: 17 | Train Loss: 0.278 Vali Loss: 2.791 Vali Acc: 0.659 Test Loss: 2.791 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.022481918334961
Epoch: 11, Steps: 17 | Train Loss: 0.099 Vali Loss: 2.469 Vali Acc: 0.604 Test Loss: 2.469 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.096887826919556
Epoch: 12, Steps: 17 | Train Loss: 0.177 Vali Loss: 4.759 Vali Acc: 0.590 Test Loss: 4.759 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.430229187011719
Epoch: 13, Steps: 17 | Train Loss: 0.097 Vali Loss: 2.496 Vali Acc: 0.659 Test Loss: 2.496 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.868993282318115
Epoch: 14, Steps: 17 | Train Loss: 0.234 Vali Loss: 6.992 Vali Acc: 0.560 Test Loss: 6.992 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.628153324127197
Epoch: 15, Steps: 17 | Train Loss: 0.084 Vali Loss: 3.541 Vali Acc: 0.655 Test Loss: 3.541 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.658703071672355
model parameter : 1679746
model size : 11.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.062086582183838
Epoch: 1, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.763 Vali Acc: 0.549 Test Loss: 0.763 Test Acc: 0.549
Validation loss decreased (inf --> -0.549480).  Saving model ...
Epoch: 2 cost time: 6.288651943206787
Epoch: 2, Steps: 17 | Train Loss: 0.604 Vali Loss: 1.703 Vali Acc: 0.543 Test Loss: 1.703 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.5844056606292725
Epoch: 3, Steps: 17 | Train Loss: 0.407 Vali Loss: 2.102 Vali Acc: 0.532 Test Loss: 2.102 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.6404430866241455
Epoch: 4, Steps: 17 | Train Loss: 0.422 Vali Loss: 1.269 Vali Acc: 0.635 Test Loss: 1.269 Test Acc: 0.635
Validation loss decreased (-0.549480 --> -0.634800).  Saving model ...
Epoch: 5 cost time: 6.5797388553619385
Epoch: 5, Steps: 17 | Train Loss: 0.273 Vali Loss: 1.474 Vali Acc: 0.621 Test Loss: 1.474 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.8103907108306885
Epoch: 6, Steps: 17 | Train Loss: 0.219 Vali Loss: 2.431 Vali Acc: 0.597 Test Loss: 2.431 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.762441396713257
Epoch: 7, Steps: 17 | Train Loss: 0.155 Vali Loss: 1.690 Vali Acc: 0.584 Test Loss: 1.690 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.456509828567505
Epoch: 8, Steps: 17 | Train Loss: 0.112 Vali Loss: 2.897 Vali Acc: 0.573 Test Loss: 2.897 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.191292762756348
Epoch: 9, Steps: 17 | Train Loss: 0.286 Vali Loss: 4.737 Vali Acc: 0.539 Test Loss: 4.737 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.780833721160889
Epoch: 10, Steps: 17 | Train Loss: 0.418 Vali Loss: 2.467 Vali Acc: 0.611 Test Loss: 2.467 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.106201171875
Epoch: 11, Steps: 17 | Train Loss: 0.084 Vali Loss: 2.353 Vali Acc: 0.631 Test Loss: 2.353 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.191810131072998
Epoch: 12, Steps: 17 | Train Loss: 0.191 Vali Loss: 2.612 Vali Acc: 0.573 Test Loss: 2.612 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.565605878829956
Epoch: 13, Steps: 17 | Train Loss: 0.143 Vali Loss: 2.894 Vali Acc: 0.590 Test Loss: 2.894 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.589557647705078
Epoch: 14, Steps: 17 | Train Loss: 0.079 Vali Loss: 5.489 Vali Acc: 0.611 Test Loss: 5.489 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6348122866894198
model parameter : 1679746
model size : 11.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 8.41159176826477
Epoch: 1, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.754 Vali Acc: 0.526 Test Loss: 0.754 Test Acc: 0.526
Validation loss decreased (inf --> -0.525590).  Saving model ...
Epoch: 2 cost time: 7.037574052810669
Epoch: 2, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.989 Vali Acc: 0.584 Test Loss: 0.989 Test Acc: 0.584
Validation loss decreased (-0.525590 --> -0.583608).  Saving model ...
Epoch: 3 cost time: 6.595657587051392
Epoch: 3, Steps: 17 | Train Loss: 0.316 Vali Loss: 1.326 Vali Acc: 0.594 Test Loss: 1.326 Test Acc: 0.594
Validation loss decreased (-0.583608 --> -0.593843).  Saving model ...
Epoch: 4 cost time: 6.824820280075073
Epoch: 4, Steps: 17 | Train Loss: 0.266 Vali Loss: 1.561 Vali Acc: 0.590 Test Loss: 1.561 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.390350341796875
Epoch: 5, Steps: 17 | Train Loss: 0.269 Vali Loss: 1.585 Vali Acc: 0.621 Test Loss: 1.585 Test Acc: 0.621
Validation loss decreased (-0.593843 --> -0.621145).  Saving model ...
Epoch: 6 cost time: 6.242435455322266
Epoch: 6, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.564 Vali Acc: 0.625 Test Loss: 1.564 Test Acc: 0.625
Validation loss decreased (-0.621145 --> -0.624558).  Saving model ...
Epoch: 7 cost time: 6.62335991859436
Epoch: 7, Steps: 17 | Train Loss: 0.223 Vali Loss: 1.343 Vali Acc: 0.638 Test Loss: 1.343 Test Acc: 0.638
Validation loss decreased (-0.624558 --> -0.638212).  Saving model ...
Epoch: 8 cost time: 6.590351819992065
Epoch: 8, Steps: 17 | Train Loss: 0.390 Vali Loss: 2.687 Vali Acc: 0.573 Test Loss: 2.687 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.796598672866821
Epoch: 9, Steps: 17 | Train Loss: 0.661 Vali Loss: 1.787 Vali Acc: 0.614 Test Loss: 1.787 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.707574129104614
Epoch: 10, Steps: 17 | Train Loss: 0.400 Vali Loss: 3.333 Vali Acc: 0.594 Test Loss: 3.333 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.033958673477173
Epoch: 11, Steps: 17 | Train Loss: 0.110 Vali Loss: 3.620 Vali Acc: 0.614 Test Loss: 3.620 Test Acc: 0.614
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.933420658111572
Epoch: 12, Steps: 17 | Train Loss: 0.065 Vali Loss: 3.270 Vali Acc: 0.608 Test Loss: 3.270 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.944719314575195
Epoch: 13, Steps: 17 | Train Loss: 0.098 Vali Loss: 3.812 Vali Acc: 0.584 Test Loss: 3.812 Test Acc: 0.584
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.8525168895721436
Epoch: 14, Steps: 17 | Train Loss: 0.210 Vali Loss: 6.540 Vali Acc: 0.573 Test Loss: 6.540 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.6475279331207275
Epoch: 15, Steps: 17 | Train Loss: 0.188 Vali Loss: 3.802 Vali Acc: 0.614 Test Loss: 3.802 Test Acc: 0.614
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.580244302749634
Epoch: 16, Steps: 17 | Train Loss: 0.068 Vali Loss: 4.095 Vali Acc: 0.618 Test Loss: 4.095 Test Acc: 0.618
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.706355094909668
Epoch: 17, Steps: 17 | Train Loss: 0.116 Vali Loss: 7.639 Vali Acc: 0.556 Test Loss: 7.639 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6382252559726962
model parameter : 1679746
model size : 11.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.95395565032959
Epoch: 1, Steps: 17 | Train Loss: 0.751 Vali Loss: 0.797 Vali Acc: 0.546 Test Loss: 0.797 Test Acc: 0.546
Validation loss decreased (inf --> -0.546067).  Saving model ...
Epoch: 2 cost time: 6.577524423599243
Epoch: 2, Steps: 17 | Train Loss: 0.554 Vali Loss: 1.463 Vali Acc: 0.526 Test Loss: 1.463 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.608184814453125
Epoch: 3, Steps: 17 | Train Loss: 0.459 Vali Loss: 2.166 Vali Acc: 0.536 Test Loss: 2.166 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.679702520370483
Epoch: 4, Steps: 17 | Train Loss: 0.371 Vali Loss: 1.656 Vali Acc: 0.587 Test Loss: 1.656 Test Acc: 0.587
Validation loss decreased (-0.546067 --> -0.587014).  Saving model ...
Epoch: 5 cost time: 6.543274641036987
Epoch: 5, Steps: 17 | Train Loss: 0.220 Vali Loss: 1.949 Vali Acc: 0.573 Test Loss: 1.949 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.264885187149048
Epoch: 6, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.864 Vali Acc: 0.608 Test Loss: 1.864 Test Acc: 0.608
Validation loss decreased (-0.587014 --> -0.607490).  Saving model ...
Epoch: 7 cost time: 6.15830397605896
Epoch: 7, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.866 Vali Acc: 0.608 Test Loss: 1.866 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.810824871063232
Epoch: 8, Steps: 17 | Train Loss: 0.113 Vali Loss: 3.100 Vali Acc: 0.567 Test Loss: 3.100 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.575631380081177
Epoch: 9, Steps: 17 | Train Loss: 0.116 Vali Loss: 4.159 Vali Acc: 0.563 Test Loss: 4.159 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.425180673599243
Epoch: 10, Steps: 17 | Train Loss: 0.114 Vali Loss: 4.772 Vali Acc: 0.563 Test Loss: 4.772 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.0737011432647705
Epoch: 11, Steps: 17 | Train Loss: 0.079 Vali Loss: 4.132 Vali Acc: 0.563 Test Loss: 4.132 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.248031854629517
Epoch: 12, Steps: 17 | Train Loss: 0.103 Vali Loss: 4.749 Vali Acc: 0.577 Test Loss: 4.749 Test Acc: 0.577
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.543290853500366
Epoch: 13, Steps: 17 | Train Loss: 0.096 Vali Loss: 3.083 Vali Acc: 0.601 Test Loss: 3.083 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.721238613128662
Epoch: 14, Steps: 17 | Train Loss: 0.271 Vali Loss: 8.991 Vali Acc: 0.519 Test Loss: 8.991 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.105014085769653
Epoch: 15, Steps: 17 | Train Loss: 0.398 Vali Loss: 4.268 Vali Acc: 0.587 Test Loss: 4.268 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.334877252578735
Epoch: 16, Steps: 17 | Train Loss: 0.058 Vali Loss: 4.315 Vali Acc: 0.608 Test Loss: 4.315 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6075085324232082
model parameter : 1679746
model size : 11.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.960349082946777
Epoch: 1, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.722 Vali Acc: 0.509 Test Loss: 0.722 Test Acc: 0.509
Validation loss decreased (inf --> -0.508525).  Saving model ...
Epoch: 2 cost time: 5.507831811904907
Epoch: 2, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.977 Vali Acc: 0.625 Test Loss: 0.977 Test Acc: 0.625
Validation loss decreased (-0.508525 --> -0.624564).  Saving model ...
Epoch: 3 cost time: 6.169612169265747
Epoch: 3, Steps: 17 | Train Loss: 0.380 Vali Loss: 1.625 Vali Acc: 0.573 Test Loss: 1.625 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.143866539001465
Epoch: 4, Steps: 17 | Train Loss: 0.398 Vali Loss: 2.475 Vali Acc: 0.536 Test Loss: 2.475 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.679253101348877
Epoch: 5, Steps: 17 | Train Loss: 0.257 Vali Loss: 1.674 Vali Acc: 0.608 Test Loss: 1.674 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.426670789718628
Epoch: 6, Steps: 17 | Train Loss: 0.391 Vali Loss: 2.496 Vali Acc: 0.563 Test Loss: 2.496 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.2811198234558105
Epoch: 7, Steps: 17 | Train Loss: 0.202 Vali Loss: 1.753 Vali Acc: 0.628 Test Loss: 1.753 Test Acc: 0.628
Validation loss decreased (-0.624564 --> -0.627969).  Saving model ...
Epoch: 8 cost time: 5.999263286590576
Epoch: 8, Steps: 17 | Train Loss: 0.149 Vali Loss: 2.541 Vali Acc: 0.601 Test Loss: 2.541 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.090573310852051
Epoch: 9, Steps: 17 | Train Loss: 0.209 Vali Loss: 4.524 Vali Acc: 0.532 Test Loss: 4.524 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.882068634033203
Epoch: 10, Steps: 17 | Train Loss: 0.257 Vali Loss: 2.174 Vali Acc: 0.635 Test Loss: 2.174 Test Acc: 0.635
Validation loss decreased (-0.627969 --> -0.634791).  Saving model ...
Epoch: 11 cost time: 5.852569818496704
Epoch: 11, Steps: 17 | Train Loss: 0.167 Vali Loss: 2.690 Vali Acc: 0.621 Test Loss: 2.690 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.127512454986572
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 4.772 Vali Acc: 0.560 Test Loss: 4.772 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.9070143699646
Epoch: 13, Steps: 17 | Train Loss: 0.114 Vali Loss: 4.015 Vali Acc: 0.573 Test Loss: 4.015 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.855939149856567
Epoch: 14, Steps: 17 | Train Loss: 0.090 Vali Loss: 4.517 Vali Acc: 0.601 Test Loss: 4.517 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.217108726501465
Epoch: 15, Steps: 17 | Train Loss: 0.223 Vali Loss: 3.573 Vali Acc: 0.618 Test Loss: 3.573 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.063997745513916
Epoch: 16, Steps: 17 | Train Loss: 0.235 Vali Loss: 3.755 Vali Acc: 0.625 Test Loss: 3.755 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.694731950759888
Epoch: 17, Steps: 17 | Train Loss: 0.201 Vali Loss: 6.201 Vali Acc: 0.570 Test Loss: 6.201 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.37548303604126
Epoch: 18, Steps: 17 | Train Loss: 0.231 Vali Loss: 4.422 Vali Acc: 0.621 Test Loss: 4.422 Test Acc: 0.621
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.130200386047363
Epoch: 19, Steps: 17 | Train Loss: 0.051 Vali Loss: 4.419 Vali Acc: 0.638 Test Loss: 4.419 Test Acc: 0.638
Validation loss decreased (-0.634791 --> -0.638181).  Saving model ...
Epoch: 20 cost time: 5.799742937088013
Epoch: 20, Steps: 17 | Train Loss: 0.028 Vali Loss: 4.298 Vali Acc: 0.638 Test Loss: 4.298 Test Acc: 0.638
Validation loss decreased (-0.638181 --> -0.638182).  Saving model ...
Epoch: 21 cost time: 6.259430646896362
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 5.960 Vali Acc: 0.590 Test Loss: 5.960 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.966614246368408
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 6.117 Vali Acc: 0.601 Test Loss: 6.117 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.881042718887329
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 4.709 Vali Acc: 0.628 Test Loss: 4.709 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.964593410491943
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 4.973 Vali Acc: 0.618 Test Loss: 4.973 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.220025300979614
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 6.583 Vali Acc: 0.611 Test Loss: 6.583 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.673875570297241
Epoch: 26, Steps: 17 | Train Loss: 0.035 Vali Loss: 8.506 Vali Acc: 0.601 Test Loss: 8.506 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.480578660964966
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 7.591 Vali Acc: 0.597 Test Loss: 7.591 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.918768644332886
Epoch: 28, Steps: 17 | Train Loss: 0.054 Vali Loss: 6.987 Vali Acc: 0.618 Test Loss: 6.987 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.51869797706604
Epoch: 29, Steps: 17 | Train Loss: 0.037 Vali Loss: 7.687 Vali Acc: 0.604 Test Loss: 7.687 Test Acc: 0.604
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.487934589385986
Epoch: 30, Steps: 17 | Train Loss: 0.112 Vali Loss: 5.245 Vali Acc: 0.642 Test Loss: 5.245 Test Acc: 0.642
Validation loss decreased (-0.638182 --> -0.641586).  Saving model ...
Epoch: 31 cost time: 6.133171081542969
Epoch: 31, Steps: 17 | Train Loss: 0.191 Vali Loss: 8.825 Vali Acc: 0.611 Test Loss: 8.825 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.595523357391357
Epoch: 32, Steps: 17 | Train Loss: 0.077 Vali Loss: 9.655 Vali Acc: 0.614 Test Loss: 9.655 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.815066814422607
Epoch: 33, Steps: 17 | Train Loss: 0.045 Vali Loss: 8.015 Vali Acc: 0.604 Test Loss: 8.015 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.576687574386597
Epoch: 34, Steps: 17 | Train Loss: 0.109 Vali Loss: 8.576 Vali Acc: 0.597 Test Loss: 8.576 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 6.504245281219482
Epoch: 35, Steps: 17 | Train Loss: 0.206 Vali Loss: 5.772 Vali Acc: 0.642 Test Loss: 5.772 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 5.936732530593872
Epoch: 36, Steps: 17 | Train Loss: 0.416 Vali Loss: 9.699 Vali Acc: 0.577 Test Loss: 9.699 Test Acc: 0.577
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 5.959840297698975
Epoch: 37, Steps: 17 | Train Loss: 0.363 Vali Loss: 8.619 Vali Acc: 0.597 Test Loss: 8.619 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 6.361018657684326
Epoch: 38, Steps: 17 | Train Loss: 0.112 Vali Loss: 10.500 Vali Acc: 0.580 Test Loss: 10.500 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 5.852508544921875
Epoch: 39, Steps: 17 | Train Loss: 0.254 Vali Loss: 10.814 Vali Acc: 0.597 Test Loss: 10.814 Test Acc: 0.597
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 5.875795364379883
Epoch: 40, Steps: 17 | Train Loss: 0.098 Vali Loss: 8.286 Vali Acc: 0.638 Test Loss: 8.286 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 1679746
model size : 11.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.857701539993286
Epoch: 1, Steps: 17 | Train Loss: 0.725 Vali Loss: 0.733 Vali Acc: 0.539 Test Loss: 0.733 Test Acc: 0.539
Validation loss decreased (inf --> -0.539242).  Saving model ...
Epoch: 2 cost time: 5.931286334991455
Epoch: 2, Steps: 17 | Train Loss: 0.599 Vali Loss: 1.631 Vali Acc: 0.502 Test Loss: 1.631 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.181901216506958
Epoch: 3, Steps: 17 | Train Loss: 0.484 Vali Loss: 2.324 Vali Acc: 0.502 Test Loss: 2.324 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.897409439086914
Epoch: 4, Steps: 17 | Train Loss: 0.455 Vali Loss: 1.302 Vali Acc: 0.560 Test Loss: 1.302 Test Acc: 0.560
Validation loss decreased (-0.539242 --> -0.559714).  Saving model ...
Epoch: 5 cost time: 6.167819261550903
Epoch: 5, Steps: 17 | Train Loss: 0.296 Vali Loss: 1.646 Vali Acc: 0.522 Test Loss: 1.646 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.314913511276245
Epoch: 6, Steps: 17 | Train Loss: 0.206 Vali Loss: 1.343 Vali Acc: 0.594 Test Loss: 1.343 Test Acc: 0.594
Validation loss decreased (-0.559714 --> -0.593843).  Saving model ...
Epoch: 7 cost time: 5.791727781295776
Epoch: 7, Steps: 17 | Train Loss: 0.200 Vali Loss: 1.248 Vali Acc: 0.628 Test Loss: 1.248 Test Acc: 0.628
Validation loss decreased (-0.593843 --> -0.627974).  Saving model ...
Epoch: 8 cost time: 6.306265592575073
Epoch: 8, Steps: 17 | Train Loss: 0.185 Vali Loss: 2.260 Vali Acc: 0.549 Test Loss: 2.260 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.470868349075317
Epoch: 9, Steps: 17 | Train Loss: 0.111 Vali Loss: 2.733 Vali Acc: 0.560 Test Loss: 2.733 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.958667993545532
Epoch: 10, Steps: 17 | Train Loss: 0.167 Vali Loss: 2.303 Vali Acc: 0.611 Test Loss: 2.303 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.0083231925964355
Epoch: 11, Steps: 17 | Train Loss: 0.124 Vali Loss: 2.360 Vali Acc: 0.625 Test Loss: 2.360 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.560396194458008
Epoch: 12, Steps: 17 | Train Loss: 0.083 Vali Loss: 4.233 Vali Acc: 0.543 Test Loss: 4.233 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.285391330718994
Epoch: 13, Steps: 17 | Train Loss: 0.060 Vali Loss: 2.735 Vali Acc: 0.587 Test Loss: 2.735 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.103998184204102
Epoch: 14, Steps: 17 | Train Loss: 0.261 Vali Loss: 3.227 Vali Acc: 0.587 Test Loss: 3.227 Test Acc: 0.587
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.233315467834473
Epoch: 15, Steps: 17 | Train Loss: 0.097 Vali Loss: 4.587 Vali Acc: 0.567 Test Loss: 4.587 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.751539468765259
Epoch: 16, Steps: 17 | Train Loss: 0.126 Vali Loss: 4.684 Vali Acc: 0.553 Test Loss: 4.684 Test Acc: 0.553
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.673089504241943
Epoch: 17, Steps: 17 | Train Loss: 0.095 Vali Loss: 3.788 Vali Acc: 0.584 Test Loss: 3.788 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6279863481228669
model parameter : 1679746
model size : 11.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.89599084854126
Epoch: 1, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.893 Vali Acc: 0.505 Test Loss: 0.893 Test Acc: 0.505
Validation loss decreased (inf --> -0.505111).  Saving model ...
Epoch: 2 cost time: 5.716388702392578
Epoch: 2, Steps: 17 | Train Loss: 0.571 Vali Loss: 1.339 Vali Acc: 0.515 Test Loss: 1.339 Test Acc: 0.515
Validation loss decreased (-0.505111 --> -0.515345).  Saving model ...
Epoch: 3 cost time: 5.81604266166687
Epoch: 3, Steps: 17 | Train Loss: 0.522 Vali Loss: 1.934 Vali Acc: 0.505 Test Loss: 1.934 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.1909120082855225
Epoch: 4, Steps: 17 | Train Loss: 0.493 Vali Loss: 1.138 Vali Acc: 0.597 Test Loss: 1.138 Test Acc: 0.597
Validation loss decreased (-0.515345 --> -0.597258).  Saving model ...
Epoch: 5 cost time: 5.940018892288208
Epoch: 5, Steps: 17 | Train Loss: 0.466 Vali Loss: 1.885 Vali Acc: 0.556 Test Loss: 1.885 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.250657081604004
Epoch: 6, Steps: 17 | Train Loss: 0.319 Vali Loss: 1.502 Vali Acc: 0.543 Test Loss: 1.502 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.601489782333374
Epoch: 7, Steps: 17 | Train Loss: 0.326 Vali Loss: 1.509 Vali Acc: 0.563 Test Loss: 1.509 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.407639265060425
Epoch: 8, Steps: 17 | Train Loss: 0.249 Vali Loss: 1.898 Vali Acc: 0.536 Test Loss: 1.898 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.5521979331970215
Epoch: 9, Steps: 17 | Train Loss: 0.378 Vali Loss: 1.919 Vali Acc: 0.546 Test Loss: 1.919 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.585814952850342
Epoch: 10, Steps: 17 | Train Loss: 0.367 Vali Loss: 2.295 Vali Acc: 0.580 Test Loss: 2.295 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.192742109298706
Epoch: 11, Steps: 17 | Train Loss: 0.453 Vali Loss: 3.483 Vali Acc: 0.539 Test Loss: 3.483 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.700500249862671
Epoch: 12, Steps: 17 | Train Loss: 0.107 Vali Loss: 3.444 Vali Acc: 0.549 Test Loss: 3.444 Test Acc: 0.549
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.554853677749634
Epoch: 13, Steps: 17 | Train Loss: 0.240 Vali Loss: 3.950 Vali Acc: 0.543 Test Loss: 3.950 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.303854703903198
Epoch: 14, Steps: 17 | Train Loss: 0.180 Vali Loss: 3.653 Vali Acc: 0.556 Test Loss: 3.653 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5972696245733788
model parameter : 1679746
model size : 11.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.707636117935181
Epoch: 1, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.888 Vali Acc: 0.495 Test Loss: 0.888 Test Acc: 0.495
Validation loss decreased (inf --> -0.494872).  Saving model ...
Epoch: 2 cost time: 6.364779472351074
Epoch: 2, Steps: 17 | Train Loss: 0.570 Vali Loss: 1.506 Vali Acc: 0.502 Test Loss: 1.506 Test Acc: 0.502
Validation loss decreased (-0.494872 --> -0.501691).  Saving model ...
Epoch: 3 cost time: 5.981340408325195
Epoch: 3, Steps: 17 | Train Loss: 0.455 Vali Loss: 1.891 Vali Acc: 0.502 Test Loss: 1.891 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.5895676612854
Epoch: 4, Steps: 17 | Train Loss: 0.451 Vali Loss: 1.282 Vali Acc: 0.532 Test Loss: 1.282 Test Acc: 0.532
Validation loss decreased (-0.501691 --> -0.532410).  Saving model ...
Epoch: 5 cost time: 6.406052827835083
Epoch: 5, Steps: 17 | Train Loss: 0.390 Vali Loss: 1.292 Vali Acc: 0.549 Test Loss: 1.292 Test Acc: 0.549
Validation loss decreased (-0.532410 --> -0.549475).  Saving model ...
Epoch: 6 cost time: 5.857928276062012
Epoch: 6, Steps: 17 | Train Loss: 0.352 Vali Loss: 1.472 Vali Acc: 0.549 Test Loss: 1.472 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.688667058944702
Epoch: 7, Steps: 17 | Train Loss: 0.251 Vali Loss: 1.716 Vali Acc: 0.553 Test Loss: 1.716 Test Acc: 0.553
Validation loss decreased (-0.549475 --> -0.552884).  Saving model ...
Epoch: 8 cost time: 5.8286473751068115
Epoch: 8, Steps: 17 | Train Loss: 0.229 Vali Loss: 2.513 Vali Acc: 0.495 Test Loss: 2.513 Test Acc: 0.495
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.506788015365601
Epoch: 9, Steps: 17 | Train Loss: 0.281 Vali Loss: 2.893 Vali Acc: 0.505 Test Loss: 2.893 Test Acc: 0.505
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.3320090770721436
Epoch: 10, Steps: 17 | Train Loss: 0.296 Vali Loss: 2.277 Vali Acc: 0.536 Test Loss: 2.277 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.8754682540893555
Epoch: 11, Steps: 17 | Train Loss: 0.168 Vali Loss: 2.866 Vali Acc: 0.543 Test Loss: 2.866 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.384681940078735
Epoch: 12, Steps: 17 | Train Loss: 0.178 Vali Loss: 3.165 Vali Acc: 0.488 Test Loss: 3.165 Test Acc: 0.488
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.898724317550659
Epoch: 13, Steps: 17 | Train Loss: 0.176 Vali Loss: 3.907 Vali Acc: 0.526 Test Loss: 3.907 Test Acc: 0.526
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.385735034942627
Epoch: 14, Steps: 17 | Train Loss: 0.069 Vali Loss: 4.106 Vali Acc: 0.526 Test Loss: 4.106 Test Acc: 0.526
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.215191602706909
Epoch: 15, Steps: 17 | Train Loss: 0.246 Vali Loss: 4.401 Vali Acc: 0.522 Test Loss: 4.401 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.612713098526001
Epoch: 16, Steps: 17 | Train Loss: 0.078 Vali Loss: 3.735 Vali Acc: 0.536 Test Loss: 3.735 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.715553045272827
Epoch: 17, Steps: 17 | Train Loss: 0.334 Vali Loss: 6.892 Vali Acc: 0.495 Test Loss: 6.892 Test Acc: 0.495
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.552901023890785
model parameter : 1679746
model size : 11.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.855332136154175
Epoch: 1, Steps: 17 | Train Loss: 0.743 Vali Loss: 1.193 Vali Acc: 0.502 Test Loss: 1.193 Test Acc: 0.502
Validation loss decreased (inf --> -0.501695).  Saving model ...
Epoch: 2 cost time: 6.114779472351074
Epoch: 2, Steps: 17 | Train Loss: 0.649 Vali Loss: 1.471 Vali Acc: 0.502 Test Loss: 1.471 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.773974180221558
Epoch: 3, Steps: 17 | Train Loss: 0.576 Vali Loss: 1.545 Vali Acc: 0.502 Test Loss: 1.545 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.173845291137695
Epoch: 4, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.720 Vali Acc: 0.526 Test Loss: 0.720 Test Acc: 0.526
Validation loss decreased (-0.501695 --> -0.525590).  Saving model ...
Epoch: 5 cost time: 5.695577144622803
Epoch: 5, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.809 Vali Acc: 0.512 Test Loss: 0.809 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.339770317077637
Epoch: 6, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.677 Vali Acc: 0.618 Test Loss: 0.677 Test Acc: 0.618
Validation loss decreased (-0.525590 --> -0.617741).  Saving model ...
Epoch: 7 cost time: 5.437831401824951
Epoch: 7, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.710 Vali Acc: 0.580 Test Loss: 0.710 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.917057514190674
Epoch: 8, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.754 Vali Acc: 0.614 Test Loss: 0.754 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.356507778167725
Epoch: 9, Steps: 17 | Train Loss: 0.351 Vali Loss: 1.295 Vali Acc: 0.519 Test Loss: 1.295 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.377317190170288
Epoch: 10, Steps: 17 | Train Loss: 0.299 Vali Loss: 1.466 Vali Acc: 0.526 Test Loss: 1.466 Test Acc: 0.526
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.420388221740723
Epoch: 11, Steps: 17 | Train Loss: 0.316 Vali Loss: 1.000 Vali Acc: 0.573 Test Loss: 1.000 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.3147149085998535
Epoch: 12, Steps: 17 | Train Loss: 0.306 Vali Loss: 1.701 Vali Acc: 0.532 Test Loss: 1.701 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.125190258026123
Epoch: 13, Steps: 17 | Train Loss: 0.343 Vali Loss: 1.255 Vali Acc: 0.577 Test Loss: 1.255 Test Acc: 0.577
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.738928318023682
Epoch: 14, Steps: 17 | Train Loss: 0.223 Vali Loss: 1.531 Vali Acc: 0.570 Test Loss: 1.531 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.8104777336120605
Epoch: 15, Steps: 17 | Train Loss: 0.361 Vali Loss: 1.996 Vali Acc: 0.536 Test Loss: 1.996 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.936811923980713
Epoch: 16, Steps: 17 | Train Loss: 0.312 Vali Loss: 1.605 Vali Acc: 0.577 Test Loss: 1.605 Test Acc: 0.577
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6177474402730375
model parameter : 1679746
model size : 11.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.538378000259399
Epoch: 1, Steps: 17 | Train Loss: 0.732 Vali Loss: 0.762 Vali Acc: 0.505 Test Loss: 0.762 Test Acc: 0.505
Validation loss decreased (inf --> -0.505112).  Saving model ...
Epoch: 2 cost time: 5.666075229644775
Epoch: 2, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.837 Vali Acc: 0.505 Test Loss: 0.837 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.506831407546997
Epoch: 3, Steps: 17 | Train Loss: 0.592 Vali Loss: 2.359 Vali Acc: 0.502 Test Loss: 2.359 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.136592864990234
Epoch: 4, Steps: 17 | Train Loss: 0.679 Vali Loss: 1.112 Vali Acc: 0.505 Test Loss: 1.112 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.11152720451355
Epoch: 5, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.956 Vali Acc: 0.529 Test Loss: 0.956 Test Acc: 0.529
Validation loss decreased (-0.505112 --> -0.529001).  Saving model ...
Epoch: 6 cost time: 6.506279230117798
Epoch: 6, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.813 Vali Acc: 0.584 Test Loss: 0.813 Test Acc: 0.584
Validation loss decreased (-0.529001 --> -0.583610).  Saving model ...
Epoch: 7 cost time: 5.832896947860718
Epoch: 7, Steps: 17 | Train Loss: 0.590 Vali Loss: 1.313 Vali Acc: 0.560 Test Loss: 1.313 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.460702419281006
Epoch: 8, Steps: 17 | Train Loss: 0.583 Vali Loss: 1.919 Vali Acc: 0.563 Test Loss: 1.919 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.632636785507202
Epoch: 9, Steps: 17 | Train Loss: 0.447 Vali Loss: 1.726 Vali Acc: 0.601 Test Loss: 1.726 Test Acc: 0.601
Validation loss decreased (-0.583610 --> -0.600665).  Saving model ...
Epoch: 10 cost time: 5.436911582946777
Epoch: 10, Steps: 17 | Train Loss: 0.482 Vali Loss: 1.662 Vali Acc: 0.577 Test Loss: 1.662 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.825673818588257
Epoch: 11, Steps: 17 | Train Loss: 0.459 Vali Loss: 2.002 Vali Acc: 0.597 Test Loss: 2.002 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.595910310745239
Epoch: 12, Steps: 17 | Train Loss: 0.302 Vali Loss: 2.262 Vali Acc: 0.611 Test Loss: 2.262 Test Acc: 0.611
Validation loss decreased (-0.600665 --> -0.610899).  Saving model ...
Epoch: 13 cost time: 5.620621681213379
Epoch: 13, Steps: 17 | Train Loss: 0.404 Vali Loss: 1.828 Vali Acc: 0.608 Test Loss: 1.828 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.443463325500488
Epoch: 14, Steps: 17 | Train Loss: 0.507 Vali Loss: 2.483 Vali Acc: 0.604 Test Loss: 2.483 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.36827540397644
Epoch: 15, Steps: 17 | Train Loss: 0.376 Vali Loss: 2.567 Vali Acc: 0.628 Test Loss: 2.567 Test Acc: 0.628
Validation loss decreased (-0.610899 --> -0.627961).  Saving model ...
Epoch: 16 cost time: 5.144761800765991
Epoch: 16, Steps: 17 | Train Loss: 0.517 Vali Loss: 2.855 Vali Acc: 0.590 Test Loss: 2.855 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.332264184951782
Epoch: 17, Steps: 17 | Train Loss: 0.454 Vali Loss: 3.948 Vali Acc: 0.553 Test Loss: 3.948 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.476656675338745
Epoch: 18, Steps: 17 | Train Loss: 0.302 Vali Loss: 3.532 Vali Acc: 0.590 Test Loss: 3.532 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.332171678543091
Epoch: 19, Steps: 17 | Train Loss: 0.516 Vali Loss: 3.336 Vali Acc: 0.563 Test Loss: 3.336 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.596456289291382
Epoch: 20, Steps: 17 | Train Loss: 0.517 Vali Loss: 4.446 Vali Acc: 0.539 Test Loss: 4.446 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.347725868225098
Epoch: 21, Steps: 17 | Train Loss: 0.537 Vali Loss: 3.544 Vali Acc: 0.590 Test Loss: 3.544 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.700871706008911
Epoch: 22, Steps: 17 | Train Loss: 0.400 Vali Loss: 3.636 Vali Acc: 0.567 Test Loss: 3.636 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.320757150650024
Epoch: 23, Steps: 17 | Train Loss: 0.392 Vali Loss: 5.599 Vali Acc: 0.580 Test Loss: 5.599 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.595830202102661
Epoch: 24, Steps: 17 | Train Loss: 0.525 Vali Loss: 4.321 Vali Acc: 0.621 Test Loss: 4.321 Test Acc: 0.621
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.572349548339844
Epoch: 25, Steps: 17 | Train Loss: 0.501 Vali Loss: 4.871 Vali Acc: 0.570 Test Loss: 4.871 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6279863481228669
model parameter : 1679746
model size : 11.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.906232118606567
Epoch: 1, Steps: 17 | Train Loss: 0.720 Vali Loss: 1.324 Vali Acc: 0.509 Test Loss: 1.324 Test Acc: 0.509
Validation loss decreased (inf --> -0.508519).  Saving model ...
Epoch: 2 cost time: 7.350077867507935
Epoch: 2, Steps: 17 | Train Loss: 0.503 Vali Loss: 1.012 Vali Acc: 0.611 Test Loss: 1.012 Test Acc: 0.611
Validation loss decreased (-0.508519 --> -0.610911).  Saving model ...
Epoch: 3 cost time: 6.0108864307403564
Epoch: 3, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.918 Vali Acc: 0.669 Test Loss: 0.918 Test Acc: 0.669
Validation loss decreased (-0.610911 --> -0.668933).  Saving model ...
Epoch: 4 cost time: 7.285687685012817
Epoch: 4, Steps: 17 | Train Loss: 0.217 Vali Loss: 1.505 Vali Acc: 0.594 Test Loss: 1.505 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.334333658218384
Epoch: 5, Steps: 17 | Train Loss: 0.171 Vali Loss: 1.318 Vali Acc: 0.655 Test Loss: 1.318 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.053294658660889
Epoch: 6, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.792 Vali Acc: 0.631 Test Loss: 1.792 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.306041479110718
Epoch: 7, Steps: 17 | Train Loss: 0.149 Vali Loss: 2.871 Vali Acc: 0.594 Test Loss: 2.871 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.072969913482666
Epoch: 8, Steps: 17 | Train Loss: 0.290 Vali Loss: 1.599 Vali Acc: 0.662 Test Loss: 1.599 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.9516284465789795
Epoch: 9, Steps: 17 | Train Loss: 0.233 Vali Loss: 3.204 Vali Acc: 0.601 Test Loss: 3.204 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.484960556030273
Epoch: 10, Steps: 17 | Train Loss: 0.120 Vali Loss: 2.856 Vali Acc: 0.628 Test Loss: 2.856 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.166177272796631
Epoch: 11, Steps: 17 | Train Loss: 0.128 Vali Loss: 3.330 Vali Acc: 0.621 Test Loss: 3.330 Test Acc: 0.621
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.112947940826416
Epoch: 12, Steps: 17 | Train Loss: 0.095 Vali Loss: 3.197 Vali Acc: 0.618 Test Loss: 3.197 Test Acc: 0.618
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.524823427200317
Epoch: 13, Steps: 17 | Train Loss: 0.296 Vali Loss: 3.050 Vali Acc: 0.652 Test Loss: 3.050 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6689419795221843
model parameter : 1286530
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.632536172866821
Epoch: 1, Steps: 17 | Train Loss: 0.721 Vali Loss: 1.275 Vali Acc: 0.505 Test Loss: 1.275 Test Acc: 0.505
Validation loss decreased (inf --> -0.505107).  Saving model ...
Epoch: 2 cost time: 6.693684339523315
Epoch: 2, Steps: 17 | Train Loss: 0.542 Vali Loss: 1.277 Vali Acc: 0.587 Test Loss: 1.277 Test Acc: 0.587
Validation loss decreased (-0.505107 --> -0.587018).  Saving model ...
Epoch: 3 cost time: 6.33000111579895
Epoch: 3, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.902 Vali Acc: 0.652 Test Loss: 0.902 Test Acc: 0.652
Validation loss decreased (-0.587018 --> -0.651868).  Saving model ...
Epoch: 4 cost time: 5.965740203857422
Epoch: 4, Steps: 17 | Train Loss: 0.242 Vali Loss: 1.515 Vali Acc: 0.604 Test Loss: 1.515 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.118165493011475
Epoch: 5, Steps: 17 | Train Loss: 0.408 Vali Loss: 2.444 Vali Acc: 0.556 Test Loss: 2.444 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.36589241027832
Epoch: 6, Steps: 17 | Train Loss: 0.341 Vali Loss: 1.562 Vali Acc: 0.597 Test Loss: 1.562 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.404577732086182
Epoch: 7, Steps: 17 | Train Loss: 0.410 Vali Loss: 1.582 Vali Acc: 0.662 Test Loss: 1.582 Test Acc: 0.662
Validation loss decreased (-0.651868 --> -0.662100).  Saving model ...
Epoch: 8 cost time: 6.516862392425537
Epoch: 8, Steps: 17 | Train Loss: 0.310 Vali Loss: 3.205 Vali Acc: 0.601 Test Loss: 3.205 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.982630729675293
Epoch: 9, Steps: 17 | Train Loss: 0.169 Vali Loss: 2.333 Vali Acc: 0.625 Test Loss: 2.333 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.918803691864014
Epoch: 10, Steps: 17 | Train Loss: 0.111 Vali Loss: 2.764 Vali Acc: 0.625 Test Loss: 2.764 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.346553802490234
Epoch: 11, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.110 Vali Acc: 0.642 Test Loss: 2.110 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.5304834842681885
Epoch: 12, Steps: 17 | Train Loss: 0.153 Vali Loss: 4.673 Vali Acc: 0.597 Test Loss: 4.673 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.063592433929443
Epoch: 13, Steps: 17 | Train Loss: 0.067 Vali Loss: 3.691 Vali Acc: 0.631 Test Loss: 3.691 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.046653985977173
Epoch: 14, Steps: 17 | Train Loss: 0.169 Vali Loss: 4.595 Vali Acc: 0.604 Test Loss: 4.595 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.116623878479004
Epoch: 15, Steps: 17 | Train Loss: 0.071 Vali Loss: 3.326 Vali Acc: 0.625 Test Loss: 3.326 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.861270904541016
Epoch: 16, Steps: 17 | Train Loss: 0.096 Vali Loss: 5.497 Vali Acc: 0.577 Test Loss: 5.497 Test Acc: 0.577
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.281329393386841
Epoch: 17, Steps: 17 | Train Loss: 0.078 Vali Loss: 5.730 Vali Acc: 0.590 Test Loss: 5.730 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6621160409556314
model parameter : 1286530
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.45930290222168
Epoch: 1, Steps: 17 | Train Loss: 0.719 Vali Loss: 1.193 Vali Acc: 0.498 Test Loss: 1.193 Test Acc: 0.498
Validation loss decreased (inf --> -0.498282).  Saving model ...
Epoch: 2 cost time: 6.231220006942749
Epoch: 2, Steps: 17 | Train Loss: 0.562 Vali Loss: 1.649 Vali Acc: 0.529 Test Loss: 1.649 Test Acc: 0.529
Validation loss decreased (-0.498282 --> -0.528994).  Saving model ...
Epoch: 3 cost time: 6.078963994979858
Epoch: 3, Steps: 17 | Train Loss: 0.412 Vali Loss: 1.098 Vali Acc: 0.628 Test Loss: 1.098 Test Acc: 0.628
Validation loss decreased (-0.528994 --> -0.627975).  Saving model ...
Epoch: 4 cost time: 6.468284845352173
Epoch: 4, Steps: 17 | Train Loss: 0.261 Vali Loss: 1.766 Vali Acc: 0.560 Test Loss: 1.766 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.109757900238037
Epoch: 5, Steps: 17 | Train Loss: 0.322 Vali Loss: 2.870 Vali Acc: 0.522 Test Loss: 2.870 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.205239534378052
Epoch: 6, Steps: 17 | Train Loss: 0.276 Vali Loss: 1.339 Vali Acc: 0.628 Test Loss: 1.339 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.1328125
Epoch: 7, Steps: 17 | Train Loss: 0.247 Vali Loss: 1.494 Vali Acc: 0.642 Test Loss: 1.494 Test Acc: 0.642
Validation loss decreased (-0.627975 --> -0.641623).  Saving model ...
Epoch: 8 cost time: 5.8493406772613525
Epoch: 8, Steps: 17 | Train Loss: 0.239 Vali Loss: 1.681 Vali Acc: 0.638 Test Loss: 1.681 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.289254665374756
Epoch: 9, Steps: 17 | Train Loss: 0.519 Vali Loss: 5.810 Vali Acc: 0.522 Test Loss: 5.810 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.290690898895264
Epoch: 10, Steps: 17 | Train Loss: 0.268 Vali Loss: 3.185 Vali Acc: 0.573 Test Loss: 3.185 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.668787240982056
Epoch: 11, Steps: 17 | Train Loss: 0.146 Vali Loss: 2.386 Vali Acc: 0.604 Test Loss: 2.386 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.298988103866577
Epoch: 12, Steps: 17 | Train Loss: 0.147 Vali Loss: 3.880 Vali Acc: 0.590 Test Loss: 3.880 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.4104859828948975
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 2.931 Vali Acc: 0.621 Test Loss: 2.931 Test Acc: 0.621
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.449282169342041
Epoch: 14, Steps: 17 | Train Loss: 0.065 Vali Loss: 3.247 Vali Acc: 0.625 Test Loss: 3.247 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.6507017612457275
Epoch: 15, Steps: 17 | Train Loss: 0.090 Vali Loss: 3.010 Vali Acc: 0.631 Test Loss: 3.010 Test Acc: 0.631
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.417617321014404
Epoch: 16, Steps: 17 | Train Loss: 0.257 Vali Loss: 6.343 Vali Acc: 0.573 Test Loss: 6.343 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.99277925491333
Epoch: 17, Steps: 17 | Train Loss: 0.071 Vali Loss: 4.887 Vali Acc: 0.594 Test Loss: 4.887 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 1286530
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.453283309936523
Epoch: 1, Steps: 17 | Train Loss: 0.726 Vali Loss: 1.093 Vali Acc: 0.512 Test Loss: 1.093 Test Acc: 0.512
Validation loss decreased (inf --> -0.511934).  Saving model ...
Epoch: 2 cost time: 5.470754384994507
Epoch: 2, Steps: 17 | Train Loss: 0.537 Vali Loss: 1.187 Vali Acc: 0.553 Test Loss: 1.187 Test Acc: 0.553
Validation loss decreased (-0.511934 --> -0.552889).  Saving model ...
Epoch: 3 cost time: 5.678055286407471
Epoch: 3, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.898 Vali Acc: 0.604 Test Loss: 0.898 Test Acc: 0.604
Validation loss decreased (-0.552889 --> -0.604087).  Saving model ...
Epoch: 4 cost time: 5.5526018142700195
Epoch: 4, Steps: 17 | Train Loss: 0.316 Vali Loss: 1.228 Vali Acc: 0.590 Test Loss: 1.228 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.459754705429077
Epoch: 5, Steps: 17 | Train Loss: 0.184 Vali Loss: 1.464 Vali Acc: 0.587 Test Loss: 1.464 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.846045970916748
Epoch: 6, Steps: 17 | Train Loss: 0.179 Vali Loss: 1.501 Vali Acc: 0.611 Test Loss: 1.501 Test Acc: 0.611
Validation loss decreased (-0.604087 --> -0.610906).  Saving model ...
Epoch: 7 cost time: 5.6642022132873535
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 2.021 Vali Acc: 0.587 Test Loss: 2.021 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.826075315475464
Epoch: 8, Steps: 17 | Train Loss: 0.154 Vali Loss: 2.271 Vali Acc: 0.608 Test Loss: 2.271 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.8817830085754395
Epoch: 9, Steps: 17 | Train Loss: 0.130 Vali Loss: 1.989 Vali Acc: 0.628 Test Loss: 1.989 Test Acc: 0.628
Validation loss decreased (-0.610906 --> -0.627966).  Saving model ...
Epoch: 10 cost time: 5.480321407318115
Epoch: 10, Steps: 17 | Train Loss: 0.115 Vali Loss: 2.706 Vali Acc: 0.621 Test Loss: 2.706 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.259811878204346
Epoch: 11, Steps: 17 | Train Loss: 0.101 Vali Loss: 2.756 Vali Acc: 0.642 Test Loss: 2.756 Test Acc: 0.642
Validation loss decreased (-0.627966 --> -0.641611).  Saving model ...
Epoch: 12 cost time: 5.95191216468811
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 3.943 Vali Acc: 0.584 Test Loss: 3.943 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.814186096191406
Epoch: 13, Steps: 17 | Train Loss: 0.041 Vali Loss: 4.678 Vali Acc: 0.584 Test Loss: 4.678 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.850471258163452
Epoch: 14, Steps: 17 | Train Loss: 0.060 Vali Loss: 3.212 Vali Acc: 0.608 Test Loss: 3.212 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.517146825790405
Epoch: 15, Steps: 17 | Train Loss: 0.114 Vali Loss: 4.319 Vali Acc: 0.590 Test Loss: 4.319 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.7898759841918945
Epoch: 16, Steps: 17 | Train Loss: 0.094 Vali Loss: 6.764 Vali Acc: 0.546 Test Loss: 6.764 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.943276643753052
Epoch: 17, Steps: 17 | Train Loss: 0.050 Vali Loss: 4.370 Vali Acc: 0.611 Test Loss: 4.370 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.556674003601074
Epoch: 18, Steps: 17 | Train Loss: 0.047 Vali Loss: 3.574 Vali Acc: 0.611 Test Loss: 3.574 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.569214582443237
Epoch: 19, Steps: 17 | Train Loss: 0.067 Vali Loss: 6.449 Vali Acc: 0.560 Test Loss: 6.449 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.783949136734009
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 5.193 Vali Acc: 0.584 Test Loss: 5.193 Test Acc: 0.584
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.7517454624176025
Epoch: 21, Steps: 17 | Train Loss: 0.065 Vali Loss: 5.941 Vali Acc: 0.570 Test Loss: 5.941 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 1286530
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.7208333015441895
Epoch: 1, Steps: 17 | Train Loss: 0.742 Vali Loss: 1.120 Vali Acc: 0.512 Test Loss: 1.120 Test Acc: 0.512
Validation loss decreased (inf --> -0.511934).  Saving model ...
Epoch: 2 cost time: 5.064818620681763
Epoch: 2, Steps: 17 | Train Loss: 0.521 Vali Loss: 1.253 Vali Acc: 0.539 Test Loss: 1.253 Test Acc: 0.539
Validation loss decreased (-0.511934 --> -0.539237).  Saving model ...
Epoch: 3 cost time: 5.355271577835083
Epoch: 3, Steps: 17 | Train Loss: 0.393 Vali Loss: 1.153 Vali Acc: 0.611 Test Loss: 1.153 Test Acc: 0.611
Validation loss decreased (-0.539237 --> -0.610910).  Saving model ...
Epoch: 4 cost time: 5.267769813537598
Epoch: 4, Steps: 17 | Train Loss: 0.432 Vali Loss: 1.098 Vali Acc: 0.625 Test Loss: 1.098 Test Acc: 0.625
Validation loss decreased (-0.610910 --> -0.624562).  Saving model ...
Epoch: 5 cost time: 5.290166139602661
Epoch: 5, Steps: 17 | Train Loss: 0.334 Vali Loss: 2.058 Vali Acc: 0.573 Test Loss: 2.058 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.452737092971802
Epoch: 6, Steps: 17 | Train Loss: 0.216 Vali Loss: 1.269 Vali Acc: 0.652 Test Loss: 1.269 Test Acc: 0.652
Validation loss decreased (-0.624562 --> -0.651864).  Saving model ...
Epoch: 7 cost time: 5.4979753494262695
Epoch: 7, Steps: 17 | Train Loss: 0.306 Vali Loss: 1.294 Vali Acc: 0.666 Test Loss: 1.294 Test Acc: 0.666
Validation loss decreased (-0.651864 --> -0.665516).  Saving model ...
Epoch: 8 cost time: 5.688261032104492
Epoch: 8, Steps: 17 | Train Loss: 0.282 Vali Loss: 2.397 Vali Acc: 0.580 Test Loss: 2.397 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.477309226989746
Epoch: 9, Steps: 17 | Train Loss: 0.089 Vali Loss: 2.614 Vali Acc: 0.608 Test Loss: 2.614 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.6512451171875
Epoch: 10, Steps: 17 | Train Loss: 0.101 Vali Loss: 3.073 Vali Acc: 0.570 Test Loss: 3.073 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.255123615264893
Epoch: 11, Steps: 17 | Train Loss: 0.111 Vali Loss: 2.145 Vali Acc: 0.621 Test Loss: 2.145 Test Acc: 0.621
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.282879114151001
Epoch: 12, Steps: 17 | Train Loss: 0.466 Vali Loss: 5.986 Vali Acc: 0.532 Test Loss: 5.986 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.3958165645599365
Epoch: 13, Steps: 17 | Train Loss: 0.273 Vali Loss: 2.811 Vali Acc: 0.611 Test Loss: 2.811 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.116529941558838
Epoch: 14, Steps: 17 | Train Loss: 0.072 Vali Loss: 4.201 Vali Acc: 0.618 Test Loss: 4.201 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.3031909465789795
Epoch: 15, Steps: 17 | Train Loss: 0.192 Vali Loss: 4.037 Vali Acc: 0.621 Test Loss: 4.037 Test Acc: 0.621
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.384240388870239
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 4.481 Vali Acc: 0.604 Test Loss: 4.481 Test Acc: 0.604
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.870155334472656
Epoch: 17, Steps: 17 | Train Loss: 0.045 Vali Loss: 6.726 Vali Acc: 0.570 Test Loss: 6.726 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6655290102389079
model parameter : 1286530
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.536799669265747
Epoch: 1, Steps: 17 | Train Loss: 0.738 Vali Loss: 1.139 Vali Acc: 0.505 Test Loss: 1.139 Test Acc: 0.505
Validation loss decreased (inf --> -0.505108).  Saving model ...
Epoch: 2 cost time: 5.0463645458221436
Epoch: 2, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.979 Vali Acc: 0.556 Test Loss: 0.979 Test Acc: 0.556
Validation loss decreased (-0.505108 --> -0.556304).  Saving model ...
Epoch: 3 cost time: 5.143208742141724
Epoch: 3, Steps: 17 | Train Loss: 0.443 Vali Loss: 1.457 Vali Acc: 0.543 Test Loss: 1.457 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.046673536300659
Epoch: 4, Steps: 17 | Train Loss: 0.335 Vali Loss: 1.516 Vali Acc: 0.539 Test Loss: 1.516 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.896763324737549
Epoch: 5, Steps: 17 | Train Loss: 0.322 Vali Loss: 3.037 Vali Acc: 0.498 Test Loss: 3.037 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.140820741653442
Epoch: 6, Steps: 17 | Train Loss: 0.361 Vali Loss: 1.249 Vali Acc: 0.625 Test Loss: 1.249 Test Acc: 0.625
Validation loss decreased (-0.556304 --> -0.624561).  Saving model ...
Epoch: 7 cost time: 5.207482576370239
Epoch: 7, Steps: 17 | Train Loss: 0.215 Vali Loss: 1.542 Vali Acc: 0.590 Test Loss: 1.542 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.060201644897461
Epoch: 8, Steps: 17 | Train Loss: 0.174 Vali Loss: 1.544 Vali Acc: 0.614 Test Loss: 1.544 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.971968412399292
Epoch: 9, Steps: 17 | Train Loss: 0.128 Vali Loss: 1.850 Vali Acc: 0.604 Test Loss: 1.850 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.083563566207886
Epoch: 10, Steps: 17 | Train Loss: 0.233 Vali Loss: 2.047 Vali Acc: 0.580 Test Loss: 2.047 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.985810041427612
Epoch: 11, Steps: 17 | Train Loss: 0.419 Vali Loss: 3.402 Vali Acc: 0.567 Test Loss: 3.402 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.321730375289917
Epoch: 12, Steps: 17 | Train Loss: 0.593 Vali Loss: 2.393 Vali Acc: 0.590 Test Loss: 2.393 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.340437412261963
Epoch: 13, Steps: 17 | Train Loss: 0.378 Vali Loss: 6.259 Vali Acc: 0.512 Test Loss: 6.259 Test Acc: 0.512
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.927673101425171
Epoch: 14, Steps: 17 | Train Loss: 0.215 Vali Loss: 3.077 Vali Acc: 0.608 Test Loss: 3.077 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.10650897026062
Epoch: 15, Steps: 17 | Train Loss: 0.295 Vali Loss: 3.533 Vali Acc: 0.587 Test Loss: 3.533 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.437987327575684
Epoch: 16, Steps: 17 | Train Loss: 0.101 Vali Loss: 4.961 Vali Acc: 0.546 Test Loss: 4.961 Test Acc: 0.546
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 1286530
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.378883600234985
Epoch: 1, Steps: 17 | Train Loss: 0.717 Vali Loss: 1.031 Vali Acc: 0.505 Test Loss: 1.031 Test Acc: 0.505
Validation loss decreased (inf --> -0.505109).  Saving model ...
Epoch: 2 cost time: 5.069593667984009
Epoch: 2, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.950 Vali Acc: 0.556 Test Loss: 0.950 Test Acc: 0.556
Validation loss decreased (-0.505109 --> -0.556304).  Saving model ...
Epoch: 3 cost time: 5.148611307144165
Epoch: 3, Steps: 17 | Train Loss: 0.416 Vali Loss: 1.042 Vali Acc: 0.580 Test Loss: 1.042 Test Acc: 0.580
Validation loss decreased (-0.556304 --> -0.580194).  Saving model ...
Epoch: 4 cost time: 5.619839668273926
Epoch: 4, Steps: 17 | Train Loss: 0.378 Vali Loss: 1.298 Vali Acc: 0.549 Test Loss: 1.298 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.530738830566406
Epoch: 5, Steps: 17 | Train Loss: 0.365 Vali Loss: 1.269 Vali Acc: 0.567 Test Loss: 1.269 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.5046257972717285
Epoch: 6, Steps: 17 | Train Loss: 0.248 Vali Loss: 1.301 Vali Acc: 0.570 Test Loss: 1.301 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.39479398727417
Epoch: 7, Steps: 17 | Train Loss: 0.286 Vali Loss: 1.516 Vali Acc: 0.573 Test Loss: 1.516 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.428783655166626
Epoch: 8, Steps: 17 | Train Loss: 0.263 Vali Loss: 1.795 Vali Acc: 0.573 Test Loss: 1.795 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.737983226776123
Epoch: 9, Steps: 17 | Train Loss: 0.251 Vali Loss: 1.926 Vali Acc: 0.577 Test Loss: 1.926 Test Acc: 0.577
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.341493368148804
Epoch: 10, Steps: 17 | Train Loss: 0.179 Vali Loss: 2.657 Vali Acc: 0.560 Test Loss: 2.657 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.616726398468018
Epoch: 11, Steps: 17 | Train Loss: 0.162 Vali Loss: 2.083 Vali Acc: 0.580 Test Loss: 2.083 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.420193433761597
Epoch: 12, Steps: 17 | Train Loss: 0.283 Vali Loss: 3.506 Vali Acc: 0.546 Test Loss: 3.506 Test Acc: 0.546
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.2756667137146
Epoch: 13, Steps: 17 | Train Loss: 0.144 Vali Loss: 3.372 Vali Acc: 0.539 Test Loss: 3.372 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5802047781569966
model parameter : 1286530
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.873340845108032
Epoch: 1, Steps: 17 | Train Loss: 0.704 Vali Loss: 1.069 Vali Acc: 0.502 Test Loss: 1.069 Test Acc: 0.502
Validation loss decreased (inf --> -0.501696).  Saving model ...
Epoch: 2 cost time: 5.067865610122681
Epoch: 2, Steps: 17 | Train Loss: 0.562 Vali Loss: 1.494 Vali Acc: 0.502 Test Loss: 1.494 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.212590217590332
Epoch: 3, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.916 Vali Acc: 0.560 Test Loss: 0.916 Test Acc: 0.560
Validation loss decreased (-0.501696 --> -0.559718).  Saving model ...
Epoch: 4 cost time: 5.093565464019775
Epoch: 4, Steps: 17 | Train Loss: 0.350 Vali Loss: 1.651 Vali Acc: 0.526 Test Loss: 1.651 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.568504571914673
Epoch: 5, Steps: 17 | Train Loss: 0.366 Vali Loss: 1.790 Vali Acc: 0.515 Test Loss: 1.790 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.29647159576416
Epoch: 6, Steps: 17 | Train Loss: 0.276 Vali Loss: 1.372 Vali Acc: 0.529 Test Loss: 1.372 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.319827318191528
Epoch: 7, Steps: 17 | Train Loss: 0.327 Vali Loss: 2.124 Vali Acc: 0.515 Test Loss: 2.124 Test Acc: 0.515
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.0328333377838135
Epoch: 8, Steps: 17 | Train Loss: 0.272 Vali Loss: 2.188 Vali Acc: 0.519 Test Loss: 2.188 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.276744842529297
Epoch: 9, Steps: 17 | Train Loss: 0.209 Vali Loss: 2.472 Vali Acc: 0.515 Test Loss: 2.472 Test Acc: 0.515
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.2802979946136475
Epoch: 10, Steps: 17 | Train Loss: 0.183 Vali Loss: 3.190 Vali Acc: 0.491 Test Loss: 3.190 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.2854530811309814
Epoch: 11, Steps: 17 | Train Loss: 0.136 Vali Loss: 2.889 Vali Acc: 0.522 Test Loss: 2.889 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.330915689468384
Epoch: 12, Steps: 17 | Train Loss: 0.146 Vali Loss: 3.034 Vali Acc: 0.522 Test Loss: 3.034 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.194740056991577
Epoch: 13, Steps: 17 | Train Loss: 0.104 Vali Loss: 3.826 Vali Acc: 0.536 Test Loss: 3.826 Test Acc: 0.536
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5597269624573379
model parameter : 1286530
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.782950162887573
Epoch: 1, Steps: 17 | Train Loss: 0.679 Vali Loss: 1.260 Vali Acc: 0.502 Test Loss: 1.260 Test Acc: 0.502
Validation loss decreased (inf --> -0.501694).  Saving model ...
Epoch: 2 cost time: 5.2479774951934814
Epoch: 2, Steps: 17 | Train Loss: 0.591 Vali Loss: 1.968 Vali Acc: 0.502 Test Loss: 1.968 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.214048385620117
Epoch: 3, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.833 Vali Acc: 0.502 Test Loss: 0.833 Test Acc: 0.502
Validation loss decreased (-0.501694 --> -0.501698).  Saving model ...
Epoch: 4 cost time: 5.7192442417144775
Epoch: 4, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.853 Vali Acc: 0.502 Test Loss: 0.853 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.617196321487427
Epoch: 5, Steps: 17 | Train Loss: 0.470 Vali Loss: 1.172 Vali Acc: 0.502 Test Loss: 1.172 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.423019170761108
Epoch: 6, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.659 Vali Acc: 0.614 Test Loss: 0.659 Test Acc: 0.614
Validation loss decreased (-0.501698 --> -0.614328).  Saving model ...
Epoch: 7 cost time: 5.338484525680542
Epoch: 7, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.694 Vali Acc: 0.604 Test Loss: 0.694 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.517638921737671
Epoch: 8, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.876 Vali Acc: 0.539 Test Loss: 0.876 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.72852897644043
Epoch: 9, Steps: 17 | Train Loss: 0.598 Vali Loss: 1.353 Vali Acc: 0.502 Test Loss: 1.353 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.316879034042358
Epoch: 10, Steps: 17 | Train Loss: 0.573 Vali Loss: 1.212 Vali Acc: 0.515 Test Loss: 1.212 Test Acc: 0.515
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.536186933517456
Epoch: 11, Steps: 17 | Train Loss: 0.496 Vali Loss: 1.879 Vali Acc: 0.502 Test Loss: 1.879 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.817409038543701
Epoch: 12, Steps: 17 | Train Loss: 0.620 Vali Loss: 1.564 Vali Acc: 0.512 Test Loss: 1.564 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.736320972442627
Epoch: 13, Steps: 17 | Train Loss: 0.390 Vali Loss: 1.054 Vali Acc: 0.580 Test Loss: 1.054 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.687871932983398
Epoch: 14, Steps: 17 | Train Loss: 0.406 Vali Loss: 1.072 Vali Acc: 0.587 Test Loss: 1.072 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.285465717315674
Epoch: 15, Steps: 17 | Train Loss: 0.250 Vali Loss: 1.286 Vali Acc: 0.590 Test Loss: 1.286 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.108909368515015
Epoch: 16, Steps: 17 | Train Loss: 0.315 Vali Loss: 1.554 Vali Acc: 0.573 Test Loss: 1.554 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6143344709897611
model parameter : 1286530
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.819263935089111
Epoch: 1, Steps: 17 | Train Loss: 0.663 Vali Loss: 1.067 Vali Acc: 0.498 Test Loss: 1.067 Test Acc: 0.498
Validation loss decreased (inf --> -0.498283).  Saving model ...
Epoch: 2 cost time: 5.514125823974609
Epoch: 2, Steps: 17 | Train Loss: 0.614 Vali Loss: 2.186 Vali Acc: 0.502 Test Loss: 2.186 Test Acc: 0.502
Validation loss decreased (-0.498283 --> -0.501685).  Saving model ...
Epoch: 3 cost time: 5.686695575714111
Epoch: 3, Steps: 17 | Train Loss: 0.608 Vali Loss: 1.075 Vali Acc: 0.502 Test Loss: 1.075 Test Acc: 0.502
Validation loss decreased (-0.501685 --> -0.501696).  Saving model ...
Epoch: 4 cost time: 5.743932247161865
Epoch: 4, Steps: 17 | Train Loss: 0.505 Vali Loss: 1.607 Vali Acc: 0.502 Test Loss: 1.607 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.229189872741699
Epoch: 5, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.947 Vali Acc: 0.522 Test Loss: 0.947 Test Acc: 0.522
Validation loss decreased (-0.501696 --> -0.522175).  Saving model ...
Epoch: 6 cost time: 5.339378356933594
Epoch: 6, Steps: 17 | Train Loss: 0.455 Vali Loss: 1.002 Vali Acc: 0.556 Test Loss: 1.002 Test Acc: 0.556
Validation loss decreased (-0.522175 --> -0.556304).  Saving model ...
Epoch: 7 cost time: 5.358998537063599
Epoch: 7, Steps: 17 | Train Loss: 0.477 Vali Loss: 1.494 Vali Acc: 0.560 Test Loss: 1.494 Test Acc: 0.560
Validation loss decreased (-0.556304 --> -0.559712).  Saving model ...
Epoch: 8 cost time: 5.54718017578125
Epoch: 8, Steps: 17 | Train Loss: 0.502 Vali Loss: 1.839 Vali Acc: 0.553 Test Loss: 1.839 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.81217360496521
Epoch: 9, Steps: 17 | Train Loss: 0.458 Vali Loss: 2.606 Vali Acc: 0.549 Test Loss: 2.606 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.4296715259552
Epoch: 10, Steps: 17 | Train Loss: 0.465 Vali Loss: 2.868 Vali Acc: 0.539 Test Loss: 2.868 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.3186118602752686
Epoch: 11, Steps: 17 | Train Loss: 0.438 Vali Loss: 1.692 Vali Acc: 0.587 Test Loss: 1.692 Test Acc: 0.587
Validation loss decreased (-0.559712 --> -0.587014).  Saving model ...
Epoch: 12 cost time: 5.473678112030029
Epoch: 12, Steps: 17 | Train Loss: 0.451 Vali Loss: 2.854 Vali Acc: 0.594 Test Loss: 2.854 Test Acc: 0.594
Validation loss decreased (-0.587014 --> -0.593828).  Saving model ...
Epoch: 13 cost time: 5.815335035324097
Epoch: 13, Steps: 17 | Train Loss: 0.376 Vali Loss: 2.565 Vali Acc: 0.580 Test Loss: 2.565 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.528869152069092
Epoch: 14, Steps: 17 | Train Loss: 0.443 Vali Loss: 2.684 Vali Acc: 0.597 Test Loss: 2.684 Test Acc: 0.597
Validation loss decreased (-0.593828 --> -0.597243).  Saving model ...
Epoch: 15 cost time: 6.1551830768585205
Epoch: 15, Steps: 17 | Train Loss: 0.373 Vali Loss: 2.086 Vali Acc: 0.635 Test Loss: 2.086 Test Acc: 0.635
Validation loss decreased (-0.597243 --> -0.634791).  Saving model ...
Epoch: 16 cost time: 5.619644403457642
Epoch: 16, Steps: 17 | Train Loss: 0.378 Vali Loss: 3.678 Vali Acc: 0.543 Test Loss: 3.678 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.502129793167114
Epoch: 17, Steps: 17 | Train Loss: 0.304 Vali Loss: 3.527 Vali Acc: 0.601 Test Loss: 3.527 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.689233303070068
Epoch: 18, Steps: 17 | Train Loss: 0.351 Vali Loss: 2.770 Vali Acc: 0.560 Test Loss: 2.770 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.242033243179321
Epoch: 19, Steps: 17 | Train Loss: 0.382 Vali Loss: 4.073 Vali Acc: 0.580 Test Loss: 4.073 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.720849514007568
Epoch: 20, Steps: 17 | Train Loss: 0.395 Vali Loss: 4.674 Vali Acc: 0.560 Test Loss: 4.674 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.033262729644775
Epoch: 21, Steps: 17 | Train Loss: 0.575 Vali Loss: 3.455 Vali Acc: 0.584 Test Loss: 3.455 Test Acc: 0.584
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.685390472412109
Epoch: 22, Steps: 17 | Train Loss: 0.368 Vali Loss: 4.508 Vali Acc: 0.584 Test Loss: 4.508 Test Acc: 0.584
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.5025575160980225
Epoch: 23, Steps: 17 | Train Loss: 0.434 Vali Loss: 4.799 Vali Acc: 0.560 Test Loss: 4.799 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.319487810134888
Epoch: 24, Steps: 17 | Train Loss: 0.748 Vali Loss: 5.265 Vali Acc: 0.577 Test Loss: 5.265 Test Acc: 0.577
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.576770782470703
Epoch: 25, Steps: 17 | Train Loss: 0.387 Vali Loss: 5.184 Vali Acc: 0.587 Test Loss: 5.184 Test Acc: 0.587
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6348122866894198
model parameter : 1286530
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.574997425079346
Epoch: 1, Steps: 17 | Train Loss: 0.784 Vali Loss: 0.815 Vali Acc: 0.556 Test Loss: 0.815 Test Acc: 0.556
Validation loss decreased (inf --> -0.556306).  Saving model ...
Epoch: 2 cost time: 6.378461122512817
Epoch: 2, Steps: 17 | Train Loss: 0.435 Vali Loss: 1.169 Vali Acc: 0.587 Test Loss: 1.169 Test Acc: 0.587
Validation loss decreased (-0.556306 --> -0.587019).  Saving model ...
Epoch: 3 cost time: 6.408457040786743
Epoch: 3, Steps: 17 | Train Loss: 0.304 Vali Loss: 1.085 Vali Acc: 0.635 Test Loss: 1.085 Test Acc: 0.635
Validation loss decreased (-0.587019 --> -0.634801).  Saving model ...
Epoch: 4 cost time: 6.721576929092407
Epoch: 4, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.967 Vali Acc: 0.648 Test Loss: 0.967 Test Acc: 0.648
Validation loss decreased (-0.634801 --> -0.648454).  Saving model ...
Epoch: 5 cost time: 6.132925271987915
Epoch: 5, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.968 Vali Acc: 0.604 Test Loss: 1.968 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.90477180480957
Epoch: 6, Steps: 17 | Train Loss: 0.153 Vali Loss: 2.141 Vali Acc: 0.611 Test Loss: 2.141 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.747488498687744
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 3.469 Vali Acc: 0.556 Test Loss: 3.469 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.737117290496826
Epoch: 8, Steps: 17 | Train Loss: 0.237 Vali Loss: 2.391 Vali Acc: 0.601 Test Loss: 2.391 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.343544244766235
Epoch: 9, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.688 Vali Acc: 0.666 Test Loss: 1.688 Test Acc: 0.666
Validation loss decreased (-0.648454 --> -0.665512).  Saving model ...
Epoch: 10 cost time: 6.075636386871338
Epoch: 10, Steps: 17 | Train Loss: 0.230 Vali Loss: 2.274 Vali Acc: 0.628 Test Loss: 2.274 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.110275983810425
Epoch: 11, Steps: 17 | Train Loss: 0.110 Vali Loss: 4.835 Vali Acc: 0.567 Test Loss: 4.835 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.844166278839111
Epoch: 12, Steps: 17 | Train Loss: 0.144 Vali Loss: 2.362 Vali Acc: 0.672 Test Loss: 2.362 Test Acc: 0.672
Validation loss decreased (-0.665512 --> -0.672331).  Saving model ...
Epoch: 13 cost time: 6.707063913345337
Epoch: 13, Steps: 17 | Train Loss: 0.054 Vali Loss: 2.618 Vali Acc: 0.669 Test Loss: 2.618 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.579637765884399
Epoch: 14, Steps: 17 | Train Loss: 0.046 Vali Loss: 3.040 Vali Acc: 0.648 Test Loss: 3.040 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.838634967803955
Epoch: 15, Steps: 17 | Train Loss: 0.045 Vali Loss: 4.088 Vali Acc: 0.614 Test Loss: 4.088 Test Acc: 0.614
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.577268600463867
Epoch: 16, Steps: 17 | Train Loss: 0.092 Vali Loss: 2.864 Vali Acc: 0.604 Test Loss: 2.864 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.358612298965454
Epoch: 17, Steps: 17 | Train Loss: 0.210 Vali Loss: 4.811 Vali Acc: 0.621 Test Loss: 4.811 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.756688117980957
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 3.211 Vali Acc: 0.659 Test Loss: 3.211 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.808053255081177
Epoch: 19, Steps: 17 | Train Loss: 0.066 Vali Loss: 4.605 Vali Acc: 0.631 Test Loss: 4.605 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.442553520202637
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 5.838 Vali Acc: 0.625 Test Loss: 5.838 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.176133871078491
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 3.571 Vali Acc: 0.621 Test Loss: 3.571 Test Acc: 0.621
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.838050127029419
Epoch: 22, Steps: 17 | Train Loss: 0.058 Vali Loss: 3.826 Vali Acc: 0.652 Test Loss: 3.826 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6723549488054608
model parameter : 1089922
model size : 9.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.245080947875977
Epoch: 1, Steps: 17 | Train Loss: 0.785 Vali Loss: 0.761 Vali Acc: 0.580 Test Loss: 0.761 Test Acc: 0.580
Validation loss decreased (inf --> -0.580197).  Saving model ...
Epoch: 2 cost time: 6.290944337844849
Epoch: 2, Steps: 17 | Train Loss: 0.443 Vali Loss: 1.078 Vali Acc: 0.604 Test Loss: 1.078 Test Acc: 0.604
Validation loss decreased (-0.580197 --> -0.604085).  Saving model ...
Epoch: 3 cost time: 6.325802326202393
Epoch: 3, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.987 Vali Acc: 0.618 Test Loss: 0.987 Test Acc: 0.618
Validation loss decreased (-0.604085 --> -0.617738).  Saving model ...
Epoch: 4 cost time: 5.864726781845093
Epoch: 4, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.982 Vali Acc: 0.604 Test Loss: 0.982 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.626505613327026
Epoch: 5, Steps: 17 | Train Loss: 0.197 Vali Loss: 1.180 Vali Acc: 0.648 Test Loss: 1.180 Test Acc: 0.648
Validation loss decreased (-0.617738 --> -0.648452).  Saving model ...
Epoch: 6 cost time: 5.981133699417114
Epoch: 6, Steps: 17 | Train Loss: 0.343 Vali Loss: 1.290 Vali Acc: 0.577 Test Loss: 1.290 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.09904146194458
Epoch: 7, Steps: 17 | Train Loss: 0.287 Vali Loss: 1.787 Vali Acc: 0.631 Test Loss: 1.787 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.187472105026245
Epoch: 8, Steps: 17 | Train Loss: 0.179 Vali Loss: 1.937 Vali Acc: 0.642 Test Loss: 1.937 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.155040979385376
Epoch: 9, Steps: 17 | Train Loss: 0.103 Vali Loss: 2.407 Vali Acc: 0.573 Test Loss: 2.407 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.943568706512451
Epoch: 10, Steps: 17 | Train Loss: 0.158 Vali Loss: 3.017 Vali Acc: 0.625 Test Loss: 3.017 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.052874803543091
Epoch: 11, Steps: 17 | Train Loss: 0.195 Vali Loss: 2.181 Vali Acc: 0.597 Test Loss: 2.181 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.313131809234619
Epoch: 12, Steps: 17 | Train Loss: 0.266 Vali Loss: 3.411 Vali Acc: 0.611 Test Loss: 3.411 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.30060601234436
Epoch: 13, Steps: 17 | Train Loss: 0.105 Vali Loss: 6.882 Vali Acc: 0.553 Test Loss: 6.882 Test Acc: 0.553
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.958706617355347
Epoch: 14, Steps: 17 | Train Loss: 0.093 Vali Loss: 3.101 Vali Acc: 0.604 Test Loss: 3.101 Test Acc: 0.604
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.934023141860962
Epoch: 15, Steps: 17 | Train Loss: 0.402 Vali Loss: 6.222 Vali Acc: 0.563 Test Loss: 6.222 Test Acc: 0.563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6484641638225256
model parameter : 1089922
model size : 9.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.83578634262085
Epoch: 1, Steps: 17 | Train Loss: 0.790 Vali Loss: 0.744 Vali Acc: 0.522 Test Loss: 0.744 Test Acc: 0.522
Validation loss decreased (inf --> -0.522177).  Saving model ...
Epoch: 2 cost time: 5.972166538238525
Epoch: 2, Steps: 17 | Train Loss: 0.471 Vali Loss: 1.163 Vali Acc: 0.573 Test Loss: 1.163 Test Acc: 0.573
Validation loss decreased (-0.522177 --> -0.573367).  Saving model ...
Epoch: 3 cost time: 5.937236070632935
Epoch: 3, Steps: 17 | Train Loss: 0.390 Vali Loss: 1.072 Vali Acc: 0.584 Test Loss: 1.072 Test Acc: 0.584
Validation loss decreased (-0.573367 --> -0.583607).  Saving model ...
Epoch: 4 cost time: 5.5344719886779785
Epoch: 4, Steps: 17 | Train Loss: 0.308 Vali Loss: 1.518 Vali Acc: 0.567 Test Loss: 1.518 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.735244035720825
Epoch: 5, Steps: 17 | Train Loss: 0.290 Vali Loss: 2.548 Vali Acc: 0.536 Test Loss: 2.548 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.327119588851929
Epoch: 6, Steps: 17 | Train Loss: 0.203 Vali Loss: 2.286 Vali Acc: 0.573 Test Loss: 2.286 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.314424991607666
Epoch: 7, Steps: 17 | Train Loss: 0.145 Vali Loss: 1.824 Vali Acc: 0.611 Test Loss: 1.824 Test Acc: 0.611
Validation loss decreased (-0.583607 --> -0.610903).  Saving model ...
Epoch: 8 cost time: 5.918280601501465
Epoch: 8, Steps: 17 | Train Loss: 0.121 Vali Loss: 2.255 Vali Acc: 0.601 Test Loss: 2.255 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.03162407875061
Epoch: 9, Steps: 17 | Train Loss: 0.110 Vali Loss: 1.991 Vali Acc: 0.594 Test Loss: 1.991 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.0369040966033936
Epoch: 10, Steps: 17 | Train Loss: 0.274 Vali Loss: 4.246 Vali Acc: 0.563 Test Loss: 4.246 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.088852405548096
Epoch: 11, Steps: 17 | Train Loss: 0.239 Vali Loss: 2.199 Vali Acc: 0.611 Test Loss: 2.199 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.210677146911621
Epoch: 12, Steps: 17 | Train Loss: 0.205 Vali Loss: 3.212 Vali Acc: 0.594 Test Loss: 3.212 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.370366334915161
Epoch: 13, Steps: 17 | Train Loss: 0.054 Vali Loss: 3.294 Vali Acc: 0.604 Test Loss: 3.294 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.43522834777832
Epoch: 14, Steps: 17 | Train Loss: 0.025 Vali Loss: 3.102 Vali Acc: 0.597 Test Loss: 3.102 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.143396854400635
Epoch: 15, Steps: 17 | Train Loss: 0.046 Vali Loss: 3.595 Vali Acc: 0.614 Test Loss: 3.595 Test Acc: 0.614
Validation loss decreased (-0.610903 --> -0.614299).  Saving model ...
Epoch: 16 cost time: 6.114253282546997
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 4.112 Vali Acc: 0.604 Test Loss: 4.112 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.557907819747925
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 4.704 Vali Acc: 0.590 Test Loss: 4.704 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.893848180770874
Epoch: 18, Steps: 17 | Train Loss: 0.057 Vali Loss: 6.391 Vali Acc: 0.567 Test Loss: 6.391 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.403005123138428
Epoch: 19, Steps: 17 | Train Loss: 0.142 Vali Loss: 4.075 Vali Acc: 0.621 Test Loss: 4.075 Test Acc: 0.621
Validation loss decreased (-0.614299 --> -0.621120).  Saving model ...
Epoch: 20 cost time: 5.387018203735352
Epoch: 20, Steps: 17 | Train Loss: 0.082 Vali Loss: 3.773 Vali Acc: 0.625 Test Loss: 3.773 Test Acc: 0.625
Validation loss decreased (-0.621120 --> -0.624536).  Saving model ...
Epoch: 21 cost time: 5.932183027267456
Epoch: 21, Steps: 17 | Train Loss: 0.246 Vali Loss: 8.099 Vali Acc: 0.560 Test Loss: 8.099 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.322929620742798
Epoch: 22, Steps: 17 | Train Loss: 0.181 Vali Loss: 5.809 Vali Acc: 0.563 Test Loss: 5.809 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.736771583557129
Epoch: 23, Steps: 17 | Train Loss: 0.036 Vali Loss: 5.810 Vali Acc: 0.601 Test Loss: 5.810 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.0741283893585205
Epoch: 24, Steps: 17 | Train Loss: 0.083 Vali Loss: 4.731 Vali Acc: 0.611 Test Loss: 4.731 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.2361109256744385
Epoch: 25, Steps: 17 | Train Loss: 0.046 Vali Loss: 8.485 Vali Acc: 0.560 Test Loss: 8.485 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.150259733200073
Epoch: 26, Steps: 17 | Train Loss: 0.041 Vali Loss: 6.161 Vali Acc: 0.604 Test Loss: 6.161 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.301647901535034
Epoch: 27, Steps: 17 | Train Loss: 0.047 Vali Loss: 6.609 Vali Acc: 0.577 Test Loss: 6.609 Test Acc: 0.577
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.813565492630005
Epoch: 28, Steps: 17 | Train Loss: 0.056 Vali Loss: 9.910 Vali Acc: 0.580 Test Loss: 9.910 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.5308287143707275
Epoch: 29, Steps: 17 | Train Loss: 0.240 Vali Loss: 5.508 Vali Acc: 0.608 Test Loss: 5.508 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.74301815032959
Epoch: 30, Steps: 17 | Train Loss: 0.157 Vali Loss: 7.768 Vali Acc: 0.604 Test Loss: 7.768 Test Acc: 0.604
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 1089922
model size : 9.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.885976552963257
Epoch: 1, Steps: 17 | Train Loss: 0.783 Vali Loss: 0.705 Vali Acc: 0.546 Test Loss: 0.705 Test Acc: 0.546
Validation loss decreased (inf --> -0.546068).  Saving model ...
Epoch: 2 cost time: 5.832624197006226
Epoch: 2, Steps: 17 | Train Loss: 0.458 Vali Loss: 1.025 Vali Acc: 0.597 Test Loss: 1.025 Test Acc: 0.597
Validation loss decreased (-0.546068 --> -0.597259).  Saving model ...
Epoch: 3 cost time: 5.562544345855713
Epoch: 3, Steps: 17 | Train Loss: 0.322 Vali Loss: 1.227 Vali Acc: 0.573 Test Loss: 1.227 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.474890232086182
Epoch: 4, Steps: 17 | Train Loss: 0.208 Vali Loss: 1.798 Vali Acc: 0.563 Test Loss: 1.798 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.912379503250122
Epoch: 5, Steps: 17 | Train Loss: 0.176 Vali Loss: 1.328 Vali Acc: 0.584 Test Loss: 1.328 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.46011757850647
Epoch: 6, Steps: 17 | Train Loss: 0.277 Vali Loss: 1.461 Vali Acc: 0.608 Test Loss: 1.461 Test Acc: 0.608
Validation loss decreased (-0.597259 --> -0.607494).  Saving model ...
Epoch: 7 cost time: 5.6163225173950195
Epoch: 7, Steps: 17 | Train Loss: 0.223 Vali Loss: 1.517 Vali Acc: 0.621 Test Loss: 1.517 Test Acc: 0.621
Validation loss decreased (-0.607494 --> -0.621145).  Saving model ...
Epoch: 8 cost time: 5.337258815765381
Epoch: 8, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.834 Vali Acc: 0.597 Test Loss: 1.834 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.398916721343994
Epoch: 9, Steps: 17 | Train Loss: 0.085 Vali Loss: 2.044 Vali Acc: 0.625 Test Loss: 2.044 Test Acc: 0.625
Validation loss decreased (-0.621145 --> -0.624553).  Saving model ...
Epoch: 10 cost time: 5.483158826828003
Epoch: 10, Steps: 17 | Train Loss: 0.081 Vali Loss: 2.747 Vali Acc: 0.604 Test Loss: 2.747 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.81760835647583
Epoch: 11, Steps: 17 | Train Loss: 0.076 Vali Loss: 2.764 Vali Acc: 0.584 Test Loss: 2.764 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.326941251754761
Epoch: 12, Steps: 17 | Train Loss: 0.207 Vali Loss: 3.027 Vali Acc: 0.580 Test Loss: 3.027 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.551295518875122
Epoch: 13, Steps: 17 | Train Loss: 0.068 Vali Loss: 6.651 Vali Acc: 0.539 Test Loss: 6.651 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.018879413604736
Epoch: 14, Steps: 17 | Train Loss: 0.044 Vali Loss: 4.839 Vali Acc: 0.560 Test Loss: 4.839 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.910299062728882
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 3.749 Vali Acc: 0.587 Test Loss: 3.749 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.787376642227173
Epoch: 16, Steps: 17 | Train Loss: 0.072 Vali Loss: 3.823 Vali Acc: 0.611 Test Loss: 3.823 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.324753761291504
Epoch: 17, Steps: 17 | Train Loss: 0.068 Vali Loss: 6.102 Vali Acc: 0.590 Test Loss: 6.102 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.472193956375122
Epoch: 18, Steps: 17 | Train Loss: 0.054 Vali Loss: 5.605 Vali Acc: 0.570 Test Loss: 5.605 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.778995037078857
Epoch: 19, Steps: 17 | Train Loss: 0.037 Vali Loss: 9.106 Vali Acc: 0.549 Test Loss: 9.106 Test Acc: 0.549
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 1089922
model size : 9.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.846296548843384
Epoch: 1, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.690 Vali Acc: 0.556 Test Loss: 0.690 Test Acc: 0.556
Validation loss decreased (inf --> -0.556307).  Saving model ...
Epoch: 2 cost time: 5.446242094039917
Epoch: 2, Steps: 17 | Train Loss: 0.479 Vali Loss: 1.115 Vali Acc: 0.590 Test Loss: 1.115 Test Acc: 0.590
Validation loss decreased (-0.556307 --> -0.590433).  Saving model ...
Epoch: 3 cost time: 5.788294553756714
Epoch: 3, Steps: 17 | Train Loss: 0.434 Vali Loss: 1.160 Vali Acc: 0.601 Test Loss: 1.160 Test Acc: 0.601
Validation loss decreased (-0.590433 --> -0.600671).  Saving model ...
Epoch: 4 cost time: 5.554106712341309
Epoch: 4, Steps: 17 | Train Loss: 0.326 Vali Loss: 1.227 Vali Acc: 0.628 Test Loss: 1.227 Test Acc: 0.628
Validation loss decreased (-0.600671 --> -0.627974).  Saving model ...
Epoch: 5 cost time: 5.30997633934021
Epoch: 5, Steps: 17 | Train Loss: 0.221 Vali Loss: 1.172 Vali Acc: 0.631 Test Loss: 1.172 Test Acc: 0.631
Validation loss decreased (-0.627974 --> -0.631388).  Saving model ...
Epoch: 6 cost time: 5.346003532409668
Epoch: 6, Steps: 17 | Train Loss: 0.428 Vali Loss: 2.523 Vali Acc: 0.553 Test Loss: 2.523 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.8360276222229
Epoch: 7, Steps: 17 | Train Loss: 0.219 Vali Loss: 3.669 Vali Acc: 0.543 Test Loss: 3.669 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.579543590545654
Epoch: 8, Steps: 17 | Train Loss: 0.186 Vali Loss: 2.883 Vali Acc: 0.587 Test Loss: 2.883 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.273537874221802
Epoch: 9, Steps: 17 | Train Loss: 0.124 Vali Loss: 2.152 Vali Acc: 0.625 Test Loss: 2.152 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.192516326904297
Epoch: 10, Steps: 17 | Train Loss: 0.213 Vali Loss: 3.813 Vali Acc: 0.546 Test Loss: 3.813 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.068331241607666
Epoch: 11, Steps: 17 | Train Loss: 0.307 Vali Loss: 1.818 Vali Acc: 0.652 Test Loss: 1.818 Test Acc: 0.652
Validation loss decreased (-0.631388 --> -0.651859).  Saving model ...
Epoch: 12 cost time: 5.1645660400390625
Epoch: 12, Steps: 17 | Train Loss: 0.249 Vali Loss: 4.284 Vali Acc: 0.590 Test Loss: 4.284 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.1936726570129395
Epoch: 13, Steps: 17 | Train Loss: 0.068 Vali Loss: 5.385 Vali Acc: 0.556 Test Loss: 5.385 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.269822359085083
Epoch: 14, Steps: 17 | Train Loss: 0.117 Vali Loss: 3.712 Vali Acc: 0.635 Test Loss: 3.712 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.870496511459351
Epoch: 15, Steps: 17 | Train Loss: 0.077 Vali Loss: 2.800 Vali Acc: 0.628 Test Loss: 2.800 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.654271602630615
Epoch: 16, Steps: 17 | Train Loss: 0.106 Vali Loss: 4.006 Vali Acc: 0.601 Test Loss: 4.006 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.795990228652954
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 4.990 Vali Acc: 0.590 Test Loss: 4.990 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.843517541885376
Epoch: 18, Steps: 17 | Train Loss: 0.185 Vali Loss: 5.428 Vali Acc: 0.584 Test Loss: 5.428 Test Acc: 0.584
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.255762338638306
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 6.490 Vali Acc: 0.549 Test Loss: 6.490 Test Acc: 0.549
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.350095272064209
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 4.803 Vali Acc: 0.608 Test Loss: 4.803 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.334845781326294
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 7.281 Vali Acc: 0.560 Test Loss: 7.281 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6518771331058021
model parameter : 1089922
model size : 9.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.88717794418335
Epoch: 1, Steps: 17 | Train Loss: 0.742 Vali Loss: 0.720 Vali Acc: 0.549 Test Loss: 0.720 Test Acc: 0.549
Validation loss decreased (inf --> -0.549481).  Saving model ...
Epoch: 2 cost time: 5.932048797607422
Epoch: 2, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.973 Vali Acc: 0.549 Test Loss: 0.973 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.81003737449646
Epoch: 3, Steps: 17 | Train Loss: 0.497 Vali Loss: 1.059 Vali Acc: 0.553 Test Loss: 1.059 Test Acc: 0.553
Validation loss decreased (-0.549481 --> -0.552890).  Saving model ...
Epoch: 4 cost time: 5.979279041290283
Epoch: 4, Steps: 17 | Train Loss: 0.374 Vali Loss: 1.147 Vali Acc: 0.580 Test Loss: 1.147 Test Acc: 0.580
Validation loss decreased (-0.552890 --> -0.580193).  Saving model ...
Epoch: 5 cost time: 5.78193473815918
Epoch: 5, Steps: 17 | Train Loss: 0.278 Vali Loss: 1.093 Vali Acc: 0.628 Test Loss: 1.093 Test Acc: 0.628
Validation loss decreased (-0.580193 --> -0.627975).  Saving model ...
Epoch: 6 cost time: 5.187010765075684
Epoch: 6, Steps: 17 | Train Loss: 0.401 Vali Loss: 1.351 Vali Acc: 0.611 Test Loss: 1.351 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.230891942977905
Epoch: 7, Steps: 17 | Train Loss: 0.436 Vali Loss: 2.392 Vali Acc: 0.509 Test Loss: 2.392 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.219089984893799
Epoch: 8, Steps: 17 | Train Loss: 0.206 Vali Loss: 1.469 Vali Acc: 0.621 Test Loss: 1.469 Test Acc: 0.621
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.93362283706665
Epoch: 9, Steps: 17 | Train Loss: 0.274 Vali Loss: 2.644 Vali Acc: 0.522 Test Loss: 2.644 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.1098175048828125
Epoch: 10, Steps: 17 | Train Loss: 0.283 Vali Loss: 4.515 Vali Acc: 0.498 Test Loss: 4.515 Test Acc: 0.498
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.690698862075806
Epoch: 11, Steps: 17 | Train Loss: 0.436 Vali Loss: 2.039 Vali Acc: 0.621 Test Loss: 2.039 Test Acc: 0.621
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.586513519287109
Epoch: 12, Steps: 17 | Train Loss: 0.115 Vali Loss: 2.162 Vali Acc: 0.621 Test Loss: 2.162 Test Acc: 0.621
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.763417720794678
Epoch: 13, Steps: 17 | Train Loss: 0.364 Vali Loss: 4.098 Vali Acc: 0.546 Test Loss: 4.098 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.411219835281372
Epoch: 14, Steps: 17 | Train Loss: 0.184 Vali Loss: 3.459 Vali Acc: 0.601 Test Loss: 3.459 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.740480661392212
Epoch: 15, Steps: 17 | Train Loss: 0.075 Vali Loss: 3.301 Vali Acc: 0.597 Test Loss: 3.301 Test Acc: 0.597
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6279863481228669
model parameter : 1089922
model size : 9.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.093709468841553
Epoch: 1, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.729 Vali Acc: 0.556 Test Loss: 0.729 Test Acc: 0.556
Validation loss decreased (inf --> -0.556307).  Saving model ...
Epoch: 2 cost time: 4.633301496505737
Epoch: 2, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.965 Vali Acc: 0.570 Test Loss: 0.965 Test Acc: 0.570
Validation loss decreased (-0.556307 --> -0.569956).  Saving model ...
Epoch: 3 cost time: 5.395520210266113
Epoch: 3, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.968 Vali Acc: 0.573 Test Loss: 0.968 Test Acc: 0.573
Validation loss decreased (-0.569956 --> -0.573369).  Saving model ...
Epoch: 4 cost time: 4.8970582485198975
Epoch: 4, Steps: 17 | Train Loss: 0.435 Vali Loss: 1.953 Vali Acc: 0.536 Test Loss: 1.953 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.923896551132202
Epoch: 5, Steps: 17 | Train Loss: 0.390 Vali Loss: 1.119 Vali Acc: 0.587 Test Loss: 1.119 Test Acc: 0.587
Validation loss decreased (-0.573369 --> -0.587020).  Saving model ...
Epoch: 6 cost time: 5.6741087436676025
Epoch: 6, Steps: 17 | Train Loss: 0.341 Vali Loss: 1.360 Vali Acc: 0.563 Test Loss: 1.360 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.246790885925293
Epoch: 7, Steps: 17 | Train Loss: 0.204 Vali Loss: 2.517 Vali Acc: 0.526 Test Loss: 2.517 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.052163362503052
Epoch: 8, Steps: 17 | Train Loss: 0.371 Vali Loss: 2.249 Vali Acc: 0.553 Test Loss: 2.249 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.046460151672363
Epoch: 9, Steps: 17 | Train Loss: 0.243 Vali Loss: 1.765 Vali Acc: 0.573 Test Loss: 1.765 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.722346067428589
Epoch: 10, Steps: 17 | Train Loss: 0.179 Vali Loss: 2.637 Vali Acc: 0.563 Test Loss: 2.637 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.344873666763306
Epoch: 11, Steps: 17 | Train Loss: 0.572 Vali Loss: 2.211 Vali Acc: 0.546 Test Loss: 2.211 Test Acc: 0.546
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.47769570350647
Epoch: 12, Steps: 17 | Train Loss: 0.204 Vali Loss: 2.212 Vali Acc: 0.570 Test Loss: 2.212 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.330859422683716
Epoch: 13, Steps: 17 | Train Loss: 0.162 Vali Loss: 3.149 Vali Acc: 0.543 Test Loss: 3.149 Test Acc: 0.543
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.170552015304565
Epoch: 14, Steps: 17 | Train Loss: 0.376 Vali Loss: 2.908 Vali Acc: 0.553 Test Loss: 2.908 Test Acc: 0.553
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.91123104095459
Epoch: 15, Steps: 17 | Train Loss: 0.276 Vali Loss: 3.123 Vali Acc: 0.553 Test Loss: 3.123 Test Acc: 0.553
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5870307167235495
model parameter : 1089922
model size : 9.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.772024154663086
Epoch: 1, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.749 Vali Acc: 0.515 Test Loss: 0.749 Test Acc: 0.515
Validation loss decreased (inf --> -0.515351).  Saving model ...
Epoch: 2 cost time: 5.2030065059661865
Epoch: 2, Steps: 17 | Train Loss: 0.534 Vali Loss: 1.186 Vali Acc: 0.509 Test Loss: 1.186 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.4418113231658936
Epoch: 3, Steps: 17 | Train Loss: 0.464 Vali Loss: 1.211 Vali Acc: 0.543 Test Loss: 1.211 Test Acc: 0.543
Validation loss decreased (-0.515351 --> -0.542650).  Saving model ...
Epoch: 4 cost time: 5.017564296722412
Epoch: 4, Steps: 17 | Train Loss: 0.351 Vali Loss: 1.504 Vali Acc: 0.539 Test Loss: 1.504 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.077368974685669
Epoch: 5, Steps: 17 | Train Loss: 0.336 Vali Loss: 1.251 Vali Acc: 0.543 Test Loss: 1.251 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.991437673568726
Epoch: 6, Steps: 17 | Train Loss: 0.332 Vali Loss: 1.349 Vali Acc: 0.526 Test Loss: 1.349 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.779633045196533
Epoch: 7, Steps: 17 | Train Loss: 0.257 Vali Loss: 2.328 Vali Acc: 0.532 Test Loss: 2.328 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.896773099899292
Epoch: 8, Steps: 17 | Train Loss: 0.243 Vali Loss: 2.559 Vali Acc: 0.546 Test Loss: 2.559 Test Acc: 0.546
Validation loss decreased (-0.542650 --> -0.546049).  Saving model ...
Epoch: 9 cost time: 5.095121383666992
Epoch: 9, Steps: 17 | Train Loss: 0.436 Vali Loss: 2.195 Vali Acc: 0.532 Test Loss: 2.195 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.1217427253723145
Epoch: 10, Steps: 17 | Train Loss: 0.232 Vali Loss: 2.064 Vali Acc: 0.556 Test Loss: 2.064 Test Acc: 0.556
Validation loss decreased (-0.546049 --> -0.556293).  Saving model ...
Epoch: 11 cost time: 4.8076958656311035
Epoch: 11, Steps: 17 | Train Loss: 0.305 Vali Loss: 2.166 Vali Acc: 0.560 Test Loss: 2.166 Test Acc: 0.560
Validation loss decreased (-0.556293 --> -0.559705).  Saving model ...
Epoch: 12 cost time: 5.250823020935059
Epoch: 12, Steps: 17 | Train Loss: 0.308 Vali Loss: 3.196 Vali Acc: 0.549 Test Loss: 3.196 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.272030591964722
Epoch: 13, Steps: 17 | Train Loss: 0.351 Vali Loss: 3.084 Vali Acc: 0.522 Test Loss: 3.084 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.1627137660980225
Epoch: 14, Steps: 17 | Train Loss: 0.240 Vali Loss: 3.410 Vali Acc: 0.536 Test Loss: 3.410 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.029566764831543
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 3.266 Vali Acc: 0.526 Test Loss: 3.266 Test Acc: 0.526
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.8706934452056885
Epoch: 16, Steps: 17 | Train Loss: 0.232 Vali Loss: 5.854 Vali Acc: 0.502 Test Loss: 5.854 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.873659610748291
Epoch: 17, Steps: 17 | Train Loss: 0.150 Vali Loss: 4.566 Vali Acc: 0.549 Test Loss: 4.566 Test Acc: 0.549
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.684847354888916
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 3.934 Vali Acc: 0.539 Test Loss: 3.934 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.843777894973755
Epoch: 19, Steps: 17 | Train Loss: 0.053 Vali Loss: 4.905 Vali Acc: 0.570 Test Loss: 4.905 Test Acc: 0.570
Validation loss decreased (-0.559705 --> -0.569917).  Saving model ...
Epoch: 20 cost time: 4.680701017379761
Epoch: 20, Steps: 17 | Train Loss: 0.047 Vali Loss: 4.660 Vali Acc: 0.570 Test Loss: 4.660 Test Acc: 0.570
Validation loss decreased (-0.569917 --> -0.569919).  Saving model ...
Epoch: 21 cost time: 4.75738787651062
Epoch: 21, Steps: 17 | Train Loss: 0.145 Vali Loss: 6.050 Vali Acc: 0.536 Test Loss: 6.050 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.508502960205078
Epoch: 22, Steps: 17 | Train Loss: 0.108 Vali Loss: 5.685 Vali Acc: 0.556 Test Loss: 5.685 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.132300853729248
Epoch: 23, Steps: 17 | Train Loss: 0.130 Vali Loss: 6.025 Vali Acc: 0.567 Test Loss: 6.025 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.307088375091553
Epoch: 24, Steps: 17 | Train Loss: 0.057 Vali Loss: 5.651 Vali Acc: 0.556 Test Loss: 5.651 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.16480565071106
Epoch: 25, Steps: 17 | Train Loss: 0.055 Vali Loss: 8.681 Vali Acc: 0.512 Test Loss: 8.681 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.888363838195801
Epoch: 26, Steps: 17 | Train Loss: 0.121 Vali Loss: 5.659 Vali Acc: 0.567 Test Loss: 5.659 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.120450973510742
Epoch: 27, Steps: 17 | Train Loss: 0.119 Vali Loss: 6.951 Vali Acc: 0.522 Test Loss: 6.951 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.426023960113525
Epoch: 28, Steps: 17 | Train Loss: 0.036 Vali Loss: 7.164 Vali Acc: 0.509 Test Loss: 7.164 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.110588312149048
Epoch: 29, Steps: 17 | Train Loss: 0.032 Vali Loss: 6.640 Vali Acc: 0.529 Test Loss: 6.640 Test Acc: 0.529
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.976339817047119
Epoch: 30, Steps: 17 | Train Loss: 0.177 Vali Loss: 6.442 Vali Acc: 0.539 Test Loss: 6.442 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5699658703071673
model parameter : 1089922
model size : 9.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.031287908554077
Epoch: 1, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.828 Vali Acc: 0.502 Test Loss: 0.828 Test Acc: 0.502
Validation loss decreased (inf --> -0.501698).  Saving model ...
Epoch: 2 cost time: 5.093153238296509
Epoch: 2, Steps: 17 | Train Loss: 0.635 Vali Loss: 2.520 Vali Acc: 0.502 Test Loss: 2.520 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.149041414260864
Epoch: 3, Steps: 17 | Train Loss: 0.680 Vali Loss: 1.900 Vali Acc: 0.502 Test Loss: 1.900 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.262398719787598
Epoch: 4, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.693 Vali Acc: 0.560 Test Loss: 0.693 Test Acc: 0.560
Validation loss decreased (-0.501698 --> -0.559720).  Saving model ...
Epoch: 5 cost time: 5.376281261444092
Epoch: 5, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.640 Vali Acc: 0.645 Test Loss: 0.640 Test Acc: 0.645
Validation loss decreased (-0.559720 --> -0.645045).  Saving model ...
Epoch: 6 cost time: 5.14409613609314
Epoch: 6, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.930 Vali Acc: 0.502 Test Loss: 0.930 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.458236932754517
Epoch: 7, Steps: 17 | Train Loss: 0.400 Vali Loss: 1.456 Vali Acc: 0.502 Test Loss: 1.456 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.445537328720093
Epoch: 8, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.882 Vali Acc: 0.543 Test Loss: 0.882 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.250281810760498
Epoch: 9, Steps: 17 | Train Loss: 0.366 Vali Loss: 1.684 Vali Acc: 0.498 Test Loss: 1.684 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.9313788414001465
Epoch: 10, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.795 Vali Acc: 0.590 Test Loss: 0.795 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.286532163619995
Epoch: 11, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.896 Vali Acc: 0.594 Test Loss: 0.896 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.05177116394043
Epoch: 12, Steps: 17 | Train Loss: 0.458 Vali Loss: 1.787 Vali Acc: 0.505 Test Loss: 1.787 Test Acc: 0.505
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.270659446716309
Epoch: 13, Steps: 17 | Train Loss: 0.436 Vali Loss: 1.853 Vali Acc: 0.505 Test Loss: 1.853 Test Acc: 0.505
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.151146650314331
Epoch: 14, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.996 Vali Acc: 0.611 Test Loss: 0.996 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.981489181518555
Epoch: 15, Steps: 17 | Train Loss: 0.291 Vali Loss: 1.856 Vali Acc: 0.532 Test Loss: 1.856 Test Acc: 0.532
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6450511945392492
model parameter : 1089922
model size : 9.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.259184122085571
Epoch: 1, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.845 Vali Acc: 0.474 Test Loss: 0.845 Test Acc: 0.474
Validation loss decreased (inf --> -0.474394).  Saving model ...
Epoch: 2 cost time: 5.721984624862671
Epoch: 2, Steps: 17 | Train Loss: 0.656 Vali Loss: 2.142 Vali Acc: 0.502 Test Loss: 2.142 Test Acc: 0.502
Validation loss decreased (-0.474394 --> -0.501685).  Saving model ...
Epoch: 3 cost time: 5.498042345046997
Epoch: 3, Steps: 17 | Train Loss: 0.615 Vali Loss: 2.324 Vali Acc: 0.502 Test Loss: 2.324 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.940897226333618
Epoch: 4, Steps: 17 | Train Loss: 0.549 Vali Loss: 1.190 Vali Acc: 0.502 Test Loss: 1.190 Test Acc: 0.502
Validation loss decreased (-0.501685 --> -0.501695).  Saving model ...
Epoch: 5 cost time: 5.179598093032837
Epoch: 5, Steps: 17 | Train Loss: 0.500 Vali Loss: 1.004 Vali Acc: 0.512 Test Loss: 1.004 Test Acc: 0.512
Validation loss decreased (-0.501695 --> -0.511935).  Saving model ...
Epoch: 6 cost time: 5.647477149963379
Epoch: 6, Steps: 17 | Train Loss: 0.487 Vali Loss: 1.708 Vali Acc: 0.509 Test Loss: 1.708 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.464617967605591
Epoch: 7, Steps: 17 | Train Loss: 0.462 Vali Loss: 2.060 Vali Acc: 0.519 Test Loss: 2.060 Test Acc: 0.519
Validation loss decreased (-0.511935 --> -0.518751).  Saving model ...
Epoch: 8 cost time: 5.404548406600952
Epoch: 8, Steps: 17 | Train Loss: 0.452 Vali Loss: 1.697 Vali Acc: 0.560 Test Loss: 1.697 Test Acc: 0.560
Validation loss decreased (-0.518751 --> -0.559710).  Saving model ...
Epoch: 9 cost time: 5.460197925567627
Epoch: 9, Steps: 17 | Train Loss: 0.447 Vali Loss: 1.563 Vali Acc: 0.587 Test Loss: 1.563 Test Acc: 0.587
Validation loss decreased (-0.559710 --> -0.587015).  Saving model ...
Epoch: 10 cost time: 5.775779724121094
Epoch: 10, Steps: 17 | Train Loss: 0.522 Vali Loss: 3.090 Vali Acc: 0.560 Test Loss: 3.090 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.340806484222412
Epoch: 11, Steps: 17 | Train Loss: 0.770 Vali Loss: 2.143 Vali Acc: 0.597 Test Loss: 2.143 Test Acc: 0.597
Validation loss decreased (-0.587015 --> -0.597248).  Saving model ...
Epoch: 12 cost time: 5.796774864196777
Epoch: 12, Steps: 17 | Train Loss: 0.487 Vali Loss: 1.784 Vali Acc: 0.584 Test Loss: 1.784 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.833643436431885
Epoch: 13, Steps: 17 | Train Loss: 0.469 Vali Loss: 2.354 Vali Acc: 0.567 Test Loss: 2.354 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.701804876327515
Epoch: 14, Steps: 17 | Train Loss: 0.360 Vali Loss: 2.577 Vali Acc: 0.584 Test Loss: 2.577 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.441417694091797
Epoch: 15, Steps: 17 | Train Loss: 0.345 Vali Loss: 2.233 Vali Acc: 0.597 Test Loss: 2.233 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.530224084854126
Epoch: 16, Steps: 17 | Train Loss: 0.390 Vali Loss: 3.079 Vali Acc: 0.570 Test Loss: 3.079 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.148372650146484
Epoch: 17, Steps: 17 | Train Loss: 0.302 Vali Loss: 3.778 Vali Acc: 0.556 Test Loss: 3.778 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.1331400871276855
Epoch: 18, Steps: 17 | Train Loss: 0.364 Vali Loss: 3.208 Vali Acc: 0.580 Test Loss: 3.208 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.967356443405151
Epoch: 19, Steps: 17 | Train Loss: 0.342 Vali Loss: 2.737 Vali Acc: 0.604 Test Loss: 2.737 Test Acc: 0.604
Validation loss decreased (-0.597248 --> -0.604068).  Saving model ...
Epoch: 20 cost time: 5.504214763641357
Epoch: 20, Steps: 17 | Train Loss: 0.309 Vali Loss: 2.862 Vali Acc: 0.608 Test Loss: 2.862 Test Acc: 0.608
Validation loss decreased (-0.604068 --> -0.607480).  Saving model ...
Epoch: 21 cost time: 5.0389344692230225
Epoch: 21, Steps: 17 | Train Loss: 0.322 Vali Loss: 3.490 Vali Acc: 0.573 Test Loss: 3.490 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.292717695236206
Epoch: 22, Steps: 17 | Train Loss: 0.417 Vali Loss: 4.463 Vali Acc: 0.543 Test Loss: 4.463 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.344897031784058
Epoch: 23, Steps: 17 | Train Loss: 0.406 Vali Loss: 4.700 Vali Acc: 0.567 Test Loss: 4.700 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.495928764343262
Epoch: 24, Steps: 17 | Train Loss: 0.404 Vali Loss: 4.841 Vali Acc: 0.567 Test Loss: 4.841 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.662166595458984
Epoch: 25, Steps: 17 | Train Loss: 0.379 Vali Loss: 4.814 Vali Acc: 0.553 Test Loss: 4.814 Test Acc: 0.553
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.584868907928467
Epoch: 26, Steps: 17 | Train Loss: 0.397 Vali Loss: 4.836 Vali Acc: 0.567 Test Loss: 4.836 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.344386339187622
Epoch: 27, Steps: 17 | Train Loss: 0.350 Vali Loss: 4.928 Vali Acc: 0.560 Test Loss: 4.928 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.128093957901001
Epoch: 28, Steps: 17 | Train Loss: 0.611 Vali Loss: 5.878 Vali Acc: 0.553 Test Loss: 5.878 Test Acc: 0.553
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.338442802429199
Epoch: 29, Steps: 17 | Train Loss: 0.367 Vali Loss: 5.378 Vali Acc: 0.573 Test Loss: 5.378 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.894773721694946
Epoch: 30, Steps: 17 | Train Loss: 0.602 Vali Loss: 4.618 Vali Acc: 0.539 Test Loss: 4.618 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6075085324232082
model parameter : 1089922
model size : 9.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.699089527130127
Epoch: 1, Steps: 17 | Train Loss: 0.687 Vali Loss: 0.678 Vali Acc: 0.611 Test Loss: 0.678 Test Acc: 0.611
Validation loss decreased (inf --> -0.610915).  Saving model ...
Epoch: 2 cost time: 6.6077539920806885
Epoch: 2, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.965 Vali Acc: 0.614 Test Loss: 0.965 Test Acc: 0.614
Validation loss decreased (-0.610915 --> -0.614325).  Saving model ...
Epoch: 3 cost time: 6.148627519607544
Epoch: 3, Steps: 17 | Train Loss: 0.310 Vali Loss: 1.563 Vali Acc: 0.577 Test Loss: 1.563 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.732034206390381
Epoch: 4, Steps: 17 | Train Loss: 0.239 Vali Loss: 2.139 Vali Acc: 0.563 Test Loss: 2.139 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.873256206512451
Epoch: 5, Steps: 17 | Train Loss: 0.252 Vali Loss: 2.178 Vali Acc: 0.604 Test Loss: 2.178 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.884868860244751
Epoch: 6, Steps: 17 | Train Loss: 0.174 Vali Loss: 2.283 Vali Acc: 0.577 Test Loss: 2.283 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.991640329360962
Epoch: 7, Steps: 17 | Train Loss: 0.414 Vali Loss: 1.807 Vali Acc: 0.652 Test Loss: 1.807 Test Acc: 0.652
Validation loss decreased (-0.614325 --> -0.651859).  Saving model ...
Epoch: 8 cost time: 5.96782112121582
Epoch: 8, Steps: 17 | Train Loss: 0.141 Vali Loss: 1.763 Vali Acc: 0.672 Test Loss: 1.763 Test Acc: 0.672
Validation loss decreased (-0.651859 --> -0.672337).  Saving model ...
Epoch: 9 cost time: 6.2009618282318115
Epoch: 9, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.827 Vali Acc: 0.635 Test Loss: 1.827 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.109898805618286
Epoch: 10, Steps: 17 | Train Loss: 0.095 Vali Loss: 2.583 Vali Acc: 0.648 Test Loss: 2.583 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.098099946975708
Epoch: 11, Steps: 17 | Train Loss: 0.116 Vali Loss: 2.076 Vali Acc: 0.672 Test Loss: 2.076 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.620504856109619
Epoch: 12, Steps: 17 | Train Loss: 0.138 Vali Loss: 2.603 Vali Acc: 0.672 Test Loss: 2.603 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.358245134353638
Epoch: 13, Steps: 17 | Train Loss: 0.050 Vali Loss: 3.420 Vali Acc: 0.662 Test Loss: 3.420 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.7628326416015625
Epoch: 14, Steps: 17 | Train Loss: 0.075 Vali Loss: 2.160 Vali Acc: 0.666 Test Loss: 2.160 Test Acc: 0.666
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.6179327964782715
Epoch: 15, Steps: 17 | Train Loss: 0.069 Vali Loss: 2.554 Vali Acc: 0.686 Test Loss: 2.554 Test Acc: 0.686
Validation loss decreased (-0.672337 --> -0.685981).  Saving model ...
Epoch: 16 cost time: 6.536399841308594
Epoch: 16, Steps: 17 | Train Loss: 0.113 Vali Loss: 5.969 Vali Acc: 0.587 Test Loss: 5.969 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.6259400844573975
Epoch: 17, Steps: 17 | Train Loss: 0.170 Vali Loss: 2.963 Vali Acc: 0.662 Test Loss: 2.963 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.363276958465576
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 4.335 Vali Acc: 0.652 Test Loss: 4.335 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.797295570373535
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 5.906 Vali Acc: 0.587 Test Loss: 5.906 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.978705883026123
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 4.750 Vali Acc: 0.618 Test Loss: 4.750 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.4786763191223145
Epoch: 21, Steps: 17 | Train Loss: 0.031 Vali Loss: 3.988 Vali Acc: 0.669 Test Loss: 3.988 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.658060789108276
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 5.491 Vali Acc: 0.604 Test Loss: 5.491 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.271545648574829
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 4.062 Vali Acc: 0.642 Test Loss: 4.062 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.504265069961548
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 5.838 Vali Acc: 0.631 Test Loss: 5.838 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.635649681091309
Epoch: 25, Steps: 17 | Train Loss: 0.049 Vali Loss: 4.413 Vali Acc: 0.655 Test Loss: 4.413 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6860068259385665
model parameter : 991618
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.200110912322998
Epoch: 1, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.693 Vali Acc: 0.577 Test Loss: 0.693 Test Acc: 0.577
Validation loss decreased (inf --> -0.576785).  Saving model ...
Epoch: 2 cost time: 6.069000005722046
Epoch: 2, Steps: 17 | Train Loss: 0.418 Vali Loss: 1.046 Vali Acc: 0.608 Test Loss: 1.046 Test Acc: 0.608
Validation loss decreased (-0.576785 --> -0.607498).  Saving model ...
Epoch: 3 cost time: 6.210541248321533
Epoch: 3, Steps: 17 | Train Loss: 0.294 Vali Loss: 1.214 Vali Acc: 0.618 Test Loss: 1.214 Test Acc: 0.618
Validation loss decreased (-0.607498 --> -0.617735).  Saving model ...
Epoch: 4 cost time: 5.935383558273315
Epoch: 4, Steps: 17 | Train Loss: 0.227 Vali Loss: 1.535 Vali Acc: 0.621 Test Loss: 1.535 Test Acc: 0.621
Validation loss decreased (-0.617735 --> -0.621145).  Saving model ...
Epoch: 5 cost time: 6.310444355010986
Epoch: 5, Steps: 17 | Train Loss: 0.176 Vali Loss: 1.884 Vali Acc: 0.608 Test Loss: 1.884 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.540295839309692
Epoch: 6, Steps: 17 | Train Loss: 0.189 Vali Loss: 1.579 Vali Acc: 0.608 Test Loss: 1.579 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.9603962898254395
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 1.428 Vali Acc: 0.652 Test Loss: 1.428 Test Acc: 0.652
Validation loss decreased (-0.621145 --> -0.651863).  Saving model ...
Epoch: 8 cost time: 6.131996393203735
Epoch: 8, Steps: 17 | Train Loss: 0.155 Vali Loss: 1.819 Vali Acc: 0.642 Test Loss: 1.819 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.219484090805054
Epoch: 9, Steps: 17 | Train Loss: 0.144 Vali Loss: 2.234 Vali Acc: 0.638 Test Loss: 2.234 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.107276916503906
Epoch: 10, Steps: 17 | Train Loss: 0.117 Vali Loss: 4.512 Vali Acc: 0.549 Test Loss: 4.512 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.016278982162476
Epoch: 11, Steps: 17 | Train Loss: 0.160 Vali Loss: 2.316 Vali Acc: 0.618 Test Loss: 2.316 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.240102767944336
Epoch: 12, Steps: 17 | Train Loss: 0.133 Vali Loss: 2.567 Vali Acc: 0.628 Test Loss: 2.567 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.750394582748413
Epoch: 13, Steps: 17 | Train Loss: 0.146 Vali Loss: 3.579 Vali Acc: 0.628 Test Loss: 3.579 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.0078582763671875
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.893 Vali Acc: 0.645 Test Loss: 2.893 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.429889917373657
Epoch: 15, Steps: 17 | Train Loss: 0.143 Vali Loss: 5.740 Vali Acc: 0.580 Test Loss: 5.740 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.064940690994263
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 3.681 Vali Acc: 0.652 Test Loss: 3.681 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.1984031200408936
Epoch: 17, Steps: 17 | Train Loss: 0.032 Vali Loss: 3.195 Vali Acc: 0.628 Test Loss: 3.195 Test Acc: 0.628
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6518771331058021
model parameter : 991618
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.887523889541626
Epoch: 1, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.758 Vali Acc: 0.536 Test Loss: 0.758 Test Acc: 0.536
Validation loss decreased (inf --> -0.535829).  Saving model ...
Epoch: 2 cost time: 5.293398380279541
Epoch: 2, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.974 Vali Acc: 0.590 Test Loss: 0.974 Test Acc: 0.590
Validation loss decreased (-0.535829 --> -0.590434).  Saving model ...
Epoch: 3 cost time: 5.482686519622803
Epoch: 3, Steps: 17 | Train Loss: 0.315 Vali Loss: 1.044 Vali Acc: 0.631 Test Loss: 1.044 Test Acc: 0.631
Validation loss decreased (-0.590434 --> -0.631389).  Saving model ...
Epoch: 4 cost time: 5.732606887817383
Epoch: 4, Steps: 17 | Train Loss: 0.248 Vali Loss: 1.613 Vali Acc: 0.577 Test Loss: 1.613 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.570063591003418
Epoch: 5, Steps: 17 | Train Loss: 0.228 Vali Loss: 1.383 Vali Acc: 0.587 Test Loss: 1.383 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.7723095417022705
Epoch: 6, Steps: 17 | Train Loss: 0.262 Vali Loss: 1.437 Vali Acc: 0.604 Test Loss: 1.437 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.98906946182251
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 1.453 Vali Acc: 0.618 Test Loss: 1.453 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.911031723022461
Epoch: 8, Steps: 17 | Train Loss: 0.222 Vali Loss: 1.527 Vali Acc: 0.628 Test Loss: 1.527 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.48011326789856
Epoch: 9, Steps: 17 | Train Loss: 0.317 Vali Loss: 3.112 Vali Acc: 0.590 Test Loss: 3.112 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.8544862270355225
Epoch: 10, Steps: 17 | Train Loss: 0.111 Vali Loss: 3.233 Vali Acc: 0.573 Test Loss: 3.233 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.722710847854614
Epoch: 11, Steps: 17 | Train Loss: 0.085 Vali Loss: 2.916 Vali Acc: 0.590 Test Loss: 2.916 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.970133304595947
Epoch: 12, Steps: 17 | Train Loss: 0.070 Vali Loss: 2.275 Vali Acc: 0.628 Test Loss: 2.275 Test Acc: 0.628
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.544974088668823
Epoch: 13, Steps: 17 | Train Loss: 0.068 Vali Loss: 3.275 Vali Acc: 0.597 Test Loss: 3.275 Test Acc: 0.597
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6313993174061433
model parameter : 991618
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.8966145515441895
Epoch: 1, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.758 Vali Acc: 0.526 Test Loss: 0.758 Test Acc: 0.526
Validation loss decreased (inf --> -0.525590).  Saving model ...
Epoch: 2 cost time: 5.842339515686035
Epoch: 2, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.992 Vali Acc: 0.611 Test Loss: 0.992 Test Acc: 0.611
Validation loss decreased (-0.525590 --> -0.610912).  Saving model ...
Epoch: 3 cost time: 5.42242693901062
Epoch: 3, Steps: 17 | Train Loss: 0.330 Vali Loss: 1.255 Vali Acc: 0.597 Test Loss: 1.255 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.549820184707642
Epoch: 4, Steps: 17 | Train Loss: 0.249 Vali Loss: 1.290 Vali Acc: 0.567 Test Loss: 1.290 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.797533750534058
Epoch: 5, Steps: 17 | Train Loss: 0.246 Vali Loss: 1.400 Vali Acc: 0.597 Test Loss: 1.400 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.7822675704956055
Epoch: 6, Steps: 17 | Train Loss: 0.242 Vali Loss: 1.402 Vali Acc: 0.584 Test Loss: 1.402 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.668836832046509
Epoch: 7, Steps: 17 | Train Loss: 0.136 Vali Loss: 2.547 Vali Acc: 0.573 Test Loss: 2.547 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.721303939819336
Epoch: 8, Steps: 17 | Train Loss: 0.090 Vali Loss: 2.107 Vali Acc: 0.577 Test Loss: 2.107 Test Acc: 0.577
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.385593414306641
Epoch: 9, Steps: 17 | Train Loss: 0.094 Vali Loss: 2.763 Vali Acc: 0.563 Test Loss: 2.763 Test Acc: 0.563
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.220200061798096
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 2.805 Vali Acc: 0.597 Test Loss: 2.805 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.430132627487183
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 2.937 Vali Acc: 0.601 Test Loss: 2.937 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.646146774291992
Epoch: 12, Steps: 17 | Train Loss: 0.058 Vali Loss: 2.245 Vali Acc: 0.611 Test Loss: 2.245 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6109215017064846
model parameter : 991618
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.33205509185791
Epoch: 1, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.695 Vali Acc: 0.590 Test Loss: 0.695 Test Acc: 0.590
Validation loss decreased (inf --> -0.590437).  Saving model ...
Epoch: 2 cost time: 4.984945297241211
Epoch: 2, Steps: 17 | Train Loss: 0.437 Vali Loss: 1.263 Vali Acc: 0.553 Test Loss: 1.263 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.746257066726685
Epoch: 3, Steps: 17 | Train Loss: 0.368 Vali Loss: 1.830 Vali Acc: 0.539 Test Loss: 1.830 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.125253915786743
Epoch: 4, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.946 Vali Acc: 0.614 Test Loss: 0.946 Test Acc: 0.614
Validation loss decreased (-0.590437 --> -0.614325).  Saving model ...
Epoch: 5 cost time: 5.664775371551514
Epoch: 5, Steps: 17 | Train Loss: 0.316 Vali Loss: 1.547 Vali Acc: 0.621 Test Loss: 1.547 Test Acc: 0.621
Validation loss decreased (-0.614325 --> -0.621145).  Saving model ...
Epoch: 6 cost time: 5.629098176956177
Epoch: 6, Steps: 17 | Train Loss: 0.216 Vali Loss: 2.956 Vali Acc: 0.553 Test Loss: 2.956 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.431192398071289
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 2.902 Vali Acc: 0.549 Test Loss: 2.902 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.535162925720215
Epoch: 8, Steps: 17 | Train Loss: 0.157 Vali Loss: 2.859 Vali Acc: 0.567 Test Loss: 2.859 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.5869810581207275
Epoch: 9, Steps: 17 | Train Loss: 0.089 Vali Loss: 2.331 Vali Acc: 0.635 Test Loss: 2.331 Test Acc: 0.635
Validation loss decreased (-0.621145 --> -0.634789).  Saving model ...
Epoch: 10 cost time: 5.535655736923218
Epoch: 10, Steps: 17 | Train Loss: 0.121 Vali Loss: 2.628 Vali Acc: 0.628 Test Loss: 2.628 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.294654130935669
Epoch: 11, Steps: 17 | Train Loss: 0.117 Vali Loss: 3.133 Vali Acc: 0.614 Test Loss: 3.133 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.416733264923096
Epoch: 12, Steps: 17 | Train Loss: 0.208 Vali Loss: 3.290 Vali Acc: 0.597 Test Loss: 3.290 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.060495853424072
Epoch: 13, Steps: 17 | Train Loss: 0.153 Vali Loss: 3.838 Vali Acc: 0.608 Test Loss: 3.838 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.968687534332275
Epoch: 14, Steps: 17 | Train Loss: 0.198 Vali Loss: 2.711 Vali Acc: 0.631 Test Loss: 2.711 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.2589685916900635
Epoch: 15, Steps: 17 | Train Loss: 0.108 Vali Loss: 5.025 Vali Acc: 0.563 Test Loss: 5.025 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.316930055618286
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 3.535 Vali Acc: 0.618 Test Loss: 3.535 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.375543594360352
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 4.397 Vali Acc: 0.597 Test Loss: 4.397 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.732683897018433
Epoch: 18, Steps: 17 | Train Loss: 0.053 Vali Loss: 5.566 Vali Acc: 0.570 Test Loss: 5.566 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.840366363525391
Epoch: 19, Steps: 17 | Train Loss: 0.041 Vali Loss: 3.903 Vali Acc: 0.618 Test Loss: 3.903 Test Acc: 0.618
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6348122866894198
model parameter : 991618
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.406014680862427
Epoch: 1, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.687 Vali Acc: 0.621 Test Loss: 0.687 Test Acc: 0.621
Validation loss decreased (inf --> -0.621154).  Saving model ...
Epoch: 2 cost time: 5.059510946273804
Epoch: 2, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.783 Vali Acc: 0.604 Test Loss: 0.783 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.030503511428833
Epoch: 3, Steps: 17 | Train Loss: 0.402 Vali Loss: 1.356 Vali Acc: 0.539 Test Loss: 1.356 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.594336986541748
Epoch: 4, Steps: 17 | Train Loss: 0.317 Vali Loss: 1.256 Vali Acc: 0.546 Test Loss: 1.256 Test Acc: 0.546
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.827736854553223
Epoch: 5, Steps: 17 | Train Loss: 0.330 Vali Loss: 1.114 Vali Acc: 0.601 Test Loss: 1.114 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.177212953567505
Epoch: 6, Steps: 17 | Train Loss: 0.255 Vali Loss: 1.110 Vali Acc: 0.618 Test Loss: 1.110 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.103559255599976
Epoch: 7, Steps: 17 | Train Loss: 0.219 Vali Loss: 1.719 Vali Acc: 0.567 Test Loss: 1.719 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.149926662445068
Epoch: 8, Steps: 17 | Train Loss: 0.218 Vali Loss: 1.682 Vali Acc: 0.590 Test Loss: 1.682 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.140905380249023
Epoch: 9, Steps: 17 | Train Loss: 0.474 Vali Loss: 2.360 Vali Acc: 0.570 Test Loss: 2.360 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.278063058853149
Epoch: 10, Steps: 17 | Train Loss: 0.164 Vali Loss: 2.240 Vali Acc: 0.573 Test Loss: 2.240 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.968734264373779
Epoch: 11, Steps: 17 | Train Loss: 0.132 Vali Loss: 2.483 Vali Acc: 0.570 Test Loss: 2.483 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.621160409556314
model parameter : 991618
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.92043137550354
Epoch: 1, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.702 Vali Acc: 0.577 Test Loss: 0.702 Test Acc: 0.577
Validation loss decreased (inf --> -0.576785).  Saving model ...
Epoch: 2 cost time: 4.789091348648071
Epoch: 2, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.890 Vali Acc: 0.563 Test Loss: 0.890 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.8365983963012695
Epoch: 3, Steps: 17 | Train Loss: 0.450 Vali Loss: 1.459 Vali Acc: 0.532 Test Loss: 1.459 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.029374837875366
Epoch: 4, Steps: 17 | Train Loss: 0.409 Vali Loss: 1.025 Vali Acc: 0.601 Test Loss: 1.025 Test Acc: 0.601
Validation loss decreased (-0.576785 --> -0.600672).  Saving model ...
Epoch: 5 cost time: 4.989161014556885
Epoch: 5, Steps: 17 | Train Loss: 0.364 Vali Loss: 1.124 Vali Acc: 0.611 Test Loss: 1.124 Test Acc: 0.611
Validation loss decreased (-0.600672 --> -0.610910).  Saving model ...
Epoch: 6 cost time: 5.219449996948242
Epoch: 6, Steps: 17 | Train Loss: 0.358 Vali Loss: 1.652 Vali Acc: 0.549 Test Loss: 1.652 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.357742547988892
Epoch: 7, Steps: 17 | Train Loss: 0.265 Vali Loss: 2.073 Vali Acc: 0.570 Test Loss: 2.073 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.031033992767334
Epoch: 8, Steps: 17 | Train Loss: 0.278 Vali Loss: 1.992 Vali Acc: 0.570 Test Loss: 1.992 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.288389682769775
Epoch: 9, Steps: 17 | Train Loss: 0.225 Vali Loss: 1.945 Vali Acc: 0.587 Test Loss: 1.945 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.3809802532196045
Epoch: 10, Steps: 17 | Train Loss: 0.180 Vali Loss: 2.075 Vali Acc: 0.573 Test Loss: 2.075 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.252195119857788
Epoch: 11, Steps: 17 | Train Loss: 0.151 Vali Loss: 2.885 Vali Acc: 0.543 Test Loss: 2.885 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.938129186630249
Epoch: 12, Steps: 17 | Train Loss: 0.219 Vali Loss: 2.816 Vali Acc: 0.577 Test Loss: 2.816 Test Acc: 0.577
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.738196611404419
Epoch: 13, Steps: 17 | Train Loss: 0.220 Vali Loss: 3.207 Vali Acc: 0.549 Test Loss: 3.207 Test Acc: 0.549
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.928149700164795
Epoch: 14, Steps: 17 | Train Loss: 0.246 Vali Loss: 2.407 Vali Acc: 0.573 Test Loss: 2.407 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.851217031478882
Epoch: 15, Steps: 17 | Train Loss: 0.218 Vali Loss: 4.140 Vali Acc: 0.553 Test Loss: 4.140 Test Acc: 0.553
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6109215017064846
model parameter : 991618
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.057409048080444
Epoch: 1, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.738 Vali Acc: 0.509 Test Loss: 0.738 Test Acc: 0.509
Validation loss decreased (inf --> -0.508525).  Saving model ...
Epoch: 2 cost time: 5.874339580535889
Epoch: 2, Steps: 17 | Train Loss: 0.513 Vali Loss: 1.077 Vali Acc: 0.529 Test Loss: 1.077 Test Acc: 0.529
Validation loss decreased (-0.508525 --> -0.528999).  Saving model ...
Epoch: 3 cost time: 5.732384443283081
Epoch: 3, Steps: 17 | Train Loss: 0.425 Vali Loss: 1.359 Vali Acc: 0.543 Test Loss: 1.359 Test Acc: 0.543
Validation loss decreased (-0.528999 --> -0.542649).  Saving model ...
Epoch: 4 cost time: 5.430164575576782
Epoch: 4, Steps: 17 | Train Loss: 0.344 Vali Loss: 1.110 Vali Acc: 0.509 Test Loss: 1.110 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.569525480270386
Epoch: 5, Steps: 17 | Train Loss: 0.325 Vali Loss: 1.158 Vali Acc: 0.515 Test Loss: 1.158 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.5898778438568115
Epoch: 6, Steps: 17 | Train Loss: 0.355 Vali Loss: 1.323 Vali Acc: 0.536 Test Loss: 1.323 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.053264379501343
Epoch: 7, Steps: 17 | Train Loss: 0.258 Vali Loss: 1.895 Vali Acc: 0.532 Test Loss: 1.895 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.5607969760894775
Epoch: 8, Steps: 17 | Train Loss: 0.320 Vali Loss: 1.871 Vali Acc: 0.529 Test Loss: 1.871 Test Acc: 0.529
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.860300302505493
Epoch: 9, Steps: 17 | Train Loss: 0.300 Vali Loss: 1.843 Vali Acc: 0.539 Test Loss: 1.843 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.1191277503967285
Epoch: 10, Steps: 17 | Train Loss: 0.184 Vali Loss: 2.311 Vali Acc: 0.515 Test Loss: 2.311 Test Acc: 0.515
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.302200555801392
Epoch: 11, Steps: 17 | Train Loss: 0.138 Vali Loss: 2.142 Vali Acc: 0.536 Test Loss: 2.142 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.52117133140564
Epoch: 12, Steps: 17 | Train Loss: 0.214 Vali Loss: 2.817 Vali Acc: 0.526 Test Loss: 2.817 Test Acc: 0.526
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.519655227661133
Epoch: 13, Steps: 17 | Train Loss: 0.163 Vali Loss: 4.482 Vali Acc: 0.515 Test Loss: 4.482 Test Acc: 0.515
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5426621160409556
model parameter : 991618
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.97377872467041
Epoch: 1, Steps: 17 | Train Loss: 0.696 Vali Loss: 1.130 Vali Acc: 0.502 Test Loss: 1.130 Test Acc: 0.502
Validation loss decreased (inf --> -0.501695).  Saving model ...
Epoch: 2 cost time: 6.008530855178833
Epoch: 2, Steps: 17 | Train Loss: 0.573 Vali Loss: 1.553 Vali Acc: 0.502 Test Loss: 1.553 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.273223876953125
Epoch: 3, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.805 Vali Acc: 0.505 Test Loss: 0.805 Test Acc: 0.505
Validation loss decreased (-0.501695 --> -0.505111).  Saving model ...
Epoch: 4 cost time: 5.33927845954895
Epoch: 4, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.658 Vali Acc: 0.577 Test Loss: 0.658 Test Acc: 0.577
Validation loss decreased (-0.505111 --> -0.576785).  Saving model ...
Epoch: 5 cost time: 5.439934730529785
Epoch: 5, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.722 Vali Acc: 0.560 Test Loss: 0.722 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.1821136474609375
Epoch: 6, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.780 Vali Acc: 0.536 Test Loss: 0.780 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.892802476882935
Epoch: 7, Steps: 17 | Train Loss: 0.506 Vali Loss: 1.424 Vali Acc: 0.502 Test Loss: 1.424 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.743763208389282
Epoch: 8, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.833 Vali Acc: 0.546 Test Loss: 0.833 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.669249773025513
Epoch: 9, Steps: 17 | Train Loss: 0.482 Vali Loss: 1.570 Vali Acc: 0.505 Test Loss: 1.570 Test Acc: 0.505
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.608322381973267
Epoch: 10, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.939 Vali Acc: 0.580 Test Loss: 0.939 Test Acc: 0.580
Validation loss decreased (-0.576785 --> -0.580195).  Saving model ...
Epoch: 11 cost time: 5.734648942947388
Epoch: 11, Steps: 17 | Train Loss: 0.409 Vali Loss: 1.853 Vali Acc: 0.502 Test Loss: 1.853 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.529150485992432
Epoch: 12, Steps: 17 | Train Loss: 0.600 Vali Loss: 2.297 Vali Acc: 0.502 Test Loss: 2.297 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.688176870346069
Epoch: 13, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.928 Vali Acc: 0.601 Test Loss: 0.928 Test Acc: 0.601
Validation loss decreased (-0.580195 --> -0.600673).  Saving model ...
Epoch: 14 cost time: 5.4238121509552
Epoch: 14, Steps: 17 | Train Loss: 0.342 Vali Loss: 1.819 Vali Acc: 0.505 Test Loss: 1.819 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.2366557121276855
Epoch: 15, Steps: 17 | Train Loss: 0.338 Vali Loss: 1.349 Vali Acc: 0.546 Test Loss: 1.349 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.1520421504974365
Epoch: 16, Steps: 17 | Train Loss: 0.290 Vali Loss: 1.171 Vali Acc: 0.584 Test Loss: 1.171 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.148664951324463
Epoch: 17, Steps: 17 | Train Loss: 0.268 Vali Loss: 1.945 Vali Acc: 0.556 Test Loss: 1.945 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.085820913314819
Epoch: 18, Steps: 17 | Train Loss: 0.298 Vali Loss: 1.371 Vali Acc: 0.567 Test Loss: 1.371 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.137786149978638
Epoch: 19, Steps: 17 | Train Loss: 0.270 Vali Loss: 1.634 Vali Acc: 0.546 Test Loss: 1.634 Test Acc: 0.546
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.383394002914429
Epoch: 20, Steps: 17 | Train Loss: 0.222 Vali Loss: 1.598 Vali Acc: 0.573 Test Loss: 1.598 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.545207500457764
Epoch: 21, Steps: 17 | Train Loss: 0.284 Vali Loss: 1.589 Vali Acc: 0.570 Test Loss: 1.589 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.436154127120972
Epoch: 22, Steps: 17 | Train Loss: 0.264 Vali Loss: 1.864 Vali Acc: 0.580 Test Loss: 1.864 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.294093370437622
Epoch: 23, Steps: 17 | Train Loss: 0.190 Vali Loss: 2.710 Vali Acc: 0.529 Test Loss: 2.710 Test Acc: 0.529
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6006825938566553
model parameter : 991618
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.3024680614471436
Epoch: 1, Steps: 17 | Train Loss: 0.722 Vali Loss: 1.105 Vali Acc: 0.502 Test Loss: 1.105 Test Acc: 0.502
Validation loss decreased (inf --> -0.501695).  Saving model ...
Epoch: 2 cost time: 5.483893871307373
Epoch: 2, Steps: 17 | Train Loss: 0.587 Vali Loss: 1.206 Vali Acc: 0.505 Test Loss: 1.206 Test Acc: 0.505
Validation loss decreased (-0.501695 --> -0.505107).  Saving model ...
Epoch: 3 cost time: 5.33437442779541
Epoch: 3, Steps: 17 | Train Loss: 0.524 Vali Loss: 1.105 Vali Acc: 0.505 Test Loss: 1.105 Test Acc: 0.505
Validation loss decreased (-0.505107 --> -0.505108).  Saving model ...
Epoch: 4 cost time: 5.495085000991821
Epoch: 4, Steps: 17 | Train Loss: 0.508 Vali Loss: 1.018 Vali Acc: 0.519 Test Loss: 1.018 Test Acc: 0.519
Validation loss decreased (-0.505108 --> -0.518761).  Saving model ...
Epoch: 5 cost time: 5.334813833236694
Epoch: 5, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.988 Vali Acc: 0.543 Test Loss: 0.988 Test Acc: 0.543
Validation loss decreased (-0.518761 --> -0.542652).  Saving model ...
Epoch: 6 cost time: 5.26738715171814
Epoch: 6, Steps: 17 | Train Loss: 0.468 Vali Loss: 1.308 Vali Acc: 0.543 Test Loss: 1.308 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.262719392776489
Epoch: 7, Steps: 17 | Train Loss: 0.506 Vali Loss: 2.320 Vali Acc: 0.512 Test Loss: 2.320 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.250153541564941
Epoch: 8, Steps: 17 | Train Loss: 0.559 Vali Loss: 1.175 Vali Acc: 0.604 Test Loss: 1.175 Test Acc: 0.604
Validation loss decreased (-0.542652 --> -0.604084).  Saving model ...
Epoch: 9 cost time: 5.3470964431762695
Epoch: 9, Steps: 17 | Train Loss: 0.580 Vali Loss: 1.760 Vali Acc: 0.590 Test Loss: 1.760 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.742709636688232
Epoch: 10, Steps: 17 | Train Loss: 0.427 Vali Loss: 2.262 Vali Acc: 0.587 Test Loss: 2.262 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.301407814025879
Epoch: 11, Steps: 17 | Train Loss: 0.374 Vali Loss: 2.033 Vali Acc: 0.590 Test Loss: 2.033 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.015742301940918
Epoch: 12, Steps: 17 | Train Loss: 0.433 Vali Loss: 1.880 Vali Acc: 0.594 Test Loss: 1.880 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.019692659378052
Epoch: 13, Steps: 17 | Train Loss: 0.325 Vali Loss: 2.379 Vali Acc: 0.573 Test Loss: 2.379 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.380027532577515
Epoch: 14, Steps: 17 | Train Loss: 0.417 Vali Loss: 2.399 Vali Acc: 0.567 Test Loss: 2.399 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.3904829025268555
Epoch: 15, Steps: 17 | Train Loss: 0.322 Vali Loss: 2.712 Vali Acc: 0.590 Test Loss: 2.712 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.095533132553101
Epoch: 16, Steps: 17 | Train Loss: 0.305 Vali Loss: 2.429 Vali Acc: 0.573 Test Loss: 2.429 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.787837743759155
Epoch: 17, Steps: 17 | Train Loss: 0.292 Vali Loss: 4.562 Vali Acc: 0.573 Test Loss: 4.562 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.8667991161346436
Epoch: 18, Steps: 17 | Train Loss: 0.271 Vali Loss: 3.312 Vali Acc: 0.570 Test Loss: 3.312 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6040955631399317
model parameter : 991618
model size : 8.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.111399412155151
Epoch: 1, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.902 Vali Acc: 0.512 Test Loss: 0.902 Test Acc: 0.512
Validation loss decreased (inf --> -0.511936).  Saving model ...
Epoch: 2 cost time: 5.917217016220093
Epoch: 2, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.641 Vali Acc: 0.672 Test Loss: 0.641 Test Acc: 0.672
Validation loss decreased (-0.511936 --> -0.672349).  Saving model ...
Epoch: 3 cost time: 5.710542440414429
Epoch: 3, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.724 Vali Acc: 0.655 Test Loss: 0.724 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.648702621459961
Epoch: 4, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.796 Vali Acc: 0.652 Test Loss: 0.796 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.693756818771362
Epoch: 5, Steps: 17 | Train Loss: 0.244 Vali Loss: 1.085 Vali Acc: 0.648 Test Loss: 1.085 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.717592477798462
Epoch: 6, Steps: 17 | Train Loss: 0.215 Vali Loss: 1.897 Vali Acc: 0.577 Test Loss: 1.897 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.636826753616333
Epoch: 7, Steps: 17 | Train Loss: 0.156 Vali Loss: 2.025 Vali Acc: 0.556 Test Loss: 2.025 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.087122917175293
Epoch: 8, Steps: 17 | Train Loss: 0.117 Vali Loss: 2.283 Vali Acc: 0.577 Test Loss: 2.283 Test Acc: 0.577
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.9335408210754395
Epoch: 9, Steps: 17 | Train Loss: 0.171 Vali Loss: 1.200 Vali Acc: 0.631 Test Loss: 1.200 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.063603162765503
Epoch: 10, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.567 Vali Acc: 0.635 Test Loss: 1.567 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.875799655914307
Epoch: 11, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.333 Vali Acc: 0.672 Test Loss: 1.333 Test Acc: 0.672
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.004421234130859
Epoch: 12, Steps: 17 | Train Loss: 0.056 Vali Loss: 2.163 Vali Acc: 0.635 Test Loss: 2.163 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6723549488054608
model parameter : 1069250
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.732264995574951
Epoch: 1, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.854 Vali Acc: 0.522 Test Loss: 0.854 Test Acc: 0.522
Validation loss decreased (inf --> -0.522176).  Saving model ...
Epoch: 2 cost time: 5.8591578006744385
Epoch: 2, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.656 Vali Acc: 0.638 Test Loss: 0.656 Test Acc: 0.638
Validation loss decreased (-0.522176 --> -0.638219).  Saving model ...
Epoch: 3 cost time: 5.588054895401001
Epoch: 3, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.750 Vali Acc: 0.584 Test Loss: 0.750 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.6326072216033936
Epoch: 4, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.897 Vali Acc: 0.625 Test Loss: 0.897 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.516178131103516
Epoch: 5, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.853 Vali Acc: 0.669 Test Loss: 0.853 Test Acc: 0.669
Validation loss decreased (-0.638219 --> -0.668933).  Saving model ...
Epoch: 6 cost time: 5.571904182434082
Epoch: 6, Steps: 17 | Train Loss: 0.206 Vali Loss: 2.068 Vali Acc: 0.546 Test Loss: 2.068 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.823194265365601
Epoch: 7, Steps: 17 | Train Loss: 0.146 Vali Loss: 2.018 Vali Acc: 0.556 Test Loss: 2.018 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.631794214248657
Epoch: 8, Steps: 17 | Train Loss: 0.109 Vali Loss: 1.527 Vali Acc: 0.614 Test Loss: 1.527 Test Acc: 0.614
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.724134206771851
Epoch: 9, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.586 Vali Acc: 0.648 Test Loss: 1.586 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.201628923416138
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.245 Vali Acc: 0.621 Test Loss: 2.245 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.3874592781066895
Epoch: 11, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.390 Vali Acc: 0.625 Test Loss: 1.390 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.919577360153198
Epoch: 12, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.878 Vali Acc: 0.635 Test Loss: 1.878 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.551892042160034
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 2.130 Vali Acc: 0.635 Test Loss: 2.130 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.205756664276123
Epoch: 14, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.707 Vali Acc: 0.621 Test Loss: 1.707 Test Acc: 0.621
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.612215042114258
Epoch: 15, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.886 Vali Acc: 0.618 Test Loss: 2.886 Test Acc: 0.618
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6689419795221843
model parameter : 1069250
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.868191719055176
Epoch: 1, Steps: 17 | Train Loss: 0.726 Vali Loss: 0.826 Vali Acc: 0.509 Test Loss: 0.826 Test Acc: 0.509
Validation loss decreased (inf --> -0.508524).  Saving model ...
Epoch: 2 cost time: 5.741211175918579
Epoch: 2, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.674 Vali Acc: 0.587 Test Loss: 0.674 Test Acc: 0.587
Validation loss decreased (-0.508524 --> -0.587024).  Saving model ...
Epoch: 3 cost time: 5.288011789321899
Epoch: 3, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.739 Vali Acc: 0.608 Test Loss: 0.739 Test Acc: 0.608
Validation loss decreased (-0.587024 --> -0.607501).  Saving model ...
Epoch: 4 cost time: 5.7108845710754395
Epoch: 4, Steps: 17 | Train Loss: 0.330 Vali Loss: 1.309 Vali Acc: 0.560 Test Loss: 1.309 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.2723002433776855
Epoch: 5, Steps: 17 | Train Loss: 0.340 Vali Loss: 1.483 Vali Acc: 0.573 Test Loss: 1.483 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.342405319213867
Epoch: 6, Steps: 17 | Train Loss: 0.285 Vali Loss: 1.873 Vali Acc: 0.560 Test Loss: 1.873 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.573343753814697
Epoch: 7, Steps: 17 | Train Loss: 0.212 Vali Loss: 1.583 Vali Acc: 0.584 Test Loss: 1.583 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.015661001205444
Epoch: 8, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.847 Vali Acc: 0.601 Test Loss: 1.847 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.3989269733428955
Epoch: 9, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.448 Vali Acc: 0.604 Test Loss: 1.448 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.3995561599731445
Epoch: 10, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.870 Vali Acc: 0.614 Test Loss: 1.870 Test Acc: 0.614
Validation loss decreased (-0.607501 --> -0.614316).  Saving model ...
Epoch: 11 cost time: 5.77397608757019
Epoch: 11, Steps: 17 | Train Loss: 0.142 Vali Loss: 1.607 Vali Acc: 0.638 Test Loss: 1.607 Test Acc: 0.638
Validation loss decreased (-0.614316 --> -0.638209).  Saving model ...
Epoch: 12 cost time: 5.351851940155029
Epoch: 12, Steps: 17 | Train Loss: 0.029 Vali Loss: 2.378 Vali Acc: 0.597 Test Loss: 2.378 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.971102714538574
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 2.670 Vali Acc: 0.597 Test Loss: 2.670 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.060385227203369
Epoch: 14, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.893 Vali Acc: 0.635 Test Loss: 1.893 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.9792163372039795
Epoch: 15, Steps: 17 | Train Loss: 0.065 Vali Loss: 2.074 Vali Acc: 0.621 Test Loss: 2.074 Test Acc: 0.621
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.484539031982422
Epoch: 16, Steps: 17 | Train Loss: 0.040 Vali Loss: 2.359 Vali Acc: 0.614 Test Loss: 2.359 Test Acc: 0.614
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.203372478485107
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 2.527 Vali Acc: 0.618 Test Loss: 2.527 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.871305227279663
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 2.942 Vali Acc: 0.604 Test Loss: 2.942 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.69083571434021
Epoch: 19, Steps: 17 | Train Loss: 0.030 Vali Loss: 3.676 Vali Acc: 0.584 Test Loss: 3.676 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.190047740936279
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.668 Vali Acc: 0.594 Test Loss: 2.668 Test Acc: 0.594
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.962634801864624
Epoch: 21, Steps: 17 | Train Loss: 0.056 Vali Loss: 4.340 Vali Acc: 0.580 Test Loss: 4.340 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6382252559726962
model parameter : 1069250
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.241171598434448
Epoch: 1, Steps: 17 | Train Loss: 0.711 Vali Loss: 0.818 Vali Acc: 0.509 Test Loss: 0.818 Test Acc: 0.509
Validation loss decreased (inf --> -0.508524).  Saving model ...
Epoch: 2 cost time: 5.554033994674683
Epoch: 2, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.733 Vali Acc: 0.563 Test Loss: 0.733 Test Acc: 0.563
Validation loss decreased (-0.508524 --> -0.563133).  Saving model ...
Epoch: 3 cost time: 5.248125314712524
Epoch: 3, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.843 Vali Acc: 0.608 Test Loss: 0.843 Test Acc: 0.608
Validation loss decreased (-0.563133 --> -0.607500).  Saving model ...
Epoch: 4 cost time: 4.89648175239563
Epoch: 4, Steps: 17 | Train Loss: 0.310 Vali Loss: 1.040 Vali Acc: 0.604 Test Loss: 1.040 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.618946552276611
Epoch: 5, Steps: 17 | Train Loss: 0.216 Vali Loss: 1.015 Vali Acc: 0.590 Test Loss: 1.015 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.119733810424805
Epoch: 6, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.951 Vali Acc: 0.560 Test Loss: 1.951 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.810547113418579
Epoch: 7, Steps: 17 | Train Loss: 0.199 Vali Loss: 1.301 Vali Acc: 0.584 Test Loss: 1.301 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.247692584991455
Epoch: 8, Steps: 17 | Train Loss: 0.125 Vali Loss: 2.134 Vali Acc: 0.573 Test Loss: 2.134 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.1681060791015625
Epoch: 9, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.625 Vali Acc: 0.601 Test Loss: 1.625 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.040977716445923
Epoch: 10, Steps: 17 | Train Loss: 0.057 Vali Loss: 2.027 Vali Acc: 0.608 Test Loss: 2.027 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.244131326675415
Epoch: 11, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.777 Vali Acc: 0.635 Test Loss: 1.777 Test Acc: 0.635
Validation loss decreased (-0.607500 --> -0.634795).  Saving model ...
Epoch: 12 cost time: 5.356675624847412
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 2.225 Vali Acc: 0.611 Test Loss: 2.225 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.3134729862213135
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.247 Vali Acc: 0.618 Test Loss: 2.247 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.8085715770721436
Epoch: 14, Steps: 17 | Train Loss: 0.068 Vali Loss: 2.716 Vali Acc: 0.594 Test Loss: 2.716 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.313449859619141
Epoch: 15, Steps: 17 | Train Loss: 0.034 Vali Loss: 3.680 Vali Acc: 0.567 Test Loss: 3.680 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.437470436096191
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 2.490 Vali Acc: 0.635 Test Loss: 2.490 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.374910593032837
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.976 Vali Acc: 0.611 Test Loss: 2.976 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.410707712173462
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 4.052 Vali Acc: 0.580 Test Loss: 4.052 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.631573677062988
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 4.169 Vali Acc: 0.597 Test Loss: 4.169 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.996234178543091
Epoch: 20, Steps: 17 | Train Loss: 0.042 Vali Loss: 2.998 Vali Acc: 0.628 Test Loss: 2.998 Test Acc: 0.628
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.555858612060547
Epoch: 21, Steps: 17 | Train Loss: 0.038 Vali Loss: 4.233 Vali Acc: 0.570 Test Loss: 4.233 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6348122866894198
model parameter : 1069250
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.79405951499939
Epoch: 1, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.809 Vali Acc: 0.519 Test Loss: 0.809 Test Acc: 0.519
Validation loss decreased (inf --> -0.518763).  Saving model ...
Epoch: 2 cost time: 5.716245889663696
Epoch: 2, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.752 Vali Acc: 0.529 Test Loss: 0.752 Test Acc: 0.529
Validation loss decreased (-0.518763 --> -0.529003).  Saving model ...
Epoch: 3 cost time: 5.604424715042114
Epoch: 3, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.764 Vali Acc: 0.628 Test Loss: 0.764 Test Acc: 0.628
Validation loss decreased (-0.529003 --> -0.627979).  Saving model ...
Epoch: 4 cost time: 6.0880231857299805
Epoch: 4, Steps: 17 | Train Loss: 0.345 Vali Loss: 1.391 Vali Acc: 0.539 Test Loss: 1.391 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.82531213760376
Epoch: 5, Steps: 17 | Train Loss: 0.368 Vali Loss: 1.426 Vali Acc: 0.567 Test Loss: 1.426 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.826405763626099
Epoch: 6, Steps: 17 | Train Loss: 0.366 Vali Loss: 1.064 Vali Acc: 0.635 Test Loss: 1.064 Test Acc: 0.635
Validation loss decreased (-0.627979 --> -0.634802).  Saving model ...
Epoch: 7 cost time: 5.663358211517334
Epoch: 7, Steps: 17 | Train Loss: 0.264 Vali Loss: 1.293 Vali Acc: 0.621 Test Loss: 1.293 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.995694160461426
Epoch: 8, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.594 Vali Acc: 0.611 Test Loss: 1.594 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.402944087982178
Epoch: 9, Steps: 17 | Train Loss: 0.109 Vali Loss: 1.538 Vali Acc: 0.635 Test Loss: 1.538 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.2182629108428955
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.937 Vali Acc: 0.625 Test Loss: 1.937 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.676840305328369
Epoch: 11, Steps: 17 | Train Loss: 0.106 Vali Loss: 2.094 Vali Acc: 0.601 Test Loss: 2.094 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.56318473815918
Epoch: 12, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.662 Vali Acc: 0.621 Test Loss: 1.662 Test Acc: 0.621
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.940333843231201
Epoch: 13, Steps: 17 | Train Loss: 0.163 Vali Loss: 2.612 Vali Acc: 0.590 Test Loss: 2.612 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.3194544315338135
Epoch: 14, Steps: 17 | Train Loss: 0.178 Vali Loss: 3.143 Vali Acc: 0.580 Test Loss: 3.143 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.036458730697632
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 2.400 Vali Acc: 0.608 Test Loss: 2.400 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.429050445556641
Epoch: 16, Steps: 17 | Train Loss: 0.134 Vali Loss: 5.166 Vali Acc: 0.567 Test Loss: 5.166 Test Acc: 0.567
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6348122866894198
model parameter : 1069250
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.249989032745361
Epoch: 1, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.721 Vali Acc: 0.522 Test Loss: 0.721 Test Acc: 0.522
Validation loss decreased (inf --> -0.522177).  Saving model ...
Epoch: 2 cost time: 5.497147083282471
Epoch: 2, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.813 Vali Acc: 0.549 Test Loss: 0.813 Test Acc: 0.549
Validation loss decreased (-0.522177 --> -0.549480).  Saving model ...
Epoch: 3 cost time: 5.660677909851074
Epoch: 3, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.857 Vali Acc: 0.577 Test Loss: 0.857 Test Acc: 0.577
Validation loss decreased (-0.549480 --> -0.576783).  Saving model ...
Epoch: 4 cost time: 4.95163106918335
Epoch: 4, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.989 Vali Acc: 0.567 Test Loss: 0.989 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.263412952423096
Epoch: 5, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.822 Vali Acc: 0.621 Test Loss: 0.822 Test Acc: 0.621
Validation loss decreased (-0.576783 --> -0.621152).  Saving model ...
Epoch: 6 cost time: 5.470221281051636
Epoch: 6, Steps: 17 | Train Loss: 0.277 Vali Loss: 1.236 Vali Acc: 0.573 Test Loss: 1.236 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.4983038902282715
Epoch: 7, Steps: 17 | Train Loss: 0.224 Vali Loss: 1.197 Vali Acc: 0.604 Test Loss: 1.197 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.878060340881348
Epoch: 8, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.638 Vali Acc: 0.563 Test Loss: 1.638 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.122123718261719
Epoch: 9, Steps: 17 | Train Loss: 0.121 Vali Loss: 1.327 Vali Acc: 0.618 Test Loss: 1.327 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.6219847202301025
Epoch: 10, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.939 Vali Acc: 0.570 Test Loss: 1.939 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.815036058425903
Epoch: 11, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.802 Vali Acc: 0.601 Test Loss: 1.802 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.496548652648926
Epoch: 12, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.634 Vali Acc: 0.618 Test Loss: 1.634 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.697665452957153
Epoch: 13, Steps: 17 | Train Loss: 0.142 Vali Loss: 2.495 Vali Acc: 0.570 Test Loss: 2.495 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.648781061172485
Epoch: 14, Steps: 17 | Train Loss: 0.281 Vali Loss: 2.042 Vali Acc: 0.601 Test Loss: 2.042 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.1603546142578125
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 2.020 Vali Acc: 0.621 Test Loss: 2.020 Test Acc: 0.621
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.621160409556314
model parameter : 1069250
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.247699975967407
Epoch: 1, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.753 Vali Acc: 0.512 Test Loss: 0.753 Test Acc: 0.512
Validation loss decreased (inf --> -0.511938).  Saving model ...
Epoch: 2 cost time: 4.884563684463501
Epoch: 2, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.852 Vali Acc: 0.543 Test Loss: 0.852 Test Acc: 0.543
Validation loss decreased (-0.511938 --> -0.542654).  Saving model ...
Epoch: 3 cost time: 5.104626655578613
Epoch: 3, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.975 Vali Acc: 0.539 Test Loss: 0.975 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.413675785064697
Epoch: 4, Steps: 17 | Train Loss: 0.403 Vali Loss: 1.025 Vali Acc: 0.560 Test Loss: 1.025 Test Acc: 0.560
Validation loss decreased (-0.542654 --> -0.559717).  Saving model ...
Epoch: 5 cost time: 5.545313835144043
Epoch: 5, Steps: 17 | Train Loss: 0.371 Vali Loss: 1.004 Vali Acc: 0.590 Test Loss: 1.004 Test Acc: 0.590
Validation loss decreased (-0.559717 --> -0.590434).  Saving model ...
Epoch: 6 cost time: 5.415490388870239
Epoch: 6, Steps: 17 | Train Loss: 0.304 Vali Loss: 1.249 Vali Acc: 0.556 Test Loss: 1.249 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.973980903625488
Epoch: 7, Steps: 17 | Train Loss: 0.296 Vali Loss: 1.467 Vali Acc: 0.556 Test Loss: 1.467 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.887044429779053
Epoch: 8, Steps: 17 | Train Loss: 0.224 Vali Loss: 1.472 Vali Acc: 0.543 Test Loss: 1.472 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.921145439147949
Epoch: 9, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.398 Vali Acc: 0.570 Test Loss: 1.398 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.831667184829712
Epoch: 10, Steps: 17 | Train Loss: 0.143 Vali Loss: 1.624 Vali Acc: 0.567 Test Loss: 1.624 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.927261829376221
Epoch: 11, Steps: 17 | Train Loss: 0.168 Vali Loss: 1.932 Vali Acc: 0.567 Test Loss: 1.932 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.891455411911011
Epoch: 12, Steps: 17 | Train Loss: 0.243 Vali Loss: 2.612 Vali Acc: 0.539 Test Loss: 2.612 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.060213804244995
Epoch: 13, Steps: 17 | Train Loss: 0.159 Vali Loss: 2.523 Vali Acc: 0.526 Test Loss: 2.523 Test Acc: 0.526
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.696245908737183
Epoch: 14, Steps: 17 | Train Loss: 0.127 Vali Loss: 2.425 Vali Acc: 0.532 Test Loss: 2.425 Test Acc: 0.532
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.312286138534546
Epoch: 15, Steps: 17 | Train Loss: 0.086 Vali Loss: 2.603 Vali Acc: 0.512 Test Loss: 2.603 Test Acc: 0.512
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.590443686006826
model parameter : 1069250
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.026730060577393
Epoch: 1, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.809 Vali Acc: 0.505 Test Loss: 0.809 Test Acc: 0.505
Validation loss decreased (inf --> -0.505111).  Saving model ...
Epoch: 2 cost time: 5.581115245819092
Epoch: 2, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.696 Vali Acc: 0.556 Test Loss: 0.696 Test Acc: 0.556
Validation loss decreased (-0.505111 --> -0.556307).  Saving model ...
Epoch: 3 cost time: 5.747650861740112
Epoch: 3, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.891 Vali Acc: 0.539 Test Loss: 0.891 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.153905153274536
Epoch: 4, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.956 Vali Acc: 0.529 Test Loss: 0.956 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.806025981903076
Epoch: 5, Steps: 17 | Train Loss: 0.326 Vali Loss: 1.037 Vali Acc: 0.526 Test Loss: 1.037 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.848394155502319
Epoch: 6, Steps: 17 | Train Loss: 0.280 Vali Loss: 1.346 Vali Acc: 0.519 Test Loss: 1.346 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.89692234992981
Epoch: 7, Steps: 17 | Train Loss: 0.257 Vali Loss: 1.840 Vali Acc: 0.522 Test Loss: 1.840 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.773169994354248
Epoch: 8, Steps: 17 | Train Loss: 0.265 Vali Loss: 2.027 Vali Acc: 0.509 Test Loss: 2.027 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.400070428848267
Epoch: 9, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.593 Vali Acc: 0.543 Test Loss: 1.593 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.746601104736328
Epoch: 10, Steps: 17 | Train Loss: 0.172 Vali Loss: 3.063 Vali Acc: 0.509 Test Loss: 3.063 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.592800140380859
Epoch: 11, Steps: 17 | Train Loss: 0.153 Vali Loss: 2.100 Vali Acc: 0.532 Test Loss: 2.100 Test Acc: 0.532
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.111258268356323
Epoch: 12, Steps: 17 | Train Loss: 0.221 Vali Loss: 2.042 Vali Acc: 0.532 Test Loss: 2.042 Test Acc: 0.532
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5563139931740614
model parameter : 1069250
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.981698989868164
Epoch: 1, Steps: 17 | Train Loss: 0.679 Vali Loss: 0.953 Vali Acc: 0.502 Test Loss: 0.953 Test Acc: 0.502
Validation loss decreased (inf --> -0.501697).  Saving model ...
Epoch: 2 cost time: 5.106358766555786
Epoch: 2, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.847 Vali Acc: 0.502 Test Loss: 0.847 Test Acc: 0.502
Validation loss decreased (-0.501697 --> -0.501698).  Saving model ...
Epoch: 3 cost time: 5.050854206085205
Epoch: 3, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.997 Vali Acc: 0.502 Test Loss: 0.997 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.124131679534912
Epoch: 4, Steps: 17 | Train Loss: 0.519 Vali Loss: 1.091 Vali Acc: 0.502 Test Loss: 1.091 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.379299879074097
Epoch: 5, Steps: 17 | Train Loss: 0.501 Vali Loss: 1.019 Vali Acc: 0.502 Test Loss: 1.019 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.1299872398376465
Epoch: 6, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.882 Vali Acc: 0.502 Test Loss: 0.882 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.389650583267212
Epoch: 7, Steps: 17 | Train Loss: 0.467 Vali Loss: 1.280 Vali Acc: 0.502 Test Loss: 1.280 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.515254497528076
Epoch: 8, Steps: 17 | Train Loss: 0.470 Vali Loss: 1.146 Vali Acc: 0.498 Test Loss: 1.146 Test Acc: 0.498
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.575695037841797
Epoch: 9, Steps: 17 | Train Loss: 0.448 Vali Loss: 1.145 Vali Acc: 0.502 Test Loss: 1.145 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.716211795806885
Epoch: 10, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.963 Vali Acc: 0.532 Test Loss: 0.963 Test Acc: 0.532
Validation loss decreased (-0.501698 --> -0.532414).  Saving model ...
Epoch: 11 cost time: 4.828015327453613
Epoch: 11, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.957 Vali Acc: 0.573 Test Loss: 0.957 Test Acc: 0.573
Validation loss decreased (-0.532414 --> -0.573369).  Saving model ...
Epoch: 12 cost time: 5.105916500091553
Epoch: 12, Steps: 17 | Train Loss: 0.510 Vali Loss: 1.169 Vali Acc: 0.546 Test Loss: 1.169 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.009066104888916
Epoch: 13, Steps: 17 | Train Loss: 0.315 Vali Loss: 1.004 Vali Acc: 0.573 Test Loss: 1.004 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.099628448486328
Epoch: 14, Steps: 17 | Train Loss: 0.309 Vali Loss: 2.104 Vali Acc: 0.529 Test Loss: 2.104 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.4942662715911865
Epoch: 15, Steps: 17 | Train Loss: 0.409 Vali Loss: 1.507 Vali Acc: 0.563 Test Loss: 1.507 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.413534641265869
Epoch: 16, Steps: 17 | Train Loss: 0.470 Vali Loss: 1.541 Vali Acc: 0.546 Test Loss: 1.541 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.634902477264404
Epoch: 17, Steps: 17 | Train Loss: 0.305 Vali Loss: 2.251 Vali Acc: 0.546 Test Loss: 2.251 Test Acc: 0.546
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.468106031417847
Epoch: 18, Steps: 17 | Train Loss: 0.460 Vali Loss: 2.687 Vali Acc: 0.532 Test Loss: 2.687 Test Acc: 0.532
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.8344666957855225
Epoch: 19, Steps: 17 | Train Loss: 0.455 Vali Loss: 2.490 Vali Acc: 0.546 Test Loss: 2.490 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.956401348114014
Epoch: 20, Steps: 17 | Train Loss: 0.345 Vali Loss: 2.146 Vali Acc: 0.563 Test Loss: 2.146 Test Acc: 0.563
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.525610685348511
Epoch: 21, Steps: 17 | Train Loss: 0.333 Vali Loss: 3.558 Vali Acc: 0.539 Test Loss: 3.558 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5733788395904437
model parameter : 1069250
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.062011957168579
Epoch: 1, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.741 Vali Acc: 0.498 Test Loss: 0.741 Test Acc: 0.498
Validation loss decreased (inf --> -0.498286).  Saving model ...
Epoch: 2 cost time: 5.331241130828857
Epoch: 2, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.801 Vali Acc: 0.502 Test Loss: 0.801 Test Acc: 0.502
Validation loss decreased (-0.498286 --> -0.501698).  Saving model ...
Epoch: 3 cost time: 5.616734504699707
Epoch: 3, Steps: 17 | Train Loss: 0.593 Vali Loss: 1.148 Vali Acc: 0.502 Test Loss: 1.148 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.431402921676636
Epoch: 4, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.875 Vali Acc: 0.515 Test Loss: 0.875 Test Acc: 0.515
Validation loss decreased (-0.501698 --> -0.515350).  Saving model ...
Epoch: 5 cost time: 5.336519241333008
Epoch: 5, Steps: 17 | Train Loss: 0.601 Vali Loss: 1.077 Vali Acc: 0.502 Test Loss: 1.077 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.2417731285095215
Epoch: 6, Steps: 17 | Train Loss: 0.561 Vali Loss: 2.236 Vali Acc: 0.502 Test Loss: 2.236 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.241724491119385
Epoch: 7, Steps: 17 | Train Loss: 0.519 Vali Loss: 1.566 Vali Acc: 0.502 Test Loss: 1.566 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.178121328353882
Epoch: 8, Steps: 17 | Train Loss: 0.475 Vali Loss: 1.405 Vali Acc: 0.505 Test Loss: 1.405 Test Acc: 0.505
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.221730470657349
Epoch: 9, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.957 Vali Acc: 0.532 Test Loss: 0.957 Test Acc: 0.532
Validation loss decreased (-0.515350 --> -0.532414).  Saving model ...
Epoch: 10 cost time: 5.293381929397583
Epoch: 10, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.938 Vali Acc: 0.553 Test Loss: 0.938 Test Acc: 0.553
Validation loss decreased (-0.532414 --> -0.552892).  Saving model ...
Epoch: 11 cost time: 5.291681528091431
Epoch: 11, Steps: 17 | Train Loss: 0.493 Vali Loss: 1.308 Vali Acc: 0.529 Test Loss: 1.308 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.235030651092529
Epoch: 12, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.817 Vali Acc: 0.587 Test Loss: 0.817 Test Acc: 0.587
Validation loss decreased (-0.552892 --> -0.587023).  Saving model ...
Epoch: 13 cost time: 5.273213148117065
Epoch: 13, Steps: 17 | Train Loss: 0.495 Vali Loss: 1.214 Vali Acc: 0.560 Test Loss: 1.214 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.98643946647644
Epoch: 14, Steps: 17 | Train Loss: 0.422 Vali Loss: 1.498 Vali Acc: 0.560 Test Loss: 1.498 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.536825180053711
Epoch: 15, Steps: 17 | Train Loss: 0.444 Vali Loss: 1.139 Vali Acc: 0.597 Test Loss: 1.139 Test Acc: 0.597
Validation loss decreased (-0.587023 --> -0.597258).  Saving model ...
Epoch: 16 cost time: 5.999434232711792
Epoch: 16, Steps: 17 | Train Loss: 0.446 Vali Loss: 1.717 Vali Acc: 0.560 Test Loss: 1.717 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.502090692520142
Epoch: 17, Steps: 17 | Train Loss: 0.538 Vali Loss: 2.753 Vali Acc: 0.543 Test Loss: 2.753 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.134767293930054
Epoch: 18, Steps: 17 | Train Loss: 0.457 Vali Loss: 2.444 Vali Acc: 0.539 Test Loss: 2.444 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.332316160202026
Epoch: 19, Steps: 17 | Train Loss: 0.541 Vali Loss: 2.928 Vali Acc: 0.536 Test Loss: 2.928 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.0673828125
Epoch: 20, Steps: 17 | Train Loss: 0.585 Vali Loss: 2.131 Vali Acc: 0.577 Test Loss: 2.131 Test Acc: 0.577
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.422193765640259
Epoch: 21, Steps: 17 | Train Loss: 0.470 Vali Loss: 2.612 Vali Acc: 0.590 Test Loss: 2.612 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.407897710800171
Epoch: 22, Steps: 17 | Train Loss: 0.425 Vali Loss: 2.566 Vali Acc: 0.587 Test Loss: 2.566 Test Acc: 0.587
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.557863473892212
Epoch: 23, Steps: 17 | Train Loss: 0.542 Vali Loss: 3.157 Vali Acc: 0.567 Test Loss: 3.157 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.462283134460449
Epoch: 24, Steps: 17 | Train Loss: 0.634 Vali Loss: 2.600 Vali Acc: 0.577 Test Loss: 2.600 Test Acc: 0.577
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.430135250091553
Epoch: 25, Steps: 17 | Train Loss: 0.620 Vali Loss: 4.172 Vali Acc: 0.563 Test Loss: 4.172 Test Acc: 0.563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5972696245733788
model parameter : 1069250
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.626539707183838
Epoch: 1, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.675 Vali Acc: 0.621 Test Loss: 0.675 Test Acc: 0.621
Validation loss decreased (inf --> -0.621154).  Saving model ...
Epoch: 2 cost time: 5.711512088775635
Epoch: 2, Steps: 17 | Train Loss: 0.475 Vali Loss: 1.122 Vali Acc: 0.553 Test Loss: 1.122 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.451246976852417
Epoch: 3, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.894 Vali Acc: 0.631 Test Loss: 0.894 Test Acc: 0.631
Validation loss decreased (-0.621154 --> -0.631390).  Saving model ...
Epoch: 4 cost time: 5.616509675979614
Epoch: 4, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.895 Vali Acc: 0.662 Test Loss: 0.895 Test Acc: 0.662
Validation loss decreased (-0.631390 --> -0.662107).  Saving model ...
Epoch: 5 cost time: 5.606542110443115
Epoch: 5, Steps: 17 | Train Loss: 0.225 Vali Loss: 1.098 Vali Acc: 0.648 Test Loss: 1.098 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.620027780532837
Epoch: 6, Steps: 17 | Train Loss: 0.200 Vali Loss: 1.103 Vali Acc: 0.652 Test Loss: 1.103 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.835127115249634
Epoch: 7, Steps: 17 | Train Loss: 0.262 Vali Loss: 1.877 Vali Acc: 0.587 Test Loss: 1.877 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.617504358291626
Epoch: 8, Steps: 17 | Train Loss: 0.180 Vali Loss: 1.455 Vali Acc: 0.635 Test Loss: 1.455 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.5320539474487305
Epoch: 9, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.672 Vali Acc: 0.614 Test Loss: 1.672 Test Acc: 0.614
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.334809303283691
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.619 Vali Acc: 0.648 Test Loss: 1.619 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.417689323425293
Epoch: 11, Steps: 17 | Train Loss: 0.100 Vali Loss: 3.656 Vali Acc: 0.549 Test Loss: 3.656 Test Acc: 0.549
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.56637167930603
Epoch: 12, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.514 Vali Acc: 0.628 Test Loss: 1.514 Test Acc: 0.628
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.534902334213257
Epoch: 13, Steps: 17 | Train Loss: 0.119 Vali Loss: 2.511 Vali Acc: 0.631 Test Loss: 2.511 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.021805286407471
Epoch: 14, Steps: 17 | Train Loss: 0.040 Vali Loss: 2.211 Vali Acc: 0.655 Test Loss: 2.211 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6621160409556314
model parameter : 676034
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.526401042938232
Epoch: 1, Steps: 17 | Train Loss: 0.669 Vali Loss: 0.683 Vali Acc: 0.597 Test Loss: 0.683 Test Acc: 0.597
Validation loss decreased (inf --> -0.597263).  Saving model ...
Epoch: 2 cost time: 5.387377977371216
Epoch: 2, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.907 Vali Acc: 0.587 Test Loss: 0.907 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.563998699188232
Epoch: 3, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.934 Vali Acc: 0.618 Test Loss: 0.934 Test Acc: 0.618
Validation loss decreased (-0.597263 --> -0.617738).  Saving model ...
Epoch: 4 cost time: 5.6302809715271
Epoch: 4, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.852 Vali Acc: 0.652 Test Loss: 0.852 Test Acc: 0.652
Validation loss decreased (-0.617738 --> -0.651869).  Saving model ...
Epoch: 5 cost time: 6.017557144165039
Epoch: 5, Steps: 17 | Train Loss: 0.222 Vali Loss: 1.298 Vali Acc: 0.614 Test Loss: 1.298 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.4650750160217285
Epoch: 6, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.120 Vali Acc: 0.628 Test Loss: 1.120 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.440698146820068
Epoch: 7, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.258 Vali Acc: 0.652 Test Loss: 1.258 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.7724316120147705
Epoch: 8, Steps: 17 | Train Loss: 0.206 Vali Loss: 2.340 Vali Acc: 0.560 Test Loss: 2.340 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.648661136627197
Epoch: 9, Steps: 17 | Train Loss: 0.139 Vali Loss: 1.419 Vali Acc: 0.638 Test Loss: 1.419 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.558329343795776
Epoch: 10, Steps: 17 | Train Loss: 0.124 Vali Loss: 2.113 Vali Acc: 0.628 Test Loss: 2.113 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.721116304397583
Epoch: 11, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.969 Vali Acc: 0.638 Test Loss: 1.969 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.886172771453857
Epoch: 12, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.415 Vali Acc: 0.666 Test Loss: 1.415 Test Acc: 0.666
Validation loss decreased (-0.651869 --> -0.665515).  Saving model ...
Epoch: 13 cost time: 5.531398057937622
Epoch: 13, Steps: 17 | Train Loss: 0.217 Vali Loss: 2.280 Vali Acc: 0.618 Test Loss: 2.280 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.634475231170654
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.381 Vali Acc: 0.618 Test Loss: 2.381 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.426434278488159
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.746 Vali Acc: 0.648 Test Loss: 1.746 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.541729688644409
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.576 Vali Acc: 0.621 Test Loss: 2.576 Test Acc: 0.621
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.777808904647827
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 2.121 Vali Acc: 0.652 Test Loss: 2.121 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.474268436431885
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 3.768 Vali Acc: 0.601 Test Loss: 3.768 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.176259517669678
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.277 Vali Acc: 0.614 Test Loss: 2.277 Test Acc: 0.614
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.399716854095459
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 2.624 Vali Acc: 0.631 Test Loss: 2.624 Test Acc: 0.631
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.992186546325684
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 3.056 Vali Acc: 0.625 Test Loss: 3.056 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.428337097167969
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 3.582 Vali Acc: 0.601 Test Loss: 3.582 Test Acc: 0.601
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6655290102389079
model parameter : 676034
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.655690670013428
Epoch: 1, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.719 Vali Acc: 0.536 Test Loss: 0.719 Test Acc: 0.536
Validation loss decreased (inf --> -0.535829).  Saving model ...
Epoch: 2 cost time: 5.735000133514404
Epoch: 2, Steps: 17 | Train Loss: 0.504 Vali Loss: 1.048 Vali Acc: 0.546 Test Loss: 1.048 Test Acc: 0.546
Validation loss decreased (-0.535829 --> -0.546065).  Saving model ...
Epoch: 3 cost time: 5.277143239974976
Epoch: 3, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.839 Vali Acc: 0.608 Test Loss: 0.839 Test Acc: 0.608
Validation loss decreased (-0.546065 --> -0.607500).  Saving model ...
Epoch: 4 cost time: 4.560990810394287
Epoch: 4, Steps: 17 | Train Loss: 0.350 Vali Loss: 1.240 Vali Acc: 0.594 Test Loss: 1.240 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.926217555999756
Epoch: 5, Steps: 17 | Train Loss: 0.257 Vali Loss: 1.507 Vali Acc: 0.584 Test Loss: 1.507 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.922051668167114
Epoch: 6, Steps: 17 | Train Loss: 0.281 Vali Loss: 1.028 Vali Acc: 0.635 Test Loss: 1.028 Test Acc: 0.635
Validation loss decreased (-0.607500 --> -0.634802).  Saving model ...
Epoch: 7 cost time: 5.19511079788208
Epoch: 7, Steps: 17 | Train Loss: 0.288 Vali Loss: 2.069 Vali Acc: 0.567 Test Loss: 2.069 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.159291982650757
Epoch: 8, Steps: 17 | Train Loss: 0.212 Vali Loss: 1.384 Vali Acc: 0.625 Test Loss: 1.384 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.754132509231567
Epoch: 9, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.654 Vali Acc: 0.611 Test Loss: 1.654 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.286463975906372
Epoch: 10, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.794 Vali Acc: 0.618 Test Loss: 1.794 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.366065979003906
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 2.239 Vali Acc: 0.608 Test Loss: 2.239 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.336206436157227
Epoch: 12, Steps: 17 | Train Loss: 0.061 Vali Loss: 2.088 Vali Acc: 0.648 Test Loss: 2.088 Test Acc: 0.648
Validation loss decreased (-0.634802 --> -0.648443).  Saving model ...
Epoch: 13 cost time: 5.2562034130096436
Epoch: 13, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.752 Vali Acc: 0.638 Test Loss: 1.752 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.490545034408569
Epoch: 14, Steps: 17 | Train Loss: 0.085 Vali Loss: 2.609 Vali Acc: 0.618 Test Loss: 2.609 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.2627763748168945
Epoch: 15, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.189 Vali Acc: 0.625 Test Loss: 2.189 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.131950378417969
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.376 Vali Acc: 0.631 Test Loss: 2.376 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.102386951446533
Epoch: 17, Steps: 17 | Train Loss: 0.032 Vali Loss: 2.942 Vali Acc: 0.614 Test Loss: 2.942 Test Acc: 0.614
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.572320222854614
Epoch: 18, Steps: 17 | Train Loss: 0.068 Vali Loss: 2.533 Vali Acc: 0.638 Test Loss: 2.533 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.399226427078247
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.637 Vali Acc: 0.601 Test Loss: 2.637 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.278373956680298
Epoch: 20, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.829 Vali Acc: 0.611 Test Loss: 2.829 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.737975358963013
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 4.023 Vali Acc: 0.584 Test Loss: 4.023 Test Acc: 0.584
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.5285964012146
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 2.838 Vali Acc: 0.631 Test Loss: 2.838 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6484641638225256
model parameter : 676034
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.23529314994812
Epoch: 1, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.697 Vali Acc: 0.536 Test Loss: 0.697 Test Acc: 0.536
Validation loss decreased (inf --> -0.535829).  Saving model ...
Epoch: 2 cost time: 4.946631908416748
Epoch: 2, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.829 Vali Acc: 0.590 Test Loss: 0.829 Test Acc: 0.590
Validation loss decreased (-0.535829 --> -0.590435).  Saving model ...
Epoch: 3 cost time: 5.460917234420776
Epoch: 3, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.798 Vali Acc: 0.580 Test Loss: 0.798 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.094349145889282
Epoch: 4, Steps: 17 | Train Loss: 0.352 Vali Loss: 1.729 Vali Acc: 0.532 Test Loss: 1.729 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.036730051040649
Epoch: 5, Steps: 17 | Train Loss: 0.309 Vali Loss: 1.275 Vali Acc: 0.608 Test Loss: 1.275 Test Acc: 0.608
Validation loss decreased (-0.590435 --> -0.607496).  Saving model ...
Epoch: 6 cost time: 5.55613899230957
Epoch: 6, Steps: 17 | Train Loss: 0.173 Vali Loss: 1.133 Vali Acc: 0.621 Test Loss: 1.133 Test Acc: 0.621
Validation loss decreased (-0.607496 --> -0.621149).  Saving model ...
Epoch: 7 cost time: 5.407516717910767
Epoch: 7, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.178 Vali Acc: 0.642 Test Loss: 1.178 Test Acc: 0.642
Validation loss decreased (-0.621149 --> -0.641626).  Saving model ...
Epoch: 8 cost time: 5.210372447967529
Epoch: 8, Steps: 17 | Train Loss: 0.206 Vali Loss: 2.723 Vali Acc: 0.563 Test Loss: 2.723 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.911451101303101
Epoch: 9, Steps: 17 | Train Loss: 0.145 Vali Loss: 2.006 Vali Acc: 0.608 Test Loss: 2.006 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.423029184341431
Epoch: 10, Steps: 17 | Train Loss: 0.057 Vali Loss: 2.373 Vali Acc: 0.549 Test Loss: 2.373 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.12062668800354
Epoch: 11, Steps: 17 | Train Loss: 0.062 Vali Loss: 2.535 Vali Acc: 0.587 Test Loss: 2.535 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.351880788803101
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 2.463 Vali Acc: 0.601 Test Loss: 2.463 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.748860836029053
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 2.111 Vali Acc: 0.608 Test Loss: 2.111 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.963937997817993
Epoch: 14, Steps: 17 | Train Loss: 0.039 Vali Loss: 2.773 Vali Acc: 0.577 Test Loss: 2.773 Test Acc: 0.577
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.888920783996582
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 3.120 Vali Acc: 0.584 Test Loss: 3.120 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.5780556201934814
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.455 Vali Acc: 0.618 Test Loss: 2.455 Test Acc: 0.618
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.971830129623413
Epoch: 17, Steps: 17 | Train Loss: 0.051 Vali Loss: 3.940 Vali Acc: 0.601 Test Loss: 3.940 Test Acc: 0.601
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 676034
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.450141191482544
Epoch: 1, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.695 Vali Acc: 0.563 Test Loss: 0.695 Test Acc: 0.563
Validation loss decreased (inf --> -0.563133).  Saving model ...
Epoch: 2 cost time: 5.4351561069488525
Epoch: 2, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.890 Vali Acc: 0.587 Test Loss: 0.890 Test Acc: 0.587
Validation loss decreased (-0.563133 --> -0.587022).  Saving model ...
Epoch: 3 cost time: 5.082553386688232
Epoch: 3, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.771 Vali Acc: 0.625 Test Loss: 0.771 Test Acc: 0.625
Validation loss decreased (-0.587022 --> -0.624566).  Saving model ...
Epoch: 4 cost time: 5.077871084213257
Epoch: 4, Steps: 17 | Train Loss: 0.417 Vali Loss: 1.515 Vali Acc: 0.556 Test Loss: 1.515 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.240708827972412
Epoch: 5, Steps: 17 | Train Loss: 0.273 Vali Loss: 1.355 Vali Acc: 0.597 Test Loss: 1.355 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.848900556564331
Epoch: 6, Steps: 17 | Train Loss: 0.217 Vali Loss: 1.355 Vali Acc: 0.625 Test Loss: 1.355 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.865753412246704
Epoch: 7, Steps: 17 | Train Loss: 0.147 Vali Loss: 1.190 Vali Acc: 0.652 Test Loss: 1.190 Test Acc: 0.652
Validation loss decreased (-0.624566 --> -0.651865).  Saving model ...
Epoch: 8 cost time: 5.007014274597168
Epoch: 8, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.848 Vali Acc: 0.597 Test Loss: 1.848 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.206211805343628
Epoch: 9, Steps: 17 | Train Loss: 0.069 Vali Loss: 2.124 Vali Acc: 0.590 Test Loss: 2.124 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.225511312484741
Epoch: 10, Steps: 17 | Train Loss: 0.074 Vali Loss: 2.048 Vali Acc: 0.601 Test Loss: 2.048 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.1925177574157715
Epoch: 11, Steps: 17 | Train Loss: 0.066 Vali Loss: 2.282 Vali Acc: 0.601 Test Loss: 2.282 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.829609394073486
Epoch: 12, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.860 Vali Acc: 0.642 Test Loss: 1.860 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.2902514934539795
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.934 Vali Acc: 0.628 Test Loss: 1.934 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.183119058609009
Epoch: 14, Steps: 17 | Train Loss: 0.049 Vali Loss: 3.352 Vali Acc: 0.590 Test Loss: 3.352 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.7932353019714355
Epoch: 15, Steps: 17 | Train Loss: 0.049 Vali Loss: 3.992 Vali Acc: 0.563 Test Loss: 3.992 Test Acc: 0.563
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.660689353942871
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.618 Vali Acc: 0.628 Test Loss: 2.618 Test Acc: 0.628
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.882114410400391
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 2.443 Vali Acc: 0.625 Test Loss: 2.443 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6518771331058021
model parameter : 676034
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.361088514328003
Epoch: 1, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.683 Vali Acc: 0.563 Test Loss: 0.683 Test Acc: 0.563
Validation loss decreased (inf --> -0.563133).  Saving model ...
Epoch: 2 cost time: 5.190420627593994
Epoch: 2, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.695 Vali Acc: 0.614 Test Loss: 0.695 Test Acc: 0.614
Validation loss decreased (-0.563133 --> -0.614328).  Saving model ...
Epoch: 3 cost time: 5.567838668823242
Epoch: 3, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.840 Vali Acc: 0.556 Test Loss: 0.840 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.49150013923645
Epoch: 4, Steps: 17 | Train Loss: 0.390 Vali Loss: 1.574 Vali Acc: 0.512 Test Loss: 1.574 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.353941202163696
Epoch: 5, Steps: 17 | Train Loss: 0.360 Vali Loss: 1.092 Vali Acc: 0.594 Test Loss: 1.092 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.014432668685913
Epoch: 6, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.988 Vali Acc: 0.614 Test Loss: 0.988 Test Acc: 0.614
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.675222158432007
Epoch: 7, Steps: 17 | Train Loss: 0.226 Vali Loss: 1.190 Vali Acc: 0.573 Test Loss: 1.190 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.440309762954712
Epoch: 8, Steps: 17 | Train Loss: 0.215 Vali Loss: 1.397 Vali Acc: 0.608 Test Loss: 1.397 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.554872035980225
Epoch: 9, Steps: 17 | Train Loss: 0.145 Vali Loss: 1.338 Vali Acc: 0.601 Test Loss: 1.338 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.51798152923584
Epoch: 10, Steps: 17 | Train Loss: 0.135 Vali Loss: 2.358 Vali Acc: 0.543 Test Loss: 2.358 Test Acc: 0.543
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.8119659423828125
Epoch: 11, Steps: 17 | Train Loss: 0.133 Vali Loss: 2.603 Vali Acc: 0.553 Test Loss: 2.603 Test Acc: 0.553
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.840620756149292
Epoch: 12, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.769 Vali Acc: 0.625 Test Loss: 1.769 Test Acc: 0.625
Validation loss decreased (-0.614328 --> -0.624556).  Saving model ...
Epoch: 13 cost time: 5.90168833732605
Epoch: 13, Steps: 17 | Train Loss: 0.265 Vali Loss: 1.780 Vali Acc: 0.604 Test Loss: 1.780 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.337177991867065
Epoch: 14, Steps: 17 | Train Loss: 0.069 Vali Loss: 2.600 Vali Acc: 0.590 Test Loss: 2.600 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.4206178188323975
Epoch: 15, Steps: 17 | Train Loss: 0.098 Vali Loss: 2.723 Vali Acc: 0.573 Test Loss: 2.723 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.844533443450928
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 2.316 Vali Acc: 0.614 Test Loss: 2.316 Test Acc: 0.614
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.797182083129883
Epoch: 17, Steps: 17 | Train Loss: 0.086 Vali Loss: 3.380 Vali Acc: 0.546 Test Loss: 3.380 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.473132610321045
Epoch: 18, Steps: 17 | Train Loss: 0.074 Vali Loss: 2.979 Vali Acc: 0.567 Test Loss: 2.979 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.004130601882935
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 3.738 Vali Acc: 0.543 Test Loss: 3.738 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.287449836730957
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.939 Vali Acc: 0.580 Test Loss: 2.939 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.298091888427734
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.898 Vali Acc: 0.604 Test Loss: 2.898 Test Acc: 0.604
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.131033897399902
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 4.421 Vali Acc: 0.563 Test Loss: 4.421 Test Acc: 0.563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 676034
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.4176859855651855
Epoch: 1, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.739 Vali Acc: 0.546 Test Loss: 0.739 Test Acc: 0.546
Validation loss decreased (inf --> -0.546068).  Saving model ...
Epoch: 2 cost time: 5.046562433242798
Epoch: 2, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.790 Vali Acc: 0.546 Test Loss: 0.790 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.164008378982544
Epoch: 3, Steps: 17 | Train Loss: 0.429 Vali Loss: 1.010 Vali Acc: 0.536 Test Loss: 1.010 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.289581060409546
Epoch: 4, Steps: 17 | Train Loss: 0.401 Vali Loss: 1.352 Vali Acc: 0.553 Test Loss: 1.352 Test Acc: 0.553
Validation loss decreased (-0.546068 --> -0.552888).  Saving model ...
Epoch: 5 cost time: 4.763557434082031
Epoch: 5, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.993 Vali Acc: 0.570 Test Loss: 0.993 Test Acc: 0.570
Validation loss decreased (-0.552888 --> -0.569956).  Saving model ...
Epoch: 6 cost time: 4.909278631210327
Epoch: 6, Steps: 17 | Train Loss: 0.311 Vali Loss: 1.345 Vali Acc: 0.563 Test Loss: 1.345 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.861703872680664
Epoch: 7, Steps: 17 | Train Loss: 0.272 Vali Loss: 1.261 Vali Acc: 0.563 Test Loss: 1.261 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.648548603057861
Epoch: 8, Steps: 17 | Train Loss: 0.233 Vali Loss: 1.538 Vali Acc: 0.549 Test Loss: 1.538 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.767821788787842
Epoch: 9, Steps: 17 | Train Loss: 0.199 Vali Loss: 1.396 Vali Acc: 0.560 Test Loss: 1.396 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.280269145965576
Epoch: 10, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.770 Vali Acc: 0.546 Test Loss: 1.770 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.210615634918213
Epoch: 11, Steps: 17 | Train Loss: 0.135 Vali Loss: 1.763 Vali Acc: 0.563 Test Loss: 1.763 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.796205282211304
Epoch: 12, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.821 Vali Acc: 0.590 Test Loss: 1.821 Test Acc: 0.590
Validation loss decreased (-0.569956 --> -0.590425).  Saving model ...
Epoch: 13 cost time: 5.553804874420166
Epoch: 13, Steps: 17 | Train Loss: 0.182 Vali Loss: 2.148 Vali Acc: 0.573 Test Loss: 2.148 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.331067800521851
Epoch: 14, Steps: 17 | Train Loss: 0.084 Vali Loss: 2.590 Vali Acc: 0.539 Test Loss: 2.590 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.22113561630249
Epoch: 15, Steps: 17 | Train Loss: 0.119 Vali Loss: 2.633 Vali Acc: 0.522 Test Loss: 2.633 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.252658128738403
Epoch: 16, Steps: 17 | Train Loss: 0.082 Vali Loss: 3.009 Vali Acc: 0.522 Test Loss: 3.009 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.995342969894409
Epoch: 17, Steps: 17 | Train Loss: 0.064 Vali Loss: 2.564 Vali Acc: 0.549 Test Loss: 2.564 Test Acc: 0.549
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.121435165405273
Epoch: 18, Steps: 17 | Train Loss: 0.164 Vali Loss: 3.046 Vali Acc: 0.556 Test Loss: 3.046 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.624339580535889
Epoch: 19, Steps: 17 | Train Loss: 0.047 Vali Loss: 2.585 Vali Acc: 0.601 Test Loss: 2.585 Test Acc: 0.601
Validation loss decreased (-0.590425 --> -0.600657).  Saving model ...
Epoch: 20 cost time: 5.317384243011475
Epoch: 20, Steps: 17 | Train Loss: 0.076 Vali Loss: 3.226 Vali Acc: 0.560 Test Loss: 3.226 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.239992618560791
Epoch: 21, Steps: 17 | Train Loss: 0.045 Vali Loss: 2.927 Vali Acc: 0.563 Test Loss: 2.927 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.75551700592041
Epoch: 22, Steps: 17 | Train Loss: 0.057 Vali Loss: 3.771 Vali Acc: 0.532 Test Loss: 3.771 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.618466138839722
Epoch: 23, Steps: 17 | Train Loss: 0.048 Vali Loss: 3.087 Vali Acc: 0.580 Test Loss: 3.087 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.673490285873413
Epoch: 24, Steps: 17 | Train Loss: 0.045 Vali Loss: 3.360 Vali Acc: 0.567 Test Loss: 3.360 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.943071365356445
Epoch: 25, Steps: 17 | Train Loss: 0.046 Vali Loss: 3.870 Vali Acc: 0.553 Test Loss: 3.870 Test Acc: 0.553
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.109316825866699
Epoch: 26, Steps: 17 | Train Loss: 0.060 Vali Loss: 3.835 Vali Acc: 0.543 Test Loss: 3.835 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.210221290588379
Epoch: 27, Steps: 17 | Train Loss: 0.259 Vali Loss: 4.232 Vali Acc: 0.543 Test Loss: 4.232 Test Acc: 0.543
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.229745388031006
Epoch: 28, Steps: 17 | Train Loss: 0.100 Vali Loss: 5.006 Vali Acc: 0.543 Test Loss: 5.006 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.634113311767578
Epoch: 29, Steps: 17 | Train Loss: 0.074 Vali Loss: 5.875 Vali Acc: 0.549 Test Loss: 5.875 Test Acc: 0.549
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6006825938566553
model parameter : 676034
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.460932731628418
Epoch: 1, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.727 Vali Acc: 0.522 Test Loss: 0.727 Test Acc: 0.522
Validation loss decreased (inf --> -0.522177).  Saving model ...
Epoch: 2 cost time: 6.0085883140563965
Epoch: 2, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.719 Vali Acc: 0.529 Test Loss: 0.719 Test Acc: 0.529
Validation loss decreased (-0.522177 --> -0.529003).  Saving model ...
Epoch: 3 cost time: 5.143723011016846
Epoch: 3, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.969 Vali Acc: 0.536 Test Loss: 0.969 Test Acc: 0.536
Validation loss decreased (-0.529003 --> -0.535826).  Saving model ...
Epoch: 4 cost time: 5.527533054351807
Epoch: 4, Steps: 17 | Train Loss: 0.376 Vali Loss: 1.231 Vali Acc: 0.532 Test Loss: 1.231 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.85474705696106
Epoch: 5, Steps: 17 | Train Loss: 0.396 Vali Loss: 1.107 Vali Acc: 0.515 Test Loss: 1.107 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.241095781326294
Epoch: 6, Steps: 17 | Train Loss: 0.313 Vali Loss: 1.135 Vali Acc: 0.536 Test Loss: 1.135 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.0067009925842285
Epoch: 7, Steps: 17 | Train Loss: 0.278 Vali Loss: 1.252 Vali Acc: 0.522 Test Loss: 1.252 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.942952394485474
Epoch: 8, Steps: 17 | Train Loss: 0.249 Vali Loss: 2.240 Vali Acc: 0.502 Test Loss: 2.240 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.783049583435059
Epoch: 9, Steps: 17 | Train Loss: 0.243 Vali Loss: 2.043 Vali Acc: 0.495 Test Loss: 2.043 Test Acc: 0.495
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.7114667892456055
Epoch: 10, Steps: 17 | Train Loss: 0.190 Vali Loss: 2.428 Vali Acc: 0.522 Test Loss: 2.428 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.711150646209717
Epoch: 11, Steps: 17 | Train Loss: 0.162 Vali Loss: 2.484 Vali Acc: 0.529 Test Loss: 2.484 Test Acc: 0.529
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.652434825897217
Epoch: 12, Steps: 17 | Train Loss: 0.266 Vali Loss: 1.910 Vali Acc: 0.553 Test Loss: 1.910 Test Acc: 0.553
Validation loss decreased (-0.535826 --> -0.552882).  Saving model ...
Epoch: 13 cost time: 5.693972826004028
Epoch: 13, Steps: 17 | Train Loss: 0.313 Vali Loss: 2.299 Vali Acc: 0.519 Test Loss: 2.299 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.6268227100372314
Epoch: 14, Steps: 17 | Train Loss: 0.142 Vali Loss: 2.276 Vali Acc: 0.546 Test Loss: 2.276 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.376805067062378
Epoch: 15, Steps: 17 | Train Loss: 0.128 Vali Loss: 3.092 Vali Acc: 0.515 Test Loss: 3.092 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.923909425735474
Epoch: 16, Steps: 17 | Train Loss: 0.083 Vali Loss: 2.783 Vali Acc: 0.509 Test Loss: 2.783 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.3023035526275635
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 3.336 Vali Acc: 0.522 Test Loss: 3.336 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.46555757522583
Epoch: 18, Steps: 17 | Train Loss: 0.085 Vali Loss: 3.381 Vali Acc: 0.532 Test Loss: 3.381 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.353684186935425
Epoch: 19, Steps: 17 | Train Loss: 0.084 Vali Loss: 3.024 Vali Acc: 0.519 Test Loss: 3.024 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.580842733383179
Epoch: 20, Steps: 17 | Train Loss: 0.057 Vali Loss: 3.201 Vali Acc: 0.536 Test Loss: 3.201 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.386257886886597
Epoch: 21, Steps: 17 | Train Loss: 0.085 Vali Loss: 3.316 Vali Acc: 0.543 Test Loss: 3.316 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.6461501121521
Epoch: 22, Steps: 17 | Train Loss: 0.112 Vali Loss: 3.728 Vali Acc: 0.529 Test Loss: 3.728 Test Acc: 0.529
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.552901023890785
model parameter : 676034
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.861698150634766
Epoch: 1, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.818 Vali Acc: 0.502 Test Loss: 0.818 Test Acc: 0.502
Validation loss decreased (inf --> -0.501698).  Saving model ...
Epoch: 2 cost time: 5.384725093841553
Epoch: 2, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.992 Vali Acc: 0.502 Test Loss: 0.992 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.993082523345947
Epoch: 3, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.992 Vali Acc: 0.502 Test Loss: 0.992 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.918114423751831
Epoch: 4, Steps: 17 | Train Loss: 0.582 Vali Loss: 1.080 Vali Acc: 0.502 Test Loss: 1.080 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.012971639633179
Epoch: 5, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.853 Vali Acc: 0.502 Test Loss: 0.853 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.2527196407318115
Epoch: 6, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.663 Vali Acc: 0.611 Test Loss: 0.663 Test Acc: 0.611
Validation loss decreased (-0.501698 --> -0.610915).  Saving model ...
Epoch: 7 cost time: 5.347208499908447
Epoch: 7, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.687 Vali Acc: 0.594 Test Loss: 0.687 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.46799111366272
Epoch: 8, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.655 Vali Acc: 0.631 Test Loss: 0.655 Test Acc: 0.631
Validation loss decreased (-0.610915 --> -0.631393).  Saving model ...
Epoch: 9 cost time: 5.4921135902404785
Epoch: 9, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.754 Vali Acc: 0.563 Test Loss: 0.754 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.678758382797241
Epoch: 10, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.871 Vali Acc: 0.546 Test Loss: 0.871 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.438496351242065
Epoch: 11, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.904 Vali Acc: 0.577 Test Loss: 0.904 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.482515096664429
Epoch: 12, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.977 Vali Acc: 0.567 Test Loss: 0.977 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.489927530288696
Epoch: 13, Steps: 17 | Train Loss: 0.272 Vali Loss: 1.009 Vali Acc: 0.563 Test Loss: 1.009 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.4487245082855225
Epoch: 14, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.941 Vali Acc: 0.570 Test Loss: 0.941 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.370326995849609
Epoch: 15, Steps: 17 | Train Loss: 0.257 Vali Loss: 1.072 Vali Acc: 0.567 Test Loss: 1.072 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.333006858825684
Epoch: 16, Steps: 17 | Train Loss: 0.238 Vali Loss: 1.032 Vali Acc: 0.597 Test Loss: 1.032 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.007601737976074
Epoch: 17, Steps: 17 | Train Loss: 0.203 Vali Loss: 1.437 Vali Acc: 0.543 Test Loss: 1.437 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.2725441455841064
Epoch: 18, Steps: 17 | Train Loss: 0.329 Vali Loss: 1.299 Vali Acc: 0.580 Test Loss: 1.299 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6313993174061433
model parameter : 676034
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.270587921142578
Epoch: 1, Steps: 17 | Train Loss: 0.653 Vali Loss: 0.769 Vali Acc: 0.491 Test Loss: 0.769 Test Acc: 0.491
Validation loss decreased (inf --> -0.491460).  Saving model ...
Epoch: 2 cost time: 5.592655658721924
Epoch: 2, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.987 Vali Acc: 0.502 Test Loss: 0.987 Test Acc: 0.502
Validation loss decreased (-0.491460 --> -0.501697).  Saving model ...
Epoch: 3 cost time: 5.277578830718994
Epoch: 3, Steps: 17 | Train Loss: 0.568 Vali Loss: 1.330 Vali Acc: 0.502 Test Loss: 1.330 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.5243189334869385
Epoch: 4, Steps: 17 | Train Loss: 0.544 Vali Loss: 1.464 Vali Acc: 0.502 Test Loss: 1.464 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.982115745544434
Epoch: 5, Steps: 17 | Train Loss: 0.525 Vali Loss: 1.199 Vali Acc: 0.502 Test Loss: 1.199 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.935791969299316
Epoch: 6, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.903 Vali Acc: 0.512 Test Loss: 0.903 Test Acc: 0.512
Validation loss decreased (-0.501697 --> -0.511936).  Saving model ...
Epoch: 7 cost time: 4.99086332321167
Epoch: 7, Steps: 17 | Train Loss: 0.487 Vali Loss: 1.253 Vali Acc: 0.502 Test Loss: 1.253 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.346860408782959
Epoch: 8, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.964 Vali Acc: 0.522 Test Loss: 0.964 Test Acc: 0.522
Validation loss decreased (-0.511936 --> -0.522175).  Saving model ...
Epoch: 9 cost time: 5.474206209182739
Epoch: 9, Steps: 17 | Train Loss: 0.454 Vali Loss: 1.424 Vali Acc: 0.505 Test Loss: 1.424 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.4998064041137695
Epoch: 10, Steps: 17 | Train Loss: 0.389 Vali Loss: 1.921 Vali Acc: 0.502 Test Loss: 1.921 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.01730751991272
Epoch: 11, Steps: 17 | Train Loss: 0.418 Vali Loss: 1.531 Vali Acc: 0.529 Test Loss: 1.531 Test Acc: 0.529
Validation loss decreased (-0.522175 --> -0.528995).  Saving model ...
Epoch: 12 cost time: 5.330538034439087
Epoch: 12, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.856 Vali Acc: 0.584 Test Loss: 0.856 Test Acc: 0.584
Validation loss decreased (-0.528995 --> -0.583609).  Saving model ...
Epoch: 13 cost time: 5.550678968429565
Epoch: 13, Steps: 17 | Train Loss: 0.474 Vali Loss: 1.133 Vali Acc: 0.556 Test Loss: 1.133 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.0137364864349365
Epoch: 14, Steps: 17 | Train Loss: 0.361 Vali Loss: 1.831 Vali Acc: 0.556 Test Loss: 1.831 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.4392900466918945
Epoch: 15, Steps: 17 | Train Loss: 0.411 Vali Loss: 1.278 Vali Acc: 0.594 Test Loss: 1.278 Test Acc: 0.594
Validation loss decreased (-0.583609 --> -0.593844).  Saving model ...
Epoch: 16 cost time: 5.209745168685913
Epoch: 16, Steps: 17 | Train Loss: 0.440 Vali Loss: 1.924 Vali Acc: 0.549 Test Loss: 1.924 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.333304166793823
Epoch: 17, Steps: 17 | Train Loss: 0.333 Vali Loss: 1.402 Vali Acc: 0.614 Test Loss: 1.402 Test Acc: 0.614
Validation loss decreased (-0.593844 --> -0.614320).  Saving model ...
Epoch: 18 cost time: 5.748751401901245
Epoch: 18, Steps: 17 | Train Loss: 0.396 Vali Loss: 1.625 Vali Acc: 0.594 Test Loss: 1.625 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.207173585891724
Epoch: 19, Steps: 17 | Train Loss: 0.504 Vali Loss: 1.535 Vali Acc: 0.560 Test Loss: 1.535 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.208625316619873
Epoch: 20, Steps: 17 | Train Loss: 0.359 Vali Loss: 2.371 Vali Acc: 0.567 Test Loss: 2.371 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.484738349914551
Epoch: 21, Steps: 17 | Train Loss: 0.389 Vali Loss: 2.073 Vali Acc: 0.587 Test Loss: 2.073 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.884620666503906
Epoch: 22, Steps: 17 | Train Loss: 0.354 Vali Loss: 2.211 Vali Acc: 0.590 Test Loss: 2.211 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.105253458023071
Epoch: 23, Steps: 17 | Train Loss: 0.399 Vali Loss: 2.360 Vali Acc: 0.611 Test Loss: 2.360 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.269739151000977
Epoch: 24, Steps: 17 | Train Loss: 0.399 Vali Loss: 2.332 Vali Acc: 0.594 Test Loss: 2.332 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.192381143569946
Epoch: 25, Steps: 17 | Train Loss: 0.461 Vali Loss: 2.124 Vali Acc: 0.584 Test Loss: 2.124 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.174851179122925
Epoch: 26, Steps: 17 | Train Loss: 0.343 Vali Loss: 2.514 Vali Acc: 0.573 Test Loss: 2.514 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.398571968078613
Epoch: 27, Steps: 17 | Train Loss: 0.222 Vali Loss: 2.668 Vali Acc: 0.611 Test Loss: 2.668 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6143344709897611
model parameter : 676034
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.779812812805176
Epoch: 1, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.628 Vali Acc: 0.655 Test Loss: 0.628 Test Acc: 0.655
Validation loss decreased (inf --> -0.655284).  Saving model ...
Epoch: 2 cost time: 5.441227674484253
Epoch: 2, Steps: 17 | Train Loss: 0.530 Vali Loss: 1.063 Vali Acc: 0.556 Test Loss: 1.063 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.159231901168823
Epoch: 3, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.706 Vali Acc: 0.679 Test Loss: 0.706 Test Acc: 0.679
Validation loss decreased (-0.655284 --> -0.679174).  Saving model ...
Epoch: 4 cost time: 5.89592432975769
Epoch: 4, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.821 Vali Acc: 0.655 Test Loss: 0.821 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.440108060836792
Epoch: 5, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.932 Vali Acc: 0.652 Test Loss: 0.932 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.395740985870361
Epoch: 6, Steps: 17 | Train Loss: 0.213 Vali Loss: 1.044 Vali Acc: 0.645 Test Loss: 1.044 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.450457334518433
Epoch: 7, Steps: 17 | Train Loss: 0.141 Vali Loss: 1.679 Vali Acc: 0.601 Test Loss: 1.679 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.176415205001831
Epoch: 8, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.018 Vali Acc: 0.672 Test Loss: 1.018 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.196491479873657
Epoch: 9, Steps: 17 | Train Loss: 0.089 Vali Loss: 2.212 Vali Acc: 0.597 Test Loss: 2.212 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.483413219451904
Epoch: 10, Steps: 17 | Train Loss: 0.232 Vali Loss: 1.437 Vali Acc: 0.676 Test Loss: 1.437 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.369619131088257
Epoch: 11, Steps: 17 | Train Loss: 0.091 Vali Loss: 2.133 Vali Acc: 0.628 Test Loss: 2.133 Test Acc: 0.628
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.258409261703491
Epoch: 12, Steps: 17 | Train Loss: 0.078 Vali Loss: 2.673 Vali Acc: 0.604 Test Loss: 2.673 Test Acc: 0.604
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.4611122608184814
Epoch: 13, Steps: 17 | Train Loss: 0.076 Vali Loss: 2.227 Vali Acc: 0.642 Test Loss: 2.227 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6791808873720137
model parameter : 479426
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.588415145874023
Epoch: 1, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.635 Vali Acc: 0.625 Test Loss: 0.635 Test Acc: 0.625
Validation loss decreased (inf --> -0.624567).  Saving model ...
Epoch: 2 cost time: 5.497573137283325
Epoch: 2, Steps: 17 | Train Loss: 0.535 Vali Loss: 1.164 Vali Acc: 0.553 Test Loss: 1.164 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.783995628356934
Epoch: 3, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.633 Vali Acc: 0.652 Test Loss: 0.633 Test Acc: 0.652
Validation loss decreased (-0.624567 --> -0.651871).  Saving model ...
Epoch: 4 cost time: 4.923925161361694
Epoch: 4, Steps: 17 | Train Loss: 0.533 Vali Loss: 1.369 Vali Acc: 0.577 Test Loss: 1.369 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.99284291267395
Epoch: 5, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.877 Vali Acc: 0.638 Test Loss: 0.877 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.999595403671265
Epoch: 6, Steps: 17 | Train Loss: 0.328 Vali Loss: 1.353 Vali Acc: 0.621 Test Loss: 1.353 Test Acc: 0.621
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.926785945892334
Epoch: 7, Steps: 17 | Train Loss: 0.153 Vali Loss: 1.395 Vali Acc: 0.621 Test Loss: 1.395 Test Acc: 0.621
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.1172075271606445
Epoch: 8, Steps: 17 | Train Loss: 0.126 Vali Loss: 1.071 Vali Acc: 0.659 Test Loss: 1.071 Test Acc: 0.659
Validation loss decreased (-0.651871 --> -0.658692).  Saving model ...
Epoch: 9 cost time: 5.316789150238037
Epoch: 9, Steps: 17 | Train Loss: 0.064 Vali Loss: 2.007 Vali Acc: 0.587 Test Loss: 2.007 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.557874917984009
Epoch: 10, Steps: 17 | Train Loss: 0.084 Vali Loss: 3.466 Vali Acc: 0.539 Test Loss: 3.466 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.3480224609375
Epoch: 11, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.646 Vali Acc: 0.628 Test Loss: 1.646 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.886819362640381
Epoch: 12, Steps: 17 | Train Loss: 0.059 Vali Loss: 2.375 Vali Acc: 0.604 Test Loss: 2.375 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.423680305480957
Epoch: 13, Steps: 17 | Train Loss: 0.042 Vali Loss: 2.409 Vali Acc: 0.621 Test Loss: 2.409 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.221376895904541
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 2.872 Vali Acc: 0.608 Test Loss: 2.872 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.3778815269470215
Epoch: 15, Steps: 17 | Train Loss: 0.038 Vali Loss: 2.814 Vali Acc: 0.618 Test Loss: 2.814 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.596959352493286
Epoch: 16, Steps: 17 | Train Loss: 0.029 Vali Loss: 2.133 Vali Acc: 0.638 Test Loss: 2.133 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.639647483825684
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 3.436 Vali Acc: 0.587 Test Loss: 3.436 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.34060263633728
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 3.025 Vali Acc: 0.611 Test Loss: 3.025 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.658703071672355
model parameter : 479426
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.734572887420654
Epoch: 1, Steps: 17 | Train Loss: 0.735 Vali Loss: 0.662 Vali Acc: 0.597 Test Loss: 0.662 Test Acc: 0.597
Validation loss decreased (inf --> -0.597263).  Saving model ...
Epoch: 2 cost time: 5.195120811462402
Epoch: 2, Steps: 17 | Train Loss: 0.554 Vali Loss: 1.151 Vali Acc: 0.536 Test Loss: 1.151 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.7476487159729
Epoch: 3, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.683 Vali Acc: 0.614 Test Loss: 0.683 Test Acc: 0.614
Validation loss decreased (-0.597263 --> -0.614328).  Saving model ...
Epoch: 4 cost time: 5.451211929321289
Epoch: 4, Steps: 17 | Train Loss: 0.459 Vali Loss: 1.634 Vali Acc: 0.536 Test Loss: 1.634 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.90385890007019
Epoch: 5, Steps: 17 | Train Loss: 0.301 Vali Loss: 1.056 Vali Acc: 0.621 Test Loss: 1.056 Test Acc: 0.621
Validation loss decreased (-0.614328 --> -0.621150).  Saving model ...
Epoch: 6 cost time: 5.018115997314453
Epoch: 6, Steps: 17 | Train Loss: 0.303 Vali Loss: 1.314 Vali Acc: 0.625 Test Loss: 1.314 Test Acc: 0.625
Validation loss decreased (-0.621150 --> -0.624560).  Saving model ...
Epoch: 7 cost time: 5.055539131164551
Epoch: 7, Steps: 17 | Train Loss: 0.161 Vali Loss: 1.298 Vali Acc: 0.642 Test Loss: 1.298 Test Acc: 0.642
Validation loss decreased (-0.624560 --> -0.641625).  Saving model ...
Epoch: 8 cost time: 4.9995338916778564
Epoch: 8, Steps: 17 | Train Loss: 0.206 Vali Loss: 1.344 Vali Acc: 0.614 Test Loss: 1.344 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.042867422103882
Epoch: 9, Steps: 17 | Train Loss: 0.201 Vali Loss: 2.369 Vali Acc: 0.560 Test Loss: 2.369 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.135306119918823
Epoch: 10, Steps: 17 | Train Loss: 0.197 Vali Loss: 1.404 Vali Acc: 0.642 Test Loss: 1.404 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.528336524963379
Epoch: 11, Steps: 17 | Train Loss: 0.106 Vali Loss: 2.393 Vali Acc: 0.597 Test Loss: 2.393 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.43218469619751
Epoch: 12, Steps: 17 | Train Loss: 0.086 Vali Loss: 2.353 Vali Acc: 0.590 Test Loss: 2.353 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.401488780975342
Epoch: 13, Steps: 17 | Train Loss: 0.073 Vali Loss: 2.060 Vali Acc: 0.631 Test Loss: 2.060 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.314920425415039
Epoch: 14, Steps: 17 | Train Loss: 0.045 Vali Loss: 2.416 Vali Acc: 0.635 Test Loss: 2.416 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.062113285064697
Epoch: 15, Steps: 17 | Train Loss: 0.075 Vali Loss: 2.629 Vali Acc: 0.608 Test Loss: 2.629 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.315234899520874
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 2.856 Vali Acc: 0.590 Test Loss: 2.856 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.174020051956177
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 2.928 Vali Acc: 0.604 Test Loss: 2.928 Test Acc: 0.604
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 479426
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.275698184967041
Epoch: 1, Steps: 17 | Train Loss: 0.739 Vali Loss: 0.673 Vali Acc: 0.567 Test Loss: 0.673 Test Acc: 0.567
Validation loss decreased (inf --> -0.566546).  Saving model ...
Epoch: 2 cost time: 5.57549786567688
Epoch: 2, Steps: 17 | Train Loss: 0.547 Vali Loss: 1.207 Vali Acc: 0.512 Test Loss: 1.207 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.53345513343811
Epoch: 3, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.712 Vali Acc: 0.645 Test Loss: 0.712 Test Acc: 0.645
Validation loss decreased (-0.566546 --> -0.645044).  Saving model ...
Epoch: 4 cost time: 6.0172951221466064
Epoch: 4, Steps: 17 | Train Loss: 0.473 Vali Loss: 1.561 Vali Acc: 0.529 Test Loss: 1.561 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.966110944747925
Epoch: 5, Steps: 17 | Train Loss: 0.284 Vali Loss: 1.002 Vali Acc: 0.604 Test Loss: 1.002 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.259848356246948
Epoch: 6, Steps: 17 | Train Loss: 0.304 Vali Loss: 1.370 Vali Acc: 0.601 Test Loss: 1.370 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.197025299072266
Epoch: 7, Steps: 17 | Train Loss: 0.177 Vali Loss: 1.403 Vali Acc: 0.597 Test Loss: 1.403 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.163599967956543
Epoch: 8, Steps: 17 | Train Loss: 0.130 Vali Loss: 1.217 Vali Acc: 0.611 Test Loss: 1.217 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.348150730133057
Epoch: 9, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.767 Vali Acc: 0.590 Test Loss: 1.767 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.796025991439819
Epoch: 10, Steps: 17 | Train Loss: 0.076 Vali Loss: 2.879 Vali Acc: 0.549 Test Loss: 2.879 Test Acc: 0.549
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.760061264038086
Epoch: 11, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.975 Vali Acc: 0.584 Test Loss: 1.975 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.29897141456604
Epoch: 12, Steps: 17 | Train Loss: 0.063 Vali Loss: 2.953 Vali Acc: 0.560 Test Loss: 2.953 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.0201942920684814
Epoch: 13, Steps: 17 | Train Loss: 0.045 Vali Loss: 2.261 Vali Acc: 0.601 Test Loss: 2.261 Test Acc: 0.601
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6450511945392492
model parameter : 479426
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.806415796279907
Epoch: 1, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.694 Vali Acc: 0.529 Test Loss: 0.694 Test Acc: 0.529
Validation loss decreased (inf --> -0.529003).  Saving model ...
Epoch: 2 cost time: 5.077788591384888
Epoch: 2, Steps: 17 | Train Loss: 0.557 Vali Loss: 1.037 Vali Acc: 0.532 Test Loss: 1.037 Test Acc: 0.532
Validation loss decreased (-0.529003 --> -0.532413).  Saving model ...
Epoch: 3 cost time: 4.858947038650513
Epoch: 3, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.677 Vali Acc: 0.648 Test Loss: 0.677 Test Acc: 0.648
Validation loss decreased (-0.532413 --> -0.648457).  Saving model ...
Epoch: 4 cost time: 5.454927682876587
Epoch: 4, Steps: 17 | Train Loss: 0.480 Vali Loss: 1.630 Vali Acc: 0.539 Test Loss: 1.630 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.509673833847046
Epoch: 5, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.815 Vali Acc: 0.659 Test Loss: 0.815 Test Acc: 0.659
Validation loss decreased (-0.648457 --> -0.658695).  Saving model ...
Epoch: 6 cost time: 5.630789518356323
Epoch: 6, Steps: 17 | Train Loss: 0.330 Vali Loss: 1.276 Vali Acc: 0.625 Test Loss: 1.276 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.093235492706299
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 1.604 Vali Acc: 0.590 Test Loss: 1.604 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.550632953643799
Epoch: 8, Steps: 17 | Train Loss: 0.173 Vali Loss: 1.249 Vali Acc: 0.631 Test Loss: 1.249 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.323410272598267
Epoch: 9, Steps: 17 | Train Loss: 0.135 Vali Loss: 2.010 Vali Acc: 0.573 Test Loss: 2.010 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.1512610912323
Epoch: 10, Steps: 17 | Train Loss: 0.110 Vali Loss: 2.055 Vali Acc: 0.594 Test Loss: 2.055 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.520582437515259
Epoch: 11, Steps: 17 | Train Loss: 0.065 Vali Loss: 2.262 Vali Acc: 0.580 Test Loss: 2.262 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.511747360229492
Epoch: 12, Steps: 17 | Train Loss: 0.061 Vali Loss: 2.075 Vali Acc: 0.621 Test Loss: 2.075 Test Acc: 0.621
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.903772592544556
Epoch: 13, Steps: 17 | Train Loss: 0.064 Vali Loss: 2.470 Vali Acc: 0.608 Test Loss: 2.470 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.2547996044158936
Epoch: 14, Steps: 17 | Train Loss: 0.042 Vali Loss: 3.715 Vali Acc: 0.549 Test Loss: 3.715 Test Acc: 0.549
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.057482719421387
Epoch: 15, Steps: 17 | Train Loss: 0.150 Vali Loss: 2.413 Vali Acc: 0.635 Test Loss: 2.413 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.658703071672355
model parameter : 479426
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.448732852935791
Epoch: 1, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.729 Vali Acc: 0.529 Test Loss: 0.729 Test Acc: 0.529
Validation loss decreased (inf --> -0.529003).  Saving model ...
Epoch: 2 cost time: 5.3394293785095215
Epoch: 2, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.925 Vali Acc: 0.512 Test Loss: 0.925 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.640296459197998
Epoch: 3, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.700 Vali Acc: 0.631 Test Loss: 0.700 Test Acc: 0.631
Validation loss decreased (-0.529003 --> -0.631392).  Saving model ...
Epoch: 4 cost time: 5.745054721832275
Epoch: 4, Steps: 17 | Train Loss: 0.558 Vali Loss: 1.444 Vali Acc: 0.512 Test Loss: 1.444 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.768763542175293
Epoch: 5, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.774 Vali Acc: 0.625 Test Loss: 0.774 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.400013446807861
Epoch: 6, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.856 Vali Acc: 0.631 Test Loss: 0.856 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.2659711837768555
Epoch: 7, Steps: 17 | Train Loss: 0.247 Vali Loss: 1.217 Vali Acc: 0.573 Test Loss: 1.217 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.888572454452515
Epoch: 8, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.105 Vali Acc: 0.628 Test Loss: 1.105 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.553798675537109
Epoch: 9, Steps: 17 | Train Loss: 0.210 Vali Loss: 2.638 Vali Acc: 0.529 Test Loss: 2.638 Test Acc: 0.529
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.78623366355896
Epoch: 10, Steps: 17 | Train Loss: 0.179 Vali Loss: 2.045 Vali Acc: 0.539 Test Loss: 2.045 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.99073052406311
Epoch: 11, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.576 Vali Acc: 0.597 Test Loss: 1.576 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.328228712081909
Epoch: 12, Steps: 17 | Train Loss: 0.179 Vali Loss: 2.418 Vali Acc: 0.560 Test Loss: 2.418 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.414720296859741
Epoch: 13, Steps: 17 | Train Loss: 0.216 Vali Loss: 3.019 Vali Acc: 0.526 Test Loss: 3.019 Test Acc: 0.526
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6313993174061433
model parameter : 479426
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.8932952880859375
Epoch: 1, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.679 Vali Acc: 0.567 Test Loss: 0.679 Test Acc: 0.567
Validation loss decreased (inf --> -0.566546).  Saving model ...
Epoch: 2 cost time: 5.141931772232056
Epoch: 2, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.994 Vali Acc: 0.509 Test Loss: 0.994 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.437824010848999
Epoch: 3, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.814 Vali Acc: 0.604 Test Loss: 0.814 Test Acc: 0.604
Validation loss decreased (-0.566546 --> -0.604087).  Saving model ...
Epoch: 4 cost time: 4.759865999221802
Epoch: 4, Steps: 17 | Train Loss: 0.572 Vali Loss: 1.180 Vali Acc: 0.563 Test Loss: 1.180 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.651625156402588
Epoch: 5, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.986 Vali Acc: 0.573 Test Loss: 0.986 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.15747594833374
Epoch: 6, Steps: 17 | Train Loss: 0.401 Vali Loss: 1.661 Vali Acc: 0.532 Test Loss: 1.661 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.8244874477386475
Epoch: 7, Steps: 17 | Train Loss: 0.279 Vali Loss: 1.284 Vali Acc: 0.560 Test Loss: 1.284 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.562682151794434
Epoch: 8, Steps: 17 | Train Loss: 0.278 Vali Loss: 1.322 Vali Acc: 0.577 Test Loss: 1.322 Test Acc: 0.577
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.476941823959351
Epoch: 9, Steps: 17 | Train Loss: 0.216 Vali Loss: 2.046 Vali Acc: 0.532 Test Loss: 2.046 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.343519926071167
Epoch: 10, Steps: 17 | Train Loss: 0.178 Vali Loss: 1.984 Vali Acc: 0.546 Test Loss: 1.984 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.2583935260772705
Epoch: 11, Steps: 17 | Train Loss: 0.185 Vali Loss: 2.079 Vali Acc: 0.539 Test Loss: 2.079 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.346893072128296
Epoch: 12, Steps: 17 | Train Loss: 0.143 Vali Loss: 2.513 Vali Acc: 0.539 Test Loss: 2.513 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.156361103057861
Epoch: 13, Steps: 17 | Train Loss: 0.140 Vali Loss: 1.909 Vali Acc: 0.563 Test Loss: 1.909 Test Acc: 0.563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6040955631399317
model parameter : 479426
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.947973012924194
Epoch: 1, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.677 Vali Acc: 0.580 Test Loss: 0.677 Test Acc: 0.580
Validation loss decreased (inf --> -0.580198).  Saving model ...
Epoch: 2 cost time: 5.036886930465698
Epoch: 2, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.995 Vali Acc: 0.502 Test Loss: 0.995 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.289880037307739
Epoch: 3, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.807 Vali Acc: 0.563 Test Loss: 0.807 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.291079044342041
Epoch: 4, Steps: 17 | Train Loss: 0.514 Vali Loss: 1.469 Vali Acc: 0.526 Test Loss: 1.469 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.28472113609314
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.966 Vali Acc: 0.536 Test Loss: 0.966 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.531594514846802
Epoch: 6, Steps: 17 | Train Loss: 0.356 Vali Loss: 1.226 Vali Acc: 0.536 Test Loss: 1.226 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.178611993789673
Epoch: 7, Steps: 17 | Train Loss: 0.280 Vali Loss: 1.284 Vali Acc: 0.546 Test Loss: 1.284 Test Acc: 0.546
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.194903373718262
Epoch: 8, Steps: 17 | Train Loss: 0.232 Vali Loss: 1.293 Vali Acc: 0.532 Test Loss: 1.293 Test Acc: 0.532
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.155072450637817
Epoch: 9, Steps: 17 | Train Loss: 0.190 Vali Loss: 2.263 Vali Acc: 0.515 Test Loss: 2.263 Test Acc: 0.515
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.563026428222656
Epoch: 10, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.950 Vali Acc: 0.526 Test Loss: 1.950 Test Acc: 0.526
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.889272212982178
Epoch: 11, Steps: 17 | Train Loss: 0.148 Vali Loss: 2.235 Vali Acc: 0.519 Test Loss: 2.235 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5802047781569966
model parameter : 479426
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.9903199672698975
Epoch: 1, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.741 Vali Acc: 0.502 Test Loss: 0.741 Test Acc: 0.502
Validation loss decreased (inf --> -0.501699).  Saving model ...
Epoch: 2 cost time: 5.062470197677612
Epoch: 2, Steps: 17 | Train Loss: 0.569 Vali Loss: 1.221 Vali Acc: 0.502 Test Loss: 1.221 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.029892683029175
Epoch: 3, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.680 Vali Acc: 0.509 Test Loss: 0.680 Test Acc: 0.509
Validation loss decreased (-0.501699 --> -0.508526).  Saving model ...
Epoch: 4 cost time: 4.934725522994995
Epoch: 4, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.965 Vali Acc: 0.502 Test Loss: 0.965 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.149627923965454
Epoch: 5, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.750 Vali Acc: 0.502 Test Loss: 0.750 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.17003059387207
Epoch: 6, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.875 Vali Acc: 0.502 Test Loss: 0.875 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.009288549423218
Epoch: 7, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.642 Vali Acc: 0.618 Test Loss: 0.642 Test Acc: 0.618
Validation loss decreased (-0.508526 --> -0.617741).  Saving model ...
Epoch: 8 cost time: 4.812154293060303
Epoch: 8, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.919 Vali Acc: 0.502 Test Loss: 0.919 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.555961847305298
Epoch: 9, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.963 Vali Acc: 0.509 Test Loss: 0.963 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.563845157623291
Epoch: 10, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.690 Vali Acc: 0.597 Test Loss: 0.690 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.550148248672485
Epoch: 11, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.994 Vali Acc: 0.532 Test Loss: 0.994 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.769212961196899
Epoch: 12, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.795 Vali Acc: 0.597 Test Loss: 0.795 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.6189281940460205
Epoch: 13, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.846 Vali Acc: 0.590 Test Loss: 0.846 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.394962310791016
Epoch: 14, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.938 Vali Acc: 0.590 Test Loss: 0.938 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.988969564437866
Epoch: 15, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.892 Vali Acc: 0.587 Test Loss: 0.892 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.92734956741333
Epoch: 16, Steps: 17 | Train Loss: 0.267 Vali Loss: 1.180 Vali Acc: 0.546 Test Loss: 1.180 Test Acc: 0.546
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.394792556762695
Epoch: 17, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.991 Vali Acc: 0.584 Test Loss: 0.991 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6177474402730375
model parameter : 479426
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.66989803314209
Epoch: 1, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.825 Vali Acc: 0.502 Test Loss: 0.825 Test Acc: 0.502
Validation loss decreased (inf --> -0.501698).  Saving model ...
Epoch: 2 cost time: 4.702669143676758
Epoch: 2, Steps: 17 | Train Loss: 0.580 Vali Loss: 1.405 Vali Acc: 0.502 Test Loss: 1.405 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.121760606765747
Epoch: 3, Steps: 17 | Train Loss: 0.562 Vali Loss: 1.059 Vali Acc: 0.502 Test Loss: 1.059 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.176596164703369
Epoch: 4, Steps: 17 | Train Loss: 0.606 Vali Loss: 1.285 Vali Acc: 0.502 Test Loss: 1.285 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.289687395095825
Epoch: 5, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.975 Vali Acc: 0.505 Test Loss: 0.975 Test Acc: 0.505
Validation loss decreased (-0.501698 --> -0.505110).  Saving model ...
Epoch: 6 cost time: 5.078141689300537
Epoch: 6, Steps: 17 | Train Loss: 0.541 Vali Loss: 1.194 Vali Acc: 0.502 Test Loss: 1.194 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.1228861808776855
Epoch: 7, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.905 Vali Acc: 0.509 Test Loss: 0.905 Test Acc: 0.509
Validation loss decreased (-0.505110 --> -0.508523).  Saving model ...
Epoch: 8 cost time: 5.382156848907471
Epoch: 8, Steps: 17 | Train Loss: 0.493 Vali Loss: 1.119 Vali Acc: 0.509 Test Loss: 1.119 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.086616516113281
Epoch: 9, Steps: 17 | Train Loss: 0.502 Vali Loss: 1.510 Vali Acc: 0.502 Test Loss: 1.510 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.089381456375122
Epoch: 10, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.895 Vali Acc: 0.580 Test Loss: 0.895 Test Acc: 0.580
Validation loss decreased (-0.508523 --> -0.580196).  Saving model ...
Epoch: 11 cost time: 4.903040409088135
Epoch: 11, Steps: 17 | Train Loss: 0.416 Vali Loss: 1.357 Vali Acc: 0.519 Test Loss: 1.357 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.171404600143433
Epoch: 12, Steps: 17 | Train Loss: 0.405 Vali Loss: 1.290 Vali Acc: 0.543 Test Loss: 1.290 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.209072113037109
Epoch: 13, Steps: 17 | Train Loss: 0.335 Vali Loss: 1.313 Vali Acc: 0.553 Test Loss: 1.313 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.930204153060913
Epoch: 14, Steps: 17 | Train Loss: 0.364 Vali Loss: 1.642 Vali Acc: 0.553 Test Loss: 1.642 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.519739866256714
Epoch: 15, Steps: 17 | Train Loss: 0.431 Vali Loss: 1.668 Vali Acc: 0.587 Test Loss: 1.668 Test Acc: 0.587
Validation loss decreased (-0.580196 --> -0.587014).  Saving model ...
Epoch: 16 cost time: 4.774398565292358
Epoch: 16, Steps: 17 | Train Loss: 0.360 Vali Loss: 2.298 Vali Acc: 0.584 Test Loss: 2.298 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.724856615066528
Epoch: 17, Steps: 17 | Train Loss: 0.586 Vali Loss: 2.128 Vali Acc: 0.584 Test Loss: 2.128 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.914467096328735
Epoch: 18, Steps: 17 | Train Loss: 0.418 Vali Loss: 2.577 Vali Acc: 0.580 Test Loss: 2.577 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.925552606582642
Epoch: 19, Steps: 17 | Train Loss: 0.368 Vali Loss: 1.978 Vali Acc: 0.573 Test Loss: 1.978 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.0516228675842285
Epoch: 20, Steps: 17 | Train Loss: 0.317 Vali Loss: 2.120 Vali Acc: 0.580 Test Loss: 2.120 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.2074244022369385
Epoch: 21, Steps: 17 | Train Loss: 0.261 Vali Loss: 1.851 Vali Acc: 0.584 Test Loss: 1.851 Test Acc: 0.584
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.1625776290893555
Epoch: 22, Steps: 17 | Train Loss: 0.367 Vali Loss: 2.225 Vali Acc: 0.573 Test Loss: 2.225 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.091218948364258
Epoch: 23, Steps: 17 | Train Loss: 0.323 Vali Loss: 2.355 Vali Acc: 0.580 Test Loss: 2.355 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.887676477432251
Epoch: 24, Steps: 17 | Train Loss: 0.385 Vali Loss: 2.437 Vali Acc: 0.577 Test Loss: 2.437 Test Acc: 0.577
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.693379878997803
Epoch: 25, Steps: 17 | Train Loss: 0.339 Vali Loss: 2.216 Vali Acc: 0.580 Test Loss: 2.216 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5870307167235495
model parameter : 479426
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.033989906311035
Epoch: 1, Steps: 17 | Train Loss: 0.718 Vali Loss: 0.853 Vali Acc: 0.515 Test Loss: 0.853 Test Acc: 0.515
Validation loss decreased (inf --> -0.515350).  Saving model ...
Epoch: 2 cost time: 4.8373167514801025
Epoch: 2, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.699 Vali Acc: 0.611 Test Loss: 0.699 Test Acc: 0.611
Validation loss decreased (-0.515350 --> -0.610915).  Saving model ...
Epoch: 3 cost time: 5.052049160003662
Epoch: 3, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.899 Vali Acc: 0.621 Test Loss: 0.899 Test Acc: 0.621
Validation loss decreased (-0.610915 --> -0.621151).  Saving model ...
Epoch: 4 cost time: 4.948496103286743
Epoch: 4, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.880 Vali Acc: 0.601 Test Loss: 0.880 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.358041524887085
Epoch: 5, Steps: 17 | Train Loss: 0.298 Vali Loss: 1.131 Vali Acc: 0.638 Test Loss: 1.131 Test Acc: 0.638
Validation loss decreased (-0.621151 --> -0.638214).  Saving model ...
Epoch: 6 cost time: 5.230004787445068
Epoch: 6, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.976 Vali Acc: 0.666 Test Loss: 0.976 Test Acc: 0.666
Validation loss decreased (-0.638214 --> -0.665519).  Saving model ...
Epoch: 7 cost time: 5.51655650138855
Epoch: 7, Steps: 17 | Train Loss: 0.147 Vali Loss: 1.515 Vali Acc: 0.597 Test Loss: 1.515 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.358008623123169
Epoch: 8, Steps: 17 | Train Loss: 0.131 Vali Loss: 2.252 Vali Acc: 0.570 Test Loss: 2.252 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.584218740463257
Epoch: 9, Steps: 17 | Train Loss: 0.194 Vali Loss: 1.167 Vali Acc: 0.652 Test Loss: 1.167 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.34328293800354
Epoch: 10, Steps: 17 | Train Loss: 0.096 Vali Loss: 1.544 Vali Acc: 0.669 Test Loss: 1.544 Test Acc: 0.669
Validation loss decreased (-0.665519 --> -0.668927).  Saving model ...
Epoch: 11 cost time: 5.377566814422607
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.674 Vali Acc: 0.652 Test Loss: 1.674 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.105914831161499
Epoch: 12, Steps: 17 | Train Loss: 0.102 Vali Loss: 2.176 Vali Acc: 0.614 Test Loss: 2.176 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.971316576004028
Epoch: 13, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.592 Vali Acc: 0.611 Test Loss: 1.592 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.151363134384155
Epoch: 14, Steps: 17 | Train Loss: 0.136 Vali Loss: 3.807 Vali Acc: 0.584 Test Loss: 3.807 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.912250280380249
Epoch: 15, Steps: 17 | Train Loss: 0.103 Vali Loss: 2.107 Vali Acc: 0.628 Test Loss: 2.107 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.463858604431152
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.458 Vali Acc: 0.631 Test Loss: 2.458 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.511350631713867
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 2.095 Vali Acc: 0.659 Test Loss: 2.095 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.263122320175171
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 2.276 Vali Acc: 0.679 Test Loss: 2.276 Test Acc: 0.679
Validation loss decreased (-0.668927 --> -0.679158).  Saving model ...
Epoch: 19 cost time: 5.16031289100647
Epoch: 19, Steps: 17 | Train Loss: 0.062 Vali Loss: 2.835 Vali Acc: 0.631 Test Loss: 2.835 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.176161289215088
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.381 Vali Acc: 0.683 Test Loss: 2.381 Test Acc: 0.683
Validation loss decreased (-0.679158 --> -0.682570).  Saving model ...
Epoch: 21 cost time: 5.341065883636475
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 3.595 Vali Acc: 0.601 Test Loss: 3.595 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.222424030303955
Epoch: 22, Steps: 17 | Train Loss: 0.039 Vali Loss: 2.204 Vali Acc: 0.652 Test Loss: 2.204 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.093260288238525
Epoch: 23, Steps: 17 | Train Loss: 0.116 Vali Loss: 4.440 Vali Acc: 0.584 Test Loss: 4.440 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.1835010051727295
Epoch: 24, Steps: 17 | Train Loss: 0.069 Vali Loss: 2.394 Vali Acc: 0.652 Test Loss: 2.394 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.152050495147705
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 3.756 Vali Acc: 0.604 Test Loss: 3.756 Test Acc: 0.604
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.921514987945557
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 3.500 Vali Acc: 0.608 Test Loss: 3.500 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.354190826416016
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 3.916 Vali Acc: 0.597 Test Loss: 3.916 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.449331283569336
Epoch: 28, Steps: 17 | Train Loss: 0.013 Vali Loss: 3.233 Vali Acc: 0.645 Test Loss: 3.233 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.391932010650635
Epoch: 29, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.930 Vali Acc: 0.659 Test Loss: 2.930 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.866836309432983
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 4.030 Vali Acc: 0.625 Test Loss: 4.030 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6825938566552902
model parameter : 381122
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.0111188888549805
Epoch: 1, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.826 Vali Acc: 0.532 Test Loss: 0.826 Test Acc: 0.532
Validation loss decreased (inf --> -0.532415).  Saving model ...
Epoch: 2 cost time: 4.858021259307861
Epoch: 2, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.716 Vali Acc: 0.570 Test Loss: 0.716 Test Acc: 0.570
Validation loss decreased (-0.532415 --> -0.569959).  Saving model ...
Epoch: 3 cost time: 4.981655836105347
Epoch: 3, Steps: 17 | Train Loss: 0.379 Vali Loss: 1.112 Vali Acc: 0.594 Test Loss: 1.112 Test Acc: 0.594
Validation loss decreased (-0.569959 --> -0.593846).  Saving model ...
Epoch: 4 cost time: 4.661302804946899
Epoch: 4, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.755 Vali Acc: 0.621 Test Loss: 0.755 Test Acc: 0.621
Validation loss decreased (-0.593846 --> -0.621153).  Saving model ...
Epoch: 5 cost time: 4.650701284408569
Epoch: 5, Steps: 17 | Train Loss: 0.316 Vali Loss: 1.255 Vali Acc: 0.604 Test Loss: 1.255 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.061931848526001
Epoch: 6, Steps: 17 | Train Loss: 0.203 Vali Loss: 1.560 Vali Acc: 0.570 Test Loss: 1.560 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.255674839019775
Epoch: 7, Steps: 17 | Train Loss: 0.172 Vali Loss: 1.334 Vali Acc: 0.614 Test Loss: 1.334 Test Acc: 0.614
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.290535926818848
Epoch: 8, Steps: 17 | Train Loss: 0.122 Vali Loss: 2.527 Vali Acc: 0.546 Test Loss: 2.527 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.398719787597656
Epoch: 9, Steps: 17 | Train Loss: 0.220 Vali Loss: 1.267 Vali Acc: 0.621 Test Loss: 1.267 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.281249523162842
Epoch: 10, Steps: 17 | Train Loss: 0.180 Vali Loss: 2.450 Vali Acc: 0.570 Test Loss: 2.450 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.0543248653411865
Epoch: 11, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.904 Vali Acc: 0.618 Test Loss: 1.904 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.054771184921265
Epoch: 12, Steps: 17 | Train Loss: 0.077 Vali Loss: 2.203 Vali Acc: 0.618 Test Loss: 2.203 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.920404434204102
Epoch: 13, Steps: 17 | Train Loss: 0.053 Vali Loss: 3.317 Vali Acc: 0.577 Test Loss: 3.317 Test Acc: 0.577
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.863153696060181
Epoch: 14, Steps: 17 | Train Loss: 0.044 Vali Loss: 2.057 Vali Acc: 0.648 Test Loss: 2.057 Test Acc: 0.648
Validation loss decreased (-0.621153 --> -0.648444).  Saving model ...
Epoch: 15 cost time: 4.382524490356445
Epoch: 15, Steps: 17 | Train Loss: 0.040 Vali Loss: 2.147 Vali Acc: 0.628 Test Loss: 2.147 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.533037424087524
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 3.013 Vali Acc: 0.611 Test Loss: 3.013 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.672698736190796
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.262 Vali Acc: 0.659 Test Loss: 2.262 Test Acc: 0.659
Validation loss decreased (-0.648444 --> -0.658680).  Saving model ...
Epoch: 18 cost time: 5.373027324676514
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.626 Vali Acc: 0.638 Test Loss: 2.626 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.813670635223389
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 2.863 Vali Acc: 0.635 Test Loss: 2.863 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.391326904296875
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.542 Vali Acc: 0.659 Test Loss: 2.542 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.194005012512207
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.874 Vali Acc: 0.635 Test Loss: 2.874 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.4574971199035645
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.455 Vali Acc: 0.642 Test Loss: 2.455 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.1479651927948
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.411 Vali Acc: 0.662 Test Loss: 2.411 Test Acc: 0.662
Validation loss decreased (-0.658680 --> -0.662092).  Saving model ...
Epoch: 24 cost time: 4.990499258041382
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.615 Vali Acc: 0.655 Test Loss: 2.615 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.758903741836548
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 3.017 Vali Acc: 0.631 Test Loss: 3.017 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.9848058223724365
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 2.689 Vali Acc: 0.648 Test Loss: 2.689 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.917610168457031
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.546 Vali Acc: 0.638 Test Loss: 2.546 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.990140914916992
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 3.287 Vali Acc: 0.625 Test Loss: 3.287 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.2156662940979
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 3.047 Vali Acc: 0.642 Test Loss: 3.047 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.278709888458252
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.718 Vali Acc: 0.655 Test Loss: 2.718 Test Acc: 0.655
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.348580360412598
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 3.721 Vali Acc: 0.625 Test Loss: 3.721 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.587687253952026
Epoch: 32, Steps: 17 | Train Loss: 0.027 Vali Loss: 2.387 Vali Acc: 0.662 Test Loss: 2.387 Test Acc: 0.662
Validation loss decreased (-0.662092 --> -0.662092).  Saving model ...
Epoch: 33 cost time: 5.532839775085449
Epoch: 33, Steps: 17 | Train Loss: 0.102 Vali Loss: 3.283 Vali Acc: 0.635 Test Loss: 3.283 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.306153297424316
Epoch: 34, Steps: 17 | Train Loss: 0.075 Vali Loss: 3.433 Vali Acc: 0.611 Test Loss: 3.433 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.089913368225098
Epoch: 35, Steps: 17 | Train Loss: 0.062 Vali Loss: 3.892 Vali Acc: 0.631 Test Loss: 3.892 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.275852680206299
Epoch: 36, Steps: 17 | Train Loss: 0.032 Vali Loss: 4.099 Vali Acc: 0.642 Test Loss: 4.099 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 5.443896770477295
Epoch: 37, Steps: 17 | Train Loss: 0.113 Vali Loss: 4.771 Vali Acc: 0.625 Test Loss: 4.771 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 5.411082744598389
Epoch: 38, Steps: 17 | Train Loss: 0.039 Vali Loss: 3.831 Vali Acc: 0.642 Test Loss: 3.831 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 4.814964532852173
Epoch: 39, Steps: 17 | Train Loss: 0.015 Vali Loss: 3.757 Vali Acc: 0.645 Test Loss: 3.757 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 5.341363191604614
Epoch: 40, Steps: 17 | Train Loss: 0.020 Vali Loss: 4.021 Vali Acc: 0.628 Test Loss: 4.021 Test Acc: 0.628
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 5.444009780883789
Epoch: 41, Steps: 17 | Train Loss: 0.010 Vali Loss: 4.762 Vali Acc: 0.638 Test Loss: 4.762 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 5.52711033821106
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 4.913 Vali Acc: 0.648 Test Loss: 4.913 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6621160409556314
model parameter : 381122
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.3136372566223145
Epoch: 1, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.861 Vali Acc: 0.529 Test Loss: 0.861 Test Acc: 0.529
Validation loss decreased (inf --> -0.529002).  Saving model ...
Epoch: 2 cost time: 4.496330976486206
Epoch: 2, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.743 Vali Acc: 0.553 Test Loss: 0.743 Test Acc: 0.553
Validation loss decreased (-0.529002 --> -0.552894).  Saving model ...
Epoch: 3 cost time: 4.743609666824341
Epoch: 3, Steps: 17 | Train Loss: 0.418 Vali Loss: 1.101 Vali Acc: 0.580 Test Loss: 1.101 Test Acc: 0.580
Validation loss decreased (-0.552894 --> -0.580194).  Saving model ...
Epoch: 4 cost time: 4.6830527782440186
Epoch: 4, Steps: 17 | Train Loss: 0.345 Vali Loss: 1.022 Vali Acc: 0.577 Test Loss: 1.022 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.9945361614227295
Epoch: 5, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.908 Vali Acc: 0.614 Test Loss: 0.908 Test Acc: 0.614
Validation loss decreased (-0.580194 --> -0.614325).  Saving model ...
Epoch: 6 cost time: 4.710231065750122
Epoch: 6, Steps: 17 | Train Loss: 0.206 Vali Loss: 1.347 Vali Acc: 0.590 Test Loss: 1.347 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.650364637374878
Epoch: 7, Steps: 17 | Train Loss: 0.188 Vali Loss: 1.716 Vali Acc: 0.580 Test Loss: 1.716 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.0230491161346436
Epoch: 8, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.906 Vali Acc: 0.597 Test Loss: 1.906 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.030704021453857
Epoch: 9, Steps: 17 | Train Loss: 0.179 Vali Loss: 1.466 Vali Acc: 0.601 Test Loss: 1.466 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.162003755569458
Epoch: 10, Steps: 17 | Train Loss: 0.114 Vali Loss: 2.330 Vali Acc: 0.590 Test Loss: 2.330 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.175626039505005
Epoch: 11, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.844 Vali Acc: 0.580 Test Loss: 1.844 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.014104604721069
Epoch: 12, Steps: 17 | Train Loss: 0.076 Vali Loss: 2.537 Vali Acc: 0.577 Test Loss: 2.537 Test Acc: 0.577
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.904343366622925
Epoch: 13, Steps: 17 | Train Loss: 0.043 Vali Loss: 2.005 Vali Acc: 0.611 Test Loss: 2.005 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.977254629135132
Epoch: 14, Steps: 17 | Train Loss: 0.049 Vali Loss: 2.935 Vali Acc: 0.584 Test Loss: 2.935 Test Acc: 0.584
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.969948053359985
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 2.490 Vali Acc: 0.587 Test Loss: 2.490 Test Acc: 0.587
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6143344709897611
model parameter : 381122
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.269447565078735
Epoch: 1, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.865 Vali Acc: 0.505 Test Loss: 0.865 Test Acc: 0.505
Validation loss decreased (inf --> -0.505111).  Saving model ...
Epoch: 2 cost time: 5.461921453475952
Epoch: 2, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.799 Vali Acc: 0.529 Test Loss: 0.799 Test Acc: 0.529
Validation loss decreased (-0.505111 --> -0.529002).  Saving model ...
Epoch: 3 cost time: 5.6332104206085205
Epoch: 3, Steps: 17 | Train Loss: 0.433 Vali Loss: 1.122 Vali Acc: 0.546 Test Loss: 1.122 Test Acc: 0.546
Validation loss decreased (-0.529002 --> -0.546064).  Saving model ...
Epoch: 4 cost time: 5.663725852966309
Epoch: 4, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.855 Vali Acc: 0.597 Test Loss: 0.855 Test Acc: 0.597
Validation loss decreased (-0.546064 --> -0.597261).  Saving model ...
Epoch: 5 cost time: 5.2720043659210205
Epoch: 5, Steps: 17 | Train Loss: 0.367 Vali Loss: 1.184 Vali Acc: 0.587 Test Loss: 1.184 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.388225555419922
Epoch: 6, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.096 Vali Acc: 0.608 Test Loss: 1.096 Test Acc: 0.608
Validation loss decreased (-0.597261 --> -0.607498).  Saving model ...
Epoch: 7 cost time: 5.659891605377197
Epoch: 7, Steps: 17 | Train Loss: 0.274 Vali Loss: 3.105 Vali Acc: 0.526 Test Loss: 3.105 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.439486026763916
Epoch: 8, Steps: 17 | Train Loss: 0.347 Vali Loss: 1.497 Vali Acc: 0.594 Test Loss: 1.497 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.234933853149414
Epoch: 9, Steps: 17 | Train Loss: 0.179 Vali Loss: 1.950 Vali Acc: 0.580 Test Loss: 1.950 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.0003662109375
Epoch: 10, Steps: 17 | Train Loss: 0.430 Vali Loss: 3.396 Vali Acc: 0.546 Test Loss: 3.396 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.350204944610596
Epoch: 11, Steps: 17 | Train Loss: 0.112 Vali Loss: 1.881 Vali Acc: 0.618 Test Loss: 1.881 Test Acc: 0.618
Validation loss decreased (-0.607498 --> -0.617729).  Saving model ...
Epoch: 12 cost time: 5.3012166023254395
Epoch: 12, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.924 Vali Acc: 0.621 Test Loss: 1.924 Test Acc: 0.621
Validation loss decreased (-0.617729 --> -0.621141).  Saving model ...
Epoch: 13 cost time: 5.155614614486694
Epoch: 13, Steps: 17 | Train Loss: 0.069 Vali Loss: 3.091 Vali Acc: 0.567 Test Loss: 3.091 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.360663890838623
Epoch: 14, Steps: 17 | Train Loss: 0.086 Vali Loss: 3.257 Vali Acc: 0.573 Test Loss: 3.257 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.5446717739105225
Epoch: 15, Steps: 17 | Train Loss: 0.078 Vali Loss: 2.001 Vali Acc: 0.652 Test Loss: 2.001 Test Acc: 0.652
Validation loss decreased (-0.621141 --> -0.651857).  Saving model ...
Epoch: 16 cost time: 5.627328157424927
Epoch: 16, Steps: 17 | Train Loss: 0.110 Vali Loss: 3.113 Vali Acc: 0.560 Test Loss: 3.113 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.455344200134277
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.458 Vali Acc: 0.631 Test Loss: 2.458 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.617434740066528
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 3.551 Vali Acc: 0.577 Test Loss: 3.551 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.222702264785767
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 3.241 Vali Acc: 0.601 Test Loss: 3.241 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.849844455718994
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 3.229 Vali Acc: 0.604 Test Loss: 3.229 Test Acc: 0.604
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.942731618881226
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 3.165 Vali Acc: 0.608 Test Loss: 3.165 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.87964129447937
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.894 Vali Acc: 0.625 Test Loss: 2.894 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.930786371231079
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 3.109 Vali Acc: 0.611 Test Loss: 3.109 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.478301525115967
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 3.282 Vali Acc: 0.601 Test Loss: 3.282 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.339151382446289
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.973 Vali Acc: 0.608 Test Loss: 2.973 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6518771331058021
model parameter : 381122
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.398568868637085
Epoch: 1, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.804 Vali Acc: 0.522 Test Loss: 0.804 Test Acc: 0.522
Validation loss decreased (inf --> -0.522176).  Saving model ...
Epoch: 2 cost time: 5.628150939941406
Epoch: 2, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.709 Vali Acc: 0.584 Test Loss: 0.709 Test Acc: 0.584
Validation loss decreased (-0.522176 --> -0.583611).  Saving model ...
Epoch: 3 cost time: 5.390386343002319
Epoch: 3, Steps: 17 | Train Loss: 0.404 Vali Loss: 1.055 Vali Acc: 0.567 Test Loss: 1.055 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.108036756515503
Epoch: 4, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.772 Vali Acc: 0.652 Test Loss: 0.772 Test Acc: 0.652
Validation loss decreased (-0.583611 --> -0.651869).  Saving model ...
Epoch: 5 cost time: 5.447850227355957
Epoch: 5, Steps: 17 | Train Loss: 0.320 Vali Loss: 1.115 Vali Acc: 0.614 Test Loss: 1.115 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.592818021774292
Epoch: 6, Steps: 17 | Train Loss: 0.222 Vali Loss: 1.582 Vali Acc: 0.584 Test Loss: 1.582 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.113182067871094
Epoch: 7, Steps: 17 | Train Loss: 0.186 Vali Loss: 1.989 Vali Acc: 0.556 Test Loss: 1.989 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.29058575630188
Epoch: 8, Steps: 17 | Train Loss: 0.255 Vali Loss: 1.456 Vali Acc: 0.625 Test Loss: 1.456 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.196856737136841
Epoch: 9, Steps: 17 | Train Loss: 0.157 Vali Loss: 1.960 Vali Acc: 0.611 Test Loss: 1.960 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.4293622970581055
Epoch: 10, Steps: 17 | Train Loss: 0.139 Vali Loss: 1.814 Vali Acc: 0.608 Test Loss: 1.814 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.726025104522705
Epoch: 11, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.665 Vali Acc: 0.635 Test Loss: 1.665 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.266156196594238
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 2.079 Vali Acc: 0.604 Test Loss: 2.079 Test Acc: 0.604
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.329917669296265
Epoch: 13, Steps: 17 | Train Loss: 0.052 Vali Loss: 2.270 Vali Acc: 0.608 Test Loss: 2.270 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.313769817352295
Epoch: 14, Steps: 17 | Train Loss: 0.062 Vali Loss: 2.670 Vali Acc: 0.604 Test Loss: 2.670 Test Acc: 0.604
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6518771331058021
model parameter : 381122
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.882990598678589
Epoch: 1, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.856 Vali Acc: 0.502 Test Loss: 0.856 Test Acc: 0.502
Validation loss decreased (inf --> -0.501698).  Saving model ...
Epoch: 2 cost time: 4.818616151809692
Epoch: 2, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.714 Vali Acc: 0.573 Test Loss: 0.714 Test Acc: 0.573
Validation loss decreased (-0.501698 --> -0.573372).  Saving model ...
Epoch: 3 cost time: 4.869469881057739
Epoch: 3, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.806 Vali Acc: 0.570 Test Loss: 0.806 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.3436362743377686
Epoch: 4, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.793 Vali Acc: 0.601 Test Loss: 0.793 Test Acc: 0.601
Validation loss decreased (-0.573372 --> -0.600675).  Saving model ...
Epoch: 5 cost time: 5.134718418121338
Epoch: 5, Steps: 17 | Train Loss: 0.423 Vali Loss: 1.002 Vali Acc: 0.543 Test Loss: 1.002 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.396570682525635
Epoch: 6, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.908 Vali Acc: 0.604 Test Loss: 0.908 Test Acc: 0.604
Validation loss decreased (-0.600675 --> -0.604086).  Saving model ...
Epoch: 7 cost time: 5.235331058502197
Epoch: 7, Steps: 17 | Train Loss: 0.380 Vali Loss: 2.845 Vali Acc: 0.509 Test Loss: 2.845 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.453645944595337
Epoch: 8, Steps: 17 | Train Loss: 0.270 Vali Loss: 1.469 Vali Acc: 0.556 Test Loss: 1.469 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.633757829666138
Epoch: 9, Steps: 17 | Train Loss: 0.189 Vali Loss: 1.485 Vali Acc: 0.584 Test Loss: 1.485 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.183001279830933
Epoch: 10, Steps: 17 | Train Loss: 0.157 Vali Loss: 1.476 Vali Acc: 0.594 Test Loss: 1.476 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.880366086959839
Epoch: 11, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.384 Vali Acc: 0.625 Test Loss: 1.384 Test Acc: 0.625
Validation loss decreased (-0.604086 --> -0.624560).  Saving model ...
Epoch: 12 cost time: 5.149704217910767
Epoch: 12, Steps: 17 | Train Loss: 0.082 Vali Loss: 2.112 Vali Acc: 0.560 Test Loss: 2.112 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.187701940536499
Epoch: 13, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.901 Vali Acc: 0.577 Test Loss: 1.901 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.289190292358398
Epoch: 14, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.943 Vali Acc: 0.587 Test Loss: 1.943 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.594273805618286
Epoch: 15, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.269 Vali Acc: 0.584 Test Loss: 2.269 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.184443712234497
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.347 Vali Acc: 0.587 Test Loss: 2.347 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.622073173522949
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 2.013 Vali Acc: 0.594 Test Loss: 2.013 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.409454107284546
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 2.902 Vali Acc: 0.553 Test Loss: 2.902 Test Acc: 0.553
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.933283805847168
Epoch: 19, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.256 Vali Acc: 0.594 Test Loss: 2.256 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.500413656234741
Epoch: 20, Steps: 17 | Train Loss: 0.029 Vali Loss: 3.628 Vali Acc: 0.560 Test Loss: 3.628 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.755661964416504
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 2.646 Vali Acc: 0.577 Test Loss: 2.646 Test Acc: 0.577
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 381122
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.949418544769287
Epoch: 1, Steps: 17 | Train Loss: 0.725 Vali Loss: 0.761 Vali Acc: 0.519 Test Loss: 0.761 Test Acc: 0.519
Validation loss decreased (inf --> -0.518764).  Saving model ...
Epoch: 2 cost time: 4.566762685775757
Epoch: 2, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.773 Vali Acc: 0.532 Test Loss: 0.773 Test Acc: 0.532
Validation loss decreased (-0.518764 --> -0.532415).  Saving model ...
Epoch: 3 cost time: 4.819497585296631
Epoch: 3, Steps: 17 | Train Loss: 0.450 Vali Loss: 1.057 Vali Acc: 0.536 Test Loss: 1.057 Test Acc: 0.536
Validation loss decreased (-0.532415 --> -0.535826).  Saving model ...
Epoch: 4 cost time: 4.767540454864502
Epoch: 4, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.861 Vali Acc: 0.590 Test Loss: 0.861 Test Acc: 0.590
Validation loss decreased (-0.535826 --> -0.590435).  Saving model ...
Epoch: 5 cost time: 5.223905324935913
Epoch: 5, Steps: 17 | Train Loss: 0.377 Vali Loss: 1.064 Vali Acc: 0.553 Test Loss: 1.064 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.2849204540252686
Epoch: 6, Steps: 17 | Train Loss: 0.459 Vali Loss: 1.072 Vali Acc: 0.560 Test Loss: 1.072 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.515933990478516
Epoch: 7, Steps: 17 | Train Loss: 0.449 Vali Loss: 2.181 Vali Acc: 0.522 Test Loss: 2.181 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.320114850997925
Epoch: 8, Steps: 17 | Train Loss: 0.419 Vali Loss: 1.296 Vali Acc: 0.573 Test Loss: 1.296 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.274876356124878
Epoch: 9, Steps: 17 | Train Loss: 0.253 Vali Loss: 1.512 Vali Acc: 0.570 Test Loss: 1.512 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.42901349067688
Epoch: 10, Steps: 17 | Train Loss: 0.228 Vali Loss: 2.293 Vali Acc: 0.539 Test Loss: 2.293 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.339261293411255
Epoch: 11, Steps: 17 | Train Loss: 0.245 Vali Loss: 1.488 Vali Acc: 0.567 Test Loss: 1.488 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.585005760192871
Epoch: 12, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.479 Vali Acc: 0.594 Test Loss: 1.479 Test Acc: 0.594
Validation loss decreased (-0.590435 --> -0.593842).  Saving model ...
Epoch: 13 cost time: 5.098404169082642
Epoch: 13, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.881 Vali Acc: 0.570 Test Loss: 1.881 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.5081260204315186
Epoch: 14, Steps: 17 | Train Loss: 0.206 Vali Loss: 2.494 Vali Acc: 0.536 Test Loss: 2.494 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.028262376785278
Epoch: 15, Steps: 17 | Train Loss: 0.225 Vali Loss: 2.021 Vali Acc: 0.573 Test Loss: 2.021 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.313780784606934
Epoch: 16, Steps: 17 | Train Loss: 0.201 Vali Loss: 2.916 Vali Acc: 0.553 Test Loss: 2.916 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.142192602157593
Epoch: 17, Steps: 17 | Train Loss: 0.102 Vali Loss: 2.394 Vali Acc: 0.580 Test Loss: 2.394 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.52868914604187
Epoch: 18, Steps: 17 | Train Loss: 0.100 Vali Loss: 3.218 Vali Acc: 0.553 Test Loss: 3.218 Test Acc: 0.553
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.506058931350708
Epoch: 19, Steps: 17 | Train Loss: 0.059 Vali Loss: 2.482 Vali Acc: 0.587 Test Loss: 2.482 Test Acc: 0.587
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.6887242794036865
Epoch: 20, Steps: 17 | Train Loss: 0.053 Vali Loss: 2.699 Vali Acc: 0.560 Test Loss: 2.699 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.721430063247681
Epoch: 21, Steps: 17 | Train Loss: 0.045 Vali Loss: 3.081 Vali Acc: 0.553 Test Loss: 3.081 Test Acc: 0.553
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.10193395614624
Epoch: 22, Steps: 17 | Train Loss: 0.039 Vali Loss: 2.944 Vali Acc: 0.549 Test Loss: 2.944 Test Acc: 0.549
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5938566552901023
model parameter : 381122
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.675718307495117
Epoch: 1, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.764 Vali Acc: 0.505 Test Loss: 0.764 Test Acc: 0.505
Validation loss decreased (inf --> -0.505112).  Saving model ...
Epoch: 2 cost time: 5.15985631942749
Epoch: 2, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.713 Vali Acc: 0.529 Test Loss: 0.713 Test Acc: 0.529
Validation loss decreased (-0.505112 --> -0.529003).  Saving model ...
Epoch: 3 cost time: 5.537010669708252
Epoch: 3, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.934 Vali Acc: 0.529 Test Loss: 0.934 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.98240852355957
Epoch: 4, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.794 Vali Acc: 0.556 Test Loss: 0.794 Test Acc: 0.556
Validation loss decreased (-0.529003 --> -0.556306).  Saving model ...
Epoch: 5 cost time: 5.193576812744141
Epoch: 5, Steps: 17 | Train Loss: 0.379 Vali Loss: 1.173 Vali Acc: 0.515 Test Loss: 1.173 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.067042589187622
Epoch: 6, Steps: 17 | Train Loss: 0.429 Vali Loss: 1.003 Vali Acc: 0.546 Test Loss: 1.003 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.212553977966309
Epoch: 7, Steps: 17 | Train Loss: 0.357 Vali Loss: 2.291 Vali Acc: 0.515 Test Loss: 2.291 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.147314071655273
Epoch: 8, Steps: 17 | Train Loss: 0.303 Vali Loss: 1.195 Vali Acc: 0.556 Test Loss: 1.195 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.0548295974731445
Epoch: 9, Steps: 17 | Train Loss: 0.304 Vali Loss: 1.816 Vali Acc: 0.543 Test Loss: 1.816 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.353344202041626
Epoch: 10, Steps: 17 | Train Loss: 0.235 Vali Loss: 2.643 Vali Acc: 0.505 Test Loss: 2.643 Test Acc: 0.505
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.056137323379517
Epoch: 11, Steps: 17 | Train Loss: 0.281 Vali Loss: 1.601 Vali Acc: 0.546 Test Loss: 1.601 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.965944766998291
Epoch: 12, Steps: 17 | Train Loss: 0.185 Vali Loss: 1.876 Vali Acc: 0.549 Test Loss: 1.876 Test Acc: 0.549
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.7041175365448
Epoch: 13, Steps: 17 | Train Loss: 0.179 Vali Loss: 2.386 Vali Acc: 0.522 Test Loss: 2.386 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.969129800796509
Epoch: 14, Steps: 17 | Train Loss: 0.134 Vali Loss: 2.445 Vali Acc: 0.532 Test Loss: 2.445 Test Acc: 0.532
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5563139931740614
model parameter : 381122
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.260599851608276
Epoch: 1, Steps: 17 | Train Loss: 0.694 Vali Loss: 0.796 Vali Acc: 0.502 Test Loss: 0.796 Test Acc: 0.502
Validation loss decreased (inf --> -0.501699).  Saving model ...
Epoch: 2 cost time: 4.898019790649414
Epoch: 2, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.893 Vali Acc: 0.502 Test Loss: 0.893 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.26171350479126
Epoch: 3, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.857 Vali Acc: 0.502 Test Loss: 0.857 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.9366772174835205
Epoch: 4, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.752 Vali Acc: 0.498 Test Loss: 0.752 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.197813034057617
Epoch: 5, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.737 Vali Acc: 0.498 Test Loss: 0.737 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.131574869155884
Epoch: 6, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.683 Vali Acc: 0.570 Test Loss: 0.683 Test Acc: 0.570
Validation loss decreased (-0.501699 --> -0.569959).  Saving model ...
Epoch: 7 cost time: 4.697633504867554
Epoch: 7, Steps: 17 | Train Loss: 0.555 Vali Loss: 1.403 Vali Acc: 0.502 Test Loss: 1.403 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.622496128082275
Epoch: 8, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.635 Vali Acc: 0.618 Test Loss: 0.635 Test Acc: 0.618
Validation loss decreased (-0.569959 --> -0.617741).  Saving model ...
Epoch: 9 cost time: 5.110682249069214
Epoch: 9, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.651 Vali Acc: 0.625 Test Loss: 0.651 Test Acc: 0.625
Validation loss decreased (-0.617741 --> -0.624567).  Saving model ...
Epoch: 10 cost time: 5.34250283241272
Epoch: 10, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.679 Vali Acc: 0.625 Test Loss: 0.679 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.153557538986206
Epoch: 11, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.680 Vali Acc: 0.597 Test Loss: 0.680 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.682029962539673
Epoch: 12, Steps: 17 | Train Loss: 0.407 Vali Loss: 1.125 Vali Acc: 0.512 Test Loss: 1.125 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.234231948852539
Epoch: 13, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.710 Vali Acc: 0.611 Test Loss: 0.710 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.3800671100616455
Epoch: 14, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.816 Vali Acc: 0.608 Test Loss: 0.816 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.9223997592926025
Epoch: 15, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.878 Vali Acc: 0.594 Test Loss: 0.878 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.302654504776001
Epoch: 16, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.840 Vali Acc: 0.590 Test Loss: 0.840 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.652738332748413
Epoch: 17, Steps: 17 | Train Loss: 0.283 Vali Loss: 2.236 Vali Acc: 0.498 Test Loss: 2.236 Test Acc: 0.498
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.812558650970459
Epoch: 18, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.923 Vali Acc: 0.621 Test Loss: 0.923 Test Acc: 0.621
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.793379545211792
Epoch: 19, Steps: 17 | Train Loss: 0.405 Vali Loss: 1.337 Vali Acc: 0.567 Test Loss: 1.337 Test Acc: 0.567
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 381122
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.176618814468384
Epoch: 1, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.774 Vali Acc: 0.502 Test Loss: 0.774 Test Acc: 0.502
Validation loss decreased (inf --> -0.501699).  Saving model ...
Epoch: 2 cost time: 4.899847030639648
Epoch: 2, Steps: 17 | Train Loss: 0.613 Vali Loss: 1.083 Vali Acc: 0.502 Test Loss: 1.083 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.286724090576172
Epoch: 3, Steps: 17 | Train Loss: 0.589 Vali Loss: 1.420 Vali Acc: 0.502 Test Loss: 1.420 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.35665488243103
Epoch: 4, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.733 Vali Acc: 0.498 Test Loss: 0.733 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.86634635925293
Epoch: 5, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.878 Vali Acc: 0.509 Test Loss: 0.878 Test Acc: 0.509
Validation loss decreased (-0.501699 --> -0.508524).  Saving model ...
Epoch: 6 cost time: 5.227145671844482
Epoch: 6, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.746 Vali Acc: 0.512 Test Loss: 0.746 Test Acc: 0.512
Validation loss decreased (-0.508524 --> -0.511938).  Saving model ...
Epoch: 7 cost time: 4.863459825515747
Epoch: 7, Steps: 17 | Train Loss: 0.514 Vali Loss: 1.553 Vali Acc: 0.502 Test Loss: 1.553 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.314893960952759
Epoch: 8, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.928 Vali Acc: 0.498 Test Loss: 0.928 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.299527645111084
Epoch: 9, Steps: 17 | Train Loss: 0.429 Vali Loss: 1.338 Vali Acc: 0.512 Test Loss: 1.338 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.069398880004883
Epoch: 10, Steps: 17 | Train Loss: 0.461 Vali Loss: 1.897 Vali Acc: 0.502 Test Loss: 1.897 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.018988132476807
Epoch: 11, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.803 Vali Acc: 0.594 Test Loss: 0.803 Test Acc: 0.594
Validation loss decreased (-0.511938 --> -0.593849).  Saving model ...
Epoch: 12 cost time: 5.1513566970825195
Epoch: 12, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.869 Vali Acc: 0.601 Test Loss: 0.869 Test Acc: 0.601
Validation loss decreased (-0.593849 --> -0.600674).  Saving model ...
Epoch: 13 cost time: 4.820433139801025
Epoch: 13, Steps: 17 | Train Loss: 0.354 Vali Loss: 1.512 Vali Acc: 0.529 Test Loss: 1.512 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.559491395950317
Epoch: 14, Steps: 17 | Train Loss: 0.370 Vali Loss: 1.002 Vali Acc: 0.608 Test Loss: 1.002 Test Acc: 0.608
Validation loss decreased (-0.600674 --> -0.607499).  Saving model ...
Epoch: 15 cost time: 4.523821592330933
Epoch: 15, Steps: 17 | Train Loss: 0.390 Vali Loss: 1.292 Vali Acc: 0.625 Test Loss: 1.292 Test Acc: 0.625
Validation loss decreased (-0.607499 --> -0.624560).  Saving model ...
Epoch: 16 cost time: 5.7351226806640625
Epoch: 16, Steps: 17 | Train Loss: 0.357 Vali Loss: 1.541 Vali Acc: 0.611 Test Loss: 1.541 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.231707572937012
Epoch: 17, Steps: 17 | Train Loss: 0.460 Vali Loss: 2.100 Vali Acc: 0.604 Test Loss: 2.100 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.178002119064331
Epoch: 18, Steps: 17 | Train Loss: 0.316 Vali Loss: 2.062 Vali Acc: 0.590 Test Loss: 2.062 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.20327353477478
Epoch: 19, Steps: 17 | Train Loss: 0.441 Vali Loss: 1.939 Vali Acc: 0.614 Test Loss: 1.939 Test Acc: 0.614
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.360499382019043
Epoch: 20, Steps: 17 | Train Loss: 0.322 Vali Loss: 2.161 Vali Acc: 0.567 Test Loss: 2.161 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.283047199249268
Epoch: 21, Steps: 17 | Train Loss: 0.426 Vali Loss: 3.027 Vali Acc: 0.604 Test Loss: 3.027 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.019574165344238
Epoch: 22, Steps: 17 | Train Loss: 0.536 Vali Loss: 2.341 Vali Acc: 0.570 Test Loss: 2.341 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.015617370605469
Epoch: 23, Steps: 17 | Train Loss: 0.330 Vali Loss: 3.187 Vali Acc: 0.584 Test Loss: 3.187 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.982633829116821
Epoch: 24, Steps: 17 | Train Loss: 0.336 Vali Loss: 2.938 Vali Acc: 0.587 Test Loss: 2.938 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.494549751281738
Epoch: 25, Steps: 17 | Train Loss: 0.324 Vali Loss: 2.452 Vali Acc: 0.590 Test Loss: 2.452 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6245733788395904
model parameter : 381122
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.39540696144104
Epoch: 1, Steps: 17 | Train Loss: 0.675 Vali Loss: 0.724 Vali Acc: 0.567 Test Loss: 0.724 Test Acc: 0.567
Validation loss decreased (inf --> -0.566546).  Saving model ...
Epoch: 2 cost time: 5.216922283172607
Epoch: 2, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.639 Vali Acc: 0.672 Test Loss: 0.639 Test Acc: 0.672
Validation loss decreased (-0.566546 --> -0.672349).  Saving model ...
Epoch: 3 cost time: 5.225388050079346
Epoch: 3, Steps: 17 | Train Loss: 0.364 Vali Loss: 1.654 Vali Acc: 0.526 Test Loss: 1.654 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.245768785476685
Epoch: 4, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.742 Vali Acc: 0.631 Test Loss: 0.742 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.033133268356323
Epoch: 5, Steps: 17 | Train Loss: 0.396 Vali Loss: 1.107 Vali Acc: 0.652 Test Loss: 1.107 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.634164333343506
Epoch: 6, Steps: 17 | Train Loss: 0.194 Vali Loss: 2.001 Vali Acc: 0.553 Test Loss: 2.001 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.875692844390869
Epoch: 7, Steps: 17 | Train Loss: 0.221 Vali Loss: 1.421 Vali Acc: 0.625 Test Loss: 1.421 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.7428648471832275
Epoch: 8, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.536 Vali Acc: 0.638 Test Loss: 1.536 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.928351640701294
Epoch: 9, Steps: 17 | Train Loss: 0.096 Vali Loss: 1.641 Vali Acc: 0.648 Test Loss: 1.641 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.417690992355347
Epoch: 10, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.838 Vali Acc: 0.648 Test Loss: 1.838 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.425874471664429
Epoch: 11, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.458 Vali Acc: 0.635 Test Loss: 1.458 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.906767129898071
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.838 Vali Acc: 0.652 Test Loss: 1.838 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6723549488054608
model parameter : 331970
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.187611818313599
Epoch: 1, Steps: 17 | Train Loss: 0.674 Vali Loss: 0.710 Vali Acc: 0.587 Test Loss: 0.710 Test Acc: 0.587
Validation loss decreased (inf --> -0.587024).  Saving model ...
Epoch: 2 cost time: 5.125828742980957
Epoch: 2, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.680 Vali Acc: 0.621 Test Loss: 0.680 Test Acc: 0.621
Validation loss decreased (-0.587024 --> -0.621154).  Saving model ...
Epoch: 3 cost time: 5.078303813934326
Epoch: 3, Steps: 17 | Train Loss: 0.370 Vali Loss: 1.396 Vali Acc: 0.553 Test Loss: 1.396 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.919981002807617
Epoch: 4, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.738 Vali Acc: 0.621 Test Loss: 0.738 Test Acc: 0.621
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.932196378707886
Epoch: 5, Steps: 17 | Train Loss: 0.387 Vali Loss: 1.208 Vali Acc: 0.601 Test Loss: 1.208 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.863711833953857
Epoch: 6, Steps: 17 | Train Loss: 0.228 Vali Loss: 1.138 Vali Acc: 0.635 Test Loss: 1.138 Test Acc: 0.635
Validation loss decreased (-0.621154 --> -0.634801).  Saving model ...
Epoch: 7 cost time: 4.558082818984985
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 1.307 Vali Acc: 0.621 Test Loss: 1.307 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.676111459732056
Epoch: 8, Steps: 17 | Train Loss: 0.147 Vali Loss: 1.149 Vali Acc: 0.648 Test Loss: 1.149 Test Acc: 0.648
Validation loss decreased (-0.634801 --> -0.648453).  Saving model ...
Epoch: 9 cost time: 4.6070802211761475
Epoch: 9, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.394 Vali Acc: 0.645 Test Loss: 1.394 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.387129783630371
Epoch: 10, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.954 Vali Acc: 0.621 Test Loss: 1.954 Test Acc: 0.621
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.032476425170898
Epoch: 11, Steps: 17 | Train Loss: 0.138 Vali Loss: 1.554 Vali Acc: 0.645 Test Loss: 1.554 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.284258604049683
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.715 Vali Acc: 0.648 Test Loss: 1.715 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.04845929145813
Epoch: 13, Steps: 17 | Train Loss: 0.067 Vali Loss: 2.665 Vali Acc: 0.597 Test Loss: 2.665 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.362671375274658
Epoch: 14, Steps: 17 | Train Loss: 0.067 Vali Loss: 2.386 Vali Acc: 0.635 Test Loss: 2.386 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.331255912780762
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.961 Vali Acc: 0.642 Test Loss: 1.961 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.2423694133758545
Epoch: 16, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.678 Vali Acc: 0.621 Test Loss: 2.678 Test Acc: 0.621
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.100676774978638
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.838 Vali Acc: 0.621 Test Loss: 2.838 Test Acc: 0.621
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.991252899169922
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.346 Vali Acc: 0.662 Test Loss: 2.346 Test Acc: 0.662
Validation loss decreased (-0.648453 --> -0.662093).  Saving model ...
Epoch: 19 cost time: 5.240194320678711
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.744 Vali Acc: 0.645 Test Loss: 2.744 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.0503551959991455
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 3.337 Vali Acc: 0.618 Test Loss: 3.337 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.070563793182373
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.655 Vali Acc: 0.642 Test Loss: 2.655 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.1057517528533936
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 3.666 Vali Acc: 0.604 Test Loss: 3.666 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.079793930053711
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 2.728 Vali Acc: 0.631 Test Loss: 2.728 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.064909934997559
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 2.868 Vali Acc: 0.625 Test Loss: 2.868 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.982542037963867
Epoch: 25, Steps: 17 | Train Loss: 0.018 Vali Loss: 3.005 Vali Acc: 0.642 Test Loss: 3.005 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.416767597198486
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 3.043 Vali Acc: 0.648 Test Loss: 3.043 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.554651737213135
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 3.473 Vali Acc: 0.625 Test Loss: 3.473 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.4464051723480225
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 3.229 Vali Acc: 0.614 Test Loss: 3.229 Test Acc: 0.614
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6621160409556314
model parameter : 331970
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.738081932067871
Epoch: 1, Steps: 17 | Train Loss: 0.687 Vali Loss: 0.748 Vali Acc: 0.546 Test Loss: 0.748 Test Acc: 0.546
Validation loss decreased (inf --> -0.546068).  Saving model ...
Epoch: 2 cost time: 5.0699498653411865
Epoch: 2, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.696 Vali Acc: 0.604 Test Loss: 0.696 Test Acc: 0.604
Validation loss decreased (-0.546068 --> -0.604089).  Saving model ...
Epoch: 3 cost time: 5.047689199447632
Epoch: 3, Steps: 17 | Train Loss: 0.418 Vali Loss: 1.755 Vali Acc: 0.509 Test Loss: 1.755 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.024521112442017
Epoch: 4, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.911 Vali Acc: 0.635 Test Loss: 0.911 Test Acc: 0.635
Validation loss decreased (-0.604089 --> -0.634803).  Saving model ...
Epoch: 5 cost time: 5.0128493309021
Epoch: 5, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.805 Vali Acc: 0.621 Test Loss: 0.805 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.997140169143677
Epoch: 6, Steps: 17 | Train Loss: 0.251 Vali Loss: 1.978 Vali Acc: 0.536 Test Loss: 1.978 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.64624547958374
Epoch: 7, Steps: 17 | Train Loss: 0.235 Vali Loss: 1.262 Vali Acc: 0.614 Test Loss: 1.262 Test Acc: 0.614
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.359645128250122
Epoch: 8, Steps: 17 | Train Loss: 0.148 Vali Loss: 1.505 Vali Acc: 0.601 Test Loss: 1.505 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.759140729904175
Epoch: 9, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.714 Vali Acc: 0.594 Test Loss: 1.714 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.792459011077881
Epoch: 10, Steps: 17 | Train Loss: 0.212 Vali Loss: 1.614 Vali Acc: 0.618 Test Loss: 1.614 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.814881324768066
Epoch: 11, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.499 Vali Acc: 0.631 Test Loss: 1.499 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.721019506454468
Epoch: 12, Steps: 17 | Train Loss: 0.075 Vali Loss: 2.139 Vali Acc: 0.604 Test Loss: 2.139 Test Acc: 0.604
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.062698125839233
Epoch: 13, Steps: 17 | Train Loss: 0.068 Vali Loss: 2.096 Vali Acc: 0.601 Test Loss: 2.096 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.0166754722595215
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 2.160 Vali Acc: 0.594 Test Loss: 2.160 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6348122866894198
model parameter : 331970
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.548631191253662
Epoch: 1, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.709 Vali Acc: 0.567 Test Loss: 0.709 Test Acc: 0.567
Validation loss decreased (inf --> -0.566546).  Saving model ...
Epoch: 2 cost time: 5.915392875671387
Epoch: 2, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.712 Vali Acc: 0.570 Test Loss: 0.712 Test Acc: 0.570
Validation loss decreased (-0.566546 --> -0.569959).  Saving model ...
Epoch: 3 cost time: 5.205637216567993
Epoch: 3, Steps: 17 | Train Loss: 0.428 Vali Loss: 1.343 Vali Acc: 0.549 Test Loss: 1.343 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.329680681228638
Epoch: 4, Steps: 17 | Train Loss: 0.345 Vali Loss: 1.064 Vali Acc: 0.601 Test Loss: 1.064 Test Acc: 0.601
Validation loss decreased (-0.569959 --> -0.600672).  Saving model ...
Epoch: 5 cost time: 4.922365427017212
Epoch: 5, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.817 Vali Acc: 0.638 Test Loss: 0.817 Test Acc: 0.638
Validation loss decreased (-0.600672 --> -0.638217).  Saving model ...
Epoch: 6 cost time: 5.161299228668213
Epoch: 6, Steps: 17 | Train Loss: 0.208 Vali Loss: 1.297 Vali Acc: 0.597 Test Loss: 1.297 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.052079677581787
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 1.574 Vali Acc: 0.580 Test Loss: 1.574 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.2658371925354
Epoch: 8, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.231 Vali Acc: 0.625 Test Loss: 1.231 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.447375774383545
Epoch: 9, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.320 Vali Acc: 0.597 Test Loss: 1.320 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.805818319320679
Epoch: 10, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.590 Vali Acc: 0.590 Test Loss: 1.590 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.1764726638793945
Epoch: 11, Steps: 17 | Train Loss: 0.069 Vali Loss: 2.224 Vali Acc: 0.584 Test Loss: 2.224 Test Acc: 0.584
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.01162052154541
Epoch: 12, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.648 Vali Acc: 0.628 Test Loss: 1.648 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.058014392852783
Epoch: 13, Steps: 17 | Train Loss: 0.044 Vali Loss: 2.407 Vali Acc: 0.584 Test Loss: 2.407 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.665966510772705
Epoch: 14, Steps: 17 | Train Loss: 0.033 Vali Loss: 2.660 Vali Acc: 0.584 Test Loss: 2.660 Test Acc: 0.584
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.0340025424957275
Epoch: 15, Steps: 17 | Train Loss: 0.034 Vali Loss: 2.829 Vali Acc: 0.597 Test Loss: 2.829 Test Acc: 0.597
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6382252559726962
model parameter : 331970
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.818114280700684
Epoch: 1, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.771 Vali Acc: 0.532 Test Loss: 0.771 Test Acc: 0.532
Validation loss decreased (inf --> -0.532416).  Saving model ...
Epoch: 2 cost time: 5.541781187057495
Epoch: 2, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.807 Vali Acc: 0.584 Test Loss: 0.807 Test Acc: 0.584
Validation loss decreased (-0.532416 --> -0.583610).  Saving model ...
Epoch: 3 cost time: 5.758050203323364
Epoch: 3, Steps: 17 | Train Loss: 0.452 Vali Loss: 1.232 Vali Acc: 0.553 Test Loss: 1.232 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.085416555404663
Epoch: 4, Steps: 17 | Train Loss: 0.349 Vali Loss: 1.215 Vali Acc: 0.594 Test Loss: 1.215 Test Acc: 0.594
Validation loss decreased (-0.583610 --> -0.593845).  Saving model ...
Epoch: 5 cost time: 5.1993632316589355
Epoch: 5, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.910 Vali Acc: 0.631 Test Loss: 0.910 Test Acc: 0.631
Validation loss decreased (-0.593845 --> -0.631390).  Saving model ...
Epoch: 6 cost time: 5.124289274215698
Epoch: 6, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.645 Vali Acc: 0.573 Test Loss: 1.645 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.377125263214111
Epoch: 7, Steps: 17 | Train Loss: 0.229 Vali Loss: 1.377 Vali Acc: 0.618 Test Loss: 1.377 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.99517035484314
Epoch: 8, Steps: 17 | Train Loss: 0.212 Vali Loss: 2.043 Vali Acc: 0.560 Test Loss: 2.043 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.1336588859558105
Epoch: 9, Steps: 17 | Train Loss: 0.139 Vali Loss: 1.904 Vali Acc: 0.587 Test Loss: 1.904 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.746038198471069
Epoch: 10, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.763 Vali Acc: 0.621 Test Loss: 1.763 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.436563730239868
Epoch: 11, Steps: 17 | Train Loss: 0.081 Vali Loss: 2.168 Vali Acc: 0.584 Test Loss: 2.168 Test Acc: 0.584
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.903569936752319
Epoch: 12, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.528 Vali Acc: 0.648 Test Loss: 1.528 Test Acc: 0.648
Validation loss decreased (-0.631390 --> -0.648449).  Saving model ...
Epoch: 13 cost time: 4.703489065170288
Epoch: 13, Steps: 17 | Train Loss: 0.081 Vali Loss: 2.693 Vali Acc: 0.604 Test Loss: 2.693 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.3755810260772705
Epoch: 14, Steps: 17 | Train Loss: 0.074 Vali Loss: 2.672 Vali Acc: 0.618 Test Loss: 2.672 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.914877653121948
Epoch: 15, Steps: 17 | Train Loss: 0.104 Vali Loss: 2.560 Vali Acc: 0.608 Test Loss: 2.560 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.821487903594971
Epoch: 16, Steps: 17 | Train Loss: 0.062 Vali Loss: 3.091 Vali Acc: 0.604 Test Loss: 3.091 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.112555980682373
Epoch: 17, Steps: 17 | Train Loss: 0.074 Vali Loss: 2.417 Vali Acc: 0.611 Test Loss: 2.417 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.972208499908447
Epoch: 18, Steps: 17 | Train Loss: 0.076 Vali Loss: 3.169 Vali Acc: 0.611 Test Loss: 3.169 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.7523040771484375
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 3.015 Vali Acc: 0.635 Test Loss: 3.015 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.488200902938843
Epoch: 20, Steps: 17 | Train Loss: 0.021 Vali Loss: 3.770 Vali Acc: 0.587 Test Loss: 3.770 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.681821346282959
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.922 Vali Acc: 0.625 Test Loss: 2.922 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.604202032089233
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 4.958 Vali Acc: 0.553 Test Loss: 4.958 Test Acc: 0.553
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6484641638225256
model parameter : 331970
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.533827781677246
Epoch: 1, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.771 Vali Acc: 0.515 Test Loss: 0.771 Test Acc: 0.515
Validation loss decreased (inf --> -0.515351).  Saving model ...
Epoch: 2 cost time: 4.381872892379761
Epoch: 2, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.803 Vali Acc: 0.567 Test Loss: 0.803 Test Acc: 0.567
Validation loss decreased (-0.515351 --> -0.566545).  Saving model ...
Epoch: 3 cost time: 4.640217304229736
Epoch: 3, Steps: 17 | Train Loss: 0.489 Vali Loss: 1.062 Vali Acc: 0.532 Test Loss: 1.062 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.665597200393677
Epoch: 4, Steps: 17 | Train Loss: 0.397 Vali Loss: 1.320 Vali Acc: 0.512 Test Loss: 1.320 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.378214359283447
Epoch: 5, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.781 Vali Acc: 0.625 Test Loss: 0.781 Test Acc: 0.625
Validation loss decreased (-0.566545 --> -0.624566).  Saving model ...
Epoch: 6 cost time: 4.662331819534302
Epoch: 6, Steps: 17 | Train Loss: 0.306 Vali Loss: 1.165 Vali Acc: 0.567 Test Loss: 1.165 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.807313919067383
Epoch: 7, Steps: 17 | Train Loss: 0.228 Vali Loss: 1.755 Vali Acc: 0.546 Test Loss: 1.755 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.643188238143921
Epoch: 8, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.986 Vali Acc: 0.621 Test Loss: 0.986 Test Acc: 0.621
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.050797462463379
Epoch: 9, Steps: 17 | Train Loss: 0.195 Vali Loss: 1.174 Vali Acc: 0.608 Test Loss: 1.174 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.800080299377441
Epoch: 10, Steps: 17 | Train Loss: 0.145 Vali Loss: 1.309 Vali Acc: 0.580 Test Loss: 1.309 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.80729866027832
Epoch: 11, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.696 Vali Acc: 0.567 Test Loss: 1.696 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.185089349746704
Epoch: 12, Steps: 17 | Train Loss: 0.130 Vali Loss: 1.342 Vali Acc: 0.631 Test Loss: 1.342 Test Acc: 0.631
Validation loss decreased (-0.624566 --> -0.631386).  Saving model ...
Epoch: 13 cost time: 4.305937767028809
Epoch: 13, Steps: 17 | Train Loss: 0.123 Vali Loss: 2.697 Vali Acc: 0.529 Test Loss: 2.697 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.764783143997192
Epoch: 14, Steps: 17 | Train Loss: 0.114 Vali Loss: 2.275 Vali Acc: 0.577 Test Loss: 2.275 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.230300664901733
Epoch: 15, Steps: 17 | Train Loss: 0.130 Vali Loss: 2.766 Vali Acc: 0.563 Test Loss: 2.766 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.179494619369507
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.873 Vali Acc: 0.608 Test Loss: 1.873 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.231720924377441
Epoch: 17, Steps: 17 | Train Loss: 0.041 Vali Loss: 2.733 Vali Acc: 0.556 Test Loss: 2.733 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.46712327003479
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.999 Vali Acc: 0.567 Test Loss: 2.999 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.7768168449401855
Epoch: 19, Steps: 17 | Train Loss: 0.070 Vali Loss: 3.091 Vali Acc: 0.577 Test Loss: 3.091 Test Acc: 0.577
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.85582160949707
Epoch: 20, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.448 Vali Acc: 0.608 Test Loss: 2.448 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.724905490875244
Epoch: 21, Steps: 17 | Train Loss: 0.033 Vali Loss: 2.660 Vali Acc: 0.563 Test Loss: 2.660 Test Acc: 0.563
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.877649784088135
Epoch: 22, Steps: 17 | Train Loss: 0.033 Vali Loss: 5.131 Vali Acc: 0.560 Test Loss: 5.131 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6313993174061433
model parameter : 331970
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.799555778503418
Epoch: 1, Steps: 17 | Train Loss: 0.694 Vali Loss: 0.749 Vali Acc: 0.515 Test Loss: 0.749 Test Acc: 0.515
Validation loss decreased (inf --> -0.515351).  Saving model ...
Epoch: 2 cost time: 5.184718132019043
Epoch: 2, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.821 Vali Acc: 0.560 Test Loss: 0.821 Test Acc: 0.560
Validation loss decreased (-0.515351 --> -0.559719).  Saving model ...
Epoch: 3 cost time: 5.698397636413574
Epoch: 3, Steps: 17 | Train Loss: 0.487 Vali Loss: 1.095 Vali Acc: 0.522 Test Loss: 1.095 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.776964426040649
Epoch: 4, Steps: 17 | Train Loss: 0.404 Vali Loss: 1.389 Vali Acc: 0.522 Test Loss: 1.389 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.086146116256714
Epoch: 5, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.922 Vali Acc: 0.601 Test Loss: 0.922 Test Acc: 0.601
Validation loss decreased (-0.559719 --> -0.600673).  Saving model ...
Epoch: 6 cost time: 5.495851516723633
Epoch: 6, Steps: 17 | Train Loss: 0.327 Vali Loss: 1.446 Vali Acc: 0.546 Test Loss: 1.446 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.691254138946533
Epoch: 7, Steps: 17 | Train Loss: 0.338 Vali Loss: 1.415 Vali Acc: 0.549 Test Loss: 1.415 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.407428979873657
Epoch: 8, Steps: 17 | Train Loss: 0.276 Vali Loss: 1.189 Vali Acc: 0.584 Test Loss: 1.189 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.549804210662842
Epoch: 9, Steps: 17 | Train Loss: 0.248 Vali Loss: 1.212 Vali Acc: 0.577 Test Loss: 1.212 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.8879759311676025
Epoch: 10, Steps: 17 | Train Loss: 0.206 Vali Loss: 1.377 Vali Acc: 0.570 Test Loss: 1.377 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.420361518859863
Epoch: 11, Steps: 17 | Train Loss: 0.159 Vali Loss: 1.937 Vali Acc: 0.553 Test Loss: 1.937 Test Acc: 0.553
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.6271679401397705
Epoch: 12, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.598 Vali Acc: 0.570 Test Loss: 1.598 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.08608078956604
Epoch: 13, Steps: 17 | Train Loss: 0.169 Vali Loss: 2.508 Vali Acc: 0.567 Test Loss: 2.508 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.034796953201294
Epoch: 14, Steps: 17 | Train Loss: 0.142 Vali Loss: 1.921 Vali Acc: 0.556 Test Loss: 1.921 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.792308807373047
Epoch: 15, Steps: 17 | Train Loss: 0.073 Vali Loss: 2.176 Vali Acc: 0.543 Test Loss: 2.176 Test Acc: 0.543
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6006825938566553
model parameter : 331970
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.934218168258667
Epoch: 1, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.832 Vali Acc: 0.502 Test Loss: 0.832 Test Acc: 0.502
Validation loss decreased (inf --> -0.501698).  Saving model ...
Epoch: 2 cost time: 4.995728969573975
Epoch: 2, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.808 Vali Acc: 0.509 Test Loss: 0.808 Test Acc: 0.509
Validation loss decreased (-0.501698 --> -0.508524).  Saving model ...
Epoch: 3 cost time: 5.167773246765137
Epoch: 3, Steps: 17 | Train Loss: 0.479 Vali Loss: 1.464 Vali Acc: 0.509 Test Loss: 1.464 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.379441738128662
Epoch: 4, Steps: 17 | Train Loss: 0.416 Vali Loss: 1.299 Vali Acc: 0.515 Test Loss: 1.299 Test Acc: 0.515
Validation loss decreased (-0.508524 --> -0.515345).  Saving model ...
Epoch: 5 cost time: 5.738741874694824
Epoch: 5, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.887 Vali Acc: 0.529 Test Loss: 0.887 Test Acc: 0.529
Validation loss decreased (-0.515345 --> -0.529001).  Saving model ...
Epoch: 6 cost time: 5.82094931602478
Epoch: 6, Steps: 17 | Train Loss: 0.306 Vali Loss: 1.310 Vali Acc: 0.532 Test Loss: 1.310 Test Acc: 0.532
Validation loss decreased (-0.529001 --> -0.532410).  Saving model ...
Epoch: 7 cost time: 4.952568531036377
Epoch: 7, Steps: 17 | Train Loss: 0.303 Vali Loss: 1.207 Vali Acc: 0.539 Test Loss: 1.207 Test Acc: 0.539
Validation loss decreased (-0.532410 --> -0.539237).  Saving model ...
Epoch: 8 cost time: 4.834368467330933
Epoch: 8, Steps: 17 | Train Loss: 0.268 Vali Loss: 1.260 Vali Acc: 0.522 Test Loss: 1.260 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.122679948806763
Epoch: 9, Steps: 17 | Train Loss: 0.232 Vali Loss: 1.326 Vali Acc: 0.536 Test Loss: 1.326 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.246719837188721
Epoch: 10, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.425 Vali Acc: 0.522 Test Loss: 1.425 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.978788137435913
Epoch: 11, Steps: 17 | Train Loss: 0.167 Vali Loss: 1.982 Vali Acc: 0.522 Test Loss: 1.982 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.510588645935059
Epoch: 12, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.695 Vali Acc: 0.543 Test Loss: 1.695 Test Acc: 0.543
Validation loss decreased (-0.539237 --> -0.542645).  Saving model ...
Epoch: 13 cost time: 5.389810562133789
Epoch: 13, Steps: 17 | Train Loss: 0.179 Vali Loss: 2.560 Vali Acc: 0.529 Test Loss: 2.560 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.6023595333099365
Epoch: 14, Steps: 17 | Train Loss: 0.142 Vali Loss: 2.663 Vali Acc: 0.536 Test Loss: 2.663 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.431833982467651
Epoch: 15, Steps: 17 | Train Loss: 0.113 Vali Loss: 2.840 Vali Acc: 0.529 Test Loss: 2.840 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.442201137542725
Epoch: 16, Steps: 17 | Train Loss: 0.088 Vali Loss: 2.657 Vali Acc: 0.546 Test Loss: 2.657 Test Acc: 0.546
Validation loss decreased (-0.542645 --> -0.546049).  Saving model ...
Epoch: 17 cost time: 5.6227428913116455
Epoch: 17, Steps: 17 | Train Loss: 0.063 Vali Loss: 2.664 Vali Acc: 0.549 Test Loss: 2.664 Test Acc: 0.549
Validation loss decreased (-0.546049 --> -0.549461).  Saving model ...
Epoch: 18 cost time: 5.633943796157837
Epoch: 18, Steps: 17 | Train Loss: 0.053 Vali Loss: 2.644 Vali Acc: 0.515 Test Loss: 2.644 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.144425868988037
Epoch: 19, Steps: 17 | Train Loss: 0.051 Vali Loss: 3.001 Vali Acc: 0.549 Test Loss: 3.001 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.025595426559448
Epoch: 20, Steps: 17 | Train Loss: 0.072 Vali Loss: 3.781 Vali Acc: 0.543 Test Loss: 3.781 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.86899995803833
Epoch: 21, Steps: 17 | Train Loss: 0.073 Vali Loss: 2.903 Vali Acc: 0.536 Test Loss: 2.903 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.099394083023071
Epoch: 22, Steps: 17 | Train Loss: 0.135 Vali Loss: 4.739 Vali Acc: 0.526 Test Loss: 4.739 Test Acc: 0.526
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.439115762710571
Epoch: 23, Steps: 17 | Train Loss: 0.103 Vali Loss: 3.590 Vali Acc: 0.539 Test Loss: 3.590 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.419379472732544
Epoch: 24, Steps: 17 | Train Loss: 0.035 Vali Loss: 3.744 Vali Acc: 0.532 Test Loss: 3.744 Test Acc: 0.532
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.861144065856934
Epoch: 25, Steps: 17 | Train Loss: 0.046 Vali Loss: 4.379 Vali Acc: 0.522 Test Loss: 4.379 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.089238882064819
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 3.748 Vali Acc: 0.536 Test Loss: 3.748 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.339395999908447
Epoch: 27, Steps: 17 | Train Loss: 0.039 Vali Loss: 3.860 Vali Acc: 0.549 Test Loss: 3.860 Test Acc: 0.549
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5494880546075085
model parameter : 331970
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.857747316360474
Epoch: 1, Steps: 17 | Train Loss: 0.694 Vali Loss: 0.921 Vali Acc: 0.502 Test Loss: 0.921 Test Acc: 0.502
Validation loss decreased (inf --> -0.501697).  Saving model ...
Epoch: 2 cost time: 4.439306735992432
Epoch: 2, Steps: 17 | Train Loss: 0.614 Vali Loss: 1.120 Vali Acc: 0.502 Test Loss: 1.120 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.494152784347534
Epoch: 3, Steps: 17 | Train Loss: 0.555 Vali Loss: 1.463 Vali Acc: 0.502 Test Loss: 1.463 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.525668382644653
Epoch: 4, Steps: 17 | Train Loss: 0.548 Vali Loss: 1.239 Vali Acc: 0.502 Test Loss: 1.239 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.610746622085571
Epoch: 5, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.657 Vali Acc: 0.638 Test Loss: 0.657 Test Acc: 0.638
Validation loss decreased (-0.501697 --> -0.638219).  Saving model ...
Epoch: 6 cost time: 4.378642320632935
Epoch: 6, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.888 Vali Acc: 0.502 Test Loss: 0.888 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.368014097213745
Epoch: 7, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.802 Vali Acc: 0.498 Test Loss: 0.802 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.9809730052948
Epoch: 8, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.695 Vali Acc: 0.580 Test Loss: 0.695 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.7770490646362305
Epoch: 9, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.660 Vali Acc: 0.618 Test Loss: 0.660 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.913748502731323
Epoch: 10, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.852 Vali Acc: 0.512 Test Loss: 0.852 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.185092210769653
Epoch: 11, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.690 Vali Acc: 0.597 Test Loss: 0.690 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.021570920944214
Epoch: 12, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.682 Vali Acc: 0.631 Test Loss: 0.682 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.038326978683472
Epoch: 13, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.693 Vali Acc: 0.611 Test Loss: 0.693 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.910162448883057
Epoch: 14, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.732 Vali Acc: 0.628 Test Loss: 0.732 Test Acc: 0.628
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.14407753944397
Epoch: 15, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.860 Vali Acc: 0.580 Test Loss: 0.860 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6382252559726962
model parameter : 331970
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.336950778961182
Epoch: 1, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.781 Vali Acc: 0.509 Test Loss: 0.781 Test Acc: 0.509
Validation loss decreased (inf --> -0.508525).  Saving model ...
Epoch: 2 cost time: 5.418783903121948
Epoch: 2, Steps: 17 | Train Loss: 0.635 Vali Loss: 1.081 Vali Acc: 0.502 Test Loss: 1.081 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.410707235336304
Epoch: 3, Steps: 17 | Train Loss: 0.575 Vali Loss: 1.690 Vali Acc: 0.502 Test Loss: 1.690 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.324682950973511
Epoch: 4, Steps: 17 | Train Loss: 0.535 Vali Loss: 1.588 Vali Acc: 0.502 Test Loss: 1.588 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.105748176574707
Epoch: 5, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.875 Vali Acc: 0.515 Test Loss: 0.875 Test Acc: 0.515
Validation loss decreased (-0.508525 --> -0.515350).  Saving model ...
Epoch: 6 cost time: 5.129196643829346
Epoch: 6, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.972 Vali Acc: 0.512 Test Loss: 0.972 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.282010793685913
Epoch: 7, Steps: 17 | Train Loss: 0.451 Vali Loss: 1.350 Vali Acc: 0.505 Test Loss: 1.350 Test Acc: 0.505
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.897557020187378
Epoch: 8, Steps: 17 | Train Loss: 0.477 Vali Loss: 1.279 Vali Acc: 0.509 Test Loss: 1.279 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.771514415740967
Epoch: 9, Steps: 17 | Train Loss: 0.405 Vali Loss: 1.161 Vali Acc: 0.522 Test Loss: 1.161 Test Acc: 0.522
Validation loss decreased (-0.515350 --> -0.522173).  Saving model ...
Epoch: 10 cost time: 4.925198078155518
Epoch: 10, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.764 Vali Acc: 0.570 Test Loss: 0.764 Test Acc: 0.570
Validation loss decreased (-0.522173 --> -0.569958).  Saving model ...
Epoch: 11 cost time: 5.55847430229187
Epoch: 11, Steps: 17 | Train Loss: 0.406 Vali Loss: 1.273 Vali Acc: 0.536 Test Loss: 1.273 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.0160627365112305
Epoch: 12, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.919 Vali Acc: 0.549 Test Loss: 0.919 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.061222791671753
Epoch: 13, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.941 Vali Acc: 0.556 Test Loss: 0.941 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.045984745025635
Epoch: 14, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.896 Vali Acc: 0.601 Test Loss: 0.896 Test Acc: 0.601
Validation loss decreased (-0.569958 --> -0.600674).  Saving model ...
Epoch: 15 cost time: 5.002373218536377
Epoch: 15, Steps: 17 | Train Loss: 0.365 Vali Loss: 1.135 Vali Acc: 0.567 Test Loss: 1.135 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.4583024978637695
Epoch: 16, Steps: 17 | Train Loss: 0.421 Vali Loss: 1.152 Vali Acc: 0.611 Test Loss: 1.152 Test Acc: 0.611
Validation loss decreased (-0.600674 --> -0.610910).  Saving model ...
Epoch: 17 cost time: 4.887372732162476
Epoch: 17, Steps: 17 | Train Loss: 0.407 Vali Loss: 1.435 Vali Acc: 0.560 Test Loss: 1.435 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.9778077602386475
Epoch: 18, Steps: 17 | Train Loss: 0.375 Vali Loss: 1.463 Vali Acc: 0.587 Test Loss: 1.463 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.96387243270874
Epoch: 19, Steps: 17 | Train Loss: 0.370 Vali Loss: 1.524 Vali Acc: 0.614 Test Loss: 1.524 Test Acc: 0.614
Validation loss decreased (-0.610910 --> -0.614319).  Saving model ...
Epoch: 20 cost time: 4.5650246143341064
Epoch: 20, Steps: 17 | Train Loss: 0.321 Vali Loss: 1.650 Vali Acc: 0.614 Test Loss: 1.650 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.372551679611206
Epoch: 21, Steps: 17 | Train Loss: 0.324 Vali Loss: 1.860 Vali Acc: 0.604 Test Loss: 1.860 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.293816089630127
Epoch: 22, Steps: 17 | Train Loss: 0.316 Vali Loss: 2.235 Vali Acc: 0.618 Test Loss: 2.235 Test Acc: 0.618
Validation loss decreased (-0.614319 --> -0.617725).  Saving model ...
Epoch: 23 cost time: 4.994825601577759
Epoch: 23, Steps: 17 | Train Loss: 0.328 Vali Loss: 2.455 Vali Acc: 0.594 Test Loss: 2.455 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.197022914886475
Epoch: 24, Steps: 17 | Train Loss: 0.312 Vali Loss: 2.496 Vali Acc: 0.546 Test Loss: 2.496 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.181387662887573
Epoch: 25, Steps: 17 | Train Loss: 0.300 Vali Loss: 2.602 Vali Acc: 0.577 Test Loss: 2.602 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.885286092758179
Epoch: 26, Steps: 17 | Train Loss: 0.379 Vali Loss: 2.729 Vali Acc: 0.570 Test Loss: 2.729 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.2909462451934814
Epoch: 27, Steps: 17 | Train Loss: 0.334 Vali Loss: 2.727 Vali Acc: 0.577 Test Loss: 2.727 Test Acc: 0.577
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.434993028640747
Epoch: 28, Steps: 17 | Train Loss: 0.303 Vali Loss: 2.655 Vali Acc: 0.590 Test Loss: 2.655 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.222424030303955
Epoch: 29, Steps: 17 | Train Loss: 0.297 Vali Loss: 3.015 Vali Acc: 0.570 Test Loss: 3.015 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.811851501464844
Epoch: 30, Steps: 17 | Train Loss: 0.305 Vali Loss: 2.878 Vali Acc: 0.553 Test Loss: 2.878 Test Acc: 0.553
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.051021337509155
Epoch: 31, Steps: 17 | Train Loss: 0.294 Vali Loss: 2.963 Vali Acc: 0.601 Test Loss: 2.963 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.064715623855591
Epoch: 32, Steps: 17 | Train Loss: 0.376 Vali Loss: 3.015 Vali Acc: 0.580 Test Loss: 3.015 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6177474402730375
model parameter : 331970
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.838906764984131
Epoch: 1, Steps: 17 | Train Loss: 0.689 Vali Loss: 0.669 Vali Acc: 0.601 Test Loss: 0.669 Test Acc: 0.601
Validation loss decreased (inf --> -0.600676).  Saving model ...
Epoch: 2 cost time: 4.788467884063721
Epoch: 2, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.954 Vali Acc: 0.529 Test Loss: 0.954 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.72185206413269
Epoch: 3, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.926 Vali Acc: 0.584 Test Loss: 0.926 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.732907295227051
Epoch: 4, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.700 Vali Acc: 0.659 Test Loss: 0.700 Test Acc: 0.659
Validation loss decreased (-0.600676 --> -0.658696).  Saving model ...
Epoch: 5 cost time: 4.8975465297698975
Epoch: 5, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.724 Vali Acc: 0.666 Test Loss: 0.724 Test Acc: 0.666
Validation loss decreased (-0.658696 --> -0.665522).  Saving model ...
Epoch: 6 cost time: 4.942270278930664
Epoch: 6, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.937 Vali Acc: 0.648 Test Loss: 0.937 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.928759813308716
Epoch: 7, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.835 Vali Acc: 0.662 Test Loss: 0.835 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.032352447509766
Epoch: 8, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.778 Vali Acc: 0.679 Test Loss: 0.778 Test Acc: 0.679
Validation loss decreased (-0.665522 --> -0.679173).  Saving model ...
Epoch: 9 cost time: 5.137815952301025
Epoch: 9, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.159 Vali Acc: 0.669 Test Loss: 1.159 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.8376147747039795
Epoch: 10, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.887 Vali Acc: 0.686 Test Loss: 0.887 Test Acc: 0.686
Validation loss decreased (-0.679173 --> -0.685998).  Saving model ...
Epoch: 11 cost time: 4.515061855316162
Epoch: 11, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.908 Vali Acc: 0.700 Test Loss: 0.908 Test Acc: 0.700
Validation loss decreased (-0.685998 --> -0.699650).  Saving model ...
Epoch: 12 cost time: 4.780938148498535
Epoch: 12, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.226 Vali Acc: 0.696 Test Loss: 1.226 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.689119338989258
Epoch: 13, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.088 Vali Acc: 0.713 Test Loss: 1.088 Test Acc: 0.713
Validation loss decreased (-0.699650 --> -0.713300).  Saving model ...
Epoch: 14 cost time: 4.91661262512207
Epoch: 14, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.403 Vali Acc: 0.696 Test Loss: 1.403 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.02765154838562
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.024 Vali Acc: 0.724 Test Loss: 1.024 Test Acc: 0.724
Validation loss decreased (-0.713300 --> -0.723539).  Saving model ...
Epoch: 16 cost time: 5.529311418533325
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.425 Vali Acc: 0.700 Test Loss: 1.425 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.669291734695435
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.153 Vali Acc: 0.710 Test Loss: 1.153 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.515505075454712
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.787 Vali Acc: 0.693 Test Loss: 1.787 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.620787858963013
Epoch: 19, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.917 Vali Acc: 0.751 Test Loss: 0.917 Test Acc: 0.751
Validation loss decreased (-0.723539 --> -0.750844).  Saving model ...
Epoch: 20 cost time: 5.817564010620117
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.285 Vali Acc: 0.727 Test Loss: 1.285 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.684446096420288
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.522 Vali Acc: 0.720 Test Loss: 1.522 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.7996766567230225
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.157 Vali Acc: 0.720 Test Loss: 1.157 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.364124298095703
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.432 Vali Acc: 0.727 Test Loss: 1.432 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.191606283187866
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.449 Vali Acc: 0.717 Test Loss: 1.449 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.256983518600464
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.392 Vali Acc: 0.730 Test Loss: 1.392 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.556903600692749
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.405 Vali Acc: 0.737 Test Loss: 1.405 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.072023153305054
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.431 Vali Acc: 0.727 Test Loss: 1.431 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.927233695983887
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.342 Vali Acc: 0.747 Test Loss: 1.342 Test Acc: 0.747
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.337385177612305
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.231 Vali Acc: 0.741 Test Loss: 1.231 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7508532423208191
model parameter : 493666
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.730297565460205
Epoch: 1, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.671 Vali Acc: 0.584 Test Loss: 0.671 Test Acc: 0.584
Validation loss decreased (inf --> -0.583611).  Saving model ...
Epoch: 2 cost time: 4.737230539321899
Epoch: 2, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.914 Vali Acc: 0.526 Test Loss: 0.914 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.3877856731414795
Epoch: 3, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.990 Vali Acc: 0.560 Test Loss: 0.990 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.694589614868164
Epoch: 4, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.880 Vali Acc: 0.618 Test Loss: 0.880 Test Acc: 0.618
Validation loss decreased (-0.583611 --> -0.617739).  Saving model ...
Epoch: 5 cost time: 4.379837512969971
Epoch: 5, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.737 Vali Acc: 0.638 Test Loss: 0.737 Test Acc: 0.638
Validation loss decreased (-0.617739 --> -0.638218).  Saving model ...
Epoch: 6 cost time: 5.025213718414307
Epoch: 6, Steps: 17 | Train Loss: 0.279 Vali Loss: 1.153 Vali Acc: 0.611 Test Loss: 1.153 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.119616746902466
Epoch: 7, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.895 Vali Acc: 0.638 Test Loss: 0.895 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.123541593551636
Epoch: 8, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.789 Vali Acc: 0.631 Test Loss: 0.789 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.005570650100708
Epoch: 9, Steps: 17 | Train Loss: 0.146 Vali Loss: 1.344 Vali Acc: 0.625 Test Loss: 1.344 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.900330066680908
Epoch: 10, Steps: 17 | Train Loss: 0.139 Vali Loss: 1.176 Vali Acc: 0.655 Test Loss: 1.176 Test Acc: 0.655
Validation loss decreased (-0.638218 --> -0.655278).  Saving model ...
Epoch: 11 cost time: 4.745015621185303
Epoch: 11, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.150 Vali Acc: 0.683 Test Loss: 1.150 Test Acc: 0.683
Validation loss decreased (-0.655278 --> -0.682582).  Saving model ...
Epoch: 12 cost time: 4.698735475540161
Epoch: 12, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.694 Vali Acc: 0.631 Test Loss: 1.694 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.823196172714233
Epoch: 13, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.435 Vali Acc: 0.669 Test Loss: 1.435 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.8169944286346436
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.509 Vali Acc: 0.655 Test Loss: 1.509 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.853509426116943
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.724 Vali Acc: 0.659 Test Loss: 1.724 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.4142303466796875
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.542 Vali Acc: 0.659 Test Loss: 1.542 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.971947908401489
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.431 Vali Acc: 0.672 Test Loss: 1.431 Test Acc: 0.672
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.065086126327515
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.717 Vali Acc: 0.652 Test Loss: 1.717 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.30194616317749
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 2.045 Vali Acc: 0.669 Test Loss: 2.045 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.141935348510742
Epoch: 20, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.310 Vali Acc: 0.689 Test Loss: 1.310 Test Acc: 0.689
Validation loss decreased (-0.682582 --> -0.689407).  Saving model ...
Epoch: 21 cost time: 5.168812274932861
Epoch: 21, Steps: 17 | Train Loss: 0.053 Vali Loss: 2.289 Vali Acc: 0.655 Test Loss: 2.289 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.049767255783081
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.427 Vali Acc: 0.645 Test Loss: 1.427 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.4436354637146
Epoch: 23, Steps: 17 | Train Loss: 0.040 Vali Loss: 2.146 Vali Acc: 0.662 Test Loss: 2.146 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.8593995571136475
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 2.079 Vali Acc: 0.635 Test Loss: 2.079 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.158342361450195
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.109 Vali Acc: 0.676 Test Loss: 2.109 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.771884202957153
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 2.564 Vali Acc: 0.659 Test Loss: 2.564 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.830700874328613
Epoch: 27, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.985 Vali Acc: 0.689 Test Loss: 1.985 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.9282190799713135
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.578 Vali Acc: 0.672 Test Loss: 2.578 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.044977188110352
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.818 Vali Acc: 0.713 Test Loss: 1.818 Test Acc: 0.713
Validation loss decreased (-0.689407 --> -0.713292).  Saving model ...
Epoch: 30 cost time: 5.292006731033325
Epoch: 30, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.273 Vali Acc: 0.666 Test Loss: 2.273 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.095865964889526
Epoch: 31, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.490 Vali Acc: 0.648 Test Loss: 2.490 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.7471277713775635
Epoch: 32, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.993 Vali Acc: 0.666 Test Loss: 1.993 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.491610527038574
Epoch: 33, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.718 Vali Acc: 0.683 Test Loss: 1.718 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.581080436706543
Epoch: 34, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.901 Vali Acc: 0.686 Test Loss: 2.901 Test Acc: 0.686
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.325708627700806
Epoch: 35, Steps: 17 | Train Loss: 0.012 Vali Loss: 2.497 Vali Acc: 0.683 Test Loss: 2.497 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 4.465949296951294
Epoch: 36, Steps: 17 | Train Loss: 0.047 Vali Loss: 2.305 Vali Acc: 0.696 Test Loss: 2.305 Test Acc: 0.696
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 4.268690586090088
Epoch: 37, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.678 Vali Acc: 0.672 Test Loss: 2.678 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.328983783721924
Epoch: 38, Steps: 17 | Train Loss: 0.012 Vali Loss: 2.153 Vali Acc: 0.683 Test Loss: 2.153 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.807112216949463
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.733 Vali Acc: 0.696 Test Loss: 2.733 Test Acc: 0.696
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7133105802047781
model parameter : 493666
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.549203634262085
Epoch: 1, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.690 Vali Acc: 0.536 Test Loss: 0.690 Test Acc: 0.536
Validation loss decreased (inf --> -0.535829).  Saving model ...
Epoch: 2 cost time: 5.241914987564087
Epoch: 2, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.867 Vali Acc: 0.546 Test Loss: 0.867 Test Acc: 0.546
Validation loss decreased (-0.535829 --> -0.546066).  Saving model ...
Epoch: 3 cost time: 5.161982774734497
Epoch: 3, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.959 Vali Acc: 0.556 Test Loss: 0.959 Test Acc: 0.556
Validation loss decreased (-0.546066 --> -0.556304).  Saving model ...
Epoch: 4 cost time: 4.8775975704193115
Epoch: 4, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.897 Vali Acc: 0.601 Test Loss: 0.897 Test Acc: 0.601
Validation loss decreased (-0.556304 --> -0.600674).  Saving model ...
Epoch: 5 cost time: 5.004856824874878
Epoch: 5, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.813 Vali Acc: 0.614 Test Loss: 0.813 Test Acc: 0.614
Validation loss decreased (-0.600674 --> -0.614326).  Saving model ...
Epoch: 6 cost time: 5.36991024017334
Epoch: 6, Steps: 17 | Train Loss: 0.303 Vali Loss: 1.317 Vali Acc: 0.577 Test Loss: 1.317 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.10802698135376
Epoch: 7, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.981 Vali Acc: 0.642 Test Loss: 0.981 Test Acc: 0.642
Validation loss decreased (-0.614326 --> -0.641628).  Saving model ...
Epoch: 8 cost time: 4.989336252212524
Epoch: 8, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.902 Vali Acc: 0.597 Test Loss: 0.902 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.3767924308776855
Epoch: 9, Steps: 17 | Train Loss: 0.168 Vali Loss: 1.139 Vali Acc: 0.628 Test Loss: 1.139 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.651135206222534
Epoch: 10, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.399 Vali Acc: 0.625 Test Loss: 1.399 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.508186101913452
Epoch: 11, Steps: 17 | Train Loss: 0.110 Vali Loss: 1.367 Vali Acc: 0.655 Test Loss: 1.367 Test Acc: 0.655
Validation loss decreased (-0.641628 --> -0.655276).  Saving model ...
Epoch: 12 cost time: 5.4728102684021
Epoch: 12, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.738 Vali Acc: 0.614 Test Loss: 1.738 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.418941974639893
Epoch: 13, Steps: 17 | Train Loss: 0.093 Vali Loss: 2.225 Vali Acc: 0.604 Test Loss: 2.225 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.331270933151245
Epoch: 14, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.724 Vali Acc: 0.618 Test Loss: 1.724 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.179994583129883
Epoch: 15, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.767 Vali Acc: 0.638 Test Loss: 1.767 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.044911861419678
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.859 Vali Acc: 0.631 Test Loss: 1.859 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.359523057937622
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.696 Vali Acc: 0.666 Test Loss: 1.696 Test Acc: 0.666
Validation loss decreased (-0.655276 --> -0.665512).  Saving model ...
Epoch: 18 cost time: 4.8971192836761475
Epoch: 18, Steps: 17 | Train Loss: 0.063 Vali Loss: 3.280 Vali Acc: 0.549 Test Loss: 3.280 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.984323024749756
Epoch: 19, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.704 Vali Acc: 0.648 Test Loss: 1.704 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.371335983276367
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.851 Vali Acc: 0.625 Test Loss: 1.851 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.627030849456787
Epoch: 21, Steps: 17 | Train Loss: 0.020 Vali Loss: 2.395 Vali Acc: 0.628 Test Loss: 2.395 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.307716369628906
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.674 Vali Acc: 0.652 Test Loss: 1.674 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.032849073410034
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.918 Vali Acc: 0.652 Test Loss: 1.918 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.514253854751587
Epoch: 24, Steps: 17 | Train Loss: 0.018 Vali Loss: 2.537 Vali Acc: 0.635 Test Loss: 2.537 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.850347518920898
Epoch: 25, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.874 Vali Acc: 0.645 Test Loss: 1.874 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.700647354125977
Epoch: 26, Steps: 17 | Train Loss: 0.049 Vali Loss: 3.268 Vali Acc: 0.597 Test Loss: 3.268 Test Acc: 0.597
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.425835847854614
Epoch: 27, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.955 Vali Acc: 0.638 Test Loss: 1.955 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6655290102389079
model parameter : 493666
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.725038051605225
Epoch: 1, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.691 Vali Acc: 0.553 Test Loss: 0.691 Test Acc: 0.553
Validation loss decreased (inf --> -0.552894).  Saving model ...
Epoch: 2 cost time: 5.420923948287964
Epoch: 2, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.890 Vali Acc: 0.539 Test Loss: 0.890 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.346445560455322
Epoch: 3, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.977 Vali Acc: 0.587 Test Loss: 0.977 Test Acc: 0.587
Validation loss decreased (-0.552894 --> -0.587021).  Saving model ...
Epoch: 4 cost time: 5.361510515213013
Epoch: 4, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.979 Vali Acc: 0.580 Test Loss: 0.979 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.4215171337127686
Epoch: 5, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.834 Vali Acc: 0.638 Test Loss: 0.834 Test Acc: 0.638
Validation loss decreased (-0.587021 --> -0.638217).  Saving model ...
Epoch: 6 cost time: 5.840765714645386
Epoch: 6, Steps: 17 | Train Loss: 0.366 Vali Loss: 1.003 Vali Acc: 0.604 Test Loss: 1.003 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.9840333461761475
Epoch: 7, Steps: 17 | Train Loss: 0.277 Vali Loss: 1.033 Vali Acc: 0.601 Test Loss: 1.033 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.145676851272583
Epoch: 8, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.976 Vali Acc: 0.584 Test Loss: 0.976 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.75124454498291
Epoch: 9, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.434 Vali Acc: 0.594 Test Loss: 1.434 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.659671783447266
Epoch: 10, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.327 Vali Acc: 0.563 Test Loss: 1.327 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.642435789108276
Epoch: 11, Steps: 17 | Train Loss: 0.129 Vali Loss: 1.319 Vali Acc: 0.604 Test Loss: 1.319 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.817320346832275
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 2.176 Vali Acc: 0.580 Test Loss: 2.176 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.91851544380188
Epoch: 13, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.867 Vali Acc: 0.570 Test Loss: 1.867 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.209758996963501
Epoch: 14, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.627 Vali Acc: 0.604 Test Loss: 1.627 Test Acc: 0.604
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.965143442153931
Epoch: 15, Steps: 17 | Train Loss: 0.039 Vali Loss: 2.160 Vali Acc: 0.567 Test Loss: 2.160 Test Acc: 0.567
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6382252559726962
model parameter : 493666
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.253898859024048
Epoch: 1, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.692 Vali Acc: 0.556 Test Loss: 0.692 Test Acc: 0.556
Validation loss decreased (inf --> -0.556307).  Saving model ...
Epoch: 2 cost time: 4.7455737590789795
Epoch: 2, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.884 Vali Acc: 0.546 Test Loss: 0.884 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.82299542427063
Epoch: 3, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.860 Vali Acc: 0.594 Test Loss: 0.860 Test Acc: 0.594
Validation loss decreased (-0.556307 --> -0.593848).  Saving model ...
Epoch: 4 cost time: 4.82968544960022
Epoch: 4, Steps: 17 | Train Loss: 0.400 Vali Loss: 1.000 Vali Acc: 0.590 Test Loss: 1.000 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.964051723480225
Epoch: 5, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.839 Vali Acc: 0.635 Test Loss: 0.839 Test Acc: 0.635
Validation loss decreased (-0.593848 --> -0.634804).  Saving model ...
Epoch: 6 cost time: 5.1637585163116455
Epoch: 6, Steps: 17 | Train Loss: 0.333 Vali Loss: 1.278 Vali Acc: 0.597 Test Loss: 1.278 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.275752067565918
Epoch: 7, Steps: 17 | Train Loss: 0.256 Vali Loss: 1.147 Vali Acc: 0.608 Test Loss: 1.147 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.385310173034668
Epoch: 8, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.948 Vali Acc: 0.642 Test Loss: 0.948 Test Acc: 0.642
Validation loss decreased (-0.634804 --> -0.641629).  Saving model ...
Epoch: 9 cost time: 5.745167255401611
Epoch: 9, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.511 Vali Acc: 0.584 Test Loss: 1.511 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.567205429077148
Epoch: 10, Steps: 17 | Train Loss: 0.169 Vali Loss: 1.162 Vali Acc: 0.628 Test Loss: 1.162 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.533280849456787
Epoch: 11, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.461 Vali Acc: 0.631 Test Loss: 1.461 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.017084360122681
Epoch: 12, Steps: 17 | Train Loss: 0.094 Vali Loss: 2.334 Vali Acc: 0.567 Test Loss: 2.334 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.20695424079895
Epoch: 13, Steps: 17 | Train Loss: 0.098 Vali Loss: 2.001 Vali Acc: 0.584 Test Loss: 2.001 Test Acc: 0.584
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.205072402954102
Epoch: 14, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.974 Vali Acc: 0.608 Test Loss: 1.974 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.108230829238892
Epoch: 15, Steps: 17 | Train Loss: 0.051 Vali Loss: 2.147 Vali Acc: 0.601 Test Loss: 2.147 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.090830087661743
Epoch: 16, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.957 Vali Acc: 0.601 Test Loss: 1.957 Test Acc: 0.601
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.904240131378174
Epoch: 17, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.894 Vali Acc: 0.608 Test Loss: 1.894 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.333258867263794
Epoch: 18, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.429 Vali Acc: 0.590 Test Loss: 2.429 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 493666
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.33119535446167
Epoch: 1, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.679 Vali Acc: 0.536 Test Loss: 0.679 Test Acc: 0.536
Validation loss decreased (inf --> -0.535829).  Saving model ...
Epoch: 2 cost time: 5.194851875305176
Epoch: 2, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.880 Vali Acc: 0.512 Test Loss: 0.880 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.022004842758179
Epoch: 3, Steps: 17 | Train Loss: 0.497 Vali Loss: 1.047 Vali Acc: 0.509 Test Loss: 1.047 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.0623250007629395
Epoch: 4, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.825 Vali Acc: 0.573 Test Loss: 0.825 Test Acc: 0.573
Validation loss decreased (-0.535829 --> -0.573371).  Saving model ...
Epoch: 5 cost time: 4.6387341022491455
Epoch: 5, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.903 Vali Acc: 0.546 Test Loss: 0.903 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.624236106872559
Epoch: 6, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.958 Vali Acc: 0.577 Test Loss: 0.958 Test Acc: 0.577
Validation loss decreased (-0.573371 --> -0.576782).  Saving model ...
Epoch: 7 cost time: 4.674131393432617
Epoch: 7, Steps: 17 | Train Loss: 0.304 Vali Loss: 1.299 Vali Acc: 0.529 Test Loss: 1.299 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.39221978187561
Epoch: 8, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.908 Vali Acc: 0.608 Test Loss: 0.908 Test Acc: 0.608
Validation loss decreased (-0.576782 --> -0.607499).  Saving model ...
Epoch: 9 cost time: 5.164358377456665
Epoch: 9, Steps: 17 | Train Loss: 0.223 Vali Loss: 1.390 Vali Acc: 0.573 Test Loss: 1.390 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.153842926025391
Epoch: 10, Steps: 17 | Train Loss: 0.184 Vali Loss: 1.379 Vali Acc: 0.567 Test Loss: 1.379 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.017071962356567
Epoch: 11, Steps: 17 | Train Loss: 0.225 Vali Loss: 1.049 Vali Acc: 0.621 Test Loss: 1.049 Test Acc: 0.621
Validation loss decreased (-0.607499 --> -0.621150).  Saving model ...
Epoch: 12 cost time: 5.214716911315918
Epoch: 12, Steps: 17 | Train Loss: 0.263 Vali Loss: 2.068 Vali Acc: 0.536 Test Loss: 2.068 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.521745443344116
Epoch: 13, Steps: 17 | Train Loss: 0.217 Vali Loss: 2.163 Vali Acc: 0.539 Test Loss: 2.163 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.837307453155518
Epoch: 14, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.377 Vali Acc: 0.604 Test Loss: 1.377 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.756785869598389
Epoch: 15, Steps: 17 | Train Loss: 0.094 Vali Loss: 2.248 Vali Acc: 0.539 Test Loss: 2.248 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.715353488922119
Epoch: 16, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.862 Vali Acc: 0.567 Test Loss: 1.862 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.161193370819092
Epoch: 17, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.651 Vali Acc: 0.594 Test Loss: 1.651 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.987527370452881
Epoch: 18, Steps: 17 | Train Loss: 0.081 Vali Loss: 2.054 Vali Acc: 0.567 Test Loss: 2.054 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.408446311950684
Epoch: 19, Steps: 17 | Train Loss: 0.060 Vali Loss: 2.376 Vali Acc: 0.570 Test Loss: 2.376 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.643099069595337
Epoch: 20, Steps: 17 | Train Loss: 0.052 Vali Loss: 2.118 Vali Acc: 0.587 Test Loss: 2.118 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.216742515563965
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 2.273 Vali Acc: 0.580 Test Loss: 2.273 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.621160409556314
model parameter : 493666
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.292815446853638
Epoch: 1, Steps: 17 | Train Loss: 0.694 Vali Loss: 0.737 Vali Acc: 0.478 Test Loss: 0.737 Test Acc: 0.478
Validation loss decreased (inf --> -0.477808).  Saving model ...
Epoch: 2 cost time: 5.23584771156311
Epoch: 2, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.908 Vali Acc: 0.502 Test Loss: 0.908 Test Acc: 0.502
Validation loss decreased (-0.477808 --> -0.501697).  Saving model ...
Epoch: 3 cost time: 5.460003852844238
Epoch: 3, Steps: 17 | Train Loss: 0.501 Vali Loss: 1.078 Vali Acc: 0.505 Test Loss: 1.078 Test Acc: 0.505
Validation loss decreased (-0.501697 --> -0.505109).  Saving model ...
Epoch: 4 cost time: 5.08184552192688
Epoch: 4, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.836 Vali Acc: 0.556 Test Loss: 0.836 Test Acc: 0.556
Validation loss decreased (-0.505109 --> -0.556306).  Saving model ...
Epoch: 5 cost time: 4.887237548828125
Epoch: 5, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.903 Vali Acc: 0.567 Test Loss: 0.903 Test Acc: 0.567
Validation loss decreased (-0.556306 --> -0.566544).  Saving model ...
Epoch: 6 cost time: 4.441094875335693
Epoch: 6, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.908 Vali Acc: 0.573 Test Loss: 0.908 Test Acc: 0.573
Validation loss decreased (-0.566544 --> -0.573370).  Saving model ...
Epoch: 7 cost time: 4.89081072807312
Epoch: 7, Steps: 17 | Train Loss: 0.344 Vali Loss: 1.174 Vali Acc: 0.546 Test Loss: 1.174 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.512375831604004
Epoch: 8, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.957 Vali Acc: 0.580 Test Loss: 0.957 Test Acc: 0.580
Validation loss decreased (-0.573370 --> -0.580195).  Saving model ...
Epoch: 9 cost time: 5.3289079666137695
Epoch: 9, Steps: 17 | Train Loss: 0.303 Vali Loss: 1.229 Vali Acc: 0.563 Test Loss: 1.229 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.137420892715454
Epoch: 10, Steps: 17 | Train Loss: 0.252 Vali Loss: 1.170 Vali Acc: 0.584 Test Loss: 1.170 Test Acc: 0.584
Validation loss decreased (-0.580195 --> -0.583606).  Saving model ...
Epoch: 11 cost time: 5.235952615737915
Epoch: 11, Steps: 17 | Train Loss: 0.254 Vali Loss: 1.157 Vali Acc: 0.577 Test Loss: 1.157 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.075986385345459
Epoch: 12, Steps: 17 | Train Loss: 0.265 Vali Loss: 2.512 Vali Acc: 0.519 Test Loss: 2.512 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.87407660484314
Epoch: 13, Steps: 17 | Train Loss: 0.279 Vali Loss: 2.066 Vali Acc: 0.532 Test Loss: 2.066 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.936791658401489
Epoch: 14, Steps: 17 | Train Loss: 0.211 Vali Loss: 1.410 Vali Acc: 0.560 Test Loss: 1.410 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.673530101776123
Epoch: 15, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.683 Vali Acc: 0.563 Test Loss: 1.683 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.099571228027344
Epoch: 16, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.905 Vali Acc: 0.563 Test Loss: 1.905 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.78066611289978
Epoch: 17, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.989 Vali Acc: 0.539 Test Loss: 1.989 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.094631671905518
Epoch: 18, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.854 Vali Acc: 0.567 Test Loss: 1.854 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.159432411193848
Epoch: 19, Steps: 17 | Train Loss: 0.076 Vali Loss: 2.045 Vali Acc: 0.556 Test Loss: 2.045 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.443421363830566
Epoch: 20, Steps: 17 | Train Loss: 0.074 Vali Loss: 2.316 Vali Acc: 0.563 Test Loss: 2.316 Test Acc: 0.563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5836177474402731
model parameter : 493666
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.959862947463989
Epoch: 1, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.730 Vali Acc: 0.478 Test Loss: 0.730 Test Acc: 0.478
Validation loss decreased (inf --> -0.477808).  Saving model ...
Epoch: 2 cost time: 4.9114670753479
Epoch: 2, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.962 Vali Acc: 0.498 Test Loss: 0.962 Test Acc: 0.498
Validation loss decreased (-0.477808 --> -0.498284).  Saving model ...
Epoch: 3 cost time: 4.708146333694458
Epoch: 3, Steps: 17 | Train Loss: 0.555 Vali Loss: 1.315 Vali Acc: 0.502 Test Loss: 1.315 Test Acc: 0.502
Validation loss decreased (-0.498284 --> -0.501693).  Saving model ...
Epoch: 4 cost time: 5.256837606430054
Epoch: 4, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.791 Vali Acc: 0.532 Test Loss: 0.791 Test Acc: 0.532
Validation loss decreased (-0.501693 --> -0.532415).  Saving model ...
Epoch: 5 cost time: 5.068826913833618
Epoch: 5, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.952 Vali Acc: 0.519 Test Loss: 0.952 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.142882823944092
Epoch: 6, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.958 Vali Acc: 0.522 Test Loss: 0.958 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.217295169830322
Epoch: 7, Steps: 17 | Train Loss: 0.363 Vali Loss: 1.187 Vali Acc: 0.512 Test Loss: 1.187 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.908700227737427
Epoch: 8, Steps: 17 | Train Loss: 0.347 Vali Loss: 1.032 Vali Acc: 0.560 Test Loss: 1.032 Test Acc: 0.560
Validation loss decreased (-0.532415 --> -0.559717).  Saving model ...
Epoch: 9 cost time: 5.151166677474976
Epoch: 9, Steps: 17 | Train Loss: 0.335 Vali Loss: 1.263 Vali Acc: 0.519 Test Loss: 1.263 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.619335174560547
Epoch: 10, Steps: 17 | Train Loss: 0.264 Vali Loss: 1.665 Vali Acc: 0.502 Test Loss: 1.665 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.192449331283569
Epoch: 11, Steps: 17 | Train Loss: 0.278 Vali Loss: 1.323 Vali Acc: 0.543 Test Loss: 1.323 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.256218433380127
Epoch: 12, Steps: 17 | Train Loss: 0.251 Vali Loss: 2.447 Vali Acc: 0.512 Test Loss: 2.447 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.744400978088379
Epoch: 13, Steps: 17 | Train Loss: 0.197 Vali Loss: 1.505 Vali Acc: 0.539 Test Loss: 1.505 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.112261772155762
Epoch: 14, Steps: 17 | Train Loss: 0.192 Vali Loss: 2.480 Vali Acc: 0.509 Test Loss: 2.480 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.108753204345703
Epoch: 15, Steps: 17 | Train Loss: 0.150 Vali Loss: 2.421 Vali Acc: 0.491 Test Loss: 2.421 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.358598470687866
Epoch: 16, Steps: 17 | Train Loss: 0.159 Vali Loss: 1.966 Vali Acc: 0.529 Test Loss: 1.966 Test Acc: 0.529
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.768372535705566
Epoch: 17, Steps: 17 | Train Loss: 0.140 Vali Loss: 1.999 Vali Acc: 0.536 Test Loss: 1.999 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.486157417297363
Epoch: 18, Steps: 17 | Train Loss: 0.116 Vali Loss: 2.379 Vali Acc: 0.519 Test Loss: 2.379 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5597269624573379
model parameter : 493666
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.658354759216309
Epoch: 1, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.769 Vali Acc: 0.502 Test Loss: 0.769 Test Acc: 0.502
Validation loss decreased (inf --> -0.501699).  Saving model ...
Epoch: 2 cost time: 5.092852830886841
Epoch: 2, Steps: 17 | Train Loss: 0.593 Vali Loss: 1.118 Vali Acc: 0.502 Test Loss: 1.118 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.910987854003906
Epoch: 3, Steps: 17 | Train Loss: 0.576 Vali Loss: 1.581 Vali Acc: 0.502 Test Loss: 1.581 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.959757328033447
Epoch: 4, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.794 Vali Acc: 0.502 Test Loss: 0.794 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.242075681686401
Epoch: 5, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.942 Vali Acc: 0.502 Test Loss: 0.942 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.642202138900757
Epoch: 6, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.779 Vali Acc: 0.502 Test Loss: 0.779 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.78627347946167
Epoch: 7, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.754 Vali Acc: 0.505 Test Loss: 0.754 Test Acc: 0.505
Validation loss decreased (-0.501699 --> -0.505112).  Saving model ...
Epoch: 8 cost time: 4.915125131607056
Epoch: 8, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.694 Vali Acc: 0.512 Test Loss: 0.694 Test Acc: 0.512
Validation loss decreased (-0.505112 --> -0.511938).  Saving model ...
Epoch: 9 cost time: 5.047152280807495
Epoch: 9, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.869 Vali Acc: 0.498 Test Loss: 0.869 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.737084627151489
Epoch: 10, Steps: 17 | Train Loss: 0.443 Vali Loss: 1.427 Vali Acc: 0.502 Test Loss: 1.427 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.731988430023193
Epoch: 11, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.667 Vali Acc: 0.594 Test Loss: 0.667 Test Acc: 0.594
Validation loss decreased (-0.511938 --> -0.593850).  Saving model ...
Epoch: 12 cost time: 5.6759703159332275
Epoch: 12, Steps: 17 | Train Loss: 0.451 Vali Loss: 2.064 Vali Acc: 0.502 Test Loss: 2.064 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.4162657260894775
Epoch: 13, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.689 Vali Acc: 0.601 Test Loss: 0.689 Test Acc: 0.601
Validation loss decreased (-0.593850 --> -0.600676).  Saving model ...
Epoch: 14 cost time: 5.608926773071289
Epoch: 14, Steps: 17 | Train Loss: 0.435 Vali Loss: 1.360 Vali Acc: 0.498 Test Loss: 1.360 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.126221656799316
Epoch: 15, Steps: 17 | Train Loss: 0.394 Vali Loss: 1.571 Vali Acc: 0.498 Test Loss: 1.571 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.846575975418091
Epoch: 16, Steps: 17 | Train Loss: 0.484 Vali Loss: 1.602 Vali Acc: 0.502 Test Loss: 1.602 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.504273414611816
Epoch: 17, Steps: 17 | Train Loss: 0.442 Vali Loss: 1.125 Vali Acc: 0.519 Test Loss: 1.125 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.166657447814941
Epoch: 18, Steps: 17 | Train Loss: 0.398 Vali Loss: 2.054 Vali Acc: 0.498 Test Loss: 2.054 Test Acc: 0.498
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.444132089614868
Epoch: 19, Steps: 17 | Train Loss: 0.420 Vali Loss: 1.951 Vali Acc: 0.498 Test Loss: 1.951 Test Acc: 0.498
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.764312028884888
Epoch: 20, Steps: 17 | Train Loss: 0.404 Vali Loss: 1.259 Vali Acc: 0.519 Test Loss: 1.259 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.374496698379517
Epoch: 21, Steps: 17 | Train Loss: 0.351 Vali Loss: 1.477 Vali Acc: 0.512 Test Loss: 1.477 Test Acc: 0.512
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.568495988845825
Epoch: 22, Steps: 17 | Train Loss: 0.334 Vali Loss: 1.446 Vali Acc: 0.536 Test Loss: 1.446 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.326344013214111
Epoch: 23, Steps: 17 | Train Loss: 0.319 Vali Loss: 1.474 Vali Acc: 0.532 Test Loss: 1.474 Test Acc: 0.532
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6006825938566553
model parameter : 493666
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.998543977737427
Epoch: 1, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.940 Vali Acc: 0.502 Test Loss: 0.940 Test Acc: 0.502
Validation loss decreased (inf --> -0.501697).  Saving model ...
Epoch: 2 cost time: 4.966558933258057
Epoch: 2, Steps: 17 | Train Loss: 0.602 Vali Loss: 1.194 Vali Acc: 0.502 Test Loss: 1.194 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.356302738189697
Epoch: 3, Steps: 17 | Train Loss: 0.597 Vali Loss: 1.651 Vali Acc: 0.502 Test Loss: 1.651 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.268145799636841
Epoch: 4, Steps: 17 | Train Loss: 0.571 Vali Loss: 1.547 Vali Acc: 0.502 Test Loss: 1.547 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.321227073669434
Epoch: 5, Steps: 17 | Train Loss: 0.548 Vali Loss: 1.685 Vali Acc: 0.502 Test Loss: 1.685 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.556684494018555
Epoch: 6, Steps: 17 | Train Loss: 0.592 Vali Loss: 1.386 Vali Acc: 0.502 Test Loss: 1.386 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.502529859542847
Epoch: 7, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.991 Vali Acc: 0.502 Test Loss: 0.991 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.358806610107422
Epoch: 8, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.688 Vali Acc: 0.556 Test Loss: 0.688 Test Acc: 0.556
Validation loss decreased (-0.501697 --> -0.556307).  Saving model ...
Epoch: 9 cost time: 4.450323581695557
Epoch: 9, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.718 Vali Acc: 0.522 Test Loss: 0.718 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.775722503662109
Epoch: 10, Steps: 17 | Train Loss: 0.524 Vali Loss: 1.090 Vali Acc: 0.502 Test Loss: 1.090 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.890842437744141
Epoch: 11, Steps: 17 | Train Loss: 0.558 Vali Loss: 1.008 Vali Acc: 0.505 Test Loss: 1.008 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.056133985519409
Epoch: 12, Steps: 17 | Train Loss: 0.457 Vali Loss: 1.633 Vali Acc: 0.502 Test Loss: 1.633 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.010314702987671
Epoch: 13, Steps: 17 | Train Loss: 0.603 Vali Loss: 1.275 Vali Acc: 0.502 Test Loss: 1.275 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.917147397994995
Epoch: 14, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.836 Vali Acc: 0.512 Test Loss: 0.836 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.653519153594971
Epoch: 15, Steps: 17 | Train Loss: 0.540 Vali Loss: 1.633 Vali Acc: 0.502 Test Loss: 1.633 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.767836332321167
Epoch: 16, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.744 Vali Acc: 0.590 Test Loss: 0.744 Test Acc: 0.590
Validation loss decreased (-0.556307 --> -0.590436).  Saving model ...
Epoch: 17 cost time: 4.643859624862671
Epoch: 17, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.952 Vali Acc: 0.529 Test Loss: 0.952 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.527255296707153
Epoch: 18, Steps: 17 | Train Loss: 0.522 Vali Loss: 1.106 Vali Acc: 0.532 Test Loss: 1.106 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.7588050365448
Epoch: 19, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.773 Vali Acc: 0.590 Test Loss: 0.773 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.572826147079468
Epoch: 20, Steps: 17 | Train Loss: 0.415 Vali Loss: 1.340 Vali Acc: 0.532 Test Loss: 1.340 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.860234260559082
Epoch: 21, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.840 Vali Acc: 0.563 Test Loss: 0.840 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.060561656951904
Epoch: 22, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.874 Vali Acc: 0.570 Test Loss: 0.874 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.87005090713501
Epoch: 23, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.881 Vali Acc: 0.573 Test Loss: 0.881 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.951291561126709
Epoch: 24, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.863 Vali Acc: 0.597 Test Loss: 0.863 Test Acc: 0.597
Validation loss decreased (-0.590436 --> -0.597261).  Saving model ...
Epoch: 25 cost time: 5.166786432266235
Epoch: 25, Steps: 17 | Train Loss: 0.512 Vali Loss: 1.133 Vali Acc: 0.553 Test Loss: 1.133 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.257457494735718
Epoch: 26, Steps: 17 | Train Loss: 0.511 Vali Loss: 1.029 Vali Acc: 0.532 Test Loss: 1.029 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.722796440124512
Epoch: 27, Steps: 17 | Train Loss: 0.623 Vali Loss: 1.067 Vali Acc: 0.549 Test Loss: 1.067 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.553078651428223
Epoch: 28, Steps: 17 | Train Loss: 0.450 Vali Loss: 1.697 Vali Acc: 0.529 Test Loss: 1.697 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.7054831981658936
Epoch: 29, Steps: 17 | Train Loss: 0.598 Vali Loss: 1.026 Vali Acc: 0.546 Test Loss: 1.026 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.754573822021484
Epoch: 30, Steps: 17 | Train Loss: 0.520 Vali Loss: 1.066 Vali Acc: 0.570 Test Loss: 1.066 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.961727142333984
Epoch: 31, Steps: 17 | Train Loss: 0.553 Vali Loss: 1.693 Vali Acc: 0.519 Test Loss: 1.693 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.971580505371094
Epoch: 32, Steps: 17 | Train Loss: 0.472 Vali Loss: 1.677 Vali Acc: 0.536 Test Loss: 1.677 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.045476675033569
Epoch: 33, Steps: 17 | Train Loss: 0.469 Vali Loss: 1.327 Vali Acc: 0.580 Test Loss: 1.327 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.2651872634887695
Epoch: 34, Steps: 17 | Train Loss: 0.488 Vali Loss: 1.523 Vali Acc: 0.546 Test Loss: 1.523 Test Acc: 0.546
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5972696245733788
model parameter : 493666
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.425574541091919
Epoch: 1, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.695 Vali Acc: 0.567 Test Loss: 0.695 Test Acc: 0.567
Validation loss decreased (inf --> -0.566546).  Saving model ...
Epoch: 2 cost time: 5.2626237869262695
Epoch: 2, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.661 Vali Acc: 0.635 Test Loss: 0.661 Test Acc: 0.635
Validation loss decreased (-0.566546 --> -0.634806).  Saving model ...
Epoch: 3 cost time: 4.573378324508667
Epoch: 3, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.771 Vali Acc: 0.652 Test Loss: 0.771 Test Acc: 0.652
Validation loss decreased (-0.634806 --> -0.651869).  Saving model ...
Epoch: 4 cost time: 4.566629409790039
Epoch: 4, Steps: 17 | Train Loss: 0.368 Vali Loss: 1.500 Vali Acc: 0.539 Test Loss: 1.500 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.6065123081207275
Epoch: 5, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.728 Vali Acc: 0.652 Test Loss: 0.728 Test Acc: 0.652
Validation loss decreased (-0.651869 --> -0.651870).  Saving model ...
Epoch: 6 cost time: 4.8544697761535645
Epoch: 6, Steps: 17 | Train Loss: 0.340 Vali Loss: 1.206 Vali Acc: 0.618 Test Loss: 1.206 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.687475681304932
Epoch: 7, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.884 Vali Acc: 0.676 Test Loss: 0.884 Test Acc: 0.676
Validation loss decreased (-0.651870 --> -0.675759).  Saving model ...
Epoch: 8 cost time: 4.67419171333313
Epoch: 8, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.910 Vali Acc: 0.672 Test Loss: 0.910 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.8007872104644775
Epoch: 9, Steps: 17 | Train Loss: 0.171 Vali Loss: 1.159 Vali Acc: 0.648 Test Loss: 1.159 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.887115955352783
Epoch: 10, Steps: 17 | Train Loss: 0.138 Vali Loss: 1.864 Vali Acc: 0.584 Test Loss: 1.864 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.731218338012695
Epoch: 11, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.056 Vali Acc: 0.676 Test Loss: 1.056 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.118485927581787
Epoch: 12, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.368 Vali Acc: 0.652 Test Loss: 1.368 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.904123783111572
Epoch: 13, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.974 Vali Acc: 0.679 Test Loss: 0.974 Test Acc: 0.679
Validation loss decreased (-0.675759 --> -0.679171).  Saving model ...
Epoch: 14 cost time: 4.834112882614136
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 2.042 Vali Acc: 0.611 Test Loss: 2.042 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.094750642776489
Epoch: 15, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.077 Vali Acc: 0.645 Test Loss: 1.077 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.185728311538696
Epoch: 16, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.410 Vali Acc: 0.693 Test Loss: 1.410 Test Acc: 0.693
Validation loss decreased (-0.679171 --> -0.692819).  Saving model ...
Epoch: 17 cost time: 5.284856796264648
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.733 Vali Acc: 0.669 Test Loss: 1.733 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.217905282974243
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.392 Vali Acc: 0.693 Test Loss: 1.392 Test Acc: 0.693
Validation loss decreased (-0.692819 --> -0.692819).  Saving model ...
Epoch: 19 cost time: 5.2120232582092285
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.521 Vali Acc: 0.696 Test Loss: 1.521 Test Acc: 0.696
Validation loss decreased (-0.692819 --> -0.696231).  Saving model ...
Epoch: 20 cost time: 4.937497138977051
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.690 Vali Acc: 0.676 Test Loss: 1.690 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.2666919231414795
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.319 Vali Acc: 0.696 Test Loss: 1.319 Test Acc: 0.696
Validation loss decreased (-0.696231 --> -0.696233).  Saving model ...
Epoch: 22 cost time: 4.828035593032837
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.312 Vali Acc: 0.700 Test Loss: 1.312 Test Acc: 0.700
Validation loss decreased (-0.696233 --> -0.699646).  Saving model ...
Epoch: 23 cost time: 4.910749912261963
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.467 Vali Acc: 0.703 Test Loss: 1.467 Test Acc: 0.703
Validation loss decreased (-0.699646 --> -0.703057).  Saving model ...
Epoch: 24 cost time: 4.891996145248413
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.955 Vali Acc: 0.666 Test Loss: 1.955 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.211175918579102
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.602 Vali Acc: 0.693 Test Loss: 1.602 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.346009731292725
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.472 Vali Acc: 0.710 Test Loss: 1.472 Test Acc: 0.710
Validation loss decreased (-0.703057 --> -0.709883).  Saving model ...
Epoch: 27 cost time: 5.157522678375244
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.485 Vali Acc: 0.703 Test Loss: 1.485 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.99968409538269
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.686 Vali Acc: 0.693 Test Loss: 1.686 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.140055418014526
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.572 Vali Acc: 0.700 Test Loss: 1.572 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.977277517318726
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.742 Vali Acc: 0.693 Test Loss: 1.742 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.985546350479126
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.567 Vali Acc: 0.693 Test Loss: 1.567 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.141713619232178
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.714 Vali Acc: 0.696 Test Loss: 1.714 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.894507884979248
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.509 Vali Acc: 0.696 Test Loss: 1.509 Test Acc: 0.696
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.661585092544556
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.676 Vali Acc: 0.696 Test Loss: 1.676 Test Acc: 0.696
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.916973352432251
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.479 Vali Acc: 0.720 Test Loss: 1.479 Test Acc: 0.720
Validation loss decreased (-0.709883 --> -0.720122).  Saving model ...
Epoch: 36 cost time: 5.1340012550354
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.479 Vali Acc: 0.724 Test Loss: 1.479 Test Acc: 0.724
Validation loss decreased (-0.720122 --> -0.723535).  Saving model ...
Epoch: 37 cost time: 5.335141897201538
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.654 Vali Acc: 0.696 Test Loss: 1.654 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.959982872009277
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.651 Vali Acc: 0.700 Test Loss: 1.651 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 5.156646728515625
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.580 Vali Acc: 0.710 Test Loss: 1.580 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 4.94934344291687
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.542 Vali Acc: 0.720 Test Loss: 1.542 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 4.889345169067383
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.875 Vali Acc: 0.693 Test Loss: 1.875 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 4.780073881149292
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.706 Vali Acc: 0.703 Test Loss: 1.706 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 4.760227203369141
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.681 Vali Acc: 0.710 Test Loss: 1.681 Test Acc: 0.710
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 4.839241027832031
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.618 Vali Acc: 0.713 Test Loss: 1.618 Test Acc: 0.713
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 4.7485034465789795
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.700 Test Loss: 1.749 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 4.999652624130249
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.710 Test Loss: 1.691 Test Acc: 0.710
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.7235494880546075
model parameter : 297058
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.5573437213897705
Epoch: 1, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.683 Vali Acc: 0.556 Test Loss: 0.683 Test Acc: 0.556
Validation loss decreased (inf --> -0.556307).  Saving model ...
Epoch: 2 cost time: 5.529651403427124
Epoch: 2, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.648 Vali Acc: 0.590 Test Loss: 0.648 Test Acc: 0.590
Validation loss decreased (-0.556307 --> -0.590437).  Saving model ...
Epoch: 3 cost time: 5.209999322891235
Epoch: 3, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.700 Vali Acc: 0.655 Test Loss: 0.700 Test Acc: 0.655
Validation loss decreased (-0.590437 --> -0.655283).  Saving model ...
Epoch: 4 cost time: 4.990989685058594
Epoch: 4, Steps: 17 | Train Loss: 0.390 Vali Loss: 1.415 Vali Acc: 0.543 Test Loss: 1.415 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.915865659713745
Epoch: 5, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.858 Vali Acc: 0.621 Test Loss: 0.858 Test Acc: 0.621
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.172862768173218
Epoch: 6, Steps: 17 | Train Loss: 0.324 Vali Loss: 1.404 Vali Acc: 0.577 Test Loss: 1.404 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.798737287521362
Epoch: 7, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.870 Vali Acc: 0.642 Test Loss: 0.870 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.992945671081543
Epoch: 8, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.994 Vali Acc: 0.635 Test Loss: 0.994 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.106557130813599
Epoch: 9, Steps: 17 | Train Loss: 0.174 Vali Loss: 1.169 Vali Acc: 0.659 Test Loss: 1.169 Test Acc: 0.659
Validation loss decreased (-0.655283 --> -0.658691).  Saving model ...
Epoch: 10 cost time: 5.530625343322754
Epoch: 10, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.713 Vali Acc: 0.590 Test Loss: 1.713 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.173504590988159
Epoch: 11, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.676 Vali Acc: 0.631 Test Loss: 1.676 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.458385705947876
Epoch: 12, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.460 Vali Acc: 0.628 Test Loss: 1.460 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.619013786315918
Epoch: 13, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.215 Vali Acc: 0.645 Test Loss: 1.215 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.382542371749878
Epoch: 14, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.790 Vali Acc: 0.655 Test Loss: 1.790 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.762124061584473
Epoch: 15, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.353 Vali Acc: 0.611 Test Loss: 1.353 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.524445056915283
Epoch: 16, Steps: 17 | Train Loss: 0.059 Vali Loss: 2.397 Vali Acc: 0.625 Test Loss: 2.397 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.157562255859375
Epoch: 17, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.538 Vali Acc: 0.594 Test Loss: 1.538 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.027994394302368
Epoch: 18, Steps: 17 | Train Loss: 0.067 Vali Loss: 2.079 Vali Acc: 0.631 Test Loss: 2.079 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.819782495498657
Epoch: 19, Steps: 17 | Train Loss: 0.041 Vali Loss: 2.027 Vali Acc: 0.631 Test Loss: 2.027 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.658703071672355
model parameter : 297058
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.796919822692871
Epoch: 1, Steps: 17 | Train Loss: 0.696 Vali Loss: 0.701 Vali Acc: 0.584 Test Loss: 0.701 Test Acc: 0.584
Validation loss decreased (inf --> -0.583611).  Saving model ...
Epoch: 2 cost time: 5.467540979385376
Epoch: 2, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.676 Vali Acc: 0.608 Test Loss: 0.676 Test Acc: 0.608
Validation loss decreased (-0.583611 --> -0.607502).  Saving model ...
Epoch: 3 cost time: 5.916652679443359
Epoch: 3, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.694 Vali Acc: 0.621 Test Loss: 0.694 Test Acc: 0.621
Validation loss decreased (-0.607502 --> -0.621153).  Saving model ...
Epoch: 4 cost time: 5.473787069320679
Epoch: 4, Steps: 17 | Train Loss: 0.396 Vali Loss: 1.528 Vali Acc: 0.526 Test Loss: 1.528 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.000552415847778
Epoch: 5, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.993 Vali Acc: 0.608 Test Loss: 0.993 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.697246074676514
Epoch: 6, Steps: 17 | Train Loss: 0.339 Vali Loss: 1.436 Vali Acc: 0.556 Test Loss: 1.436 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.891503810882568
Epoch: 7, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.915 Vali Acc: 0.604 Test Loss: 0.915 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.25910496711731
Epoch: 8, Steps: 17 | Train Loss: 0.211 Vali Loss: 1.072 Vali Acc: 0.625 Test Loss: 1.072 Test Acc: 0.625
Validation loss decreased (-0.621153 --> -0.624563).  Saving model ...
Epoch: 9 cost time: 5.1685192584991455
Epoch: 9, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.231 Vali Acc: 0.604 Test Loss: 1.231 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.412593364715576
Epoch: 10, Steps: 17 | Train Loss: 0.126 Vali Loss: 1.406 Vali Acc: 0.614 Test Loss: 1.406 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.526934385299683
Epoch: 11, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.621 Vali Acc: 0.625 Test Loss: 1.621 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.476316690444946
Epoch: 12, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.424 Vali Acc: 0.611 Test Loss: 1.424 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.62126612663269
Epoch: 13, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.534 Vali Acc: 0.621 Test Loss: 1.534 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.867713928222656
Epoch: 14, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.616 Vali Acc: 0.611 Test Loss: 1.616 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.990696907043457
Epoch: 15, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.486 Vali Acc: 0.631 Test Loss: 1.486 Test Acc: 0.631
Validation loss decreased (-0.624563 --> -0.631384).  Saving model ...
Epoch: 16 cost time: 5.023029088973999
Epoch: 16, Steps: 17 | Train Loss: 0.040 Vali Loss: 2.457 Vali Acc: 0.601 Test Loss: 2.457 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.871181964874268
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.563 Vali Acc: 0.625 Test Loss: 1.563 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.213860750198364
Epoch: 18, Steps: 17 | Train Loss: 0.060 Vali Loss: 2.229 Vali Acc: 0.628 Test Loss: 2.229 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.727185487747192
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.837 Vali Acc: 0.611 Test Loss: 1.837 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.200769424438477
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 2.639 Vali Acc: 0.608 Test Loss: 2.639 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.582820892333984
Epoch: 21, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.812 Vali Acc: 0.614 Test Loss: 1.812 Test Acc: 0.614
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.3924384117126465
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.677 Vali Acc: 0.631 Test Loss: 1.677 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.743678569793701
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.259 Vali Acc: 0.614 Test Loss: 2.259 Test Acc: 0.614
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.850995063781738
Epoch: 24, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.822 Vali Acc: 0.648 Test Loss: 1.822 Test Acc: 0.648
Validation loss decreased (-0.631384 --> -0.648446).  Saving model ...
Epoch: 25 cost time: 4.9496729373931885
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.668 Vali Acc: 0.587 Test Loss: 2.668 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.362147808074951
Epoch: 26, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.152 Vali Acc: 0.621 Test Loss: 2.152 Test Acc: 0.621
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.320531129837036
Epoch: 27, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.944 Vali Acc: 0.618 Test Loss: 1.944 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.671132326126099
Epoch: 28, Steps: 17 | Train Loss: 0.062 Vali Loss: 3.225 Vali Acc: 0.590 Test Loss: 3.225 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.694751501083374
Epoch: 29, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.051 Vali Acc: 0.642 Test Loss: 2.051 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.855765104293823
Epoch: 30, Steps: 17 | Train Loss: 0.021 Vali Loss: 2.408 Vali Acc: 0.621 Test Loss: 2.408 Test Acc: 0.621
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.498771667480469
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 3.113 Vali Acc: 0.608 Test Loss: 3.113 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.345252513885498
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 2.660 Vali Acc: 0.631 Test Loss: 2.660 Test Acc: 0.631
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.401728630065918
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.790 Vali Acc: 0.611 Test Loss: 2.790 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.581189393997192
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.767 Vali Acc: 0.625 Test Loss: 2.767 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6484641638225256
model parameter : 297058
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.972346305847168
Epoch: 1, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.690 Vali Acc: 0.556 Test Loss: 0.690 Test Acc: 0.556
Validation loss decreased (inf --> -0.556307).  Saving model ...
Epoch: 2 cost time: 5.455554723739624
Epoch: 2, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.702 Vali Acc: 0.546 Test Loss: 0.702 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.946171760559082
Epoch: 3, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.716 Vali Acc: 0.563 Test Loss: 0.716 Test Acc: 0.563
Validation loss decreased (-0.556307 --> -0.563133).  Saving model ...
Epoch: 4 cost time: 5.085608243942261
Epoch: 4, Steps: 17 | Train Loss: 0.394 Vali Loss: 1.409 Vali Acc: 0.539 Test Loss: 1.409 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.12379789352417
Epoch: 5, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.903 Vali Acc: 0.601 Test Loss: 0.903 Test Acc: 0.601
Validation loss decreased (-0.563133 --> -0.600674).  Saving model ...
Epoch: 6 cost time: 5.346914768218994
Epoch: 6, Steps: 17 | Train Loss: 0.297 Vali Loss: 1.462 Vali Acc: 0.543 Test Loss: 1.462 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.72259521484375
Epoch: 7, Steps: 17 | Train Loss: 0.282 Vali Loss: 1.056 Vali Acc: 0.625 Test Loss: 1.056 Test Acc: 0.625
Validation loss decreased (-0.600674 --> -0.624563).  Saving model ...
Epoch: 8 cost time: 5.367342233657837
Epoch: 8, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.982 Vali Acc: 0.608 Test Loss: 0.982 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.486898899078369
Epoch: 9, Steps: 17 | Train Loss: 0.148 Vali Loss: 1.457 Vali Acc: 0.577 Test Loss: 1.457 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.57043981552124
Epoch: 10, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.772 Vali Acc: 0.573 Test Loss: 1.772 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.169070482254028
Epoch: 11, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.546 Vali Acc: 0.590 Test Loss: 1.546 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.370917081832886
Epoch: 12, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.687 Vali Acc: 0.604 Test Loss: 1.687 Test Acc: 0.604
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.464005947113037
Epoch: 13, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.493 Vali Acc: 0.597 Test Loss: 1.493 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.537783145904541
Epoch: 14, Steps: 17 | Train Loss: 0.047 Vali Loss: 2.009 Vali Acc: 0.604 Test Loss: 2.009 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.981039047241211
Epoch: 15, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.706 Vali Acc: 0.628 Test Loss: 1.706 Test Acc: 0.628
Validation loss decreased (-0.624563 --> -0.627969).  Saving model ...
Epoch: 16 cost time: 5.274349212646484
Epoch: 16, Steps: 17 | Train Loss: 0.029 Vali Loss: 2.468 Vali Acc: 0.587 Test Loss: 2.468 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.440398693084717
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 2.186 Vali Acc: 0.590 Test Loss: 2.186 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.784176826477051
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.960 Vali Acc: 0.594 Test Loss: 1.960 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.003563404083252
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.238 Vali Acc: 0.597 Test Loss: 2.238 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.193091154098511
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 2.312 Vali Acc: 0.608 Test Loss: 2.312 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.2790687084198
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 2.156 Vali Acc: 0.614 Test Loss: 2.156 Test Acc: 0.614
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.149980306625366
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 2.105 Vali Acc: 0.601 Test Loss: 2.105 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.183010816574097
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 2.054 Vali Acc: 0.594 Test Loss: 2.054 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.10657262802124
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 2.817 Vali Acc: 0.587 Test Loss: 2.817 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.231668710708618
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 2.474 Vali Acc: 0.618 Test Loss: 2.474 Test Acc: 0.618
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6279863481228669
model parameter : 297058
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.267972469329834
Epoch: 1, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.706 Vali Acc: 0.536 Test Loss: 0.706 Test Acc: 0.536
Validation loss decreased (inf --> -0.535829).  Saving model ...
Epoch: 2 cost time: 5.1366424560546875
Epoch: 2, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.688 Vali Acc: 0.529 Test Loss: 0.688 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.317648887634277
Epoch: 3, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.671 Vali Acc: 0.645 Test Loss: 0.671 Test Acc: 0.645
Validation loss decreased (-0.535829 --> -0.645044).  Saving model ...
Epoch: 4 cost time: 5.639701843261719
Epoch: 4, Steps: 17 | Train Loss: 0.405 Vali Loss: 1.307 Vali Acc: 0.532 Test Loss: 1.307 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.622548341751099
Epoch: 5, Steps: 17 | Train Loss: 0.340 Vali Loss: 1.083 Vali Acc: 0.604 Test Loss: 1.083 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.28682279586792
Epoch: 6, Steps: 17 | Train Loss: 0.287 Vali Loss: 1.629 Vali Acc: 0.526 Test Loss: 1.629 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.125191926956177
Epoch: 7, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.985 Vali Acc: 0.631 Test Loss: 0.985 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.46924352645874
Epoch: 8, Steps: 17 | Train Loss: 0.228 Vali Loss: 1.181 Vali Acc: 0.631 Test Loss: 1.181 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.587647199630737
Epoch: 9, Steps: 17 | Train Loss: 0.159 Vali Loss: 1.562 Vali Acc: 0.590 Test Loss: 1.562 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.165224075317383
Epoch: 10, Steps: 17 | Train Loss: 0.146 Vali Loss: 1.272 Vali Acc: 0.628 Test Loss: 1.272 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.082256317138672
Epoch: 11, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.742 Vali Acc: 0.597 Test Loss: 1.742 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.383293151855469
Epoch: 12, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.350 Vali Acc: 0.648 Test Loss: 1.350 Test Acc: 0.648
Validation loss decreased (-0.645044 --> -0.648451).  Saving model ...
Epoch: 13 cost time: 5.3964924812316895
Epoch: 13, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.434 Vali Acc: 0.631 Test Loss: 1.434 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.073267936706543
Epoch: 14, Steps: 17 | Train Loss: 0.064 Vali Loss: 2.517 Vali Acc: 0.587 Test Loss: 2.517 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.027409076690674
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.769 Vali Acc: 0.635 Test Loss: 1.769 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.511675834655762
Epoch: 16, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.843 Vali Acc: 0.577 Test Loss: 2.843 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.587831497192383
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 2.028 Vali Acc: 0.611 Test Loss: 2.028 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.678908586502075
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 2.379 Vali Acc: 0.608 Test Loss: 2.379 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.528453350067139
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.906 Vali Acc: 0.618 Test Loss: 1.906 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.845618009567261
Epoch: 20, Steps: 17 | Train Loss: 0.029 Vali Loss: 2.848 Vali Acc: 0.587 Test Loss: 2.848 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.671834230422974
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 2.180 Vali Acc: 0.621 Test Loss: 2.180 Test Acc: 0.621
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.370523452758789
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.976 Vali Acc: 0.614 Test Loss: 1.976 Test Acc: 0.614
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6484641638225256
model parameter : 297058
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.621277332305908
Epoch: 1, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.765 Vali Acc: 0.509 Test Loss: 0.765 Test Acc: 0.509
Validation loss decreased (inf --> -0.508525).  Saving model ...
Epoch: 2 cost time: 5.284608840942383
Epoch: 2, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.664 Vali Acc: 0.563 Test Loss: 0.664 Test Acc: 0.563
Validation loss decreased (-0.508525 --> -0.563133).  Saving model ...
Epoch: 3 cost time: 4.284756183624268
Epoch: 3, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.659 Vali Acc: 0.611 Test Loss: 0.659 Test Acc: 0.611
Validation loss decreased (-0.563133 --> -0.610915).  Saving model ...
Epoch: 4 cost time: 4.660054922103882
Epoch: 4, Steps: 17 | Train Loss: 0.467 Vali Loss: 1.315 Vali Acc: 0.505 Test Loss: 1.315 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.449177026748657
Epoch: 5, Steps: 17 | Train Loss: 0.407 Vali Loss: 1.277 Vali Acc: 0.519 Test Loss: 1.277 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.740880012512207
Epoch: 6, Steps: 17 | Train Loss: 0.371 Vali Loss: 1.344 Vali Acc: 0.532 Test Loss: 1.344 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.644508123397827
Epoch: 7, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.912 Vali Acc: 0.584 Test Loss: 0.912 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.536994934082031
Epoch: 8, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.882 Vali Acc: 0.597 Test Loss: 0.882 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.313742399215698
Epoch: 9, Steps: 17 | Train Loss: 0.217 Vali Loss: 1.335 Vali Acc: 0.560 Test Loss: 1.335 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.224897861480713
Epoch: 10, Steps: 17 | Train Loss: 0.178 Vali Loss: 1.093 Vali Acc: 0.608 Test Loss: 1.093 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.032326936721802
Epoch: 11, Steps: 17 | Train Loss: 0.165 Vali Loss: 1.501 Vali Acc: 0.567 Test Loss: 1.501 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.165888071060181
Epoch: 12, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.345 Vali Acc: 0.601 Test Loss: 1.345 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.490269184112549
Epoch: 13, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.317 Vali Acc: 0.594 Test Loss: 1.317 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6109215017064846
model parameter : 297058
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.379570960998535
Epoch: 1, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.752 Vali Acc: 0.505 Test Loss: 0.752 Test Acc: 0.505
Validation loss decreased (inf --> -0.505112).  Saving model ...
Epoch: 2 cost time: 5.40505051612854
Epoch: 2, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.700 Vali Acc: 0.560 Test Loss: 0.700 Test Acc: 0.560
Validation loss decreased (-0.505112 --> -0.559720).  Saving model ...
Epoch: 3 cost time: 5.511960983276367
Epoch: 3, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.723 Vali Acc: 0.573 Test Loss: 0.723 Test Acc: 0.573
Validation loss decreased (-0.559720 --> -0.573372).  Saving model ...
Epoch: 4 cost time: 4.902318239212036
Epoch: 4, Steps: 17 | Train Loss: 0.474 Vali Loss: 1.184 Vali Acc: 0.505 Test Loss: 1.184 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.176026821136475
Epoch: 5, Steps: 17 | Train Loss: 0.416 Vali Loss: 1.372 Vali Acc: 0.512 Test Loss: 1.372 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.394076108932495
Epoch: 6, Steps: 17 | Train Loss: 0.393 Vali Loss: 1.173 Vali Acc: 0.532 Test Loss: 1.173 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.059707880020142
Epoch: 7, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.923 Vali Acc: 0.570 Test Loss: 0.923 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.089544773101807
Epoch: 8, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.994 Vali Acc: 0.567 Test Loss: 0.994 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.497180700302124
Epoch: 9, Steps: 17 | Train Loss: 0.253 Vali Loss: 1.155 Vali Acc: 0.563 Test Loss: 1.155 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.077160120010376
Epoch: 10, Steps: 17 | Train Loss: 0.254 Vali Loss: 1.360 Vali Acc: 0.556 Test Loss: 1.360 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.109651565551758
Epoch: 11, Steps: 17 | Train Loss: 0.207 Vali Loss: 1.290 Vali Acc: 0.546 Test Loss: 1.290 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.344124794006348
Epoch: 12, Steps: 17 | Train Loss: 0.194 Vali Loss: 1.521 Vali Acc: 0.546 Test Loss: 1.521 Test Acc: 0.546
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.919113397598267
Epoch: 13, Steps: 17 | Train Loss: 0.269 Vali Loss: 1.620 Vali Acc: 0.570 Test Loss: 1.620 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5733788395904437
model parameter : 297058
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.338629961013794
Epoch: 1, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.735 Vali Acc: 0.498 Test Loss: 0.735 Test Acc: 0.498
Validation loss decreased (inf --> -0.498286).  Saving model ...
Epoch: 2 cost time: 5.786227703094482
Epoch: 2, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.693 Vali Acc: 0.560 Test Loss: 0.693 Test Acc: 0.560
Validation loss decreased (-0.498286 --> -0.559720).  Saving model ...
Epoch: 3 cost time: 5.039036989212036
Epoch: 3, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.697 Vali Acc: 0.556 Test Loss: 0.697 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.276463031768799
Epoch: 4, Steps: 17 | Train Loss: 0.503 Vali Loss: 1.199 Vali Acc: 0.502 Test Loss: 1.199 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.874570608139038
Epoch: 5, Steps: 17 | Train Loss: 0.442 Vali Loss: 1.299 Vali Acc: 0.509 Test Loss: 1.299 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.827093124389648
Epoch: 6, Steps: 17 | Train Loss: 0.395 Vali Loss: 1.377 Vali Acc: 0.522 Test Loss: 1.377 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.5299763679504395
Epoch: 7, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.961 Vali Acc: 0.532 Test Loss: 0.961 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.669011831283569
Epoch: 8, Steps: 17 | Train Loss: 0.349 Vali Loss: 1.205 Vali Acc: 0.522 Test Loss: 1.205 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.0041399002075195
Epoch: 9, Steps: 17 | Train Loss: 0.282 Vali Loss: 1.417 Vali Acc: 0.519 Test Loss: 1.417 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.620269060134888
Epoch: 10, Steps: 17 | Train Loss: 0.250 Vali Loss: 1.468 Vali Acc: 0.536 Test Loss: 1.468 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.074891090393066
Epoch: 11, Steps: 17 | Train Loss: 0.245 Vali Loss: 1.646 Vali Acc: 0.512 Test Loss: 1.646 Test Acc: 0.512
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.7199485301971436
Epoch: 12, Steps: 17 | Train Loss: 0.199 Vali Loss: 1.736 Vali Acc: 0.512 Test Loss: 1.736 Test Acc: 0.512
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5597269624573379
model parameter : 297058
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.53484582901001
Epoch: 1, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.811 Vali Acc: 0.502 Test Loss: 0.811 Test Acc: 0.502
Validation loss decreased (inf --> -0.501698).  Saving model ...
Epoch: 2 cost time: 5.566606760025024
Epoch: 2, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.717 Vali Acc: 0.502 Test Loss: 0.717 Test Acc: 0.502
Validation loss decreased (-0.501698 --> -0.501699).  Saving model ...
Epoch: 3 cost time: 5.254389047622681
Epoch: 3, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.842 Vali Acc: 0.502 Test Loss: 0.842 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.861938953399658
Epoch: 4, Steps: 17 | Train Loss: 0.543 Vali Loss: 1.408 Vali Acc: 0.502 Test Loss: 1.408 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.354629755020142
Epoch: 5, Steps: 17 | Train Loss: 0.535 Vali Loss: 1.468 Vali Acc: 0.502 Test Loss: 1.468 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.025583982467651
Epoch: 6, Steps: 17 | Train Loss: 0.519 Vali Loss: 1.204 Vali Acc: 0.502 Test Loss: 1.204 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.162629842758179
Epoch: 7, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.665 Vali Acc: 0.570 Test Loss: 0.665 Test Acc: 0.570
Validation loss decreased (-0.501699 --> -0.569959).  Saving model ...
Epoch: 8 cost time: 5.201186895370483
Epoch: 8, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.730 Vali Acc: 0.498 Test Loss: 0.730 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.58601188659668
Epoch: 9, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.795 Vali Acc: 0.498 Test Loss: 0.795 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.633002758026123
Epoch: 10, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.982 Vali Acc: 0.502 Test Loss: 0.982 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.77119779586792
Epoch: 11, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.733 Vali Acc: 0.526 Test Loss: 0.733 Test Acc: 0.526
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.676357984542847
Epoch: 12, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.733 Vali Acc: 0.522 Test Loss: 0.733 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.405224800109863
Epoch: 13, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.937 Vali Acc: 0.512 Test Loss: 0.937 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.6307532787323
Epoch: 14, Steps: 17 | Train Loss: 0.532 Vali Loss: 1.037 Vali Acc: 0.505 Test Loss: 1.037 Test Acc: 0.505
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.969260215759277
Epoch: 15, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.673 Vali Acc: 0.614 Test Loss: 0.673 Test Acc: 0.614
Validation loss decreased (-0.569959 --> -0.614328).  Saving model ...
Epoch: 16 cost time: 4.900685787200928
Epoch: 16, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.687 Vali Acc: 0.621 Test Loss: 0.687 Test Acc: 0.621
Validation loss decreased (-0.614328 --> -0.621154).  Saving model ...
Epoch: 17 cost time: 4.944606065750122
Epoch: 17, Steps: 17 | Train Loss: 0.583 Vali Loss: 1.319 Vali Acc: 0.498 Test Loss: 1.319 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.1481873989105225
Epoch: 18, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.742 Vali Acc: 0.597 Test Loss: 0.742 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.691725730895996
Epoch: 19, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.910 Vali Acc: 0.560 Test Loss: 0.910 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.295195817947388
Epoch: 20, Steps: 17 | Train Loss: 0.422 Vali Loss: 1.474 Vali Acc: 0.512 Test Loss: 1.474 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.43221378326416
Epoch: 21, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.805 Vali Acc: 0.594 Test Loss: 0.805 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.273681640625
Epoch: 22, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.843 Vali Acc: 0.604 Test Loss: 0.843 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.028260946273804
Epoch: 23, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.913 Vali Acc: 0.601 Test Loss: 0.913 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.802248001098633
Epoch: 24, Steps: 17 | Train Loss: 0.293 Vali Loss: 1.862 Vali Acc: 0.509 Test Loss: 1.862 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.096065998077393
Epoch: 25, Steps: 17 | Train Loss: 0.344 Vali Loss: 1.416 Vali Acc: 0.563 Test Loss: 1.416 Test Acc: 0.563
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.013545036315918
Epoch: 26, Steps: 17 | Train Loss: 0.414 Vali Loss: 2.057 Vali Acc: 0.509 Test Loss: 2.057 Test Acc: 0.509
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.621160409556314
model parameter : 297058
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.374301910400391
Epoch: 1, Steps: 17 | Train Loss: 0.679 Vali Loss: 0.801 Vali Acc: 0.502 Test Loss: 0.801 Test Acc: 0.502
Validation loss decreased (inf --> -0.501698).  Saving model ...
Epoch: 2 cost time: 5.342190265655518
Epoch: 2, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.848 Vali Acc: 0.502 Test Loss: 0.848 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.650155067443848
Epoch: 3, Steps: 17 | Train Loss: 0.597 Vali Loss: 1.192 Vali Acc: 0.502 Test Loss: 1.192 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.678739547729492
Epoch: 4, Steps: 17 | Train Loss: 0.537 Vali Loss: 1.802 Vali Acc: 0.502 Test Loss: 1.802 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.482738018035889
Epoch: 5, Steps: 17 | Train Loss: 0.537 Vali Loss: 1.645 Vali Acc: 0.502 Test Loss: 1.645 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.235563278198242
Epoch: 6, Steps: 17 | Train Loss: 0.517 Vali Loss: 1.745 Vali Acc: 0.502 Test Loss: 1.745 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.392940998077393
Epoch: 7, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.966 Vali Acc: 0.502 Test Loss: 0.966 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.806422472000122
Epoch: 8, Steps: 17 | Train Loss: 0.537 Vali Loss: 1.077 Vali Acc: 0.502 Test Loss: 1.077 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.744577884674072
Epoch: 9, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.909 Vali Acc: 0.505 Test Loss: 0.909 Test Acc: 0.505
Validation loss decreased (-0.501698 --> -0.505110).  Saving model ...
Epoch: 10 cost time: 4.871861219406128
Epoch: 10, Steps: 17 | Train Loss: 0.484 Vali Loss: 1.138 Vali Acc: 0.502 Test Loss: 1.138 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.736250400543213
Epoch: 11, Steps: 17 | Train Loss: 0.444 Vali Loss: 1.275 Vali Acc: 0.502 Test Loss: 1.275 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.70415472984314
Epoch: 12, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.799 Vali Acc: 0.556 Test Loss: 0.799 Test Acc: 0.556
Validation loss decreased (-0.505110 --> -0.556306).  Saving model ...
Epoch: 13 cost time: 5.219496726989746
Epoch: 13, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.767 Vali Acc: 0.546 Test Loss: 0.767 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.378106117248535
Epoch: 14, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.780 Vali Acc: 0.529 Test Loss: 0.780 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.874206066131592
Epoch: 15, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.831 Vali Acc: 0.567 Test Loss: 0.831 Test Acc: 0.567
Validation loss decreased (-0.556306 --> -0.566545).  Saving model ...
Epoch: 16 cost time: 5.040926694869995
Epoch: 16, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.752 Vali Acc: 0.608 Test Loss: 0.752 Test Acc: 0.608
Validation loss decreased (-0.566545 --> -0.607501).  Saving model ...
Epoch: 17 cost time: 4.961965084075928
Epoch: 17, Steps: 17 | Train Loss: 0.520 Vali Loss: 1.033 Vali Acc: 0.539 Test Loss: 1.033 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.873407602310181
Epoch: 18, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.920 Vali Acc: 0.556 Test Loss: 0.920 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.678634405136108
Epoch: 19, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.803 Vali Acc: 0.577 Test Loss: 0.803 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.982397556304932
Epoch: 20, Steps: 17 | Train Loss: 0.547 Vali Loss: 1.231 Vali Acc: 0.536 Test Loss: 1.231 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.118614673614502
Epoch: 21, Steps: 17 | Train Loss: 0.517 Vali Loss: 1.314 Vali Acc: 0.543 Test Loss: 1.314 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.659207344055176
Epoch: 22, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.849 Vali Acc: 0.580 Test Loss: 0.849 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.6832380294799805
Epoch: 23, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.819 Vali Acc: 0.601 Test Loss: 0.819 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.556203365325928
Epoch: 24, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.955 Vali Acc: 0.546 Test Loss: 0.955 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.72709321975708
Epoch: 25, Steps: 17 | Train Loss: 0.507 Vali Loss: 1.505 Vali Acc: 0.553 Test Loss: 1.505 Test Acc: 0.553
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.432196855545044
Epoch: 26, Steps: 17 | Train Loss: 0.548 Vali Loss: 1.111 Vali Acc: 0.597 Test Loss: 1.111 Test Acc: 0.597
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6075085324232082
model parameter : 297058
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.304019451141357
Epoch: 1, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.688 Vali Acc: 0.519 Test Loss: 0.688 Test Acc: 0.519
Validation loss decreased (inf --> -0.518764).  Saving model ...
Epoch: 2 cost time: 4.772806406021118
Epoch: 2, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.937 Vali Acc: 0.522 Test Loss: 0.937 Test Acc: 0.522
Validation loss decreased (-0.518764 --> -0.522175).  Saving model ...
Epoch: 3 cost time: 4.937641143798828
Epoch: 3, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.836 Vali Acc: 0.614 Test Loss: 0.836 Test Acc: 0.614
Validation loss decreased (-0.522175 --> -0.614326).  Saving model ...
Epoch: 4 cost time: 4.666555881500244
Epoch: 4, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.789 Vali Acc: 0.669 Test Loss: 0.789 Test Acc: 0.669
Validation loss decreased (-0.614326 --> -0.668934).  Saving model ...
Epoch: 5 cost time: 4.672546863555908
Epoch: 5, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.867 Vali Acc: 0.642 Test Loss: 0.867 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.574453592300415
Epoch: 6, Steps: 17 | Train Loss: 0.297 Vali Loss: 1.377 Vali Acc: 0.594 Test Loss: 1.377 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.74950909614563
Epoch: 7, Steps: 17 | Train Loss: 0.221 Vali Loss: 1.092 Vali Acc: 0.631 Test Loss: 1.092 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.858501434326172
Epoch: 8, Steps: 17 | Train Loss: 0.199 Vali Loss: 1.509 Vali Acc: 0.604 Test Loss: 1.509 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.9059226512908936
Epoch: 9, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.872 Vali Acc: 0.655 Test Loss: 0.872 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.952993154525757
Epoch: 10, Steps: 17 | Train Loss: 0.141 Vali Loss: 1.270 Vali Acc: 0.659 Test Loss: 1.270 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.792733192443848
Epoch: 11, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.879 Vali Acc: 0.700 Test Loss: 0.879 Test Acc: 0.700
Validation loss decreased (-0.668934 --> -0.699650).  Saving model ...
Epoch: 12 cost time: 5.040761232376099
Epoch: 12, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.720 Vali Acc: 0.611 Test Loss: 1.720 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.241036415100098
Epoch: 13, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.127 Vali Acc: 0.683 Test Loss: 1.127 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.735335350036621
Epoch: 14, Steps: 17 | Train Loss: 0.048 Vali Loss: 2.050 Vali Acc: 0.618 Test Loss: 2.050 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.001708030700684
Epoch: 15, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.358 Vali Acc: 0.689 Test Loss: 1.358 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.667582988739014
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.686 Vali Acc: 0.666 Test Loss: 1.686 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.062151908874512
Epoch: 17, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.760 Vali Acc: 0.652 Test Loss: 1.760 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.004498720169067
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.719 Vali Acc: 0.669 Test Loss: 1.719 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.072106599807739
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.739 Vali Acc: 0.659 Test Loss: 1.739 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.624176263809204
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.494 Vali Acc: 0.652 Test Loss: 1.494 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.80028772354126
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.910 Vali Acc: 0.666 Test Loss: 1.910 Test Acc: 0.666
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6996587030716723
model parameter : 198754
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.434312582015991
Epoch: 1, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.689 Vali Acc: 0.546 Test Loss: 0.689 Test Acc: 0.546
Validation loss decreased (inf --> -0.546068).  Saving model ...
Epoch: 2 cost time: 4.731333494186401
Epoch: 2, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.926 Vali Acc: 0.529 Test Loss: 0.926 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.982171535491943
Epoch: 3, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.876 Vali Acc: 0.573 Test Loss: 0.876 Test Acc: 0.573
Validation loss decreased (-0.546068 --> -0.573370).  Saving model ...
Epoch: 4 cost time: 4.985251188278198
Epoch: 4, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.870 Vali Acc: 0.601 Test Loss: 0.870 Test Acc: 0.601
Validation loss decreased (-0.573370 --> -0.600674).  Saving model ...
Epoch: 5 cost time: 5.084766864776611
Epoch: 5, Steps: 17 | Train Loss: 0.310 Vali Loss: 1.010 Vali Acc: 0.601 Test Loss: 1.010 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.816411972045898
Epoch: 6, Steps: 17 | Train Loss: 0.289 Vali Loss: 1.214 Vali Acc: 0.594 Test Loss: 1.214 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.289108991622925
Epoch: 7, Steps: 17 | Train Loss: 0.258 Vali Loss: 1.138 Vali Acc: 0.614 Test Loss: 1.138 Test Acc: 0.614
Validation loss decreased (-0.600674 --> -0.614323).  Saving model ...
Epoch: 8 cost time: 5.26568603515625
Epoch: 8, Steps: 17 | Train Loss: 0.337 Vali Loss: 2.140 Vali Acc: 0.543 Test Loss: 2.140 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.802307605743408
Epoch: 9, Steps: 17 | Train Loss: 0.280 Vali Loss: 1.756 Vali Acc: 0.567 Test Loss: 1.756 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.462638854980469
Epoch: 10, Steps: 17 | Train Loss: 0.159 Vali Loss: 1.004 Vali Acc: 0.655 Test Loss: 1.004 Test Acc: 0.655
Validation loss decreased (-0.614323 --> -0.655280).  Saving model ...
Epoch: 11 cost time: 5.853243350982666
Epoch: 11, Steps: 17 | Train Loss: 0.132 Vali Loss: 1.060 Vali Acc: 0.648 Test Loss: 1.060 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.449828863143921
Epoch: 12, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.684 Vali Acc: 0.631 Test Loss: 1.684 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.094683647155762
Epoch: 13, Steps: 17 | Train Loss: 0.091 Vali Loss: 1.367 Vali Acc: 0.631 Test Loss: 1.367 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.847365140914917
Epoch: 14, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.981 Vali Acc: 0.614 Test Loss: 1.981 Test Acc: 0.614
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.8252832889556885
Epoch: 15, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.826 Vali Acc: 0.638 Test Loss: 1.826 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.8216729164123535
Epoch: 16, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.650 Vali Acc: 0.635 Test Loss: 1.650 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.33144736289978
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.868 Vali Acc: 0.631 Test Loss: 1.868 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.7635884284973145
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.647 Vali Acc: 0.652 Test Loss: 1.647 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.389635801315308
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.928 Vali Acc: 0.645 Test Loss: 1.928 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.417837858200073
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.817 Vali Acc: 0.628 Test Loss: 1.817 Test Acc: 0.628
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6552901023890785
model parameter : 198754
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.72407078742981
Epoch: 1, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.711 Vali Acc: 0.505 Test Loss: 0.711 Test Acc: 0.505
Validation loss decreased (inf --> -0.505112).  Saving model ...
Epoch: 2 cost time: 5.240027904510498
Epoch: 2, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.944 Vali Acc: 0.512 Test Loss: 0.944 Test Acc: 0.512
Validation loss decreased (-0.505112 --> -0.511936).  Saving model ...
Epoch: 3 cost time: 5.400684833526611
Epoch: 3, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.980 Vali Acc: 0.539 Test Loss: 0.980 Test Acc: 0.539
Validation loss decreased (-0.511936 --> -0.539239).  Saving model ...
Epoch: 4 cost time: 4.297667503356934
Epoch: 4, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.866 Vali Acc: 0.601 Test Loss: 0.866 Test Acc: 0.601
Validation loss decreased (-0.539239 --> -0.600674).  Saving model ...
Epoch: 5 cost time: 5.186437129974365
Epoch: 5, Steps: 17 | Train Loss: 0.336 Vali Loss: 1.007 Vali Acc: 0.594 Test Loss: 1.007 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.069611072540283
Epoch: 6, Steps: 17 | Train Loss: 0.303 Vali Loss: 1.317 Vali Acc: 0.577 Test Loss: 1.317 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.245382070541382
Epoch: 7, Steps: 17 | Train Loss: 0.259 Vali Loss: 1.104 Vali Acc: 0.601 Test Loss: 1.104 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.084155559539795
Epoch: 8, Steps: 17 | Train Loss: 0.235 Vali Loss: 1.505 Vali Acc: 0.577 Test Loss: 1.505 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.282305002212524
Epoch: 9, Steps: 17 | Train Loss: 0.161 Vali Loss: 1.225 Vali Acc: 0.608 Test Loss: 1.225 Test Acc: 0.608
Validation loss decreased (-0.600674 --> -0.607496).  Saving model ...
Epoch: 10 cost time: 5.31039834022522
Epoch: 10, Steps: 17 | Train Loss: 0.135 Vali Loss: 1.194 Vali Acc: 0.628 Test Loss: 1.194 Test Acc: 0.628
Validation loss decreased (-0.607496 --> -0.627974).  Saving model ...
Epoch: 11 cost time: 5.679248332977295
Epoch: 11, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.025 Vali Acc: 0.655 Test Loss: 1.025 Test Acc: 0.655
Validation loss decreased (-0.627974 --> -0.655280).  Saving model ...
Epoch: 12 cost time: 4.399224758148193
Epoch: 12, Steps: 17 | Train Loss: 0.155 Vali Loss: 1.558 Vali Acc: 0.635 Test Loss: 1.558 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.674671649932861
Epoch: 13, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.631 Vali Acc: 0.618 Test Loss: 1.631 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.606653928756714
Epoch: 14, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.836 Vali Acc: 0.625 Test Loss: 1.836 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.053199529647827
Epoch: 15, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.894 Vali Acc: 0.608 Test Loss: 1.894 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.224936008453369
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.903 Vali Acc: 0.614 Test Loss: 1.903 Test Acc: 0.614
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.373483657836914
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 2.131 Vali Acc: 0.621 Test Loss: 2.131 Test Acc: 0.621
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.709447860717773
Epoch: 18, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.912 Vali Acc: 0.618 Test Loss: 1.912 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.894790410995483
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 2.091 Vali Acc: 0.614 Test Loss: 2.091 Test Acc: 0.614
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.151344299316406
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.825 Vali Acc: 0.635 Test Loss: 1.825 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.9251978397369385
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 3.028 Vali Acc: 0.584 Test Loss: 3.028 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6552901023890785
model parameter : 198754
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.308549642562866
Epoch: 1, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.696 Vali Acc: 0.549 Test Loss: 0.696 Test Acc: 0.549
Validation loss decreased (inf --> -0.549481).  Saving model ...
Epoch: 2 cost time: 5.427953004837036
Epoch: 2, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.894 Vali Acc: 0.526 Test Loss: 0.894 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.267627716064453
Epoch: 3, Steps: 17 | Train Loss: 0.488 Vali Loss: 1.000 Vali Acc: 0.546 Test Loss: 1.000 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.994701623916626
Epoch: 4, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.805 Vali Acc: 0.577 Test Loss: 0.805 Test Acc: 0.577
Validation loss decreased (-0.549481 --> -0.576784).  Saving model ...
Epoch: 5 cost time: 4.8215508460998535
Epoch: 5, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.956 Vali Acc: 0.587 Test Loss: 0.956 Test Acc: 0.587
Validation loss decreased (-0.576784 --> -0.587021).  Saving model ...
Epoch: 6 cost time: 4.589240789413452
Epoch: 6, Steps: 17 | Train Loss: 0.284 Vali Loss: 1.315 Vali Acc: 0.567 Test Loss: 1.315 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.679950952529907
Epoch: 7, Steps: 17 | Train Loss: 0.236 Vali Loss: 1.262 Vali Acc: 0.594 Test Loss: 1.262 Test Acc: 0.594
Validation loss decreased (-0.587021 --> -0.593844).  Saving model ...
Epoch: 8 cost time: 4.521776437759399
Epoch: 8, Steps: 17 | Train Loss: 0.218 Vali Loss: 1.156 Vali Acc: 0.618 Test Loss: 1.156 Test Acc: 0.618
Validation loss decreased (-0.593844 --> -0.617736).  Saving model ...
Epoch: 9 cost time: 4.396130561828613
Epoch: 9, Steps: 17 | Train Loss: 0.150 Vali Loss: 1.347 Vali Acc: 0.604 Test Loss: 1.347 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.271722316741943
Epoch: 10, Steps: 17 | Train Loss: 0.126 Vali Loss: 1.704 Vali Acc: 0.587 Test Loss: 1.704 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.999035358428955
Epoch: 11, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.145 Vali Acc: 0.604 Test Loss: 1.145 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.006419897079468
Epoch: 12, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.722 Vali Acc: 0.584 Test Loss: 1.722 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.873111248016357
Epoch: 13, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.952 Vali Acc: 0.584 Test Loss: 1.952 Test Acc: 0.584
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.95068621635437
Epoch: 14, Steps: 17 | Train Loss: 0.059 Vali Loss: 2.467 Vali Acc: 0.573 Test Loss: 2.467 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.792322874069214
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.778 Vali Acc: 0.590 Test Loss: 1.778 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.318033695220947
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 2.269 Vali Acc: 0.597 Test Loss: 2.269 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.643380165100098
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.616 Vali Acc: 0.580 Test Loss: 2.616 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.524461507797241
Epoch: 18, Steps: 17 | Train Loss: 0.035 Vali Loss: 2.014 Vali Acc: 0.594 Test Loss: 2.014 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6177474402730375
model parameter : 198754
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.695034742355347
Epoch: 1, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.689 Vali Acc: 0.522 Test Loss: 0.689 Test Acc: 0.522
Validation loss decreased (inf --> -0.522177).  Saving model ...
Epoch: 2 cost time: 5.0107457637786865
Epoch: 2, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.810 Vali Acc: 0.532 Test Loss: 0.810 Test Acc: 0.532
Validation loss decreased (-0.522177 --> -0.532415).  Saving model ...
Epoch: 3 cost time: 5.4775660037994385
Epoch: 3, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.901 Vali Acc: 0.567 Test Loss: 0.901 Test Acc: 0.567
Validation loss decreased (-0.532415 --> -0.566544).  Saving model ...
Epoch: 4 cost time: 5.171632766723633
Epoch: 4, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.859 Vali Acc: 0.611 Test Loss: 0.859 Test Acc: 0.611
Validation loss decreased (-0.566544 --> -0.610913).  Saving model ...
Epoch: 5 cost time: 5.1776134967803955
Epoch: 5, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.969 Vali Acc: 0.618 Test Loss: 0.969 Test Acc: 0.618
Validation loss decreased (-0.610913 --> -0.617738).  Saving model ...
Epoch: 6 cost time: 5.38842248916626
Epoch: 6, Steps: 17 | Train Loss: 0.296 Vali Loss: 1.436 Vali Acc: 0.556 Test Loss: 1.436 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.258151292800903
Epoch: 7, Steps: 17 | Train Loss: 0.255 Vali Loss: 1.240 Vali Acc: 0.590 Test Loss: 1.240 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.839958190917969
Epoch: 8, Steps: 17 | Train Loss: 0.242 Vali Loss: 1.637 Vali Acc: 0.567 Test Loss: 1.637 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.112934350967407
Epoch: 9, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.335 Vali Acc: 0.625 Test Loss: 1.335 Test Acc: 0.625
Validation loss decreased (-0.617738 --> -0.624560).  Saving model ...
Epoch: 10 cost time: 4.741360187530518
Epoch: 10, Steps: 17 | Train Loss: 0.141 Vali Loss: 1.712 Vali Acc: 0.597 Test Loss: 1.712 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.243847370147705
Epoch: 11, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.194 Vali Acc: 0.631 Test Loss: 1.194 Test Acc: 0.631
Validation loss decreased (-0.624560 --> -0.631387).  Saving model ...
Epoch: 12 cost time: 5.156933069229126
Epoch: 12, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.953 Vali Acc: 0.587 Test Loss: 1.953 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.131481885910034
Epoch: 13, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.820 Vali Acc: 0.611 Test Loss: 1.820 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.2796690464019775
Epoch: 14, Steps: 17 | Train Loss: 0.076 Vali Loss: 2.077 Vali Acc: 0.587 Test Loss: 2.077 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.687366247177124
Epoch: 15, Steps: 17 | Train Loss: 0.047 Vali Loss: 2.193 Vali Acc: 0.580 Test Loss: 2.193 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.941555738449097
Epoch: 16, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.719 Vali Acc: 0.577 Test Loss: 2.719 Test Acc: 0.577
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.3984575271606445
Epoch: 17, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.443 Vali Acc: 0.601 Test Loss: 2.443 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.114270210266113
Epoch: 18, Steps: 17 | Train Loss: 0.047 Vali Loss: 2.333 Vali Acc: 0.590 Test Loss: 2.333 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.292616605758667
Epoch: 19, Steps: 17 | Train Loss: 0.024 Vali Loss: 2.265 Vali Acc: 0.604 Test Loss: 2.265 Test Acc: 0.604
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.683110237121582
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.336 Vali Acc: 0.608 Test Loss: 2.336 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.956076383590698
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 3.044 Vali Acc: 0.590 Test Loss: 3.044 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6313993174061433
model parameter : 198754
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.009005784988403
Epoch: 1, Steps: 17 | Train Loss: 0.690 Vali Loss: 0.682 Vali Acc: 0.509 Test Loss: 0.682 Test Acc: 0.509
Validation loss decreased (inf --> -0.508526).  Saving model ...
Epoch: 2 cost time: 5.277977228164673
Epoch: 2, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.833 Vali Acc: 0.509 Test Loss: 0.833 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.507650375366211
Epoch: 3, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.884 Vali Acc: 0.532 Test Loss: 0.884 Test Acc: 0.532
Validation loss decreased (-0.508526 --> -0.532414).  Saving model ...
Epoch: 4 cost time: 5.130618333816528
Epoch: 4, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.900 Vali Acc: 0.529 Test Loss: 0.900 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.287584066390991
Epoch: 5, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.839 Vali Acc: 0.549 Test Loss: 0.839 Test Acc: 0.549
Validation loss decreased (-0.532414 --> -0.549480).  Saving model ...
Epoch: 6 cost time: 4.675766468048096
Epoch: 6, Steps: 17 | Train Loss: 0.417 Vali Loss: 1.737 Vali Acc: 0.509 Test Loss: 1.737 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.69266939163208
Epoch: 7, Steps: 17 | Train Loss: 0.360 Vali Loss: 1.314 Vali Acc: 0.529 Test Loss: 1.314 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.22011399269104
Epoch: 8, Steps: 17 | Train Loss: 0.274 Vali Loss: 1.261 Vali Acc: 0.543 Test Loss: 1.261 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.734827518463135
Epoch: 9, Steps: 17 | Train Loss: 0.245 Vali Loss: 1.191 Vali Acc: 0.549 Test Loss: 1.191 Test Acc: 0.549
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.674341678619385
Epoch: 10, Steps: 17 | Train Loss: 0.193 Vali Loss: 1.445 Vali Acc: 0.563 Test Loss: 1.445 Test Acc: 0.563
Validation loss decreased (-0.549480 --> -0.563125).  Saving model ...
Epoch: 11 cost time: 4.5606865882873535
Epoch: 11, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.976 Vali Acc: 0.611 Test Loss: 0.976 Test Acc: 0.611
Validation loss decreased (-0.563125 --> -0.610912).  Saving model ...
Epoch: 12 cost time: 4.622669696807861
Epoch: 12, Steps: 17 | Train Loss: 0.199 Vali Loss: 1.820 Vali Acc: 0.522 Test Loss: 1.820 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.083658695220947
Epoch: 13, Steps: 17 | Train Loss: 0.150 Vali Loss: 1.466 Vali Acc: 0.573 Test Loss: 1.466 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.450992107391357
Epoch: 14, Steps: 17 | Train Loss: 0.124 Vali Loss: 2.222 Vali Acc: 0.532 Test Loss: 2.222 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.282706022262573
Epoch: 15, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.364 Vali Acc: 0.587 Test Loss: 1.364 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.302807092666626
Epoch: 16, Steps: 17 | Train Loss: 0.118 Vali Loss: 2.325 Vali Acc: 0.556 Test Loss: 2.325 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.419055700302124
Epoch: 17, Steps: 17 | Train Loss: 0.069 Vali Loss: 2.217 Vali Acc: 0.549 Test Loss: 2.217 Test Acc: 0.549
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.221942186355591
Epoch: 18, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.792 Vali Acc: 0.556 Test Loss: 1.792 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.931254625320435
Epoch: 19, Steps: 17 | Train Loss: 0.057 Vali Loss: 2.415 Vali Acc: 0.560 Test Loss: 2.415 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.631531000137329
Epoch: 20, Steps: 17 | Train Loss: 0.044 Vali Loss: 2.099 Vali Acc: 0.567 Test Loss: 2.099 Test Acc: 0.567
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.352985382080078
Epoch: 21, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.712 Vali Acc: 0.546 Test Loss: 2.712 Test Acc: 0.546
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6109215017064846
model parameter : 198754
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.0800817012786865
Epoch: 1, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.721 Vali Acc: 0.488 Test Loss: 0.721 Test Acc: 0.488
Validation loss decreased (inf --> -0.488047).  Saving model ...
Epoch: 2 cost time: 5.092901706695557
Epoch: 2, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.878 Vali Acc: 0.502 Test Loss: 0.878 Test Acc: 0.502
Validation loss decreased (-0.488047 --> -0.501698).  Saving model ...
Epoch: 3 cost time: 5.263969421386719
Epoch: 3, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.910 Vali Acc: 0.519 Test Loss: 0.910 Test Acc: 0.519
Validation loss decreased (-0.501698 --> -0.518762).  Saving model ...
Epoch: 4 cost time: 5.062144994735718
Epoch: 4, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.874 Vali Acc: 0.549 Test Loss: 0.874 Test Acc: 0.549
Validation loss decreased (-0.518762 --> -0.549479).  Saving model ...
Epoch: 5 cost time: 5.0223517417907715
Epoch: 5, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.867 Vali Acc: 0.570 Test Loss: 0.867 Test Acc: 0.570
Validation loss decreased (-0.549479 --> -0.569957).  Saving model ...
Epoch: 6 cost time: 4.8484461307525635
Epoch: 6, Steps: 17 | Train Loss: 0.435 Vali Loss: 1.506 Vali Acc: 0.515 Test Loss: 1.506 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.717903137207031
Epoch: 7, Steps: 17 | Train Loss: 0.424 Vali Loss: 1.685 Vali Acc: 0.526 Test Loss: 1.685 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.4729697704315186
Epoch: 8, Steps: 17 | Train Loss: 0.328 Vali Loss: 1.210 Vali Acc: 0.553 Test Loss: 1.210 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.3602306842803955
Epoch: 9, Steps: 17 | Train Loss: 0.321 Vali Loss: 1.306 Vali Acc: 0.539 Test Loss: 1.306 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.558450222015381
Epoch: 10, Steps: 17 | Train Loss: 0.247 Vali Loss: 1.396 Vali Acc: 0.556 Test Loss: 1.396 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.289257764816284
Epoch: 11, Steps: 17 | Train Loss: 0.243 Vali Loss: 1.105 Vali Acc: 0.587 Test Loss: 1.105 Test Acc: 0.587
Validation loss decreased (-0.569957 --> -0.587020).  Saving model ...
Epoch: 12 cost time: 4.567319631576538
Epoch: 12, Steps: 17 | Train Loss: 0.248 Vali Loss: 1.335 Vali Acc: 0.560 Test Loss: 1.335 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.905630588531494
Epoch: 13, Steps: 17 | Train Loss: 0.182 Vali Loss: 1.329 Vali Acc: 0.573 Test Loss: 1.329 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.861140489578247
Epoch: 14, Steps: 17 | Train Loss: 0.186 Vali Loss: 2.097 Vali Acc: 0.556 Test Loss: 2.097 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.99835991859436
Epoch: 15, Steps: 17 | Train Loss: 0.145 Vali Loss: 1.628 Vali Acc: 0.549 Test Loss: 1.628 Test Acc: 0.549
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.065207004547119
Epoch: 16, Steps: 17 | Train Loss: 0.150 Vali Loss: 1.865 Vali Acc: 0.556 Test Loss: 1.865 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.304457902908325
Epoch: 17, Steps: 17 | Train Loss: 0.120 Vali Loss: 2.330 Vali Acc: 0.539 Test Loss: 2.330 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.830429315567017
Epoch: 18, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.566 Vali Acc: 0.556 Test Loss: 1.566 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.939972877502441
Epoch: 19, Steps: 17 | Train Loss: 0.096 Vali Loss: 2.101 Vali Acc: 0.543 Test Loss: 2.101 Test Acc: 0.543
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.007058143615723
Epoch: 20, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.800 Vali Acc: 0.553 Test Loss: 1.800 Test Acc: 0.553
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.6253440380096436
Epoch: 21, Steps: 17 | Train Loss: 0.088 Vali Loss: 2.998 Vali Acc: 0.532 Test Loss: 2.998 Test Acc: 0.532
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5870307167235495
model parameter : 198754
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.7231059074401855
Epoch: 1, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.719 Vali Acc: 0.522 Test Loss: 0.719 Test Acc: 0.522
Validation loss decreased (inf --> -0.522177).  Saving model ...
Epoch: 2 cost time: 6.011407136917114
Epoch: 2, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.939 Vali Acc: 0.502 Test Loss: 0.939 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.689976215362549
Epoch: 3, Steps: 17 | Train Loss: 0.532 Vali Loss: 1.011 Vali Acc: 0.502 Test Loss: 1.011 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.271708011627197
Epoch: 4, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.881 Vali Acc: 0.519 Test Loss: 0.881 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.738818883895874
Epoch: 5, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.804 Vali Acc: 0.519 Test Loss: 0.804 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.291718482971191
Epoch: 6, Steps: 17 | Train Loss: 0.438 Vali Loss: 1.306 Vali Acc: 0.515 Test Loss: 1.306 Test Acc: 0.515
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.291521310806274
Epoch: 7, Steps: 17 | Train Loss: 0.377 Vali Loss: 1.238 Vali Acc: 0.522 Test Loss: 1.238 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.258312225341797
Epoch: 8, Steps: 17 | Train Loss: 0.322 Vali Loss: 1.318 Vali Acc: 0.522 Test Loss: 1.318 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.118286848068237
Epoch: 9, Steps: 17 | Train Loss: 0.299 Vali Loss: 1.308 Vali Acc: 0.522 Test Loss: 1.308 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.208250999450684
Epoch: 10, Steps: 17 | Train Loss: 0.248 Vali Loss: 1.537 Vali Acc: 0.505 Test Loss: 1.537 Test Acc: 0.505
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.657995223999023
Epoch: 11, Steps: 17 | Train Loss: 0.217 Vali Loss: 1.372 Vali Acc: 0.532 Test Loss: 1.372 Test Acc: 0.532
Validation loss decreased (-0.522177 --> -0.532409).  Saving model ...
Epoch: 12 cost time: 5.568989515304565
Epoch: 12, Steps: 17 | Train Loss: 0.201 Vali Loss: 2.012 Vali Acc: 0.491 Test Loss: 2.012 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.3988964557647705
Epoch: 13, Steps: 17 | Train Loss: 0.193 Vali Loss: 1.507 Vali Acc: 0.532 Test Loss: 1.507 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.440533876419067
Epoch: 14, Steps: 17 | Train Loss: 0.182 Vali Loss: 2.404 Vali Acc: 0.509 Test Loss: 2.404 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.681825637817383
Epoch: 15, Steps: 17 | Train Loss: 0.155 Vali Loss: 1.984 Vali Acc: 0.519 Test Loss: 1.984 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.141460418701172
Epoch: 16, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.849 Vali Acc: 0.502 Test Loss: 1.849 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.989832401275635
Epoch: 17, Steps: 17 | Train Loss: 0.124 Vali Loss: 2.949 Vali Acc: 0.505 Test Loss: 2.949 Test Acc: 0.505
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.07110595703125
Epoch: 18, Steps: 17 | Train Loss: 0.184 Vali Loss: 2.179 Vali Acc: 0.515 Test Loss: 2.179 Test Acc: 0.515
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.14219069480896
Epoch: 19, Steps: 17 | Train Loss: 0.102 Vali Loss: 2.496 Vali Acc: 0.495 Test Loss: 2.496 Test Acc: 0.495
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.897536754608154
Epoch: 20, Steps: 17 | Train Loss: 0.079 Vali Loss: 2.382 Vali Acc: 0.509 Test Loss: 2.382 Test Acc: 0.509
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.441952705383301
Epoch: 21, Steps: 17 | Train Loss: 0.048 Vali Loss: 2.730 Vali Acc: 0.498 Test Loss: 2.730 Test Acc: 0.498
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5324232081911263
model parameter : 198754
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.7502031326293945
Epoch: 1, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.755 Vali Acc: 0.502 Test Loss: 0.755 Test Acc: 0.502
Validation loss decreased (inf --> -0.501699).  Saving model ...
Epoch: 2 cost time: 5.083230018615723
Epoch: 2, Steps: 17 | Train Loss: 0.603 Vali Loss: 1.114 Vali Acc: 0.502 Test Loss: 1.114 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.563371181488037
Epoch: 3, Steps: 17 | Train Loss: 0.568 Vali Loss: 1.268 Vali Acc: 0.502 Test Loss: 1.268 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.335216999053955
Epoch: 4, Steps: 17 | Train Loss: 0.550 Vali Loss: 1.131 Vali Acc: 0.502 Test Loss: 1.131 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.029810905456543
Epoch: 5, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.738 Vali Acc: 0.502 Test Loss: 0.738 Test Acc: 0.502
Validation loss decreased (-0.501699 --> -0.501699).  Saving model ...
Epoch: 6 cost time: 4.857022047042847
Epoch: 6, Steps: 17 | Train Loss: 0.527 Vali Loss: 1.357 Vali Acc: 0.502 Test Loss: 1.357 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.775483131408691
Epoch: 7, Steps: 17 | Train Loss: 0.489 Vali Loss: 1.352 Vali Acc: 0.502 Test Loss: 1.352 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.240273714065552
Epoch: 8, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.922 Vali Acc: 0.502 Test Loss: 0.922 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.266775369644165
Epoch: 9, Steps: 17 | Train Loss: 0.499 Vali Loss: 1.041 Vali Acc: 0.502 Test Loss: 1.041 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.578587055206299
Epoch: 10, Steps: 17 | Train Loss: 0.418 Vali Loss: 1.200 Vali Acc: 0.502 Test Loss: 1.200 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.616302967071533
Epoch: 11, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.680 Vali Acc: 0.567 Test Loss: 0.680 Test Acc: 0.567
Validation loss decreased (-0.501699 --> -0.566546).  Saving model ...
Epoch: 12 cost time: 5.378330945968628
Epoch: 12, Steps: 17 | Train Loss: 0.448 Vali Loss: 1.461 Vali Acc: 0.502 Test Loss: 1.461 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.561751365661621
Epoch: 13, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.693 Vali Acc: 0.549 Test Loss: 0.693 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.784167289733887
Epoch: 14, Steps: 17 | Train Loss: 0.442 Vali Loss: 1.074 Vali Acc: 0.505 Test Loss: 1.074 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.912421226501465
Epoch: 15, Steps: 17 | Train Loss: 0.450 Vali Loss: 1.269 Vali Acc: 0.498 Test Loss: 1.269 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.00256085395813
Epoch: 16, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.747 Vali Acc: 0.577 Test Loss: 0.747 Test Acc: 0.577
Validation loss decreased (-0.566546 --> -0.576784).  Saving model ...
Epoch: 17 cost time: 4.413300275802612
Epoch: 17, Steps: 17 | Train Loss: 0.373 Vali Loss: 1.575 Vali Acc: 0.498 Test Loss: 1.575 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.889719009399414
Epoch: 18, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.861 Vali Acc: 0.553 Test Loss: 0.861 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.833555221557617
Epoch: 19, Steps: 17 | Train Loss: 0.328 Vali Loss: 1.154 Vali Acc: 0.519 Test Loss: 1.154 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.0986316204071045
Epoch: 20, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.781 Vali Acc: 0.590 Test Loss: 0.781 Test Acc: 0.590
Validation loss decreased (-0.576784 --> -0.590436).  Saving model ...
Epoch: 21 cost time: 5.198338508605957
Epoch: 21, Steps: 17 | Train Loss: 0.348 Vali Loss: 1.916 Vali Acc: 0.502 Test Loss: 1.916 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.200777769088745
Epoch: 22, Steps: 17 | Train Loss: 0.425 Vali Loss: 1.104 Vali Acc: 0.556 Test Loss: 1.104 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.449352979660034
Epoch: 23, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.979 Vali Acc: 0.608 Test Loss: 0.979 Test Acc: 0.608
Validation loss decreased (-0.590436 --> -0.607499).  Saving model ...
Epoch: 24 cost time: 5.252969980239868
Epoch: 24, Steps: 17 | Train Loss: 0.271 Vali Loss: 1.779 Vali Acc: 0.543 Test Loss: 1.779 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.958787441253662
Epoch: 25, Steps: 17 | Train Loss: 0.454 Vali Loss: 1.214 Vali Acc: 0.587 Test Loss: 1.214 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.861274480819702
Epoch: 26, Steps: 17 | Train Loss: 0.259 Vali Loss: 1.331 Vali Acc: 0.563 Test Loss: 1.331 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.099683046340942
Epoch: 27, Steps: 17 | Train Loss: 0.348 Vali Loss: 1.262 Vali Acc: 0.573 Test Loss: 1.262 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.541985273361206
Epoch: 28, Steps: 17 | Train Loss: 0.236 Vali Loss: 1.236 Vali Acc: 0.601 Test Loss: 1.236 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.797982692718506
Epoch: 29, Steps: 17 | Train Loss: 0.260 Vali Loss: 1.184 Vali Acc: 0.601 Test Loss: 1.184 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.1875526905059814
Epoch: 30, Steps: 17 | Train Loss: 0.176 Vali Loss: 1.392 Vali Acc: 0.580 Test Loss: 1.392 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.447706699371338
Epoch: 31, Steps: 17 | Train Loss: 0.179 Vali Loss: 1.384 Vali Acc: 0.594 Test Loss: 1.384 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.527504205703735
Epoch: 32, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.507 Vali Acc: 0.584 Test Loss: 1.507 Test Acc: 0.584
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.269163370132446
Epoch: 33, Steps: 17 | Train Loss: 0.244 Vali Loss: 1.442 Vali Acc: 0.601 Test Loss: 1.442 Test Acc: 0.601
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6075085324232082
model parameter : 198754
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.763273239135742
Epoch: 1, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.774 Vali Acc: 0.498 Test Loss: 0.774 Test Acc: 0.498
Validation loss decreased (inf --> -0.498286).  Saving model ...
Epoch: 2 cost time: 5.007575035095215
Epoch: 2, Steps: 17 | Train Loss: 0.599 Vali Loss: 1.151 Vali Acc: 0.502 Test Loss: 1.151 Test Acc: 0.502
Validation loss decreased (-0.498286 --> -0.501695).  Saving model ...
Epoch: 3 cost time: 4.988563537597656
Epoch: 3, Steps: 17 | Train Loss: 0.575 Vali Loss: 1.177 Vali Acc: 0.502 Test Loss: 1.177 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.886151313781738
Epoch: 4, Steps: 17 | Train Loss: 0.551 Vali Loss: 1.265 Vali Acc: 0.502 Test Loss: 1.265 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.834680557250977
Epoch: 5, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.968 Vali Acc: 0.502 Test Loss: 0.968 Test Acc: 0.502
Validation loss decreased (-0.501695 --> -0.501697).  Saving model ...
Epoch: 6 cost time: 5.180921316146851
Epoch: 6, Steps: 17 | Train Loss: 0.555 Vali Loss: 1.485 Vali Acc: 0.502 Test Loss: 1.485 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.166014909744263
Epoch: 7, Steps: 17 | Train Loss: 0.501 Vali Loss: 1.456 Vali Acc: 0.502 Test Loss: 1.456 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.399344205856323
Epoch: 8, Steps: 17 | Train Loss: 0.500 Vali Loss: 1.324 Vali Acc: 0.502 Test Loss: 1.324 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.537113189697266
Epoch: 9, Steps: 17 | Train Loss: 0.531 Vali Loss: 1.578 Vali Acc: 0.502 Test Loss: 1.578 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.478473901748657
Epoch: 10, Steps: 17 | Train Loss: 0.457 Vali Loss: 1.368 Vali Acc: 0.502 Test Loss: 1.368 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.753180980682373
Epoch: 11, Steps: 17 | Train Loss: 0.498 Vali Loss: 1.093 Vali Acc: 0.502 Test Loss: 1.093 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.463575601577759
Epoch: 12, Steps: 17 | Train Loss: 0.484 Vali Loss: 1.299 Vali Acc: 0.502 Test Loss: 1.299 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.1515583992004395
Epoch: 13, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.814 Vali Acc: 0.536 Test Loss: 0.814 Test Acc: 0.536
Validation loss decreased (-0.501697 --> -0.535828).  Saving model ...
Epoch: 14 cost time: 5.116517543792725
Epoch: 14, Steps: 17 | Train Loss: 0.495 Vali Loss: 1.096 Vali Acc: 0.519 Test Loss: 1.096 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.0856711864471436
Epoch: 15, Steps: 17 | Train Loss: 0.491 Vali Loss: 1.815 Vali Acc: 0.502 Test Loss: 1.815 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.428475379943848
Epoch: 16, Steps: 17 | Train Loss: 0.543 Vali Loss: 1.839 Vali Acc: 0.502 Test Loss: 1.839 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.5158326625823975
Epoch: 17, Steps: 17 | Train Loss: 0.486 Vali Loss: 1.728 Vali Acc: 0.502 Test Loss: 1.728 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.211375713348389
Epoch: 18, Steps: 17 | Train Loss: 0.481 Vali Loss: 1.490 Vali Acc: 0.519 Test Loss: 1.490 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.153651714324951
Epoch: 19, Steps: 17 | Train Loss: 0.363 Vali Loss: 1.350 Vali Acc: 0.529 Test Loss: 1.350 Test Acc: 0.529
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.420912027359009
Epoch: 20, Steps: 17 | Train Loss: 0.430 Vali Loss: 1.053 Vali Acc: 0.563 Test Loss: 1.053 Test Acc: 0.563
Validation loss decreased (-0.535828 --> -0.563129).  Saving model ...
Epoch: 21 cost time: 5.5301594734191895
Epoch: 21, Steps: 17 | Train Loss: 0.400 Vali Loss: 1.557 Vali Acc: 0.526 Test Loss: 1.557 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.448792219161987
Epoch: 22, Steps: 17 | Train Loss: 0.467 Vali Loss: 1.685 Vali Acc: 0.526 Test Loss: 1.685 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.141822576522827
Epoch: 23, Steps: 17 | Train Loss: 0.355 Vali Loss: 1.206 Vali Acc: 0.560 Test Loss: 1.206 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.708177089691162
Epoch: 24, Steps: 17 | Train Loss: 0.399 Vali Loss: 1.536 Vali Acc: 0.536 Test Loss: 1.536 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.8059117794036865
Epoch: 25, Steps: 17 | Train Loss: 0.465 Vali Loss: 1.386 Vali Acc: 0.556 Test Loss: 1.386 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.806950330734253
Epoch: 26, Steps: 17 | Train Loss: 0.391 Vali Loss: 1.952 Vali Acc: 0.539 Test Loss: 1.952 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.867415428161621
Epoch: 27, Steps: 17 | Train Loss: 0.473 Vali Loss: 1.173 Vali Acc: 0.601 Test Loss: 1.173 Test Acc: 0.601
Validation loss decreased (-0.563129 --> -0.600671).  Saving model ...
Epoch: 28 cost time: 4.883803367614746
Epoch: 28, Steps: 17 | Train Loss: 0.328 Vali Loss: 1.660 Vali Acc: 0.567 Test Loss: 1.660 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.397740602493286
Epoch: 29, Steps: 17 | Train Loss: 0.341 Vali Loss: 1.707 Vali Acc: 0.580 Test Loss: 1.707 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.562940359115601
Epoch: 30, Steps: 17 | Train Loss: 0.372 Vali Loss: 2.227 Vali Acc: 0.590 Test Loss: 2.227 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.5948405265808105
Epoch: 31, Steps: 17 | Train Loss: 0.349 Vali Loss: 1.770 Vali Acc: 0.597 Test Loss: 1.770 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.4623799324035645
Epoch: 32, Steps: 17 | Train Loss: 0.368 Vali Loss: 2.025 Vali Acc: 0.584 Test Loss: 2.025 Test Acc: 0.584
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.666624069213867
Epoch: 33, Steps: 17 | Train Loss: 0.426 Vali Loss: 2.333 Vali Acc: 0.594 Test Loss: 2.333 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.098745346069336
Epoch: 34, Steps: 17 | Train Loss: 0.446 Vali Loss: 2.047 Vali Acc: 0.560 Test Loss: 2.047 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 5.0988006591796875
Epoch: 35, Steps: 17 | Train Loss: 0.563 Vali Loss: 1.971 Vali Acc: 0.577 Test Loss: 1.971 Test Acc: 0.577
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 4.974905729293823
Epoch: 36, Steps: 17 | Train Loss: 0.478 Vali Loss: 2.843 Vali Acc: 0.556 Test Loss: 2.843 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.72199010848999
Epoch: 37, Steps: 17 | Train Loss: 0.400 Vali Loss: 2.025 Vali Acc: 0.580 Test Loss: 2.025 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6006825938566553
model parameter : 198754
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.230739593505859
Epoch: 1, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.690 Vali Acc: 0.546 Test Loss: 0.690 Test Acc: 0.546
Validation loss decreased (inf --> -0.546068).  Saving model ...
Epoch: 2 cost time: 5.25160813331604
Epoch: 2, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.778 Vali Acc: 0.573 Test Loss: 0.778 Test Acc: 0.573
Validation loss decreased (-0.546068 --> -0.573371).  Saving model ...
Epoch: 3 cost time: 5.609988689422607
Epoch: 3, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.979 Vali Acc: 0.567 Test Loss: 0.979 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.053657293319702
Epoch: 4, Steps: 17 | Train Loss: 0.383 Vali Loss: 1.189 Vali Acc: 0.573 Test Loss: 1.189 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.399975776672363
Epoch: 5, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.717 Vali Acc: 0.655 Test Loss: 0.717 Test Acc: 0.655
Validation loss decreased (-0.573371 --> -0.655283).  Saving model ...
Epoch: 6 cost time: 5.025581359863281
Epoch: 6, Steps: 17 | Train Loss: 0.282 Vali Loss: 1.379 Vali Acc: 0.584 Test Loss: 1.379 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.395037651062012
Epoch: 7, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.744 Vali Acc: 0.669 Test Loss: 0.744 Test Acc: 0.669
Validation loss decreased (-0.655283 --> -0.668935).  Saving model ...
Epoch: 8 cost time: 5.043027639389038
Epoch: 8, Steps: 17 | Train Loss: 0.226 Vali Loss: 1.179 Vali Acc: 0.618 Test Loss: 1.179 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.27001166343689
Epoch: 9, Steps: 17 | Train Loss: 0.213 Vali Loss: 1.016 Vali Acc: 0.628 Test Loss: 1.016 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.980269908905029
Epoch: 10, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.959 Vali Acc: 0.676 Test Loss: 0.959 Test Acc: 0.676
Validation loss decreased (-0.668935 --> -0.675758).  Saving model ...
Epoch: 11 cost time: 4.828071117401123
Epoch: 11, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.995 Vali Acc: 0.700 Test Loss: 0.995 Test Acc: 0.700
Validation loss decreased (-0.675758 --> -0.699649).  Saving model ...
Epoch: 12 cost time: 4.748090982437134
Epoch: 12, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.130 Vali Acc: 0.676 Test Loss: 1.130 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.157146215438843
Epoch: 13, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.224 Vali Acc: 0.669 Test Loss: 1.224 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.4092371463775635
Epoch: 14, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.453 Vali Acc: 0.655 Test Loss: 1.453 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.0929787158966064
Epoch: 15, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.390 Vali Acc: 0.662 Test Loss: 1.390 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.184343099594116
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.192 Vali Acc: 0.679 Test Loss: 1.192 Test Acc: 0.679
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.551501989364624
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.847 Vali Acc: 0.652 Test Loss: 1.847 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.935399770736694
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.554 Vali Acc: 0.676 Test Loss: 1.554 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.887844085693359
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.988 Vali Acc: 0.642 Test Loss: 1.988 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.826598644256592
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.844 Vali Acc: 0.652 Test Loss: 1.844 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.787678003311157
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.430 Vali Acc: 0.676 Test Loss: 1.430 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6996587030716723
model parameter : 149602
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.233401775360107
Epoch: 1, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.681 Vali Acc: 0.567 Test Loss: 0.681 Test Acc: 0.567
Validation loss decreased (inf --> -0.566546).  Saving model ...
Epoch: 2 cost time: 5.731065273284912
Epoch: 2, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.769 Vali Acc: 0.577 Test Loss: 0.769 Test Acc: 0.577
Validation loss decreased (-0.566546 --> -0.576784).  Saving model ...
Epoch: 3 cost time: 5.520956039428711
Epoch: 3, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.993 Vali Acc: 0.560 Test Loss: 0.993 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.926954746246338
Epoch: 4, Steps: 17 | Train Loss: 0.392 Vali Loss: 1.324 Vali Acc: 0.529 Test Loss: 1.324 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.693451881408691
Epoch: 5, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.757 Vali Acc: 0.638 Test Loss: 0.757 Test Acc: 0.638
Validation loss decreased (-0.576784 --> -0.638218).  Saving model ...
Epoch: 6 cost time: 5.3969385623931885
Epoch: 6, Steps: 17 | Train Loss: 0.298 Vali Loss: 1.278 Vali Acc: 0.584 Test Loss: 1.278 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.172516822814941
Epoch: 7, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.825 Vali Acc: 0.645 Test Loss: 0.825 Test Acc: 0.645
Validation loss decreased (-0.638218 --> -0.645043).  Saving model ...
Epoch: 8 cost time: 4.705938816070557
Epoch: 8, Steps: 17 | Train Loss: 0.206 Vali Loss: 1.248 Vali Acc: 0.597 Test Loss: 1.248 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.382985830307007
Epoch: 9, Steps: 17 | Train Loss: 0.183 Vali Loss: 1.155 Vali Acc: 0.625 Test Loss: 1.155 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.0320353507995605
Epoch: 10, Steps: 17 | Train Loss: 0.150 Vali Loss: 1.113 Vali Acc: 0.635 Test Loss: 1.113 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.480366468429565
Epoch: 11, Steps: 17 | Train Loss: 0.139 Vali Loss: 1.159 Vali Acc: 0.655 Test Loss: 1.159 Test Acc: 0.655
Validation loss decreased (-0.645043 --> -0.655279).  Saving model ...
Epoch: 12 cost time: 5.347435235977173
Epoch: 12, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.337 Vali Acc: 0.635 Test Loss: 1.337 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.202743053436279
Epoch: 13, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.674 Vali Acc: 0.631 Test Loss: 1.674 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.223074674606323
Epoch: 14, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.459 Vali Acc: 0.631 Test Loss: 1.459 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.162914276123047
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.503 Vali Acc: 0.635 Test Loss: 1.503 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.6653149127960205
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.487 Vali Acc: 0.655 Test Loss: 1.487 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.7070183753967285
Epoch: 17, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.857 Vali Acc: 0.635 Test Loss: 1.857 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.152608633041382
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.872 Vali Acc: 0.648 Test Loss: 1.872 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.8203959465026855
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 2.158 Vali Acc: 0.635 Test Loss: 2.158 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.092759847640991
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 2.128 Vali Acc: 0.638 Test Loss: 2.128 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.964423418045044
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.857 Vali Acc: 0.652 Test Loss: 1.857 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6552901023890785
model parameter : 149602
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.871181964874268
Epoch: 1, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.694 Vali Acc: 0.529 Test Loss: 0.694 Test Acc: 0.529
Validation loss decreased (inf --> -0.529003).  Saving model ...
Epoch: 2 cost time: 4.985213994979858
Epoch: 2, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.791 Vali Acc: 0.567 Test Loss: 0.791 Test Acc: 0.567
Validation loss decreased (-0.529003 --> -0.566545).  Saving model ...
Epoch: 3 cost time: 5.342041492462158
Epoch: 3, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.963 Vali Acc: 0.549 Test Loss: 0.963 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.719694137573242
Epoch: 4, Steps: 17 | Train Loss: 0.383 Vali Loss: 1.145 Vali Acc: 0.549 Test Loss: 1.145 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.985331296920776
Epoch: 5, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.801 Vali Acc: 0.594 Test Loss: 0.801 Test Acc: 0.594
Validation loss decreased (-0.566545 --> -0.593849).  Saving model ...
Epoch: 6 cost time: 5.1141908168792725
Epoch: 6, Steps: 17 | Train Loss: 0.323 Vali Loss: 1.382 Vali Acc: 0.556 Test Loss: 1.382 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.161752223968506
Epoch: 7, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.873 Vali Acc: 0.621 Test Loss: 0.873 Test Acc: 0.621
Validation loss decreased (-0.593849 --> -0.621152).  Saving model ...
Epoch: 8 cost time: 5.1946306228637695
Epoch: 8, Steps: 17 | Train Loss: 0.212 Vali Loss: 1.269 Vali Acc: 0.580 Test Loss: 1.269 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.36958909034729
Epoch: 9, Steps: 17 | Train Loss: 0.183 Vali Loss: 1.303 Vali Acc: 0.580 Test Loss: 1.303 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.043727397918701
Epoch: 10, Steps: 17 | Train Loss: 0.173 Vali Loss: 1.206 Vali Acc: 0.611 Test Loss: 1.206 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.800381898880005
Epoch: 11, Steps: 17 | Train Loss: 0.135 Vali Loss: 1.363 Vali Acc: 0.608 Test Loss: 1.363 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.792532444000244
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.580 Vali Acc: 0.611 Test Loss: 1.580 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.115165710449219
Epoch: 13, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.213 Vali Acc: 0.628 Test Loss: 1.213 Test Acc: 0.628
Validation loss decreased (-0.621152 --> -0.627974).  Saving model ...
Epoch: 14 cost time: 5.88405442237854
Epoch: 14, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.546 Vali Acc: 0.631 Test Loss: 1.546 Test Acc: 0.631
Validation loss decreased (-0.627974 --> -0.631384).  Saving model ...
Epoch: 15 cost time: 4.9309000968933105
Epoch: 15, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.781 Vali Acc: 0.614 Test Loss: 1.781 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.118225812911987
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.662 Vali Acc: 0.635 Test Loss: 1.662 Test Acc: 0.635
Validation loss decreased (-0.631384 --> -0.634796).  Saving model ...
Epoch: 17 cost time: 5.107322692871094
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 2.259 Vali Acc: 0.628 Test Loss: 2.259 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.860530138015747
Epoch: 18, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.825 Vali Acc: 0.628 Test Loss: 1.825 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.897165060043335
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.391 Vali Acc: 0.587 Test Loss: 2.391 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.978200912475586
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.963 Vali Acc: 0.642 Test Loss: 1.963 Test Acc: 0.642
Validation loss decreased (-0.634796 --> -0.641619).  Saving model ...
Epoch: 21 cost time: 5.461604118347168
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.977 Vali Acc: 0.625 Test Loss: 1.977 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.094875812530518
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 2.085 Vali Acc: 0.614 Test Loss: 2.085 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.015215873718262
Epoch: 23, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.156 Vali Acc: 0.604 Test Loss: 2.156 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.771694660186768
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 2.657 Vali Acc: 0.587 Test Loss: 2.657 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.014744520187378
Epoch: 25, Steps: 17 | Train Loss: 0.049 Vali Loss: 2.879 Vali Acc: 0.604 Test Loss: 2.879 Test Acc: 0.604
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.370686769485474
Epoch: 26, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.939 Vali Acc: 0.642 Test Loss: 1.939 Test Acc: 0.642
Validation loss decreased (-0.641619 --> -0.641619).  Saving model ...
Epoch: 27 cost time: 4.547652959823608
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.823 Vali Acc: 0.631 Test Loss: 2.823 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.3196165561676025
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.966 Vali Acc: 0.618 Test Loss: 2.966 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.476375341415405
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.382 Vali Acc: 0.631 Test Loss: 2.382 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.5096564292907715
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 2.553 Vali Acc: 0.631 Test Loss: 2.553 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.742909669876099
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 3.162 Vali Acc: 0.614 Test Loss: 3.162 Test Acc: 0.614
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.067322015762329
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 3.457 Vali Acc: 0.597 Test Loss: 3.457 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 5.093722581863403
Epoch: 33, Steps: 17 | Train Loss: 0.005 Vali Loss: 3.033 Vali Acc: 0.625 Test Loss: 3.033 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 5.108894348144531
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.990 Vali Acc: 0.625 Test Loss: 2.990 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.98345422744751
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.697 Vali Acc: 0.631 Test Loss: 2.697 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 5.108962535858154
Epoch: 36, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.791 Vali Acc: 0.625 Test Loss: 2.791 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 149602
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.80374813079834
Epoch: 1, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.691 Vali Acc: 0.532 Test Loss: 0.691 Test Acc: 0.532
Validation loss decreased (inf --> -0.532416).  Saving model ...
Epoch: 2 cost time: 4.3054914474487305
Epoch: 2, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.711 Vali Acc: 0.553 Test Loss: 0.711 Test Acc: 0.553
Validation loss decreased (-0.532416 --> -0.552894).  Saving model ...
Epoch: 3 cost time: 4.62220025062561
Epoch: 3, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.824 Vali Acc: 0.543 Test Loss: 0.824 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.876666307449341
Epoch: 4, Steps: 17 | Train Loss: 0.392 Vali Loss: 1.168 Vali Acc: 0.549 Test Loss: 1.168 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.7703611850738525
Epoch: 5, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.806 Vali Acc: 0.573 Test Loss: 0.806 Test Acc: 0.573
Validation loss decreased (-0.552894 --> -0.573371).  Saving model ...
Epoch: 6 cost time: 5.1957902908325195
Epoch: 6, Steps: 17 | Train Loss: 0.336 Vali Loss: 1.145 Vali Acc: 0.553 Test Loss: 1.145 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.813975095748901
Epoch: 7, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.944 Vali Acc: 0.577 Test Loss: 0.944 Test Acc: 0.577
Validation loss decreased (-0.573371 --> -0.576782).  Saving model ...
Epoch: 8 cost time: 4.855855226516724
Epoch: 8, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.425 Vali Acc: 0.577 Test Loss: 1.425 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.479621648788452
Epoch: 9, Steps: 17 | Train Loss: 0.181 Vali Loss: 1.543 Vali Acc: 0.573 Test Loss: 1.543 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.005850315093994
Epoch: 10, Steps: 17 | Train Loss: 0.196 Vali Loss: 1.306 Vali Acc: 0.584 Test Loss: 1.306 Test Acc: 0.584
Validation loss decreased (-0.576782 --> -0.583605).  Saving model ...
Epoch: 11 cost time: 4.395457744598389
Epoch: 11, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.263 Vali Acc: 0.584 Test Loss: 1.263 Test Acc: 0.584
Validation loss decreased (-0.583605 --> -0.583605).  Saving model ...
Epoch: 12 cost time: 4.851264476776123
Epoch: 12, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.352 Vali Acc: 0.597 Test Loss: 1.352 Test Acc: 0.597
Validation loss decreased (-0.583605 --> -0.597256).  Saving model ...
Epoch: 13 cost time: 4.848550319671631
Epoch: 13, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.508 Vali Acc: 0.594 Test Loss: 1.508 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.712739944458008
Epoch: 14, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.891 Vali Acc: 0.573 Test Loss: 1.891 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.222940921783447
Epoch: 15, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.785 Vali Acc: 0.587 Test Loss: 1.785 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.11106014251709
Epoch: 16, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.054 Vali Acc: 0.590 Test Loss: 2.054 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.448545932769775
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.949 Vali Acc: 0.584 Test Loss: 1.949 Test Acc: 0.584
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.051103830337524
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 2.046 Vali Acc: 0.584 Test Loss: 2.046 Test Acc: 0.584
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.1179986000061035
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 2.017 Vali Acc: 0.590 Test Loss: 2.017 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.173241853713989
Epoch: 20, Steps: 17 | Train Loss: 0.022 Vali Loss: 2.777 Vali Acc: 0.573 Test Loss: 2.777 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.241236686706543
Epoch: 21, Steps: 17 | Train Loss: 0.034 Vali Loss: 2.180 Vali Acc: 0.584 Test Loss: 2.180 Test Acc: 0.584
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.836976528167725
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 2.056 Vali Acc: 0.594 Test Loss: 2.056 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5972696245733788
model parameter : 149602
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.2445714473724365
Epoch: 1, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.677 Vali Acc: 0.546 Test Loss: 0.677 Test Acc: 0.546
Validation loss decreased (inf --> -0.546068).  Saving model ...
Epoch: 2 cost time: 5.317888975143433
Epoch: 2, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.727 Vali Acc: 0.580 Test Loss: 0.727 Test Acc: 0.580
Validation loss decreased (-0.546068 --> -0.580198).  Saving model ...
Epoch: 3 cost time: 4.728583574295044
Epoch: 3, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.835 Vali Acc: 0.580 Test Loss: 0.835 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.755163669586182
Epoch: 4, Steps: 17 | Train Loss: 0.391 Vali Loss: 1.140 Vali Acc: 0.543 Test Loss: 1.140 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.253891468048096
Epoch: 5, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.870 Vali Acc: 0.638 Test Loss: 0.870 Test Acc: 0.638
Validation loss decreased (-0.580198 --> -0.638217).  Saving model ...
Epoch: 6 cost time: 5.362607002258301
Epoch: 6, Steps: 17 | Train Loss: 0.333 Vali Loss: 1.315 Vali Acc: 0.549 Test Loss: 1.315 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.999392986297607
Epoch: 7, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.973 Vali Acc: 0.628 Test Loss: 0.973 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.475978136062622
Epoch: 8, Steps: 17 | Train Loss: 0.247 Vali Loss: 1.248 Vali Acc: 0.621 Test Loss: 1.248 Test Acc: 0.621
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.127911567687988
Epoch: 9, Steps: 17 | Train Loss: 0.179 Vali Loss: 1.324 Vali Acc: 0.614 Test Loss: 1.324 Test Acc: 0.614
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.831723690032959
Epoch: 10, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.633 Vali Acc: 0.597 Test Loss: 1.633 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.763706684112549
Epoch: 11, Steps: 17 | Train Loss: 0.157 Vali Loss: 1.343 Vali Acc: 0.638 Test Loss: 1.343 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.951302766799927
Epoch: 12, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.709 Vali Acc: 0.594 Test Loss: 1.709 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.458791971206665
Epoch: 13, Steps: 17 | Train Loss: 0.109 Vali Loss: 1.574 Vali Acc: 0.618 Test Loss: 1.574 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.891626358032227
Epoch: 14, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.990 Vali Acc: 0.597 Test Loss: 1.990 Test Acc: 0.597
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.256807804107666
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.734 Vali Acc: 0.621 Test Loss: 1.734 Test Acc: 0.621
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6382252559726962
model parameter : 149602
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.495535612106323
Epoch: 1, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.676 Vali Acc: 0.594 Test Loss: 0.676 Test Acc: 0.594
Validation loss decreased (inf --> -0.593850).  Saving model ...
Epoch: 2 cost time: 5.255979299545288
Epoch: 2, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.727 Vali Acc: 0.543 Test Loss: 0.727 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.150812864303589
Epoch: 3, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.902 Vali Acc: 0.529 Test Loss: 0.902 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.063838720321655
Epoch: 4, Steps: 17 | Train Loss: 0.449 Vali Loss: 1.161 Vali Acc: 0.519 Test Loss: 1.161 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.04220724105835
Epoch: 5, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.806 Vali Acc: 0.560 Test Loss: 0.806 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.810904502868652
Epoch: 6, Steps: 17 | Train Loss: 0.360 Vali Loss: 1.603 Vali Acc: 0.505 Test Loss: 1.603 Test Acc: 0.505
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.3469460010528564
Epoch: 7, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.942 Vali Acc: 0.563 Test Loss: 0.942 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.6760571002960205
Epoch: 8, Steps: 17 | Train Loss: 0.284 Vali Loss: 1.224 Vali Acc: 0.556 Test Loss: 1.224 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.5766236782073975
Epoch: 9, Steps: 17 | Train Loss: 0.239 Vali Loss: 1.091 Vali Acc: 0.584 Test Loss: 1.091 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.15958309173584
Epoch: 10, Steps: 17 | Train Loss: 0.197 Vali Loss: 1.257 Vali Acc: 0.560 Test Loss: 1.257 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.813618421554565
Epoch: 11, Steps: 17 | Train Loss: 0.199 Vali Loss: 1.308 Vali Acc: 0.563 Test Loss: 1.308 Test Acc: 0.563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5938566552901023
model parameter : 149602
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.284662246704102
Epoch: 1, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.706 Vali Acc: 0.498 Test Loss: 0.706 Test Acc: 0.498
Validation loss decreased (inf --> -0.498286).  Saving model ...
Epoch: 2 cost time: 5.439166307449341
Epoch: 2, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.810 Vali Acc: 0.498 Test Loss: 0.810 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.428657531738281
Epoch: 3, Steps: 17 | Train Loss: 0.498 Vali Loss: 1.037 Vali Acc: 0.498 Test Loss: 1.037 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.229388475418091
Epoch: 4, Steps: 17 | Train Loss: 0.473 Vali Loss: 1.186 Vali Acc: 0.505 Test Loss: 1.186 Test Acc: 0.505
Validation loss decreased (-0.498286 --> -0.505108).  Saving model ...
Epoch: 5 cost time: 4.832911252975464
Epoch: 5, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.927 Vali Acc: 0.539 Test Loss: 0.927 Test Acc: 0.539
Validation loss decreased (-0.505108 --> -0.539240).  Saving model ...
Epoch: 6 cost time: 4.624194145202637
Epoch: 6, Steps: 17 | Train Loss: 0.367 Vali Loss: 1.592 Vali Acc: 0.515 Test Loss: 1.592 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.60038948059082
Epoch: 7, Steps: 17 | Train Loss: 0.423 Vali Loss: 1.237 Vali Acc: 0.526 Test Loss: 1.237 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.80658483505249
Epoch: 8, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.977 Vali Acc: 0.577 Test Loss: 0.977 Test Acc: 0.577
Validation loss decreased (-0.539240 --> -0.576782).  Saving model ...
Epoch: 9 cost time: 5.207123279571533
Epoch: 9, Steps: 17 | Train Loss: 0.293 Vali Loss: 1.048 Vali Acc: 0.560 Test Loss: 1.048 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.294516563415527
Epoch: 10, Steps: 17 | Train Loss: 0.262 Vali Loss: 1.285 Vali Acc: 0.529 Test Loss: 1.285 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.153480529785156
Epoch: 11, Steps: 17 | Train Loss: 0.305 Vali Loss: 1.207 Vali Acc: 0.560 Test Loss: 1.207 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.437650918960571
Epoch: 12, Steps: 17 | Train Loss: 0.235 Vali Loss: 1.162 Vali Acc: 0.573 Test Loss: 1.162 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.077469110488892
Epoch: 13, Steps: 17 | Train Loss: 0.203 Vali Loss: 1.414 Vali Acc: 0.563 Test Loss: 1.414 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.2760655879974365
Epoch: 14, Steps: 17 | Train Loss: 0.205 Vali Loss: 1.462 Vali Acc: 0.560 Test Loss: 1.462 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.948371648788452
Epoch: 15, Steps: 17 | Train Loss: 0.155 Vali Loss: 1.566 Vali Acc: 0.570 Test Loss: 1.566 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.871383905410767
Epoch: 16, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.459 Vali Acc: 0.556 Test Loss: 1.459 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.784173965454102
Epoch: 17, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.684 Vali Acc: 0.553 Test Loss: 1.684 Test Acc: 0.553
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.09153938293457
Epoch: 18, Steps: 17 | Train Loss: 0.123 Vali Loss: 1.733 Vali Acc: 0.560 Test Loss: 1.733 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5767918088737202
model parameter : 149602
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.765554666519165
Epoch: 1, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.698 Vali Acc: 0.553 Test Loss: 0.698 Test Acc: 0.553
Validation loss decreased (inf --> -0.552894).  Saving model ...
Epoch: 2 cost time: 5.771755218505859
Epoch: 2, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.859 Vali Acc: 0.502 Test Loss: 0.859 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.429108619689941
Epoch: 3, Steps: 17 | Train Loss: 0.522 Vali Loss: 1.052 Vali Acc: 0.505 Test Loss: 1.052 Test Acc: 0.505
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.241334915161133
Epoch: 4, Steps: 17 | Train Loss: 0.504 Vali Loss: 1.146 Vali Acc: 0.502 Test Loss: 1.146 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.604201793670654
Epoch: 5, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.940 Vali Acc: 0.519 Test Loss: 0.940 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.522028923034668
Epoch: 6, Steps: 17 | Train Loss: 0.399 Vali Loss: 1.597 Vali Acc: 0.509 Test Loss: 1.597 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.512385129928589
Epoch: 7, Steps: 17 | Train Loss: 0.469 Vali Loss: 1.472 Vali Acc: 0.509 Test Loss: 1.472 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.175753831863403
Epoch: 8, Steps: 17 | Train Loss: 0.371 Vali Loss: 1.065 Vali Acc: 0.539 Test Loss: 1.065 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.942541837692261
Epoch: 9, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.903 Vali Acc: 0.560 Test Loss: 0.903 Test Acc: 0.560
Validation loss decreased (-0.552894 --> -0.559718).  Saving model ...
Epoch: 10 cost time: 5.133619070053101
Epoch: 10, Steps: 17 | Train Loss: 0.321 Vali Loss: 1.452 Vali Acc: 0.526 Test Loss: 1.452 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.467925071716309
Epoch: 11, Steps: 17 | Train Loss: 0.346 Vali Loss: 1.669 Vali Acc: 0.539 Test Loss: 1.669 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.629623174667358
Epoch: 12, Steps: 17 | Train Loss: 0.334 Vali Loss: 1.165 Vali Acc: 0.536 Test Loss: 1.165 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.560154438018799
Epoch: 13, Steps: 17 | Train Loss: 0.258 Vali Loss: 1.396 Vali Acc: 0.522 Test Loss: 1.396 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.572533130645752
Epoch: 14, Steps: 17 | Train Loss: 0.216 Vali Loss: 1.492 Vali Acc: 0.539 Test Loss: 1.492 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.187727451324463
Epoch: 15, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.720 Vali Acc: 0.522 Test Loss: 1.720 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.084575891494751
Epoch: 16, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.919 Vali Acc: 0.526 Test Loss: 1.919 Test Acc: 0.526
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.85869026184082
Epoch: 17, Steps: 17 | Train Loss: 0.177 Vali Loss: 1.682 Vali Acc: 0.529 Test Loss: 1.682 Test Acc: 0.529
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.0126731395721436
Epoch: 18, Steps: 17 | Train Loss: 0.164 Vali Loss: 2.291 Vali Acc: 0.491 Test Loss: 2.291 Test Acc: 0.491
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.812638521194458
Epoch: 19, Steps: 17 | Train Loss: 0.109 Vali Loss: 1.724 Vali Acc: 0.556 Test Loss: 1.724 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5597269624573379
model parameter : 149602
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.8562493324279785
Epoch: 1, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.717 Vali Acc: 0.502 Test Loss: 0.717 Test Acc: 0.502
Validation loss decreased (inf --> -0.501699).  Saving model ...
Epoch: 2 cost time: 4.647846698760986
Epoch: 2, Steps: 17 | Train Loss: 0.585 Vali Loss: 1.049 Vali Acc: 0.502 Test Loss: 1.049 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.21599555015564
Epoch: 3, Steps: 17 | Train Loss: 0.557 Vali Loss: 1.305 Vali Acc: 0.502 Test Loss: 1.305 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.048689126968384
Epoch: 4, Steps: 17 | Train Loss: 0.574 Vali Loss: 1.313 Vali Acc: 0.502 Test Loss: 1.313 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.210354566574097
Epoch: 5, Steps: 17 | Train Loss: 0.547 Vali Loss: 1.028 Vali Acc: 0.502 Test Loss: 1.028 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.200026988983154
Epoch: 6, Steps: 17 | Train Loss: 0.505 Vali Loss: 1.344 Vali Acc: 0.502 Test Loss: 1.344 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.499352693557739
Epoch: 7, Steps: 17 | Train Loss: 0.563 Vali Loss: 1.189 Vali Acc: 0.502 Test Loss: 1.189 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.987459897994995
Epoch: 8, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.750 Vali Acc: 0.502 Test Loss: 0.750 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.228689908981323
Epoch: 9, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.698 Vali Acc: 0.556 Test Loss: 0.698 Test Acc: 0.556
Validation loss decreased (-0.501699 --> -0.556307).  Saving model ...
Epoch: 10 cost time: 5.097590208053589
Epoch: 10, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.908 Vali Acc: 0.502 Test Loss: 0.908 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.156290769577026
Epoch: 11, Steps: 17 | Train Loss: 0.493 Vali Loss: 1.253 Vali Acc: 0.502 Test Loss: 1.253 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.235863447189331
Epoch: 12, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.843 Vali Acc: 0.512 Test Loss: 0.843 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.248274803161621
Epoch: 13, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.714 Vali Acc: 0.546 Test Loss: 0.714 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.232007741928101
Epoch: 14, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.895 Vali Acc: 0.512 Test Loss: 0.895 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.498089551925659
Epoch: 15, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.901 Vali Acc: 0.522 Test Loss: 0.901 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.502216100692749
Epoch: 16, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.692 Vali Acc: 0.573 Test Loss: 0.692 Test Acc: 0.573
Validation loss decreased (-0.556307 --> -0.573372).  Saving model ...
Epoch: 17 cost time: 5.279775857925415
Epoch: 17, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.775 Vali Acc: 0.529 Test Loss: 0.775 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.213712215423584
Epoch: 18, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.694 Vali Acc: 0.618 Test Loss: 0.694 Test Acc: 0.618
Validation loss decreased (-0.573372 --> -0.617741).  Saving model ...
Epoch: 19 cost time: 4.831828832626343
Epoch: 19, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.719 Vali Acc: 0.614 Test Loss: 0.719 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.603042125701904
Epoch: 20, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.767 Vali Acc: 0.601 Test Loss: 0.767 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.102851390838623
Epoch: 21, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.758 Vali Acc: 0.628 Test Loss: 0.758 Test Acc: 0.628
Validation loss decreased (-0.617741 --> -0.627979).  Saving model ...
Epoch: 22 cost time: 4.317590951919556
Epoch: 22, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.855 Vali Acc: 0.573 Test Loss: 0.855 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.703294038772583
Epoch: 23, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.916 Vali Acc: 0.573 Test Loss: 0.916 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.968731880187988
Epoch: 24, Steps: 17 | Train Loss: 0.351 Vali Loss: 1.172 Vali Acc: 0.560 Test Loss: 1.172 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.360660076141357
Epoch: 25, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.929 Vali Acc: 0.580 Test Loss: 0.929 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.271319150924683
Epoch: 26, Steps: 17 | Train Loss: 0.289 Vali Loss: 1.001 Vali Acc: 0.563 Test Loss: 1.001 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.514035224914551
Epoch: 27, Steps: 17 | Train Loss: 0.249 Vali Loss: 1.018 Vali Acc: 0.580 Test Loss: 1.018 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.411397457122803
Epoch: 28, Steps: 17 | Train Loss: 0.289 Vali Loss: 1.157 Vali Acc: 0.556 Test Loss: 1.157 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.408543586730957
Epoch: 29, Steps: 17 | Train Loss: 0.237 Vali Loss: 1.059 Vali Acc: 0.570 Test Loss: 1.059 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.054084062576294
Epoch: 30, Steps: 17 | Train Loss: 0.232 Vali Loss: 1.109 Vali Acc: 0.556 Test Loss: 1.109 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.796191692352295
Epoch: 31, Steps: 17 | Train Loss: 0.248 Vali Loss: 1.446 Vali Acc: 0.573 Test Loss: 1.446 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6279863481228669
model parameter : 149602
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.412250518798828
Epoch: 1, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.763 Vali Acc: 0.495 Test Loss: 0.763 Test Acc: 0.495
Validation loss decreased (inf --> -0.494873).  Saving model ...
Epoch: 2 cost time: 4.954515695571899
Epoch: 2, Steps: 17 | Train Loss: 0.592 Vali Loss: 1.174 Vali Acc: 0.502 Test Loss: 1.174 Test Acc: 0.502
Validation loss decreased (-0.494873 --> -0.501695).  Saving model ...
Epoch: 3 cost time: 5.55823540687561
Epoch: 3, Steps: 17 | Train Loss: 0.597 Vali Loss: 1.319 Vali Acc: 0.502 Test Loss: 1.319 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.306731462478638
Epoch: 4, Steps: 17 | Train Loss: 0.592 Vali Loss: 1.256 Vali Acc: 0.502 Test Loss: 1.256 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.1762001514434814
Epoch: 5, Steps: 17 | Train Loss: 0.566 Vali Loss: 1.355 Vali Acc: 0.502 Test Loss: 1.355 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.5095179080963135
Epoch: 6, Steps: 17 | Train Loss: 0.516 Vali Loss: 1.787 Vali Acc: 0.502 Test Loss: 1.787 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.586996793746948
Epoch: 7, Steps: 17 | Train Loss: 0.555 Vali Loss: 1.766 Vali Acc: 0.502 Test Loss: 1.766 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.121966123580933
Epoch: 8, Steps: 17 | Train Loss: 0.542 Vali Loss: 1.429 Vali Acc: 0.502 Test Loss: 1.429 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.929454803466797
Epoch: 9, Steps: 17 | Train Loss: 0.506 Vali Loss: 1.017 Vali Acc: 0.498 Test Loss: 1.017 Test Acc: 0.498
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.678172826766968
Epoch: 10, Steps: 17 | Train Loss: 0.508 Vali Loss: 1.145 Vali Acc: 0.502 Test Loss: 1.145 Test Acc: 0.502
Validation loss decreased (-0.501695 --> -0.501695).  Saving model ...
Epoch: 11 cost time: 5.404036521911621
Epoch: 11, Steps: 17 | Train Loss: 0.521 Vali Loss: 1.843 Vali Acc: 0.502 Test Loss: 1.843 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.99352502822876
Epoch: 12, Steps: 17 | Train Loss: 0.542 Vali Loss: 1.772 Vali Acc: 0.502 Test Loss: 1.772 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.709927558898926
Epoch: 13, Steps: 17 | Train Loss: 0.480 Vali Loss: 1.000 Vali Acc: 0.498 Test Loss: 1.000 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.044992685317993
Epoch: 14, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.792 Vali Acc: 0.539 Test Loss: 0.792 Test Acc: 0.539
Validation loss decreased (-0.501695 --> -0.539241).  Saving model ...
Epoch: 15 cost time: 5.116852521896362
Epoch: 15, Steps: 17 | Train Loss: 0.533 Vali Loss: 1.218 Vali Acc: 0.512 Test Loss: 1.218 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.386697769165039
Epoch: 16, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.890 Vali Acc: 0.532 Test Loss: 0.890 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.225189447402954
Epoch: 17, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.884 Vali Acc: 0.543 Test Loss: 0.884 Test Acc: 0.543
Validation loss decreased (-0.539241 --> -0.542653).  Saving model ...
Epoch: 18 cost time: 5.510107040405273
Epoch: 18, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.914 Vali Acc: 0.546 Test Loss: 0.914 Test Acc: 0.546
Validation loss decreased (-0.542653 --> -0.546066).  Saving model ...
Epoch: 19 cost time: 4.501719236373901
Epoch: 19, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.747 Vali Acc: 0.584 Test Loss: 0.747 Test Acc: 0.584
Validation loss decreased (-0.546066 --> -0.583610).  Saving model ...
Epoch: 20 cost time: 4.813754558563232
Epoch: 20, Steps: 17 | Train Loss: 0.438 Vali Loss: 1.190 Vali Acc: 0.529 Test Loss: 1.190 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.599513053894043
Epoch: 21, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.952 Vali Acc: 0.567 Test Loss: 0.952 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.39679741859436
Epoch: 22, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.768 Vali Acc: 0.580 Test Loss: 0.768 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.69984769821167
Epoch: 23, Steps: 17 | Train Loss: 0.457 Vali Loss: 1.008 Vali Acc: 0.563 Test Loss: 1.008 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.503423452377319
Epoch: 24, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.980 Vali Acc: 0.577 Test Loss: 0.980 Test Acc: 0.577
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.156144618988037
Epoch: 25, Steps: 17 | Train Loss: 0.421 Vali Loss: 1.633 Vali Acc: 0.549 Test Loss: 1.633 Test Acc: 0.549
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.130372524261475
Epoch: 26, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.976 Vali Acc: 0.580 Test Loss: 0.976 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.202511310577393
Epoch: 27, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.930 Vali Acc: 0.594 Test Loss: 0.930 Test Acc: 0.594
Validation loss decreased (-0.583610 --> -0.593847).  Saving model ...
Epoch: 28 cost time: 5.579591989517212
Epoch: 28, Steps: 17 | Train Loss: 0.382 Vali Loss: 1.050 Vali Acc: 0.604 Test Loss: 1.050 Test Acc: 0.604
Validation loss decreased (-0.593847 --> -0.604085).  Saving model ...
Epoch: 29 cost time: 5.537106990814209
Epoch: 29, Steps: 17 | Train Loss: 0.348 Vali Loss: 1.127 Vali Acc: 0.560 Test Loss: 1.127 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.211352825164795
Epoch: 30, Steps: 17 | Train Loss: 0.433 Vali Loss: 1.232 Vali Acc: 0.580 Test Loss: 1.232 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.820211172103882
Epoch: 31, Steps: 17 | Train Loss: 0.316 Vali Loss: 1.260 Vali Acc: 0.594 Test Loss: 1.260 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.9773595333099365
Epoch: 32, Steps: 17 | Train Loss: 0.347 Vali Loss: 1.412 Vali Acc: 0.587 Test Loss: 1.412 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 5.375594139099121
Epoch: 33, Steps: 17 | Train Loss: 0.331 Vali Loss: 1.639 Vali Acc: 0.570 Test Loss: 1.639 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.569711923599243
Epoch: 34, Steps: 17 | Train Loss: 0.432 Vali Loss: 1.669 Vali Acc: 0.567 Test Loss: 1.669 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.796474456787109
Epoch: 35, Steps: 17 | Train Loss: 0.342 Vali Loss: 1.729 Vali Acc: 0.577 Test Loss: 1.729 Test Acc: 0.577
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.730835437774658
Epoch: 36, Steps: 17 | Train Loss: 0.401 Vali Loss: 1.796 Vali Acc: 0.584 Test Loss: 1.796 Test Acc: 0.584
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.963091611862183
Epoch: 37, Steps: 17 | Train Loss: 0.409 Vali Loss: 1.752 Vali Acc: 0.590 Test Loss: 1.752 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 4.9994957447052
Epoch: 38, Steps: 17 | Train Loss: 0.379 Vali Loss: 1.816 Vali Acc: 0.573 Test Loss: 1.816 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6040955631399317
model parameter : 149602
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         448                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma448_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.674957513809204
Epoch: 1, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.691 Vali Acc: 0.553 Test Loss: 0.691 Test Acc: 0.553
Validation loss decreased (inf --> -0.552894).  Saving model ...
Epoch: 2 cost time: 4.705668926239014
Epoch: 2, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.864 Vali Acc: 0.543 Test Loss: 0.864 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.532303810119629
Epoch: 3, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.969 Vali Acc: 0.570 Test Loss: 0.969 Test Acc: 0.570
Validation loss decreased (-0.552894 --> -0.569956).  Saving model ...
Epoch: 4 cost time: 5.09847092628479
Epoch: 4, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.937 Vali Acc: 0.625 Test Loss: 0.937 Test Acc: 0.625
Validation loss decreased (-0.569956 --> -0.624564).  Saving model ...
Epoch: 5 cost time: 4.804011583328247
Epoch: 5, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.776 Vali Acc: 0.672 Test Loss: 0.776 Test Acc: 0.672
Validation loss decreased (-0.624564 --> -0.672347).  Saving model ...
Epoch: 6 cost time: 4.762548446655273
Epoch: 6, Steps: 17 | Train Loss: 0.262 Vali Loss: 1.534 Vali Acc: 0.556 Test Loss: 1.534 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.963360786437988
Epoch: 7, Steps: 17 | Train Loss: 0.229 Vali Loss: 1.055 Vali Acc: 0.669 Test Loss: 1.055 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.806728839874268
Epoch: 8, Steps: 17 | Train Loss: 0.202 Vali Loss: 1.253 Vali Acc: 0.628 Test Loss: 1.253 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.783461570739746
Epoch: 9, Steps: 17 | Train Loss: 0.157 Vali Loss: 1.458 Vali Acc: 0.618 Test Loss: 1.458 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.586648464202881
Epoch: 10, Steps: 17 | Train Loss: 0.143 Vali Loss: 1.445 Vali Acc: 0.608 Test Loss: 1.445 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.632522106170654
Epoch: 11, Steps: 17 | Train Loss: 0.138 Vali Loss: 1.062 Vali Acc: 0.686 Test Loss: 1.062 Test Acc: 0.686
Validation loss decreased (-0.672347 --> -0.685996).  Saving model ...
Epoch: 12 cost time: 5.350893020629883
Epoch: 12, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.185 Vali Acc: 0.669 Test Loss: 1.185 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.997115135192871
Epoch: 13, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.428 Vali Acc: 0.642 Test Loss: 1.428 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.3764472007751465
Epoch: 14, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.402 Vali Acc: 0.669 Test Loss: 1.402 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.106653451919556
Epoch: 15, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.423 Vali Acc: 0.662 Test Loss: 1.423 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.886089086532593
Epoch: 16, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.204 Vali Acc: 0.652 Test Loss: 1.204 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.892967224121094
Epoch: 17, Steps: 17 | Train Loss: 0.056 Vali Loss: 2.118 Vali Acc: 0.621 Test Loss: 2.118 Test Acc: 0.621
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.091454982757568
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.636 Vali Acc: 0.672 Test Loss: 1.636 Test Acc: 0.672
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.897039413452148
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.800 Vali Acc: 0.652 Test Loss: 1.800 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.184811592102051
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.763 Vali Acc: 0.655 Test Loss: 1.763 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.727892637252808
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.972 Vali Acc: 0.652 Test Loss: 1.972 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma448_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6860068259385665
model parameter : 125026
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         359                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma359_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.094879388809204
Epoch: 1, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.690 Vali Acc: 0.549 Test Loss: 0.690 Test Acc: 0.549
Validation loss decreased (inf --> -0.549481).  Saving model ...
Epoch: 2 cost time: 4.963797092437744
Epoch: 2, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.816 Vali Acc: 0.567 Test Loss: 0.816 Test Acc: 0.567
Validation loss decreased (-0.549481 --> -0.566545).  Saving model ...
Epoch: 3 cost time: 5.266514301300049
Epoch: 3, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.875 Vali Acc: 0.584 Test Loss: 0.875 Test Acc: 0.584
Validation loss decreased (-0.566545 --> -0.583609).  Saving model ...
Epoch: 4 cost time: 5.178452253341675
Epoch: 4, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.976 Vali Acc: 0.590 Test Loss: 0.976 Test Acc: 0.590
Validation loss decreased (-0.583609 --> -0.590434).  Saving model ...
Epoch: 5 cost time: 4.713764905929565
Epoch: 5, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.788 Vali Acc: 0.625 Test Loss: 0.788 Test Acc: 0.625
Validation loss decreased (-0.590434 --> -0.624565).  Saving model ...
Epoch: 6 cost time: 4.829951047897339
Epoch: 6, Steps: 17 | Train Loss: 0.289 Vali Loss: 1.436 Vali Acc: 0.563 Test Loss: 1.436 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.5476367473602295
Epoch: 7, Steps: 17 | Train Loss: 0.244 Vali Loss: 1.081 Vali Acc: 0.611 Test Loss: 1.081 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.186840295791626
Epoch: 8, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.997 Vali Acc: 0.635 Test Loss: 0.997 Test Acc: 0.635
Validation loss decreased (-0.624565 --> -0.634802).  Saving model ...
Epoch: 9 cost time: 5.138312101364136
Epoch: 9, Steps: 17 | Train Loss: 0.182 Vali Loss: 1.728 Vali Acc: 0.577 Test Loss: 1.728 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.853417158126831
Epoch: 10, Steps: 17 | Train Loss: 0.151 Vali Loss: 1.242 Vali Acc: 0.618 Test Loss: 1.242 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.849618673324585
Epoch: 11, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.365 Vali Acc: 0.631 Test Loss: 1.365 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.451567888259888
Epoch: 12, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.091 Vali Acc: 0.642 Test Loss: 1.091 Test Acc: 0.642
Validation loss decreased (-0.634802 --> -0.641627).  Saving model ...
Epoch: 13 cost time: 5.650869131088257
Epoch: 13, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.472 Vali Acc: 0.638 Test Loss: 1.472 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.431193113327026
Epoch: 14, Steps: 17 | Train Loss: 0.112 Vali Loss: 1.544 Vali Acc: 0.635 Test Loss: 1.544 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.260067462921143
Epoch: 15, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.595 Vali Acc: 0.638 Test Loss: 1.595 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.201649188995361
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.242 Vali Acc: 0.608 Test Loss: 1.242 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.807414531707764
Epoch: 17, Steps: 17 | Train Loss: 0.077 Vali Loss: 2.241 Vali Acc: 0.611 Test Loss: 2.241 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.220510959625244
Epoch: 18, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.369 Vali Acc: 0.642 Test Loss: 1.369 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.403810262680054
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.957 Vali Acc: 0.642 Test Loss: 1.957 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.678626298904419
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.727 Vali Acc: 0.642 Test Loss: 1.727 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.652028322219849
Epoch: 21, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.075 Vali Acc: 0.648 Test Loss: 2.075 Test Acc: 0.648
Validation loss decreased (-0.641627 --> -0.648443).  Saving model ...
Epoch: 22 cost time: 5.404305696487427
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.737 Vali Acc: 0.662 Test Loss: 1.737 Test Acc: 0.662
Validation loss decreased (-0.648443 --> -0.662099).  Saving model ...
Epoch: 23 cost time: 5.405981540679932
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.842 Vali Acc: 0.659 Test Loss: 1.842 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.5892229080200195
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.097 Vali Acc: 0.652 Test Loss: 2.097 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.991100311279297
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.205 Vali Acc: 0.635 Test Loss: 2.205 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.737032413482666
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.226 Vali Acc: 0.635 Test Loss: 2.226 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.597155332565308
Epoch: 27, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.436 Vali Acc: 0.645 Test Loss: 2.436 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.9074015617370605
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.984 Vali Acc: 0.648 Test Loss: 1.984 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.653986692428589
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.976 Vali Acc: 0.652 Test Loss: 1.976 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.980666399002075
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 2.258 Vali Acc: 0.645 Test Loss: 2.258 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.313237428665161
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.318 Vali Acc: 0.655 Test Loss: 2.318 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.913178443908691
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.944 Vali Acc: 0.635 Test Loss: 1.944 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma359_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6621160409556314
model parameter : 125026
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         269                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma269_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.45216703414917
Epoch: 1, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.698 Vali Acc: 0.549 Test Loss: 0.698 Test Acc: 0.549
Validation loss decreased (inf --> -0.549481).  Saving model ...
Epoch: 2 cost time: 5.15907883644104
Epoch: 2, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.835 Vali Acc: 0.563 Test Loss: 0.835 Test Acc: 0.563
Validation loss decreased (-0.549481 --> -0.563132).  Saving model ...
Epoch: 3 cost time: 5.373867988586426
Epoch: 3, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.974 Vali Acc: 0.560 Test Loss: 0.974 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.081351280212402
Epoch: 4, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.976 Vali Acc: 0.573 Test Loss: 0.976 Test Acc: 0.573
Validation loss decreased (-0.563132 --> -0.573369).  Saving model ...
Epoch: 5 cost time: 5.063702344894409
Epoch: 5, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.868 Vali Acc: 0.604 Test Loss: 0.868 Test Acc: 0.604
Validation loss decreased (-0.573369 --> -0.604087).  Saving model ...
Epoch: 6 cost time: 5.12901496887207
Epoch: 6, Steps: 17 | Train Loss: 0.286 Vali Loss: 1.405 Vali Acc: 0.553 Test Loss: 1.405 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.897474765777588
Epoch: 7, Steps: 17 | Train Loss: 0.259 Vali Loss: 1.311 Vali Acc: 0.567 Test Loss: 1.311 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.9127516746521
Epoch: 8, Steps: 17 | Train Loss: 0.231 Vali Loss: 1.446 Vali Acc: 0.577 Test Loss: 1.446 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.321731328964233
Epoch: 9, Steps: 17 | Train Loss: 0.186 Vali Loss: 1.574 Vali Acc: 0.590 Test Loss: 1.574 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.919484853744507
Epoch: 10, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.582 Vali Acc: 0.570 Test Loss: 1.582 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.7468695640563965
Epoch: 11, Steps: 17 | Train Loss: 0.152 Vali Loss: 1.246 Vali Acc: 0.618 Test Loss: 1.246 Test Acc: 0.618
Validation loss decreased (-0.604087 --> -0.617735).  Saving model ...
Epoch: 12 cost time: 5.426125764846802
Epoch: 12, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.496 Vali Acc: 0.597 Test Loss: 1.496 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.646795272827148
Epoch: 13, Steps: 17 | Train Loss: 0.128 Vali Loss: 1.357 Vali Acc: 0.625 Test Loss: 1.357 Test Acc: 0.625
Validation loss decreased (-0.617735 --> -0.624560).  Saving model ...
Epoch: 14 cost time: 5.311588525772095
Epoch: 14, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.699 Vali Acc: 0.594 Test Loss: 1.699 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.721935749053955
Epoch: 15, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.843 Vali Acc: 0.580 Test Loss: 1.843 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.7509214878082275
Epoch: 16, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.288 Vali Acc: 0.652 Test Loss: 1.288 Test Acc: 0.652
Validation loss decreased (-0.624560 --> -0.651864).  Saving model ...
Epoch: 17 cost time: 4.92504096031189
Epoch: 17, Steps: 17 | Train Loss: 0.070 Vali Loss: 2.201 Vali Acc: 0.587 Test Loss: 2.201 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.4392170906066895
Epoch: 18, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.399 Vali Acc: 0.638 Test Loss: 1.399 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.2460408210754395
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.054 Vali Acc: 0.601 Test Loss: 2.054 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.186523914337158
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 2.154 Vali Acc: 0.631 Test Loss: 2.154 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.316871166229248
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 2.387 Vali Acc: 0.611 Test Loss: 2.387 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.478472471237183
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.075 Vali Acc: 0.604 Test Loss: 2.075 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.206920862197876
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.971 Vali Acc: 0.621 Test Loss: 1.971 Test Acc: 0.621
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.203421115875244
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.927 Vali Acc: 0.618 Test Loss: 1.927 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.022438049316406
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 2.074 Vali Acc: 0.628 Test Loss: 2.074 Test Acc: 0.628
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.6008994579315186
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.210 Vali Acc: 0.625 Test Loss: 2.210 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma269_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6518771331058021
model parameter : 125026
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.449249982833862
Epoch: 1, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.697 Vali Acc: 0.543 Test Loss: 0.697 Test Acc: 0.543
Validation loss decreased (inf --> -0.542655).  Saving model ...
Epoch: 2 cost time: 4.595043182373047
Epoch: 2, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.826 Vali Acc: 0.563 Test Loss: 0.826 Test Acc: 0.563
Validation loss decreased (-0.542655 --> -0.563132).  Saving model ...
Epoch: 3 cost time: 4.749176979064941
Epoch: 3, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.914 Vali Acc: 0.577 Test Loss: 0.914 Test Acc: 0.577
Validation loss decreased (-0.563132 --> -0.576783).  Saving model ...
Epoch: 4 cost time: 5.068333387374878
Epoch: 4, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.809 Vali Acc: 0.584 Test Loss: 0.809 Test Acc: 0.584
Validation loss decreased (-0.576783 --> -0.583610).  Saving model ...
Epoch: 5 cost time: 4.751354694366455
Epoch: 5, Steps: 17 | Train Loss: 0.328 Vali Loss: 1.004 Vali Acc: 0.587 Test Loss: 1.004 Test Acc: 0.587
Validation loss decreased (-0.583610 --> -0.587021).  Saving model ...
Epoch: 6 cost time: 5.483476161956787
Epoch: 6, Steps: 17 | Train Loss: 0.305 Vali Loss: 1.088 Vali Acc: 0.556 Test Loss: 1.088 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.494297027587891
Epoch: 7, Steps: 17 | Train Loss: 0.257 Vali Loss: 1.477 Vali Acc: 0.553 Test Loss: 1.477 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.545970916748047
Epoch: 8, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.014 Vali Acc: 0.580 Test Loss: 1.014 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.016764163970947
Epoch: 9, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.662 Vali Acc: 0.563 Test Loss: 1.662 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.556171894073486
Epoch: 10, Steps: 17 | Train Loss: 0.146 Vali Loss: 1.370 Vali Acc: 0.590 Test Loss: 1.370 Test Acc: 0.590
Validation loss decreased (-0.587021 --> -0.590430).  Saving model ...
Epoch: 11 cost time: 4.924797296524048
Epoch: 11, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.344 Vali Acc: 0.590 Test Loss: 1.344 Test Acc: 0.590
Validation loss decreased (-0.590430 --> -0.590430).  Saving model ...
Epoch: 12 cost time: 5.172431945800781
Epoch: 12, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.479 Vali Acc: 0.577 Test Loss: 1.479 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.059398651123047
Epoch: 13, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.710 Vali Acc: 0.563 Test Loss: 1.710 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.274102687835693
Epoch: 14, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.912 Vali Acc: 0.584 Test Loss: 1.912 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.49129581451416
Epoch: 15, Steps: 17 | Train Loss: 0.065 Vali Loss: 2.019 Vali Acc: 0.577 Test Loss: 2.019 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.591094493865967
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.565 Vali Acc: 0.546 Test Loss: 1.565 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.447258472442627
Epoch: 17, Steps: 17 | Train Loss: 0.077 Vali Loss: 2.199 Vali Acc: 0.597 Test Loss: 2.199 Test Acc: 0.597
Validation loss decreased (-0.590430 --> -0.597248).  Saving model ...
Epoch: 18 cost time: 5.7940146923065186
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.992 Vali Acc: 0.604 Test Loss: 1.992 Test Acc: 0.604
Validation loss decreased (-0.597248 --> -0.604076).  Saving model ...
Epoch: 19 cost time: 5.324848890304565
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.966 Vali Acc: 0.587 Test Loss: 1.966 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.609464168548584
Epoch: 20, Steps: 17 | Train Loss: 0.029 Vali Loss: 2.343 Vali Acc: 0.584 Test Loss: 2.343 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.57004189491272
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.527 Vali Acc: 0.587 Test Loss: 2.527 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.3962721824646
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 2.058 Vali Acc: 0.604 Test Loss: 2.058 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.612728595733643
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 2.534 Vali Acc: 0.580 Test Loss: 2.534 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.841925621032715
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.700 Vali Acc: 0.577 Test Loss: 2.700 Test Acc: 0.577
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.334605693817139
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.672 Vali Acc: 0.580 Test Loss: 2.672 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.247557878494263
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.239 Vali Acc: 0.601 Test Loss: 2.239 Test Acc: 0.601
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.901683807373047
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 3.162 Vali Acc: 0.567 Test Loss: 3.162 Test Acc: 0.567
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.812854528427124
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.325 Vali Acc: 0.573 Test Loss: 2.325 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6040955631399317
model parameter : 125026
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.617551326751709
Epoch: 1, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.712 Vali Acc: 0.539 Test Loss: 0.712 Test Acc: 0.539
Validation loss decreased (inf --> -0.539242).  Saving model ...
Epoch: 2 cost time: 4.656163692474365
Epoch: 2, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.862 Vali Acc: 0.549 Test Loss: 0.862 Test Acc: 0.549
Validation loss decreased (-0.539242 --> -0.549479).  Saving model ...
Epoch: 3 cost time: 4.935726165771484
Epoch: 3, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.932 Vali Acc: 0.563 Test Loss: 0.932 Test Acc: 0.563
Validation loss decreased (-0.549479 --> -0.563131).  Saving model ...
Epoch: 4 cost time: 5.068747043609619
Epoch: 4, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.793 Vali Acc: 0.625 Test Loss: 0.793 Test Acc: 0.625
Validation loss decreased (-0.563131 --> -0.624565).  Saving model ...
Epoch: 5 cost time: 4.686713218688965
Epoch: 5, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.991 Vali Acc: 0.614 Test Loss: 0.991 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.918283462524414
Epoch: 6, Steps: 17 | Train Loss: 0.311 Vali Loss: 1.322 Vali Acc: 0.553 Test Loss: 1.322 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.417872190475464
Epoch: 7, Steps: 17 | Train Loss: 0.283 Vali Loss: 1.444 Vali Acc: 0.549 Test Loss: 1.444 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.596027135848999
Epoch: 8, Steps: 17 | Train Loss: 0.245 Vali Loss: 1.066 Vali Acc: 0.621 Test Loss: 1.066 Test Acc: 0.621
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.609068393707275
Epoch: 9, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.708 Vali Acc: 0.549 Test Loss: 1.708 Test Acc: 0.549
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.859176397323608
Epoch: 10, Steps: 17 | Train Loss: 0.171 Vali Loss: 1.399 Vali Acc: 0.608 Test Loss: 1.399 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.625370264053345
Epoch: 11, Steps: 17 | Train Loss: 0.169 Vali Loss: 1.832 Vali Acc: 0.563 Test Loss: 1.832 Test Acc: 0.563
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.681664228439331
Epoch: 12, Steps: 17 | Train Loss: 0.137 Vali Loss: 1.265 Vali Acc: 0.635 Test Loss: 1.265 Test Acc: 0.635
Validation loss decreased (-0.624565 --> -0.634800).  Saving model ...
Epoch: 13 cost time: 5.197335481643677
Epoch: 13, Steps: 17 | Train Loss: 0.129 Vali Loss: 1.852 Vali Acc: 0.597 Test Loss: 1.852 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.909425497055054
Epoch: 14, Steps: 17 | Train Loss: 0.088 Vali Loss: 2.271 Vali Acc: 0.563 Test Loss: 2.271 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.740005254745483
Epoch: 15, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.618 Vali Acc: 0.601 Test Loss: 1.618 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.83956503868103
Epoch: 16, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.925 Vali Acc: 0.608 Test Loss: 1.925 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.382540702819824
Epoch: 17, Steps: 17 | Train Loss: 0.079 Vali Loss: 2.236 Vali Acc: 0.604 Test Loss: 2.236 Test Acc: 0.604
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.443631887435913
Epoch: 18, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.643 Vali Acc: 0.631 Test Loss: 1.643 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.3056206703186035
Epoch: 19, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.934 Vali Acc: 0.628 Test Loss: 1.934 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.3958117961883545
Epoch: 20, Steps: 17 | Train Loss: 0.032 Vali Loss: 2.271 Vali Acc: 0.608 Test Loss: 2.271 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.199955940246582
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 2.777 Vali Acc: 0.587 Test Loss: 2.777 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.039565563201904
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.989 Vali Acc: 0.642 Test Loss: 1.989 Test Acc: 0.642
Validation loss decreased (-0.634800 --> -0.641618).  Saving model ...
Epoch: 23 cost time: 4.84671425819397
Epoch: 23, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.934 Vali Acc: 0.642 Test Loss: 1.934 Test Acc: 0.642
Validation loss decreased (-0.641618 --> -0.641619).  Saving model ...
Epoch: 24 cost time: 4.541248559951782
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.982 Vali Acc: 0.590 Test Loss: 2.982 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.844912767410278
Epoch: 25, Steps: 17 | Train Loss: 0.026 Vali Loss: 3.193 Vali Acc: 0.587 Test Loss: 3.193 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.796034097671509
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.657 Vali Acc: 0.625 Test Loss: 2.657 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.90177059173584
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 3.157 Vali Acc: 0.608 Test Loss: 3.157 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.397816181182861
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.541 Vali Acc: 0.621 Test Loss: 2.541 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.552900552749634
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.819 Vali Acc: 0.608 Test Loss: 2.819 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.432466268539429
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 3.004 Vali Acc: 0.597 Test Loss: 3.004 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.709536790847778
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.990 Vali Acc: 0.604 Test Loss: 2.990 Test Acc: 0.604
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.387085437774658
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.349 Vali Acc: 0.631 Test Loss: 2.349 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.452428340911865
Epoch: 33, Steps: 17 | Train Loss: 0.019 Vali Loss: 3.341 Vali Acc: 0.584 Test Loss: 3.341 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6416382252559727
model parameter : 125026
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.066401481628418
Epoch: 1, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.695 Vali Acc: 0.553 Test Loss: 0.695 Test Acc: 0.553
Validation loss decreased (inf --> -0.552894).  Saving model ...
Epoch: 2 cost time: 4.942143201828003
Epoch: 2, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.879 Vali Acc: 0.498 Test Loss: 0.879 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.479891777038574
Epoch: 3, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.992 Vali Acc: 0.502 Test Loss: 0.992 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.383200407028198
Epoch: 4, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.910 Vali Acc: 0.536 Test Loss: 0.910 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.713719129562378
Epoch: 5, Steps: 17 | Train Loss: 0.402 Vali Loss: 1.028 Vali Acc: 0.536 Test Loss: 1.028 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.440302610397339
Epoch: 6, Steps: 17 | Train Loss: 0.359 Vali Loss: 1.354 Vali Acc: 0.532 Test Loss: 1.354 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.440161466598511
Epoch: 7, Steps: 17 | Train Loss: 0.334 Vali Loss: 1.366 Vali Acc: 0.536 Test Loss: 1.366 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.294157028198242
Epoch: 8, Steps: 17 | Train Loss: 0.281 Vali Loss: 1.141 Vali Acc: 0.543 Test Loss: 1.141 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.939948081970215
Epoch: 9, Steps: 17 | Train Loss: 0.253 Vali Loss: 1.718 Vali Acc: 0.522 Test Loss: 1.718 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.252928256988525
Epoch: 10, Steps: 17 | Train Loss: 0.234 Vali Loss: 1.366 Vali Acc: 0.549 Test Loss: 1.366 Test Acc: 0.549
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.869966268539429
Epoch: 11, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.692 Vali Acc: 0.529 Test Loss: 1.692 Test Acc: 0.529
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.552901023890785
model parameter : 125026
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         27                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.9945104122161865
Epoch: 1, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.699 Vali Acc: 0.519 Test Loss: 0.699 Test Acc: 0.519
Validation loss decreased (inf --> -0.518764).  Saving model ...
Epoch: 2 cost time: 5.212873935699463
Epoch: 2, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.987 Vali Acc: 0.495 Test Loss: 0.987 Test Acc: 0.495
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.1859354972839355
Epoch: 3, Steps: 17 | Train Loss: 0.523 Vali Loss: 1.199 Vali Acc: 0.502 Test Loss: 1.199 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.948789596557617
Epoch: 4, Steps: 17 | Train Loss: 0.463 Vali Loss: 1.086 Vali Acc: 0.512 Test Loss: 1.086 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.021804571151733
Epoch: 5, Steps: 17 | Train Loss: 0.438 Vali Loss: 1.003 Vali Acc: 0.543 Test Loss: 1.003 Test Acc: 0.543
Validation loss decreased (-0.518764 --> -0.542652).  Saving model ...
Epoch: 6 cost time: 4.562530040740967
Epoch: 6, Steps: 17 | Train Loss: 0.385 Vali Loss: 1.173 Vali Acc: 0.532 Test Loss: 1.173 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.900947570800781
Epoch: 7, Steps: 17 | Train Loss: 0.380 Vali Loss: 1.503 Vali Acc: 0.536 Test Loss: 1.503 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.478990316390991
Epoch: 8, Steps: 17 | Train Loss: 0.332 Vali Loss: 1.079 Vali Acc: 0.549 Test Loss: 1.079 Test Acc: 0.549
Validation loss decreased (-0.542652 --> -0.549477).  Saving model ...
Epoch: 9 cost time: 5.007721900939941
Epoch: 9, Steps: 17 | Train Loss: 0.296 Vali Loss: 1.457 Vali Acc: 0.536 Test Loss: 1.457 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.8861083984375
Epoch: 10, Steps: 17 | Train Loss: 0.261 Vali Loss: 1.141 Vali Acc: 0.567 Test Loss: 1.141 Test Acc: 0.567
Validation loss decreased (-0.549477 --> -0.566541).  Saving model ...
Epoch: 11 cost time: 4.956371784210205
Epoch: 11, Steps: 17 | Train Loss: 0.254 Vali Loss: 1.641 Vali Acc: 0.539 Test Loss: 1.641 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.1702492237091064
Epoch: 12, Steps: 17 | Train Loss: 0.284 Vali Loss: 1.592 Vali Acc: 0.526 Test Loss: 1.592 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.181381940841675
Epoch: 13, Steps: 17 | Train Loss: 0.223 Vali Loss: 1.230 Vali Acc: 0.556 Test Loss: 1.230 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.637704372406006
Epoch: 14, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.274 Vali Acc: 0.580 Test Loss: 1.274 Test Acc: 0.580
Validation loss decreased (-0.566541 --> -0.580192).  Saving model ...
Epoch: 15 cost time: 4.924994230270386
Epoch: 15, Steps: 17 | Train Loss: 0.191 Vali Loss: 1.509 Vali Acc: 0.549 Test Loss: 1.509 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.3600709438323975
Epoch: 16, Steps: 17 | Train Loss: 0.145 Vali Loss: 1.385 Vali Acc: 0.560 Test Loss: 1.385 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.065877914428711
Epoch: 17, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.530 Vali Acc: 0.563 Test Loss: 1.530 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.477143049240112
Epoch: 18, Steps: 17 | Train Loss: 0.123 Vali Loss: 1.504 Vali Acc: 0.567 Test Loss: 1.504 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.838284492492676
Epoch: 19, Steps: 17 | Train Loss: 0.151 Vali Loss: 1.488 Vali Acc: 0.590 Test Loss: 1.488 Test Acc: 0.590
Validation loss decreased (-0.580192 --> -0.590429).  Saving model ...
Epoch: 20 cost time: 4.608300685882568
Epoch: 20, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.918 Vali Acc: 0.570 Test Loss: 1.918 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.581097602844238
Epoch: 21, Steps: 17 | Train Loss: 0.093 Vali Loss: 2.042 Vali Acc: 0.549 Test Loss: 2.042 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.007214784622192
Epoch: 22, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.787 Vali Acc: 0.590 Test Loss: 1.787 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.20001220703125
Epoch: 23, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.977 Vali Acc: 0.567 Test Loss: 1.977 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.407628536224365
Epoch: 24, Steps: 17 | Train Loss: 0.059 Vali Loss: 2.161 Vali Acc: 0.567 Test Loss: 2.161 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.620651721954346
Epoch: 25, Steps: 17 | Train Loss: 0.065 Vali Loss: 2.384 Vali Acc: 0.536 Test Loss: 2.384 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.348288297653198
Epoch: 26, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.117 Vali Acc: 0.567 Test Loss: 2.117 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.372255563735962
Epoch: 27, Steps: 17 | Train Loss: 0.043 Vali Loss: 2.193 Vali Acc: 0.567 Test Loss: 2.193 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.338747024536133
Epoch: 28, Steps: 17 | Train Loss: 0.039 Vali Loss: 2.354 Vali Acc: 0.567 Test Loss: 2.354 Test Acc: 0.567
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.062460422515869
Epoch: 29, Steps: 17 | Train Loss: 0.036 Vali Loss: 2.644 Vali Acc: 0.563 Test Loss: 2.644 Test Acc: 0.563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.590443686006826
model parameter : 125026
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.484728574752808
Epoch: 1, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.693 Vali Acc: 0.536 Test Loss: 0.693 Test Acc: 0.536
Validation loss decreased (inf --> -0.535829).  Saving model ...
Epoch: 2 cost time: 5.447006702423096
Epoch: 2, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.983 Vali Acc: 0.502 Test Loss: 0.983 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.390053987503052
Epoch: 3, Steps: 17 | Train Loss: 0.537 Vali Loss: 1.236 Vali Acc: 0.502 Test Loss: 1.236 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.976905345916748
Epoch: 4, Steps: 17 | Train Loss: 0.506 Vali Loss: 1.194 Vali Acc: 0.505 Test Loss: 1.194 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.954975605010986
Epoch: 5, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.995 Vali Acc: 0.522 Test Loss: 0.995 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.5741283893585205
Epoch: 6, Steps: 17 | Train Loss: 0.420 Vali Loss: 1.114 Vali Acc: 0.526 Test Loss: 1.114 Test Acc: 0.526
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.415385007858276
Epoch: 7, Steps: 17 | Train Loss: 0.389 Vali Loss: 1.363 Vali Acc: 0.515 Test Loss: 1.363 Test Acc: 0.515
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.182513475418091
Epoch: 8, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.969 Vali Acc: 0.526 Test Loss: 0.969 Test Acc: 0.526
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.72194766998291
Epoch: 9, Steps: 17 | Train Loss: 0.341 Vali Loss: 1.821 Vali Acc: 0.509 Test Loss: 1.821 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.317495346069336
Epoch: 10, Steps: 17 | Train Loss: 0.295 Vali Loss: 1.219 Vali Acc: 0.519 Test Loss: 1.219 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.911304712295532
Epoch: 11, Steps: 17 | Train Loss: 0.271 Vali Loss: 1.589 Vali Acc: 0.532 Test Loss: 1.589 Test Acc: 0.532
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.5358361774744027
model parameter : 125026
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.39255166053772
Epoch: 1, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.749 Vali Acc: 0.502 Test Loss: 0.749 Test Acc: 0.502
Validation loss decreased (inf --> -0.501699).  Saving model ...
Epoch: 2 cost time: 5.165841817855835
Epoch: 2, Steps: 17 | Train Loss: 0.599 Vali Loss: 1.294 Vali Acc: 0.502 Test Loss: 1.294 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.344773769378662
Epoch: 3, Steps: 17 | Train Loss: 0.602 Vali Loss: 1.453 Vali Acc: 0.502 Test Loss: 1.453 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.946979284286499
Epoch: 4, Steps: 17 | Train Loss: 0.571 Vali Loss: 1.388 Vali Acc: 0.502 Test Loss: 1.388 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.866690158843994
Epoch: 5, Steps: 17 | Train Loss: 0.563 Vali Loss: 1.311 Vali Acc: 0.502 Test Loss: 1.311 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.808051586151123
Epoch: 6, Steps: 17 | Train Loss: 0.528 Vali Loss: 1.227 Vali Acc: 0.502 Test Loss: 1.227 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.65757417678833
Epoch: 7, Steps: 17 | Train Loss: 0.519 Vali Loss: 1.166 Vali Acc: 0.502 Test Loss: 1.166 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.124843120574951
Epoch: 8, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.964 Vali Acc: 0.502 Test Loss: 0.964 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.135631084442139
Epoch: 9, Steps: 17 | Train Loss: 0.500 Vali Loss: 1.252 Vali Acc: 0.502 Test Loss: 1.252 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.575812101364136
Epoch: 10, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.790 Vali Acc: 0.505 Test Loss: 0.790 Test Acc: 0.505
Validation loss decreased (-0.501699 --> -0.505112).  Saving model ...
Epoch: 11 cost time: 4.6446897983551025
Epoch: 11, Steps: 17 | Train Loss: 0.494 Vali Loss: 1.489 Vali Acc: 0.502 Test Loss: 1.489 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.135232448577881
Epoch: 12, Steps: 17 | Train Loss: 0.473 Vali Loss: 1.224 Vali Acc: 0.502 Test Loss: 1.224 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.245452165603638
Epoch: 13, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.741 Vali Acc: 0.529 Test Loss: 0.741 Test Acc: 0.529
Validation loss decreased (-0.505112 --> -0.529003).  Saving model ...
Epoch: 14 cost time: 5.273474931716919
Epoch: 14, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.716 Vali Acc: 0.553 Test Loss: 0.716 Test Acc: 0.553
Validation loss decreased (-0.529003 --> -0.552894).  Saving model ...
Epoch: 15 cost time: 5.273314476013184
Epoch: 15, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.858 Vali Acc: 0.509 Test Loss: 0.858 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.156914949417114
Epoch: 16, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.781 Vali Acc: 0.519 Test Loss: 0.781 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.119563102722168
Epoch: 17, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.784 Vali Acc: 0.532 Test Loss: 0.784 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.402063369750977
Epoch: 18, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.710 Vali Acc: 0.594 Test Loss: 0.710 Test Acc: 0.594
Validation loss decreased (-0.552894 --> -0.593850).  Saving model ...
Epoch: 19 cost time: 4.675557374954224
Epoch: 19, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.681 Vali Acc: 0.631 Test Loss: 0.681 Test Acc: 0.631
Validation loss decreased (-0.593850 --> -0.631393).  Saving model ...
Epoch: 20 cost time: 5.2030510902404785
Epoch: 20, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.735 Vali Acc: 0.611 Test Loss: 0.735 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.1324782371521
Epoch: 21, Steps: 17 | Train Loss: 0.335 Vali Loss: 1.028 Vali Acc: 0.522 Test Loss: 1.028 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.027993440628052
Epoch: 22, Steps: 17 | Train Loss: 0.314 Vali Loss: 1.244 Vali Acc: 0.505 Test Loss: 1.244 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.762701749801636
Epoch: 23, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.866 Vali Acc: 0.560 Test Loss: 0.866 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.310472249984741
Epoch: 24, Steps: 17 | Train Loss: 0.324 Vali Loss: 1.136 Vali Acc: 0.539 Test Loss: 1.136 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.194301128387451
Epoch: 25, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.893 Vali Acc: 0.567 Test Loss: 0.893 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.151857614517212
Epoch: 26, Steps: 17 | Train Loss: 0.229 Vali Loss: 1.038 Vali Acc: 0.567 Test Loss: 1.038 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.55323600769043
Epoch: 27, Steps: 17 | Train Loss: 0.266 Vali Loss: 1.059 Vali Acc: 0.567 Test Loss: 1.059 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.138835430145264
Epoch: 28, Steps: 17 | Train Loss: 0.264 Vali Loss: 1.201 Vali Acc: 0.560 Test Loss: 1.201 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.326122999191284
Epoch: 29, Steps: 17 | Train Loss: 0.236 Vali Loss: 1.764 Vali Acc: 0.519 Test Loss: 1.764 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6313993174061433
model parameter : 125026
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
fourier enhanced block used!
modes=32, index=[13, 34, 46, 64, 66, 111, 115, 118, 124, 134, 138, 139, 142, 182, 211, 215, 216, 252, 274, 277, 290, 301, 302, 312, 320, 335, 337, 347, 354, 375, 434, 439]
fourier enhanced block used!
modes=32, index=[3, 6, 9, 18, 20, 28, 34, 40, 44, 45, 47, 54, 59, 79, 81, 84, 92, 101, 103, 107, 125, 137, 161, 163, 180, 194, 205, 214, 217, 218, 219, 221]
 fourier enhanced cross attention used!
modes_q=32, index_q=[19, 20, 35, 38, 59, 61, 62, 65, 67, 70, 71, 72, 74, 85, 86, 102, 110, 111, 121, 122, 140, 146, 148, 149, 167, 191, 193, 197, 202, 206, 207, 209]
modes_kv=32, index_kv=[15, 27, 31, 32, 49, 59, 62, 89, 95, 105, 111, 114, 135, 144, 148, 189, 206, 215, 232, 242, 254, 269, 277, 297, 343, 349, 368, 370, 420, 437, 445, 446]
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.748646020889282
Epoch: 1, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.768 Vali Acc: 0.491 Test Loss: 0.768 Test Acc: 0.491
Validation loss decreased (inf --> -0.491460).  Saving model ...
Epoch: 2 cost time: 4.430229902267456
Epoch: 2, Steps: 17 | Train Loss: 0.610 Vali Loss: 1.414 Vali Acc: 0.502 Test Loss: 1.414 Test Acc: 0.502
Validation loss decreased (-0.491460 --> -0.501692).  Saving model ...
Epoch: 3 cost time: 4.305343389511108
Epoch: 3, Steps: 17 | Train Loss: 0.629 Vali Loss: 1.534 Vali Acc: 0.502 Test Loss: 1.534 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.157302379608154
Epoch: 4, Steps: 17 | Train Loss: 0.558 Vali Loss: 1.476 Vali Acc: 0.502 Test Loss: 1.476 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.321960687637329
Epoch: 5, Steps: 17 | Train Loss: 0.585 Vali Loss: 1.660 Vali Acc: 0.502 Test Loss: 1.660 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.055501937866211
Epoch: 6, Steps: 17 | Train Loss: 0.533 Vali Loss: 1.904 Vali Acc: 0.502 Test Loss: 1.904 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.0991528034210205
Epoch: 7, Steps: 17 | Train Loss: 0.486 Vali Loss: 1.777 Vali Acc: 0.502 Test Loss: 1.777 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.88826060295105
Epoch: 8, Steps: 17 | Train Loss: 0.486 Vali Loss: 1.212 Vali Acc: 0.502 Test Loss: 1.212 Test Acc: 0.502
Validation loss decreased (-0.501692 --> -0.501694).  Saving model ...
Epoch: 9 cost time: 5.086570978164673
Epoch: 9, Steps: 17 | Train Loss: 0.519 Vali Loss: 1.461 Vali Acc: 0.502 Test Loss: 1.461 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.115678548812866
Epoch: 10, Steps: 17 | Train Loss: 0.491 Vali Loss: 1.145 Vali Acc: 0.502 Test Loss: 1.145 Test Acc: 0.502
Validation loss decreased (-0.501694 --> -0.501695).  Saving model ...
Epoch: 11 cost time: 4.803600072860718
Epoch: 11, Steps: 17 | Train Loss: 0.484 Vali Loss: 1.534 Vali Acc: 0.502 Test Loss: 1.534 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.886645793914795
Epoch: 12, Steps: 17 | Train Loss: 0.470 Vali Loss: 1.200 Vali Acc: 0.502 Test Loss: 1.200 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.939194917678833
Epoch: 13, Steps: 17 | Train Loss: 0.509 Vali Loss: 1.331 Vali Acc: 0.502 Test Loss: 1.331 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.104446649551392
Epoch: 14, Steps: 17 | Train Loss: 0.479 Vali Loss: 1.115 Vali Acc: 0.502 Test Loss: 1.115 Test Acc: 0.502
Validation loss decreased (-0.501695 --> -0.501695).  Saving model ...
Epoch: 15 cost time: 5.34205174446106
Epoch: 15, Steps: 17 | Train Loss: 0.454 Vali Loss: 1.002 Vali Acc: 0.509 Test Loss: 1.002 Test Acc: 0.509
Validation loss decreased (-0.501695 --> -0.508522).  Saving model ...
Epoch: 16 cost time: 5.474899053573608
Epoch: 16, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.730 Vali Acc: 0.584 Test Loss: 0.730 Test Acc: 0.584
Validation loss decreased (-0.508522 --> -0.583610).  Saving model ...
Epoch: 17 cost time: 5.155421733856201
Epoch: 17, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.702 Vali Acc: 0.601 Test Loss: 0.702 Test Acc: 0.601
Validation loss decreased (-0.583610 --> -0.600676).  Saving model ...
Epoch: 18 cost time: 5.345439434051514
Epoch: 18, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.753 Vali Acc: 0.618 Test Loss: 0.753 Test Acc: 0.618
Validation loss decreased (-0.600676 --> -0.617740).  Saving model ...
Epoch: 19 cost time: 5.159393310546875
Epoch: 19, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.759 Vali Acc: 0.560 Test Loss: 0.759 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.9785401821136475
Epoch: 20, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.752 Vali Acc: 0.618 Test Loss: 0.752 Test Acc: 0.618
Validation loss decreased (-0.617740 --> -0.617740).  Saving model ...
Epoch: 21 cost time: 4.4838950634002686
Epoch: 21, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.752 Vali Acc: 0.563 Test Loss: 0.752 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.646269798278809
Epoch: 22, Steps: 17 | Train Loss: 0.384 Vali Loss: 1.211 Vali Acc: 0.549 Test Loss: 1.211 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.415932655334473
Epoch: 23, Steps: 17 | Train Loss: 0.534 Vali Loss: 1.387 Vali Acc: 0.532 Test Loss: 1.387 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.302401065826416
Epoch: 24, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.914 Vali Acc: 0.584 Test Loss: 0.914 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.597983360290527
Epoch: 25, Steps: 17 | Train Loss: 0.398 Vali Loss: 1.035 Vali Acc: 0.587 Test Loss: 1.035 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.909032821655273
Epoch: 26, Steps: 17 | Train Loss: 0.353 Vali Loss: 1.402 Vali Acc: 0.570 Test Loss: 1.402 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.99230170249939
Epoch: 27, Steps: 17 | Train Loss: 0.362 Vali Loss: 1.462 Vali Acc: 0.567 Test Loss: 1.462 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.985021352767944
Epoch: 28, Steps: 17 | Train Loss: 0.526 Vali Loss: 1.741 Vali Acc: 0.549 Test Loss: 1.741 Test Acc: 0.549
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.840981721878052
Epoch: 29, Steps: 17 | Train Loss: 0.388 Vali Loss: 1.499 Vali Acc: 0.577 Test Loss: 1.499 Test Acc: 0.577
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.064828634262085
Epoch: 30, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.971 Vali Acc: 0.608 Test Loss: 0.971 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_FEDformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.6177474402730375
model parameter : 125026
model size : 1.72MB
