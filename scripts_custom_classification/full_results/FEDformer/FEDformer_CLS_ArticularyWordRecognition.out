Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.433054208755493
Epoch: 1, Steps: 18 | Train Loss: 2.559 Vali Loss: 1.039 Vali Acc: 0.747 Test Loss: 1.039 Test Acc: 0.747
Validation loss decreased (inf --> -0.746656).  Saving model ...
Epoch: 2 cost time: 7.168901443481445
Epoch: 2, Steps: 18 | Train Loss: 0.298 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
Validation loss decreased (-0.746656 --> -0.849994).  Saving model ...
Epoch: 3 cost time: 6.7485880851745605
Epoch: 3, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.467 Vali Acc: 0.883 Test Loss: 0.467 Test Acc: 0.883
Validation loss decreased (-0.849994 --> -0.883329).  Saving model ...
Epoch: 4 cost time: 7.481196165084839
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.502 Vali Acc: 0.877 Test Loss: 0.502 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.600026607513428
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.883 Test Loss: 0.468 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.518580675125122
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.897 Test Loss: 0.433 Test Acc: 0.897
Validation loss decreased (-0.883329 --> -0.896662).  Saving model ...
Epoch: 7 cost time: 6.633407354354858
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
Validation loss decreased (-0.896662 --> -0.899996).  Saving model ...
Epoch: 8 cost time: 7.611371278762817
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 9 cost time: 6.969862699508667
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 6.395747184753418
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 7.355059623718262
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 7.540151357650757
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 7.282803297042847
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.418 Vali Acc: 0.897 Test Loss: 0.418 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.548950910568237
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.418 Vali Acc: 0.897 Test Loss: 0.418 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.357127904891968
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.897 Test Loss: 0.417 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.989959001541138
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.897 Test Loss: 0.417 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.038115978240967
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.897 Test Loss: 0.415 Test Acc: 0.897
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.255749464035034
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.897 Test Loss: 0.415 Test Acc: 0.897
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.915461301803589
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.897 Test Loss: 0.414 Test Acc: 0.897
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.859303951263428
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.897 Test Loss: 0.413 Test Acc: 0.897
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.855087041854858
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.897 Test Loss: 0.412 Test Acc: 0.897
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.334962844848633
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.897 Test Loss: 0.413 Test Acc: 0.897
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9
model parameter : 18659353
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.278820514678955
Epoch: 1, Steps: 18 | Train Loss: 2.758 Vali Loss: 1.394 Vali Acc: 0.690 Test Loss: 1.394 Test Acc: 0.690
Validation loss decreased (inf --> -0.689986).  Saving model ...
Epoch: 2 cost time: 6.925870418548584
Epoch: 2, Steps: 18 | Train Loss: 0.411 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
Validation loss decreased (-0.689986 --> -0.799992).  Saving model ...
Epoch: 3 cost time: 6.961132049560547
Epoch: 3, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.667 Vali Acc: 0.820 Test Loss: 0.667 Test Acc: 0.820
Validation loss decreased (-0.799992 --> -0.819993).  Saving model ...
Epoch: 4 cost time: 7.3425610065460205
Epoch: 4, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.623 Vali Acc: 0.847 Test Loss: 0.623 Test Acc: 0.847
Validation loss decreased (-0.819993 --> -0.846660).  Saving model ...
Epoch: 5 cost time: 6.420654535293579
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.676 Vali Acc: 0.843 Test Loss: 0.676 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.721583366394043
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.763 Vali Acc: 0.820 Test Loss: 0.763 Test Acc: 0.820
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.47060227394104
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.996 Vali Acc: 0.767 Test Loss: 0.996 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.445607662200928
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.871 Vali Acc: 0.833 Test Loss: 0.871 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.194496154785156
Epoch: 9, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.028 Vali Acc: 0.780 Test Loss: 1.028 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.724820613861084
Epoch: 10, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.701 Vali Acc: 0.690 Test Loss: 1.701 Test Acc: 0.690
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.38521409034729
Epoch: 11, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.040 Vali Acc: 0.800 Test Loss: 1.040 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.440234899520874
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.099 Vali Acc: 0.763 Test Loss: 1.099 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.280397415161133
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.994 Vali Acc: 0.810 Test Loss: 0.994 Test Acc: 0.810
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.6489739418029785
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.063 Vali Acc: 0.807 Test Loss: 1.063 Test Acc: 0.807
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8466666666666667
model parameter : 18659353
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.69464373588562
Epoch: 1, Steps: 18 | Train Loss: 2.966 Vali Loss: 1.954 Vali Acc: 0.497 Test Loss: 1.954 Test Acc: 0.497
Validation loss decreased (inf --> -0.496647).  Saving model ...
Epoch: 2 cost time: 7.1832756996154785
Epoch: 2, Steps: 18 | Train Loss: 0.700 Vali Loss: 1.126 Vali Acc: 0.697 Test Loss: 1.126 Test Acc: 0.697
Validation loss decreased (-0.496647 --> -0.696655).  Saving model ...
Epoch: 3 cost time: 6.144125461578369
Epoch: 3, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.922 Vali Acc: 0.743 Test Loss: 0.922 Test Acc: 0.743
Validation loss decreased (-0.696655 --> -0.743324).  Saving model ...
Epoch: 4 cost time: 7.036106586456299
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.017 Vali Acc: 0.747 Test Loss: 1.017 Test Acc: 0.747
Validation loss decreased (-0.743324 --> -0.746656).  Saving model ...
Epoch: 5 cost time: 7.446317672729492
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.995 Vali Acc: 0.750 Test Loss: 0.995 Test Acc: 0.750
Validation loss decreased (-0.746656 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 7.269344806671143
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.921 Vali Acc: 0.777 Test Loss: 0.921 Test Acc: 0.777
Validation loss decreased (-0.749990 --> -0.776657).  Saving model ...
Epoch: 7 cost time: 6.72007155418396
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.790 Test Loss: 0.875 Test Acc: 0.790
Validation loss decreased (-0.776657 --> -0.789991).  Saving model ...
Epoch: 8 cost time: 7.0838494300842285
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.783 Test Loss: 0.864 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.648563861846924
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.783 Test Loss: 0.864 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.494006156921387
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.790 Test Loss: 0.864 Test Acc: 0.790
Validation loss decreased (-0.789991 --> -0.789991).  Saving model ...
Epoch: 11 cost time: 6.796149969100952
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.790 Test Loss: 0.864 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.594439506530762
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.797 Test Loss: 0.863 Test Acc: 0.797
Validation loss decreased (-0.789991 --> -0.796658).  Saving model ...
Epoch: 13 cost time: 6.82624077796936
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.800 Test Loss: 0.862 Test Acc: 0.800
Validation loss decreased (-0.796658 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 6.628758907318115
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.800 Test Loss: 0.865 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.663428544998169
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.803 Test Loss: 0.864 Test Acc: 0.803
Validation loss decreased (-0.799991 --> -0.803325).  Saving model ...
Epoch: 16 cost time: 7.136752128601074
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.803 Test Loss: 0.867 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.767382621765137
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.803 Test Loss: 0.870 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.242409706115723
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.800 Test Loss: 0.870 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.048676013946533
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.800 Test Loss: 0.872 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.5276405811309814
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.800 Test Loss: 0.876 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.570963621139526
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.800 Test Loss: 0.876 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.3815085887908936
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.793 Test Loss: 0.879 Test Acc: 0.793
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.792712926864624
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.878 Vali Acc: 0.797 Test Loss: 0.878 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.54862117767334
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.800 Test Loss: 0.879 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.97734522819519
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.800 Test Loss: 0.881 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8033333333333333
model parameter : 18659353
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.860815048217773
Epoch: 1, Steps: 18 | Train Loss: 3.107 Vali Loss: 2.457 Vali Acc: 0.277 Test Loss: 2.457 Test Acc: 0.277
Validation loss decreased (inf --> -0.276642).  Saving model ...
Epoch: 2 cost time: 6.771456480026245
Epoch: 2, Steps: 18 | Train Loss: 1.119 Vali Loss: 1.674 Vali Acc: 0.530 Test Loss: 1.674 Test Acc: 0.530
Validation loss decreased (-0.276642 --> -0.529983).  Saving model ...
Epoch: 3 cost time: 7.379208326339722
Epoch: 3, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.518 Vali Acc: 0.533 Test Loss: 1.518 Test Acc: 0.533
Validation loss decreased (-0.529983 --> -0.533318).  Saving model ...
Epoch: 4 cost time: 7.035325765609741
Epoch: 4, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.360 Vali Acc: 0.617 Test Loss: 1.360 Test Acc: 0.617
Validation loss decreased (-0.533318 --> -0.616653).  Saving model ...
Epoch: 5 cost time: 6.581216335296631
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.141 Vali Acc: 0.690 Test Loss: 1.141 Test Acc: 0.690
Validation loss decreased (-0.616653 --> -0.689989).  Saving model ...
Epoch: 6 cost time: 6.751933336257935
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.199 Vali Acc: 0.667 Test Loss: 1.199 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.818299770355225
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.155 Vali Acc: 0.693 Test Loss: 1.155 Test Acc: 0.693
Validation loss decreased (-0.689989 --> -0.693322).  Saving model ...
Epoch: 8 cost time: 6.893794059753418
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.140 Vali Acc: 0.693 Test Loss: 1.140 Test Acc: 0.693
Validation loss decreased (-0.693322 --> -0.693322).  Saving model ...
Epoch: 9 cost time: 6.158851385116577
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.700 Test Loss: 1.132 Test Acc: 0.700
Validation loss decreased (-0.693322 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 6.75098729133606
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.131 Vali Acc: 0.700 Test Loss: 1.131 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 6.975125551223755
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.125 Vali Acc: 0.697 Test Loss: 1.125 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.5835254192352295
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.120 Vali Acc: 0.703 Test Loss: 1.120 Test Acc: 0.703
Validation loss decreased (-0.699989 --> -0.703322).  Saving model ...
Epoch: 13 cost time: 6.965952396392822
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.115 Vali Acc: 0.697 Test Loss: 1.115 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.387310266494751
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.117 Vali Acc: 0.703 Test Loss: 1.117 Test Acc: 0.703
Validation loss decreased (-0.703322 --> -0.703322).  Saving model ...
Epoch: 15 cost time: 6.269903182983398
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.110 Vali Acc: 0.703 Test Loss: 1.110 Test Acc: 0.703
Validation loss decreased (-0.703322 --> -0.703322).  Saving model ...
Epoch: 16 cost time: 6.820129871368408
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.710 Test Loss: 1.108 Test Acc: 0.710
Validation loss decreased (-0.703322 --> -0.709989).  Saving model ...
Epoch: 17 cost time: 7.202936410903931
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.707 Test Loss: 1.108 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.6722352504730225
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.105 Vali Acc: 0.710 Test Loss: 1.105 Test Acc: 0.710
Validation loss decreased (-0.709989 --> -0.709989).  Saving model ...
Epoch: 19 cost time: 6.639208555221558
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.102 Vali Acc: 0.707 Test Loss: 1.102 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.042231321334839
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.099 Vali Acc: 0.707 Test Loss: 1.099 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.006206512451172
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.096 Vali Acc: 0.703 Test Loss: 1.096 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.440068483352661
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.095 Vali Acc: 0.703 Test Loss: 1.095 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.649236679077148
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.093 Vali Acc: 0.707 Test Loss: 1.093 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.069348335266113
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.091 Vali Acc: 0.707 Test Loss: 1.091 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.200853109359741
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.707 Test Loss: 1.090 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.084048271179199
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.707 Test Loss: 1.089 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.7135396003723145
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.707 Test Loss: 1.089 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.366716146469116
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.088 Vali Acc: 0.710 Test Loss: 1.088 Test Acc: 0.710
Validation loss decreased (-0.709989 --> -0.709989).  Saving model ...
Epoch: 29 cost time: 6.2813920974731445
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.710 Test Loss: 1.087 Test Acc: 0.710
Validation loss decreased (-0.709989 --> -0.709989).  Saving model ...
Epoch: 30 cost time: 6.343748331069946
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.083 Vali Acc: 0.710 Test Loss: 1.083 Test Acc: 0.710
Validation loss decreased (-0.709989 --> -0.709989).  Saving model ...
Epoch: 31 cost time: 6.943543434143066
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.083 Vali Acc: 0.710 Test Loss: 1.083 Test Acc: 0.710
Validation loss decreased (-0.709989 --> -0.709989).  Saving model ...
Epoch: 32 cost time: 6.717386484146118
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.082 Vali Acc: 0.710 Test Loss: 1.082 Test Acc: 0.710
Validation loss decreased (-0.709989 --> -0.709989).  Saving model ...
Epoch: 33 cost time: 6.860260009765625
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.713 Test Loss: 1.081 Test Acc: 0.713
Validation loss decreased (-0.709989 --> -0.713323).  Saving model ...
Epoch: 34 cost time: 7.140843868255615
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.079 Vali Acc: 0.713 Test Loss: 1.079 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 35 cost time: 7.2325825691223145
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.713 Test Loss: 1.078 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 36 cost time: 6.516683101654053
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.713 Test Loss: 1.076 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 37 cost time: 7.152818441390991
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.717 Test Loss: 1.076 Test Acc: 0.717
Validation loss decreased (-0.713323 --> -0.716656).  Saving model ...
Epoch: 38 cost time: 7.412456512451172
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.717 Test Loss: 1.075 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716656).  Saving model ...
Epoch: 39 cost time: 6.797896146774292
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.717 Test Loss: 1.074 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716656).  Saving model ...
Epoch: 40 cost time: 6.874719858169556
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.717 Test Loss: 1.073 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716656).  Saving model ...
Epoch: 41 cost time: 7.0299317836761475
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.720 Test Loss: 1.071 Test Acc: 0.720
Validation loss decreased (-0.716656 --> -0.719989).  Saving model ...
Epoch: 42 cost time: 6.690186977386475
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.717 Test Loss: 1.069 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.8556969165802
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.717 Test Loss: 1.069 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 7.034976482391357
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.713 Test Loss: 1.069 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 6.500951528549194
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.713 Test Loss: 1.069 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 7.1905810832977295
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.713 Test Loss: 1.068 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 6.950838327407837
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.067 Vali Acc: 0.713 Test Loss: 1.067 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 7.17424464225769
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.067 Vali Acc: 0.713 Test Loss: 1.067 Test Acc: 0.713
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 6.992252349853516
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.713 Test Loss: 1.070 Test Acc: 0.713
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 6.942721605300903
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.713 Test Loss: 1.069 Test Acc: 0.713
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 6.511444091796875
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.713 Test Loss: 1.069 Test Acc: 0.713
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.72
model parameter : 18659353
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.533926248550415
Epoch: 1, Steps: 18 | Train Loss: 3.200 Vali Loss: 2.800 Vali Acc: 0.220 Test Loss: 2.800 Test Acc: 0.220
Validation loss decreased (inf --> -0.219972).  Saving model ...
Epoch: 2 cost time: 5.862230539321899
Epoch: 2, Steps: 18 | Train Loss: 1.415 Vali Loss: 2.250 Vali Acc: 0.363 Test Loss: 2.250 Test Acc: 0.363
Validation loss decreased (-0.219972 --> -0.363311).  Saving model ...
Epoch: 3 cost time: 6.443629503250122
Epoch: 3, Steps: 18 | Train Loss: 0.233 Vali Loss: 2.042 Vali Acc: 0.393 Test Loss: 2.042 Test Acc: 0.393
Validation loss decreased (-0.363311 --> -0.393313).  Saving model ...
Epoch: 4 cost time: 6.082168340682983
Epoch: 4, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.991 Vali Acc: 0.400 Test Loss: 1.991 Test Acc: 0.400
Validation loss decreased (-0.393313 --> -0.399980).  Saving model ...
Epoch: 5 cost time: 6.224944591522217
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.568 Vali Acc: 0.530 Test Loss: 1.568 Test Acc: 0.530
Validation loss decreased (-0.399980 --> -0.529984).  Saving model ...
Epoch: 6 cost time: 6.765739917755127
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.558 Vali Acc: 0.550 Test Loss: 1.558 Test Acc: 0.550
Validation loss decreased (-0.529984 --> -0.549984).  Saving model ...
Epoch: 7 cost time: 7.349993705749512
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.520 Vali Acc: 0.563 Test Loss: 1.520 Test Acc: 0.563
Validation loss decreased (-0.549984 --> -0.563318).  Saving model ...
Epoch: 8 cost time: 6.382850885391235
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.560 Test Loss: 1.519 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.60126256942749
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.557 Test Loss: 1.517 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.916061162948608
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.570 Test Loss: 1.510 Test Acc: 0.570
Validation loss decreased (-0.563318 --> -0.569985).  Saving model ...
Epoch: 11 cost time: 6.437581300735474
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.577 Test Loss: 1.505 Test Acc: 0.577
Validation loss decreased (-0.569985 --> -0.576652).  Saving model ...
Epoch: 12 cost time: 6.61139988899231
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.573 Test Loss: 1.499 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.879040241241455
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.590 Test Loss: 1.500 Test Acc: 0.590
Validation loss decreased (-0.576652 --> -0.589985).  Saving model ...
Epoch: 14 cost time: 7.12785792350769
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.590 Test Loss: 1.496 Test Acc: 0.590
Validation loss decreased (-0.589985 --> -0.589985).  Saving model ...
Epoch: 15 cost time: 6.175281763076782
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.593 Test Loss: 1.486 Test Acc: 0.593
Validation loss decreased (-0.589985 --> -0.593318).  Saving model ...
Epoch: 16 cost time: 6.6608192920684814
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.597 Test Loss: 1.482 Test Acc: 0.597
Validation loss decreased (-0.593318 --> -0.596652).  Saving model ...
Epoch: 17 cost time: 6.810400485992432
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.603 Test Loss: 1.480 Test Acc: 0.603
Validation loss decreased (-0.596652 --> -0.603319).  Saving model ...
Epoch: 18 cost time: 6.442189455032349
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.603 Test Loss: 1.478 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 19 cost time: 7.227936029434204
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.600 Test Loss: 1.473 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.963312387466431
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.597 Test Loss: 1.470 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.920413255691528
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.607 Test Loss: 1.468 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606652).  Saving model ...
Epoch: 22 cost time: 6.384014129638672
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.610 Test Loss: 1.466 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609985).  Saving model ...
Epoch: 23 cost time: 6.184729337692261
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.613 Test Loss: 1.460 Test Acc: 0.613
Validation loss decreased (-0.609985 --> -0.613319).  Saving model ...
Epoch: 24 cost time: 6.43890118598938
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.457 Vali Acc: 0.610 Test Loss: 1.457 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.249046325683594
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.457 Vali Acc: 0.610 Test Loss: 1.457 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.452583312988281
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.613 Test Loss: 1.456 Test Acc: 0.613
Validation loss decreased (-0.613319 --> -0.613319).  Saving model ...
Epoch: 27 cost time: 7.233895301818848
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.613 Test Loss: 1.456 Test Acc: 0.613
Validation loss decreased (-0.613319 --> -0.613319).  Saving model ...
Epoch: 28 cost time: 7.296926021575928
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.458 Vali Acc: 0.627 Test Loss: 1.458 Test Acc: 0.627
Validation loss decreased (-0.613319 --> -0.626652).  Saving model ...
Epoch: 29 cost time: 6.684569835662842
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.630 Test Loss: 1.455 Test Acc: 0.630
Validation loss decreased (-0.626652 --> -0.629985).  Saving model ...
Epoch: 30 cost time: 7.121264219284058
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.627 Test Loss: 1.454 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 7.141618013381958
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.630 Test Loss: 1.453 Test Acc: 0.630
Validation loss decreased (-0.629985 --> -0.629985).  Saving model ...
Epoch: 32 cost time: 7.205285549163818
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.630 Test Loss: 1.452 Test Acc: 0.630
Validation loss decreased (-0.629985 --> -0.629985).  Saving model ...
Epoch: 33 cost time: 7.065565347671509
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.630 Test Loss: 1.451 Test Acc: 0.630
Validation loss decreased (-0.629985 --> -0.629985).  Saving model ...
Epoch: 34 cost time: 6.351206064224243
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.630 Test Loss: 1.449 Test Acc: 0.630
Validation loss decreased (-0.629985 --> -0.629986).  Saving model ...
Epoch: 35 cost time: 6.743517875671387
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.630 Test Loss: 1.450 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.67060923576355
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.627 Test Loss: 1.448 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 7.016051292419434
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.630 Test Loss: 1.448 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 38 cost time: 6.584492921829224
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.630 Test Loss: 1.447 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 39 cost time: 6.371239423751831
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.446 Vali Acc: 0.630 Test Loss: 1.446 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 40 cost time: 7.235144138336182
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.637 Test Loss: 1.445 Test Acc: 0.637
Validation loss decreased (-0.629986 --> -0.636652).  Saving model ...
Epoch: 41 cost time: 7.651430130004883
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.637 Test Loss: 1.444 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 42 cost time: 6.945290803909302
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.633 Test Loss: 1.444 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 7.029272556304932
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.633 Test Loss: 1.445 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 6.756521463394165
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.630 Test Loss: 1.445 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 6.799401521682739
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.633 Test Loss: 1.442 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 6.865777015686035
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.633 Test Loss: 1.441 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 6.569957971572876
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.637 Test Loss: 1.440 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 48 cost time: 6.896498441696167
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.643 Test Loss: 1.441 Test Acc: 0.643
Validation loss decreased (-0.636652 --> -0.643319).  Saving model ...
Epoch: 49 cost time: 6.925105333328247
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.643 Test Loss: 1.443 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.567802429199219
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.647 Test Loss: 1.443 Test Acc: 0.647
Validation loss decreased (-0.643319 --> -0.646652).  Saving model ...
Epoch: 51 cost time: 7.070959091186523
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.640 Test Loss: 1.440 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.383380174636841
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.647 Test Loss: 1.440 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 53 cost time: 6.8952271938323975
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.647 Test Loss: 1.440 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 54 cost time: 7.089263677597046
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.647 Test Loss: 1.441 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.661359786987305
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.647 Test Loss: 1.442 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 6.209683179855347
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.647 Test Loss: 1.440 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 6.837663650512695
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.650 Test Loss: 1.441 Test Acc: 0.650
Validation loss decreased (-0.646652 --> -0.649986).  Saving model ...
Epoch: 58 cost time: 7.1796555519104
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.650 Test Loss: 1.440 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 59 cost time: 6.43772029876709
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.650 Test Loss: 1.440 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 6.651097059249878
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.650 Test Loss: 1.439 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 61 cost time: 6.958723545074463
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.650 Test Loss: 1.440 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 5.9287190437316895
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.650 Test Loss: 1.439 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 63 cost time: 7.389742136001587
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.650 Test Loss: 1.439 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 6.063359022140503
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.657 Test Loss: 1.439 Test Acc: 0.657
Validation loss decreased (-0.649986 --> -0.656652).  Saving model ...
Epoch: 65 cost time: 6.4939329624176025
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.653 Test Loss: 1.442 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 6.598077058792114
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.657 Test Loss: 1.441 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 6.683023452758789
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.653 Test Loss: 1.441 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 7.005122661590576
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.653 Test Loss: 1.442 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 6.92011022567749
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.657 Test Loss: 1.442 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 6.21965479850769
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.657 Test Loss: 1.442 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 6.575381517410278
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.657 Test Loss: 1.441 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 7.164590358734131
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.657 Test Loss: 1.441 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 6.629716634750366
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.657 Test Loss: 1.441 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 6.625343322753906
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.653 Test Loss: 1.442 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6566666666666666
model parameter : 18659353
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.851356506347656
Epoch: 1, Steps: 18 | Train Loss: 3.243 Vali Loss: 2.939 Vali Acc: 0.177 Test Loss: 2.939 Test Acc: 0.177
Validation loss decreased (inf --> -0.176637).  Saving model ...
Epoch: 2 cost time: 5.911379814147949
Epoch: 2, Steps: 18 | Train Loss: 1.460 Vali Loss: 2.609 Vali Acc: 0.263 Test Loss: 2.609 Test Acc: 0.263
Validation loss decreased (-0.176637 --> -0.263307).  Saving model ...
Epoch: 3 cost time: 6.5008392333984375
Epoch: 3, Steps: 18 | Train Loss: 0.215 Vali Loss: 2.306 Vali Acc: 0.343 Test Loss: 2.306 Test Acc: 0.343
Validation loss decreased (-0.263307 --> -0.343310).  Saving model ...
Epoch: 4 cost time: 6.05392861366272
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 2.603 Vali Acc: 0.340 Test Loss: 2.603 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.535749435424805
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.309 Vali Acc: 0.403 Test Loss: 2.309 Test Acc: 0.403
Validation loss decreased (-0.343310 --> -0.403310).  Saving model ...
Epoch: 6 cost time: 6.1913886070251465
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.143 Vali Acc: 0.450 Test Loss: 2.143 Test Acc: 0.450
Validation loss decreased (-0.403310 --> -0.449979).  Saving model ...
Epoch: 7 cost time: 6.929297924041748
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 2.178 Vali Acc: 0.437 Test Loss: 2.178 Test Acc: 0.437
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.828094005584717
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.459 Vali Acc: 0.373 Test Loss: 2.459 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.586017370223999
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.297 Vali Acc: 0.410 Test Loss: 2.297 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.467213869094849
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.230 Vali Acc: 0.400 Test Loss: 2.230 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.034317970275879
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.203 Vali Acc: 0.437 Test Loss: 2.203 Test Acc: 0.437
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.54504656791687
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.183 Vali Acc: 0.433 Test Loss: 2.183 Test Acc: 0.433
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.224292278289795
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.174 Vali Acc: 0.450 Test Loss: 2.174 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.423893213272095
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.165 Vali Acc: 0.443 Test Loss: 2.165 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.660250425338745
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.148 Vali Acc: 0.450 Test Loss: 2.148 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.398002624511719
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.140 Vali Acc: 0.450 Test Loss: 2.140 Test Acc: 0.450
Validation loss decreased (-0.449979 --> -0.449979).  Saving model ...
Epoch: 17 cost time: 6.6100382804870605
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.131 Vali Acc: 0.457 Test Loss: 2.131 Test Acc: 0.457
Validation loss decreased (-0.449979 --> -0.456645).  Saving model ...
Epoch: 18 cost time: 7.096130847930908
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.125 Vali Acc: 0.453 Test Loss: 2.125 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.0561583042144775
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.116 Vali Acc: 0.463 Test Loss: 2.116 Test Acc: 0.463
Validation loss decreased (-0.456645 --> -0.463312).  Saving model ...
Epoch: 20 cost time: 6.390033960342407
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.111 Vali Acc: 0.460 Test Loss: 2.111 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.813532829284668
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.105 Vali Acc: 0.460 Test Loss: 2.105 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.877138376235962
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.098 Vali Acc: 0.463 Test Loss: 2.098 Test Acc: 0.463
Validation loss decreased (-0.463312 --> -0.463312).  Saving model ...
Epoch: 23 cost time: 6.567626237869263
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.089 Vali Acc: 0.473 Test Loss: 2.089 Test Acc: 0.473
Validation loss decreased (-0.463312 --> -0.473312).  Saving model ...
Epoch: 24 cost time: 6.58949875831604
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.087 Vali Acc: 0.473 Test Loss: 2.087 Test Acc: 0.473
Validation loss decreased (-0.473312 --> -0.473312).  Saving model ...
Epoch: 25 cost time: 6.612601041793823
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.083 Vali Acc: 0.473 Test Loss: 2.083 Test Acc: 0.473
Validation loss decreased (-0.473312 --> -0.473313).  Saving model ...
Epoch: 26 cost time: 7.021679162979126
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.080 Vali Acc: 0.477 Test Loss: 2.080 Test Acc: 0.477
Validation loss decreased (-0.473313 --> -0.476646).  Saving model ...
Epoch: 27 cost time: 7.401522397994995
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.074 Vali Acc: 0.477 Test Loss: 2.074 Test Acc: 0.477
Validation loss decreased (-0.476646 --> -0.476646).  Saving model ...
Epoch: 28 cost time: 6.687203407287598
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.068 Vali Acc: 0.480 Test Loss: 2.068 Test Acc: 0.480
Validation loss decreased (-0.476646 --> -0.479979).  Saving model ...
Epoch: 29 cost time: 6.3892576694488525
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.062 Vali Acc: 0.480 Test Loss: 2.062 Test Acc: 0.480
Validation loss decreased (-0.479979 --> -0.479979).  Saving model ...
Epoch: 30 cost time: 7.247642278671265
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.058 Vali Acc: 0.490 Test Loss: 2.058 Test Acc: 0.490
Validation loss decreased (-0.479979 --> -0.489979).  Saving model ...
Epoch: 31 cost time: 6.944504976272583
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.058 Vali Acc: 0.487 Test Loss: 2.058 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.400774717330933
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.055 Vali Acc: 0.487 Test Loss: 2.055 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.980158090591431
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.053 Vali Acc: 0.497 Test Loss: 2.053 Test Acc: 0.497
Validation loss decreased (-0.489979 --> -0.496646).  Saving model ...
Epoch: 34 cost time: 6.897432804107666
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.047 Vali Acc: 0.493 Test Loss: 2.047 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.584317445755005
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.046 Vali Acc: 0.497 Test Loss: 2.046 Test Acc: 0.497
Validation loss decreased (-0.496646 --> -0.496646).  Saving model ...
Epoch: 36 cost time: 6.879568338394165
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.042 Vali Acc: 0.497 Test Loss: 2.042 Test Acc: 0.497
Validation loss decreased (-0.496646 --> -0.496646).  Saving model ...
Epoch: 37 cost time: 6.596312999725342
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.037 Vali Acc: 0.513 Test Loss: 2.037 Test Acc: 0.513
Validation loss decreased (-0.496646 --> -0.513313).  Saving model ...
Epoch: 38 cost time: 5.911461353302002
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.032 Vali Acc: 0.527 Test Loss: 2.032 Test Acc: 0.527
Validation loss decreased (-0.513313 --> -0.526646).  Saving model ...
Epoch: 39 cost time: 6.941747665405273
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.030 Vali Acc: 0.520 Test Loss: 2.030 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.73113226890564
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.025 Vali Acc: 0.523 Test Loss: 2.025 Test Acc: 0.523
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.2492499351501465
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.022 Vali Acc: 0.523 Test Loss: 2.022 Test Acc: 0.523
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 7.013777017593384
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.021 Vali Acc: 0.523 Test Loss: 2.021 Test Acc: 0.523
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 6.834368467330933
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.020 Vali Acc: 0.523 Test Loss: 2.020 Test Acc: 0.523
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 7.218627214431763
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.018 Vali Acc: 0.533 Test Loss: 2.018 Test Acc: 0.533
Validation loss decreased (-0.526646 --> -0.533313).  Saving model ...
Epoch: 45 cost time: 6.474130868911743
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.013 Vali Acc: 0.537 Test Loss: 2.013 Test Acc: 0.537
Validation loss decreased (-0.533313 --> -0.536647).  Saving model ...
Epoch: 46 cost time: 6.271888494491577
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.010 Vali Acc: 0.537 Test Loss: 2.010 Test Acc: 0.537
Validation loss decreased (-0.536647 --> -0.536647).  Saving model ...
Epoch: 47 cost time: 6.347535133361816
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.007 Vali Acc: 0.543 Test Loss: 2.007 Test Acc: 0.543
Validation loss decreased (-0.536647 --> -0.543313).  Saving model ...
Epoch: 48 cost time: 7.388803720474243
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.004 Vali Acc: 0.540 Test Loss: 2.004 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 7.076376676559448
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.005 Vali Acc: 0.533 Test Loss: 2.005 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 6.285525798797607
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.003 Vali Acc: 0.533 Test Loss: 2.003 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.052366256713867
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.000 Vali Acc: 0.537 Test Loss: 2.000 Test Acc: 0.537
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 6.495508909225464
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.996 Vali Acc: 0.537 Test Loss: 1.996 Test Acc: 0.537
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 6.747392416000366
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.995 Vali Acc: 0.540 Test Loss: 1.995 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 6.462208271026611
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.995 Vali Acc: 0.540 Test Loss: 1.995 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 5.989718675613403
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.993 Vali Acc: 0.540 Test Loss: 1.993 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 7.109896183013916
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.994 Vali Acc: 0.550 Test Loss: 1.994 Test Acc: 0.550
Validation loss decreased (-0.543313 --> -0.549980).  Saving model ...
Epoch: 57 cost time: 7.117915868759155
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.993 Vali Acc: 0.543 Test Loss: 1.993 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.803327322006226
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.993 Vali Acc: 0.543 Test Loss: 1.993 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 6.941164016723633
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.993 Vali Acc: 0.543 Test Loss: 1.993 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 6.7840235233306885
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.991 Vali Acc: 0.543 Test Loss: 1.991 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 6.89100456237793
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.989 Vali Acc: 0.543 Test Loss: 1.989 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 6.506861925125122
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.986 Vali Acc: 0.540 Test Loss: 1.986 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 6.905952453613281
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.983 Vali Acc: 0.543 Test Loss: 1.983 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 6.43062949180603
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.981 Vali Acc: 0.547 Test Loss: 1.981 Test Acc: 0.547
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 6.670585870742798
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.981 Vali Acc: 0.543 Test Loss: 1.981 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 6.683523416519165
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.979 Vali Acc: 0.550 Test Loss: 1.979 Test Acc: 0.550
Validation loss decreased (-0.549980 --> -0.549980).  Saving model ...
Epoch: 67 cost time: 6.669703483581543
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.978 Vali Acc: 0.550 Test Loss: 1.978 Test Acc: 0.550
Validation loss decreased (-0.549980 --> -0.549980).  Saving model ...
Epoch: 68 cost time: 6.909456014633179
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.977 Vali Acc: 0.550 Test Loss: 1.977 Test Acc: 0.550
Validation loss decreased (-0.549980 --> -0.549980).  Saving model ...
Epoch: 69 cost time: 6.618265390396118
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.978 Vali Acc: 0.547 Test Loss: 1.978 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 6.500154256820679
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.976 Vali Acc: 0.550 Test Loss: 1.976 Test Acc: 0.550
Validation loss decreased (-0.549980 --> -0.549980).  Saving model ...
Epoch: 71 cost time: 7.298258066177368
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.974 Vali Acc: 0.553 Test Loss: 1.974 Test Acc: 0.553
Validation loss decreased (-0.549980 --> -0.553314).  Saving model ...
Epoch: 72 cost time: 7.199268579483032
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.553 Test Loss: 1.973 Test Acc: 0.553
Validation loss decreased (-0.553314 --> -0.553314).  Saving model ...
Epoch: 73 cost time: 6.71722149848938
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.972 Vali Acc: 0.553 Test Loss: 1.972 Test Acc: 0.553
Validation loss decreased (-0.553314 --> -0.553314).  Saving model ...
Epoch: 74 cost time: 6.359182357788086
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.971 Vali Acc: 0.553 Test Loss: 1.971 Test Acc: 0.553
Validation loss decreased (-0.553314 --> -0.553314).  Saving model ...
Epoch: 75 cost time: 5.841564893722534
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.972 Vali Acc: 0.553 Test Loss: 1.972 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 6.913761377334595
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.971 Vali Acc: 0.557 Test Loss: 1.971 Test Acc: 0.557
Validation loss decreased (-0.553314 --> -0.556647).  Saving model ...
Epoch: 77 cost time: 6.279268026351929
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.968 Vali Acc: 0.557 Test Loss: 1.968 Test Acc: 0.557
Validation loss decreased (-0.556647 --> -0.556647).  Saving model ...
Epoch: 78 cost time: 6.099732160568237
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.968 Vali Acc: 0.557 Test Loss: 1.968 Test Acc: 0.557
Validation loss decreased (-0.556647 --> -0.556647).  Saving model ...
Epoch: 79 cost time: 7.083212375640869
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.553 Test Loss: 1.967 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 6.63311767578125
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.966 Vali Acc: 0.553 Test Loss: 1.966 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 6.60806941986084
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.966 Vali Acc: 0.557 Test Loss: 1.966 Test Acc: 0.557
Validation loss decreased (-0.556647 --> -0.556647).  Saving model ...
Epoch: 82 cost time: 6.479229211807251
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.965 Vali Acc: 0.557 Test Loss: 1.965 Test Acc: 0.557
Validation loss decreased (-0.556647 --> -0.556647).  Saving model ...
Epoch: 83 cost time: 6.814881324768066
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.965 Vali Acc: 0.557 Test Loss: 1.965 Test Acc: 0.557
Validation loss decreased (-0.556647 --> -0.556647).  Saving model ...
Epoch: 84 cost time: 6.76923680305481
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.963 Vali Acc: 0.557 Test Loss: 1.963 Test Acc: 0.557
Validation loss decreased (-0.556647 --> -0.556647).  Saving model ...
Epoch: 85 cost time: 6.854458808898926
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.962 Vali Acc: 0.557 Test Loss: 1.962 Test Acc: 0.557
Validation loss decreased (-0.556647 --> -0.556647).  Saving model ...
Epoch: 86 cost time: 7.0968523025512695
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.961 Vali Acc: 0.557 Test Loss: 1.961 Test Acc: 0.557
Validation loss decreased (-0.556647 --> -0.556647).  Saving model ...
Epoch: 87 cost time: 6.874013423919678
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.961 Vali Acc: 0.557 Test Loss: 1.961 Test Acc: 0.557
Validation loss decreased (-0.556647 --> -0.556647).  Saving model ...
Epoch: 88 cost time: 7.299833536148071
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.960 Vali Acc: 0.557 Test Loss: 1.960 Test Acc: 0.557
Validation loss decreased (-0.556647 --> -0.556647).  Saving model ...
Epoch: 89 cost time: 7.403174877166748
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.960 Vali Acc: 0.557 Test Loss: 1.960 Test Acc: 0.557
Validation loss decreased (-0.556647 --> -0.556647).  Saving model ...
Epoch: 90 cost time: 6.81338095664978
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.960 Vali Acc: 0.553 Test Loss: 1.960 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 6.571127414703369
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.959 Vali Acc: 0.557 Test Loss: 1.959 Test Acc: 0.557
Validation loss decreased (-0.556647 --> -0.556647).  Saving model ...
Epoch: 92 cost time: 7.2219343185424805
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.958 Vali Acc: 0.560 Test Loss: 1.958 Test Acc: 0.560
Validation loss decreased (-0.556647 --> -0.559980).  Saving model ...
Epoch: 93 cost time: 7.178711652755737
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.560 Test Loss: 1.956 Test Acc: 0.560
Validation loss decreased (-0.559980 --> -0.559980).  Saving model ...
Epoch: 94 cost time: 7.0178258419036865
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.560 Test Loss: 1.956 Test Acc: 0.560
Validation loss decreased (-0.559980 --> -0.559980).  Saving model ...
Epoch: 95 cost time: 6.979960680007935
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.560 Test Loss: 1.956 Test Acc: 0.560
Validation loss decreased (-0.559980 --> -0.559980).  Saving model ...
Epoch: 96 cost time: 7.179152488708496
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.954 Vali Acc: 0.563 Test Loss: 1.954 Test Acc: 0.563
Validation loss decreased (-0.559980 --> -0.563314).  Saving model ...
Epoch: 97 cost time: 6.988181114196777
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.953 Vali Acc: 0.563 Test Loss: 1.953 Test Acc: 0.563
Validation loss decreased (-0.563314 --> -0.563314).  Saving model ...
Epoch: 98 cost time: 6.374387979507446
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.563 Test Loss: 1.956 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 6.381797552108765
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.954 Vali Acc: 0.563 Test Loss: 1.954 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 6.267551422119141
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.953 Vali Acc: 0.563 Test Loss: 1.953 Test Acc: 0.563
Validation loss decreased (-0.563314 --> -0.563314).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5633333333333334
model parameter : 18659353
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.866432428359985
Epoch: 1, Steps: 18 | Train Loss: 3.268 Vali Loss: 3.096 Vali Acc: 0.127 Test Loss: 3.096 Test Acc: 0.127
Validation loss decreased (inf --> -0.126636).  Saving model ...
Epoch: 2 cost time: 6.287752866744995
Epoch: 2, Steps: 18 | Train Loss: 1.527 Vali Loss: 2.972 Vali Acc: 0.127 Test Loss: 2.972 Test Acc: 0.127
Validation loss decreased (-0.126636 --> -0.126637).  Saving model ...
Epoch: 3 cost time: 6.247670888900757
Epoch: 3, Steps: 18 | Train Loss: 0.234 Vali Loss: 2.878 Vali Acc: 0.203 Test Loss: 2.878 Test Acc: 0.203
Validation loss decreased (-0.126637 --> -0.203305).  Saving model ...
Epoch: 4 cost time: 6.100566148757935
Epoch: 4, Steps: 18 | Train Loss: 0.024 Vali Loss: 3.012 Vali Acc: 0.240 Test Loss: 3.012 Test Acc: 0.240
Validation loss decreased (-0.203305 --> -0.239970).  Saving model ...
Epoch: 5 cost time: 6.401768684387207
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.825 Vali Acc: 0.277 Test Loss: 2.825 Test Acc: 0.277
Validation loss decreased (-0.239970 --> -0.276638).  Saving model ...
Epoch: 6 cost time: 6.295259475708008
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.638 Vali Acc: 0.300 Test Loss: 2.638 Test Acc: 0.300
Validation loss decreased (-0.276638 --> -0.299974).  Saving model ...
Epoch: 7 cost time: 6.317227840423584
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.619 Vali Acc: 0.303 Test Loss: 2.619 Test Acc: 0.303
Validation loss decreased (-0.299974 --> -0.303307).  Saving model ...
Epoch: 8 cost time: 6.690322160720825
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.516 Vali Acc: 0.310 Test Loss: 2.516 Test Acc: 0.310
Validation loss decreased (-0.303307 --> -0.309975).  Saving model ...
Epoch: 9 cost time: 6.569268226623535
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.437 Vali Acc: 0.333 Test Loss: 2.437 Test Acc: 0.333
Validation loss decreased (-0.309975 --> -0.333309).  Saving model ...
Epoch: 10 cost time: 6.4242894649505615
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.380 Vali Acc: 0.353 Test Loss: 2.380 Test Acc: 0.353
Validation loss decreased (-0.333309 --> -0.353310).  Saving model ...
Epoch: 11 cost time: 6.198124170303345
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.338 Vali Acc: 0.370 Test Loss: 2.338 Test Acc: 0.370
Validation loss decreased (-0.353310 --> -0.369977).  Saving model ...
Epoch: 12 cost time: 6.547260761260986
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.310 Vali Acc: 0.390 Test Loss: 2.310 Test Acc: 0.390
Validation loss decreased (-0.369977 --> -0.389977).  Saving model ...
Epoch: 13 cost time: 6.779088735580444
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.284 Vali Acc: 0.400 Test Loss: 2.284 Test Acc: 0.400
Validation loss decreased (-0.389977 --> -0.399977).  Saving model ...
Epoch: 14 cost time: 7.109175443649292
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.265 Vali Acc: 0.400 Test Loss: 2.265 Test Acc: 0.400
Validation loss decreased (-0.399977 --> -0.399977).  Saving model ...
Epoch: 15 cost time: 6.982432842254639
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.235 Vali Acc: 0.430 Test Loss: 2.235 Test Acc: 0.430
Validation loss decreased (-0.399977 --> -0.429978).  Saving model ...
Epoch: 16 cost time: 6.555771589279175
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.233 Vali Acc: 0.417 Test Loss: 2.233 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.052724838256836
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.215 Vali Acc: 0.430 Test Loss: 2.215 Test Acc: 0.430
Validation loss decreased (-0.429978 --> -0.429978).  Saving model ...
Epoch: 18 cost time: 6.249406337738037
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.198 Vali Acc: 0.437 Test Loss: 2.198 Test Acc: 0.437
Validation loss decreased (-0.429978 --> -0.436645).  Saving model ...
Epoch: 19 cost time: 6.594620704650879
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.175 Vali Acc: 0.443 Test Loss: 2.175 Test Acc: 0.443
Validation loss decreased (-0.436645 --> -0.443312).  Saving model ...
Epoch: 20 cost time: 6.081075191497803
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.161 Vali Acc: 0.453 Test Loss: 2.161 Test Acc: 0.453
Validation loss decreased (-0.443312 --> -0.453312).  Saving model ...
Epoch: 21 cost time: 6.300756216049194
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.149 Vali Acc: 0.443 Test Loss: 2.149 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.7295520305633545
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.136 Vali Acc: 0.457 Test Loss: 2.136 Test Acc: 0.457
Validation loss decreased (-0.453312 --> -0.456645).  Saving model ...
Epoch: 23 cost time: 6.930777549743652
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.123 Vali Acc: 0.460 Test Loss: 2.123 Test Acc: 0.460
Validation loss decreased (-0.456645 --> -0.459979).  Saving model ...
Epoch: 24 cost time: 6.162329435348511
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.107 Vali Acc: 0.467 Test Loss: 2.107 Test Acc: 0.467
Validation loss decreased (-0.459979 --> -0.466646).  Saving model ...
Epoch: 25 cost time: 6.416391372680664
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.088 Vali Acc: 0.473 Test Loss: 2.088 Test Acc: 0.473
Validation loss decreased (-0.466646 --> -0.473312).  Saving model ...
Epoch: 26 cost time: 6.9219279289245605
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.081 Vali Acc: 0.467 Test Loss: 2.081 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.09173583984375
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.069 Vali Acc: 0.470 Test Loss: 2.069 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.155980110168457
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.058 Vali Acc: 0.477 Test Loss: 2.058 Test Acc: 0.477
Validation loss decreased (-0.473312 --> -0.476646).  Saving model ...
Epoch: 29 cost time: 6.655780553817749
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.047 Vali Acc: 0.490 Test Loss: 2.047 Test Acc: 0.490
Validation loss decreased (-0.476646 --> -0.489980).  Saving model ...
Epoch: 30 cost time: 6.730993032455444
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.038 Vali Acc: 0.493 Test Loss: 2.038 Test Acc: 0.493
Validation loss decreased (-0.489980 --> -0.493313).  Saving model ...
Epoch: 31 cost time: 6.833820581436157
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.030 Vali Acc: 0.507 Test Loss: 2.030 Test Acc: 0.507
Validation loss decreased (-0.493313 --> -0.506646).  Saving model ...
Epoch: 32 cost time: 6.8430845737457275
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.018 Vali Acc: 0.503 Test Loss: 2.018 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.097914218902588
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.010 Vali Acc: 0.510 Test Loss: 2.010 Test Acc: 0.510
Validation loss decreased (-0.506646 --> -0.509980).  Saving model ...
Epoch: 34 cost time: 6.293071985244751
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.999 Vali Acc: 0.513 Test Loss: 1.999 Test Acc: 0.513
Validation loss decreased (-0.509980 --> -0.513313).  Saving model ...
Epoch: 35 cost time: 6.4202516078948975
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.990 Vali Acc: 0.513 Test Loss: 1.990 Test Acc: 0.513
Validation loss decreased (-0.513313 --> -0.513313).  Saving model ...
Epoch: 36 cost time: 6.201746940612793
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.989 Vali Acc: 0.510 Test Loss: 1.989 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.157356023788452
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.984 Vali Acc: 0.513 Test Loss: 1.984 Test Acc: 0.513
Validation loss decreased (-0.513313 --> -0.513313).  Saving model ...
Epoch: 38 cost time: 6.715534925460815
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.972 Vali Acc: 0.517 Test Loss: 1.972 Test Acc: 0.517
Validation loss decreased (-0.513313 --> -0.516647).  Saving model ...
Epoch: 39 cost time: 6.754067897796631
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.971 Vali Acc: 0.517 Test Loss: 1.971 Test Acc: 0.517
Validation loss decreased (-0.516647 --> -0.516647).  Saving model ...
Epoch: 40 cost time: 6.6185548305511475
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.965 Vali Acc: 0.517 Test Loss: 1.965 Test Acc: 0.517
Validation loss decreased (-0.516647 --> -0.516647).  Saving model ...
Epoch: 41 cost time: 6.632706880569458
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.960 Vali Acc: 0.517 Test Loss: 1.960 Test Acc: 0.517
Validation loss decreased (-0.516647 --> -0.516647).  Saving model ...
Epoch: 42 cost time: 6.3134729862213135
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.958 Vali Acc: 0.517 Test Loss: 1.958 Test Acc: 0.517
Validation loss decreased (-0.516647 --> -0.516647).  Saving model ...
Epoch: 43 cost time: 6.538534641265869
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.953 Vali Acc: 0.517 Test Loss: 1.953 Test Acc: 0.517
Validation loss decreased (-0.516647 --> -0.516647).  Saving model ...
Epoch: 44 cost time: 6.632571220397949
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.948 Vali Acc: 0.517 Test Loss: 1.948 Test Acc: 0.517
Validation loss decreased (-0.516647 --> -0.516647).  Saving model ...
Epoch: 45 cost time: 6.057948112487793
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.941 Vali Acc: 0.517 Test Loss: 1.941 Test Acc: 0.517
Validation loss decreased (-0.516647 --> -0.516647).  Saving model ...
Epoch: 46 cost time: 6.1451966762542725
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.942 Vali Acc: 0.517 Test Loss: 1.942 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.004843235015869
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.937 Vali Acc: 0.517 Test Loss: 1.937 Test Acc: 0.517
Validation loss decreased (-0.516647 --> -0.516647).  Saving model ...
Epoch: 48 cost time: 6.57737922668457
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.933 Vali Acc: 0.520 Test Loss: 1.933 Test Acc: 0.520
Validation loss decreased (-0.516647 --> -0.519981).  Saving model ...
Epoch: 49 cost time: 6.5153772830963135
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.932 Vali Acc: 0.513 Test Loss: 1.932 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.561161279678345
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.924 Vali Acc: 0.513 Test Loss: 1.924 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 6.028725862503052
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.916 Vali Acc: 0.513 Test Loss: 1.916 Test Acc: 0.513
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 6.745033502578735
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.910 Vali Acc: 0.517 Test Loss: 1.910 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 6.537238359451294
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.905 Vali Acc: 0.520 Test Loss: 1.905 Test Acc: 0.520
Validation loss decreased (-0.519981 --> -0.519981).  Saving model ...
Epoch: 54 cost time: 6.657758712768555
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.904 Vali Acc: 0.520 Test Loss: 1.904 Test Acc: 0.520
Validation loss decreased (-0.519981 --> -0.519981).  Saving model ...
Epoch: 55 cost time: 6.3259947299957275
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.900 Vali Acc: 0.527 Test Loss: 1.900 Test Acc: 0.527
Validation loss decreased (-0.519981 --> -0.526648).  Saving model ...
Epoch: 56 cost time: 6.976490020751953
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.896 Vali Acc: 0.523 Test Loss: 1.896 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.4995646476745605
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.890 Vali Acc: 0.527 Test Loss: 1.890 Test Acc: 0.527
Validation loss decreased (-0.526648 --> -0.526648).  Saving model ...
Epoch: 58 cost time: 6.395658016204834
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.888 Vali Acc: 0.527 Test Loss: 1.888 Test Acc: 0.527
Validation loss decreased (-0.526648 --> -0.526648).  Saving model ...
Epoch: 59 cost time: 6.4358038902282715
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.887 Vali Acc: 0.537 Test Loss: 1.887 Test Acc: 0.537
Validation loss decreased (-0.526648 --> -0.536648).  Saving model ...
Epoch: 60 cost time: 6.236125230789185
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.884 Vali Acc: 0.537 Test Loss: 1.884 Test Acc: 0.537
Validation loss decreased (-0.536648 --> -0.536648).  Saving model ...
Epoch: 61 cost time: 6.417979955673218
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.880 Vali Acc: 0.540 Test Loss: 1.880 Test Acc: 0.540
Validation loss decreased (-0.536648 --> -0.539981).  Saving model ...
Epoch: 62 cost time: 6.095130920410156
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.875 Vali Acc: 0.547 Test Loss: 1.875 Test Acc: 0.547
Validation loss decreased (-0.539981 --> -0.546648).  Saving model ...
Epoch: 63 cost time: 6.828922271728516
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.874 Vali Acc: 0.550 Test Loss: 1.874 Test Acc: 0.550
Validation loss decreased (-0.546648 --> -0.549981).  Saving model ...
Epoch: 64 cost time: 6.481586933135986
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.550 Test Loss: 1.871 Test Acc: 0.550
Validation loss decreased (-0.549981 --> -0.549981).  Saving model ...
Epoch: 65 cost time: 6.519582509994507
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.869 Vali Acc: 0.553 Test Loss: 1.869 Test Acc: 0.553
Validation loss decreased (-0.549981 --> -0.553315).  Saving model ...
Epoch: 66 cost time: 6.47925329208374
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.869 Vali Acc: 0.553 Test Loss: 1.869 Test Acc: 0.553
Validation loss decreased (-0.553315 --> -0.553315).  Saving model ...
Epoch: 67 cost time: 6.053372383117676
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.866 Vali Acc: 0.557 Test Loss: 1.866 Test Acc: 0.557
Validation loss decreased (-0.553315 --> -0.556648).  Saving model ...
Epoch: 68 cost time: 6.006327867507935
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.863 Vali Acc: 0.557 Test Loss: 1.863 Test Acc: 0.557
Validation loss decreased (-0.556648 --> -0.556648).  Saving model ...
Epoch: 69 cost time: 6.534568548202515
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.861 Vali Acc: 0.557 Test Loss: 1.861 Test Acc: 0.557
Validation loss decreased (-0.556648 --> -0.556648).  Saving model ...
Epoch: 70 cost time: 7.00538444519043
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.857 Vali Acc: 0.560 Test Loss: 1.857 Test Acc: 0.560
Validation loss decreased (-0.556648 --> -0.559981).  Saving model ...
Epoch: 71 cost time: 6.501502752304077
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.856 Vali Acc: 0.560 Test Loss: 1.856 Test Acc: 0.560
Validation loss decreased (-0.559981 --> -0.559981).  Saving model ...
Epoch: 72 cost time: 6.399929761886597
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.560 Test Loss: 1.853 Test Acc: 0.560
Validation loss decreased (-0.559981 --> -0.559981).  Saving model ...
Epoch: 73 cost time: 6.283364772796631
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.852 Vali Acc: 0.557 Test Loss: 1.852 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 6.732831239700317
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.847 Vali Acc: 0.557 Test Loss: 1.847 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 6.879848003387451
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.845 Vali Acc: 0.557 Test Loss: 1.845 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 6.283430099487305
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.844 Vali Acc: 0.557 Test Loss: 1.844 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 6.57062029838562
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.841 Vali Acc: 0.557 Test Loss: 1.841 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 6.369705438613892
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.839 Vali Acc: 0.557 Test Loss: 1.839 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 6.651687145233154
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.557 Test Loss: 1.835 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 6.549371957778931
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.553 Test Loss: 1.833 Test Acc: 0.553
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 6.711423397064209
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.557 Test Loss: 1.833 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 6.721467018127441
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.831 Vali Acc: 0.560 Test Loss: 1.831 Test Acc: 0.560
Validation loss decreased (-0.559981 --> -0.559982).  Saving model ...
Epoch: 83 cost time: 6.317793607711792
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.560 Test Loss: 1.829 Test Acc: 0.560
Validation loss decreased (-0.559982 --> -0.559982).  Saving model ...
Epoch: 84 cost time: 5.745314121246338
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.828 Vali Acc: 0.563 Test Loss: 1.828 Test Acc: 0.563
Validation loss decreased (-0.559982 --> -0.563315).  Saving model ...
Epoch: 85 cost time: 6.18213677406311
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.563 Test Loss: 1.827 Test Acc: 0.563
Validation loss decreased (-0.563315 --> -0.563315).  Saving model ...
Epoch: 86 cost time: 6.061853885650635
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.567 Test Loss: 1.825 Test Acc: 0.567
Validation loss decreased (-0.563315 --> -0.566648).  Saving model ...
Epoch: 87 cost time: 6.230824947357178
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.567 Test Loss: 1.824 Test Acc: 0.567
Validation loss decreased (-0.566648 --> -0.566648).  Saving model ...
Epoch: 88 cost time: 6.613443374633789
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.567 Test Loss: 1.822 Test Acc: 0.567
Validation loss decreased (-0.566648 --> -0.566648).  Saving model ...
Epoch: 89 cost time: 6.699562311172485
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.819 Vali Acc: 0.573 Test Loss: 1.819 Test Acc: 0.573
Validation loss decreased (-0.566648 --> -0.573315).  Saving model ...
Epoch: 90 cost time: 6.554744005203247
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.819 Vali Acc: 0.573 Test Loss: 1.819 Test Acc: 0.573
Validation loss decreased (-0.573315 --> -0.573315).  Saving model ...
Epoch: 91 cost time: 6.5498316287994385
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.573 Test Loss: 1.818 Test Acc: 0.573
Validation loss decreased (-0.573315 --> -0.573315).  Saving model ...
Epoch: 92 cost time: 6.275248765945435
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.814 Vali Acc: 0.577 Test Loss: 1.814 Test Acc: 0.577
Validation loss decreased (-0.573315 --> -0.576649).  Saving model ...
Epoch: 93 cost time: 6.036165952682495
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.814 Vali Acc: 0.577 Test Loss: 1.814 Test Acc: 0.577
Validation loss decreased (-0.576649 --> -0.576649).  Saving model ...
Epoch: 94 cost time: 6.371721506118774
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.814 Vali Acc: 0.577 Test Loss: 1.814 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 6.264434576034546
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.809 Vali Acc: 0.577 Test Loss: 1.809 Test Acc: 0.577
Validation loss decreased (-0.576649 --> -0.576649).  Saving model ...
Epoch: 96 cost time: 6.325673341751099
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.807 Vali Acc: 0.580 Test Loss: 1.807 Test Acc: 0.580
Validation loss decreased (-0.576649 --> -0.579982).  Saving model ...
Epoch: 97 cost time: 5.961717367172241
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.807 Vali Acc: 0.583 Test Loss: 1.807 Test Acc: 0.583
Validation loss decreased (-0.579982 --> -0.583315).  Saving model ...
Epoch: 98 cost time: 6.36639404296875
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.806 Vali Acc: 0.587 Test Loss: 1.806 Test Acc: 0.587
Validation loss decreased (-0.583315 --> -0.586649).  Saving model ...
Epoch: 99 cost time: 6.119603872299194
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.590 Test Loss: 1.805 Test Acc: 0.590
Validation loss decreased (-0.586649 --> -0.589982).  Saving model ...
Epoch: 100 cost time: 6.363234996795654
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.583 Test Loss: 1.803 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.59
model parameter : 18659353
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.910284996032715
Epoch: 1, Steps: 18 | Train Loss: 3.263 Vali Loss: 3.082 Vali Acc: 0.093 Test Loss: 3.082 Test Acc: 0.093
Validation loss decreased (inf --> -0.093303).  Saving model ...
Epoch: 2 cost time: 6.234634876251221
Epoch: 2, Steps: 18 | Train Loss: 1.735 Vali Loss: 2.827 Vali Acc: 0.157 Test Loss: 2.827 Test Acc: 0.157
Validation loss decreased (-0.093303 --> -0.156638).  Saving model ...
Epoch: 3 cost time: 6.314872741699219
Epoch: 3, Steps: 18 | Train Loss: 0.373 Vali Loss: 2.652 Vali Acc: 0.250 Test Loss: 2.652 Test Acc: 0.250
Validation loss decreased (-0.156638 --> -0.249973).  Saving model ...
Epoch: 4 cost time: 6.763723611831665
Epoch: 4, Steps: 18 | Train Loss: 0.050 Vali Loss: 2.774 Vali Acc: 0.260 Test Loss: 2.774 Test Acc: 0.260
Validation loss decreased (-0.249973 --> -0.259972).  Saving model ...
Epoch: 5 cost time: 6.327450275421143
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.326 Vali Acc: 0.363 Test Loss: 2.326 Test Acc: 0.363
Validation loss decreased (-0.259972 --> -0.363310).  Saving model ...
Epoch: 6 cost time: 6.216728687286377
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.282 Vali Acc: 0.410 Test Loss: 2.282 Test Acc: 0.410
Validation loss decreased (-0.363310 --> -0.409977).  Saving model ...
Epoch: 7 cost time: 6.5064826011657715
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.180 Vali Acc: 0.433 Test Loss: 2.180 Test Acc: 0.433
Validation loss decreased (-0.409977 --> -0.433312).  Saving model ...
Epoch: 8 cost time: 6.422943115234375
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.084 Vali Acc: 0.433 Test Loss: 2.084 Test Acc: 0.433
Validation loss decreased (-0.433312 --> -0.433312).  Saving model ...
Epoch: 9 cost time: 6.228142499923706
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.053 Vali Acc: 0.457 Test Loss: 2.053 Test Acc: 0.457
Validation loss decreased (-0.433312 --> -0.456646).  Saving model ...
Epoch: 10 cost time: 6.342596769332886
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.027 Vali Acc: 0.467 Test Loss: 2.027 Test Acc: 0.467
Validation loss decreased (-0.456646 --> -0.466646).  Saving model ...
Epoch: 11 cost time: 6.53708291053772
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.008 Vali Acc: 0.457 Test Loss: 2.008 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.567633628845215
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.977 Vali Acc: 0.473 Test Loss: 1.977 Test Acc: 0.473
Validation loss decreased (-0.466646 --> -0.473314).  Saving model ...
Epoch: 13 cost time: 6.413932800292969
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.955 Vali Acc: 0.477 Test Loss: 1.955 Test Acc: 0.477
Validation loss decreased (-0.473314 --> -0.476647).  Saving model ...
Epoch: 14 cost time: 6.3660054206848145
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.929 Vali Acc: 0.497 Test Loss: 1.929 Test Acc: 0.497
Validation loss decreased (-0.476647 --> -0.496647).  Saving model ...
Epoch: 15 cost time: 6.428455829620361
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.490 Test Loss: 1.901 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.133264780044556
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.888 Vali Acc: 0.503 Test Loss: 1.888 Test Acc: 0.503
Validation loss decreased (-0.496647 --> -0.503314).  Saving model ...
Epoch: 17 cost time: 6.368703126907349
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.880 Vali Acc: 0.513 Test Loss: 1.880 Test Acc: 0.513
Validation loss decreased (-0.503314 --> -0.513315).  Saving model ...
Epoch: 18 cost time: 6.045205116271973
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.865 Vali Acc: 0.510 Test Loss: 1.865 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.904962539672852
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.850 Vali Acc: 0.520 Test Loss: 1.850 Test Acc: 0.520
Validation loss decreased (-0.513315 --> -0.519982).  Saving model ...
Epoch: 20 cost time: 6.411169528961182
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.847 Vali Acc: 0.527 Test Loss: 1.847 Test Acc: 0.527
Validation loss decreased (-0.519982 --> -0.526648).  Saving model ...
Epoch: 21 cost time: 6.2246153354644775
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.832 Vali Acc: 0.537 Test Loss: 1.832 Test Acc: 0.537
Validation loss decreased (-0.526648 --> -0.536648).  Saving model ...
Epoch: 22 cost time: 5.72670316696167
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.814 Vali Acc: 0.540 Test Loss: 1.814 Test Acc: 0.540
Validation loss decreased (-0.536648 --> -0.539982).  Saving model ...
Epoch: 23 cost time: 5.716305494308472
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.797 Vali Acc: 0.557 Test Loss: 1.797 Test Acc: 0.557
Validation loss decreased (-0.539982 --> -0.556649).  Saving model ...
Epoch: 24 cost time: 6.007220268249512
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.787 Vali Acc: 0.557 Test Loss: 1.787 Test Acc: 0.557
Validation loss decreased (-0.556649 --> -0.556649).  Saving model ...
Epoch: 25 cost time: 6.766956090927124
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.780 Vali Acc: 0.550 Test Loss: 1.780 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.445605993270874
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.765 Vali Acc: 0.550 Test Loss: 1.765 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.179614305496216
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.560 Test Loss: 1.749 Test Acc: 0.560
Validation loss decreased (-0.556649 --> -0.559983).  Saving model ...
Epoch: 28 cost time: 6.452189207077026
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.738 Vali Acc: 0.567 Test Loss: 1.738 Test Acc: 0.567
Validation loss decreased (-0.559983 --> -0.566649).  Saving model ...
Epoch: 29 cost time: 6.440251111984253
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.735 Vali Acc: 0.570 Test Loss: 1.735 Test Acc: 0.570
Validation loss decreased (-0.566649 --> -0.569983).  Saving model ...
Epoch: 30 cost time: 6.602858781814575
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.567 Test Loss: 1.727 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.012894630432129
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.723 Vali Acc: 0.567 Test Loss: 1.723 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.932634115219116
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.567 Test Loss: 1.717 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.191271066665649
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.563 Test Loss: 1.717 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 6.139989614486694
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.710 Vali Acc: 0.567 Test Loss: 1.710 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 6.396421194076538
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.702 Vali Acc: 0.573 Test Loss: 1.702 Test Acc: 0.573
Validation loss decreased (-0.569983 --> -0.573316).  Saving model ...
Epoch: 36 cost time: 6.037572145462036
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.580 Test Loss: 1.706 Test Acc: 0.580
Validation loss decreased (-0.573316 --> -0.579983).  Saving model ...
Epoch: 37 cost time: 6.43045449256897
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.705 Vali Acc: 0.587 Test Loss: 1.705 Test Acc: 0.587
Validation loss decreased (-0.579983 --> -0.586650).  Saving model ...
Epoch: 38 cost time: 6.109211444854736
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.701 Vali Acc: 0.590 Test Loss: 1.701 Test Acc: 0.590
Validation loss decreased (-0.586650 --> -0.589983).  Saving model ...
Epoch: 39 cost time: 5.849818706512451
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.590 Test Loss: 1.697 Test Acc: 0.590
Validation loss decreased (-0.589983 --> -0.589983).  Saving model ...
Epoch: 40 cost time: 6.266797065734863
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.694 Vali Acc: 0.587 Test Loss: 1.694 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.926052570343018
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.688 Vali Acc: 0.580 Test Loss: 1.688 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.654321908950806
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.681 Vali Acc: 0.587 Test Loss: 1.681 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.591402292251587
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.674 Vali Acc: 0.593 Test Loss: 1.674 Test Acc: 0.593
Validation loss decreased (-0.589983 --> -0.593317).  Saving model ...
Epoch: 44 cost time: 6.161359071731567
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.672 Vali Acc: 0.587 Test Loss: 1.672 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 6.499166011810303
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.583 Test Loss: 1.669 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 6.518735885620117
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.663 Vali Acc: 0.587 Test Loss: 1.663 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 6.335818290710449
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.655 Vali Acc: 0.587 Test Loss: 1.655 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 6.37685751914978
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.653 Vali Acc: 0.590 Test Loss: 1.653 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 6.145676374435425
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.655 Vali Acc: 0.593 Test Loss: 1.655 Test Acc: 0.593
Validation loss decreased (-0.593317 --> -0.593317).  Saving model ...
Epoch: 50 cost time: 6.268939971923828
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.654 Vali Acc: 0.603 Test Loss: 1.654 Test Acc: 0.603
Validation loss decreased (-0.593317 --> -0.603317).  Saving model ...
Epoch: 51 cost time: 6.152034521102905
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.649 Vali Acc: 0.600 Test Loss: 1.649 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.682025671005249
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.607 Test Loss: 1.640 Test Acc: 0.607
Validation loss decreased (-0.603317 --> -0.606650).  Saving model ...
Epoch: 53 cost time: 6.867374420166016
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.610 Test Loss: 1.633 Test Acc: 0.610
Validation loss decreased (-0.606650 --> -0.609984).  Saving model ...
Epoch: 54 cost time: 6.7447428703308105
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.603 Test Loss: 1.639 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.820259094238281
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.607 Test Loss: 1.637 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 6.117921590805054
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.603 Test Loss: 1.633 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 6.315953016281128
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.607 Test Loss: 1.626 Test Acc: 0.607
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 6.691420316696167
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.623 Vali Acc: 0.607 Test Loss: 1.623 Test Acc: 0.607
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 6.926023960113525
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.603 Test Loss: 1.620 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 6.286115646362305
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.603 Test Loss: 1.616 Test Acc: 0.603
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 6.454813480377197
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.603 Test Loss: 1.609 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 6.421502590179443
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.617 Test Loss: 1.605 Test Acc: 0.617
Validation loss decreased (-0.609984 --> -0.616651).  Saving model ...
Epoch: 63 cost time: 6.340769529342651
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.617 Test Loss: 1.602 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616651).  Saving model ...
Epoch: 64 cost time: 6.479795455932617
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.620 Test Loss: 1.597 Test Acc: 0.620
Validation loss decreased (-0.616651 --> -0.619984).  Saving model ...
Epoch: 65 cost time: 6.397089242935181
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.620 Test Loss: 1.596 Test Acc: 0.620
Validation loss decreased (-0.619984 --> -0.619984).  Saving model ...
Epoch: 66 cost time: 6.632760524749756
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.617 Test Loss: 1.597 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 6.904696464538574
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.594 Vali Acc: 0.617 Test Loss: 1.594 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 6.804504156112671
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.620 Test Loss: 1.592 Test Acc: 0.620
Validation loss decreased (-0.619984 --> -0.619984).  Saving model ...
Epoch: 69 cost time: 6.715404748916626
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.620 Test Loss: 1.591 Test Acc: 0.620
Validation loss decreased (-0.619984 --> -0.619984).  Saving model ...
Epoch: 70 cost time: 6.5919787883758545
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.620 Test Loss: 1.592 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 6.448894739151001
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.620 Test Loss: 1.590 Test Acc: 0.620
Validation loss decreased (-0.619984 --> -0.619984).  Saving model ...
Epoch: 72 cost time: 6.520354986190796
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.620 Test Loss: 1.588 Test Acc: 0.620
Validation loss decreased (-0.619984 --> -0.619984).  Saving model ...
Epoch: 73 cost time: 5.957235813140869
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.627 Test Loss: 1.590 Test Acc: 0.627
Validation loss decreased (-0.619984 --> -0.626651).  Saving model ...
Epoch: 74 cost time: 6.1389524936676025
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.627 Test Loss: 1.588 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 75 cost time: 6.473794221878052
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.630 Test Loss: 1.585 Test Acc: 0.630
Validation loss decreased (-0.626651 --> -0.629984).  Saving model ...
Epoch: 76 cost time: 6.721343755722046
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.630 Test Loss: 1.585 Test Acc: 0.630
Validation loss decreased (-0.629984 --> -0.629984).  Saving model ...
Epoch: 77 cost time: 6.598083257675171
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.633 Test Loss: 1.583 Test Acc: 0.633
Validation loss decreased (-0.629984 --> -0.633318).  Saving model ...
Epoch: 78 cost time: 6.446739673614502
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.633 Test Loss: 1.581 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633318).  Saving model ...
Epoch: 79 cost time: 6.3854453563690186
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.637 Test Loss: 1.578 Test Acc: 0.637
Validation loss decreased (-0.633318 --> -0.636651).  Saving model ...
Epoch: 80 cost time: 6.31853723526001
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.637 Test Loss: 1.579 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 6.277461767196655
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.637 Test Loss: 1.579 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 6.310406923294067
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.647 Test Loss: 1.574 Test Acc: 0.647
Validation loss decreased (-0.636651 --> -0.646651).  Saving model ...
Epoch: 83 cost time: 6.290114402770996
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.647 Test Loss: 1.573 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 84 cost time: 5.962482690811157
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.643 Test Loss: 1.574 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 6.857592821121216
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.647 Test Loss: 1.574 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 6.348681449890137
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.571 Vali Acc: 0.647 Test Loss: 1.571 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 87 cost time: 6.244252920150757
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.647 Test Loss: 1.572 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 6.340782642364502
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.647 Test Loss: 1.575 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 6.5185205936431885
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.643 Test Loss: 1.573 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 6.351485729217529
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.647 Test Loss: 1.572 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 5.876745700836182
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.570 Vali Acc: 0.647 Test Loss: 1.570 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 92 cost time: 6.419619083404541
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.568 Vali Acc: 0.647 Test Loss: 1.568 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 93 cost time: 6.72529673576355
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.647 Test Loss: 1.567 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 94 cost time: 6.55069637298584
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.563 Vali Acc: 0.647 Test Loss: 1.563 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 95 cost time: 6.811090469360352
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.643 Test Loss: 1.561 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 6.230337142944336
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.560 Vali Acc: 0.643 Test Loss: 1.560 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 6.704557657241821
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.653 Test Loss: 1.558 Test Acc: 0.653
Validation loss decreased (-0.646651 --> -0.653318).  Saving model ...
Epoch: 98 cost time: 6.729828357696533
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.653 Test Loss: 1.558 Test Acc: 0.653
Validation loss decreased (-0.653318 --> -0.653318).  Saving model ...
Epoch: 99 cost time: 6.472582101821899
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.557 Vali Acc: 0.653 Test Loss: 1.557 Test Acc: 0.653
Validation loss decreased (-0.653318 --> -0.653318).  Saving model ...
Epoch: 100 cost time: 6.667782783508301
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.557 Vali Acc: 0.653 Test Loss: 1.557 Test Acc: 0.653
Validation loss decreased (-0.653318 --> -0.653318).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6533333333333333
model parameter : 18659353
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.302552461624146
Epoch: 1, Steps: 18 | Train Loss: 3.289 Vali Loss: 3.125 Vali Acc: 0.080 Test Loss: 3.125 Test Acc: 0.080
Validation loss decreased (inf --> -0.079969).  Saving model ...
Epoch: 2 cost time: 6.700893402099609
Epoch: 2, Steps: 18 | Train Loss: 1.737 Vali Loss: 2.878 Vali Acc: 0.143 Test Loss: 2.878 Test Acc: 0.143
Validation loss decreased (-0.079969 --> -0.143305).  Saving model ...
Epoch: 3 cost time: 6.5657079219818115
Epoch: 3, Steps: 18 | Train Loss: 0.382 Vali Loss: 2.582 Vali Acc: 0.250 Test Loss: 2.582 Test Acc: 0.250
Validation loss decreased (-0.143305 --> -0.249974).  Saving model ...
Epoch: 4 cost time: 6.585885286331177
Epoch: 4, Steps: 18 | Train Loss: 0.052 Vali Loss: 2.593 Vali Acc: 0.283 Test Loss: 2.593 Test Acc: 0.283
Validation loss decreased (-0.249974 --> -0.283307).  Saving model ...
Epoch: 5 cost time: 6.381820917129517
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.071 Vali Acc: 0.397 Test Loss: 2.071 Test Acc: 0.397
Validation loss decreased (-0.283307 --> -0.396646).  Saving model ...
Epoch: 6 cost time: 6.59869647026062
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.167 Vali Acc: 0.403 Test Loss: 2.167 Test Acc: 0.403
Validation loss decreased (-0.396646 --> -0.403312).  Saving model ...
Epoch: 7 cost time: 6.437855005264282
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.042 Vali Acc: 0.427 Test Loss: 2.042 Test Acc: 0.427
Validation loss decreased (-0.403312 --> -0.426646).  Saving model ...
Epoch: 8 cost time: 6.463179349899292
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.993 Vali Acc: 0.427 Test Loss: 1.993 Test Acc: 0.427
Validation loss decreased (-0.426646 --> -0.426647).  Saving model ...
Epoch: 9 cost time: 6.311884164810181
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.967 Vali Acc: 0.447 Test Loss: 1.967 Test Acc: 0.447
Validation loss decreased (-0.426647 --> -0.446647).  Saving model ...
Epoch: 10 cost time: 6.160632371902466
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.943 Vali Acc: 0.460 Test Loss: 1.943 Test Acc: 0.460
Validation loss decreased (-0.446647 --> -0.459981).  Saving model ...
Epoch: 11 cost time: 6.182955503463745
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.909 Vali Acc: 0.463 Test Loss: 1.909 Test Acc: 0.463
Validation loss decreased (-0.459981 --> -0.463314).  Saving model ...
Epoch: 12 cost time: 6.10926628112793
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.884 Vali Acc: 0.467 Test Loss: 1.884 Test Acc: 0.467
Validation loss decreased (-0.463314 --> -0.466648).  Saving model ...
Epoch: 13 cost time: 6.555302143096924
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.877 Vali Acc: 0.477 Test Loss: 1.877 Test Acc: 0.477
Validation loss decreased (-0.466648 --> -0.476648).  Saving model ...
Epoch: 14 cost time: 6.7693305015563965
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.868 Vali Acc: 0.467 Test Loss: 1.868 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.838876247406006
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.490 Test Loss: 1.853 Test Acc: 0.490
Validation loss decreased (-0.476648 --> -0.489981).  Saving model ...
Epoch: 16 cost time: 6.527639627456665
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.836 Vali Acc: 0.500 Test Loss: 1.836 Test Acc: 0.500
Validation loss decreased (-0.489981 --> -0.499982).  Saving model ...
Epoch: 17 cost time: 6.259143114089966
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.823 Vali Acc: 0.493 Test Loss: 1.823 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.5459864139556885
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.507 Test Loss: 1.803 Test Acc: 0.507
Validation loss decreased (-0.499982 --> -0.506649).  Saving model ...
Epoch: 19 cost time: 6.221526861190796
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.790 Vali Acc: 0.513 Test Loss: 1.790 Test Acc: 0.513
Validation loss decreased (-0.506649 --> -0.513315).  Saving model ...
Epoch: 20 cost time: 5.783797264099121
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.788 Vali Acc: 0.513 Test Loss: 1.788 Test Acc: 0.513
Validation loss decreased (-0.513315 --> -0.513315).  Saving model ...
Epoch: 21 cost time: 6.72333550453186
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.520 Test Loss: 1.772 Test Acc: 0.520
Validation loss decreased (-0.513315 --> -0.519982).  Saving model ...
Epoch: 22 cost time: 6.4430036544799805
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.753 Vali Acc: 0.527 Test Loss: 1.753 Test Acc: 0.527
Validation loss decreased (-0.519982 --> -0.526649).  Saving model ...
Epoch: 23 cost time: 6.2425010204315186
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.527 Test Loss: 1.739 Test Acc: 0.527
Validation loss decreased (-0.526649 --> -0.526649).  Saving model ...
Epoch: 24 cost time: 6.149440765380859
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.530 Test Loss: 1.734 Test Acc: 0.530
Validation loss decreased (-0.526649 --> -0.529983).  Saving model ...
Epoch: 25 cost time: 6.479896783828735
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.726 Vali Acc: 0.530 Test Loss: 1.726 Test Acc: 0.530
Validation loss decreased (-0.529983 --> -0.529983).  Saving model ...
Epoch: 26 cost time: 6.624668121337891
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.709 Vali Acc: 0.540 Test Loss: 1.709 Test Acc: 0.540
Validation loss decreased (-0.529983 --> -0.539983).  Saving model ...
Epoch: 27 cost time: 6.507676839828491
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.547 Test Loss: 1.697 Test Acc: 0.547
Validation loss decreased (-0.539983 --> -0.546650).  Saving model ...
Epoch: 28 cost time: 6.439677000045776
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.550 Test Loss: 1.691 Test Acc: 0.550
Validation loss decreased (-0.546650 --> -0.549983).  Saving model ...
Epoch: 29 cost time: 6.4193761348724365
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.688 Vali Acc: 0.557 Test Loss: 1.688 Test Acc: 0.557
Validation loss decreased (-0.549983 --> -0.556650).  Saving model ...
Epoch: 30 cost time: 6.161366701126099
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.677 Vali Acc: 0.563 Test Loss: 1.677 Test Acc: 0.563
Validation loss decreased (-0.556650 --> -0.563317).  Saving model ...
Epoch: 31 cost time: 6.883927345275879
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.677 Vali Acc: 0.567 Test Loss: 1.677 Test Acc: 0.567
Validation loss decreased (-0.563317 --> -0.566650).  Saving model ...
Epoch: 32 cost time: 5.894607067108154
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.671 Vali Acc: 0.570 Test Loss: 1.671 Test Acc: 0.570
Validation loss decreased (-0.566650 --> -0.569983).  Saving model ...
Epoch: 33 cost time: 6.2793214321136475
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.665 Vali Acc: 0.573 Test Loss: 1.665 Test Acc: 0.573
Validation loss decreased (-0.569983 --> -0.573317).  Saving model ...
Epoch: 34 cost time: 6.512256860733032
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.658 Vali Acc: 0.573 Test Loss: 1.658 Test Acc: 0.573
Validation loss decreased (-0.573317 --> -0.573317).  Saving model ...
Epoch: 35 cost time: 6.00076699256897
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.652 Vali Acc: 0.573 Test Loss: 1.652 Test Acc: 0.573
Validation loss decreased (-0.573317 --> -0.573317).  Saving model ...
Epoch: 36 cost time: 6.2782721519470215
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.655 Vali Acc: 0.577 Test Loss: 1.655 Test Acc: 0.577
Validation loss decreased (-0.573317 --> -0.576650).  Saving model ...
Epoch: 37 cost time: 7.172172784805298
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.649 Vali Acc: 0.583 Test Loss: 1.649 Test Acc: 0.583
Validation loss decreased (-0.576650 --> -0.583317).  Saving model ...
Epoch: 38 cost time: 6.826458692550659
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.587 Test Loss: 1.645 Test Acc: 0.587
Validation loss decreased (-0.583317 --> -0.586650).  Saving model ...
Epoch: 39 cost time: 6.06723690032959
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.583 Test Loss: 1.639 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.175099849700928
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.634 Vali Acc: 0.583 Test Loss: 1.634 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.899213075637817
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.593 Test Loss: 1.625 Test Acc: 0.593
Validation loss decreased (-0.586650 --> -0.593317).  Saving model ...
Epoch: 42 cost time: 6.6972503662109375
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.593 Test Loss: 1.619 Test Acc: 0.593
Validation loss decreased (-0.593317 --> -0.593317).  Saving model ...
Epoch: 43 cost time: 6.565892934799194
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.593 Test Loss: 1.616 Test Acc: 0.593
Validation loss decreased (-0.593317 --> -0.593317).  Saving model ...
Epoch: 44 cost time: 6.3439483642578125
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.593 Test Loss: 1.616 Test Acc: 0.593
Validation loss decreased (-0.593317 --> -0.593317).  Saving model ...
Epoch: 45 cost time: 6.617106199264526
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.597 Test Loss: 1.611 Test Acc: 0.597
Validation loss decreased (-0.593317 --> -0.596651).  Saving model ...
Epoch: 46 cost time: 6.338306665420532
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.597 Test Loss: 1.607 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 47 cost time: 6.252479314804077
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.600 Vali Acc: 0.600 Test Loss: 1.600 Test Acc: 0.600
Validation loss decreased (-0.596651 --> -0.599984).  Saving model ...
Epoch: 48 cost time: 6.585569381713867
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.600 Test Loss: 1.597 Test Acc: 0.600
Validation loss decreased (-0.599984 --> -0.599984).  Saving model ...
Epoch: 49 cost time: 6.467979907989502
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.603 Test Loss: 1.597 Test Acc: 0.603
Validation loss decreased (-0.599984 --> -0.603317).  Saving model ...
Epoch: 50 cost time: 6.498539447784424
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.595 Vali Acc: 0.607 Test Loss: 1.595 Test Acc: 0.607
Validation loss decreased (-0.603317 --> -0.606651).  Saving model ...
Epoch: 51 cost time: 6.521989345550537
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.607 Test Loss: 1.591 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606651).  Saving model ...
Epoch: 52 cost time: 6.1253886222839355
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.610 Test Loss: 1.585 Test Acc: 0.610
Validation loss decreased (-0.606651 --> -0.609984).  Saving model ...
Epoch: 53 cost time: 6.54608154296875
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.610 Test Loss: 1.582 Test Acc: 0.610
Validation loss decreased (-0.609984 --> -0.609984).  Saving model ...
Epoch: 54 cost time: 6.74701714515686
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.584 Vali Acc: 0.610 Test Loss: 1.584 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.3782525062561035
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.610 Test Loss: 1.581 Test Acc: 0.610
Validation loss decreased (-0.609984 --> -0.609984).  Saving model ...
Epoch: 56 cost time: 6.3079822063446045
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.610 Test Loss: 1.576 Test Acc: 0.610
Validation loss decreased (-0.609984 --> -0.609984).  Saving model ...
Epoch: 57 cost time: 6.062083721160889
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.613 Test Loss: 1.572 Test Acc: 0.613
Validation loss decreased (-0.609984 --> -0.613318).  Saving model ...
Epoch: 58 cost time: 6.023010730743408
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.613 Test Loss: 1.572 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.191729307174683
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.570 Vali Acc: 0.617 Test Loss: 1.570 Test Acc: 0.617
Validation loss decreased (-0.613318 --> -0.616651).  Saving model ...
Epoch: 60 cost time: 6.067548990249634
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.623 Test Loss: 1.566 Test Acc: 0.623
Validation loss decreased (-0.616651 --> -0.623318).  Saving model ...
Epoch: 61 cost time: 5.99501633644104
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.620 Test Loss: 1.561 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.590103626251221
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.620 Test Loss: 1.558 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 6.699265718460083
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.623 Test Loss: 1.556 Test Acc: 0.623
Validation loss decreased (-0.623318 --> -0.623318).  Saving model ...
Epoch: 64 cost time: 6.225743055343628
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.630 Test Loss: 1.551 Test Acc: 0.630
Validation loss decreased (-0.623318 --> -0.629984).  Saving model ...
Epoch: 65 cost time: 5.885089635848999
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.633 Test Loss: 1.547 Test Acc: 0.633
Validation loss decreased (-0.629984 --> -0.633318).  Saving model ...
Epoch: 66 cost time: 6.699304819107056
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.548 Vali Acc: 0.630 Test Loss: 1.548 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 6.453248977661133
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.546 Vali Acc: 0.630 Test Loss: 1.546 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 6.117218732833862
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.543 Vali Acc: 0.633 Test Loss: 1.543 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633318).  Saving model ...
Epoch: 69 cost time: 6.753652334213257
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.545 Vali Acc: 0.633 Test Loss: 1.545 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 6.822309970855713
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.548 Vali Acc: 0.633 Test Loss: 1.548 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 6.516986608505249
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.545 Vali Acc: 0.633 Test Loss: 1.545 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 6.911538124084473
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.542 Vali Acc: 0.637 Test Loss: 1.542 Test Acc: 0.637
Validation loss decreased (-0.633318 --> -0.636651).  Saving model ...
Epoch: 73 cost time: 6.046829462051392
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.637 Test Loss: 1.541 Test Acc: 0.637
Validation loss decreased (-0.636651 --> -0.636651).  Saving model ...
Epoch: 74 cost time: 6.440728187561035
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.640 Test Loss: 1.538 Test Acc: 0.640
Validation loss decreased (-0.636651 --> -0.639985).  Saving model ...
Epoch: 75 cost time: 6.315127849578857
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.640 Test Loss: 1.536 Test Acc: 0.640
Validation loss decreased (-0.639985 --> -0.639985).  Saving model ...
Epoch: 76 cost time: 6.307036638259888
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.640 Test Loss: 1.536 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 6.027864456176758
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.640 Test Loss: 1.534 Test Acc: 0.640
Validation loss decreased (-0.639985 --> -0.639985).  Saving model ...
Epoch: 78 cost time: 6.804096698760986
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.640 Test Loss: 1.532 Test Acc: 0.640
Validation loss decreased (-0.639985 --> -0.639985).  Saving model ...
Epoch: 79 cost time: 6.575209617614746
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.640 Test Loss: 1.531 Test Acc: 0.640
Validation loss decreased (-0.639985 --> -0.639985).  Saving model ...
Epoch: 80 cost time: 6.8834388256073
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.640 Test Loss: 1.534 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 5.923687219619751
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.643 Test Loss: 1.533 Test Acc: 0.643
Validation loss decreased (-0.639985 --> -0.643318).  Saving model ...
Epoch: 82 cost time: 5.834131479263306
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.643 Test Loss: 1.530 Test Acc: 0.643
Validation loss decreased (-0.643318 --> -0.643318).  Saving model ...
Epoch: 83 cost time: 5.978424310684204
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.647 Test Loss: 1.530 Test Acc: 0.647
Validation loss decreased (-0.643318 --> -0.646651).  Saving model ...
Epoch: 84 cost time: 6.216050863265991
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.647 Test Loss: 1.528 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 85 cost time: 6.101538419723511
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.647 Test Loss: 1.526 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 86 cost time: 6.7703492641448975
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.650 Test Loss: 1.524 Test Acc: 0.650
Validation loss decreased (-0.646651 --> -0.649985).  Saving model ...
Epoch: 87 cost time: 6.733352422714233
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.657 Test Loss: 1.525 Test Acc: 0.657
Validation loss decreased (-0.649985 --> -0.656651).  Saving model ...
Epoch: 88 cost time: 6.207135915756226
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.657 Test Loss: 1.524 Test Acc: 0.657
Validation loss decreased (-0.656651 --> -0.656651).  Saving model ...
Epoch: 89 cost time: 5.957696437835693
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.653 Test Loss: 1.523 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 6.34648323059082
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.653 Test Loss: 1.523 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 6.2090163230896
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.653 Test Loss: 1.522 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 6.261728286743164
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.653 Test Loss: 1.522 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 6.364119052886963
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.657 Test Loss: 1.521 Test Acc: 0.657
Validation loss decreased (-0.656651 --> -0.656651).  Saving model ...
Epoch: 94 cost time: 6.2810118198394775
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.653 Test Loss: 1.519 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 6.363556146621704
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.653 Test Loss: 1.516 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 5.9449303150177
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.653 Test Loss: 1.515 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 6.364228010177612
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.514 Vali Acc: 0.653 Test Loss: 1.514 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 6.0069990158081055
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.657 Test Loss: 1.512 Test Acc: 0.657
Validation loss decreased (-0.656651 --> -0.656652).  Saving model ...
Epoch: 99 cost time: 5.7435173988342285
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.663 Test Loss: 1.512 Test Acc: 0.663
Validation loss decreased (-0.656652 --> -0.663318).  Saving model ...
Epoch: 100 cost time: 5.976379871368408
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.660 Test Loss: 1.511 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6633333333333333
model parameter : 18659353
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.255607604980469
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 6.047213554382324
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 3 cost time: 6.149304628372192
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.76478910446167
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.805778741836548
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.594412803649902
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.33176589012146
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.611302137374878
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.501824855804443
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 10 cost time: 6.760936260223389
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.7244579792022705
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 12 cost time: 6.114946126937866
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.4313108921051025
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.71779990196228
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.750326156616211
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.657682418823242
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.893223285675049
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.853770732879639
Epoch: 18, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.862471103668213
Epoch: 19, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.6850385665893555
Epoch: 20, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.21001410484314
Epoch: 21, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 18659353
model size : 90.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.639979600906372
Epoch: 1, Steps: 18 | Train Loss: 2.637 Vali Loss: 1.072 Vali Acc: 0.720 Test Loss: 1.072 Test Acc: 0.720
Validation loss decreased (inf --> -0.719989).  Saving model ...
Epoch: 2 cost time: 6.0558178424835205
Epoch: 2, Steps: 18 | Train Loss: 0.346 Vali Loss: 0.516 Vali Acc: 0.863 Test Loss: 0.516 Test Acc: 0.863
Validation loss decreased (-0.719989 --> -0.863328).  Saving model ...
Epoch: 3 cost time: 6.44936203956604
Epoch: 3, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.199114561080933
Epoch: 4, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.441 Vali Acc: 0.893 Test Loss: 0.441 Test Acc: 0.893
Validation loss decreased (-0.863328 --> -0.893329).  Saving model ...
Epoch: 5 cost time: 6.0867760181427
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.439 Vali Acc: 0.887 Test Loss: 0.439 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.810108423233032
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
Validation loss decreased (-0.893329 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 6.067037105560303
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.607 Vali Acc: 0.880 Test Loss: 0.607 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.9983909130096436
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.719 Vali Acc: 0.830 Test Loss: 0.719 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.235461711883545
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.802 Vali Acc: 0.843 Test Loss: 0.802 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.809544324874878
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.837 Vali Acc: 0.843 Test Loss: 0.837 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.382864475250244
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.361 Vali Acc: 0.827 Test Loss: 1.361 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.293733835220337
Epoch: 12, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.883 Vali Acc: 0.817 Test Loss: 0.883 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.907917022705078
Epoch: 13, Steps: 18 | Train Loss: 0.097 Vali Loss: 1.308 Vali Acc: 0.797 Test Loss: 1.308 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.105284690856934
Epoch: 14, Steps: 18 | Train Loss: 0.187 Vali Loss: 2.731 Vali Acc: 0.693 Test Loss: 2.731 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.263062477111816
Epoch: 15, Steps: 18 | Train Loss: 0.238 Vali Loss: 2.487 Vali Acc: 0.733 Test Loss: 2.487 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.32723331451416
Epoch: 16, Steps: 18 | Train Loss: 0.128 Vali Loss: 2.480 Vali Acc: 0.757 Test Loss: 2.480 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9
model parameter : 15513625
model size : 78.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.215799331665039
Epoch: 1, Steps: 18 | Train Loss: 2.834 Vali Loss: 1.392 Vali Acc: 0.657 Test Loss: 1.392 Test Acc: 0.657
Validation loss decreased (inf --> -0.656653).  Saving model ...
Epoch: 2 cost time: 6.340078830718994
Epoch: 2, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.703 Vali Acc: 0.817 Test Loss: 0.703 Test Acc: 0.817
Validation loss decreased (-0.656653 --> -0.816660).  Saving model ...
Epoch: 3 cost time: 6.495306015014648
Epoch: 3, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.633 Vali Acc: 0.837 Test Loss: 0.633 Test Acc: 0.837
Validation loss decreased (-0.816660 --> -0.836660).  Saving model ...
Epoch: 4 cost time: 6.218440771102905
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.679 Vali Acc: 0.853 Test Loss: 0.679 Test Acc: 0.853
Validation loss decreased (-0.836660 --> -0.853327).  Saving model ...
Epoch: 5 cost time: 5.868281364440918
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.857 Test Loss: 0.589 Test Acc: 0.857
Validation loss decreased (-0.853327 --> -0.856661).  Saving model ...
Epoch: 6 cost time: 6.1429219245910645
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.340731859207153
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.857 Test Loss: 0.575 Test Acc: 0.857
Validation loss decreased (-0.856661 --> -0.856661).  Saving model ...
Epoch: 8 cost time: 6.350581645965576
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.860 Test Loss: 0.581 Test Acc: 0.860
Validation loss decreased (-0.856661 --> -0.859994).  Saving model ...
Epoch: 9 cost time: 6.114893674850464
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.853 Test Loss: 0.584 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.574605941772461
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.857 Test Loss: 0.587 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.680737495422363
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.853 Test Loss: 0.587 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.475372552871704
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.853 Test Loss: 0.587 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.521125078201294
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.853 Test Loss: 0.586 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.634754419326782
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.857 Test Loss: 0.585 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.996959924697876
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.860 Test Loss: 0.584 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.719723224639893
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.857 Test Loss: 0.585 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.409399032592773
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.853 Test Loss: 0.585 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.382974863052368
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.853 Test Loss: 0.583 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.86
model parameter : 15513625
model size : 78.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.414490461349487
Epoch: 1, Steps: 18 | Train Loss: 3.014 Vali Loss: 1.924 Vali Acc: 0.500 Test Loss: 1.924 Test Acc: 0.500
Validation loss decreased (inf --> -0.499981).  Saving model ...
Epoch: 2 cost time: 6.1281208992004395
Epoch: 2, Steps: 18 | Train Loss: 0.735 Vali Loss: 1.009 Vali Acc: 0.710 Test Loss: 1.009 Test Acc: 0.710
Validation loss decreased (-0.499981 --> -0.709990).  Saving model ...
Epoch: 3 cost time: 5.739985466003418
Epoch: 3, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.990 Vali Acc: 0.733 Test Loss: 0.990 Test Acc: 0.733
Validation loss decreased (-0.709990 --> -0.733323).  Saving model ...
Epoch: 4 cost time: 5.650051832199097
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.976 Vali Acc: 0.770 Test Loss: 0.976 Test Acc: 0.770
Validation loss decreased (-0.733323 --> -0.769990).  Saving model ...
Epoch: 5 cost time: 6.343149900436401
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.946 Vali Acc: 0.770 Test Loss: 0.946 Test Acc: 0.770
Validation loss decreased (-0.769990 --> -0.769991).  Saving model ...
Epoch: 6 cost time: 6.313462018966675
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.783 Test Loss: 0.909 Test Acc: 0.783
Validation loss decreased (-0.769991 --> -0.783324).  Saving model ...
Epoch: 7 cost time: 6.3291707038879395
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.790 Test Loss: 0.897 Test Acc: 0.790
Validation loss decreased (-0.783324 --> -0.789991).  Saving model ...
Epoch: 8 cost time: 5.882130861282349
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.901 Vali Acc: 0.797 Test Loss: 0.901 Test Acc: 0.797
Validation loss decreased (-0.789991 --> -0.796658).  Saving model ...
Epoch: 9 cost time: 5.853593587875366
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.793 Test Loss: 0.906 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.416987419128418
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.900 Vali Acc: 0.793 Test Loss: 0.900 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.878002882003784
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.898 Vali Acc: 0.790 Test Loss: 0.898 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.651019096374512
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.899 Vali Acc: 0.790 Test Loss: 0.899 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.637707471847534
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.797 Test Loss: 0.903 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.984943866729736
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.797 Test Loss: 0.902 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.750722646713257
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.900 Vali Acc: 0.797 Test Loss: 0.900 Test Acc: 0.797
Validation loss decreased (-0.796658 --> -0.796658).  Saving model ...
Epoch: 16 cost time: 6.250300407409668
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.793 Test Loss: 0.905 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.815906763076782
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.793 Test Loss: 0.905 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.671611070632935
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.793 Test Loss: 0.904 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.976072549819946
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.901 Vali Acc: 0.797 Test Loss: 0.901 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.950563430786133
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.797 Test Loss: 0.903 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.808453559875488
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.793 Test Loss: 0.905 Test Acc: 0.793
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.90810751914978
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.907 Vali Acc: 0.797 Test Loss: 0.907 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.5243964195251465
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.797 Test Loss: 0.909 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.919392347335815
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.797 Test Loss: 0.911 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.122272729873657
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.793 Test Loss: 0.910 Test Acc: 0.793
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7966666666666666
model parameter : 15513625
model size : 78.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.437608242034912
Epoch: 1, Steps: 18 | Train Loss: 3.173 Vali Loss: 2.475 Vali Acc: 0.333 Test Loss: 2.475 Test Acc: 0.333
Validation loss decreased (inf --> -0.333309).  Saving model ...
Epoch: 2 cost time: 5.848788499832153
Epoch: 2, Steps: 18 | Train Loss: 1.144 Vali Loss: 1.664 Vali Acc: 0.513 Test Loss: 1.664 Test Acc: 0.513
Validation loss decreased (-0.333309 --> -0.513317).  Saving model ...
Epoch: 3 cost time: 6.0846312046051025
Epoch: 3, Steps: 18 | Train Loss: 0.126 Vali Loss: 1.204 Vali Acc: 0.623 Test Loss: 1.204 Test Acc: 0.623
Validation loss decreased (-0.513317 --> -0.623321).  Saving model ...
Epoch: 4 cost time: 5.557464361190796
Epoch: 4, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.473 Vali Acc: 0.543 Test Loss: 1.473 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.691450357437134
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.593 Vali Acc: 0.583 Test Loss: 1.593 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.053644895553589
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.305 Vali Acc: 0.647 Test Loss: 1.305 Test Acc: 0.647
Validation loss decreased (-0.623321 --> -0.646654).  Saving model ...
Epoch: 7 cost time: 6.223813533782959
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.353 Vali Acc: 0.607 Test Loss: 1.353 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.397673845291138
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.397 Vali Acc: 0.607 Test Loss: 1.397 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.343647241592407
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.637 Test Loss: 1.229 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.049354076385498
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.670 Test Loss: 1.175 Test Acc: 0.670
Validation loss decreased (-0.646654 --> -0.669988).  Saving model ...
Epoch: 11 cost time: 6.443018436431885
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.170 Vali Acc: 0.673 Test Loss: 1.170 Test Acc: 0.673
Validation loss decreased (-0.669988 --> -0.673322).  Saving model ...
Epoch: 12 cost time: 5.992676734924316
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.174 Vali Acc: 0.670 Test Loss: 1.174 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.2750632762908936
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.172 Vali Acc: 0.683 Test Loss: 1.172 Test Acc: 0.683
Validation loss decreased (-0.673322 --> -0.683322).  Saving model ...
Epoch: 14 cost time: 6.202179670333862
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.680 Test Loss: 1.169 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.341129779815674
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.163 Vali Acc: 0.680 Test Loss: 1.163 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.373509645462036
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.165 Vali Acc: 0.680 Test Loss: 1.165 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.789179801940918
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.164 Vali Acc: 0.677 Test Loss: 1.164 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.454449892044067
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.163 Vali Acc: 0.680 Test Loss: 1.163 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.437859535217285
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.162 Vali Acc: 0.680 Test Loss: 1.162 Test Acc: 0.680
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.213279485702515
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.159 Vali Acc: 0.680 Test Loss: 1.159 Test Acc: 0.680
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.185561895370483
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.154 Vali Acc: 0.677 Test Loss: 1.154 Test Acc: 0.677
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.104678153991699
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.152 Vali Acc: 0.673 Test Loss: 1.152 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.053835153579712
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.149 Vali Acc: 0.680 Test Loss: 1.149 Test Acc: 0.680
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6833333333333333
model parameter : 15513625
model size : 78.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.088240146636963
Epoch: 1, Steps: 18 | Train Loss: 3.225 Vali Loss: 2.776 Vali Acc: 0.217 Test Loss: 2.776 Test Acc: 0.217
Validation loss decreased (inf --> -0.216639).  Saving model ...
Epoch: 2 cost time: 6.232675552368164
Epoch: 2, Steps: 18 | Train Loss: 1.390 Vali Loss: 2.210 Vali Acc: 0.360 Test Loss: 2.210 Test Acc: 0.360
Validation loss decreased (-0.216639 --> -0.359978).  Saving model ...
Epoch: 3 cost time: 6.6511549949646
Epoch: 3, Steps: 18 | Train Loss: 0.229 Vali Loss: 1.797 Vali Acc: 0.433 Test Loss: 1.797 Test Acc: 0.433
Validation loss decreased (-0.359978 --> -0.433315).  Saving model ...
Epoch: 4 cost time: 5.812786102294922
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 2.051 Vali Acc: 0.420 Test Loss: 2.051 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.6830432415008545
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.739 Vali Acc: 0.493 Test Loss: 1.739 Test Acc: 0.493
Validation loss decreased (-0.433315 --> -0.493316).  Saving model ...
Epoch: 6 cost time: 6.639930486679077
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.688 Vali Acc: 0.507 Test Loss: 1.688 Test Acc: 0.507
Validation loss decreased (-0.493316 --> -0.506650).  Saving model ...
Epoch: 7 cost time: 6.27999210357666
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.645 Vali Acc: 0.520 Test Loss: 1.645 Test Acc: 0.520
Validation loss decreased (-0.506650 --> -0.519984).  Saving model ...
Epoch: 8 cost time: 6.256122827529907
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.543 Test Loss: 1.600 Test Acc: 0.543
Validation loss decreased (-0.519984 --> -0.543317).  Saving model ...
Epoch: 9 cost time: 6.201440334320068
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.530 Test Loss: 1.596 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.737281560897827
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.550 Test Loss: 1.580 Test Acc: 0.550
Validation loss decreased (-0.543317 --> -0.549984).  Saving model ...
Epoch: 11 cost time: 5.725962400436401
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.565 Vali Acc: 0.547 Test Loss: 1.565 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.5947346687316895
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.560 Vali Acc: 0.540 Test Loss: 1.560 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.05480432510376
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.553 Test Loss: 1.551 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553318).  Saving model ...
Epoch: 14 cost time: 6.481707334518433
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.557 Test Loss: 1.540 Test Acc: 0.557
Validation loss decreased (-0.553318 --> -0.556651).  Saving model ...
Epoch: 15 cost time: 5.8220436573028564
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.560 Test Loss: 1.527 Test Acc: 0.560
Validation loss decreased (-0.556651 --> -0.559985).  Saving model ...
Epoch: 16 cost time: 5.826150894165039
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.560 Test Loss: 1.519 Test Acc: 0.560
Validation loss decreased (-0.559985 --> -0.559985).  Saving model ...
Epoch: 17 cost time: 6.038712024688721
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.560 Test Loss: 1.520 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.870524168014526
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.567 Test Loss: 1.515 Test Acc: 0.567
Validation loss decreased (-0.559985 --> -0.566652).  Saving model ...
Epoch: 19 cost time: 6.254964113235474
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.570 Test Loss: 1.507 Test Acc: 0.570
Validation loss decreased (-0.566652 --> -0.569985).  Saving model ...
Epoch: 20 cost time: 6.2383129596710205
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.570 Test Loss: 1.499 Test Acc: 0.570
Validation loss decreased (-0.569985 --> -0.569985).  Saving model ...
Epoch: 21 cost time: 6.351715087890625
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.573 Test Loss: 1.490 Test Acc: 0.573
Validation loss decreased (-0.569985 --> -0.573318).  Saving model ...
Epoch: 22 cost time: 6.45154595375061
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.573 Test Loss: 1.489 Test Acc: 0.573
Validation loss decreased (-0.573318 --> -0.573318).  Saving model ...
Epoch: 23 cost time: 6.21141242980957
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.487 Vali Acc: 0.583 Test Loss: 1.487 Test Acc: 0.583
Validation loss decreased (-0.573318 --> -0.583318).  Saving model ...
Epoch: 24 cost time: 5.884009122848511
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.583 Test Loss: 1.486 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583318).  Saving model ...
Epoch: 25 cost time: 6.018606901168823
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.483 Vali Acc: 0.583 Test Loss: 1.483 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583319).  Saving model ...
Epoch: 26 cost time: 6.16975736618042
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.590 Test Loss: 1.481 Test Acc: 0.590
Validation loss decreased (-0.583319 --> -0.589985).  Saving model ...
Epoch: 27 cost time: 6.049830436706543
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.590 Test Loss: 1.476 Test Acc: 0.590
Validation loss decreased (-0.589985 --> -0.589985).  Saving model ...
Epoch: 28 cost time: 6.269587516784668
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.474 Vali Acc: 0.593 Test Loss: 1.474 Test Acc: 0.593
Validation loss decreased (-0.589985 --> -0.593319).  Saving model ...
Epoch: 29 cost time: 5.986676454544067
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.590 Test Loss: 1.469 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.471213340759277
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.597 Test Loss: 1.471 Test Acc: 0.597
Validation loss decreased (-0.593319 --> -0.596652).  Saving model ...
Epoch: 31 cost time: 6.563301086425781
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.600 Test Loss: 1.468 Test Acc: 0.600
Validation loss decreased (-0.596652 --> -0.599985).  Saving model ...
Epoch: 32 cost time: 6.412080526351929
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.607 Test Loss: 1.463 Test Acc: 0.607
Validation loss decreased (-0.599985 --> -0.606652).  Saving model ...
Epoch: 33 cost time: 5.9860265254974365
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.600 Test Loss: 1.460 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.710839509963989
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.457 Vali Acc: 0.607 Test Loss: 1.457 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 35 cost time: 6.525936841964722
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.457 Vali Acc: 0.603 Test Loss: 1.457 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.2173216342926025
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.607 Test Loss: 1.454 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 37 cost time: 6.2873194217681885
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.607 Test Loss: 1.451 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 38 cost time: 5.991883993148804
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.610 Test Loss: 1.445 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 39 cost time: 6.21323299407959
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.613 Test Loss: 1.442 Test Acc: 0.613
Validation loss decreased (-0.609986 --> -0.613319).  Saving model ...
Epoch: 40 cost time: 6.238181829452515
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.617 Test Loss: 1.439 Test Acc: 0.617
Validation loss decreased (-0.613319 --> -0.616652).  Saving model ...
Epoch: 41 cost time: 5.696145534515381
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.620 Test Loss: 1.437 Test Acc: 0.620
Validation loss decreased (-0.616652 --> -0.619986).  Saving model ...
Epoch: 42 cost time: 5.8918516635894775
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.617 Test Loss: 1.436 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.907179832458496
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.617 Test Loss: 1.435 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 6.2536940574646
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.613 Test Loss: 1.435 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 6.491337776184082
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.610 Test Loss: 1.434 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 6.333913564682007
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.617 Test Loss: 1.432 Test Acc: 0.617
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 6.19716215133667
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.623 Test Loss: 1.429 Test Acc: 0.623
Validation loss decreased (-0.619986 --> -0.623319).  Saving model ...
Epoch: 48 cost time: 6.55608057975769
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.623 Test Loss: 1.432 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.168810844421387
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.620 Test Loss: 1.434 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 5.878505706787109
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.620 Test Loss: 1.433 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 5.817765712738037
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.627 Test Loss: 1.434 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626652).  Saving model ...
Epoch: 52 cost time: 6.136730194091797
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.623 Test Loss: 1.433 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 6.388631820678711
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.623 Test Loss: 1.429 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 6.066862344741821
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.623 Test Loss: 1.429 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 5.9540112018585205
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.627 Test Loss: 1.429 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 56 cost time: 6.1113762855529785
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.627 Test Loss: 1.426 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 57 cost time: 6.005747318267822
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.630 Test Loss: 1.425 Test Acc: 0.630
Validation loss decreased (-0.626652 --> -0.629986).  Saving model ...
Epoch: 58 cost time: 6.484165191650391
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.637 Test Loss: 1.425 Test Acc: 0.637
Validation loss decreased (-0.629986 --> -0.636652).  Saving model ...
Epoch: 59 cost time: 5.905997276306152
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.630 Test Loss: 1.424 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.971080303192139
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.637 Test Loss: 1.422 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 61 cost time: 6.25726580619812
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.637 Test Loss: 1.420 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 62 cost time: 6.771133184432983
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.421 Vali Acc: 0.627 Test Loss: 1.421 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 6.177587509155273
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.630 Test Loss: 1.420 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 6.4224348068237305
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.627 Test Loss: 1.420 Test Acc: 0.627
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 6.067975044250488
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.627 Test Loss: 1.419 Test Acc: 0.627
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 6.299217939376831
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.633 Test Loss: 1.418 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 6.1667139530181885
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.633 Test Loss: 1.419 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 5.953566551208496
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.633 Test Loss: 1.418 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 6.260467290878296
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.640 Test Loss: 1.418 Test Acc: 0.640
Validation loss decreased (-0.636652 --> -0.639986).  Saving model ...
Epoch: 70 cost time: 6.105540990829468
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.640 Test Loss: 1.418 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 71 cost time: 6.291988134384155
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.640 Test Loss: 1.418 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 6.432637453079224
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.417 Vali Acc: 0.640 Test Loss: 1.417 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 73 cost time: 5.871210098266602
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.640 Test Loss: 1.416 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 74 cost time: 6.2388999462127686
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.637 Test Loss: 1.416 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 6.174710273742676
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.637 Test Loss: 1.415 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 6.229461431503296
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.640 Test Loss: 1.414 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 77 cost time: 5.938618421554565
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.637 Test Loss: 1.413 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 6.128072023391724
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.640 Test Loss: 1.412 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 79 cost time: 6.456906795501709
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.650 Test Loss: 1.410 Test Acc: 0.650
Validation loss decreased (-0.639986 --> -0.649986).  Saving model ...
Epoch: 80 cost time: 6.4890828132629395
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.650 Test Loss: 1.409 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 81 cost time: 5.843672275543213
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.647 Test Loss: 1.411 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 5.88845157623291
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.647 Test Loss: 1.410 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 6.1033055782318115
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.647 Test Loss: 1.409 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 6.193161964416504
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.650 Test Loss: 1.409 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 85 cost time: 6.300151109695435
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.650 Test Loss: 1.409 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 6.493802309036255
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.650 Test Loss: 1.410 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 6.112597703933716
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.650 Test Loss: 1.411 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 6.230051040649414
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.650 Test Loss: 1.409 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 6.082658052444458
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.650 Test Loss: 1.410 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 5.822796821594238
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.657 Test Loss: 1.409 Test Acc: 0.657
Validation loss decreased (-0.649986 --> -0.656653).  Saving model ...
Epoch: 91 cost time: 5.96523118019104
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.657 Test Loss: 1.409 Test Acc: 0.657
Validation loss decreased (-0.656653 --> -0.656653).  Saving model ...
Epoch: 92 cost time: 6.193690061569214
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.660 Test Loss: 1.408 Test Acc: 0.660
Validation loss decreased (-0.656653 --> -0.659986).  Saving model ...
Epoch: 93 cost time: 6.123901605606079
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.657 Test Loss: 1.409 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 6.302288293838501
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.660 Test Loss: 1.409 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 5.98019814491272
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.660 Test Loss: 1.408 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 6.197285890579224
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.660 Test Loss: 1.408 Test Acc: 0.660
Validation loss decreased (-0.659986 --> -0.659986).  Saving model ...
Epoch: 97 cost time: 6.066463232040405
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.667 Test Loss: 1.408 Test Acc: 0.667
Validation loss decreased (-0.659986 --> -0.666653).  Saving model ...
Epoch: 98 cost time: 5.666154861450195
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.667 Test Loss: 1.408 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
Epoch: 99 cost time: 5.614334583282471
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.667 Test Loss: 1.407 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
Epoch: 100 cost time: 5.86525559425354
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.663 Test Loss: 1.408 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6666666666666666
model parameter : 15513625
model size : 78.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.965210914611816
Epoch: 1, Steps: 18 | Train Loss: 3.214 Vali Loss: 2.937 Vali Acc: 0.150 Test Loss: 2.937 Test Acc: 0.150
Validation loss decreased (inf --> -0.149971).  Saving model ...
Epoch: 2 cost time: 6.29435658454895
Epoch: 2, Steps: 18 | Train Loss: 1.407 Vali Loss: 2.552 Vali Acc: 0.257 Test Loss: 2.552 Test Acc: 0.257
Validation loss decreased (-0.149971 --> -0.256641).  Saving model ...
Epoch: 3 cost time: 6.406535863876343
Epoch: 3, Steps: 18 | Train Loss: 0.208 Vali Loss: 2.213 Vali Acc: 0.350 Test Loss: 2.213 Test Acc: 0.350
Validation loss decreased (-0.256641 --> -0.349978).  Saving model ...
Epoch: 4 cost time: 6.0792319774627686
Epoch: 4, Steps: 18 | Train Loss: 0.020 Vali Loss: 2.140 Vali Acc: 0.383 Test Loss: 2.140 Test Acc: 0.383
Validation loss decreased (-0.349978 --> -0.383312).  Saving model ...
Epoch: 5 cost time: 6.078197717666626
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.071 Vali Acc: 0.430 Test Loss: 2.071 Test Acc: 0.430
Validation loss decreased (-0.383312 --> -0.429979).  Saving model ...
Epoch: 6 cost time: 5.688625812530518
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.176 Vali Acc: 0.407 Test Loss: 2.176 Test Acc: 0.407
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.103822708129883
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.045 Vali Acc: 0.427 Test Loss: 2.045 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.575141906738281
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.940 Vali Acc: 0.473 Test Loss: 1.940 Test Acc: 0.473
Validation loss decreased (-0.429979 --> -0.473314).  Saving model ...
Epoch: 9 cost time: 6.2784812450408936
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.917 Vali Acc: 0.477 Test Loss: 1.917 Test Acc: 0.477
Validation loss decreased (-0.473314 --> -0.476647).  Saving model ...
Epoch: 10 cost time: 5.7918381690979
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.911 Vali Acc: 0.473 Test Loss: 1.911 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.9643731117248535
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.905 Vali Acc: 0.480 Test Loss: 1.905 Test Acc: 0.480
Validation loss decreased (-0.476647 --> -0.479981).  Saving model ...
Epoch: 12 cost time: 6.117480516433716
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.480 Test Loss: 1.901 Test Acc: 0.480
Validation loss decreased (-0.479981 --> -0.479981).  Saving model ...
Epoch: 13 cost time: 6.139858961105347
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.888 Vali Acc: 0.497 Test Loss: 1.888 Test Acc: 0.497
Validation loss decreased (-0.479981 --> -0.496648).  Saving model ...
Epoch: 14 cost time: 6.061041593551636
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.493 Test Loss: 1.871 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.927057981491089
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.863 Vali Acc: 0.500 Test Loss: 1.863 Test Acc: 0.500
Validation loss decreased (-0.496648 --> -0.499981).  Saving model ...
Epoch: 16 cost time: 5.64243221282959
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.857 Vali Acc: 0.493 Test Loss: 1.857 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.201091766357422
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.507 Test Loss: 1.851 Test Acc: 0.507
Validation loss decreased (-0.499981 --> -0.506648).  Saving model ...
Epoch: 18 cost time: 6.148521184921265
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.841 Vali Acc: 0.513 Test Loss: 1.841 Test Acc: 0.513
Validation loss decreased (-0.506648 --> -0.513315).  Saving model ...
Epoch: 19 cost time: 6.422193288803101
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.517 Test Loss: 1.829 Test Acc: 0.517
Validation loss decreased (-0.513315 --> -0.516648).  Saving model ...
Epoch: 20 cost time: 5.950808763504028
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.517 Test Loss: 1.822 Test Acc: 0.517
Validation loss decreased (-0.516648 --> -0.516648).  Saving model ...
Epoch: 21 cost time: 6.069446325302124
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.821 Vali Acc: 0.523 Test Loss: 1.821 Test Acc: 0.523
Validation loss decreased (-0.516648 --> -0.523315).  Saving model ...
Epoch: 22 cost time: 6.124281644821167
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.828 Vali Acc: 0.523 Test Loss: 1.828 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.890913724899292
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.527 Test Loss: 1.824 Test Acc: 0.527
Validation loss decreased (-0.523315 --> -0.526648).  Saving model ...
Epoch: 24 cost time: 5.528447389602661
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.523 Test Loss: 1.813 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.658302545547485
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.527 Test Loss: 1.801 Test Acc: 0.527
Validation loss decreased (-0.526648 --> -0.526649).  Saving model ...
Epoch: 26 cost time: 5.9630773067474365
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.527 Test Loss: 1.796 Test Acc: 0.527
Validation loss decreased (-0.526649 --> -0.526649).  Saving model ...
Epoch: 27 cost time: 5.85487174987793
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.797 Vali Acc: 0.533 Test Loss: 1.797 Test Acc: 0.533
Validation loss decreased (-0.526649 --> -0.533315).  Saving model ...
Epoch: 28 cost time: 5.704346656799316
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.533 Test Loss: 1.794 Test Acc: 0.533
Validation loss decreased (-0.533315 --> -0.533315).  Saving model ...
Epoch: 29 cost time: 5.784060001373291
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.793 Vali Acc: 0.533 Test Loss: 1.793 Test Acc: 0.533
Validation loss decreased (-0.533315 --> -0.533315).  Saving model ...
Epoch: 30 cost time: 5.936262369155884
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.787 Vali Acc: 0.530 Test Loss: 1.787 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.788528919219971
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.785 Vali Acc: 0.527 Test Loss: 1.785 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.803115367889404
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.533 Test Loss: 1.782 Test Acc: 0.533
Validation loss decreased (-0.533315 --> -0.533316).  Saving model ...
Epoch: 33 cost time: 5.784238576889038
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.776 Vali Acc: 0.543 Test Loss: 1.776 Test Acc: 0.543
Validation loss decreased (-0.533316 --> -0.543316).  Saving model ...
Epoch: 34 cost time: 5.895176410675049
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.771 Vali Acc: 0.547 Test Loss: 1.771 Test Acc: 0.547
Validation loss decreased (-0.543316 --> -0.546649).  Saving model ...
Epoch: 35 cost time: 5.837699890136719
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.769 Vali Acc: 0.550 Test Loss: 1.769 Test Acc: 0.550
Validation loss decreased (-0.546649 --> -0.549982).  Saving model ...
Epoch: 36 cost time: 6.013854742050171
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.768 Vali Acc: 0.540 Test Loss: 1.768 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.855311393737793
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.769 Vali Acc: 0.550 Test Loss: 1.769 Test Acc: 0.550
Validation loss decreased (-0.549982 --> -0.549982).  Saving model ...
Epoch: 38 cost time: 5.774521350860596
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.765 Vali Acc: 0.550 Test Loss: 1.765 Test Acc: 0.550
Validation loss decreased (-0.549982 --> -0.549982).  Saving model ...
Epoch: 39 cost time: 5.738059997558594
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.762 Vali Acc: 0.557 Test Loss: 1.762 Test Acc: 0.557
Validation loss decreased (-0.549982 --> -0.556649).  Saving model ...
Epoch: 40 cost time: 6.046815395355225
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.757 Vali Acc: 0.557 Test Loss: 1.757 Test Acc: 0.557
Validation loss decreased (-0.556649 --> -0.556649).  Saving model ...
Epoch: 41 cost time: 5.673838376998901
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.752 Vali Acc: 0.557 Test Loss: 1.752 Test Acc: 0.557
Validation loss decreased (-0.556649 --> -0.556649).  Saving model ...
Epoch: 42 cost time: 5.662018537521362
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.751 Vali Acc: 0.563 Test Loss: 1.751 Test Acc: 0.563
Validation loss decreased (-0.556649 --> -0.563316).  Saving model ...
Epoch: 43 cost time: 5.812771320343018
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.750 Vali Acc: 0.563 Test Loss: 1.750 Test Acc: 0.563
Validation loss decreased (-0.563316 --> -0.563316).  Saving model ...
Epoch: 44 cost time: 6.08355450630188
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.747 Vali Acc: 0.563 Test Loss: 1.747 Test Acc: 0.563
Validation loss decreased (-0.563316 --> -0.563316).  Saving model ...
Epoch: 45 cost time: 6.016046762466431
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.744 Vali Acc: 0.570 Test Loss: 1.744 Test Acc: 0.570
Validation loss decreased (-0.563316 --> -0.569983).  Saving model ...
Epoch: 46 cost time: 6.270723581314087
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.744 Vali Acc: 0.563 Test Loss: 1.744 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.057830810546875
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.743 Vali Acc: 0.560 Test Loss: 1.743 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 5.971689462661743
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.743 Vali Acc: 0.563 Test Loss: 1.743 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 5.783018112182617
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.563 Test Loss: 1.742 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 6.100091934204102
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.744 Vali Acc: 0.570 Test Loss: 1.744 Test Acc: 0.570
Validation loss decreased (-0.569983 --> -0.569983).  Saving model ...
Epoch: 51 cost time: 5.990786552429199
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.743 Vali Acc: 0.567 Test Loss: 1.743 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.222038507461548
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.740 Vali Acc: 0.570 Test Loss: 1.740 Test Acc: 0.570
Validation loss decreased (-0.569983 --> -0.569983).  Saving model ...
Epoch: 53 cost time: 6.261536359786987
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.737 Vali Acc: 0.573 Test Loss: 1.737 Test Acc: 0.573
Validation loss decreased (-0.569983 --> -0.573316).  Saving model ...
Epoch: 54 cost time: 6.095671653747559
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.736 Vali Acc: 0.570 Test Loss: 1.736 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.393221378326416
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.737 Vali Acc: 0.577 Test Loss: 1.737 Test Acc: 0.577
Validation loss decreased (-0.573316 --> -0.576649).  Saving model ...
Epoch: 56 cost time: 6.160740852355957
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.732 Vali Acc: 0.577 Test Loss: 1.732 Test Acc: 0.577
Validation loss decreased (-0.576649 --> -0.576649).  Saving model ...
Epoch: 57 cost time: 5.81646728515625
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.730 Vali Acc: 0.580 Test Loss: 1.730 Test Acc: 0.580
Validation loss decreased (-0.576649 --> -0.579983).  Saving model ...
Epoch: 58 cost time: 5.9246931076049805
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.726 Vali Acc: 0.580 Test Loss: 1.726 Test Acc: 0.580
Validation loss decreased (-0.579983 --> -0.579983).  Saving model ...
Epoch: 59 cost time: 5.392621994018555
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.583 Test Loss: 1.725 Test Acc: 0.583
Validation loss decreased (-0.579983 --> -0.583316).  Saving model ...
Epoch: 60 cost time: 5.709375858306885
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.723 Vali Acc: 0.583 Test Loss: 1.723 Test Acc: 0.583
Validation loss decreased (-0.583316 --> -0.583316).  Saving model ...
Epoch: 61 cost time: 5.901855230331421
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.724 Vali Acc: 0.580 Test Loss: 1.724 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 5.697927951812744
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.580 Test Loss: 1.727 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 5.752454519271851
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.577 Test Loss: 1.727 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 5.828378915786743
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.587 Test Loss: 1.725 Test Acc: 0.587
Validation loss decreased (-0.583316 --> -0.586649).  Saving model ...
Epoch: 65 cost time: 6.023522615432739
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.587 Test Loss: 1.721 Test Acc: 0.587
Validation loss decreased (-0.586649 --> -0.586649).  Saving model ...
Epoch: 66 cost time: 5.742058753967285
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.720 Vali Acc: 0.583 Test Loss: 1.720 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 5.8533313274383545
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.719 Vali Acc: 0.587 Test Loss: 1.719 Test Acc: 0.587
Validation loss decreased (-0.586649 --> -0.586649).  Saving model ...
Epoch: 68 cost time: 5.719524383544922
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.716 Vali Acc: 0.587 Test Loss: 1.716 Test Acc: 0.587
Validation loss decreased (-0.586649 --> -0.586650).  Saving model ...
Epoch: 69 cost time: 6.017502069473267
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.587 Test Loss: 1.715 Test Acc: 0.587
Validation loss decreased (-0.586650 --> -0.586650).  Saving model ...
Epoch: 70 cost time: 5.669969081878662
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.714 Vali Acc: 0.587 Test Loss: 1.714 Test Acc: 0.587
Validation loss decreased (-0.586650 --> -0.586650).  Saving model ...
Epoch: 71 cost time: 6.04328989982605
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.587 Test Loss: 1.715 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.880960941314697
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.587 Test Loss: 1.715 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.132098436355591
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.713 Vali Acc: 0.587 Test Loss: 1.713 Test Acc: 0.587
Validation loss decreased (-0.586650 --> -0.586650).  Saving model ...
Epoch: 74 cost time: 5.986004590988159
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.713 Vali Acc: 0.587 Test Loss: 1.713 Test Acc: 0.587
Validation loss decreased (-0.586650 --> -0.586650).  Saving model ...
Epoch: 75 cost time: 6.125491619110107
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.711 Vali Acc: 0.587 Test Loss: 1.711 Test Acc: 0.587
Validation loss decreased (-0.586650 --> -0.586650).  Saving model ...
Epoch: 76 cost time: 5.585039138793945
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.710 Vali Acc: 0.590 Test Loss: 1.710 Test Acc: 0.590
Validation loss decreased (-0.586650 --> -0.589983).  Saving model ...
Epoch: 77 cost time: 5.731560707092285
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.709 Vali Acc: 0.597 Test Loss: 1.709 Test Acc: 0.597
Validation loss decreased (-0.589983 --> -0.596650).  Saving model ...
Epoch: 78 cost time: 5.988522291183472
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.708 Vali Acc: 0.590 Test Loss: 1.708 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 6.069733381271362
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.587 Test Loss: 1.706 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 5.6314966678619385
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.587 Test Loss: 1.706 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 5.674518346786499
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.590 Test Loss: 1.704 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 5.442082166671753
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.702 Vali Acc: 0.590 Test Loss: 1.702 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 5.718338251113892
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.701 Vali Acc: 0.590 Test Loss: 1.701 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 5.952242612838745
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.590 Test Loss: 1.700 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 6.171226263046265
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.587 Test Loss: 1.700 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 6.248171806335449
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.701 Vali Acc: 0.590 Test Loss: 1.701 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 6.211997747421265
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.701 Vali Acc: 0.593 Test Loss: 1.701 Test Acc: 0.593
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5966666666666667
model parameter : 15513625
model size : 78.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.575557470321655
Epoch: 1, Steps: 18 | Train Loss: 3.261 Vali Loss: 3.096 Vali Acc: 0.067 Test Loss: 3.096 Test Acc: 0.067
Validation loss decreased (inf --> -0.066636).  Saving model ...
Epoch: 2 cost time: 6.0160298347473145
Epoch: 2, Steps: 18 | Train Loss: 1.502 Vali Loss: 2.893 Vali Acc: 0.183 Test Loss: 2.893 Test Acc: 0.183
Validation loss decreased (-0.066636 --> -0.183304).  Saving model ...
Epoch: 3 cost time: 6.472098112106323
Epoch: 3, Steps: 18 | Train Loss: 0.243 Vali Loss: 2.797 Vali Acc: 0.227 Test Loss: 2.797 Test Acc: 0.227
Validation loss decreased (-0.183304 --> -0.226639).  Saving model ...
Epoch: 4 cost time: 6.508396625518799
Epoch: 4, Steps: 18 | Train Loss: 0.027 Vali Loss: 2.631 Vali Acc: 0.303 Test Loss: 2.631 Test Acc: 0.303
Validation loss decreased (-0.226639 --> -0.303307).  Saving model ...
Epoch: 5 cost time: 6.651819467544556
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.705 Vali Acc: 0.270 Test Loss: 2.705 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.537795543670654
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.701 Vali Acc: 0.310 Test Loss: 2.701 Test Acc: 0.310
Validation loss decreased (-0.303307 --> -0.309973).  Saving model ...
Epoch: 7 cost time: 6.669557332992554
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.545 Vali Acc: 0.310 Test Loss: 2.545 Test Acc: 0.310
Validation loss decreased (-0.309973 --> -0.309975).  Saving model ...
Epoch: 8 cost time: 6.137684106826782
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.464 Vali Acc: 0.340 Test Loss: 2.464 Test Acc: 0.340
Validation loss decreased (-0.309975 --> -0.339975).  Saving model ...
Epoch: 9 cost time: 6.624301195144653
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.438 Vali Acc: 0.343 Test Loss: 2.438 Test Acc: 0.343
Validation loss decreased (-0.339975 --> -0.343309).  Saving model ...
Epoch: 10 cost time: 6.015407562255859
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.430 Vali Acc: 0.347 Test Loss: 2.430 Test Acc: 0.347
Validation loss decreased (-0.343309 --> -0.346642).  Saving model ...
Epoch: 11 cost time: 6.126158952713013
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.411 Vali Acc: 0.350 Test Loss: 2.411 Test Acc: 0.350
Validation loss decreased (-0.346642 --> -0.349976).  Saving model ...
Epoch: 12 cost time: 6.0702502727508545
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.390 Vali Acc: 0.347 Test Loss: 2.390 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.201892375946045
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.398 Vali Acc: 0.367 Test Loss: 2.398 Test Acc: 0.367
Validation loss decreased (-0.349976 --> -0.366643).  Saving model ...
Epoch: 14 cost time: 6.292022705078125
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.367 Vali Acc: 0.383 Test Loss: 2.367 Test Acc: 0.383
Validation loss decreased (-0.366643 --> -0.383310).  Saving model ...
Epoch: 15 cost time: 6.4061338901519775
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.329 Vali Acc: 0.383 Test Loss: 2.329 Test Acc: 0.383
Validation loss decreased (-0.383310 --> -0.383310).  Saving model ...
Epoch: 16 cost time: 6.767792701721191
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.295 Vali Acc: 0.393 Test Loss: 2.295 Test Acc: 0.393
Validation loss decreased (-0.383310 --> -0.393310).  Saving model ...
Epoch: 17 cost time: 6.159103631973267
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.272 Vali Acc: 0.407 Test Loss: 2.272 Test Acc: 0.407
Validation loss decreased (-0.393310 --> -0.406644).  Saving model ...
Epoch: 18 cost time: 5.9767115116119385
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.259 Vali Acc: 0.413 Test Loss: 2.259 Test Acc: 0.413
Validation loss decreased (-0.406644 --> -0.413311).  Saving model ...
Epoch: 19 cost time: 6.291765213012695
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.244 Vali Acc: 0.417 Test Loss: 2.244 Test Acc: 0.417
Validation loss decreased (-0.413311 --> -0.416644).  Saving model ...
Epoch: 20 cost time: 5.962541103363037
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.225 Vali Acc: 0.427 Test Loss: 2.225 Test Acc: 0.427
Validation loss decreased (-0.416644 --> -0.426644).  Saving model ...
Epoch: 21 cost time: 5.852067708969116
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.217 Vali Acc: 0.433 Test Loss: 2.217 Test Acc: 0.433
Validation loss decreased (-0.426644 --> -0.433311).  Saving model ...
Epoch: 22 cost time: 6.3142900466918945
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.202 Vali Acc: 0.443 Test Loss: 2.202 Test Acc: 0.443
Validation loss decreased (-0.433311 --> -0.443311).  Saving model ...
Epoch: 23 cost time: 6.369811534881592
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.191 Vali Acc: 0.447 Test Loss: 2.191 Test Acc: 0.447
Validation loss decreased (-0.443311 --> -0.446645).  Saving model ...
Epoch: 24 cost time: 6.383421897888184
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.172 Vali Acc: 0.453 Test Loss: 2.172 Test Acc: 0.453
Validation loss decreased (-0.446645 --> -0.453312).  Saving model ...
Epoch: 25 cost time: 6.654540061950684
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.152 Vali Acc: 0.453 Test Loss: 2.152 Test Acc: 0.453
Validation loss decreased (-0.453312 --> -0.453312).  Saving model ...
Epoch: 26 cost time: 5.8777077198028564
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.144 Vali Acc: 0.453 Test Loss: 2.144 Test Acc: 0.453
Validation loss decreased (-0.453312 --> -0.453312).  Saving model ...
Epoch: 27 cost time: 6.125489950180054
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.140 Vali Acc: 0.460 Test Loss: 2.140 Test Acc: 0.460
Validation loss decreased (-0.453312 --> -0.459979).  Saving model ...
Epoch: 28 cost time: 6.16255521774292
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.130 Vali Acc: 0.463 Test Loss: 2.130 Test Acc: 0.463
Validation loss decreased (-0.459979 --> -0.463312).  Saving model ...
Epoch: 29 cost time: 5.967450141906738
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.123 Vali Acc: 0.460 Test Loss: 2.123 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.19733190536499
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.114 Vali Acc: 0.473 Test Loss: 2.114 Test Acc: 0.473
Validation loss decreased (-0.463312 --> -0.473312).  Saving model ...
Epoch: 31 cost time: 6.232391357421875
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.106 Vali Acc: 0.483 Test Loss: 2.106 Test Acc: 0.483
Validation loss decreased (-0.473312 --> -0.483312).  Saving model ...
Epoch: 32 cost time: 6.447631597518921
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.099 Vali Acc: 0.477 Test Loss: 2.099 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.591368198394775
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.090 Vali Acc: 0.480 Test Loss: 2.090 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.556992053985596
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.083 Vali Acc: 0.477 Test Loss: 2.083 Test Acc: 0.477
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.977647066116333
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.075 Vali Acc: 0.477 Test Loss: 2.075 Test Acc: 0.477
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 6.047370910644531
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.066 Vali Acc: 0.480 Test Loss: 2.066 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 6.260603427886963
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.064 Vali Acc: 0.477 Test Loss: 2.064 Test Acc: 0.477
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 6.1590352058410645
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.062 Vali Acc: 0.480 Test Loss: 2.062 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 6.110313653945923
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.060 Vali Acc: 0.483 Test Loss: 2.060 Test Acc: 0.483
Validation loss decreased (-0.483312 --> -0.483313).  Saving model ...
Epoch: 40 cost time: 6.022910118103027
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.047 Vali Acc: 0.487 Test Loss: 2.047 Test Acc: 0.487
Validation loss decreased (-0.483313 --> -0.486646).  Saving model ...
Epoch: 41 cost time: 6.345663785934448
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.041 Vali Acc: 0.483 Test Loss: 2.041 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.207549571990967
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.036 Vali Acc: 0.493 Test Loss: 2.036 Test Acc: 0.493
Validation loss decreased (-0.486646 --> -0.493313).  Saving model ...
Epoch: 43 cost time: 6.637695789337158
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.030 Vali Acc: 0.490 Test Loss: 2.030 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.01098895072937
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.024 Vali Acc: 0.500 Test Loss: 2.024 Test Acc: 0.500
Validation loss decreased (-0.493313 --> -0.499980).  Saving model ...
Epoch: 45 cost time: 6.895037651062012
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.016 Vali Acc: 0.503 Test Loss: 2.016 Test Acc: 0.503
Validation loss decreased (-0.499980 --> -0.503313).  Saving model ...
Epoch: 46 cost time: 6.499075889587402
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.013 Vali Acc: 0.510 Test Loss: 2.013 Test Acc: 0.510
Validation loss decreased (-0.503313 --> -0.509980).  Saving model ...
Epoch: 47 cost time: 6.188877820968628
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.507 Test Loss: 2.012 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 6.197375535964966
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.009 Vali Acc: 0.510 Test Loss: 2.009 Test Acc: 0.510
Validation loss decreased (-0.509980 --> -0.509980).  Saving model ...
Epoch: 49 cost time: 6.707492113113403
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.004 Vali Acc: 0.510 Test Loss: 2.004 Test Acc: 0.510
Validation loss decreased (-0.509980 --> -0.509980).  Saving model ...
Epoch: 50 cost time: 6.471282720565796
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.998 Vali Acc: 0.510 Test Loss: 1.998 Test Acc: 0.510
Validation loss decreased (-0.509980 --> -0.509980).  Saving model ...
Epoch: 51 cost time: 6.647273063659668
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.996 Vali Acc: 0.520 Test Loss: 1.996 Test Acc: 0.520
Validation loss decreased (-0.509980 --> -0.519980).  Saving model ...
Epoch: 52 cost time: 6.186966419219971
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.992 Vali Acc: 0.520 Test Loss: 1.992 Test Acc: 0.520
Validation loss decreased (-0.519980 --> -0.519980).  Saving model ...
Epoch: 53 cost time: 6.490297079086304
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.988 Vali Acc: 0.523 Test Loss: 1.988 Test Acc: 0.523
Validation loss decreased (-0.519980 --> -0.523313).  Saving model ...
Epoch: 54 cost time: 6.444171905517578
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.987 Vali Acc: 0.530 Test Loss: 1.987 Test Acc: 0.530
Validation loss decreased (-0.523313 --> -0.529980).  Saving model ...
Epoch: 55 cost time: 5.838382959365845
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.983 Vali Acc: 0.530 Test Loss: 1.983 Test Acc: 0.530
Validation loss decreased (-0.529980 --> -0.529980).  Saving model ...
Epoch: 56 cost time: 6.037542819976807
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.982 Vali Acc: 0.537 Test Loss: 1.982 Test Acc: 0.537
Validation loss decreased (-0.529980 --> -0.536647).  Saving model ...
Epoch: 57 cost time: 6.3536694049835205
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.977 Vali Acc: 0.537 Test Loss: 1.977 Test Acc: 0.537
Validation loss decreased (-0.536647 --> -0.536647).  Saving model ...
Epoch: 58 cost time: 6.499286413192749
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.543 Test Loss: 1.973 Test Acc: 0.543
Validation loss decreased (-0.536647 --> -0.543314).  Saving model ...
Epoch: 59 cost time: 6.234652757644653
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.970 Vali Acc: 0.533 Test Loss: 1.970 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 6.233774662017822
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.968 Vali Acc: 0.540 Test Loss: 1.968 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 6.059916734695435
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.965 Vali Acc: 0.537 Test Loss: 1.965 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 6.116650581359863
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.959 Vali Acc: 0.543 Test Loss: 1.959 Test Acc: 0.543
Validation loss decreased (-0.543314 --> -0.543314).  Saving model ...
Epoch: 63 cost time: 6.338626146316528
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.955 Vali Acc: 0.543 Test Loss: 1.955 Test Acc: 0.543
Validation loss decreased (-0.543314 --> -0.543314).  Saving model ...
Epoch: 64 cost time: 5.955205678939819
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.952 Vali Acc: 0.543 Test Loss: 1.952 Test Acc: 0.543
Validation loss decreased (-0.543314 --> -0.543314).  Saving model ...
Epoch: 65 cost time: 6.1396307945251465
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.952 Vali Acc: 0.543 Test Loss: 1.952 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 6.373929023742676
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.953 Vali Acc: 0.543 Test Loss: 1.953 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 6.422482252120972
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.950 Vali Acc: 0.540 Test Loss: 1.950 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 6.215615272521973
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.944 Vali Acc: 0.540 Test Loss: 1.944 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 6.1768176555633545
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.943 Vali Acc: 0.547 Test Loss: 1.943 Test Acc: 0.547
Validation loss decreased (-0.543314 --> -0.546647).  Saving model ...
Epoch: 70 cost time: 6.419405221939087
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.937 Vali Acc: 0.553 Test Loss: 1.937 Test Acc: 0.553
Validation loss decreased (-0.546647 --> -0.553314).  Saving model ...
Epoch: 71 cost time: 5.751107692718506
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.935 Vali Acc: 0.553 Test Loss: 1.935 Test Acc: 0.553
Validation loss decreased (-0.553314 --> -0.553314).  Saving model ...
Epoch: 72 cost time: 5.9100518226623535
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.932 Vali Acc: 0.560 Test Loss: 1.932 Test Acc: 0.560
Validation loss decreased (-0.553314 --> -0.559981).  Saving model ...
Epoch: 73 cost time: 5.9211225509643555
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.929 Vali Acc: 0.563 Test Loss: 1.929 Test Acc: 0.563
Validation loss decreased (-0.559981 --> -0.563314).  Saving model ...
Epoch: 74 cost time: 6.421146869659424
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.924 Vali Acc: 0.567 Test Loss: 1.924 Test Acc: 0.567
Validation loss decreased (-0.563314 --> -0.566647).  Saving model ...
Epoch: 75 cost time: 6.130017518997192
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.923 Vali Acc: 0.563 Test Loss: 1.923 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 6.29482364654541
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.926 Vali Acc: 0.567 Test Loss: 1.926 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 6.016194581985474
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.923 Vali Acc: 0.570 Test Loss: 1.923 Test Acc: 0.570
Validation loss decreased (-0.566647 --> -0.569981).  Saving model ...
Epoch: 78 cost time: 5.946275949478149
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.919 Vali Acc: 0.573 Test Loss: 1.919 Test Acc: 0.573
Validation loss decreased (-0.569981 --> -0.573314).  Saving model ...
Epoch: 79 cost time: 6.329342842102051
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.915 Vali Acc: 0.577 Test Loss: 1.915 Test Acc: 0.577
Validation loss decreased (-0.573314 --> -0.576648).  Saving model ...
Epoch: 80 cost time: 6.2026894092559814
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.912 Vali Acc: 0.577 Test Loss: 1.912 Test Acc: 0.577
Validation loss decreased (-0.576648 --> -0.576648).  Saving model ...
Epoch: 81 cost time: 5.956824064254761
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.910 Vali Acc: 0.580 Test Loss: 1.910 Test Acc: 0.580
Validation loss decreased (-0.576648 --> -0.579981).  Saving model ...
Epoch: 82 cost time: 6.1014533042907715
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.909 Vali Acc: 0.580 Test Loss: 1.909 Test Acc: 0.580
Validation loss decreased (-0.579981 --> -0.579981).  Saving model ...
Epoch: 83 cost time: 6.522669315338135
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.906 Vali Acc: 0.577 Test Loss: 1.906 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 6.144022226333618
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.904 Vali Acc: 0.577 Test Loss: 1.904 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 6.411696672439575
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.903 Vali Acc: 0.583 Test Loss: 1.903 Test Acc: 0.583
Validation loss decreased (-0.579981 --> -0.583314).  Saving model ...
Epoch: 86 cost time: 6.193484783172607
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.583 Test Loss: 1.901 Test Acc: 0.583
Validation loss decreased (-0.583314 --> -0.583314).  Saving model ...
Epoch: 87 cost time: 5.969611883163452
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.899 Vali Acc: 0.583 Test Loss: 1.899 Test Acc: 0.583
Validation loss decreased (-0.583314 --> -0.583314).  Saving model ...
Epoch: 88 cost time: 6.220205545425415
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.898 Vali Acc: 0.587 Test Loss: 1.898 Test Acc: 0.587
Validation loss decreased (-0.583314 --> -0.586648).  Saving model ...
Epoch: 89 cost time: 6.067231893539429
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.896 Vali Acc: 0.587 Test Loss: 1.896 Test Acc: 0.587
Validation loss decreased (-0.586648 --> -0.586648).  Saving model ...
Epoch: 90 cost time: 6.068693161010742
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.587 Test Loss: 1.895 Test Acc: 0.587
Validation loss decreased (-0.586648 --> -0.586648).  Saving model ...
Epoch: 91 cost time: 5.791931629180908
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.893 Vali Acc: 0.583 Test Loss: 1.893 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 6.061010360717773
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.891 Vali Acc: 0.583 Test Loss: 1.891 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 6.1917502880096436
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.889 Vali Acc: 0.583 Test Loss: 1.889 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 6.086014270782471
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.889 Vali Acc: 0.587 Test Loss: 1.889 Test Acc: 0.587
Validation loss decreased (-0.586648 --> -0.586648).  Saving model ...
Epoch: 95 cost time: 6.469054460525513
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.889 Vali Acc: 0.587 Test Loss: 1.889 Test Acc: 0.587
Validation loss decreased (-0.586648 --> -0.586648).  Saving model ...
Epoch: 96 cost time: 6.298628330230713
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.593 Test Loss: 1.886 Test Acc: 0.593
Validation loss decreased (-0.586648 --> -0.593314).  Saving model ...
Epoch: 97 cost time: 6.2268147468566895
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.887 Vali Acc: 0.593 Test Loss: 1.887 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 6.174752950668335
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.887 Vali Acc: 0.593 Test Loss: 1.887 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 6.161524772644043
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.593 Test Loss: 1.886 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 6.310242652893066
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.884 Vali Acc: 0.587 Test Loss: 1.884 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5933333333333334
model parameter : 15513625
model size : 78.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.732745885848999
Epoch: 1, Steps: 18 | Train Loss: 3.271 Vali Loss: 3.063 Vali Acc: 0.057 Test Loss: 3.063 Test Acc: 0.057
Validation loss decreased (inf --> -0.056636).  Saving model ...
Epoch: 2 cost time: 6.441123723983765
Epoch: 2, Steps: 18 | Train Loss: 1.736 Vali Loss: 2.802 Vali Acc: 0.187 Test Loss: 2.802 Test Acc: 0.187
Validation loss decreased (-0.056636 --> -0.186639).  Saving model ...
Epoch: 3 cost time: 6.304408073425293
Epoch: 3, Steps: 18 | Train Loss: 0.381 Vali Loss: 2.509 Vali Acc: 0.293 Test Loss: 2.509 Test Acc: 0.293
Validation loss decreased (-0.186639 --> -0.293308).  Saving model ...
Epoch: 4 cost time: 5.709514856338501
Epoch: 4, Steps: 18 | Train Loss: 0.044 Vali Loss: 2.372 Vali Acc: 0.367 Test Loss: 2.372 Test Acc: 0.367
Validation loss decreased (-0.293308 --> -0.366643).  Saving model ...
Epoch: 5 cost time: 5.735780715942383
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.657 Vali Acc: 0.327 Test Loss: 2.657 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.99154806137085
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.196 Vali Acc: 0.400 Test Loss: 2.196 Test Acc: 0.400
Validation loss decreased (-0.366643 --> -0.399978).  Saving model ...
Epoch: 7 cost time: 5.811712741851807
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.010 Vali Acc: 0.440 Test Loss: 2.010 Test Acc: 0.440
Validation loss decreased (-0.399978 --> -0.439980).  Saving model ...
Epoch: 8 cost time: 6.074992656707764
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.965 Vali Acc: 0.453 Test Loss: 1.965 Test Acc: 0.453
Validation loss decreased (-0.439980 --> -0.453314).  Saving model ...
Epoch: 9 cost time: 5.88169264793396
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.987 Vali Acc: 0.440 Test Loss: 1.987 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.314335346221924
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.906 Vali Acc: 0.463 Test Loss: 1.906 Test Acc: 0.463
Validation loss decreased (-0.453314 --> -0.463314).  Saving model ...
Epoch: 11 cost time: 6.408360719680786
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.477 Test Loss: 1.843 Test Acc: 0.477
Validation loss decreased (-0.463314 --> -0.476648).  Saving model ...
Epoch: 12 cost time: 5.758604049682617
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.812 Vali Acc: 0.493 Test Loss: 1.812 Test Acc: 0.493
Validation loss decreased (-0.476648 --> -0.493315).  Saving model ...
Epoch: 13 cost time: 6.024716377258301
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.513 Test Loss: 1.794 Test Acc: 0.513
Validation loss decreased (-0.493315 --> -0.513315).  Saving model ...
Epoch: 14 cost time: 5.770968437194824
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.792 Vali Acc: 0.510 Test Loss: 1.792 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.99423623085022
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.769 Vali Acc: 0.527 Test Loss: 1.769 Test Acc: 0.527
Validation loss decreased (-0.513315 --> -0.526649).  Saving model ...
Epoch: 16 cost time: 6.246912240982056
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.746 Vali Acc: 0.537 Test Loss: 1.746 Test Acc: 0.537
Validation loss decreased (-0.526649 --> -0.536649).  Saving model ...
Epoch: 17 cost time: 6.148672819137573
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.537 Test Loss: 1.734 Test Acc: 0.537
Validation loss decreased (-0.536649 --> -0.536649).  Saving model ...
Epoch: 18 cost time: 6.2428131103515625
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.547 Test Loss: 1.721 Test Acc: 0.547
Validation loss decreased (-0.536649 --> -0.546649).  Saving model ...
Epoch: 19 cost time: 6.20470929145813
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.701 Vali Acc: 0.547 Test Loss: 1.701 Test Acc: 0.547
Validation loss decreased (-0.546649 --> -0.546650).  Saving model ...
Epoch: 20 cost time: 5.940004110336304
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.547 Test Loss: 1.685 Test Acc: 0.547
Validation loss decreased (-0.546650 --> -0.546650).  Saving model ...
Epoch: 21 cost time: 5.685906410217285
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.670 Vali Acc: 0.547 Test Loss: 1.670 Test Acc: 0.547
Validation loss decreased (-0.546650 --> -0.546650).  Saving model ...
Epoch: 22 cost time: 5.905392408370972
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.661 Vali Acc: 0.547 Test Loss: 1.661 Test Acc: 0.547
Validation loss decreased (-0.546650 --> -0.546650).  Saving model ...
Epoch: 23 cost time: 5.665870904922485
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.656 Vali Acc: 0.553 Test Loss: 1.656 Test Acc: 0.553
Validation loss decreased (-0.546650 --> -0.553317).  Saving model ...
Epoch: 24 cost time: 5.536681413650513
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.646 Vali Acc: 0.560 Test Loss: 1.646 Test Acc: 0.560
Validation loss decreased (-0.553317 --> -0.559984).  Saving model ...
Epoch: 25 cost time: 5.6896748542785645
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.560 Test Loss: 1.639 Test Acc: 0.560
Validation loss decreased (-0.559984 --> -0.559984).  Saving model ...
Epoch: 26 cost time: 5.998415231704712
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.567 Test Loss: 1.625 Test Acc: 0.567
Validation loss decreased (-0.559984 --> -0.566650).  Saving model ...
Epoch: 27 cost time: 5.9657981395721436
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.577 Test Loss: 1.624 Test Acc: 0.577
Validation loss decreased (-0.566650 --> -0.576650).  Saving model ...
Epoch: 28 cost time: 6.217744827270508
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.629 Vali Acc: 0.573 Test Loss: 1.629 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.118971109390259
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.570 Test Loss: 1.627 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.65273380279541
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.613 Vali Acc: 0.587 Test Loss: 1.613 Test Acc: 0.587
Validation loss decreased (-0.576650 --> -0.586651).  Saving model ...
Epoch: 31 cost time: 5.963963508605957
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.590 Test Loss: 1.610 Test Acc: 0.590
Validation loss decreased (-0.586651 --> -0.589984).  Saving model ...
Epoch: 32 cost time: 6.319072961807251
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.593 Test Loss: 1.607 Test Acc: 0.593
Validation loss decreased (-0.589984 --> -0.593317).  Saving model ...
Epoch: 33 cost time: 5.671226263046265
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.600 Vali Acc: 0.597 Test Loss: 1.600 Test Acc: 0.597
Validation loss decreased (-0.593317 --> -0.596651).  Saving model ...
Epoch: 34 cost time: 5.797746181488037
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.595 Vali Acc: 0.590 Test Loss: 1.595 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.914368152618408
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.600 Test Loss: 1.585 Test Acc: 0.600
Validation loss decreased (-0.596651 --> -0.599984).  Saving model ...
Epoch: 36 cost time: 5.744619846343994
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.603 Test Loss: 1.578 Test Acc: 0.603
Validation loss decreased (-0.599984 --> -0.603318).  Saving model ...
Epoch: 37 cost time: 6.086849689483643
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.607 Test Loss: 1.575 Test Acc: 0.607
Validation loss decreased (-0.603318 --> -0.606651).  Saving model ...
Epoch: 38 cost time: 5.758533000946045
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.607 Test Loss: 1.575 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.104858160018921
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.607 Test Loss: 1.575 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 5.9402570724487305
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.571 Vali Acc: 0.610 Test Loss: 1.571 Test Acc: 0.610
Validation loss decreased (-0.606651 --> -0.609984).  Saving model ...
Epoch: 41 cost time: 5.6092212200164795
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.563 Vali Acc: 0.613 Test Loss: 1.563 Test Acc: 0.613
Validation loss decreased (-0.609984 --> -0.613318).  Saving model ...
Epoch: 42 cost time: 6.279189825057983
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.620 Test Loss: 1.562 Test Acc: 0.620
Validation loss decreased (-0.613318 --> -0.619984).  Saving model ...
Epoch: 43 cost time: 6.2619616985321045
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.620 Test Loss: 1.559 Test Acc: 0.620
Validation loss decreased (-0.619984 --> -0.619984).  Saving model ...
Epoch: 44 cost time: 5.889861822128296
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.560 Vali Acc: 0.620 Test Loss: 1.560 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 6.117544889450073
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.623 Test Loss: 1.554 Test Acc: 0.623
Validation loss decreased (-0.619984 --> -0.623318).  Saving model ...
Epoch: 46 cost time: 6.595183610916138
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.627 Test Loss: 1.553 Test Acc: 0.627
Validation loss decreased (-0.623318 --> -0.626651).  Saving model ...
Epoch: 47 cost time: 5.9103803634643555
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.552 Vali Acc: 0.627 Test Loss: 1.552 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 48 cost time: 6.25702428817749
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.552 Vali Acc: 0.627 Test Loss: 1.552 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 49 cost time: 5.679820537567139
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.637 Test Loss: 1.551 Test Acc: 0.637
Validation loss decreased (-0.626651 --> -0.636651).  Saving model ...
Epoch: 50 cost time: 5.697014808654785
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.637 Test Loss: 1.551 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.590824842453003
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.633 Test Loss: 1.554 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 5.38278865814209
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.630 Test Loss: 1.547 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 5.805129528045654
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.544 Vali Acc: 0.633 Test Loss: 1.544 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 5.865147590637207
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.542 Vali Acc: 0.643 Test Loss: 1.542 Test Acc: 0.643
Validation loss decreased (-0.636651 --> -0.643318).  Saving model ...
Epoch: 55 cost time: 5.6938395500183105
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.537 Vali Acc: 0.647 Test Loss: 1.537 Test Acc: 0.647
Validation loss decreased (-0.643318 --> -0.646651).  Saving model ...
Epoch: 56 cost time: 5.757809400558472
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.647 Test Loss: 1.535 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 57 cost time: 5.748619556427002
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.647 Test Loss: 1.533 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 58 cost time: 5.7684385776519775
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.643 Test Loss: 1.534 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.472161769866943
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.647 Test Loss: 1.534 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 5.56534481048584
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.640 Test Loss: 1.539 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 5.969191312789917
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.640 Test Loss: 1.540 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 6.11609959602356
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.647 Test Loss: 1.540 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 6.183354139328003
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.650 Test Loss: 1.535 Test Acc: 0.650
Validation loss decreased (-0.646651 --> -0.649985).  Saving model ...
Epoch: 64 cost time: 6.126281976699829
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.653 Test Loss: 1.531 Test Acc: 0.653
Validation loss decreased (-0.649985 --> -0.653318).  Saving model ...
Epoch: 65 cost time: 6.065117597579956
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.653 Test Loss: 1.530 Test Acc: 0.653
Validation loss decreased (-0.653318 --> -0.653318).  Saving model ...
Epoch: 66 cost time: 6.464640140533447
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.657 Test Loss: 1.531 Test Acc: 0.657
Validation loss decreased (-0.653318 --> -0.656651).  Saving model ...
Epoch: 67 cost time: 6.241723537445068
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.653 Test Loss: 1.530 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 5.565680742263794
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.650 Test Loss: 1.528 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 5.520885467529297
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.650 Test Loss: 1.528 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 5.797100782394409
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.650 Test Loss: 1.525 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 5.708531856536865
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.653 Test Loss: 1.527 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 5.9122092723846436
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.657 Test Loss: 1.525 Test Acc: 0.657
Validation loss decreased (-0.656651 --> -0.656651).  Saving model ...
Epoch: 73 cost time: 6.266500473022461
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.653 Test Loss: 1.522 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 5.958997488021851
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.653 Test Loss: 1.517 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 5.9141929149627686
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.657 Test Loss: 1.516 Test Acc: 0.657
Validation loss decreased (-0.656651 --> -0.656652).  Saving model ...
Epoch: 76 cost time: 6.068076133728027
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.657 Test Loss: 1.517 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 5.780590295791626
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.657 Test Loss: 1.516 Test Acc: 0.657
Validation loss decreased (-0.656652 --> -0.656652).  Saving model ...
Epoch: 78 cost time: 5.913250923156738
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.653 Test Loss: 1.515 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 5.955058813095093
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.660 Test Loss: 1.515 Test Acc: 0.660
Validation loss decreased (-0.656652 --> -0.659985).  Saving model ...
Epoch: 80 cost time: 5.875456809997559
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.657 Test Loss: 1.513 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 5.826448917388916
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.657 Test Loss: 1.510 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 5.917710542678833
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.660 Test Loss: 1.509 Test Acc: 0.660
Validation loss decreased (-0.659985 --> -0.659985).  Saving model ...
Epoch: 83 cost time: 5.966921091079712
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.663 Test Loss: 1.506 Test Acc: 0.663
Validation loss decreased (-0.659985 --> -0.663318).  Saving model ...
Epoch: 84 cost time: 5.632578611373901
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.663 Test Loss: 1.506 Test Acc: 0.663
Validation loss decreased (-0.663318 --> -0.663318).  Saving model ...
Epoch: 85 cost time: 6.010952472686768
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.663 Test Loss: 1.506 Test Acc: 0.663
Validation loss decreased (-0.663318 --> -0.663318).  Saving model ...
Epoch: 86 cost time: 5.88132905960083
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.663 Test Loss: 1.505 Test Acc: 0.663
Validation loss decreased (-0.663318 --> -0.663318).  Saving model ...
Epoch: 87 cost time: 5.726969003677368
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.670 Test Loss: 1.503 Test Acc: 0.670
Validation loss decreased (-0.663318 --> -0.669985).  Saving model ...
Epoch: 88 cost time: 6.038024187088013
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.673 Test Loss: 1.501 Test Acc: 0.673
Validation loss decreased (-0.669985 --> -0.673318).  Saving model ...
Epoch: 89 cost time: 6.256922721862793
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.502 Vali Acc: 0.677 Test Loss: 1.502 Test Acc: 0.677
Validation loss decreased (-0.673318 --> -0.676652).  Saving model ...
Epoch: 90 cost time: 5.59837532043457
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.677 Test Loss: 1.500 Test Acc: 0.677
Validation loss decreased (-0.676652 --> -0.676652).  Saving model ...
Epoch: 91 cost time: 6.892365455627441
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.677 Test Loss: 1.496 Test Acc: 0.677
Validation loss decreased (-0.676652 --> -0.676652).  Saving model ...
Epoch: 92 cost time: 5.93775749206543
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.680 Test Loss: 1.499 Test Acc: 0.680
Validation loss decreased (-0.676652 --> -0.679985).  Saving model ...
Epoch: 93 cost time: 5.698789596557617
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.680 Test Loss: 1.501 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 5.913492679595947
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.677 Test Loss: 1.505 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 5.777558088302612
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.673 Test Loss: 1.505 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 5.875341176986694
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.502 Vali Acc: 0.680 Test Loss: 1.502 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 5.814959526062012
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.680 Test Loss: 1.503 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 5.988593101501465
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.677 Test Loss: 1.505 Test Acc: 0.677
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 5.858595132827759
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.677 Test Loss: 1.504 Test Acc: 0.677
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 5.620753288269043
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.673 Test Loss: 1.503 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.68
model parameter : 15513625
model size : 78.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.193493604660034
Epoch: 1, Steps: 18 | Train Loss: 3.299 Vali Loss: 3.126 Vali Acc: 0.060 Test Loss: 3.126 Test Acc: 0.060
Validation loss decreased (inf --> -0.059969).  Saving model ...
Epoch: 2 cost time: 5.279842853546143
Epoch: 2, Steps: 18 | Train Loss: 1.798 Vali Loss: 2.855 Vali Acc: 0.170 Test Loss: 2.855 Test Acc: 0.170
Validation loss decreased (-0.059969 --> -0.169971).  Saving model ...
Epoch: 3 cost time: 5.584273815155029
Epoch: 3, Steps: 18 | Train Loss: 0.394 Vali Loss: 2.455 Vali Acc: 0.290 Test Loss: 2.455 Test Acc: 0.290
Validation loss decreased (-0.169971 --> -0.289975).  Saving model ...
Epoch: 4 cost time: 5.744989395141602
Epoch: 4, Steps: 18 | Train Loss: 0.039 Vali Loss: 2.158 Vali Acc: 0.400 Test Loss: 2.158 Test Acc: 0.400
Validation loss decreased (-0.289975 --> -0.399978).  Saving model ...
Epoch: 5 cost time: 5.473912477493286
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.124 Vali Acc: 0.393 Test Loss: 2.124 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.592762231826782
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.924 Vali Acc: 0.437 Test Loss: 1.924 Test Acc: 0.437
Validation loss decreased (-0.399978 --> -0.436647).  Saving model ...
Epoch: 7 cost time: 6.48606014251709
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.798 Vali Acc: 0.493 Test Loss: 1.798 Test Acc: 0.493
Validation loss decreased (-0.436647 --> -0.493315).  Saving model ...
Epoch: 8 cost time: 5.943343162536621
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.747 Vali Acc: 0.497 Test Loss: 1.747 Test Acc: 0.497
Validation loss decreased (-0.493315 --> -0.496649).  Saving model ...
Epoch: 9 cost time: 6.108302593231201
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.731 Vali Acc: 0.507 Test Loss: 1.731 Test Acc: 0.507
Validation loss decreased (-0.496649 --> -0.506649).  Saving model ...
Epoch: 10 cost time: 6.122586011886597
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.710 Vali Acc: 0.503 Test Loss: 1.710 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.407217025756836
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.670 Vali Acc: 0.507 Test Loss: 1.670 Test Acc: 0.507
Validation loss decreased (-0.506649 --> -0.506650).  Saving model ...
Epoch: 12 cost time: 6.139233112335205
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.646 Vali Acc: 0.530 Test Loss: 1.646 Test Acc: 0.530
Validation loss decreased (-0.506650 --> -0.529984).  Saving model ...
Epoch: 13 cost time: 5.841009855270386
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.547 Test Loss: 1.644 Test Acc: 0.547
Validation loss decreased (-0.529984 --> -0.546650).  Saving model ...
Epoch: 14 cost time: 6.013851642608643
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.537 Test Loss: 1.631 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.775433778762817
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.533 Test Loss: 1.608 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.040180444717407
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.550 Test Loss: 1.578 Test Acc: 0.550
Validation loss decreased (-0.546650 --> -0.549984).  Saving model ...
Epoch: 17 cost time: 5.777100563049316
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.560 Vali Acc: 0.573 Test Loss: 1.560 Test Acc: 0.573
Validation loss decreased (-0.549984 --> -0.573318).  Saving model ...
Epoch: 18 cost time: 6.234508752822876
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.587 Test Loss: 1.551 Test Acc: 0.587
Validation loss decreased (-0.573318 --> -0.586651).  Saving model ...
Epoch: 19 cost time: 5.54644250869751
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.593 Test Loss: 1.534 Test Acc: 0.593
Validation loss decreased (-0.586651 --> -0.593318).  Saving model ...
Epoch: 20 cost time: 5.444199562072754
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.593 Test Loss: 1.524 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 21 cost time: 5.310855865478516
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.590 Test Loss: 1.519 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.119369745254517
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.593 Test Loss: 1.512 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 23 cost time: 5.8363037109375
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.593 Test Loss: 1.505 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 24 cost time: 6.102649211883545
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.603 Test Loss: 1.493 Test Acc: 0.603
Validation loss decreased (-0.593318 --> -0.603318).  Saving model ...
Epoch: 25 cost time: 5.89719820022583
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.610 Test Loss: 1.482 Test Acc: 0.610
Validation loss decreased (-0.603318 --> -0.609985).  Saving model ...
Epoch: 26 cost time: 5.756717205047607
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.613 Test Loss: 1.472 Test Acc: 0.613
Validation loss decreased (-0.609985 --> -0.613319).  Saving model ...
Epoch: 27 cost time: 6.085931777954102
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.610 Test Loss: 1.471 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.43335485458374
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.465 Vali Acc: 0.607 Test Loss: 1.465 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.640254497528076
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.610 Test Loss: 1.461 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.246209144592285
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.613 Test Loss: 1.449 Test Acc: 0.613
Validation loss decreased (-0.613319 --> -0.613319).  Saving model ...
Epoch: 31 cost time: 6.236773490905762
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.620 Test Loss: 1.437 Test Acc: 0.620
Validation loss decreased (-0.613319 --> -0.619986).  Saving model ...
Epoch: 32 cost time: 5.69332218170166
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.623 Test Loss: 1.434 Test Acc: 0.623
Validation loss decreased (-0.619986 --> -0.623319).  Saving model ...
Epoch: 33 cost time: 5.59349513053894
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.627 Test Loss: 1.429 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626652).  Saving model ...
Epoch: 34 cost time: 6.09871244430542
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.630 Test Loss: 1.423 Test Acc: 0.630
Validation loss decreased (-0.626652 --> -0.629986).  Saving model ...
Epoch: 35 cost time: 6.119904279708862
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.630 Test Loss: 1.415 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 36 cost time: 5.894041299819946
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.633 Test Loss: 1.414 Test Acc: 0.633
Validation loss decreased (-0.629986 --> -0.633319).  Saving model ...
Epoch: 37 cost time: 5.797108888626099
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.637 Test Loss: 1.415 Test Acc: 0.637
Validation loss decreased (-0.633319 --> -0.636653).  Saving model ...
Epoch: 38 cost time: 5.370715141296387
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.630 Test Loss: 1.413 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.465027093887329
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.637 Test Loss: 1.413 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 40 cost time: 5.8075337409973145
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.647 Test Loss: 1.406 Test Acc: 0.647
Validation loss decreased (-0.636653 --> -0.646653).  Saving model ...
Epoch: 41 cost time: 5.834167242050171
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.640 Test Loss: 1.395 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.064265251159668
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.647 Test Loss: 1.395 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 43 cost time: 6.1392600536346436
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.643 Test Loss: 1.395 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.005573749542236
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.637 Test Loss: 1.401 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 5.65774941444397
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.643 Test Loss: 1.397 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 5.987105131149292
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.643 Test Loss: 1.395 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 6.1727330684661865
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.643 Test Loss: 1.393 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 5.8213279247283936
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.394 Vali Acc: 0.647 Test Loss: 1.394 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 49 cost time: 5.885296583175659
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.650 Test Loss: 1.392 Test Acc: 0.650
Validation loss decreased (-0.646653 --> -0.649986).  Saving model ...
Epoch: 50 cost time: 6.0098960399627686
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.650 Test Loss: 1.391 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 51 cost time: 6.31586766242981
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.650 Test Loss: 1.390 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 52 cost time: 6.287871360778809
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.653 Test Loss: 1.384 Test Acc: 0.653
Validation loss decreased (-0.649986 --> -0.653319).  Saving model ...
Epoch: 53 cost time: 5.838507652282715
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.653 Test Loss: 1.383 Test Acc: 0.653
Validation loss decreased (-0.653319 --> -0.653320).  Saving model ...
Epoch: 54 cost time: 5.578392267227173
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.653 Test Loss: 1.382 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 55 cost time: 5.5558435916900635
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.660 Test Loss: 1.377 Test Acc: 0.660
Validation loss decreased (-0.653320 --> -0.659986).  Saving model ...
Epoch: 56 cost time: 5.982343673706055
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.657 Test Loss: 1.374 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.756304502487183
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.653 Test Loss: 1.371 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 5.835975170135498
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.653 Test Loss: 1.372 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 5.885517120361328
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.653 Test Loss: 1.371 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 6.281347036361694
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.650 Test Loss: 1.372 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 6.29168963432312
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.657 Test Loss: 1.372 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 6.065100908279419
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.657 Test Loss: 1.371 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 6.119173049926758
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.653 Test Loss: 1.368 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 5.699516773223877
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.660 Test Loss: 1.365 Test Acc: 0.660
Validation loss decreased (-0.659986 --> -0.659986).  Saving model ...
Epoch: 65 cost time: 6.249025344848633
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.657 Test Loss: 1.365 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.877334117889404
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.657 Test Loss: 1.364 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 5.570036888122559
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.653 Test Loss: 1.361 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 6.016118764877319
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.663 Test Loss: 1.359 Test Acc: 0.663
Validation loss decreased (-0.659986 --> -0.663320).  Saving model ...
Epoch: 69 cost time: 6.1210126876831055
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.673 Test Loss: 1.358 Test Acc: 0.673
Validation loss decreased (-0.663320 --> -0.673320).  Saving model ...
Epoch: 70 cost time: 5.754849433898926
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.667 Test Loss: 1.354 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 5.611900091171265
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.670 Test Loss: 1.355 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 5.673100233078003
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.670 Test Loss: 1.354 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 5.6905517578125
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.677 Test Loss: 1.353 Test Acc: 0.677
Validation loss decreased (-0.673320 --> -0.676653).  Saving model ...
Epoch: 74 cost time: 5.873694896697998
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.670 Test Loss: 1.350 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 5.953755855560303
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.677 Test Loss: 1.349 Test Acc: 0.677
Validation loss decreased (-0.676653 --> -0.676653).  Saving model ...
Epoch: 76 cost time: 5.895624399185181
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.673 Test Loss: 1.349 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 5.623357534408569
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.673 Test Loss: 1.347 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 6.194940567016602
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.670 Test Loss: 1.346 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 5.6179351806640625
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.670 Test Loss: 1.345 Test Acc: 0.670
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 6.148922443389893
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.677 Test Loss: 1.344 Test Acc: 0.677
Validation loss decreased (-0.676653 --> -0.676653).  Saving model ...
Epoch: 81 cost time: 5.705170631408691
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.677 Test Loss: 1.342 Test Acc: 0.677
Validation loss decreased (-0.676653 --> -0.676653).  Saving model ...
Epoch: 82 cost time: 5.9464521408081055
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.677 Test Loss: 1.341 Test Acc: 0.677
Validation loss decreased (-0.676653 --> -0.676653).  Saving model ...
Epoch: 83 cost time: 6.01578950881958
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.680 Test Loss: 1.340 Test Acc: 0.680
Validation loss decreased (-0.676653 --> -0.679987).  Saving model ...
Epoch: 84 cost time: 5.755523920059204
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.677 Test Loss: 1.341 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 6.259458780288696
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.680 Test Loss: 1.342 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 6.276927709579468
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.680 Test Loss: 1.340 Test Acc: 0.680
Validation loss decreased (-0.679987 --> -0.679987).  Saving model ...
Epoch: 87 cost time: 5.866955757141113
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.680 Test Loss: 1.340 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 5.891725301742554
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.680 Test Loss: 1.340 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 5.995726585388184
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.683 Test Loss: 1.341 Test Acc: 0.683
Validation loss decreased (-0.679987 --> -0.683320).  Saving model ...
Epoch: 90 cost time: 5.929578542709351
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.683 Test Loss: 1.340 Test Acc: 0.683
Validation loss decreased (-0.683320 --> -0.683320).  Saving model ...
Epoch: 91 cost time: 5.985687255859375
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.687 Test Loss: 1.337 Test Acc: 0.687
Validation loss decreased (-0.683320 --> -0.686653).  Saving model ...
Epoch: 92 cost time: 6.000433683395386
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.687 Test Loss: 1.335 Test Acc: 0.687
Validation loss decreased (-0.686653 --> -0.686653).  Saving model ...
Epoch: 93 cost time: 5.849175691604614
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.690 Test Loss: 1.336 Test Acc: 0.690
Validation loss decreased (-0.686653 --> -0.689987).  Saving model ...
Epoch: 94 cost time: 5.848560333251953
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.693 Test Loss: 1.338 Test Acc: 0.693
Validation loss decreased (-0.689987 --> -0.693320).  Saving model ...
Epoch: 95 cost time: 6.25312614440918
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.693 Test Loss: 1.338 Test Acc: 0.693
Validation loss decreased (-0.693320 --> -0.693320).  Saving model ...
Epoch: 96 cost time: 6.049459457397461
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.697 Test Loss: 1.337 Test Acc: 0.697
Validation loss decreased (-0.693320 --> -0.696653).  Saving model ...
Epoch: 97 cost time: 6.384737491607666
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.697 Test Loss: 1.340 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 5.9668402671813965
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.693 Test Loss: 1.340 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 5.867850303649902
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.697 Test Loss: 1.339 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 5.382457494735718
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.697 Test Loss: 1.338 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6966666666666667
model parameter : 15513625
model size : 78.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.947664976119995
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 5.845579624176025
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 3 cost time: 6.080781936645508
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.284318685531616
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.176030397415161
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.896374702453613
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.755417108535767
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.075745105743408
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.764525651931763
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.535257816314697
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.098369836807251
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.193716764450073
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 15513625
model size : 78.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.863025426864624
Epoch: 1, Steps: 18 | Train Loss: 2.655 Vali Loss: 1.045 Vali Acc: 0.753 Test Loss: 1.045 Test Acc: 0.753
Validation loss decreased (inf --> -0.753323).  Saving model ...
Epoch: 2 cost time: 5.810804843902588
Epoch: 2, Steps: 18 | Train Loss: 0.312 Vali Loss: 0.585 Vali Acc: 0.853 Test Loss: 0.585 Test Acc: 0.853
Validation loss decreased (-0.753323 --> -0.853327).  Saving model ...
Epoch: 3 cost time: 5.748800992965698
Epoch: 3, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.483 Vali Acc: 0.873 Test Loss: 0.483 Test Acc: 0.873
Validation loss decreased (-0.853327 --> -0.873329).  Saving model ...
Epoch: 4 cost time: 5.251949310302734
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.469 Vali Acc: 0.907 Test Loss: 0.469 Test Acc: 0.907
Validation loss decreased (-0.873329 --> -0.906662).  Saving model ...
Epoch: 5 cost time: 5.476506948471069
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.52336573600769
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.907 Test Loss: 0.416 Test Acc: 0.907
Validation loss decreased (-0.906662 --> -0.906663).  Saving model ...
Epoch: 7 cost time: 5.532410144805908
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.907 Test Loss: 0.412 Test Acc: 0.907
Validation loss decreased (-0.906663 --> -0.906663).  Saving model ...
Epoch: 8 cost time: 5.192017316818237
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.907 Test Loss: 0.406 Test Acc: 0.907
Validation loss decreased (-0.906663 --> -0.906663).  Saving model ...
Epoch: 9 cost time: 5.606451749801636
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.672703981399536
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.903 Test Loss: 0.408 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.726068019866943
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.691467523574829
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.696949243545532
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.7105138301849365
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.513880968093872
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.889965534210205
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.940342903137207
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.729075908660889
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9066666666666666
model parameter : 13940761
model size : 72.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.378494739532471
Epoch: 1, Steps: 18 | Train Loss: 2.836 Vali Loss: 1.399 Vali Acc: 0.687 Test Loss: 1.399 Test Acc: 0.687
Validation loss decreased (inf --> -0.686653).  Saving model ...
Epoch: 2 cost time: 5.558363676071167
Epoch: 2, Steps: 18 | Train Loss: 0.440 Vali Loss: 0.800 Vali Acc: 0.790 Test Loss: 0.800 Test Acc: 0.790
Validation loss decreased (-0.686653 --> -0.789992).  Saving model ...
Epoch: 3 cost time: 5.692407608032227
Epoch: 3, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.699 Vali Acc: 0.823 Test Loss: 0.699 Test Acc: 0.823
Validation loss decreased (-0.789992 --> -0.823326).  Saving model ...
Epoch: 4 cost time: 5.5403361320495605
Epoch: 4, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.830 Vali Acc: 0.793 Test Loss: 0.830 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.579915761947632
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
Validation loss decreased (-0.823326 --> -0.849994).  Saving model ...
Epoch: 6 cost time: 5.701549768447876
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.706 Vali Acc: 0.813 Test Loss: 0.706 Test Acc: 0.813
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.455368518829346
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.860 Test Loss: 0.582 Test Acc: 0.860
Validation loss decreased (-0.849994 --> -0.859994).  Saving model ...
Epoch: 8 cost time: 5.781116485595703
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.860 Test Loss: 0.583 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.11776065826416
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.860 Test Loss: 0.584 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.91985821723938
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.857 Test Loss: 0.581 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.800921201705933
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.857 Test Loss: 0.580 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.67869758605957
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.860 Test Loss: 0.580 Test Acc: 0.860
Validation loss decreased (-0.859994 --> -0.859994).  Saving model ...
Epoch: 13 cost time: 5.611415147781372
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.863 Test Loss: 0.581 Test Acc: 0.863
Validation loss decreased (-0.859994 --> -0.863328).  Saving model ...
Epoch: 14 cost time: 5.731442928314209
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.863 Test Loss: 0.581 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 15 cost time: 5.745730400085449
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.863 Test Loss: 0.579 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 16 cost time: 5.943125247955322
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.863 Test Loss: 0.580 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.554684400558472
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.860 Test Loss: 0.581 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.320289611816406
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.860 Test Loss: 0.584 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.852001428604126
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.860 Test Loss: 0.584 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.7242348194122314
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.863 Test Loss: 0.584 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.352349519729614
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.863 Test Loss: 0.585 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.891421318054199
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.860 Test Loss: 0.585 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.886304616928101
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.863 Test Loss: 0.586 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.775318145751953
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.860 Test Loss: 0.587 Test Acc: 0.860
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.213826656341553
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.857 Test Loss: 0.588 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8633333333333333
model parameter : 13940761
model size : 72.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.743957281112671
Epoch: 1, Steps: 18 | Train Loss: 3.029 Vali Loss: 1.954 Vali Acc: 0.550 Test Loss: 1.954 Test Acc: 0.550
Validation loss decreased (inf --> -0.549980).  Saving model ...
Epoch: 2 cost time: 6.163222551345825
Epoch: 2, Steps: 18 | Train Loss: 0.706 Vali Loss: 1.076 Vali Acc: 0.707 Test Loss: 1.076 Test Acc: 0.707
Validation loss decreased (-0.549980 --> -0.706656).  Saving model ...
Epoch: 3 cost time: 5.902241468429565
Epoch: 3, Steps: 18 | Train Loss: 0.063 Vali Loss: 1.047 Vali Acc: 0.717 Test Loss: 1.047 Test Acc: 0.717
Validation loss decreased (-0.706656 --> -0.716656).  Saving model ...
Epoch: 4 cost time: 5.469370126724243
Epoch: 4, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.138 Vali Acc: 0.710 Test Loss: 1.138 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.695451021194458
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.972 Vali Acc: 0.760 Test Loss: 0.972 Test Acc: 0.760
Validation loss decreased (-0.716656 --> -0.759990).  Saving model ...
Epoch: 6 cost time: 5.762518644332886
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.910 Vali Acc: 0.780 Test Loss: 0.910 Test Acc: 0.780
Validation loss decreased (-0.759990 --> -0.779991).  Saving model ...
Epoch: 7 cost time: 5.535501956939697
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.901 Vali Acc: 0.790 Test Loss: 0.901 Test Acc: 0.790
Validation loss decreased (-0.779991 --> -0.789991).  Saving model ...
Epoch: 8 cost time: 5.574703216552734
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.790 Test Loss: 0.889 Test Acc: 0.790
Validation loss decreased (-0.789991 --> -0.789991).  Saving model ...
Epoch: 9 cost time: 5.629657030105591
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.793 Test Loss: 0.888 Test Acc: 0.793
Validation loss decreased (-0.789991 --> -0.793324).  Saving model ...
Epoch: 10 cost time: 6.097958087921143
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.793 Test Loss: 0.883 Test Acc: 0.793
Validation loss decreased (-0.793324 --> -0.793325).  Saving model ...
Epoch: 11 cost time: 5.758162975311279
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.882 Vali Acc: 0.797 Test Loss: 0.882 Test Acc: 0.797
Validation loss decreased (-0.793325 --> -0.796658).  Saving model ...
Epoch: 12 cost time: 5.544296979904175
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.790 Test Loss: 0.877 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.318567514419556
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.793 Test Loss: 0.872 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.669485807418823
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.793 Test Loss: 0.875 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.555867433547974
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.793 Test Loss: 0.877 Test Acc: 0.793
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.949404716491699
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.880 Vali Acc: 0.793 Test Loss: 0.880 Test Acc: 0.793
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.771349906921387
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.797 Test Loss: 0.881 Test Acc: 0.797
Validation loss decreased (-0.796658 --> -0.796658).  Saving model ...
Epoch: 18 cost time: 5.905826091766357
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.787 Test Loss: 0.885 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.933927774429321
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.790 Test Loss: 0.886 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.9068920612335205
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.793 Test Loss: 0.886 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.751442193984985
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.783 Test Loss: 0.890 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.162600994110107
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.783 Test Loss: 0.891 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.579226016998291
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.783 Test Loss: 0.891 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.834494352340698
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.790 Test Loss: 0.891 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.781365156173706
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.793 Test Loss: 0.891 Test Acc: 0.793
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.463416337966919
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.793 Test Loss: 0.892 Test Acc: 0.793
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.739084482192993
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.793 Test Loss: 0.889 Test Acc: 0.793
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7966666666666666
model parameter : 13940761
model size : 72.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.308220624923706
Epoch: 1, Steps: 18 | Train Loss: 3.178 Vali Loss: 2.471 Vali Acc: 0.303 Test Loss: 2.471 Test Acc: 0.303
Validation loss decreased (inf --> -0.303309).  Saving model ...
Epoch: 2 cost time: 5.65704870223999
Epoch: 2, Steps: 18 | Train Loss: 1.080 Vali Loss: 1.765 Vali Acc: 0.423 Test Loss: 1.765 Test Acc: 0.423
Validation loss decreased (-0.303309 --> -0.423316).  Saving model ...
Epoch: 3 cost time: 5.682721376419067
Epoch: 3, Steps: 18 | Train Loss: 0.141 Vali Loss: 1.526 Vali Acc: 0.537 Test Loss: 1.526 Test Acc: 0.537
Validation loss decreased (-0.423316 --> -0.536651).  Saving model ...
Epoch: 4 cost time: 5.670237064361572
Epoch: 4, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.502 Vali Acc: 0.557 Test Loss: 1.502 Test Acc: 0.557
Validation loss decreased (-0.536651 --> -0.556652).  Saving model ...
Epoch: 5 cost time: 5.86388635635376
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.417 Vali Acc: 0.580 Test Loss: 1.417 Test Acc: 0.580
Validation loss decreased (-0.556652 --> -0.579986).  Saving model ...
Epoch: 6 cost time: 5.753922700881958
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.407 Vali Acc: 0.600 Test Loss: 1.407 Test Acc: 0.600
Validation loss decreased (-0.579986 --> -0.599986).  Saving model ...
Epoch: 7 cost time: 5.9524006843566895
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.220 Vali Acc: 0.663 Test Loss: 1.220 Test Acc: 0.663
Validation loss decreased (-0.599986 --> -0.663321).  Saving model ...
Epoch: 8 cost time: 6.047009706497192
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.667 Test Loss: 1.178 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666655).  Saving model ...
Epoch: 9 cost time: 6.0215394496917725
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.155 Vali Acc: 0.667 Test Loss: 1.155 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 10 cost time: 6.094947814941406
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.149 Vali Acc: 0.680 Test Loss: 1.149 Test Acc: 0.680
Validation loss decreased (-0.666655 --> -0.679989).  Saving model ...
Epoch: 11 cost time: 5.506856918334961
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.149 Vali Acc: 0.673 Test Loss: 1.149 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.6536290645599365
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.673 Test Loss: 1.144 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.617678880691528
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.670 Test Loss: 1.132 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.926870822906494
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.680 Test Loss: 1.124 Test Acc: 0.680
Validation loss decreased (-0.679989 --> -0.679989).  Saving model ...
Epoch: 15 cost time: 5.686932563781738
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.119 Vali Acc: 0.683 Test Loss: 1.119 Test Acc: 0.683
Validation loss decreased (-0.679989 --> -0.683322).  Saving model ...
Epoch: 16 cost time: 6.147810697555542
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.677 Test Loss: 1.122 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.643823623657227
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.121 Vali Acc: 0.680 Test Loss: 1.121 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.1532886028289795
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.120 Vali Acc: 0.677 Test Loss: 1.120 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.781737565994263
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.118 Vali Acc: 0.677 Test Loss: 1.118 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.4231390953063965
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.109 Vali Acc: 0.673 Test Loss: 1.109 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.729846477508545
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.677 Test Loss: 1.108 Test Acc: 0.677
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.828947305679321
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.101 Vali Acc: 0.677 Test Loss: 1.101 Test Acc: 0.677
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.849485874176025
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.096 Vali Acc: 0.680 Test Loss: 1.096 Test Acc: 0.680
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.039530277252197
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.092 Vali Acc: 0.683 Test Loss: 1.092 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 25 cost time: 6.195960283279419
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.680 Test Loss: 1.089 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.3804638385772705
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.683 Test Loss: 1.089 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 27 cost time: 6.298051595687866
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.687 Test Loss: 1.087 Test Acc: 0.687
Validation loss decreased (-0.683322 --> -0.686656).  Saving model ...
Epoch: 28 cost time: 6.247293710708618
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.693 Test Loss: 1.087 Test Acc: 0.693
Validation loss decreased (-0.686656 --> -0.693322).  Saving model ...
Epoch: 29 cost time: 6.146891832351685
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.690 Test Loss: 1.087 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.01936936378479
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.690 Test Loss: 1.087 Test Acc: 0.690
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.9502952098846436
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.086 Vali Acc: 0.690 Test Loss: 1.086 Test Acc: 0.690
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.725273609161377
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.085 Vali Acc: 0.690 Test Loss: 1.085 Test Acc: 0.690
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 5.90482234954834
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.082 Vali Acc: 0.693 Test Loss: 1.082 Test Acc: 0.693
Validation loss decreased (-0.693322 --> -0.693323).  Saving model ...
Epoch: 34 cost time: 6.2411048412323
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.077 Vali Acc: 0.700 Test Loss: 1.077 Test Acc: 0.700
Validation loss decreased (-0.693323 --> -0.699989).  Saving model ...
Epoch: 35 cost time: 6.343471050262451
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.700 Test Loss: 1.076 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 36 cost time: 6.530218601226807
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.700 Test Loss: 1.075 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 37 cost time: 6.302335977554321
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.700 Test Loss: 1.075 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.223613500595093
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.077 Vali Acc: 0.703 Test Loss: 1.077 Test Acc: 0.703
Validation loss decreased (-0.699989 --> -0.703323).  Saving model ...
Epoch: 39 cost time: 6.186568975448608
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.700 Test Loss: 1.076 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.09462833404541
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.697 Test Loss: 1.074 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.597954988479614
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.700 Test Loss: 1.072 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 5.968272686004639
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.700 Test Loss: 1.074 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 6.357119083404541
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.700 Test Loss: 1.075 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 6.106277227401733
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.700 Test Loss: 1.076 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 6.176634788513184
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.703 Test Loss: 1.073 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 46 cost time: 5.8818724155426025
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.703 Test Loss: 1.073 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.864120960235596
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.707 Test Loss: 1.073 Test Acc: 0.707
Validation loss decreased (-0.703323 --> -0.706656).  Saving model ...
Epoch: 48 cost time: 5.895895957946777
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.707 Test Loss: 1.073 Test Acc: 0.707
Validation loss decreased (-0.706656 --> -0.706656).  Saving model ...
Epoch: 49 cost time: 6.112483978271484
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.707 Test Loss: 1.073 Test Acc: 0.707
Validation loss decreased (-0.706656 --> -0.706656).  Saving model ...
Epoch: 50 cost time: 6.330826044082642
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.710 Test Loss: 1.074 Test Acc: 0.710
Validation loss decreased (-0.706656 --> -0.709989).  Saving model ...
Epoch: 51 cost time: 6.179462909698486
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.707 Test Loss: 1.073 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.1294801235198975
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.707 Test Loss: 1.071 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.063244104385376
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.707 Test Loss: 1.071 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 6.087315559387207
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.707 Test Loss: 1.074 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 5.8871376514434814
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.707 Test Loss: 1.076 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 6.459078073501587
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.710 Test Loss: 1.073 Test Acc: 0.710
Validation loss decreased (-0.709989 --> -0.709989).  Saving model ...
Epoch: 57 cost time: 6.246899366378784
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.707 Test Loss: 1.072 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.0090227127075195
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.707 Test Loss: 1.071 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 6.55772852897644
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.707 Test Loss: 1.072 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 6.3988237380981445
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.707 Test Loss: 1.073 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 6.322998762130737
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.077 Vali Acc: 0.710 Test Loss: 1.077 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 6.02681827545166
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.077 Vali Acc: 0.710 Test Loss: 1.077 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 6.274836778640747
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.710 Test Loss: 1.076 Test Acc: 0.710
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 6.24765157699585
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.713 Test Loss: 1.074 Test Acc: 0.713
Validation loss decreased (-0.709989 --> -0.713323).  Saving model ...
Epoch: 65 cost time: 6.338714122772217
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.713 Test Loss: 1.074 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 66 cost time: 6.198639154434204
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.713 Test Loss: 1.073 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 67 cost time: 6.457066535949707
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.713 Test Loss: 1.073 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 6.220746994018555
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.720 Test Loss: 1.074 Test Acc: 0.720
Validation loss decreased (-0.713323 --> -0.719989).  Saving model ...
Epoch: 69 cost time: 6.559967994689941
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.717 Test Loss: 1.074 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 6.343413352966309
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.717 Test Loss: 1.074 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 6.2814412117004395
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.717 Test Loss: 1.076 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 5.9432549476623535
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.717 Test Loss: 1.076 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 5.999078989028931
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.717 Test Loss: 1.075 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 5.72836971282959
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.713 Test Loss: 1.076 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 6.041971683502197
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.079 Vali Acc: 0.713 Test Loss: 1.079 Test Acc: 0.713
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 5.94509220123291
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.080 Vali Acc: 0.717 Test Loss: 1.080 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 6.046005725860596
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.079 Vali Acc: 0.717 Test Loss: 1.079 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 6.281880140304565
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.079 Vali Acc: 0.720 Test Loss: 1.079 Test Acc: 0.720
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.72
model parameter : 13940761
model size : 72.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.646832227706909
Epoch: 1, Steps: 18 | Train Loss: 3.271 Vali Loss: 2.823 Vali Acc: 0.140 Test Loss: 2.823 Test Acc: 0.140
Validation loss decreased (inf --> -0.139972).  Saving model ...
Epoch: 2 cost time: 6.73744535446167
Epoch: 2, Steps: 18 | Train Loss: 1.373 Vali Loss: 2.347 Vali Acc: 0.237 Test Loss: 2.347 Test Acc: 0.237
Validation loss decreased (-0.139972 --> -0.236643).  Saving model ...
Epoch: 3 cost time: 6.385977506637573
Epoch: 3, Steps: 18 | Train Loss: 0.219 Vali Loss: 1.912 Vali Acc: 0.450 Test Loss: 1.912 Test Acc: 0.450
Validation loss decreased (-0.236643 --> -0.449981).  Saving model ...
Epoch: 4 cost time: 5.673723459243774
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.946 Vali Acc: 0.473 Test Loss: 1.946 Test Acc: 0.473
Validation loss decreased (-0.449981 --> -0.473314).  Saving model ...
Epoch: 5 cost time: 6.361026763916016
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.933 Vali Acc: 0.490 Test Loss: 1.933 Test Acc: 0.490
Validation loss decreased (-0.473314 --> -0.489981).  Saving model ...
Epoch: 6 cost time: 5.9772889614105225
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.804 Vali Acc: 0.500 Test Loss: 1.804 Test Acc: 0.500
Validation loss decreased (-0.489981 --> -0.499982).  Saving model ...
Epoch: 7 cost time: 6.136930704116821
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.674 Vali Acc: 0.550 Test Loss: 1.674 Test Acc: 0.550
Validation loss decreased (-0.499982 --> -0.549983).  Saving model ...
Epoch: 8 cost time: 5.819679498672485
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.570 Test Loss: 1.601 Test Acc: 0.570
Validation loss decreased (-0.549983 --> -0.569984).  Saving model ...
Epoch: 9 cost time: 5.916627407073975
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.584 Vali Acc: 0.563 Test Loss: 1.584 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.7712578773498535
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.571 Vali Acc: 0.570 Test Loss: 1.571 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 11 cost time: 5.8804731369018555
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.573 Test Loss: 1.556 Test Acc: 0.573
Validation loss decreased (-0.569984 --> -0.573318).  Saving model ...
Epoch: 12 cost time: 5.790310382843018
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.546 Vali Acc: 0.580 Test Loss: 1.546 Test Acc: 0.580
Validation loss decreased (-0.573318 --> -0.579985).  Saving model ...
Epoch: 13 cost time: 5.923234701156616
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.587 Test Loss: 1.536 Test Acc: 0.587
Validation loss decreased (-0.579985 --> -0.586651).  Saving model ...
Epoch: 14 cost time: 5.921104907989502
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.587 Test Loss: 1.524 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 15 cost time: 6.117773771286011
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.590 Test Loss: 1.516 Test Acc: 0.590
Validation loss decreased (-0.586651 --> -0.589985).  Saving model ...
Epoch: 16 cost time: 5.742385149002075
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.603 Test Loss: 1.517 Test Acc: 0.603
Validation loss decreased (-0.589985 --> -0.603318).  Saving model ...
Epoch: 17 cost time: 5.914589881896973
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.603 Test Loss: 1.519 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.061938047409058
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.514 Vali Acc: 0.603 Test Loss: 1.514 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 19 cost time: 5.8454461097717285
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.607 Test Loss: 1.506 Test Acc: 0.607
Validation loss decreased (-0.603318 --> -0.606652).  Saving model ...
Epoch: 20 cost time: 5.996168375015259
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.603 Test Loss: 1.501 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.798060894012451
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.603 Test Loss: 1.493 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.997627258300781
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.610 Test Loss: 1.488 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609985).  Saving model ...
Epoch: 23 cost time: 5.9105308055877686
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.610 Test Loss: 1.485 Test Acc: 0.610
Validation loss decreased (-0.609985 --> -0.609985).  Saving model ...
Epoch: 24 cost time: 6.1906585693359375
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.483 Vali Acc: 0.613 Test Loss: 1.483 Test Acc: 0.613
Validation loss decreased (-0.609985 --> -0.613318).  Saving model ...
Epoch: 25 cost time: 6.004157781600952
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.483 Vali Acc: 0.617 Test Loss: 1.483 Test Acc: 0.617
Validation loss decreased (-0.613318 --> -0.616652).  Saving model ...
Epoch: 26 cost time: 6.191028594970703
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.613 Test Loss: 1.481 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.81326699256897
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.617 Test Loss: 1.477 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 28 cost time: 5.483977317810059
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.474 Vali Acc: 0.617 Test Loss: 1.474 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 29 cost time: 5.592447996139526
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.627 Test Loss: 1.473 Test Acc: 0.627
Validation loss decreased (-0.616652 --> -0.626652).  Saving model ...
Epoch: 30 cost time: 5.323368787765503
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.627 Test Loss: 1.471 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 31 cost time: 5.907672643661499
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.630 Test Loss: 1.470 Test Acc: 0.630
Validation loss decreased (-0.626652 --> -0.629985).  Saving model ...
Epoch: 32 cost time: 5.588584661483765
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.633 Test Loss: 1.471 Test Acc: 0.633
Validation loss decreased (-0.629985 --> -0.633319).  Saving model ...
Epoch: 33 cost time: 5.981754541397095
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.627 Test Loss: 1.469 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.614481210708618
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.627 Test Loss: 1.464 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.244524240493774
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.465 Vali Acc: 0.627 Test Loss: 1.465 Test Acc: 0.627
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 6.268241882324219
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.627 Test Loss: 1.463 Test Acc: 0.627
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 5.685528993606567
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.630 Test Loss: 1.463 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 6.169281959533691
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.633 Test Loss: 1.462 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 39 cost time: 5.876516580581665
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.630 Test Loss: 1.461 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.698659896850586
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.457 Vali Acc: 0.630 Test Loss: 1.457 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 5.696696758270264
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.457 Vali Acc: 0.630 Test Loss: 1.457 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 5.692829132080078
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.633 Test Loss: 1.455 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 43 cost time: 5.370177507400513
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.633 Test Loss: 1.455 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 5.568367958068848
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.633 Test Loss: 1.455 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 5.514946222305298
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.640 Test Loss: 1.454 Test Acc: 0.640
Validation loss decreased (-0.633319 --> -0.639985).  Saving model ...
Epoch: 46 cost time: 5.853817939758301
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.640 Test Loss: 1.452 Test Acc: 0.640
Validation loss decreased (-0.639985 --> -0.639985).  Saving model ...
Epoch: 47 cost time: 5.736043930053711
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.640 Test Loss: 1.453 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.80286169052124
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.643 Test Loss: 1.453 Test Acc: 0.643
Validation loss decreased (-0.639985 --> -0.643319).  Saving model ...
Epoch: 49 cost time: 6.226379871368408
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.640 Test Loss: 1.453 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.041320562362671
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.647 Test Loss: 1.454 Test Acc: 0.647
Validation loss decreased (-0.643319 --> -0.646652).  Saving model ...
Epoch: 51 cost time: 6.216181039810181
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.650 Test Loss: 1.453 Test Acc: 0.650
Validation loss decreased (-0.646652 --> -0.649985).  Saving model ...
Epoch: 52 cost time: 5.613861560821533
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.653 Test Loss: 1.451 Test Acc: 0.653
Validation loss decreased (-0.649985 --> -0.653319).  Saving model ...
Epoch: 53 cost time: 5.593244552612305
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.653 Test Loss: 1.450 Test Acc: 0.653
Validation loss decreased (-0.653319 --> -0.653319).  Saving model ...
Epoch: 54 cost time: 6.374518394470215
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.650 Test Loss: 1.451 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.048015594482422
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.653 Test Loss: 1.452 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 5.920228958129883
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.657 Test Loss: 1.450 Test Acc: 0.657
Validation loss decreased (-0.653319 --> -0.656652).  Saving model ...
Epoch: 57 cost time: 5.996105909347534
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.667 Test Loss: 1.448 Test Acc: 0.667
Validation loss decreased (-0.656652 --> -0.666652).  Saving model ...
Epoch: 58 cost time: 5.684575080871582
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.667 Test Loss: 1.448 Test Acc: 0.667
Validation loss decreased (-0.666652 --> -0.666652).  Saving model ...
Epoch: 59 cost time: 5.619048595428467
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.663 Test Loss: 1.449 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.896644592285156
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.670 Test Loss: 1.449 Test Acc: 0.670
Validation loss decreased (-0.666652 --> -0.669986).  Saving model ...
Epoch: 61 cost time: 5.703178882598877
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.657 Test Loss: 1.453 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 5.728357553482056
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.660 Test Loss: 1.453 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 5.731234073638916
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.657 Test Loss: 1.451 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 5.783601760864258
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.660 Test Loss: 1.449 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 6.215595722198486
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.660 Test Loss: 1.448 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 5.821179151535034
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.660 Test Loss: 1.447 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 6.002280235290527
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.446 Vali Acc: 0.663 Test Loss: 1.446 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 6.308955192565918
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.446 Vali Acc: 0.657 Test Loss: 1.446 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 6.193762540817261
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.657 Test Loss: 1.444 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 6.618967294692993
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.657 Test Loss: 1.444 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.67
model parameter : 13940761
model size : 72.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.498888969421387
Epoch: 1, Steps: 18 | Train Loss: 3.217 Vali Loss: 2.952 Vali Acc: 0.117 Test Loss: 2.952 Test Acc: 0.117
Validation loss decreased (inf --> -0.116637).  Saving model ...
Epoch: 2 cost time: 5.351805686950684
Epoch: 2, Steps: 18 | Train Loss: 1.393 Vali Loss: 2.571 Vali Acc: 0.230 Test Loss: 2.571 Test Acc: 0.230
Validation loss decreased (-0.116637 --> -0.229974).  Saving model ...
Epoch: 3 cost time: 5.7951648235321045
Epoch: 3, Steps: 18 | Train Loss: 0.216 Vali Loss: 2.255 Vali Acc: 0.377 Test Loss: 2.255 Test Acc: 0.377
Validation loss decreased (-0.229974 --> -0.376644).  Saving model ...
Epoch: 4 cost time: 6.181064605712891
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 2.346 Vali Acc: 0.363 Test Loss: 2.346 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.794803857803345
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.073 Vali Acc: 0.430 Test Loss: 2.073 Test Acc: 0.430
Validation loss decreased (-0.376644 --> -0.429979).  Saving model ...
Epoch: 6 cost time: 6.084783315658569
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.065 Vali Acc: 0.463 Test Loss: 2.065 Test Acc: 0.463
Validation loss decreased (-0.429979 --> -0.463313).  Saving model ...
Epoch: 7 cost time: 5.583494424819946
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.004 Vali Acc: 0.463 Test Loss: 2.004 Test Acc: 0.463
Validation loss decreased (-0.463313 --> -0.463313).  Saving model ...
Epoch: 8 cost time: 5.705502271652222
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.968 Vali Acc: 0.467 Test Loss: 1.968 Test Acc: 0.467
Validation loss decreased (-0.463313 --> -0.466647).  Saving model ...
Epoch: 9 cost time: 5.432988405227661
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.958 Vali Acc: 0.453 Test Loss: 1.958 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.517496347427368
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.926 Vali Acc: 0.460 Test Loss: 1.926 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.8483452796936035
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.477 Test Loss: 1.901 Test Acc: 0.477
Validation loss decreased (-0.466647 --> -0.476648).  Saving model ...
Epoch: 12 cost time: 6.095247268676758
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.882 Vali Acc: 0.480 Test Loss: 1.882 Test Acc: 0.480
Validation loss decreased (-0.476648 --> -0.479981).  Saving model ...
Epoch: 13 cost time: 6.32209038734436
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.865 Vali Acc: 0.500 Test Loss: 1.865 Test Acc: 0.500
Validation loss decreased (-0.479981 --> -0.499981).  Saving model ...
Epoch: 14 cost time: 6.256842613220215
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.849 Vali Acc: 0.500 Test Loss: 1.849 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499982).  Saving model ...
Epoch: 15 cost time: 6.2504167556762695
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.520 Test Loss: 1.834 Test Acc: 0.520
Validation loss decreased (-0.499982 --> -0.519982).  Saving model ...
Epoch: 16 cost time: 6.253545522689819
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.520 Test Loss: 1.818 Test Acc: 0.520
Validation loss decreased (-0.519982 --> -0.519982).  Saving model ...
Epoch: 17 cost time: 6.0097739696502686
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.523 Test Loss: 1.811 Test Acc: 0.523
Validation loss decreased (-0.519982 --> -0.523315).  Saving model ...
Epoch: 18 cost time: 5.6801598072052
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.527 Test Loss: 1.802 Test Acc: 0.527
Validation loss decreased (-0.523315 --> -0.526649).  Saving model ...
Epoch: 19 cost time: 5.585764646530151
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.537 Test Loss: 1.791 Test Acc: 0.537
Validation loss decreased (-0.526649 --> -0.536649).  Saving model ...
Epoch: 20 cost time: 5.560596466064453
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.785 Vali Acc: 0.537 Test Loss: 1.785 Test Acc: 0.537
Validation loss decreased (-0.536649 --> -0.536649).  Saving model ...
Epoch: 21 cost time: 6.167943716049194
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.775 Vali Acc: 0.547 Test Loss: 1.775 Test Acc: 0.547
Validation loss decreased (-0.536649 --> -0.546649).  Saving model ...
Epoch: 22 cost time: 6.0482237339019775
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.768 Vali Acc: 0.543 Test Loss: 1.768 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.752211570739746
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.761 Vali Acc: 0.550 Test Loss: 1.761 Test Acc: 0.550
Validation loss decreased (-0.546649 --> -0.549982).  Saving model ...
Epoch: 24 cost time: 6.117005109786987
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.753 Vali Acc: 0.557 Test Loss: 1.753 Test Acc: 0.557
Validation loss decreased (-0.549982 --> -0.556649).  Saving model ...
Epoch: 25 cost time: 5.565640211105347
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.752 Vali Acc: 0.563 Test Loss: 1.752 Test Acc: 0.563
Validation loss decreased (-0.556649 --> -0.563316).  Saving model ...
Epoch: 26 cost time: 6.301359176635742
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.580 Test Loss: 1.742 Test Acc: 0.580
Validation loss decreased (-0.563316 --> -0.579983).  Saving model ...
Epoch: 27 cost time: 5.863973379135132
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.573 Test Loss: 1.734 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.792363405227661
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.729 Vali Acc: 0.580 Test Loss: 1.729 Test Acc: 0.580
Validation loss decreased (-0.579983 --> -0.579983).  Saving model ...
Epoch: 29 cost time: 5.929858207702637
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.570 Test Loss: 1.721 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.330310344696045
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.580 Test Loss: 1.717 Test Acc: 0.580
Validation loss decreased (-0.579983 --> -0.579983).  Saving model ...
Epoch: 31 cost time: 6.177290201187134
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.713 Vali Acc: 0.580 Test Loss: 1.713 Test Acc: 0.580
Validation loss decreased (-0.579983 --> -0.579983).  Saving model ...
Epoch: 32 cost time: 6.718690872192383
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.707 Vali Acc: 0.573 Test Loss: 1.707 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.90416693687439
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.577 Test Loss: 1.704 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.6303980350494385
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.699 Vali Acc: 0.580 Test Loss: 1.699 Test Acc: 0.580
Validation loss decreased (-0.579983 --> -0.579983).  Saving model ...
Epoch: 35 cost time: 5.828705787658691
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.590 Test Loss: 1.697 Test Acc: 0.590
Validation loss decreased (-0.579983 --> -0.589983).  Saving model ...
Epoch: 36 cost time: 5.449062347412109
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.587 Test Loss: 1.696 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.735206604003906
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.693 Vali Acc: 0.590 Test Loss: 1.693 Test Acc: 0.590
Validation loss decreased (-0.589983 --> -0.589983).  Saving model ...
Epoch: 38 cost time: 5.540005922317505
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.688 Vali Acc: 0.590 Test Loss: 1.688 Test Acc: 0.590
Validation loss decreased (-0.589983 --> -0.589983).  Saving model ...
Epoch: 39 cost time: 5.569698810577393
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.597 Test Loss: 1.685 Test Acc: 0.597
Validation loss decreased (-0.589983 --> -0.596650).  Saving model ...
Epoch: 40 cost time: 5.9804370403289795
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.682 Vali Acc: 0.597 Test Loss: 1.682 Test Acc: 0.597
Validation loss decreased (-0.596650 --> -0.596650).  Saving model ...
Epoch: 41 cost time: 5.740000247955322
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.678 Vali Acc: 0.597 Test Loss: 1.678 Test Acc: 0.597
Validation loss decreased (-0.596650 --> -0.596650).  Saving model ...
Epoch: 42 cost time: 5.85688853263855
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.672 Vali Acc: 0.597 Test Loss: 1.672 Test Acc: 0.597
Validation loss decreased (-0.596650 --> -0.596650).  Saving model ...
Epoch: 43 cost time: 6.105227708816528
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.671 Vali Acc: 0.597 Test Loss: 1.671 Test Acc: 0.597
Validation loss decreased (-0.596650 --> -0.596650).  Saving model ...
Epoch: 44 cost time: 6.112020492553711
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.597 Test Loss: 1.669 Test Acc: 0.597
Validation loss decreased (-0.596650 --> -0.596650).  Saving model ...
Epoch: 45 cost time: 6.081586837768555
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.667 Vali Acc: 0.587 Test Loss: 1.667 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.8566765785217285
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.664 Vali Acc: 0.600 Test Loss: 1.664 Test Acc: 0.600
Validation loss decreased (-0.596650 --> -0.599983).  Saving model ...
Epoch: 47 cost time: 6.279719352722168
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.662 Vali Acc: 0.597 Test Loss: 1.662 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 6.14971661567688
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.660 Vali Acc: 0.600 Test Loss: 1.660 Test Acc: 0.600
Validation loss decreased (-0.599983 --> -0.599983).  Saving model ...
Epoch: 49 cost time: 6.003870010375977
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.658 Vali Acc: 0.597 Test Loss: 1.658 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.677914142608643
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.658 Vali Acc: 0.597 Test Loss: 1.658 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 5.744489431381226
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.657 Vali Acc: 0.600 Test Loss: 1.657 Test Acc: 0.600
Validation loss decreased (-0.599983 --> -0.599983).  Saving model ...
Epoch: 52 cost time: 5.702696084976196
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.654 Vali Acc: 0.603 Test Loss: 1.654 Test Acc: 0.603
Validation loss decreased (-0.599983 --> -0.603317).  Saving model ...
Epoch: 53 cost time: 5.982918739318848
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.654 Vali Acc: 0.600 Test Loss: 1.654 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.762719631195068
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.654 Vali Acc: 0.607 Test Loss: 1.654 Test Acc: 0.607
Validation loss decreased (-0.603317 --> -0.606650).  Saving model ...
Epoch: 55 cost time: 5.5118186473846436
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.651 Vali Acc: 0.613 Test Loss: 1.651 Test Acc: 0.613
Validation loss decreased (-0.606650 --> -0.613317).  Saving model ...
Epoch: 56 cost time: 5.903850555419922
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.613 Test Loss: 1.647 Test Acc: 0.613
Validation loss decreased (-0.613317 --> -0.613317).  Saving model ...
Epoch: 57 cost time: 5.732219457626343
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.610 Test Loss: 1.644 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.06823468208313
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.613 Test Loss: 1.644 Test Acc: 0.613
Validation loss decreased (-0.613317 --> -0.613317).  Saving model ...
Epoch: 59 cost time: 6.241283416748047
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.613 Test Loss: 1.644 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.502217531204224
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.610 Test Loss: 1.639 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 5.831543207168579
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.641 Vali Acc: 0.610 Test Loss: 1.641 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 5.72826886177063
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.613 Test Loss: 1.639 Test Acc: 0.613
Validation loss decreased (-0.613317 --> -0.613317).  Saving model ...
Epoch: 63 cost time: 5.565268039703369
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.617 Test Loss: 1.637 Test Acc: 0.617
Validation loss decreased (-0.613317 --> -0.616650).  Saving model ...
Epoch: 64 cost time: 6.160984039306641
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.636 Vali Acc: 0.617 Test Loss: 1.636 Test Acc: 0.617
Validation loss decreased (-0.616650 --> -0.616650).  Saving model ...
Epoch: 65 cost time: 5.787645578384399
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.617 Test Loss: 1.637 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.618545055389404
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.636 Vali Acc: 0.613 Test Loss: 1.636 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 5.799317359924316
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.610 Test Loss: 1.633 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 5.600547552108765
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.613 Test Loss: 1.630 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 5.718041896820068
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.629 Vali Acc: 0.617 Test Loss: 1.629 Test Acc: 0.617
Validation loss decreased (-0.616650 --> -0.616650).  Saving model ...
Epoch: 70 cost time: 5.846755743026733
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.617 Test Loss: 1.628 Test Acc: 0.617
Validation loss decreased (-0.616650 --> -0.616650).  Saving model ...
Epoch: 71 cost time: 6.08008885383606
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.610 Test Loss: 1.624 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 6.031305313110352
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.622 Vali Acc: 0.613 Test Loss: 1.622 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 5.4224419593811035
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.620 Test Loss: 1.618 Test Acc: 0.620
Validation loss decreased (-0.616650 --> -0.619984).  Saving model ...
Epoch: 74 cost time: 5.874537229537964
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.617 Test Loss: 1.617 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 6.1337480545043945
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.617 Test Loss: 1.617 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 6.150553464889526
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.617 Test Loss: 1.617 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 6.046857833862305
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.620 Test Loss: 1.616 Test Acc: 0.620
Validation loss decreased (-0.619984 --> -0.619984).  Saving model ...
Epoch: 78 cost time: 6.218056917190552
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.620 Test Loss: 1.614 Test Acc: 0.620
Validation loss decreased (-0.619984 --> -0.619984).  Saving model ...
Epoch: 79 cost time: 5.715317726135254
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.613 Test Loss: 1.614 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 5.739622354507446
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.617 Test Loss: 1.614 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 5.620762586593628
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.627 Test Loss: 1.614 Test Acc: 0.627
Validation loss decreased (-0.619984 --> -0.626651).  Saving model ...
Epoch: 82 cost time: 5.444255352020264
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.620 Test Loss: 1.612 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 5.880932092666626
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.623 Test Loss: 1.612 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 6.02191424369812
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.623 Test Loss: 1.612 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 5.955302000045776
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.627 Test Loss: 1.611 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 86 cost time: 6.332884311676025
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.623 Test Loss: 1.610 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 5.833765745162964
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.623 Test Loss: 1.610 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 5.777217864990234
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.623 Test Loss: 1.608 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 5.646186351776123
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.623 Test Loss: 1.608 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 6.032674789428711
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.623 Test Loss: 1.607 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 5.751942157745361
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.627 Test Loss: 1.606 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 92 cost time: 5.820390939712524
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.627 Test Loss: 1.607 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 5.81246018409729
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.627 Test Loss: 1.605 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 94 cost time: 6.240924835205078
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.627 Test Loss: 1.605 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 6.071538925170898
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.623 Test Loss: 1.604 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 5.741889238357544
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.603 Vali Acc: 0.630 Test Loss: 1.603 Test Acc: 0.630
Validation loss decreased (-0.626651 --> -0.629984).  Saving model ...
Epoch: 97 cost time: 5.885125160217285
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.630 Test Loss: 1.602 Test Acc: 0.630
Validation loss decreased (-0.629984 --> -0.629984).  Saving model ...
Epoch: 98 cost time: 5.93817400932312
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.599 Vali Acc: 0.630 Test Loss: 1.599 Test Acc: 0.630
Validation loss decreased (-0.629984 --> -0.629984).  Saving model ...
Epoch: 99 cost time: 5.75275182723999
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.627 Test Loss: 1.597 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 5.512893438339233
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.598 Vali Acc: 0.633 Test Loss: 1.598 Test Acc: 0.633
Validation loss decreased (-0.629984 --> -0.633317).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6333333333333333
model parameter : 13940761
model size : 72.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.033939599990845
Epoch: 1, Steps: 18 | Train Loss: 3.294 Vali Loss: 3.117 Vali Acc: 0.090 Test Loss: 3.117 Test Acc: 0.090
Validation loss decreased (inf --> -0.089969).  Saving model ...
Epoch: 2 cost time: 5.891341209411621
Epoch: 2, Steps: 18 | Train Loss: 1.475 Vali Loss: 2.869 Vali Acc: 0.153 Test Loss: 2.869 Test Acc: 0.153
Validation loss decreased (-0.089969 --> -0.153305).  Saving model ...
Epoch: 3 cost time: 6.255603313446045
Epoch: 3, Steps: 18 | Train Loss: 0.236 Vali Loss: 3.139 Vali Acc: 0.163 Test Loss: 3.139 Test Acc: 0.163
Validation loss decreased (-0.153305 --> -0.163302).  Saving model ...
Epoch: 4 cost time: 5.73756217956543
Epoch: 4, Steps: 18 | Train Loss: 0.027 Vali Loss: 2.739 Vali Acc: 0.290 Test Loss: 2.739 Test Acc: 0.290
Validation loss decreased (-0.163302 --> -0.289973).  Saving model ...
Epoch: 5 cost time: 5.909233093261719
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.635 Vali Acc: 0.290 Test Loss: 2.635 Test Acc: 0.290
Validation loss decreased (-0.289973 --> -0.289974).  Saving model ...
Epoch: 6 cost time: 5.70107102394104
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.781 Vali Acc: 0.287 Test Loss: 2.781 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.834631681442261
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.554 Vali Acc: 0.323 Test Loss: 2.554 Test Acc: 0.323
Validation loss decreased (-0.289974 --> -0.323308).  Saving model ...
Epoch: 8 cost time: 6.123528480529785
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.450 Vali Acc: 0.343 Test Loss: 2.450 Test Acc: 0.343
Validation loss decreased (-0.323308 --> -0.343309).  Saving model ...
Epoch: 9 cost time: 5.521579742431641
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.388 Vali Acc: 0.357 Test Loss: 2.388 Test Acc: 0.357
Validation loss decreased (-0.343309 --> -0.356643).  Saving model ...
Epoch: 10 cost time: 5.524179220199585
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.309 Vali Acc: 0.377 Test Loss: 2.309 Test Acc: 0.377
Validation loss decreased (-0.356643 --> -0.376644).  Saving model ...
Epoch: 11 cost time: 6.135218620300293
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.271 Vali Acc: 0.383 Test Loss: 2.271 Test Acc: 0.383
Validation loss decreased (-0.376644 --> -0.383311).  Saving model ...
Epoch: 12 cost time: 5.834700345993042
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.270 Vali Acc: 0.393 Test Loss: 2.270 Test Acc: 0.393
Validation loss decreased (-0.383311 --> -0.393311).  Saving model ...
Epoch: 13 cost time: 6.56730842590332
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.239 Vali Acc: 0.397 Test Loss: 2.239 Test Acc: 0.397
Validation loss decreased (-0.393311 --> -0.396644).  Saving model ...
Epoch: 14 cost time: 6.032683849334717
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.227 Vali Acc: 0.397 Test Loss: 2.227 Test Acc: 0.397
Validation loss decreased (-0.396644 --> -0.396644).  Saving model ...
Epoch: 15 cost time: 5.727288246154785
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.196 Vali Acc: 0.410 Test Loss: 2.196 Test Acc: 0.410
Validation loss decreased (-0.396644 --> -0.409978).  Saving model ...
Epoch: 16 cost time: 5.966588735580444
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.167 Vali Acc: 0.423 Test Loss: 2.167 Test Acc: 0.423
Validation loss decreased (-0.409978 --> -0.423312).  Saving model ...
Epoch: 17 cost time: 5.59272027015686
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.136 Vali Acc: 0.440 Test Loss: 2.136 Test Acc: 0.440
Validation loss decreased (-0.423312 --> -0.439979).  Saving model ...
Epoch: 18 cost time: 5.386995315551758
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.113 Vali Acc: 0.447 Test Loss: 2.113 Test Acc: 0.447
Validation loss decreased (-0.439979 --> -0.446646).  Saving model ...
Epoch: 19 cost time: 5.498347997665405
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.099 Vali Acc: 0.453 Test Loss: 2.099 Test Acc: 0.453
Validation loss decreased (-0.446646 --> -0.453312).  Saving model ...
Epoch: 20 cost time: 5.559981822967529
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.094 Vali Acc: 0.457 Test Loss: 2.094 Test Acc: 0.457
Validation loss decreased (-0.453312 --> -0.456646).  Saving model ...
Epoch: 21 cost time: 5.993467330932617
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.090 Vali Acc: 0.470 Test Loss: 2.090 Test Acc: 0.470
Validation loss decreased (-0.456646 --> -0.469979).  Saving model ...
Epoch: 22 cost time: 5.837472915649414
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.088 Vali Acc: 0.467 Test Loss: 2.088 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.275659084320068
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.075 Vali Acc: 0.467 Test Loss: 2.075 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.135497808456421
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.049 Vali Acc: 0.490 Test Loss: 2.049 Test Acc: 0.490
Validation loss decreased (-0.469979 --> -0.489980).  Saving model ...
Epoch: 25 cost time: 5.639211416244507
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.035 Vali Acc: 0.493 Test Loss: 2.035 Test Acc: 0.493
Validation loss decreased (-0.489980 --> -0.493313).  Saving model ...
Epoch: 26 cost time: 5.895432710647583
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.025 Vali Acc: 0.497 Test Loss: 2.025 Test Acc: 0.497
Validation loss decreased (-0.493313 --> -0.496646).  Saving model ...
Epoch: 27 cost time: 5.971511363983154
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.020 Vali Acc: 0.497 Test Loss: 2.020 Test Acc: 0.497
Validation loss decreased (-0.496646 --> -0.496646).  Saving model ...
Epoch: 28 cost time: 5.9189088344573975
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.009 Vali Acc: 0.510 Test Loss: 2.009 Test Acc: 0.510
Validation loss decreased (-0.496646 --> -0.509980).  Saving model ...
Epoch: 29 cost time: 6.099660158157349
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.003 Vali Acc: 0.510 Test Loss: 2.003 Test Acc: 0.510
Validation loss decreased (-0.509980 --> -0.509980).  Saving model ...
Epoch: 30 cost time: 6.665814638137817
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.992 Vali Acc: 0.513 Test Loss: 1.992 Test Acc: 0.513
Validation loss decreased (-0.509980 --> -0.513313).  Saving model ...
Epoch: 31 cost time: 6.174600839614868
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.983 Vali Acc: 0.513 Test Loss: 1.983 Test Acc: 0.513
Validation loss decreased (-0.513313 --> -0.513314).  Saving model ...
Epoch: 32 cost time: 5.871044874191284
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.975 Vali Acc: 0.507 Test Loss: 1.975 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.86376166343689
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.975 Vali Acc: 0.507 Test Loss: 1.975 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.246588945388794
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.968 Vali Acc: 0.513 Test Loss: 1.968 Test Acc: 0.513
Validation loss decreased (-0.513314 --> -0.513314).  Saving model ...
Epoch: 35 cost time: 5.650658845901489
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.957 Vali Acc: 0.513 Test Loss: 1.957 Test Acc: 0.513
Validation loss decreased (-0.513314 --> -0.513314).  Saving model ...
Epoch: 36 cost time: 5.510435342788696
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.520 Test Loss: 1.956 Test Acc: 0.520
Validation loss decreased (-0.513314 --> -0.519980).  Saving model ...
Epoch: 37 cost time: 5.633362531661987
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.942 Vali Acc: 0.517 Test Loss: 1.942 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.48766016960144
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.932 Vali Acc: 0.520 Test Loss: 1.932 Test Acc: 0.520
Validation loss decreased (-0.519980 --> -0.519981).  Saving model ...
Epoch: 39 cost time: 5.302158355712891
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.927 Vali Acc: 0.527 Test Loss: 1.927 Test Acc: 0.527
Validation loss decreased (-0.519981 --> -0.526647).  Saving model ...
Epoch: 40 cost time: 5.5857789516448975
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.922 Vali Acc: 0.530 Test Loss: 1.922 Test Acc: 0.530
Validation loss decreased (-0.526647 --> -0.529981).  Saving model ...
Epoch: 41 cost time: 5.545227289199829
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.917 Vali Acc: 0.540 Test Loss: 1.917 Test Acc: 0.540
Validation loss decreased (-0.529981 --> -0.539981).  Saving model ...
Epoch: 42 cost time: 5.384391784667969
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.915 Vali Acc: 0.543 Test Loss: 1.915 Test Acc: 0.543
Validation loss decreased (-0.539981 --> -0.543314).  Saving model ...
Epoch: 43 cost time: 6.253657817840576
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.911 Vali Acc: 0.540 Test Loss: 1.911 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 5.905765533447266
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.908 Vali Acc: 0.540 Test Loss: 1.908 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 6.261232614517212
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.904 Vali Acc: 0.537 Test Loss: 1.904 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 5.961883783340454
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.896 Vali Acc: 0.540 Test Loss: 1.896 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 5.885906219482422
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.891 Vali Acc: 0.553 Test Loss: 1.891 Test Acc: 0.553
Validation loss decreased (-0.543314 --> -0.553314).  Saving model ...
Epoch: 48 cost time: 5.716233253479004
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.888 Vali Acc: 0.557 Test Loss: 1.888 Test Acc: 0.557
Validation loss decreased (-0.553314 --> -0.556648).  Saving model ...
Epoch: 49 cost time: 5.723784446716309
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.888 Vali Acc: 0.553 Test Loss: 1.888 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.677717208862305
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.884 Vali Acc: 0.553 Test Loss: 1.884 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 5.2947165966033936
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.880 Vali Acc: 0.557 Test Loss: 1.880 Test Acc: 0.557
Validation loss decreased (-0.556648 --> -0.556648).  Saving model ...
Epoch: 52 cost time: 5.811026334762573
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.879 Vali Acc: 0.560 Test Loss: 1.879 Test Acc: 0.560
Validation loss decreased (-0.556648 --> -0.559981).  Saving model ...
Epoch: 53 cost time: 5.866727352142334
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.873 Vali Acc: 0.563 Test Loss: 1.873 Test Acc: 0.563
Validation loss decreased (-0.559981 --> -0.563315).  Saving model ...
Epoch: 54 cost time: 6.022218704223633
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.563 Test Loss: 1.871 Test Acc: 0.563
Validation loss decreased (-0.563315 --> -0.563315).  Saving model ...
Epoch: 55 cost time: 5.5616865158081055
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.865 Vali Acc: 0.563 Test Loss: 1.865 Test Acc: 0.563
Validation loss decreased (-0.563315 --> -0.563315).  Saving model ...
Epoch: 56 cost time: 5.531576871871948
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.859 Vali Acc: 0.560 Test Loss: 1.859 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.832129955291748
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.857 Vali Acc: 0.563 Test Loss: 1.857 Test Acc: 0.563
Validation loss decreased (-0.563315 --> -0.563315).  Saving model ...
Epoch: 58 cost time: 5.726274013519287
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.852 Vali Acc: 0.567 Test Loss: 1.852 Test Acc: 0.567
Validation loss decreased (-0.563315 --> -0.566648).  Saving model ...
Epoch: 59 cost time: 5.728338003158569
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.848 Vali Acc: 0.570 Test Loss: 1.848 Test Acc: 0.570
Validation loss decreased (-0.566648 --> -0.569982).  Saving model ...
Epoch: 60 cost time: 5.60192608833313
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.849 Vali Acc: 0.573 Test Loss: 1.849 Test Acc: 0.573
Validation loss decreased (-0.569982 --> -0.573315).  Saving model ...
Epoch: 61 cost time: 6.20142388343811
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.856 Vali Acc: 0.577 Test Loss: 1.856 Test Acc: 0.577
Validation loss decreased (-0.573315 --> -0.576648).  Saving model ...
Epoch: 62 cost time: 6.1985979080200195
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.587 Test Loss: 1.854 Test Acc: 0.587
Validation loss decreased (-0.576648 --> -0.586648).  Saving model ...
Epoch: 63 cost time: 6.075277805328369
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.587 Test Loss: 1.851 Test Acc: 0.587
Validation loss decreased (-0.586648 --> -0.586648).  Saving model ...
Epoch: 64 cost time: 6.294163942337036
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.846 Vali Acc: 0.587 Test Loss: 1.846 Test Acc: 0.587
Validation loss decreased (-0.586648 --> -0.586648).  Saving model ...
Epoch: 65 cost time: 6.044093370437622
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.842 Vali Acc: 0.590 Test Loss: 1.842 Test Acc: 0.590
Validation loss decreased (-0.586648 --> -0.589982).  Saving model ...
Epoch: 66 cost time: 6.106437683105469
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.840 Vali Acc: 0.583 Test Loss: 1.840 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 5.574340581893921
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.838 Vali Acc: 0.590 Test Loss: 1.838 Test Acc: 0.590
Validation loss decreased (-0.589982 --> -0.589982).  Saving model ...
Epoch: 68 cost time: 5.746746301651001
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.836 Vali Acc: 0.590 Test Loss: 1.836 Test Acc: 0.590
Validation loss decreased (-0.589982 --> -0.589982).  Saving model ...
Epoch: 69 cost time: 6.002448797225952
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.593 Test Loss: 1.834 Test Acc: 0.593
Validation loss decreased (-0.589982 --> -0.593315).  Saving model ...
Epoch: 70 cost time: 5.679599285125732
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.832 Vali Acc: 0.593 Test Loss: 1.832 Test Acc: 0.593
Validation loss decreased (-0.593315 --> -0.593315).  Saving model ...
Epoch: 71 cost time: 5.8838348388671875
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.831 Vali Acc: 0.590 Test Loss: 1.831 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 6.040083646774292
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.590 Test Loss: 1.833 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.5458056926727295
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.590 Test Loss: 1.834 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 6.183141469955444
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.832 Vali Acc: 0.587 Test Loss: 1.832 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 6.383791208267212
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.831 Vali Acc: 0.587 Test Loss: 1.831 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 5.640503883361816
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.587 Test Loss: 1.829 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 6.416523456573486
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.590 Test Loss: 1.825 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 6.305032730102539
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.819 Vali Acc: 0.597 Test Loss: 1.819 Test Acc: 0.597
Validation loss decreased (-0.593315 --> -0.596648).  Saving model ...
Epoch: 79 cost time: 6.194056510925293
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.597 Test Loss: 1.818 Test Acc: 0.597
Validation loss decreased (-0.596648 --> -0.596648).  Saving model ...
Epoch: 80 cost time: 6.188780784606934
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.817 Vali Acc: 0.597 Test Loss: 1.817 Test Acc: 0.597
Validation loss decreased (-0.596648 --> -0.596648).  Saving model ...
Epoch: 81 cost time: 6.376052379608154
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.814 Vali Acc: 0.597 Test Loss: 1.814 Test Acc: 0.597
Validation loss decreased (-0.596648 --> -0.596649).  Saving model ...
Epoch: 82 cost time: 5.835352420806885
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.603 Test Loss: 1.811 Test Acc: 0.603
Validation loss decreased (-0.596649 --> -0.603315).  Saving model ...
Epoch: 83 cost time: 5.880414247512817
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.808 Vali Acc: 0.607 Test Loss: 1.808 Test Acc: 0.607
Validation loss decreased (-0.603315 --> -0.606649).  Saving model ...
Epoch: 84 cost time: 5.543696165084839
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.808 Vali Acc: 0.603 Test Loss: 1.808 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 5.159437894821167
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.808 Vali Acc: 0.603 Test Loss: 1.808 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 5.850091218948364
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.812 Vali Acc: 0.603 Test Loss: 1.812 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 5.614190101623535
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.810 Vali Acc: 0.603 Test Loss: 1.810 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 5.964579343795776
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.807 Vali Acc: 0.603 Test Loss: 1.807 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 6.221965551376343
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.804 Vali Acc: 0.603 Test Loss: 1.804 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 6.216481447219849
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.603 Test Loss: 1.802 Test Acc: 0.603
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 5.844198703765869
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.607 Test Loss: 1.799 Test Acc: 0.607
Validation loss decreased (-0.606649 --> -0.606649).  Saving model ...
Epoch: 92 cost time: 5.9323694705963135
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.798 Vali Acc: 0.607 Test Loss: 1.798 Test Acc: 0.607
Validation loss decreased (-0.606649 --> -0.606649).  Saving model ...
Epoch: 93 cost time: 5.754006862640381
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.610 Test Loss: 1.799 Test Acc: 0.610
Validation loss decreased (-0.606649 --> -0.609982).  Saving model ...
Epoch: 94 cost time: 5.787217140197754
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.798 Vali Acc: 0.607 Test Loss: 1.798 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 5.495443344116211
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.797 Vali Acc: 0.607 Test Loss: 1.797 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 5.875922441482544
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.610 Test Loss: 1.796 Test Acc: 0.610
Validation loss decreased (-0.609982 --> -0.609982).  Saving model ...
Epoch: 97 cost time: 5.923640251159668
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.607 Test Loss: 1.796 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 5.4464991092681885
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.617 Test Loss: 1.794 Test Acc: 0.617
Validation loss decreased (-0.609982 --> -0.616649).  Saving model ...
Epoch: 99 cost time: 6.101846694946289
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.627 Test Loss: 1.791 Test Acc: 0.627
Validation loss decreased (-0.616649 --> -0.626649).  Saving model ...
Epoch: 100 cost time: 5.726358890533447
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.627 Test Loss: 1.791 Test Acc: 0.627
Validation loss decreased (-0.626649 --> -0.626649).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6266666666666667
model parameter : 13940761
model size : 72.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.845932483673096
Epoch: 1, Steps: 18 | Train Loss: 3.263 Vali Loss: 3.084 Vali Acc: 0.080 Test Loss: 3.084 Test Acc: 0.080
Validation loss decreased (inf --> -0.079969).  Saving model ...
Epoch: 2 cost time: 5.380646467208862
Epoch: 2, Steps: 18 | Train Loss: 1.686 Vali Loss: 2.755 Vali Acc: 0.183 Test Loss: 2.755 Test Acc: 0.183
Validation loss decreased (-0.079969 --> -0.183306).  Saving model ...
Epoch: 3 cost time: 5.401463270187378
Epoch: 3, Steps: 18 | Train Loss: 0.383 Vali Loss: 2.808 Vali Acc: 0.213 Test Loss: 2.808 Test Acc: 0.213
Validation loss decreased (-0.183306 --> -0.213305).  Saving model ...
Epoch: 4 cost time: 5.8944902420043945
Epoch: 4, Steps: 18 | Train Loss: 0.048 Vali Loss: 2.325 Vali Acc: 0.327 Test Loss: 2.325 Test Acc: 0.327
Validation loss decreased (-0.213305 --> -0.326643).  Saving model ...
Epoch: 5 cost time: 5.6996009349823
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.122 Vali Acc: 0.397 Test Loss: 2.122 Test Acc: 0.397
Validation loss decreased (-0.326643 --> -0.396645).  Saving model ...
Epoch: 6 cost time: 6.013888120651245
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.056 Vali Acc: 0.417 Test Loss: 2.056 Test Acc: 0.417
Validation loss decreased (-0.396645 --> -0.416646).  Saving model ...
Epoch: 7 cost time: 5.770481824874878
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.022 Vali Acc: 0.463 Test Loss: 2.022 Test Acc: 0.463
Validation loss decreased (-0.416646 --> -0.463313).  Saving model ...
Epoch: 8 cost time: 5.747334718704224
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.907 Vali Acc: 0.487 Test Loss: 1.907 Test Acc: 0.487
Validation loss decreased (-0.463313 --> -0.486648).  Saving model ...
Epoch: 9 cost time: 5.658271312713623
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.844 Vali Acc: 0.507 Test Loss: 1.844 Test Acc: 0.507
Validation loss decreased (-0.486648 --> -0.506648).  Saving model ...
Epoch: 10 cost time: 5.422576427459717
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.817 Vali Acc: 0.510 Test Loss: 1.817 Test Acc: 0.510
Validation loss decreased (-0.506648 --> -0.509982).  Saving model ...
Epoch: 11 cost time: 5.834335088729858
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.520 Test Loss: 1.776 Test Acc: 0.520
Validation loss decreased (-0.509982 --> -0.519982).  Saving model ...
Epoch: 12 cost time: 5.420552492141724
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.523 Test Loss: 1.772 Test Acc: 0.523
Validation loss decreased (-0.519982 --> -0.523316).  Saving model ...
Epoch: 13 cost time: 5.699357509613037
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.746 Vali Acc: 0.527 Test Loss: 1.746 Test Acc: 0.527
Validation loss decreased (-0.523316 --> -0.526649).  Saving model ...
Epoch: 14 cost time: 5.544847726821899
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.735 Vali Acc: 0.537 Test Loss: 1.735 Test Acc: 0.537
Validation loss decreased (-0.526649 --> -0.536649).  Saving model ...
Epoch: 15 cost time: 5.697615623474121
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.710 Vali Acc: 0.550 Test Loss: 1.710 Test Acc: 0.550
Validation loss decreased (-0.536649 --> -0.549983).  Saving model ...
Epoch: 16 cost time: 5.5531532764434814
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.547 Test Loss: 1.685 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.621227025985718
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.660 Vali Acc: 0.563 Test Loss: 1.660 Test Acc: 0.563
Validation loss decreased (-0.549983 --> -0.563317).  Saving model ...
Epoch: 18 cost time: 5.5184326171875
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.563 Test Loss: 1.640 Test Acc: 0.563
Validation loss decreased (-0.563317 --> -0.563317).  Saving model ...
Epoch: 19 cost time: 5.264336824417114
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.570 Test Loss: 1.627 Test Acc: 0.570
Validation loss decreased (-0.563317 --> -0.569984).  Saving model ...
Epoch: 20 cost time: 5.801303148269653
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.577 Test Loss: 1.616 Test Acc: 0.577
Validation loss decreased (-0.569984 --> -0.576651).  Saving model ...
Epoch: 21 cost time: 5.510965585708618
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.570 Test Loss: 1.611 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.074658393859863
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.621 Vali Acc: 0.577 Test Loss: 1.621 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.683233976364136
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.587 Test Loss: 1.611 Test Acc: 0.587
Validation loss decreased (-0.576651 --> -0.586651).  Saving model ...
Epoch: 24 cost time: 5.7142908573150635
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.594 Vali Acc: 0.587 Test Loss: 1.594 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 25 cost time: 5.75231146812439
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.607 Test Loss: 1.580 Test Acc: 0.607
Validation loss decreased (-0.586651 --> -0.606651).  Saving model ...
Epoch: 26 cost time: 5.376518487930298
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.568 Vali Acc: 0.607 Test Loss: 1.568 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606651).  Saving model ...
Epoch: 27 cost time: 5.512265682220459
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.564 Vali Acc: 0.613 Test Loss: 1.564 Test Acc: 0.613
Validation loss decreased (-0.606651 --> -0.613318).  Saving model ...
Epoch: 28 cost time: 5.727594614028931
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.557 Vali Acc: 0.617 Test Loss: 1.557 Test Acc: 0.617
Validation loss decreased (-0.613318 --> -0.616651).  Saving model ...
Epoch: 29 cost time: 5.363453388214111
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.613 Test Loss: 1.551 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.473040819168091
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.617 Test Loss: 1.550 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616651).  Saving model ...
Epoch: 31 cost time: 5.347415208816528
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.617 Test Loss: 1.547 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616651).  Saving model ...
Epoch: 32 cost time: 6.164617538452148
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.617 Test Loss: 1.541 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616651).  Saving model ...
Epoch: 33 cost time: 5.368976593017578
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.627 Test Loss: 1.541 Test Acc: 0.627
Validation loss decreased (-0.616651 --> -0.626651).  Saving model ...
Epoch: 34 cost time: 5.640797853469849
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.620 Test Loss: 1.538 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.46086859703064
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.627 Test Loss: 1.530 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 36 cost time: 5.349671840667725
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.627 Test Loss: 1.526 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 37 cost time: 5.697472333908081
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.633 Test Loss: 1.522 Test Acc: 0.633
Validation loss decreased (-0.626651 --> -0.633318).  Saving model ...
Epoch: 38 cost time: 5.635600328445435
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.630 Test Loss: 1.513 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.579545259475708
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.630 Test Loss: 1.509 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 5.765170097351074
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.502 Vali Acc: 0.640 Test Loss: 1.502 Test Acc: 0.640
Validation loss decreased (-0.633318 --> -0.639985).  Saving model ...
Epoch: 41 cost time: 6.093759059906006
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.647 Test Loss: 1.499 Test Acc: 0.647
Validation loss decreased (-0.639985 --> -0.646652).  Saving model ...
Epoch: 42 cost time: 5.778550624847412
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.647 Test Loss: 1.501 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.012963056564331
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.650 Test Loss: 1.494 Test Acc: 0.650
Validation loss decreased (-0.646652 --> -0.649985).  Saving model ...
Epoch: 44 cost time: 5.683730125427246
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.650 Test Loss: 1.488 Test Acc: 0.650
Validation loss decreased (-0.649985 --> -0.649985).  Saving model ...
Epoch: 45 cost time: 5.240281581878662
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.647 Test Loss: 1.486 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.675206184387207
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.643 Test Loss: 1.488 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.707045316696167
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.653 Test Loss: 1.486 Test Acc: 0.653
Validation loss decreased (-0.649985 --> -0.653318).  Saving model ...
Epoch: 48 cost time: 5.905338764190674
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.653 Test Loss: 1.484 Test Acc: 0.653
Validation loss decreased (-0.653318 --> -0.653318).  Saving model ...
Epoch: 49 cost time: 5.471364736557007
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.650 Test Loss: 1.477 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.781450271606445
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.653 Test Loss: 1.472 Test Acc: 0.653
Validation loss decreased (-0.653318 --> -0.653319).  Saving model ...
Epoch: 51 cost time: 5.4455296993255615
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.650 Test Loss: 1.468 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.012037515640259
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.657 Test Loss: 1.468 Test Acc: 0.657
Validation loss decreased (-0.653319 --> -0.656652).  Saving model ...
Epoch: 53 cost time: 5.54750657081604
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.657 Test Loss: 1.472 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.954219102859497
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.653 Test Loss: 1.470 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.0738914012908936
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.657 Test Loss: 1.462 Test Acc: 0.657
Validation loss decreased (-0.656652 --> -0.656652).  Saving model ...
Epoch: 56 cost time: 5.826810359954834
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.657 Test Loss: 1.460 Test Acc: 0.657
Validation loss decreased (-0.656652 --> -0.656652).  Saving model ...
Epoch: 57 cost time: 6.152235507965088
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.457 Vali Acc: 0.660 Test Loss: 1.457 Test Acc: 0.660
Validation loss decreased (-0.656652 --> -0.659985).  Saving model ...
Epoch: 58 cost time: 5.8502655029296875
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.660 Test Loss: 1.456 Test Acc: 0.660
Validation loss decreased (-0.659985 --> -0.659985).  Saving model ...
Epoch: 59 cost time: 6.0849199295043945
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.457 Vali Acc: 0.663 Test Loss: 1.457 Test Acc: 0.663
Validation loss decreased (-0.659985 --> -0.663319).  Saving model ...
Epoch: 60 cost time: 6.198894262313843
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.459 Vali Acc: 0.663 Test Loss: 1.459 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 5.890833139419556
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.663 Test Loss: 1.461 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 5.563000440597534
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.667 Test Loss: 1.456 Test Acc: 0.667
Validation loss decreased (-0.663319 --> -0.666652).  Saving model ...
Epoch: 63 cost time: 5.43561577796936
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.663 Test Loss: 1.455 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.691405773162842
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.663 Test Loss: 1.452 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 5.756752967834473
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.670 Test Loss: 1.447 Test Acc: 0.670
Validation loss decreased (-0.666652 --> -0.669986).  Saving model ...
Epoch: 66 cost time: 5.7588279247283936
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.670 Test Loss: 1.447 Test Acc: 0.670
Validation loss decreased (-0.669986 --> -0.669986).  Saving model ...
Epoch: 67 cost time: 5.603970289230347
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.670 Test Loss: 1.449 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 6.36469030380249
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.670 Test Loss: 1.448 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 6.033889293670654
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.677 Test Loss: 1.442 Test Acc: 0.677
Validation loss decreased (-0.669986 --> -0.676652).  Saving model ...
Epoch: 70 cost time: 6.183788061141968
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.673 Test Loss: 1.444 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 6.092999458312988
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.670 Test Loss: 1.447 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 5.463624715805054
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.673 Test Loss: 1.449 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 5.551017761230469
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.673 Test Loss: 1.447 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 5.7730913162231445
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.683 Test Loss: 1.441 Test Acc: 0.683
Validation loss decreased (-0.676652 --> -0.683319).  Saving model ...
Epoch: 75 cost time: 5.444838047027588
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.683 Test Loss: 1.437 Test Acc: 0.683
Validation loss decreased (-0.683319 --> -0.683319).  Saving model ...
Epoch: 76 cost time: 5.622875690460205
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.687 Test Loss: 1.433 Test Acc: 0.687
Validation loss decreased (-0.683319 --> -0.686652).  Saving model ...
Epoch: 77 cost time: 5.47545599937439
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.687 Test Loss: 1.430 Test Acc: 0.687
Validation loss decreased (-0.686652 --> -0.686652).  Saving model ...
Epoch: 78 cost time: 5.750608682632446
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.683 Test Loss: 1.427 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 5.828393936157227
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.683 Test Loss: 1.429 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 5.131376504898071
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.683 Test Loss: 1.428 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 5.3625147342681885
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.690 Test Loss: 1.430 Test Acc: 0.690
Validation loss decreased (-0.686652 --> -0.689986).  Saving model ...
Epoch: 82 cost time: 5.284618139266968
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.687 Test Loss: 1.430 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 5.460247278213501
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.687 Test Loss: 1.429 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 5.839860677719116
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.683 Test Loss: 1.430 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 5.734450101852417
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.687 Test Loss: 1.430 Test Acc: 0.687
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 6.004398584365845
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.687 Test Loss: 1.430 Test Acc: 0.687
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 6.351557493209839
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.687 Test Loss: 1.428 Test Acc: 0.687
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 6.385510206222534
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.687 Test Loss: 1.427 Test Acc: 0.687
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 5.782510280609131
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.693 Test Loss: 1.428 Test Acc: 0.693
Validation loss decreased (-0.689986 --> -0.693319).  Saving model ...
Epoch: 90 cost time: 6.048000335693359
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.697 Test Loss: 1.427 Test Acc: 0.697
Validation loss decreased (-0.693319 --> -0.696652).  Saving model ...
Epoch: 91 cost time: 6.150416851043701
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.693 Test Loss: 1.423 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 5.759539604187012
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.697 Test Loss: 1.424 Test Acc: 0.697
Validation loss decreased (-0.696652 --> -0.696652).  Saving model ...
Epoch: 93 cost time: 5.62828516960144
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.693 Test Loss: 1.429 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 5.512797117233276
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.693 Test Loss: 1.427 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 5.540104866027832
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.700 Test Loss: 1.427 Test Acc: 0.700
Validation loss decreased (-0.696652 --> -0.699986).  Saving model ...
Epoch: 96 cost time: 5.5070109367370605
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.703 Test Loss: 1.427 Test Acc: 0.703
Validation loss decreased (-0.699986 --> -0.703319).  Saving model ...
Epoch: 97 cost time: 5.6524975299835205
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.697 Test Loss: 1.424 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 5.945160627365112
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.700 Test Loss: 1.422 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 5.998605728149414
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.703 Test Loss: 1.419 Test Acc: 0.703
Validation loss decreased (-0.703319 --> -0.703319).  Saving model ...
Epoch: 100 cost time: 5.95689582824707
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.703 Test Loss: 1.419 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7033333333333334
model parameter : 13940761
model size : 72.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.234699726104736
Epoch: 1, Steps: 18 | Train Loss: 3.284 Vali Loss: 3.135 Vali Acc: 0.067 Test Loss: 3.135 Test Acc: 0.067
Validation loss decreased (inf --> -0.066635).  Saving model ...
Epoch: 2 cost time: 5.724345922470093
Epoch: 2, Steps: 18 | Train Loss: 1.760 Vali Loss: 2.791 Vali Acc: 0.163 Test Loss: 2.791 Test Acc: 0.163
Validation loss decreased (-0.066635 --> -0.163305).  Saving model ...
Epoch: 3 cost time: 5.965366840362549
Epoch: 3, Steps: 18 | Train Loss: 0.417 Vali Loss: 2.767 Vali Acc: 0.210 Test Loss: 2.767 Test Acc: 0.210
Validation loss decreased (-0.163305 --> -0.209972).  Saving model ...
Epoch: 4 cost time: 5.609185218811035
Epoch: 4, Steps: 18 | Train Loss: 0.053 Vali Loss: 2.112 Vali Acc: 0.367 Test Loss: 2.112 Test Acc: 0.367
Validation loss decreased (-0.209972 --> -0.366646).  Saving model ...
Epoch: 5 cost time: 5.674713134765625
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.925 Vali Acc: 0.440 Test Loss: 1.925 Test Acc: 0.440
Validation loss decreased (-0.366646 --> -0.439981).  Saving model ...
Epoch: 6 cost time: 5.749530792236328
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.935 Vali Acc: 0.440 Test Loss: 1.935 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.127213001251221
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.867 Vali Acc: 0.457 Test Loss: 1.867 Test Acc: 0.457
Validation loss decreased (-0.439981 --> -0.456648).  Saving model ...
Epoch: 8 cost time: 5.853187322616577
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.789 Vali Acc: 0.480 Test Loss: 1.789 Test Acc: 0.480
Validation loss decreased (-0.456648 --> -0.479982).  Saving model ...
Epoch: 9 cost time: 5.7815985679626465
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.743 Vali Acc: 0.503 Test Loss: 1.743 Test Acc: 0.503
Validation loss decreased (-0.479982 --> -0.503316).  Saving model ...
Epoch: 10 cost time: 5.640723705291748
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.706 Vali Acc: 0.490 Test Loss: 1.706 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.639562129974365
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.664 Vali Acc: 0.507 Test Loss: 1.664 Test Acc: 0.507
Validation loss decreased (-0.503316 --> -0.506650).  Saving model ...
Epoch: 12 cost time: 6.384667158126831
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.659 Vali Acc: 0.513 Test Loss: 1.659 Test Acc: 0.513
Validation loss decreased (-0.506650 --> -0.513317).  Saving model ...
Epoch: 13 cost time: 5.810171604156494
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.520 Test Loss: 1.637 Test Acc: 0.520
Validation loss decreased (-0.513317 --> -0.519984).  Saving model ...
Epoch: 14 cost time: 5.750665664672852
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.520 Test Loss: 1.612 Test Acc: 0.520
Validation loss decreased (-0.519984 --> -0.519984).  Saving model ...
Epoch: 15 cost time: 5.8711097240448
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.527 Test Loss: 1.591 Test Acc: 0.527
Validation loss decreased (-0.519984 --> -0.526651).  Saving model ...
Epoch: 16 cost time: 5.499121427536011
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.530 Test Loss: 1.582 Test Acc: 0.530
Validation loss decreased (-0.526651 --> -0.529984).  Saving model ...
Epoch: 17 cost time: 6.022222995758057
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.547 Test Loss: 1.551 Test Acc: 0.547
Validation loss decreased (-0.529984 --> -0.546651).  Saving model ...
Epoch: 18 cost time: 6.080497741699219
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.560 Test Loss: 1.533 Test Acc: 0.560
Validation loss decreased (-0.546651 --> -0.559985).  Saving model ...
Epoch: 19 cost time: 5.778114318847656
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.518 Vali Acc: 0.563 Test Loss: 1.518 Test Acc: 0.563
Validation loss decreased (-0.559985 --> -0.563318).  Saving model ...
Epoch: 20 cost time: 5.608107328414917
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.563 Test Loss: 1.511 Test Acc: 0.563
Validation loss decreased (-0.563318 --> -0.563318).  Saving model ...
Epoch: 21 cost time: 5.653043031692505
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.567 Test Loss: 1.507 Test Acc: 0.567
Validation loss decreased (-0.563318 --> -0.566652).  Saving model ...
Epoch: 22 cost time: 5.487245082855225
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.573 Test Loss: 1.504 Test Acc: 0.573
Validation loss decreased (-0.566652 --> -0.573318).  Saving model ...
Epoch: 23 cost time: 5.58846116065979
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.580 Test Loss: 1.490 Test Acc: 0.580
Validation loss decreased (-0.573318 --> -0.579985).  Saving model ...
Epoch: 24 cost time: 5.686752080917358
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.577 Test Loss: 1.468 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.119457006454468
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.580 Test Loss: 1.461 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 26 cost time: 5.693871259689331
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.600 Test Loss: 1.453 Test Acc: 0.600
Validation loss decreased (-0.579985 --> -0.599985).  Saving model ...
Epoch: 27 cost time: 5.5197837352752686
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.600 Test Loss: 1.449 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599986).  Saving model ...
Epoch: 28 cost time: 5.61152458190918
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.600 Test Loss: 1.448 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 29 cost time: 5.516920328140259
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.603 Test Loss: 1.443 Test Acc: 0.603
Validation loss decreased (-0.599986 --> -0.603319).  Saving model ...
Epoch: 30 cost time: 5.849420547485352
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.603 Test Loss: 1.440 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 31 cost time: 5.945200681686401
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.613 Test Loss: 1.438 Test Acc: 0.613
Validation loss decreased (-0.603319 --> -0.613319).  Saving model ...
Epoch: 32 cost time: 5.888944387435913
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.607 Test Loss: 1.433 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.596681356430054
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.617 Test Loss: 1.427 Test Acc: 0.617
Validation loss decreased (-0.613319 --> -0.616652).  Saving model ...
Epoch: 34 cost time: 5.914119720458984
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.421 Vali Acc: 0.623 Test Loss: 1.421 Test Acc: 0.623
Validation loss decreased (-0.616652 --> -0.623319).  Saving model ...
Epoch: 35 cost time: 5.692299127578735
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.630 Test Loss: 1.416 Test Acc: 0.630
Validation loss decreased (-0.623319 --> -0.629986).  Saving model ...
Epoch: 36 cost time: 5.4798290729522705
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.627 Test Loss: 1.416 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.03013014793396
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.630 Test Loss: 1.410 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 38 cost time: 5.911743402481079
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.640 Test Loss: 1.403 Test Acc: 0.640
Validation loss decreased (-0.629986 --> -0.639986).  Saving model ...
Epoch: 39 cost time: 5.493067026138306
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.637 Test Loss: 1.401 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.749377727508545
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.643 Test Loss: 1.400 Test Acc: 0.643
Validation loss decreased (-0.639986 --> -0.643319).  Saving model ...
Epoch: 41 cost time: 6.124307632446289
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.653 Test Loss: 1.399 Test Acc: 0.653
Validation loss decreased (-0.643319 --> -0.653319).  Saving model ...
Epoch: 42 cost time: 5.609848260879517
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.653 Test Loss: 1.395 Test Acc: 0.653
Validation loss decreased (-0.653319 --> -0.653319).  Saving model ...
Epoch: 43 cost time: 5.944121360778809
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.657 Test Loss: 1.393 Test Acc: 0.657
Validation loss decreased (-0.653319 --> -0.656653).  Saving model ...
Epoch: 44 cost time: 5.847546815872192
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.663 Test Loss: 1.391 Test Acc: 0.663
Validation loss decreased (-0.656653 --> -0.663319).  Saving model ...
Epoch: 45 cost time: 5.872291564941406
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.660 Test Loss: 1.387 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.111621379852295
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.653 Test Loss: 1.393 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.991321325302124
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.647 Test Loss: 1.391 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 5.873989582061768
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.657 Test Loss: 1.387 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 5.978591203689575
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.657 Test Loss: 1.382 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 6.003079175949097
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.379 Vali Acc: 0.660 Test Loss: 1.379 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 5.883154392242432
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.375 Vali Acc: 0.663 Test Loss: 1.375 Test Acc: 0.663
Validation loss decreased (-0.663319 --> -0.663320).  Saving model ...
Epoch: 52 cost time: 6.268868446350098
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.663 Test Loss: 1.374 Test Acc: 0.663
Validation loss decreased (-0.663320 --> -0.663320).  Saving model ...
Epoch: 53 cost time: 5.695581436157227
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.657 Test Loss: 1.372 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.877107381820679
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.657 Test Loss: 1.369 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 5.709651470184326
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.660 Test Loss: 1.364 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 5.552214860916138
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.667 Test Loss: 1.361 Test Acc: 0.667
Validation loss decreased (-0.663320 --> -0.666653).  Saving model ...
Epoch: 57 cost time: 6.127967596054077
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.667 Test Loss: 1.359 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
Epoch: 58 cost time: 5.7210869789123535
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.670 Test Loss: 1.356 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.669986).  Saving model ...
Epoch: 59 cost time: 5.5141332149505615
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.673 Test Loss: 1.354 Test Acc: 0.673
Validation loss decreased (-0.669986 --> -0.673320).  Saving model ...
Epoch: 60 cost time: 6.267887830734253
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.673 Test Loss: 1.356 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.061798572540283
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.673 Test Loss: 1.360 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 5.9596335887908936
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.670 Test Loss: 1.357 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 5.950139284133911
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.673 Test Loss: 1.358 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 6.257403612136841
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.677 Test Loss: 1.355 Test Acc: 0.677
Validation loss decreased (-0.673320 --> -0.676653).  Saving model ...
Epoch: 65 cost time: 5.613443851470947
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.677 Test Loss: 1.354 Test Acc: 0.677
Validation loss decreased (-0.676653 --> -0.676653).  Saving model ...
Epoch: 66 cost time: 5.779433965682983
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.680 Test Loss: 1.354 Test Acc: 0.680
Validation loss decreased (-0.676653 --> -0.679986).  Saving model ...
Epoch: 67 cost time: 5.862779378890991
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.683 Test Loss: 1.355 Test Acc: 0.683
Validation loss decreased (-0.679986 --> -0.683320).  Saving model ...
Epoch: 68 cost time: 5.892751693725586
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.680 Test Loss: 1.355 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 5.980481147766113
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.690 Test Loss: 1.353 Test Acc: 0.690
Validation loss decreased (-0.683320 --> -0.689986).  Saving model ...
Epoch: 70 cost time: 5.846764326095581
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.693 Test Loss: 1.355 Test Acc: 0.693
Validation loss decreased (-0.689986 --> -0.693320).  Saving model ...
Epoch: 71 cost time: 5.894802570343018
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.683 Test Loss: 1.356 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.900726795196533
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.683 Test Loss: 1.357 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.028656482696533
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.687 Test Loss: 1.355 Test Acc: 0.687
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 5.518566608428955
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.687 Test Loss: 1.353 Test Acc: 0.687
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 5.906417369842529
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.687 Test Loss: 1.351 Test Acc: 0.687
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 5.7607200145721436
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.683 Test Loss: 1.349 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 6.045340061187744
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.690 Test Loss: 1.346 Test Acc: 0.690
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 6.009504556655884
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.697 Test Loss: 1.344 Test Acc: 0.697
Validation loss decreased (-0.693320 --> -0.696653).  Saving model ...
Epoch: 79 cost time: 5.903698682785034
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.697 Test Loss: 1.347 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 6.061777353286743
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.697 Test Loss: 1.347 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 6.2801713943481445
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.697 Test Loss: 1.347 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 5.915607929229736
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.700 Test Loss: 1.346 Test Acc: 0.700
Validation loss decreased (-0.696653 --> -0.699987).  Saving model ...
Epoch: 83 cost time: 6.170120477676392
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.700 Test Loss: 1.345 Test Acc: 0.700
Validation loss decreased (-0.699987 --> -0.699987).  Saving model ...
Epoch: 84 cost time: 5.338385105133057
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.700 Test Loss: 1.348 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 5.568415880203247
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.697 Test Loss: 1.349 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 5.33083701133728
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.697 Test Loss: 1.350 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 5.771382808685303
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.697 Test Loss: 1.350 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 5.940300464630127
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.697 Test Loss: 1.349 Test Acc: 0.697
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 5.842854976654053
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.697 Test Loss: 1.350 Test Acc: 0.697
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 5.663663387298584
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.693 Test Loss: 1.349 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 5.296233654022217
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.697 Test Loss: 1.347 Test Acc: 0.697
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 5.4779052734375
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.697 Test Loss: 1.348 Test Acc: 0.697
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 5.616710186004639
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.697 Test Loss: 1.350 Test Acc: 0.697
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7
model parameter : 13940761
model size : 72.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.884387493133545
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 5.8468122482299805
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 3 cost time: 5.579008340835571
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 4 cost time: 5.861104488372803
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.542481422424316
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.267967462539673
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.388046503067017
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.186309576034546
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 9 cost time: 5.523227691650391
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 10 cost time: 5.46325945854187
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 11 cost time: 5.821716547012329
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 12 cost time: 5.760071277618408
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.629690647125244
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.647229433059692
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.616353511810303
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.469622373580933
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.955710411071777
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.638767242431641
Epoch: 18, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.014498472213745
Epoch: 19, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.645004034042358
Epoch: 20, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.5939671993255615
Epoch: 21, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 13940761
model size : 72.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.905596971511841
Epoch: 1, Steps: 18 | Train Loss: 2.614 Vali Loss: 1.036 Vali Acc: 0.780 Test Loss: 1.036 Test Acc: 0.780
Validation loss decreased (inf --> -0.779990).  Saving model ...
Epoch: 2 cost time: 5.729520082473755
Epoch: 2, Steps: 18 | Train Loss: 0.327 Vali Loss: 0.535 Vali Acc: 0.873 Test Loss: 0.535 Test Acc: 0.873
Validation loss decreased (-0.779990 --> -0.873328).  Saving model ...
Epoch: 3 cost time: 5.348820924758911
Epoch: 3, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.560 Vali Acc: 0.857 Test Loss: 0.560 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.45047664642334
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.847 Test Loss: 0.643 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.841665506362915
Epoch: 5, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.466 Vali Acc: 0.883 Test Loss: 0.466 Test Acc: 0.883
Validation loss decreased (-0.873328 --> -0.883329).  Saving model ...
Epoch: 6 cost time: 5.768313646316528
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.438 Vali Acc: 0.890 Test Loss: 0.438 Test Acc: 0.890
Validation loss decreased (-0.883329 --> -0.889996).  Saving model ...
Epoch: 7 cost time: 5.8981523513793945
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.887 Test Loss: 0.420 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.9308600425720215
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.890 Test Loss: 0.417 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 9 cost time: 5.777653694152832
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.890 Test Loss: 0.416 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 10 cost time: 5.593812942504883
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.887 Test Loss: 0.413 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.7256762981414795
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.883 Test Loss: 0.411 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.187410593032837
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.890 Test Loss: 0.411 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 13 cost time: 5.77311372756958
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.893 Test Loss: 0.410 Test Acc: 0.893
Validation loss decreased (-0.889996 --> -0.893329).  Saving model ...
Epoch: 14 cost time: 5.832775592803955
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.890 Test Loss: 0.409 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.8861775398254395
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.893 Test Loss: 0.409 Test Acc: 0.893
Validation loss decreased (-0.893329 --> -0.893329).  Saving model ...
Epoch: 16 cost time: 5.64465069770813
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.890 Test Loss: 0.408 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.80670166015625
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.890 Test Loss: 0.407 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.462345123291016
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.893 Test Loss: 0.408 Test Acc: 0.893
Validation loss decreased (-0.893329 --> -0.893329).  Saving model ...
Epoch: 19 cost time: 5.19562840461731
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.893 Test Loss: 0.408 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.46353816986084
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.893 Test Loss: 0.407 Test Acc: 0.893
Validation loss decreased (-0.893329 --> -0.893329).  Saving model ...
Epoch: 21 cost time: 5.265166759490967
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.893 Test Loss: 0.408 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.395428895950317
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.897 Test Loss: 0.408 Test Acc: 0.897
Validation loss decreased (-0.893329 --> -0.896663).  Saving model ...
Epoch: 23 cost time: 6.052226305007935
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.897 Test Loss: 0.408 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.67138409614563
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.897 Test Loss: 0.409 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.541605710983276
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
Validation loss decreased (-0.896663 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 5.4338719844818115
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 5.576647996902466
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.654315710067749
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.897 Test Loss: 0.409 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.696098327636719
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.897 Test Loss: 0.409 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.721118211746216
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.6571033000946045
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.897 Test Loss: 0.409 Test Acc: 0.897
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.289200305938721
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.897 Test Loss: 0.410 Test Acc: 0.897
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 5.818585157394409
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.893 Test Loss: 0.409 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 5.689459800720215
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.893 Test Loss: 0.410 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 5.962327718734741
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.893 Test Loss: 0.409 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 5.81853175163269
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.893 Test Loss: 0.409 Test Acc: 0.893
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9
model parameter : 13154329
model size : 69.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.728307008743286
Epoch: 1, Steps: 18 | Train Loss: 2.799 Vali Loss: 1.399 Vali Acc: 0.683 Test Loss: 1.399 Test Acc: 0.683
Validation loss decreased (inf --> -0.683319).  Saving model ...
Epoch: 2 cost time: 5.582186222076416
Epoch: 2, Steps: 18 | Train Loss: 0.455 Vali Loss: 0.669 Vali Acc: 0.827 Test Loss: 0.669 Test Acc: 0.827
Validation loss decreased (-0.683319 --> -0.826660).  Saving model ...
Epoch: 3 cost time: 5.808590888977051
Epoch: 3, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.692 Vali Acc: 0.827 Test Loss: 0.692 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.847019195556641
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.833 Vali Acc: 0.787 Test Loss: 0.833 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.8159706592559814
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.830 Test Loss: 0.642 Test Acc: 0.830
Validation loss decreased (-0.826660 --> -0.829994).  Saving model ...
Epoch: 6 cost time: 5.521228075027466
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.837 Test Loss: 0.614 Test Acc: 0.837
Validation loss decreased (-0.829994 --> -0.836661).  Saving model ...
Epoch: 7 cost time: 5.572285413742065
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.837 Test Loss: 0.604 Test Acc: 0.837
Validation loss decreased (-0.836661 --> -0.836661).  Saving model ...
Epoch: 8 cost time: 5.751237154006958
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.843 Test Loss: 0.603 Test Acc: 0.843
Validation loss decreased (-0.836661 --> -0.843327).  Saving model ...
Epoch: 9 cost time: 5.528175115585327
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.840 Test Loss: 0.600 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.5816850662231445
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.840 Test Loss: 0.599 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.547820568084717
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.843 Test Loss: 0.597 Test Acc: 0.843
Validation loss decreased (-0.843327 --> -0.843327).  Saving model ...
Epoch: 12 cost time: 5.561316728591919
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.843 Test Loss: 0.597 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.618986368179321
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.843 Test Loss: 0.596 Test Acc: 0.843
Validation loss decreased (-0.843327 --> -0.843327).  Saving model ...
Epoch: 14 cost time: 5.562315940856934
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.843 Test Loss: 0.596 Test Acc: 0.843
Validation loss decreased (-0.843327 --> -0.843327).  Saving model ...
Epoch: 15 cost time: 5.550329685211182
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.843 Test Loss: 0.596 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.641377687454224
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.843 Test Loss: 0.595 Test Acc: 0.843
Validation loss decreased (-0.843327 --> -0.843327).  Saving model ...
Epoch: 17 cost time: 5.676995515823364
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.843 Test Loss: 0.595 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.706547498703003
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.843 Test Loss: 0.596 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.5009605884552
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.843 Test Loss: 0.595 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.691217422485352
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.843 Test Loss: 0.594 Test Acc: 0.843
Validation loss decreased (-0.843327 --> -0.843327).  Saving model ...
Epoch: 21 cost time: 5.855066299438477
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.843 Test Loss: 0.594 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.8035852909088135
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.843 Test Loss: 0.595 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.527613639831543
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.847 Test Loss: 0.595 Test Acc: 0.847
Validation loss decreased (-0.843327 --> -0.846661).  Saving model ...
Epoch: 24 cost time: 5.390663146972656
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.847 Test Loss: 0.596 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.466723680496216
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.847 Test Loss: 0.595 Test Acc: 0.847
Validation loss decreased (-0.846661 --> -0.846661).  Saving model ...
Epoch: 26 cost time: 5.692700624465942
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.847 Test Loss: 0.594 Test Acc: 0.847
Validation loss decreased (-0.846661 --> -0.846661).  Saving model ...
Epoch: 27 cost time: 5.321308135986328
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
Validation loss decreased (-0.846661 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 5.47002100944519
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.284457683563232
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.591642379760742
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.5881946086883545
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.748059988021851
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.744710206985474
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.868563890457153
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.853 Test Loss: 0.596 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853327).  Saving model ...
Epoch: 35 cost time: 5.755130052566528
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.857 Test Loss: 0.596 Test Acc: 0.857
Validation loss decreased (-0.853327 --> -0.856661).  Saving model ...
Epoch: 36 cost time: 5.554786443710327
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.853 Test Loss: 0.597 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.61640191078186
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.857 Test Loss: 0.597 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.377786636352539
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.860 Test Loss: 0.596 Test Acc: 0.860
Validation loss decreased (-0.856661 --> -0.859994).  Saving model ...
Epoch: 39 cost time: 5.557076692581177
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.857 Test Loss: 0.598 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.491528272628784
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.857 Test Loss: 0.599 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 5.610699415206909
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.857 Test Loss: 0.599 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 5.516410827636719
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.857 Test Loss: 0.600 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 5.684431076049805
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.857 Test Loss: 0.600 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 5.535735607147217
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.857 Test Loss: 0.601 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 5.631112813949585
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.857 Test Loss: 0.601 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 5.585150957107544
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.857 Test Loss: 0.601 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 5.519440174102783
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.857 Test Loss: 0.602 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 6.010186672210693
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.860 Test Loss: 0.603 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.86
model parameter : 13154329
model size : 69.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.145009517669678
Epoch: 1, Steps: 18 | Train Loss: 2.996 Vali Loss: 1.934 Vali Acc: 0.550 Test Loss: 1.934 Test Acc: 0.550
Validation loss decreased (inf --> -0.549981).  Saving model ...
Epoch: 2 cost time: 5.458725929260254
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 1.049 Vali Acc: 0.703 Test Loss: 1.049 Test Acc: 0.703
Validation loss decreased (-0.549981 --> -0.703323).  Saving model ...
Epoch: 3 cost time: 5.523113012313843
Epoch: 3, Steps: 18 | Train Loss: 0.091 Vali Loss: 1.049 Vali Acc: 0.737 Test Loss: 1.049 Test Acc: 0.737
Validation loss decreased (-0.703323 --> -0.736656).  Saving model ...
Epoch: 4 cost time: 5.389253377914429
Epoch: 4, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.968 Vali Acc: 0.710 Test Loss: 0.968 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.63120174407959
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.949 Vali Acc: 0.730 Test Loss: 0.949 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.871077537536621
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.747 Test Loss: 0.903 Test Acc: 0.747
Validation loss decreased (-0.736656 --> -0.746658).  Saving model ...
Epoch: 7 cost time: 5.784817695617676
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.767 Test Loss: 0.863 Test Acc: 0.767
Validation loss decreased (-0.746658 --> -0.766658).  Saving model ...
Epoch: 8 cost time: 5.969277858734131
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.770 Test Loss: 0.861 Test Acc: 0.770
Validation loss decreased (-0.766658 --> -0.769991).  Saving model ...
Epoch: 9 cost time: 6.215976715087891
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.777 Test Loss: 0.853 Test Acc: 0.777
Validation loss decreased (-0.769991 --> -0.776658).  Saving model ...
Epoch: 10 cost time: 6.068824768066406
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.767 Test Loss: 0.849 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.881959676742554
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.770 Test Loss: 0.845 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.998830556869507
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.770 Test Loss: 0.846 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.969638109207153
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.777 Test Loss: 0.847 Test Acc: 0.777
Validation loss decreased (-0.776658 --> -0.776658).  Saving model ...
Epoch: 14 cost time: 5.685687303543091
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.773 Test Loss: 0.848 Test Acc: 0.773
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.492278814315796
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.780 Test Loss: 0.848 Test Acc: 0.780
Validation loss decreased (-0.776658 --> -0.779992).  Saving model ...
Epoch: 16 cost time: 5.841675519943237
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.780 Test Loss: 0.848 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.688971996307373
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.780 Test Loss: 0.850 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.7899699211120605
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.787 Test Loss: 0.855 Test Acc: 0.787
Validation loss decreased (-0.779992 --> -0.786658).  Saving model ...
Epoch: 19 cost time: 5.829050540924072
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.787 Test Loss: 0.855 Test Acc: 0.787
Validation loss decreased (-0.786658 --> -0.786658).  Saving model ...
Epoch: 20 cost time: 5.881176948547363
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.790 Test Loss: 0.854 Test Acc: 0.790
Validation loss decreased (-0.786658 --> -0.789991).  Saving model ...
Epoch: 21 cost time: 5.8446691036224365
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.790 Test Loss: 0.856 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.7813732624053955
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.790 Test Loss: 0.858 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.029242515563965
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.790 Test Loss: 0.860 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.570296049118042
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.790 Test Loss: 0.862 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.7492897510528564
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.790 Test Loss: 0.863 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.707134246826172
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.790 Test Loss: 0.862 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.086785078048706
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.790 Test Loss: 0.863 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.915135383605957
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.790 Test Loss: 0.863 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.0414793491363525
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.790 Test Loss: 0.865 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.503443956375122
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.790 Test Loss: 0.868 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.79
model parameter : 13154329
model size : 69.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.658446311950684
Epoch: 1, Steps: 18 | Train Loss: 3.167 Vali Loss: 2.462 Vali Acc: 0.283 Test Loss: 2.462 Test Acc: 0.283
Validation loss decreased (inf --> -0.283309).  Saving model ...
Epoch: 2 cost time: 5.927765607833862
Epoch: 2, Steps: 18 | Train Loss: 1.117 Vali Loss: 1.758 Vali Acc: 0.480 Test Loss: 1.758 Test Acc: 0.480
Validation loss decreased (-0.283309 --> -0.479982).  Saving model ...
Epoch: 3 cost time: 5.968839883804321
Epoch: 3, Steps: 18 | Train Loss: 0.180 Vali Loss: 1.645 Vali Acc: 0.507 Test Loss: 1.645 Test Acc: 0.507
Validation loss decreased (-0.479982 --> -0.506650).  Saving model ...
Epoch: 4 cost time: 6.148588418960571
Epoch: 4, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.384 Vali Acc: 0.620 Test Loss: 1.384 Test Acc: 0.620
Validation loss decreased (-0.506650 --> -0.619986).  Saving model ...
Epoch: 5 cost time: 6.5993101596832275
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.214 Vali Acc: 0.647 Test Loss: 1.214 Test Acc: 0.647
Validation loss decreased (-0.619986 --> -0.646655).  Saving model ...
Epoch: 6 cost time: 6.2930004596710205
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.209 Vali Acc: 0.650 Test Loss: 1.209 Test Acc: 0.650
Validation loss decreased (-0.646655 --> -0.649988).  Saving model ...
Epoch: 7 cost time: 6.237322568893433
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.170 Vali Acc: 0.667 Test Loss: 1.170 Test Acc: 0.667
Validation loss decreased (-0.649988 --> -0.666655).  Saving model ...
Epoch: 8 cost time: 5.867055177688599
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.118 Vali Acc: 0.690 Test Loss: 1.118 Test Acc: 0.690
Validation loss decreased (-0.666655 --> -0.689989).  Saving model ...
Epoch: 9 cost time: 5.459911346435547
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.105 Vali Acc: 0.687 Test Loss: 1.105 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.583985328674316
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.102 Vali Acc: 0.673 Test Loss: 1.102 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.790072202682495
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.097 Vali Acc: 0.677 Test Loss: 1.097 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.05739951133728
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.099 Vali Acc: 0.673 Test Loss: 1.099 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.887653350830078
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.096 Vali Acc: 0.673 Test Loss: 1.096 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.137516260147095
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.095 Vali Acc: 0.673 Test Loss: 1.095 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.072460174560547
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.680 Test Loss: 1.090 Test Acc: 0.680
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.904213190078735
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.083 Vali Acc: 0.677 Test Loss: 1.083 Test Acc: 0.677
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.201465845108032
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.677 Test Loss: 1.081 Test Acc: 0.677
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.8650312423706055
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.085 Vali Acc: 0.680 Test Loss: 1.085 Test Acc: 0.680
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.69
model parameter : 13154329
model size : 69.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.169422626495361
Epoch: 1, Steps: 18 | Train Loss: 3.216 Vali Loss: 2.777 Vali Acc: 0.180 Test Loss: 2.777 Test Acc: 0.180
Validation loss decreased (inf --> -0.179972).  Saving model ...
Epoch: 2 cost time: 6.157012939453125
Epoch: 2, Steps: 18 | Train Loss: 1.440 Vali Loss: 2.417 Vali Acc: 0.293 Test Loss: 2.417 Test Acc: 0.293
Validation loss decreased (-0.179972 --> -0.293309).  Saving model ...
Epoch: 3 cost time: 5.74620795249939
Epoch: 3, Steps: 18 | Train Loss: 0.256 Vali Loss: 2.055 Vali Acc: 0.383 Test Loss: 2.055 Test Acc: 0.383
Validation loss decreased (-0.293309 --> -0.383313).  Saving model ...
Epoch: 4 cost time: 5.510834693908691
Epoch: 4, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.832 Vali Acc: 0.467 Test Loss: 1.832 Test Acc: 0.467
Validation loss decreased (-0.383313 --> -0.466648).  Saving model ...
Epoch: 5 cost time: 5.659026861190796
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.675 Vali Acc: 0.513 Test Loss: 1.675 Test Acc: 0.513
Validation loss decreased (-0.466648 --> -0.513317).  Saving model ...
Epoch: 6 cost time: 5.568238735198975
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.813 Vali Acc: 0.473 Test Loss: 1.813 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.7349114418029785
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.629 Vali Acc: 0.540 Test Loss: 1.629 Test Acc: 0.540
Validation loss decreased (-0.513317 --> -0.539984).  Saving model ...
Epoch: 8 cost time: 5.592210531234741
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.539 Vali Acc: 0.567 Test Loss: 1.539 Test Acc: 0.567
Validation loss decreased (-0.539984 --> -0.566651).  Saving model ...
Epoch: 9 cost time: 5.72151517868042
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.522 Vali Acc: 0.577 Test Loss: 1.522 Test Acc: 0.577
Validation loss decreased (-0.566651 --> -0.576651).  Saving model ...
Epoch: 10 cost time: 5.93706750869751
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.518 Vali Acc: 0.570 Test Loss: 1.518 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.585093975067139
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.580 Test Loss: 1.510 Test Acc: 0.580
Validation loss decreased (-0.576651 --> -0.579985).  Saving model ...
Epoch: 12 cost time: 6.160222291946411
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.502 Vali Acc: 0.580 Test Loss: 1.502 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 13 cost time: 5.952867269515991
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.580 Test Loss: 1.489 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 14 cost time: 6.115940093994141
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.580 Test Loss: 1.493 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.839092969894409
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.587 Test Loss: 1.485 Test Acc: 0.587
Validation loss decreased (-0.579985 --> -0.586652).  Saving model ...
Epoch: 16 cost time: 5.858137369155884
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.587 Test Loss: 1.473 Test Acc: 0.587
Validation loss decreased (-0.586652 --> -0.586652).  Saving model ...
Epoch: 17 cost time: 5.521780729293823
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.587 Test Loss: 1.469 Test Acc: 0.587
Validation loss decreased (-0.586652 --> -0.586652).  Saving model ...
Epoch: 18 cost time: 5.922922611236572
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.603 Test Loss: 1.471 Test Acc: 0.603
Validation loss decreased (-0.586652 --> -0.603319).  Saving model ...
Epoch: 19 cost time: 6.33002495765686
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.607 Test Loss: 1.461 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606652).  Saving model ...
Epoch: 20 cost time: 5.719978332519531
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.457 Vali Acc: 0.603 Test Loss: 1.457 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.623014688491821
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.603 Test Loss: 1.452 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.768673419952393
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.603 Test Loss: 1.447 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.203202962875366
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.610 Test Loss: 1.443 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 24 cost time: 5.556893587112427
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.607 Test Loss: 1.441 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.074415445327759
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.617 Test Loss: 1.437 Test Acc: 0.617
Validation loss decreased (-0.609986 --> -0.616652).  Saving model ...
Epoch: 26 cost time: 5.869880437850952
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.620 Test Loss: 1.435 Test Acc: 0.620
Validation loss decreased (-0.616652 --> -0.619986).  Saving model ...
Epoch: 27 cost time: 6.251016139984131
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.617 Test Loss: 1.434 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.134631633758545
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.613 Test Loss: 1.431 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.193733215332031
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.613 Test Loss: 1.432 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.631702184677124
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.613 Test Loss: 1.432 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.035830736160278
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.617 Test Loss: 1.432 Test Acc: 0.617
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.402429819107056
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.613 Test Loss: 1.428 Test Acc: 0.613
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 5.665203809738159
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.617 Test Loss: 1.426 Test Acc: 0.617
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.200297594070435
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.620 Test Loss: 1.422 Test Acc: 0.620
Validation loss decreased (-0.619986 --> -0.619986).  Saving model ...
Epoch: 35 cost time: 6.164816379547119
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.421 Vali Acc: 0.620 Test Loss: 1.421 Test Acc: 0.620
Validation loss decreased (-0.619986 --> -0.619986).  Saving model ...
Epoch: 36 cost time: 6.089263439178467
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.421 Vali Acc: 0.620 Test Loss: 1.421 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.473378658294678
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.623 Test Loss: 1.420 Test Acc: 0.623
Validation loss decreased (-0.619986 --> -0.623319).  Saving model ...
Epoch: 38 cost time: 6.143750905990601
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.620 Test Loss: 1.420 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.555246591567993
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.623 Test Loss: 1.418 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 40 cost time: 5.81043815612793
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.623 Test Loss: 1.416 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 41 cost time: 5.794721841812134
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.627 Test Loss: 1.414 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626653).  Saving model ...
Epoch: 42 cost time: 5.659156084060669
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.630 Test Loss: 1.413 Test Acc: 0.630
Validation loss decreased (-0.626653 --> -0.629986).  Saving model ...
Epoch: 43 cost time: 5.9511497020721436
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.633 Test Loss: 1.412 Test Acc: 0.633
Validation loss decreased (-0.629986 --> -0.633319).  Saving model ...
Epoch: 44 cost time: 5.97307014465332
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.633 Test Loss: 1.411 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 45 cost time: 5.815365791320801
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.633 Test Loss: 1.410 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 46 cost time: 5.642067909240723
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.630 Test Loss: 1.408 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.516255855560303
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.630 Test Loss: 1.408 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 6.16772198677063
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.637 Test Loss: 1.408 Test Acc: 0.637
Validation loss decreased (-0.633319 --> -0.636653).  Saving model ...
Epoch: 49 cost time: 5.881059408187866
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.640 Test Loss: 1.407 Test Acc: 0.640
Validation loss decreased (-0.636653 --> -0.639986).  Saving model ...
Epoch: 50 cost time: 5.89440655708313
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.640 Test Loss: 1.406 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 51 cost time: 5.978775262832642
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.637 Test Loss: 1.408 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.140891790390015
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.640 Test Loss: 1.408 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.263191223144531
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.640 Test Loss: 1.408 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 5.6696202754974365
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.637 Test Loss: 1.408 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 6.0297863483428955
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.637 Test Loss: 1.406 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 5.150277614593506
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.643 Test Loss: 1.403 Test Acc: 0.643
Validation loss decreased (-0.639986 --> -0.643319).  Saving model ...
Epoch: 57 cost time: 5.633548736572266
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.647 Test Loss: 1.399 Test Acc: 0.647
Validation loss decreased (-0.643319 --> -0.646653).  Saving model ...
Epoch: 58 cost time: 5.706782341003418
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.650 Test Loss: 1.397 Test Acc: 0.650
Validation loss decreased (-0.646653 --> -0.649986).  Saving model ...
Epoch: 59 cost time: 5.927789688110352
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.650 Test Loss: 1.398 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.998371362686157
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.653 Test Loss: 1.400 Test Acc: 0.653
Validation loss decreased (-0.649986 --> -0.653319).  Saving model ...
Epoch: 61 cost time: 5.823390483856201
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.650 Test Loss: 1.400 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.559194564819336
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.650 Test Loss: 1.399 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 6.0012733936309814
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.650 Test Loss: 1.398 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 5.66158127784729
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.653 Test Loss: 1.399 Test Acc: 0.653
Validation loss decreased (-0.653319 --> -0.653319).  Saving model ...
Epoch: 65 cost time: 5.846491098403931
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.653 Test Loss: 1.398 Test Acc: 0.653
Validation loss decreased (-0.653319 --> -0.653319).  Saving model ...
Epoch: 66 cost time: 6.611950874328613
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.653 Test Loss: 1.400 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 6.029375076293945
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.653 Test Loss: 1.399 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 6.247509241104126
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.653 Test Loss: 1.398 Test Acc: 0.653
Validation loss decreased (-0.653319 --> -0.653319).  Saving model ...
Epoch: 69 cost time: 6.449872732162476
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.653 Test Loss: 1.401 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 5.770470142364502
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.653 Test Loss: 1.401 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 5.683763742446899
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.402 Vali Acc: 0.653 Test Loss: 1.402 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 5.533587217330933
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.653 Test Loss: 1.401 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 5.676602363586426
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.653 Test Loss: 1.399 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 5.891510009765625
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.653 Test Loss: 1.400 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 5.637258052825928
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.653 Test Loss: 1.399 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 5.788287162780762
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.653 Test Loss: 1.397 Test Acc: 0.653
Validation loss decreased (-0.653319 --> -0.653319).  Saving model ...
Epoch: 77 cost time: 5.823060035705566
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.653 Test Loss: 1.399 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 6.187877178192139
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.653 Test Loss: 1.399 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 5.725200653076172
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.653 Test Loss: 1.399 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 5.530394077301025
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.657 Test Loss: 1.399 Test Acc: 0.657
Validation loss decreased (-0.653319 --> -0.656653).  Saving model ...
Epoch: 81 cost time: 6.014165163040161
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.663 Test Loss: 1.399 Test Acc: 0.663
Validation loss decreased (-0.656653 --> -0.663319).  Saving model ...
Epoch: 82 cost time: 5.774289846420288
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.663 Test Loss: 1.400 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 5.817752122879028
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.663 Test Loss: 1.400 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 5.567580223083496
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.663 Test Loss: 1.398 Test Acc: 0.663
Validation loss decreased (-0.663319 --> -0.663319).  Saving model ...
Epoch: 85 cost time: 5.961580038070679
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.660 Test Loss: 1.400 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 6.382615089416504
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.663 Test Loss: 1.400 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 5.527947187423706
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.667 Test Loss: 1.400 Test Acc: 0.667
Validation loss decreased (-0.663319 --> -0.666653).  Saving model ...
Epoch: 88 cost time: 5.574573755264282
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.670 Test Loss: 1.399 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.669986).  Saving model ...
Epoch: 89 cost time: 5.577884912490845
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.677 Test Loss: 1.399 Test Acc: 0.677
Validation loss decreased (-0.669986 --> -0.676653).  Saving model ...
Epoch: 90 cost time: 6.03530740737915
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.673 Test Loss: 1.399 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 5.5101306438446045
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.673 Test Loss: 1.399 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 5.8014490604400635
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.673 Test Loss: 1.400 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 5.82801365852356
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.677 Test Loss: 1.400 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 5.751723766326904
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.677 Test Loss: 1.400 Test Acc: 0.677
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 6.20964503288269
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.677 Test Loss: 1.399 Test Acc: 0.677
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 6.022536039352417
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.677 Test Loss: 1.400 Test Acc: 0.677
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 5.895256280899048
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.677 Test Loss: 1.400 Test Acc: 0.677
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 5.9230616092681885
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.677 Test Loss: 1.401 Test Acc: 0.677
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 5.888688325881958
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.677 Test Loss: 1.401 Test Acc: 0.677
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6766666666666666
model parameter : 13154329
model size : 69.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.655362367630005
Epoch: 1, Steps: 18 | Train Loss: 3.205 Vali Loss: 2.907 Vali Acc: 0.190 Test Loss: 2.907 Test Acc: 0.190
Validation loss decreased (inf --> -0.189971).  Saving model ...
Epoch: 2 cost time: 5.5855090618133545
Epoch: 2, Steps: 18 | Train Loss: 1.458 Vali Loss: 2.626 Vali Acc: 0.207 Test Loss: 2.626 Test Acc: 0.207
Validation loss decreased (-0.189971 --> -0.206640).  Saving model ...
Epoch: 3 cost time: 5.433557510375977
Epoch: 3, Steps: 18 | Train Loss: 0.231 Vali Loss: 2.347 Vali Acc: 0.360 Test Loss: 2.347 Test Acc: 0.360
Validation loss decreased (-0.206640 --> -0.359977).  Saving model ...
Epoch: 4 cost time: 5.620054483413696
Epoch: 4, Steps: 18 | Train Loss: 0.030 Vali Loss: 2.466 Vali Acc: 0.337 Test Loss: 2.466 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.196309566497803
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.059 Vali Acc: 0.437 Test Loss: 2.059 Test Acc: 0.437
Validation loss decreased (-0.359977 --> -0.436646).  Saving model ...
Epoch: 6 cost time: 5.575329303741455
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.142 Vali Acc: 0.427 Test Loss: 2.142 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.386602878570557
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.990 Vali Acc: 0.477 Test Loss: 1.990 Test Acc: 0.477
Validation loss decreased (-0.436646 --> -0.476647).  Saving model ...
Epoch: 8 cost time: 5.591002464294434
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.969 Vali Acc: 0.497 Test Loss: 1.969 Test Acc: 0.497
Validation loss decreased (-0.476647 --> -0.496647).  Saving model ...
Epoch: 9 cost time: 5.783890008926392
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.934 Vali Acc: 0.510 Test Loss: 1.934 Test Acc: 0.510
Validation loss decreased (-0.496647 --> -0.509981).  Saving model ...
Epoch: 10 cost time: 6.291200399398804
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.906 Vali Acc: 0.523 Test Loss: 1.906 Test Acc: 0.523
Validation loss decreased (-0.509981 --> -0.523314).  Saving model ...
Epoch: 11 cost time: 5.8533830642700195
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.888 Vali Acc: 0.517 Test Loss: 1.888 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.821762323379517
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.874 Vali Acc: 0.537 Test Loss: 1.874 Test Acc: 0.537
Validation loss decreased (-0.523314 --> -0.536648).  Saving model ...
Epoch: 13 cost time: 5.6302878856658936
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.852 Vali Acc: 0.537 Test Loss: 1.852 Test Acc: 0.537
Validation loss decreased (-0.536648 --> -0.536648).  Saving model ...
Epoch: 14 cost time: 5.360504150390625
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.849 Vali Acc: 0.543 Test Loss: 1.849 Test Acc: 0.543
Validation loss decreased (-0.536648 --> -0.543315).  Saving model ...
Epoch: 15 cost time: 5.92436957359314
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.838 Vali Acc: 0.557 Test Loss: 1.838 Test Acc: 0.557
Validation loss decreased (-0.543315 --> -0.556648).  Saving model ...
Epoch: 16 cost time: 5.84822154045105
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.570 Test Loss: 1.825 Test Acc: 0.570
Validation loss decreased (-0.556648 --> -0.569982).  Saving model ...
Epoch: 17 cost time: 5.820946455001831
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.560 Test Loss: 1.815 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.033818960189819
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.804 Vali Acc: 0.560 Test Loss: 1.804 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.044372320175171
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.792 Vali Acc: 0.557 Test Loss: 1.792 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.216747283935547
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.787 Vali Acc: 0.567 Test Loss: 1.787 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.195690631866455
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.567 Test Loss: 1.782 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.132381439208984
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.771 Vali Acc: 0.573 Test Loss: 1.771 Test Acc: 0.573
Validation loss decreased (-0.569982 --> -0.573316).  Saving model ...
Epoch: 23 cost time: 5.604275941848755
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.761 Vali Acc: 0.577 Test Loss: 1.761 Test Acc: 0.577
Validation loss decreased (-0.573316 --> -0.576649).  Saving model ...
Epoch: 24 cost time: 5.891718626022339
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.580 Test Loss: 1.756 Test Acc: 0.580
Validation loss decreased (-0.576649 --> -0.579982).  Saving model ...
Epoch: 25 cost time: 5.696491241455078
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.751 Vali Acc: 0.580 Test Loss: 1.751 Test Acc: 0.580
Validation loss decreased (-0.579982 --> -0.579982).  Saving model ...
Epoch: 26 cost time: 6.014869213104248
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.743 Vali Acc: 0.580 Test Loss: 1.743 Test Acc: 0.580
Validation loss decreased (-0.579982 --> -0.579983).  Saving model ...
Epoch: 27 cost time: 5.545347452163696
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.736 Vali Acc: 0.580 Test Loss: 1.736 Test Acc: 0.580
Validation loss decreased (-0.579983 --> -0.579983).  Saving model ...
Epoch: 28 cost time: 6.004176616668701
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.580 Test Loss: 1.727 Test Acc: 0.580
Validation loss decreased (-0.579983 --> -0.579983).  Saving model ...
Epoch: 29 cost time: 5.8139307498931885
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.726 Vali Acc: 0.583 Test Loss: 1.726 Test Acc: 0.583
Validation loss decreased (-0.579983 --> -0.583316).  Saving model ...
Epoch: 30 cost time: 5.664366006851196
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.723 Vali Acc: 0.587 Test Loss: 1.723 Test Acc: 0.587
Validation loss decreased (-0.583316 --> -0.586649).  Saving model ...
Epoch: 31 cost time: 5.599487066268921
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.587 Test Loss: 1.717 Test Acc: 0.587
Validation loss decreased (-0.586649 --> -0.586650).  Saving model ...
Epoch: 32 cost time: 5.753761529922485
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.711 Vali Acc: 0.583 Test Loss: 1.711 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.779187917709351
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.707 Vali Acc: 0.580 Test Loss: 1.707 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.661945343017578
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.587 Test Loss: 1.706 Test Acc: 0.587
Validation loss decreased (-0.586650 --> -0.586650).  Saving model ...
Epoch: 35 cost time: 5.940365314483643
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.587 Test Loss: 1.700 Test Acc: 0.587
Validation loss decreased (-0.586650 --> -0.586650).  Saving model ...
Epoch: 36 cost time: 5.893455743789673
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.698 Vali Acc: 0.590 Test Loss: 1.698 Test Acc: 0.590
Validation loss decreased (-0.586650 --> -0.589983).  Saving model ...
Epoch: 37 cost time: 6.065626859664917
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.693 Vali Acc: 0.590 Test Loss: 1.693 Test Acc: 0.590
Validation loss decreased (-0.589983 --> -0.589983).  Saving model ...
Epoch: 38 cost time: 5.482028484344482
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.687 Vali Acc: 0.600 Test Loss: 1.687 Test Acc: 0.600
Validation loss decreased (-0.589983 --> -0.599983).  Saving model ...
Epoch: 39 cost time: 5.460683107376099
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.603 Test Loss: 1.685 Test Acc: 0.603
Validation loss decreased (-0.599983 --> -0.603316).  Saving model ...
Epoch: 40 cost time: 5.524428367614746
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.686 Vali Acc: 0.600 Test Loss: 1.686 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.674766540527344
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.683 Vali Acc: 0.607 Test Loss: 1.683 Test Acc: 0.607
Validation loss decreased (-0.603316 --> -0.606650).  Saving model ...
Epoch: 42 cost time: 5.571290731430054
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.679 Vali Acc: 0.607 Test Loss: 1.679 Test Acc: 0.607
Validation loss decreased (-0.606650 --> -0.606650).  Saving model ...
Epoch: 43 cost time: 5.357824087142944
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.675 Vali Acc: 0.607 Test Loss: 1.675 Test Acc: 0.607
Validation loss decreased (-0.606650 --> -0.606650).  Saving model ...
Epoch: 44 cost time: 5.61662745475769
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.671 Vali Acc: 0.603 Test Loss: 1.671 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.495831251144409
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.607 Test Loss: 1.669 Test Acc: 0.607
Validation loss decreased (-0.606650 --> -0.606650).  Saving model ...
Epoch: 46 cost time: 5.572657108306885
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.666 Vali Acc: 0.607 Test Loss: 1.666 Test Acc: 0.607
Validation loss decreased (-0.606650 --> -0.606650).  Saving model ...
Epoch: 47 cost time: 5.580087423324585
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.663 Vali Acc: 0.607 Test Loss: 1.663 Test Acc: 0.607
Validation loss decreased (-0.606650 --> -0.606650).  Saving model ...
Epoch: 48 cost time: 5.70021653175354
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.658 Vali Acc: 0.610 Test Loss: 1.658 Test Acc: 0.610
Validation loss decreased (-0.606650 --> -0.609983).  Saving model ...
Epoch: 49 cost time: 5.294903039932251
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.656 Vali Acc: 0.610 Test Loss: 1.656 Test Acc: 0.610
Validation loss decreased (-0.609983 --> -0.609983).  Saving model ...
Epoch: 50 cost time: 5.42294979095459
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.657 Vali Acc: 0.613 Test Loss: 1.657 Test Acc: 0.613
Validation loss decreased (-0.609983 --> -0.613317).  Saving model ...
Epoch: 51 cost time: 5.415823698043823
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.655 Vali Acc: 0.610 Test Loss: 1.655 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.1446213722229
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.656 Vali Acc: 0.610 Test Loss: 1.656 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 5.169598817825317
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.651 Vali Acc: 0.613 Test Loss: 1.651 Test Acc: 0.613
Validation loss decreased (-0.613317 --> -0.613317).  Saving model ...
Epoch: 54 cost time: 5.435858726501465
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.650 Vali Acc: 0.613 Test Loss: 1.650 Test Acc: 0.613
Validation loss decreased (-0.613317 --> -0.613317).  Saving model ...
Epoch: 55 cost time: 5.407666444778442
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.649 Vali Acc: 0.617 Test Loss: 1.649 Test Acc: 0.617
Validation loss decreased (-0.613317 --> -0.616650).  Saving model ...
Epoch: 56 cost time: 5.472917556762695
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.646 Vali Acc: 0.617 Test Loss: 1.646 Test Acc: 0.617
Validation loss decreased (-0.616650 --> -0.616650).  Saving model ...
Epoch: 57 cost time: 5.713773488998413
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.623 Test Loss: 1.643 Test Acc: 0.623
Validation loss decreased (-0.616650 --> -0.623317).  Saving model ...
Epoch: 58 cost time: 5.479626893997192
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.627 Test Loss: 1.640 Test Acc: 0.627
Validation loss decreased (-0.623317 --> -0.626650).  Saving model ...
Epoch: 59 cost time: 5.589552640914917
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.638 Vali Acc: 0.627 Test Loss: 1.638 Test Acc: 0.627
Validation loss decreased (-0.626650 --> -0.626650).  Saving model ...
Epoch: 60 cost time: 5.415325164794922
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.630 Test Loss: 1.637 Test Acc: 0.630
Validation loss decreased (-0.626650 --> -0.629984).  Saving model ...
Epoch: 61 cost time: 5.197742700576782
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.635 Vali Acc: 0.627 Test Loss: 1.635 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 5.692814826965332
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.634 Vali Acc: 0.630 Test Loss: 1.634 Test Acc: 0.630
Validation loss decreased (-0.629984 --> -0.629984).  Saving model ...
Epoch: 63 cost time: 5.514912843704224
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.633 Test Loss: 1.633 Test Acc: 0.633
Validation loss decreased (-0.629984 --> -0.633317).  Saving model ...
Epoch: 64 cost time: 5.624210357666016
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.633 Test Loss: 1.630 Test Acc: 0.633
Validation loss decreased (-0.633317 --> -0.633317).  Saving model ...
Epoch: 65 cost time: 5.5039496421813965
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.633 Test Loss: 1.628 Test Acc: 0.633
Validation loss decreased (-0.633317 --> -0.633317).  Saving model ...
Epoch: 66 cost time: 5.111049652099609
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.633 Test Loss: 1.628 Test Acc: 0.633
Validation loss decreased (-0.633317 --> -0.633317).  Saving model ...
Epoch: 67 cost time: 5.045542478561401
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.633 Test Loss: 1.625 Test Acc: 0.633
Validation loss decreased (-0.633317 --> -0.633317).  Saving model ...
Epoch: 68 cost time: 5.1775782108306885
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.633 Test Loss: 1.625 Test Acc: 0.633
Validation loss decreased (-0.633317 --> -0.633317).  Saving model ...
Epoch: 69 cost time: 5.094686508178711
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.630 Test Loss: 1.626 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 5.122779846191406
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.633 Test Loss: 1.625 Test Acc: 0.633
Validation loss decreased (-0.633317 --> -0.633317).  Saving model ...
Epoch: 71 cost time: 6.171019792556763
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.633 Test Loss: 1.626 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.727892875671387
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.633 Test Loss: 1.625 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.058028697967529
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.633 Test Loss: 1.620 Test Acc: 0.633
Validation loss decreased (-0.633317 --> -0.633317).  Saving model ...
Epoch: 74 cost time: 5.5021772384643555
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.637 Test Loss: 1.616 Test Acc: 0.637
Validation loss decreased (-0.633317 --> -0.636651).  Saving model ...
Epoch: 75 cost time: 5.651934862136841
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.640 Test Loss: 1.617 Test Acc: 0.640
Validation loss decreased (-0.636651 --> -0.639984).  Saving model ...
Epoch: 76 cost time: 5.6217241287231445
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.643 Test Loss: 1.618 Test Acc: 0.643
Validation loss decreased (-0.639984 --> -0.643317).  Saving model ...
Epoch: 77 cost time: 5.990501165390015
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.643 Test Loss: 1.618 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 6.193776369094849
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.643 Test Loss: 1.616 Test Acc: 0.643
Validation loss decreased (-0.643317 --> -0.643317).  Saving model ...
Epoch: 79 cost time: 5.709705591201782
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.643 Test Loss: 1.614 Test Acc: 0.643
Validation loss decreased (-0.643317 --> -0.643317).  Saving model ...
Epoch: 80 cost time: 5.761488914489746
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.643 Test Loss: 1.612 Test Acc: 0.643
Validation loss decreased (-0.643317 --> -0.643317).  Saving model ...
Epoch: 81 cost time: 5.827119588851929
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.647 Test Loss: 1.610 Test Acc: 0.647
Validation loss decreased (-0.643317 --> -0.646651).  Saving model ...
Epoch: 82 cost time: 5.800411224365234
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.647 Test Loss: 1.609 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 83 cost time: 5.694324016571045
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.647 Test Loss: 1.608 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 84 cost time: 5.528333902359009
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.643 Test Loss: 1.606 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 5.489333868026733
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.643 Test Loss: 1.607 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 5.945574998855591
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.643 Test Loss: 1.607 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 6.078672647476196
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.647 Test Loss: 1.605 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 88 cost time: 5.943232297897339
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.647 Test Loss: 1.602 Test Acc: 0.647
Validation loss decreased (-0.646651 --> -0.646651).  Saving model ...
Epoch: 89 cost time: 5.766376256942749
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.650 Test Loss: 1.602 Test Acc: 0.650
Validation loss decreased (-0.646651 --> -0.649984).  Saving model ...
Epoch: 90 cost time: 5.79863166809082
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.653 Test Loss: 1.602 Test Acc: 0.653
Validation loss decreased (-0.649984 --> -0.653317).  Saving model ...
Epoch: 91 cost time: 5.630190134048462
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.657 Test Loss: 1.602 Test Acc: 0.657
Validation loss decreased (-0.653317 --> -0.656651).  Saving model ...
Epoch: 92 cost time: 5.924982786178589
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.657 Test Loss: 1.602 Test Acc: 0.657
Validation loss decreased (-0.656651 --> -0.656651).  Saving model ...
Epoch: 93 cost time: 5.585000514984131
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.657 Test Loss: 1.602 Test Acc: 0.657
Validation loss decreased (-0.656651 --> -0.656651).  Saving model ...
Epoch: 94 cost time: 5.674795627593994
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.657 Test Loss: 1.602 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 5.437504529953003
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.657 Test Loss: 1.601 Test Acc: 0.657
Validation loss decreased (-0.656651 --> -0.656651).  Saving model ...
Epoch: 96 cost time: 5.736055850982666
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.600 Vali Acc: 0.657 Test Loss: 1.600 Test Acc: 0.657
Validation loss decreased (-0.656651 --> -0.656651).  Saving model ...
Epoch: 97 cost time: 5.594419479370117
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.657 Test Loss: 1.602 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 5.430744409561157
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.657 Test Loss: 1.601 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 5.715858697891235
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.598 Vali Acc: 0.660 Test Loss: 1.598 Test Acc: 0.660
Validation loss decreased (-0.656651 --> -0.659984).  Saving model ...
Epoch: 100 cost time: 5.907747983932495
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.598 Vali Acc: 0.657 Test Loss: 1.598 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.66
model parameter : 13154329
model size : 69.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.1316609382629395
Epoch: 1, Steps: 18 | Train Loss: 3.198 Vali Loss: 3.094 Vali Acc: 0.090 Test Loss: 3.094 Test Acc: 0.090
Validation loss decreased (inf --> -0.089969).  Saving model ...
Epoch: 2 cost time: 5.681040287017822
Epoch: 2, Steps: 18 | Train Loss: 1.531 Vali Loss: 2.948 Vali Acc: 0.160 Test Loss: 2.948 Test Acc: 0.160
Validation loss decreased (-0.089969 --> -0.159971).  Saving model ...
Epoch: 3 cost time: 6.064358234405518
Epoch: 3, Steps: 18 | Train Loss: 0.278 Vali Loss: 2.663 Vali Acc: 0.243 Test Loss: 2.663 Test Acc: 0.243
Validation loss decreased (-0.159971 --> -0.243307).  Saving model ...
Epoch: 4 cost time: 5.732627630233765
Epoch: 4, Steps: 18 | Train Loss: 0.028 Vali Loss: 2.885 Vali Acc: 0.283 Test Loss: 2.885 Test Acc: 0.283
Validation loss decreased (-0.243307 --> -0.283304).  Saving model ...
Epoch: 5 cost time: 5.5919508934021
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.556 Vali Acc: 0.313 Test Loss: 2.556 Test Acc: 0.313
Validation loss decreased (-0.283304 --> -0.313308).  Saving model ...
Epoch: 6 cost time: 5.306394100189209
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.524 Vali Acc: 0.317 Test Loss: 2.524 Test Acc: 0.317
Validation loss decreased (-0.313308 --> -0.316641).  Saving model ...
Epoch: 7 cost time: 5.570066213607788
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.420 Vali Acc: 0.350 Test Loss: 2.420 Test Acc: 0.350
Validation loss decreased (-0.316641 --> -0.349976).  Saving model ...
Epoch: 8 cost time: 5.514409303665161
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.382 Vali Acc: 0.347 Test Loss: 2.382 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.196749448776245
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.289 Vali Acc: 0.380 Test Loss: 2.289 Test Acc: 0.380
Validation loss decreased (-0.349976 --> -0.379977).  Saving model ...
Epoch: 10 cost time: 5.719475746154785
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.237 Vali Acc: 0.387 Test Loss: 2.237 Test Acc: 0.387
Validation loss decreased (-0.379977 --> -0.386644).  Saving model ...
Epoch: 11 cost time: 5.741442918777466
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.208 Vali Acc: 0.390 Test Loss: 2.208 Test Acc: 0.390
Validation loss decreased (-0.386644 --> -0.389978).  Saving model ...
Epoch: 12 cost time: 5.93286919593811
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.183 Vali Acc: 0.400 Test Loss: 2.183 Test Acc: 0.400
Validation loss decreased (-0.389978 --> -0.399978).  Saving model ...
Epoch: 13 cost time: 6.145199537277222
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.143 Vali Acc: 0.427 Test Loss: 2.143 Test Acc: 0.427
Validation loss decreased (-0.399978 --> -0.426645).  Saving model ...
Epoch: 14 cost time: 5.845909357070923
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.119 Vali Acc: 0.437 Test Loss: 2.119 Test Acc: 0.437
Validation loss decreased (-0.426645 --> -0.436645).  Saving model ...
Epoch: 15 cost time: 5.704218149185181
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.098 Vali Acc: 0.437 Test Loss: 2.098 Test Acc: 0.437
Validation loss decreased (-0.436645 --> -0.436646).  Saving model ...
Epoch: 16 cost time: 5.718827247619629
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.085 Vali Acc: 0.440 Test Loss: 2.085 Test Acc: 0.440
Validation loss decreased (-0.436646 --> -0.439979).  Saving model ...
Epoch: 17 cost time: 5.894347667694092
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.064 Vali Acc: 0.447 Test Loss: 2.064 Test Acc: 0.447
Validation loss decreased (-0.439979 --> -0.446646).  Saving model ...
Epoch: 18 cost time: 5.752722263336182
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.047 Vali Acc: 0.463 Test Loss: 2.047 Test Acc: 0.463
Validation loss decreased (-0.446646 --> -0.463313).  Saving model ...
Epoch: 19 cost time: 6.077680349349976
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.026 Vali Acc: 0.477 Test Loss: 2.026 Test Acc: 0.477
Validation loss decreased (-0.463313 --> -0.476646).  Saving model ...
Epoch: 20 cost time: 5.592090129852295
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.005 Vali Acc: 0.473 Test Loss: 2.005 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.581878662109375
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.996 Vali Acc: 0.477 Test Loss: 1.996 Test Acc: 0.477
Validation loss decreased (-0.476646 --> -0.476647).  Saving model ...
Epoch: 22 cost time: 5.498432159423828
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.988 Vali Acc: 0.483 Test Loss: 1.988 Test Acc: 0.483
Validation loss decreased (-0.476647 --> -0.483313).  Saving model ...
Epoch: 23 cost time: 5.0921103954315186
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.974 Vali Acc: 0.490 Test Loss: 1.974 Test Acc: 0.490
Validation loss decreased (-0.483313 --> -0.489980).  Saving model ...
Epoch: 24 cost time: 5.242496490478516
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.965 Vali Acc: 0.497 Test Loss: 1.965 Test Acc: 0.497
Validation loss decreased (-0.489980 --> -0.496647).  Saving model ...
Epoch: 25 cost time: 5.577065944671631
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.947 Vali Acc: 0.500 Test Loss: 1.947 Test Acc: 0.500
Validation loss decreased (-0.496647 --> -0.499981).  Saving model ...
Epoch: 26 cost time: 6.214684724807739
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.940 Vali Acc: 0.513 Test Loss: 1.940 Test Acc: 0.513
Validation loss decreased (-0.499981 --> -0.513314).  Saving model ...
Epoch: 27 cost time: 5.85918116569519
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.929 Vali Acc: 0.513 Test Loss: 1.929 Test Acc: 0.513
Validation loss decreased (-0.513314 --> -0.513314).  Saving model ...
Epoch: 28 cost time: 6.020720720291138
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.915 Vali Acc: 0.513 Test Loss: 1.915 Test Acc: 0.513
Validation loss decreased (-0.513314 --> -0.513314).  Saving model ...
Epoch: 29 cost time: 5.569680213928223
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.909 Vali Acc: 0.520 Test Loss: 1.909 Test Acc: 0.520
Validation loss decreased (-0.513314 --> -0.519981).  Saving model ...
Epoch: 30 cost time: 6.083888292312622
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.890 Vali Acc: 0.530 Test Loss: 1.890 Test Acc: 0.530
Validation loss decreased (-0.519981 --> -0.529981).  Saving model ...
Epoch: 31 cost time: 6.145331382751465
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.884 Vali Acc: 0.530 Test Loss: 1.884 Test Acc: 0.530
Validation loss decreased (-0.529981 --> -0.529981).  Saving model ...
Epoch: 32 cost time: 5.602811098098755
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.875 Vali Acc: 0.530 Test Loss: 1.875 Test Acc: 0.530
Validation loss decreased (-0.529981 --> -0.529981).  Saving model ...
Epoch: 33 cost time: 5.890580415725708
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.865 Vali Acc: 0.537 Test Loss: 1.865 Test Acc: 0.537
Validation loss decreased (-0.529981 --> -0.536648).  Saving model ...
Epoch: 34 cost time: 6.183964729309082
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.864 Vali Acc: 0.530 Test Loss: 1.864 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.402305603027344
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.856 Vali Acc: 0.533 Test Loss: 1.856 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 6.551957130432129
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.849 Vali Acc: 0.550 Test Loss: 1.849 Test Acc: 0.550
Validation loss decreased (-0.536648 --> -0.549982).  Saving model ...
Epoch: 37 cost time: 5.291247367858887
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.830 Vali Acc: 0.557 Test Loss: 1.830 Test Acc: 0.557
Validation loss decreased (-0.549982 --> -0.556648).  Saving model ...
Epoch: 38 cost time: 5.712236642837524
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.830 Vali Acc: 0.550 Test Loss: 1.830 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.190032958984375
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.553 Test Loss: 1.822 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 5.568880796432495
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.821 Vali Acc: 0.553 Test Loss: 1.821 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 5.398658990859985
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.817 Vali Acc: 0.557 Test Loss: 1.817 Test Acc: 0.557
Validation loss decreased (-0.556648 --> -0.556648).  Saving model ...
Epoch: 42 cost time: 5.893933296203613
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.810 Vali Acc: 0.557 Test Loss: 1.810 Test Acc: 0.557
Validation loss decreased (-0.556648 --> -0.556649).  Saving model ...
Epoch: 43 cost time: 5.6968653202056885
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.800 Vali Acc: 0.557 Test Loss: 1.800 Test Acc: 0.557
Validation loss decreased (-0.556649 --> -0.556649).  Saving model ...
Epoch: 44 cost time: 6.697646379470825
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.553 Test Loss: 1.794 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 6.331418991088867
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.788 Vali Acc: 0.563 Test Loss: 1.788 Test Acc: 0.563
Validation loss decreased (-0.556649 --> -0.563315).  Saving model ...
Epoch: 46 cost time: 5.712255954742432
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.785 Vali Acc: 0.563 Test Loss: 1.785 Test Acc: 0.563
Validation loss decreased (-0.563315 --> -0.563315).  Saving model ...
Epoch: 47 cost time: 5.668779373168945
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.781 Vali Acc: 0.563 Test Loss: 1.781 Test Acc: 0.563
Validation loss decreased (-0.563315 --> -0.563316).  Saving model ...
Epoch: 48 cost time: 5.7654783725738525
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.778 Vali Acc: 0.573 Test Loss: 1.778 Test Acc: 0.573
Validation loss decreased (-0.563316 --> -0.573316).  Saving model ...
Epoch: 49 cost time: 5.640189170837402
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.771 Vali Acc: 0.570 Test Loss: 1.771 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.850376129150391
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.773 Vali Acc: 0.570 Test Loss: 1.773 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 6.357506513595581
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.766 Vali Acc: 0.587 Test Loss: 1.766 Test Acc: 0.587
Validation loss decreased (-0.573316 --> -0.586649).  Saving model ...
Epoch: 52 cost time: 5.535001516342163
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.764 Vali Acc: 0.590 Test Loss: 1.764 Test Acc: 0.590
Validation loss decreased (-0.586649 --> -0.589982).  Saving model ...
Epoch: 53 cost time: 5.221821069717407
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.757 Vali Acc: 0.590 Test Loss: 1.757 Test Acc: 0.590
Validation loss decreased (-0.589982 --> -0.589982).  Saving model ...
Epoch: 54 cost time: 5.567561388015747
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.755 Vali Acc: 0.587 Test Loss: 1.755 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.553026437759399
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.752 Vali Acc: 0.590 Test Loss: 1.752 Test Acc: 0.590
Validation loss decreased (-0.589982 --> -0.589982).  Saving model ...
Epoch: 56 cost time: 5.4714744091033936
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.747 Vali Acc: 0.593 Test Loss: 1.747 Test Acc: 0.593
Validation loss decreased (-0.589982 --> -0.593316).  Saving model ...
Epoch: 57 cost time: 5.962920427322388
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.587 Test Loss: 1.742 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.117204904556274
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.736 Vali Acc: 0.590 Test Loss: 1.736 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 6.06064510345459
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.733 Vali Acc: 0.587 Test Loss: 1.733 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 6.349437475204468
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.728 Vali Acc: 0.590 Test Loss: 1.728 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 5.86141037940979
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.726 Vali Acc: 0.593 Test Loss: 1.726 Test Acc: 0.593
Validation loss decreased (-0.593316 --> -0.593316).  Saving model ...
Epoch: 62 cost time: 5.70487642288208
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.600 Test Loss: 1.725 Test Acc: 0.600
Validation loss decreased (-0.593316 --> -0.599983).  Saving model ...
Epoch: 63 cost time: 5.697234153747559
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.600 Test Loss: 1.721 Test Acc: 0.600
Validation loss decreased (-0.599983 --> -0.599983).  Saving model ...
Epoch: 64 cost time: 6.081018447875977
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.718 Vali Acc: 0.607 Test Loss: 1.718 Test Acc: 0.607
Validation loss decreased (-0.599983 --> -0.606649).  Saving model ...
Epoch: 65 cost time: 5.69824481010437
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.603 Test Loss: 1.715 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.497499227523804
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.713 Vali Acc: 0.603 Test Loss: 1.713 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 5.691633939743042
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.712 Vali Acc: 0.610 Test Loss: 1.712 Test Acc: 0.610
Validation loss decreased (-0.606649 --> -0.609983).  Saving model ...
Epoch: 68 cost time: 6.354372978210449
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.711 Vali Acc: 0.613 Test Loss: 1.711 Test Acc: 0.613
Validation loss decreased (-0.609983 --> -0.613316).  Saving model ...
Epoch: 69 cost time: 5.6213648319244385
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.707 Vali Acc: 0.613 Test Loss: 1.707 Test Acc: 0.613
Validation loss decreased (-0.613316 --> -0.613316).  Saving model ...
Epoch: 70 cost time: 5.39980411529541
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.610 Test Loss: 1.704 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 5.511310577392578
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.702 Vali Acc: 0.603 Test Loss: 1.702 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 5.84162163734436
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.702 Vali Acc: 0.607 Test Loss: 1.702 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 5.893169641494751
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.613 Test Loss: 1.700 Test Acc: 0.613
Validation loss decreased (-0.613316 --> -0.613316).  Saving model ...
Epoch: 74 cost time: 5.875859498977661
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.610 Test Loss: 1.697 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 5.973341226577759
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.617 Test Loss: 1.697 Test Acc: 0.617
Validation loss decreased (-0.613316 --> -0.616650).  Saving model ...
Epoch: 76 cost time: 5.830749750137329
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.694 Vali Acc: 0.620 Test Loss: 1.694 Test Acc: 0.620
Validation loss decreased (-0.616650 --> -0.619983).  Saving model ...
Epoch: 77 cost time: 5.634605646133423
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.690 Vali Acc: 0.617 Test Loss: 1.690 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.313333034515381
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.687 Vali Acc: 0.617 Test Loss: 1.687 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 5.51121711730957
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.688 Vali Acc: 0.620 Test Loss: 1.688 Test Acc: 0.620
Validation loss decreased (-0.619983 --> -0.619983).  Saving model ...
Epoch: 80 cost time: 5.364037036895752
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.686 Vali Acc: 0.623 Test Loss: 1.686 Test Acc: 0.623
Validation loss decreased (-0.619983 --> -0.623316).  Saving model ...
Epoch: 81 cost time: 5.7590172290802
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.684 Vali Acc: 0.623 Test Loss: 1.684 Test Acc: 0.623
Validation loss decreased (-0.623316 --> -0.623316).  Saving model ...
Epoch: 82 cost time: 5.630234241485596
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.684 Vali Acc: 0.623 Test Loss: 1.684 Test Acc: 0.623
Validation loss decreased (-0.623316 --> -0.623316).  Saving model ...
Epoch: 83 cost time: 5.587170362472534
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.684 Vali Acc: 0.620 Test Loss: 1.684 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 5.849545478820801
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.683 Vali Acc: 0.623 Test Loss: 1.683 Test Acc: 0.623
Validation loss decreased (-0.623316 --> -0.623317).  Saving model ...
Epoch: 85 cost time: 6.07933235168457
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.681 Vali Acc: 0.620 Test Loss: 1.681 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 5.740719795227051
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.680 Vali Acc: 0.620 Test Loss: 1.680 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 5.590489864349365
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.678 Vali Acc: 0.613 Test Loss: 1.678 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 5.682879447937012
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.675 Vali Acc: 0.617 Test Loss: 1.675 Test Acc: 0.617
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 5.408908367156982
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.672 Vali Acc: 0.617 Test Loss: 1.672 Test Acc: 0.617
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 5.5836052894592285
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.670 Vali Acc: 0.613 Test Loss: 1.670 Test Acc: 0.613
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 5.768418550491333
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.670 Vali Acc: 0.613 Test Loss: 1.670 Test Acc: 0.613
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 5.740358591079712
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.668 Vali Acc: 0.613 Test Loss: 1.668 Test Acc: 0.613
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 6.022963285446167
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.667 Vali Acc: 0.617 Test Loss: 1.667 Test Acc: 0.617
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 5.840362787246704
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.666 Vali Acc: 0.623 Test Loss: 1.666 Test Acc: 0.623
Validation loss decreased (-0.623317 --> -0.623317).  Saving model ...
Epoch: 95 cost time: 5.598577499389648
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.666 Vali Acc: 0.627 Test Loss: 1.666 Test Acc: 0.627
Validation loss decreased (-0.623317 --> -0.626650).  Saving model ...
Epoch: 96 cost time: 5.341893196105957
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.665 Vali Acc: 0.623 Test Loss: 1.665 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 5.306182384490967
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.664 Vali Acc: 0.630 Test Loss: 1.664 Test Acc: 0.630
Validation loss decreased (-0.626650 --> -0.629983).  Saving model ...
Epoch: 98 cost time: 5.351762533187866
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.663 Vali Acc: 0.633 Test Loss: 1.663 Test Acc: 0.633
Validation loss decreased (-0.629983 --> -0.633317).  Saving model ...
Epoch: 99 cost time: 5.890099763870239
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.662 Vali Acc: 0.633 Test Loss: 1.662 Test Acc: 0.633
Validation loss decreased (-0.633317 --> -0.633317).  Saving model ...
Epoch: 100 cost time: 5.889128684997559
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.660 Vali Acc: 0.637 Test Loss: 1.660 Test Acc: 0.637
Validation loss decreased (-0.633317 --> -0.636650).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6366666666666667
model parameter : 13154329
model size : 69.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.204100608825684
Epoch: 1, Steps: 18 | Train Loss: 3.208 Vali Loss: 3.094 Vali Acc: 0.080 Test Loss: 3.094 Test Acc: 0.080
Validation loss decreased (inf --> -0.079969).  Saving model ...
Epoch: 2 cost time: 5.536581516265869
Epoch: 2, Steps: 18 | Train Loss: 1.734 Vali Loss: 2.735 Vali Acc: 0.197 Test Loss: 2.735 Test Acc: 0.197
Validation loss decreased (-0.079969 --> -0.196639).  Saving model ...
Epoch: 3 cost time: 5.721800804138184
Epoch: 3, Steps: 18 | Train Loss: 0.387 Vali Loss: 2.534 Vali Acc: 0.257 Test Loss: 2.534 Test Acc: 0.257
Validation loss decreased (-0.196639 --> -0.256641).  Saving model ...
Epoch: 4 cost time: 5.492677211761475
Epoch: 4, Steps: 18 | Train Loss: 0.053 Vali Loss: 2.646 Vali Acc: 0.317 Test Loss: 2.646 Test Acc: 0.317
Validation loss decreased (-0.256641 --> -0.316640).  Saving model ...
Epoch: 5 cost time: 5.969106912612915
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.202 Vali Acc: 0.353 Test Loss: 2.202 Test Acc: 0.353
Validation loss decreased (-0.316640 --> -0.353311).  Saving model ...
Epoch: 6 cost time: 5.6371986865997314
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.196 Vali Acc: 0.387 Test Loss: 2.196 Test Acc: 0.387
Validation loss decreased (-0.353311 --> -0.386645).  Saving model ...
Epoch: 7 cost time: 5.921499490737915
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.019 Vali Acc: 0.427 Test Loss: 2.019 Test Acc: 0.427
Validation loss decreased (-0.386645 --> -0.426646).  Saving model ...
Epoch: 8 cost time: 5.970184803009033
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.974 Vali Acc: 0.447 Test Loss: 1.974 Test Acc: 0.447
Validation loss decreased (-0.426646 --> -0.446647).  Saving model ...
Epoch: 9 cost time: 5.668097019195557
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.874 Vali Acc: 0.467 Test Loss: 1.874 Test Acc: 0.467
Validation loss decreased (-0.446647 --> -0.466648).  Saving model ...
Epoch: 10 cost time: 5.73700213432312
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.836 Vali Acc: 0.473 Test Loss: 1.836 Test Acc: 0.473
Validation loss decreased (-0.466648 --> -0.473315).  Saving model ...
Epoch: 11 cost time: 6.037907123565674
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.493 Test Loss: 1.803 Test Acc: 0.493
Validation loss decreased (-0.473315 --> -0.493315).  Saving model ...
Epoch: 12 cost time: 6.134340763092041
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.793 Vali Acc: 0.493 Test Loss: 1.793 Test Acc: 0.493
Validation loss decreased (-0.493315 --> -0.493315).  Saving model ...
Epoch: 13 cost time: 5.382206201553345
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.761 Vali Acc: 0.507 Test Loss: 1.761 Test Acc: 0.507
Validation loss decreased (-0.493315 --> -0.506649).  Saving model ...
Epoch: 14 cost time: 5.918783187866211
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.750 Vali Acc: 0.520 Test Loss: 1.750 Test Acc: 0.520
Validation loss decreased (-0.506649 --> -0.519983).  Saving model ...
Epoch: 15 cost time: 5.88318943977356
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.732 Vali Acc: 0.530 Test Loss: 1.732 Test Acc: 0.530
Validation loss decreased (-0.519983 --> -0.529983).  Saving model ...
Epoch: 16 cost time: 5.788883209228516
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.712 Vali Acc: 0.547 Test Loss: 1.712 Test Acc: 0.547
Validation loss decreased (-0.529983 --> -0.546650).  Saving model ...
Epoch: 17 cost time: 5.77627968788147
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.553 Test Loss: 1.697 Test Acc: 0.553
Validation loss decreased (-0.546650 --> -0.553316).  Saving model ...
Epoch: 18 cost time: 5.465491533279419
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.698 Vali Acc: 0.537 Test Loss: 1.698 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.438748359680176
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.675 Vali Acc: 0.543 Test Loss: 1.675 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.50455641746521
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.663 Vali Acc: 0.547 Test Loss: 1.663 Test Acc: 0.547
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.219597816467285
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.663 Vali Acc: 0.543 Test Loss: 1.663 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.119054555892944
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.664 Vali Acc: 0.547 Test Loss: 1.664 Test Acc: 0.547
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.581603527069092
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.652 Vali Acc: 0.550 Test Loss: 1.652 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.847853660583496
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.570 Test Loss: 1.630 Test Acc: 0.570
Validation loss decreased (-0.553316 --> -0.569984).  Saving model ...
Epoch: 25 cost time: 5.71019983291626
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.570 Test Loss: 1.617 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 26 cost time: 5.6369593143463135
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.583 Test Loss: 1.605 Test Acc: 0.583
Validation loss decreased (-0.569984 --> -0.583317).  Saving model ...
Epoch: 27 cost time: 5.643572092056274
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.593 Vali Acc: 0.587 Test Loss: 1.593 Test Acc: 0.587
Validation loss decreased (-0.583317 --> -0.586651).  Saving model ...
Epoch: 28 cost time: 5.538734197616577
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.573 Test Loss: 1.587 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.413533926010132
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.584 Vali Acc: 0.587 Test Loss: 1.584 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 30 cost time: 5.526055335998535
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.593 Test Loss: 1.573 Test Acc: 0.593
Validation loss decreased (-0.586651 --> -0.593318).  Saving model ...
Epoch: 31 cost time: 5.183736085891724
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.593 Test Loss: 1.567 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 32 cost time: 5.551630735397339
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.557 Vali Acc: 0.593 Test Loss: 1.557 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 33 cost time: 5.013014793395996
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.603 Test Loss: 1.539 Test Acc: 0.603
Validation loss decreased (-0.593318 --> -0.603318).  Saving model ...
Epoch: 34 cost time: 5.263527870178223
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.600 Test Loss: 1.541 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.324156999588013
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.597 Test Loss: 1.536 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.234506130218506
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.600 Test Loss: 1.535 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 5.422906160354614
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.620 Test Loss: 1.522 Test Acc: 0.620
Validation loss decreased (-0.603318 --> -0.619985).  Saving model ...
Epoch: 38 cost time: 5.508330583572388
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.610 Test Loss: 1.525 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.457205295562744
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.607 Test Loss: 1.525 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 5.354278564453125
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.617 Test Loss: 1.523 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 5.494094133377075
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.620 Test Loss: 1.517 Test Acc: 0.620
Validation loss decreased (-0.619985 --> -0.619985).  Saving model ...
Epoch: 42 cost time: 5.501641035079956
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.620 Test Loss: 1.513 Test Acc: 0.620
Validation loss decreased (-0.619985 --> -0.619985).  Saving model ...
Epoch: 43 cost time: 5.598006963729858
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.620 Test Loss: 1.512 Test Acc: 0.620
Validation loss decreased (-0.619985 --> -0.619985).  Saving model ...
Epoch: 44 cost time: 5.841323137283325
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.623 Test Loss: 1.510 Test Acc: 0.623
Validation loss decreased (-0.619985 --> -0.623318).  Saving model ...
Epoch: 45 cost time: 5.692977666854858
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.627 Test Loss: 1.503 Test Acc: 0.627
Validation loss decreased (-0.623318 --> -0.626652).  Saving model ...
Epoch: 46 cost time: 5.455956220626831
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.617 Test Loss: 1.505 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.343448638916016
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.623 Test Loss: 1.510 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 5.302567481994629
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.620 Test Loss: 1.508 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 5.287303686141968
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.627 Test Loss: 1.501 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 50 cost time: 5.4475672245025635
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.498 Vali Acc: 0.627 Test Loss: 1.498 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 51 cost time: 5.646920204162598
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.630 Test Loss: 1.486 Test Acc: 0.630
Validation loss decreased (-0.626652 --> -0.629985).  Saving model ...
Epoch: 52 cost time: 6.1699206829071045
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.487 Vali Acc: 0.630 Test Loss: 1.487 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 5.901132822036743
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.637 Test Loss: 1.488 Test Acc: 0.637
Validation loss decreased (-0.629985 --> -0.636652).  Saving model ...
Epoch: 54 cost time: 5.633127689361572
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.640 Test Loss: 1.484 Test Acc: 0.640
Validation loss decreased (-0.636652 --> -0.639985).  Saving model ...
Epoch: 55 cost time: 5.66959285736084
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.647 Test Loss: 1.485 Test Acc: 0.647
Validation loss decreased (-0.639985 --> -0.646652).  Saving model ...
Epoch: 56 cost time: 5.81279730796814
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.643 Test Loss: 1.482 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.715887784957886
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.647 Test Loss: 1.479 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 58 cost time: 5.57504415512085
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.650 Test Loss: 1.476 Test Acc: 0.650
Validation loss decreased (-0.646652 --> -0.649985).  Saving model ...
Epoch: 59 cost time: 5.62267279624939
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.474 Vali Acc: 0.647 Test Loss: 1.474 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.477515935897827
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.474 Vali Acc: 0.647 Test Loss: 1.474 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 5.705806255340576
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.475 Vali Acc: 0.647 Test Loss: 1.475 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 5.596241474151611
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.647 Test Loss: 1.477 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 5.829540967941284
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.650 Test Loss: 1.476 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 5.929906606674194
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.653 Test Loss: 1.476 Test Acc: 0.653
Validation loss decreased (-0.649985 --> -0.653319).  Saving model ...
Epoch: 65 cost time: 5.704514026641846
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.653 Test Loss: 1.478 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.73655366897583
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.653 Test Loss: 1.479 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 5.603562355041504
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.653 Test Loss: 1.480 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 5.688129425048828
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.650 Test Loss: 1.478 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 5.900407552719116
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.653 Test Loss: 1.472 Test Acc: 0.653
Validation loss decreased (-0.653319 --> -0.653319).  Saving model ...
Epoch: 70 cost time: 5.595836162567139
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.653 Test Loss: 1.471 Test Acc: 0.653
Validation loss decreased (-0.653319 --> -0.653319).  Saving model ...
Epoch: 71 cost time: 5.784483909606934
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.657 Test Loss: 1.466 Test Acc: 0.657
Validation loss decreased (-0.653319 --> -0.656652).  Saving model ...
Epoch: 72 cost time: 5.7200188636779785
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.657 Test Loss: 1.466 Test Acc: 0.657
Validation loss decreased (-0.656652 --> -0.656652).  Saving model ...
Epoch: 73 cost time: 5.268298625946045
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.657 Test Loss: 1.466 Test Acc: 0.657
Validation loss decreased (-0.656652 --> -0.656652).  Saving model ...
Epoch: 74 cost time: 5.121342897415161
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.660 Test Loss: 1.466 Test Acc: 0.660
Validation loss decreased (-0.656652 --> -0.659985).  Saving model ...
Epoch: 75 cost time: 5.1524338722229
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.667 Test Loss: 1.470 Test Acc: 0.667
Validation loss decreased (-0.659985 --> -0.666652).  Saving model ...
Epoch: 76 cost time: 5.062602281570435
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.670 Test Loss: 1.467 Test Acc: 0.670
Validation loss decreased (-0.666652 --> -0.669985).  Saving model ...
Epoch: 77 cost time: 5.467029094696045
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.670 Test Loss: 1.466 Test Acc: 0.670
Validation loss decreased (-0.669985 --> -0.669985).  Saving model ...
Epoch: 78 cost time: 5.451064586639404
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.670 Test Loss: 1.464 Test Acc: 0.670
Validation loss decreased (-0.669985 --> -0.669985).  Saving model ...
Epoch: 79 cost time: 5.648674964904785
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.663 Test Loss: 1.462 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 5.832175254821777
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.663 Test Loss: 1.460 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 5.857658386230469
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.459 Vali Acc: 0.660 Test Loss: 1.459 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 5.401163816452026
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.667 Test Loss: 1.455 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 5.30205225944519
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.458 Vali Acc: 0.660 Test Loss: 1.458 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 5.304431676864624
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.673 Test Loss: 1.460 Test Acc: 0.673
Validation loss decreased (-0.669985 --> -0.673319).  Saving model ...
Epoch: 85 cost time: 5.4146459102630615
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.459 Vali Acc: 0.670 Test Loss: 1.459 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 5.060704708099365
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.673 Test Loss: 1.455 Test Acc: 0.673
Validation loss decreased (-0.673319 --> -0.673319).  Saving model ...
Epoch: 87 cost time: 5.01616907119751
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.673 Test Loss: 1.452 Test Acc: 0.673
Validation loss decreased (-0.673319 --> -0.673319).  Saving model ...
Epoch: 88 cost time: 5.616380214691162
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.677 Test Loss: 1.451 Test Acc: 0.677
Validation loss decreased (-0.673319 --> -0.676652).  Saving model ...
Epoch: 89 cost time: 5.122541427612305
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.673 Test Loss: 1.452 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 5.237530708312988
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.677 Test Loss: 1.454 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 5.299971103668213
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.677 Test Loss: 1.455 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 4.893440008163452
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.677 Test Loss: 1.454 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 5.54336404800415
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.677 Test Loss: 1.453 Test Acc: 0.677
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 5.6209681034088135
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.677 Test Loss: 1.450 Test Acc: 0.677
Validation loss decreased (-0.676652 --> -0.676652).  Saving model ...
Epoch: 95 cost time: 5.330266237258911
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.680 Test Loss: 1.451 Test Acc: 0.680
Validation loss decreased (-0.676652 --> -0.679985).  Saving model ...
Epoch: 96 cost time: 5.03138542175293
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.683 Test Loss: 1.450 Test Acc: 0.683
Validation loss decreased (-0.679985 --> -0.683319).  Saving model ...
Epoch: 97 cost time: 5.7720019817352295
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.680 Test Loss: 1.451 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 5.624092102050781
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.677 Test Loss: 1.452 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 5.7992565631866455
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.680 Test Loss: 1.450 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 5.565006494522095
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.683 Test Loss: 1.449 Test Acc: 0.683
Validation loss decreased (-0.683319 --> -0.683319).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6833333333333333
model parameter : 13154329
model size : 69.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.052059888839722
Epoch: 1, Steps: 18 | Train Loss: 3.241 Vali Loss: 3.132 Vali Acc: 0.097 Test Loss: 3.132 Test Acc: 0.097
Validation loss decreased (inf --> -0.096635).  Saving model ...
Epoch: 2 cost time: 4.906610488891602
Epoch: 2, Steps: 18 | Train Loss: 1.817 Vali Loss: 2.833 Vali Acc: 0.190 Test Loss: 2.833 Test Acc: 0.190
Validation loss decreased (-0.096635 --> -0.189972).  Saving model ...
Epoch: 3 cost time: 4.82024884223938
Epoch: 3, Steps: 18 | Train Loss: 0.407 Vali Loss: 2.497 Vali Acc: 0.273 Test Loss: 2.497 Test Acc: 0.273
Validation loss decreased (-0.189972 --> -0.273308).  Saving model ...
Epoch: 4 cost time: 5.072096586227417
Epoch: 4, Steps: 18 | Train Loss: 0.055 Vali Loss: 2.366 Vali Acc: 0.323 Test Loss: 2.366 Test Acc: 0.323
Validation loss decreased (-0.273308 --> -0.323310).  Saving model ...
Epoch: 5 cost time: 5.382184982299805
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.108 Vali Acc: 0.383 Test Loss: 2.108 Test Acc: 0.383
Validation loss decreased (-0.323310 --> -0.383312).  Saving model ...
Epoch: 6 cost time: 5.803511142730713
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.955 Vali Acc: 0.430 Test Loss: 1.955 Test Acc: 0.430
Validation loss decreased (-0.383312 --> -0.429980).  Saving model ...
Epoch: 7 cost time: 5.664312839508057
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.868 Vali Acc: 0.457 Test Loss: 1.868 Test Acc: 0.457
Validation loss decreased (-0.429980 --> -0.456648).  Saving model ...
Epoch: 8 cost time: 5.455528259277344
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.831 Vali Acc: 0.463 Test Loss: 1.831 Test Acc: 0.463
Validation loss decreased (-0.456648 --> -0.463315).  Saving model ...
Epoch: 9 cost time: 5.09657096862793
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.774 Vali Acc: 0.480 Test Loss: 1.774 Test Acc: 0.480
Validation loss decreased (-0.463315 --> -0.479982).  Saving model ...
Epoch: 10 cost time: 4.892280101776123
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.737 Vali Acc: 0.480 Test Loss: 1.737 Test Acc: 0.480
Validation loss decreased (-0.479982 --> -0.479983).  Saving model ...
Epoch: 11 cost time: 5.075541257858276
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.712 Vali Acc: 0.490 Test Loss: 1.712 Test Acc: 0.490
Validation loss decreased (-0.479983 --> -0.489983).  Saving model ...
Epoch: 12 cost time: 5.296318769454956
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.681 Vali Acc: 0.503 Test Loss: 1.681 Test Acc: 0.503
Validation loss decreased (-0.489983 --> -0.503317).  Saving model ...
Epoch: 13 cost time: 5.019033908843994
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.656 Vali Acc: 0.513 Test Loss: 1.656 Test Acc: 0.513
Validation loss decreased (-0.503317 --> -0.513317).  Saving model ...
Epoch: 14 cost time: 5.511949062347412
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.520 Test Loss: 1.644 Test Acc: 0.520
Validation loss decreased (-0.513317 --> -0.519984).  Saving model ...
Epoch: 15 cost time: 5.33599853515625
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.530 Test Loss: 1.631 Test Acc: 0.530
Validation loss decreased (-0.519984 --> -0.529984).  Saving model ...
Epoch: 16 cost time: 5.625272750854492
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.543 Test Loss: 1.610 Test Acc: 0.543
Validation loss decreased (-0.529984 --> -0.543317).  Saving model ...
Epoch: 17 cost time: 5.655058145523071
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.540 Test Loss: 1.601 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.365813732147217
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.547 Test Loss: 1.597 Test Acc: 0.547
Validation loss decreased (-0.543317 --> -0.546651).  Saving model ...
Epoch: 19 cost time: 5.3571999073028564
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.567 Test Loss: 1.578 Test Acc: 0.567
Validation loss decreased (-0.546651 --> -0.566651).  Saving model ...
Epoch: 20 cost time: 5.145061016082764
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.570 Test Loss: 1.559 Test Acc: 0.570
Validation loss decreased (-0.566651 --> -0.569984).  Saving model ...
Epoch: 21 cost time: 5.377260208129883
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.543 Vali Acc: 0.580 Test Loss: 1.543 Test Acc: 0.580
Validation loss decreased (-0.569984 --> -0.579985).  Saving model ...
Epoch: 22 cost time: 5.07025408744812
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.548 Vali Acc: 0.577 Test Loss: 1.548 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.645115375518799
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.577 Test Loss: 1.541 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.497429609298706
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.587 Test Loss: 1.525 Test Acc: 0.587
Validation loss decreased (-0.579985 --> -0.586651).  Saving model ...
Epoch: 25 cost time: 5.626688241958618
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.597 Test Loss: 1.512 Test Acc: 0.597
Validation loss decreased (-0.586651 --> -0.596652).  Saving model ...
Epoch: 26 cost time: 5.585235118865967
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.600 Test Loss: 1.499 Test Acc: 0.600
Validation loss decreased (-0.596652 --> -0.599985).  Saving model ...
Epoch: 27 cost time: 5.2663068771362305
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.613 Test Loss: 1.493 Test Acc: 0.613
Validation loss decreased (-0.599985 --> -0.613318).  Saving model ...
Epoch: 28 cost time: 5.139354467391968
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.610 Test Loss: 1.492 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.989565134048462
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.610 Test Loss: 1.488 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.338663339614868
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.620 Test Loss: 1.480 Test Acc: 0.620
Validation loss decreased (-0.613318 --> -0.619985).  Saving model ...
Epoch: 31 cost time: 5.447832822799683
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.620 Test Loss: 1.472 Test Acc: 0.620
Validation loss decreased (-0.619985 --> -0.619985).  Saving model ...
Epoch: 32 cost time: 5.27987813949585
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.623 Test Loss: 1.460 Test Acc: 0.623
Validation loss decreased (-0.619985 --> -0.623319).  Saving model ...
Epoch: 33 cost time: 5.532871961593628
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.627 Test Loss: 1.449 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626652).  Saving model ...
Epoch: 34 cost time: 5.551011562347412
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.633 Test Loss: 1.449 Test Acc: 0.633
Validation loss decreased (-0.626652 --> -0.633319).  Saving model ...
Epoch: 35 cost time: 5.691232442855835
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.637 Test Loss: 1.445 Test Acc: 0.637
Validation loss decreased (-0.633319 --> -0.636652).  Saving model ...
Epoch: 36 cost time: 5.439350605010986
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.643 Test Loss: 1.441 Test Acc: 0.643
Validation loss decreased (-0.636652 --> -0.643319).  Saving model ...
Epoch: 37 cost time: 5.226386785507202
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.653 Test Loss: 1.435 Test Acc: 0.653
Validation loss decreased (-0.643319 --> -0.653319).  Saving model ...
Epoch: 38 cost time: 5.137731552124023
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.643 Test Loss: 1.438 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.2699339389801025
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.640 Test Loss: 1.437 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 5.4408934116363525
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.637 Test Loss: 1.434 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 4.947205066680908
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.633 Test Loss: 1.431 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 5.444405555725098
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.640 Test Loss: 1.430 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 5.1827943325042725
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.640 Test Loss: 1.429 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 5.166709899902344
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.643 Test Loss: 1.424 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 5.305643081665039
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.647 Test Loss: 1.416 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 5.227410554885864
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.647 Test Loss: 1.416 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 5.2218921184539795
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.417 Vali Acc: 0.647 Test Loss: 1.417 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6533333333333333
model parameter : 13154329
model size : 69.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.490693092346191
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 6.035906791687012
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 3 cost time: 5.96094012260437
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.630264759063721
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.983949184417725
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.65290093421936
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.280599117279053
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.549906015396118
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.505983591079712
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.694417476654053
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.699786186218262
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.146972179412842
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 13154329
model size : 69.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.104806661605835
Epoch: 1, Steps: 18 | Train Loss: 2.632 Vali Loss: 1.032 Vali Acc: 0.780 Test Loss: 1.032 Test Acc: 0.780
Validation loss decreased (inf --> -0.779990).  Saving model ...
Epoch: 2 cost time: 5.476646661758423
Epoch: 2, Steps: 18 | Train Loss: 0.334 Vali Loss: 0.574 Vali Acc: 0.840 Test Loss: 0.574 Test Acc: 0.840
Validation loss decreased (-0.779990 --> -0.839994).  Saving model ...
Epoch: 3 cost time: 5.5843751430511475
Epoch: 3, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.480 Vali Acc: 0.870 Test Loss: 0.480 Test Acc: 0.870
Validation loss decreased (-0.839994 --> -0.869995).  Saving model ...
Epoch: 4 cost time: 5.520846843719482
Epoch: 4, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
Validation loss decreased (-0.869995 --> -0.899996).  Saving model ...
Epoch: 5 cost time: 5.436346530914307
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.397 Vali Acc: 0.883 Test Loss: 0.397 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.157815217971802
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.395 Vali Acc: 0.883 Test Loss: 0.395 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.6159138679504395
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.893 Test Loss: 0.387 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.273754835128784
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.893 Test Loss: 0.384 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.282567024230957
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.893 Test Loss: 0.385 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.209052562713623
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.382 Vali Acc: 0.890 Test Loss: 0.382 Test Acc: 0.890
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.102067232131958
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.382 Vali Acc: 0.890 Test Loss: 0.382 Test Acc: 0.890
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.031324625015259
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.893 Test Loss: 0.383 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.955870866775513
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.890 Test Loss: 0.381 Test Acc: 0.890
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.317818880081177
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.382 Vali Acc: 0.893 Test Loss: 0.382 Test Acc: 0.893
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9
model parameter : 12761113
model size : 68.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.381568670272827
Epoch: 1, Steps: 18 | Train Loss: 2.798 Vali Loss: 1.366 Vali Acc: 0.707 Test Loss: 1.366 Test Acc: 0.707
Validation loss decreased (inf --> -0.706653).  Saving model ...
Epoch: 2 cost time: 6.207931756973267
Epoch: 2, Steps: 18 | Train Loss: 0.452 Vali Loss: 0.799 Vali Acc: 0.767 Test Loss: 0.799 Test Acc: 0.767
Validation loss decreased (-0.706653 --> -0.766659).  Saving model ...
Epoch: 3 cost time: 5.858200788497925
Epoch: 3, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.639 Vali Acc: 0.823 Test Loss: 0.639 Test Acc: 0.823
Validation loss decreased (-0.766659 --> -0.823327).  Saving model ...
Epoch: 4 cost time: 5.586020469665527
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.539 Vali Acc: 0.860 Test Loss: 0.539 Test Acc: 0.860
Validation loss decreased (-0.823327 --> -0.859995).  Saving model ...
Epoch: 5 cost time: 5.725344181060791
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.580 Vali Acc: 0.860 Test Loss: 0.580 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.4493043422698975
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.847 Test Loss: 0.600 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.175775766372681
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.870 Test Loss: 0.583 Test Acc: 0.870
Validation loss decreased (-0.859995 --> -0.869994).  Saving model ...
Epoch: 8 cost time: 5.578778505325317
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.873 Test Loss: 0.581 Test Acc: 0.873
Validation loss decreased (-0.869994 --> -0.873328).  Saving model ...
Epoch: 9 cost time: 6.0514256954193115
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.873 Test Loss: 0.586 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.720219135284424
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.877 Test Loss: 0.584 Test Acc: 0.877
Validation loss decreased (-0.873328 --> -0.876661).  Saving model ...
Epoch: 11 cost time: 6.076128959655762
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.880 Test Loss: 0.586 Test Acc: 0.880
Validation loss decreased (-0.876661 --> -0.879994).  Saving model ...
Epoch: 12 cost time: 5.801192283630371
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.883 Test Loss: 0.585 Test Acc: 0.883
Validation loss decreased (-0.879994 --> -0.883327).  Saving model ...
Epoch: 13 cost time: 5.941009283065796
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.880 Test Loss: 0.586 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.72087287902832
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.880 Test Loss: 0.586 Test Acc: 0.880
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.785834550857544
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.880 Test Loss: 0.589 Test Acc: 0.880
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.992010116577148
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.880 Test Loss: 0.592 Test Acc: 0.880
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.8254852294921875
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.877 Test Loss: 0.593 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.056386709213257
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.877 Test Loss: 0.595 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.995821475982666
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.880 Test Loss: 0.596 Test Acc: 0.880
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.998424053192139
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.873 Test Loss: 0.596 Test Acc: 0.873
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.312868356704712
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.873 Test Loss: 0.596 Test Acc: 0.873
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.662939548492432
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.873 Test Loss: 0.598 Test Acc: 0.873
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8833333333333333
model parameter : 12761113
model size : 68.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.538395643234253
Epoch: 1, Steps: 18 | Train Loss: 2.984 Vali Loss: 1.900 Vali Acc: 0.600 Test Loss: 1.900 Test Acc: 0.600
Validation loss decreased (inf --> -0.599981).  Saving model ...
Epoch: 2 cost time: 4.93910026550293
Epoch: 2, Steps: 18 | Train Loss: 0.703 Vali Loss: 1.172 Vali Acc: 0.680 Test Loss: 1.172 Test Acc: 0.680
Validation loss decreased (-0.599981 --> -0.679988).  Saving model ...
Epoch: 3 cost time: 5.7976813316345215
Epoch: 3, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.032 Vali Acc: 0.730 Test Loss: 1.032 Test Acc: 0.730
Validation loss decreased (-0.679988 --> -0.729990).  Saving model ...
Epoch: 4 cost time: 5.826364517211914
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.971 Vali Acc: 0.760 Test Loss: 0.971 Test Acc: 0.760
Validation loss decreased (-0.729990 --> -0.759990).  Saving model ...
Epoch: 5 cost time: 5.712491989135742
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.885 Vali Acc: 0.760 Test Loss: 0.885 Test Acc: 0.760
Validation loss decreased (-0.759990 --> -0.759991).  Saving model ...
Epoch: 6 cost time: 5.721733331680298
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.767 Test Loss: 0.875 Test Acc: 0.767
Validation loss decreased (-0.759991 --> -0.766658).  Saving model ...
Epoch: 7 cost time: 5.641539573669434
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.773 Test Loss: 0.872 Test Acc: 0.773
Validation loss decreased (-0.766658 --> -0.773325).  Saving model ...
Epoch: 8 cost time: 5.7733142375946045
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.770 Test Loss: 0.872 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.5256078243255615
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.773 Test Loss: 0.875 Test Acc: 0.773
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.510234832763672
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.773 Test Loss: 0.866 Test Acc: 0.773
Validation loss decreased (-0.773325 --> -0.773325).  Saving model ...
Epoch: 11 cost time: 5.565611839294434
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.770 Test Loss: 0.864 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.453968524932861
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.773 Test Loss: 0.864 Test Acc: 0.773
Validation loss decreased (-0.773325 --> -0.773325).  Saving model ...
Epoch: 13 cost time: 5.649465560913086
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.777 Test Loss: 0.864 Test Acc: 0.777
Validation loss decreased (-0.773325 --> -0.776658).  Saving model ...
Epoch: 14 cost time: 5.68210506439209
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.777 Test Loss: 0.862 Test Acc: 0.777
Validation loss decreased (-0.776658 --> -0.776658).  Saving model ...
Epoch: 15 cost time: 5.546100616455078
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.777 Test Loss: 0.868 Test Acc: 0.777
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.434451103210449
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.770 Test Loss: 0.868 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.8397510051727295
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.783 Test Loss: 0.870 Test Acc: 0.783
Validation loss decreased (-0.776658 --> -0.783325).  Saving model ...
Epoch: 18 cost time: 5.591302871704102
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.783 Test Loss: 0.873 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.767212867736816
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.793 Test Loss: 0.873 Test Acc: 0.793
Validation loss decreased (-0.783325 --> -0.793325).  Saving model ...
Epoch: 20 cost time: 5.86405086517334
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.790 Test Loss: 0.874 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.0611793994903564
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.783 Test Loss: 0.875 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.827896356582642
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.790 Test Loss: 0.881 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.927186012268066
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.787 Test Loss: 0.879 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.574514389038086
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.787 Test Loss: 0.877 Test Acc: 0.787
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.67238712310791
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.783 Test Loss: 0.881 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.532142877578735
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.787 Test Loss: 0.881 Test Acc: 0.787
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.622140169143677
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.783 Test Loss: 0.884 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.3647074699401855
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.787 Test Loss: 0.886 Test Acc: 0.787
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.765622615814209
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.787 Test Loss: 0.888 Test Acc: 0.787
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7933333333333333
model parameter : 12761113
model size : 68.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.81218957901001
Epoch: 1, Steps: 18 | Train Loss: 3.130 Vali Loss: 2.442 Vali Acc: 0.393 Test Loss: 2.442 Test Acc: 0.393
Validation loss decreased (inf --> -0.393309).  Saving model ...
Epoch: 2 cost time: 5.766829490661621
Epoch: 2, Steps: 18 | Train Loss: 1.104 Vali Loss: 1.727 Vali Acc: 0.480 Test Loss: 1.727 Test Acc: 0.480
Validation loss decreased (-0.393309 --> -0.479983).  Saving model ...
Epoch: 3 cost time: 5.885578632354736
Epoch: 3, Steps: 18 | Train Loss: 0.134 Vali Loss: 1.574 Vali Acc: 0.507 Test Loss: 1.574 Test Acc: 0.507
Validation loss decreased (-0.479983 --> -0.506651).  Saving model ...
Epoch: 4 cost time: 5.889053583145142
Epoch: 4, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.464 Vali Acc: 0.553 Test Loss: 1.464 Test Acc: 0.553
Validation loss decreased (-0.506651 --> -0.553319).  Saving model ...
Epoch: 5 cost time: 5.634636640548706
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.220 Vali Acc: 0.650 Test Loss: 1.220 Test Acc: 0.650
Validation loss decreased (-0.553319 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 5.452315092086792
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.155 Vali Acc: 0.653 Test Loss: 1.155 Test Acc: 0.653
Validation loss decreased (-0.649988 --> -0.653322).  Saving model ...
Epoch: 7 cost time: 5.37187647819519
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.094 Vali Acc: 0.687 Test Loss: 1.094 Test Acc: 0.687
Validation loss decreased (-0.653322 --> -0.686656).  Saving model ...
Epoch: 8 cost time: 5.683001756668091
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.083 Vali Acc: 0.687 Test Loss: 1.083 Test Acc: 0.687
Validation loss decreased (-0.686656 --> -0.686656).  Saving model ...
Epoch: 9 cost time: 5.671506643295288
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.086 Vali Acc: 0.693 Test Loss: 1.086 Test Acc: 0.693
Validation loss decreased (-0.686656 --> -0.693322).  Saving model ...
Epoch: 10 cost time: 5.640888214111328
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.067 Vali Acc: 0.687 Test Loss: 1.067 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.854971647262573
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.697 Test Loss: 1.068 Test Acc: 0.697
Validation loss decreased (-0.693322 --> -0.696656).  Saving model ...
Epoch: 12 cost time: 5.520269870758057
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.065 Vali Acc: 0.700 Test Loss: 1.065 Test Acc: 0.700
Validation loss decreased (-0.696656 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 5.391683578491211
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.703 Test Loss: 1.060 Test Acc: 0.703
Validation loss decreased (-0.699989 --> -0.703323).  Saving model ...
Epoch: 14 cost time: 5.3288562297821045
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.707 Test Loss: 1.061 Test Acc: 0.707
Validation loss decreased (-0.703323 --> -0.706656).  Saving model ...
Epoch: 15 cost time: 5.783689737319946
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.066 Vali Acc: 0.693 Test Loss: 1.066 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.621339797973633
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.700 Test Loss: 1.058 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.271740913391113
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.697 Test Loss: 1.053 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.591196537017822
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.703 Test Loss: 1.055 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.591684579849243
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.703 Test Loss: 1.054 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.564599990844727
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.703 Test Loss: 1.054 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.868651390075684
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.707 Test Loss: 1.051 Test Acc: 0.707
Validation loss decreased (-0.706656 --> -0.706656).  Saving model ...
Epoch: 22 cost time: 5.3857505321502686
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.703 Test Loss: 1.052 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.013420104980469
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.707 Test Loss: 1.047 Test Acc: 0.707
Validation loss decreased (-0.706656 --> -0.706656).  Saving model ...
Epoch: 24 cost time: 5.243174076080322
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.703 Test Loss: 1.040 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.37650465965271
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.044 Vali Acc: 0.703 Test Loss: 1.044 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.3918938636779785
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.707 Test Loss: 1.042 Test Acc: 0.707
Validation loss decreased (-0.706656 --> -0.706656).  Saving model ...
Epoch: 27 cost time: 5.348828554153442
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.703 Test Loss: 1.045 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.77247428894043
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.707 Test Loss: 1.049 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.627212762832642
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.707 Test Loss: 1.049 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.800570011138916
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.044 Vali Acc: 0.710 Test Loss: 1.044 Test Acc: 0.710
Validation loss decreased (-0.706656 --> -0.709990).  Saving model ...
Epoch: 31 cost time: 5.51452374458313
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.044 Vali Acc: 0.717 Test Loss: 1.044 Test Acc: 0.717
Validation loss decreased (-0.709990 --> -0.716656).  Saving model ...
Epoch: 32 cost time: 5.504047870635986
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.717 Test Loss: 1.040 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716656).  Saving model ...
Epoch: 33 cost time: 5.548870325088501
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.043 Vali Acc: 0.713 Test Loss: 1.043 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.572533845901489
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.717 Test Loss: 1.041 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.007986545562744
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.717 Test Loss: 1.041 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.460945129394531
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.713 Test Loss: 1.046 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 5.729271173477173
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.713 Test Loss: 1.047 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 5.454646110534668
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.717 Test Loss: 1.047 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 5.3060548305511475
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.723 Test Loss: 1.045 Test Acc: 0.723
Validation loss decreased (-0.716656 --> -0.723323).  Saving model ...
Epoch: 40 cost time: 5.195448875427246
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.043 Vali Acc: 0.723 Test Loss: 1.043 Test Acc: 0.723
Validation loss decreased (-0.723323 --> -0.723323).  Saving model ...
Epoch: 41 cost time: 5.071341276168823
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.723 Test Loss: 1.045 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.218107461929321
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.723 Test Loss: 1.048 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 5.720635890960693
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.720 Test Loss: 1.051 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 5.363306760787964
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.727 Test Loss: 1.051 Test Acc: 0.727
Validation loss decreased (-0.723323 --> -0.726656).  Saving model ...
Epoch: 45 cost time: 5.605708122253418
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.723 Test Loss: 1.048 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.812559127807617
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.727 Test Loss: 1.045 Test Acc: 0.727
Validation loss decreased (-0.726656 --> -0.726656).  Saving model ...
Epoch: 47 cost time: 5.630171298980713
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.727 Test Loss: 1.045 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.63341498374939
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.727 Test Loss: 1.046 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 5.348055362701416
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.727 Test Loss: 1.050 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 5.266451597213745
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.727 Test Loss: 1.051 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 5.0417680740356445
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.727 Test Loss: 1.050 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 5.405145168304443
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.727 Test Loss: 1.050 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 5.180979490280151
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.727 Test Loss: 1.049 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 5.406463623046875
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.727 Test Loss: 1.050 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 5.6208038330078125
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.723 Test Loss: 1.049 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 6.073598861694336
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.730 Test Loss: 1.048 Test Acc: 0.730
Validation loss decreased (-0.726656 --> -0.729990).  Saving model ...
Epoch: 57 cost time: 5.693036079406738
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.730 Test Loss: 1.047 Test Acc: 0.730
Validation loss decreased (-0.729990 --> -0.729990).  Saving model ...
Epoch: 58 cost time: 5.319546461105347
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.730 Test Loss: 1.046 Test Acc: 0.730
Validation loss decreased (-0.729990 --> -0.729990).  Saving model ...
Epoch: 59 cost time: 5.427594423294067
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.730 Test Loss: 1.047 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.42659068107605
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.730 Test Loss: 1.047 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 5.390750169754028
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.730 Test Loss: 1.048 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 5.796159744262695
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.727 Test Loss: 1.053 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 5.557502031326294
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.727 Test Loss: 1.055 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 5.3851401805877686
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.733 Test Loss: 1.055 Test Acc: 0.733
Validation loss decreased (-0.729990 --> -0.733323).  Saving model ...
Epoch: 65 cost time: 5.427510738372803
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.733 Test Loss: 1.053 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 66 cost time: 5.13180685043335
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.733 Test Loss: 1.054 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 4.820014476776123
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.733 Test Loss: 1.056 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 4.954561471939087
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.733 Test Loss: 1.056 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 5.203244209289551
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.733 Test Loss: 1.056 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 5.3971333503723145
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.737 Test Loss: 1.055 Test Acc: 0.737
Validation loss decreased (-0.733323 --> -0.736656).  Saving model ...
Epoch: 71 cost time: 5.3142008781433105
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.737 Test Loss: 1.056 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.900608539581299
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.737 Test Loss: 1.056 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 5.678694248199463
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.733 Test Loss: 1.056 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 5.8056416511535645
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.737 Test Loss: 1.057 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 6.162440776824951
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.737 Test Loss: 1.057 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 5.086398124694824
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.737 Test Loss: 1.059 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 5.571876764297485
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.737 Test Loss: 1.061 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 5.333980083465576
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.737 Test Loss: 1.061 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 5.275464773178101
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.062 Vali Acc: 0.733 Test Loss: 1.062 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 5.212337255477905
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.733 Test Loss: 1.060 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7366666666666667
model parameter : 12761113
model size : 68.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.746068954467773
Epoch: 1, Steps: 18 | Train Loss: 3.189 Vali Loss: 2.751 Vali Acc: 0.273 Test Loss: 2.751 Test Acc: 0.273
Validation loss decreased (inf --> -0.273306).  Saving model ...
Epoch: 2 cost time: 5.348815202713013
Epoch: 2, Steps: 18 | Train Loss: 1.390 Vali Loss: 2.302 Vali Acc: 0.337 Test Loss: 2.302 Test Acc: 0.337
Validation loss decreased (-0.273306 --> -0.336644).  Saving model ...
Epoch: 3 cost time: 5.789033651351929
Epoch: 3, Steps: 18 | Train Loss: 0.220 Vali Loss: 1.910 Vali Acc: 0.423 Test Loss: 1.910 Test Acc: 0.423
Validation loss decreased (-0.336644 --> -0.423314).  Saving model ...
Epoch: 4 cost time: 5.505185842514038
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.719 Vali Acc: 0.503 Test Loss: 1.719 Test Acc: 0.503
Validation loss decreased (-0.423314 --> -0.503316).  Saving model ...
Epoch: 5 cost time: 5.3767805099487305
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.547 Vali Acc: 0.553 Test Loss: 1.547 Test Acc: 0.553
Validation loss decreased (-0.503316 --> -0.553318).  Saving model ...
Epoch: 6 cost time: 5.292755842208862
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.524 Vali Acc: 0.563 Test Loss: 1.524 Test Acc: 0.563
Validation loss decreased (-0.553318 --> -0.563318).  Saving model ...
Epoch: 7 cost time: 5.51699686050415
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.515 Vali Acc: 0.570 Test Loss: 1.515 Test Acc: 0.570
Validation loss decreased (-0.563318 --> -0.569985).  Saving model ...
Epoch: 8 cost time: 5.721059083938599
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.493 Vali Acc: 0.583 Test Loss: 1.493 Test Acc: 0.583
Validation loss decreased (-0.569985 --> -0.583318).  Saving model ...
Epoch: 9 cost time: 5.840038776397705
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.482 Vali Acc: 0.590 Test Loss: 1.482 Test Acc: 0.590
Validation loss decreased (-0.583318 --> -0.589985).  Saving model ...
Epoch: 10 cost time: 5.779058218002319
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.452 Vali Acc: 0.600 Test Loss: 1.452 Test Acc: 0.600
Validation loss decreased (-0.589985 --> -0.599985).  Saving model ...
Epoch: 11 cost time: 5.81826639175415
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.607 Test Loss: 1.445 Test Acc: 0.607
Validation loss decreased (-0.599985 --> -0.606652).  Saving model ...
Epoch: 12 cost time: 5.557401418685913
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.421 Vali Acc: 0.607 Test Loss: 1.421 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 13 cost time: 5.207182168960571
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.603 Test Loss: 1.409 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.442114591598511
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.613 Test Loss: 1.409 Test Acc: 0.613
Validation loss decreased (-0.606652 --> -0.613319).  Saving model ...
Epoch: 15 cost time: 5.122109889984131
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.610 Test Loss: 1.407 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.165998935699463
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.623 Test Loss: 1.398 Test Acc: 0.623
Validation loss decreased (-0.613319 --> -0.623319).  Saving model ...
Epoch: 17 cost time: 5.596015930175781
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.623 Test Loss: 1.390 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 18 cost time: 5.295517683029175
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.623 Test Loss: 1.392 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.454221963882446
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.633 Test Loss: 1.383 Test Acc: 0.633
Validation loss decreased (-0.623319 --> -0.633320).  Saving model ...
Epoch: 20 cost time: 5.0791356563568115
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.633 Test Loss: 1.377 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 21 cost time: 5.268923044204712
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.633 Test Loss: 1.369 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 22 cost time: 5.268311023712158
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.633 Test Loss: 1.367 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 23 cost time: 5.458407163619995
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.633 Test Loss: 1.363 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 24 cost time: 5.425159454345703
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.637 Test Loss: 1.359 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.636653).  Saving model ...
Epoch: 25 cost time: 5.583528757095337
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.650 Test Loss: 1.358 Test Acc: 0.650
Validation loss decreased (-0.636653 --> -0.649986).  Saving model ...
Epoch: 26 cost time: 5.52570104598999
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.647 Test Loss: 1.356 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.688086986541748
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.653 Test Loss: 1.357 Test Acc: 0.653
Validation loss decreased (-0.649986 --> -0.653320).  Saving model ...
Epoch: 28 cost time: 5.601110219955444
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.643 Test Loss: 1.364 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.21161961555481
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.653 Test Loss: 1.360 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.4847798347473145
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.653 Test Loss: 1.352 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 31 cost time: 5.38948655128479
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.650 Test Loss: 1.356 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.153930187225342
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.657 Test Loss: 1.358 Test Acc: 0.657
Validation loss decreased (-0.653320 --> -0.656653).  Saving model ...
Epoch: 33 cost time: 5.4700846672058105
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.657 Test Loss: 1.356 Test Acc: 0.657
Validation loss decreased (-0.656653 --> -0.656653).  Saving model ...
Epoch: 34 cost time: 5.708656072616577
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.653 Test Loss: 1.349 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.546349287033081
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.660 Test Loss: 1.348 Test Acc: 0.660
Validation loss decreased (-0.656653 --> -0.659987).  Saving model ...
Epoch: 36 cost time: 5.63756537437439
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.667 Test Loss: 1.348 Test Acc: 0.667
Validation loss decreased (-0.659987 --> -0.666653).  Saving model ...
Epoch: 37 cost time: 5.40216326713562
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.667 Test Loss: 1.350 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.607070207595825
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.670 Test Loss: 1.354 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.669986).  Saving model ...
Epoch: 39 cost time: 5.300561189651489
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.670 Test Loss: 1.352 Test Acc: 0.670
Validation loss decreased (-0.669986 --> -0.669986).  Saving model ...
Epoch: 40 cost time: 5.402923583984375
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.670 Test Loss: 1.349 Test Acc: 0.670
Validation loss decreased (-0.669986 --> -0.669987).  Saving model ...
Epoch: 41 cost time: 5.504460573196411
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.670 Test Loss: 1.348 Test Acc: 0.670
Validation loss decreased (-0.669987 --> -0.669987).  Saving model ...
Epoch: 42 cost time: 5.54560923576355
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.673 Test Loss: 1.351 Test Acc: 0.673
Validation loss decreased (-0.669987 --> -0.673320).  Saving model ...
Epoch: 43 cost time: 5.430467128753662
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.673 Test Loss: 1.350 Test Acc: 0.673
Validation loss decreased (-0.673320 --> -0.673320).  Saving model ...
Epoch: 44 cost time: 5.471477508544922
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.677 Test Loss: 1.348 Test Acc: 0.677
Validation loss decreased (-0.673320 --> -0.676653).  Saving model ...
Epoch: 45 cost time: 5.232839822769165
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.673 Test Loss: 1.347 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.253058433532715
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.680 Test Loss: 1.343 Test Acc: 0.680
Validation loss decreased (-0.676653 --> -0.679987).  Saving model ...
Epoch: 47 cost time: 5.102288246154785
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.677 Test Loss: 1.344 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.066572666168213
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.687 Test Loss: 1.344 Test Acc: 0.687
Validation loss decreased (-0.679987 --> -0.686653).  Saving model ...
Epoch: 49 cost time: 5.2482616901397705
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.687 Test Loss: 1.343 Test Acc: 0.687
Validation loss decreased (-0.686653 --> -0.686653).  Saving model ...
Epoch: 50 cost time: 5.439035415649414
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.690 Test Loss: 1.342 Test Acc: 0.690
Validation loss decreased (-0.686653 --> -0.689987).  Saving model ...
Epoch: 51 cost time: 5.9822728633880615
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.687 Test Loss: 1.341 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.630496978759766
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.687 Test Loss: 1.343 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 5.865619897842407
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.690 Test Loss: 1.343 Test Acc: 0.690
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 5.467250347137451
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.690 Test Loss: 1.343 Test Acc: 0.690
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 5.317110538482666
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.690 Test Loss: 1.343 Test Acc: 0.690
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 5.277434587478638
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.690 Test Loss: 1.343 Test Acc: 0.690
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 5.17915153503418
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.677 Test Loss: 1.342 Test Acc: 0.677
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 4.971502065658569
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.680 Test Loss: 1.339 Test Acc: 0.680
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 5.104321479797363
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.690 Test Loss: 1.338 Test Acc: 0.690
Validation loss decreased (-0.689987 --> -0.689987).  Saving model ...
Epoch: 60 cost time: 5.540044546127319
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.687 Test Loss: 1.337 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 5.534479379653931
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.687 Test Loss: 1.337 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 5.280785083770752
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.687 Test Loss: 1.338 Test Acc: 0.687
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 5.2746076583862305
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.687 Test Loss: 1.338 Test Acc: 0.687
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 5.181914806365967
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.687 Test Loss: 1.338 Test Acc: 0.687
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 5.424166440963745
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.687 Test Loss: 1.340 Test Acc: 0.687
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 5.71675443649292
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.687 Test Loss: 1.340 Test Acc: 0.687
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 5.7350311279296875
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.690 Test Loss: 1.341 Test Acc: 0.690
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 5.736954689025879
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.693 Test Loss: 1.341 Test Acc: 0.693
Validation loss decreased (-0.689987 --> -0.693320).  Saving model ...
Epoch: 69 cost time: 6.002295970916748
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.690 Test Loss: 1.340 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 5.77845311164856
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.693 Test Loss: 1.339 Test Acc: 0.693
Validation loss decreased (-0.693320 --> -0.693320).  Saving model ...
Epoch: 71 cost time: 5.827732563018799
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.693 Test Loss: 1.341 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.274070501327515
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.693 Test Loss: 1.341 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 5.323195457458496
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.693 Test Loss: 1.341 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 5.499459743499756
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.693 Test Loss: 1.341 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 5.2972095012664795
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.693 Test Loss: 1.344 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 5.683305263519287
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.693 Test Loss: 1.344 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 5.844744443893433
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.693 Test Loss: 1.342 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 6.168528318405151
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.693 Test Loss: 1.342 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 5.938085317611694
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.693 Test Loss: 1.342 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 5.986760377883911
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.693 Test Loss: 1.342 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6933333333333334
model parameter : 12761113
model size : 68.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.844647407531738
Epoch: 1, Steps: 18 | Train Loss: 3.177 Vali Loss: 2.928 Vali Acc: 0.173 Test Loss: 2.928 Test Acc: 0.173
Validation loss decreased (inf --> -0.173304).  Saving model ...
Epoch: 2 cost time: 5.324920177459717
Epoch: 2, Steps: 18 | Train Loss: 1.420 Vali Loss: 2.538 Vali Acc: 0.263 Test Loss: 2.538 Test Acc: 0.263
Validation loss decreased (-0.173304 --> -0.263308).  Saving model ...
Epoch: 3 cost time: 5.185889482498169
Epoch: 3, Steps: 18 | Train Loss: 0.209 Vali Loss: 2.205 Vali Acc: 0.350 Test Loss: 2.205 Test Acc: 0.350
Validation loss decreased (-0.263308 --> -0.349978).  Saving model ...
Epoch: 4 cost time: 5.181312084197998
Epoch: 4, Steps: 18 | Train Loss: 0.018 Vali Loss: 2.203 Vali Acc: 0.423 Test Loss: 2.203 Test Acc: 0.423
Validation loss decreased (-0.349978 --> -0.423311).  Saving model ...
Epoch: 5 cost time: 5.467547416687012
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.960 Vali Acc: 0.470 Test Loss: 1.960 Test Acc: 0.470
Validation loss decreased (-0.423311 --> -0.469980).  Saving model ...
Epoch: 6 cost time: 5.393796920776367
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.909 Vali Acc: 0.477 Test Loss: 1.909 Test Acc: 0.477
Validation loss decreased (-0.469980 --> -0.476648).  Saving model ...
Epoch: 7 cost time: 5.533078908920288
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.873 Vali Acc: 0.490 Test Loss: 1.873 Test Acc: 0.490
Validation loss decreased (-0.476648 --> -0.489981).  Saving model ...
Epoch: 8 cost time: 5.604893445968628
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.826 Vali Acc: 0.500 Test Loss: 1.826 Test Acc: 0.500
Validation loss decreased (-0.489981 --> -0.499982).  Saving model ...
Epoch: 9 cost time: 5.389411449432373
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.803 Vali Acc: 0.500 Test Loss: 1.803 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499982).  Saving model ...
Epoch: 10 cost time: 5.3420422077178955
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.517 Test Loss: 1.776 Test Acc: 0.517
Validation loss decreased (-0.499982 --> -0.516649).  Saving model ...
Epoch: 11 cost time: 5.821544170379639
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.764 Vali Acc: 0.533 Test Loss: 1.764 Test Acc: 0.533
Validation loss decreased (-0.516649 --> -0.533316).  Saving model ...
Epoch: 12 cost time: 5.622091770172119
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.540 Test Loss: 1.742 Test Acc: 0.540
Validation loss decreased (-0.533316 --> -0.539983).  Saving model ...
Epoch: 13 cost time: 5.7084033489227295
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.716 Vali Acc: 0.553 Test Loss: 1.716 Test Acc: 0.553
Validation loss decreased (-0.539983 --> -0.553316).  Saving model ...
Epoch: 14 cost time: 5.660604000091553
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.701 Vali Acc: 0.570 Test Loss: 1.701 Test Acc: 0.570
Validation loss decreased (-0.553316 --> -0.569983).  Saving model ...
Epoch: 15 cost time: 5.844913721084595
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.570 Test Loss: 1.691 Test Acc: 0.570
Validation loss decreased (-0.569983 --> -0.569983).  Saving model ...
Epoch: 16 cost time: 5.467308044433594
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.667 Vali Acc: 0.580 Test Loss: 1.667 Test Acc: 0.580
Validation loss decreased (-0.569983 --> -0.579983).  Saving model ...
Epoch: 17 cost time: 5.2453107833862305
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.656 Vali Acc: 0.593 Test Loss: 1.656 Test Acc: 0.593
Validation loss decreased (-0.579983 --> -0.593317).  Saving model ...
Epoch: 18 cost time: 5.4105000495910645
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.650 Vali Acc: 0.597 Test Loss: 1.650 Test Acc: 0.597
Validation loss decreased (-0.593317 --> -0.596650).  Saving model ...
Epoch: 19 cost time: 5.348526954650879
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.597 Test Loss: 1.640 Test Acc: 0.597
Validation loss decreased (-0.596650 --> -0.596650).  Saving model ...
Epoch: 20 cost time: 5.497197151184082
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.603 Test Loss: 1.631 Test Acc: 0.603
Validation loss decreased (-0.596650 --> -0.603317).  Saving model ...
Epoch: 21 cost time: 5.761670827865601
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.615 Vali Acc: 0.607 Test Loss: 1.615 Test Acc: 0.607
Validation loss decreased (-0.603317 --> -0.606651).  Saving model ...
Epoch: 22 cost time: 5.679247140884399
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.600 Test Loss: 1.609 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.663351535797119
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.600 Test Loss: 1.601 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.679714679718018
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.594 Vali Acc: 0.613 Test Loss: 1.594 Test Acc: 0.613
Validation loss decreased (-0.606651 --> -0.613317).  Saving model ...
Epoch: 25 cost time: 5.416208982467651
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.589 Vali Acc: 0.613 Test Loss: 1.589 Test Acc: 0.613
Validation loss decreased (-0.613317 --> -0.613317).  Saving model ...
Epoch: 26 cost time: 5.425493001937866
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.623 Test Loss: 1.579 Test Acc: 0.623
Validation loss decreased (-0.613317 --> -0.623318).  Saving model ...
Epoch: 27 cost time: 5.472203254699707
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.623 Test Loss: 1.573 Test Acc: 0.623
Validation loss decreased (-0.623318 --> -0.623318).  Saving model ...
Epoch: 28 cost time: 5.284147024154663
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.627 Test Loss: 1.566 Test Acc: 0.627
Validation loss decreased (-0.623318 --> -0.626651).  Saving model ...
Epoch: 29 cost time: 5.422780275344849
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.627 Test Loss: 1.559 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 30 cost time: 5.620319366455078
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.623 Test Loss: 1.559 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.485165596008301
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.623 Test Loss: 1.562 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.4355549812316895
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.563 Vali Acc: 0.630 Test Loss: 1.563 Test Acc: 0.630
Validation loss decreased (-0.626651 --> -0.629984).  Saving model ...
Epoch: 33 cost time: 5.64275860786438
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.555 Vali Acc: 0.633 Test Loss: 1.555 Test Acc: 0.633
Validation loss decreased (-0.629984 --> -0.633318).  Saving model ...
Epoch: 34 cost time: 5.221034526824951
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.546 Vali Acc: 0.633 Test Loss: 1.546 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633318).  Saving model ...
Epoch: 35 cost time: 5.350409746170044
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.544 Vali Acc: 0.633 Test Loss: 1.544 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633318).  Saving model ...
Epoch: 36 cost time: 5.426751613616943
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.633 Test Loss: 1.541 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633318).  Saving model ...
Epoch: 37 cost time: 5.378312349319458
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.633 Test Loss: 1.536 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633318).  Saving model ...
Epoch: 38 cost time: 5.52287220954895
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.637 Test Loss: 1.535 Test Acc: 0.637
Validation loss decreased (-0.633318 --> -0.636651).  Saving model ...
Epoch: 39 cost time: 5.644531965255737
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.640 Test Loss: 1.528 Test Acc: 0.640
Validation loss decreased (-0.636651 --> -0.639985).  Saving model ...
Epoch: 40 cost time: 5.572211980819702
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.640 Test Loss: 1.526 Test Acc: 0.640
Validation loss decreased (-0.639985 --> -0.639985).  Saving model ...
Epoch: 41 cost time: 5.404664993286133
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.640 Test Loss: 1.523 Test Acc: 0.640
Validation loss decreased (-0.639985 --> -0.639985).  Saving model ...
Epoch: 42 cost time: 5.366311550140381
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.640 Test Loss: 1.523 Test Acc: 0.640
Validation loss decreased (-0.639985 --> -0.639985).  Saving model ...
Epoch: 43 cost time: 5.562007904052734
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.640 Test Loss: 1.520 Test Acc: 0.640
Validation loss decreased (-0.639985 --> -0.639985).  Saving model ...
Epoch: 44 cost time: 5.221927642822266
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.640 Test Loss: 1.517 Test Acc: 0.640
Validation loss decreased (-0.639985 --> -0.639985).  Saving model ...
Epoch: 45 cost time: 5.116718769073486
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.640 Test Loss: 1.513 Test Acc: 0.640
Validation loss decreased (-0.639985 --> -0.639985).  Saving model ...
Epoch: 46 cost time: 5.4152891635894775
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.650 Test Loss: 1.507 Test Acc: 0.650
Validation loss decreased (-0.639985 --> -0.649985).  Saving model ...
Epoch: 47 cost time: 5.366374969482422
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.650 Test Loss: 1.506 Test Acc: 0.650
Validation loss decreased (-0.649985 --> -0.649985).  Saving model ...
Epoch: 48 cost time: 5.512104272842407
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.647 Test Loss: 1.504 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.422644853591919
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.647 Test Loss: 1.504 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 5.530364274978638
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.643 Test Loss: 1.503 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 5.51888370513916
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.643 Test Loss: 1.500 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 5.522071123123169
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.498 Vali Acc: 0.650 Test Loss: 1.498 Test Acc: 0.650
Validation loss decreased (-0.649985 --> -0.649985).  Saving model ...
Epoch: 53 cost time: 5.430450201034546
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.498 Vali Acc: 0.650 Test Loss: 1.498 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.492023944854736
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.650 Test Loss: 1.497 Test Acc: 0.650
Validation loss decreased (-0.649985 --> -0.649985).  Saving model ...
Epoch: 55 cost time: 5.225365877151489
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.653 Test Loss: 1.496 Test Acc: 0.653
Validation loss decreased (-0.649985 --> -0.653318).  Saving model ...
Epoch: 56 cost time: 5.994326829910278
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.650 Test Loss: 1.494 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.379703044891357
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.491 Vali Acc: 0.650 Test Loss: 1.491 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 5.638211727142334
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.653 Test Loss: 1.488 Test Acc: 0.653
Validation loss decreased (-0.653318 --> -0.653318).  Saving model ...
Epoch: 59 cost time: 5.198312044143677
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.657 Test Loss: 1.485 Test Acc: 0.657
Validation loss decreased (-0.653318 --> -0.656652).  Saving model ...
Epoch: 60 cost time: 5.500473260879517
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.660 Test Loss: 1.481 Test Acc: 0.660
Validation loss decreased (-0.656652 --> -0.659985).  Saving model ...
Epoch: 61 cost time: 5.21672797203064
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.660 Test Loss: 1.477 Test Acc: 0.660
Validation loss decreased (-0.659985 --> -0.659985).  Saving model ...
Epoch: 62 cost time: 5.498461484909058
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.657 Test Loss: 1.479 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 5.631880283355713
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.657 Test Loss: 1.480 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 5.60868239402771
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.653 Test Loss: 1.480 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 5.553623914718628
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.660 Test Loss: 1.481 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 5.614128589630127
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.667 Test Loss: 1.479 Test Acc: 0.667
Validation loss decreased (-0.659985 --> -0.666652).  Saving model ...
Epoch: 67 cost time: 5.471299648284912
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.667 Test Loss: 1.477 Test Acc: 0.667
Validation loss decreased (-0.666652 --> -0.666652).  Saving model ...
Epoch: 68 cost time: 5.498874664306641
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.673 Test Loss: 1.477 Test Acc: 0.673
Validation loss decreased (-0.666652 --> -0.673319).  Saving model ...
Epoch: 69 cost time: 5.216227054595947
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.670 Test Loss: 1.478 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 5.121114730834961
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.667 Test Loss: 1.478 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 5.364512205123901
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.673 Test Loss: 1.478 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 5.183271408081055
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.673 Test Loss: 1.476 Test Acc: 0.673
Validation loss decreased (-0.673319 --> -0.673319).  Saving model ...
Epoch: 73 cost time: 5.434773683547974
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.475 Vali Acc: 0.673 Test Loss: 1.475 Test Acc: 0.673
Validation loss decreased (-0.673319 --> -0.673319).  Saving model ...
Epoch: 74 cost time: 5.398244142532349
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.475 Vali Acc: 0.677 Test Loss: 1.475 Test Acc: 0.677
Validation loss decreased (-0.673319 --> -0.676652).  Saving model ...
Epoch: 75 cost time: 5.476410627365112
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.474 Vali Acc: 0.677 Test Loss: 1.474 Test Acc: 0.677
Validation loss decreased (-0.676652 --> -0.676652).  Saving model ...
Epoch: 76 cost time: 5.254505634307861
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.680 Test Loss: 1.473 Test Acc: 0.680
Validation loss decreased (-0.676652 --> -0.679985).  Saving model ...
Epoch: 77 cost time: 5.32501745223999
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.677 Test Loss: 1.472 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.771412372589111
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.680 Test Loss: 1.473 Test Acc: 0.680
Validation loss decreased (-0.679985 --> -0.679985).  Saving model ...
Epoch: 79 cost time: 5.376462459564209
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.680 Test Loss: 1.471 Test Acc: 0.680
Validation loss decreased (-0.679985 --> -0.679985).  Saving model ...
Epoch: 80 cost time: 5.335641622543335
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.680 Test Loss: 1.470 Test Acc: 0.680
Validation loss decreased (-0.679985 --> -0.679985).  Saving model ...
Epoch: 81 cost time: 5.802124977111816
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.680 Test Loss: 1.468 Test Acc: 0.680
Validation loss decreased (-0.679985 --> -0.679985).  Saving model ...
Epoch: 82 cost time: 5.791120529174805
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.680 Test Loss: 1.471 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 5.3538079261779785
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.474 Vali Acc: 0.680 Test Loss: 1.474 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 5.607203006744385
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.680 Test Loss: 1.472 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 5.563518047332764
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.680 Test Loss: 1.470 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 5.1369946002960205
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.680 Test Loss: 1.473 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 5.168132066726685
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.677 Test Loss: 1.471 Test Acc: 0.677
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 5.339807033538818
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.680 Test Loss: 1.469 Test Acc: 0.680
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 5.249024152755737
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.680 Test Loss: 1.467 Test Acc: 0.680
Validation loss decreased (-0.679985 --> -0.679985).  Saving model ...
Epoch: 90 cost time: 5.450622797012329
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.465 Vali Acc: 0.683 Test Loss: 1.465 Test Acc: 0.683
Validation loss decreased (-0.679985 --> -0.683319).  Saving model ...
Epoch: 91 cost time: 5.510226726531982
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.690 Test Loss: 1.467 Test Acc: 0.690
Validation loss decreased (-0.683319 --> -0.689985).  Saving model ...
Epoch: 92 cost time: 5.687164306640625
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.690 Test Loss: 1.468 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 5.3050713539123535
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.683 Test Loss: 1.469 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 5.777397632598877
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.683 Test Loss: 1.469 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 5.715877294540405
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.683 Test Loss: 1.469 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 5.19329309463501
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.683 Test Loss: 1.470 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 5.425156831741333
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.680 Test Loss: 1.468 Test Acc: 0.680
EarlyStopping counter: 6 out of 10
Epoch: 98 cost time: 5.542001962661743
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.680 Test Loss: 1.469 Test Acc: 0.680
EarlyStopping counter: 7 out of 10
Epoch: 99 cost time: 5.309832572937012
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.680 Test Loss: 1.469 Test Acc: 0.680
EarlyStopping counter: 8 out of 10
Epoch: 100 cost time: 5.406437158584595
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.680 Test Loss: 1.469 Test Acc: 0.680
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.69
model parameter : 12761113
model size : 68.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.465010643005371
Epoch: 1, Steps: 18 | Train Loss: 3.214 Vali Loss: 3.112 Vali Acc: 0.083 Test Loss: 3.112 Test Acc: 0.083
Validation loss decreased (inf --> -0.083302).  Saving model ...
Epoch: 2 cost time: 5.860093593597412
Epoch: 2, Steps: 18 | Train Loss: 1.497 Vali Loss: 2.770 Vali Acc: 0.200 Test Loss: 2.770 Test Acc: 0.200
Validation loss decreased (-0.083302 --> -0.199972).  Saving model ...
Epoch: 3 cost time: 6.137178182601929
Epoch: 3, Steps: 18 | Train Loss: 0.236 Vali Loss: 2.643 Vali Acc: 0.227 Test Loss: 2.643 Test Acc: 0.227
Validation loss decreased (-0.199972 --> -0.226640).  Saving model ...
Epoch: 4 cost time: 5.928457260131836
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 2.771 Vali Acc: 0.243 Test Loss: 2.771 Test Acc: 0.243
Validation loss decreased (-0.226640 --> -0.243306).  Saving model ...
Epoch: 5 cost time: 5.556321382522583
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.543 Vali Acc: 0.317 Test Loss: 2.543 Test Acc: 0.317
Validation loss decreased (-0.243306 --> -0.316641).  Saving model ...
Epoch: 6 cost time: 5.722568035125732
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.507 Vali Acc: 0.317 Test Loss: 2.507 Test Acc: 0.317
Validation loss decreased (-0.316641 --> -0.316642).  Saving model ...
Epoch: 7 cost time: 5.464777946472168
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.349 Vali Acc: 0.333 Test Loss: 2.349 Test Acc: 0.333
Validation loss decreased (-0.316642 --> -0.333310).  Saving model ...
Epoch: 8 cost time: 5.9281165599823
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.211 Vali Acc: 0.370 Test Loss: 2.211 Test Acc: 0.370
Validation loss decreased (-0.333310 --> -0.369978).  Saving model ...
Epoch: 9 cost time: 5.4833056926727295
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.172 Vali Acc: 0.393 Test Loss: 2.172 Test Acc: 0.393
Validation loss decreased (-0.369978 --> -0.393312).  Saving model ...
Epoch: 10 cost time: 5.7580695152282715
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.158 Vali Acc: 0.410 Test Loss: 2.158 Test Acc: 0.410
Validation loss decreased (-0.393312 --> -0.409978).  Saving model ...
Epoch: 11 cost time: 5.771779298782349
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.132 Vali Acc: 0.427 Test Loss: 2.132 Test Acc: 0.427
Validation loss decreased (-0.409978 --> -0.426645).  Saving model ...
Epoch: 12 cost time: 5.489759683609009
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.107 Vali Acc: 0.430 Test Loss: 2.107 Test Acc: 0.430
Validation loss decreased (-0.426645 --> -0.429979).  Saving model ...
Epoch: 13 cost time: 6.039868116378784
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.068 Vali Acc: 0.447 Test Loss: 2.068 Test Acc: 0.447
Validation loss decreased (-0.429979 --> -0.446646).  Saving model ...
Epoch: 14 cost time: 5.3752360343933105
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.043 Vali Acc: 0.453 Test Loss: 2.043 Test Acc: 0.453
Validation loss decreased (-0.446646 --> -0.453313).  Saving model ...
Epoch: 15 cost time: 5.759961843490601
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.018 Vali Acc: 0.467 Test Loss: 2.018 Test Acc: 0.467
Validation loss decreased (-0.453313 --> -0.466646).  Saving model ...
Epoch: 16 cost time: 5.820380210876465
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.982 Vali Acc: 0.477 Test Loss: 1.982 Test Acc: 0.477
Validation loss decreased (-0.466646 --> -0.476647).  Saving model ...
Epoch: 17 cost time: 6.040532112121582
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.970 Vali Acc: 0.480 Test Loss: 1.970 Test Acc: 0.480
Validation loss decreased (-0.476647 --> -0.479980).  Saving model ...
Epoch: 18 cost time: 5.6896443367004395
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.961 Vali Acc: 0.483 Test Loss: 1.961 Test Acc: 0.483
Validation loss decreased (-0.479980 --> -0.483314).  Saving model ...
Epoch: 19 cost time: 6.240249872207642
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.944 Vali Acc: 0.483 Test Loss: 1.944 Test Acc: 0.483
Validation loss decreased (-0.483314 --> -0.483314).  Saving model ...
Epoch: 20 cost time: 5.850701093673706
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.922 Vali Acc: 0.493 Test Loss: 1.922 Test Acc: 0.493
Validation loss decreased (-0.483314 --> -0.493314).  Saving model ...
Epoch: 21 cost time: 6.248081684112549
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.899 Vali Acc: 0.510 Test Loss: 1.899 Test Acc: 0.510
Validation loss decreased (-0.493314 --> -0.509981).  Saving model ...
Epoch: 22 cost time: 5.532513380050659
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.892 Vali Acc: 0.507 Test Loss: 1.892 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.675499200820923
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.878 Vali Acc: 0.507 Test Loss: 1.878 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.441632270812988
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.877 Vali Acc: 0.507 Test Loss: 1.877 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.760377645492554
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.865 Vali Acc: 0.507 Test Loss: 1.865 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.413518667221069
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.852 Vali Acc: 0.517 Test Loss: 1.852 Test Acc: 0.517
Validation loss decreased (-0.509981 --> -0.516648).  Saving model ...
Epoch: 27 cost time: 5.763498544692993
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.841 Vali Acc: 0.520 Test Loss: 1.841 Test Acc: 0.520
Validation loss decreased (-0.516648 --> -0.519982).  Saving model ...
Epoch: 28 cost time: 5.9897284507751465
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.832 Vali Acc: 0.527 Test Loss: 1.832 Test Acc: 0.527
Validation loss decreased (-0.519982 --> -0.526648).  Saving model ...
Epoch: 29 cost time: 5.968578100204468
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.530 Test Loss: 1.818 Test Acc: 0.530
Validation loss decreased (-0.526648 --> -0.529982).  Saving model ...
Epoch: 30 cost time: 5.8661816120147705
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.817 Vali Acc: 0.527 Test Loss: 1.817 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.457112073898315
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.810 Vali Acc: 0.537 Test Loss: 1.810 Test Acc: 0.537
Validation loss decreased (-0.529982 --> -0.536649).  Saving model ...
Epoch: 32 cost time: 5.4350266456604
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.537 Test Loss: 1.802 Test Acc: 0.537
Validation loss decreased (-0.536649 --> -0.536649).  Saving model ...
Epoch: 33 cost time: 5.268017530441284
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.797 Vali Acc: 0.540 Test Loss: 1.797 Test Acc: 0.540
Validation loss decreased (-0.536649 --> -0.539982).  Saving model ...
Epoch: 34 cost time: 5.211379528045654
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.537 Test Loss: 1.791 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.210330486297607
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.537 Test Loss: 1.786 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.537838697433472
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.774 Vali Acc: 0.547 Test Loss: 1.774 Test Acc: 0.547
Validation loss decreased (-0.539982 --> -0.546649).  Saving model ...
Epoch: 37 cost time: 5.526813745498657
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.769 Vali Acc: 0.550 Test Loss: 1.769 Test Acc: 0.550
Validation loss decreased (-0.546649 --> -0.549982).  Saving model ...
Epoch: 38 cost time: 5.646368026733398
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.765 Vali Acc: 0.550 Test Loss: 1.765 Test Acc: 0.550
Validation loss decreased (-0.549982 --> -0.549982).  Saving model ...
Epoch: 39 cost time: 6.003069877624512
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.547 Test Loss: 1.760 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.432472467422485
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.550 Test Loss: 1.756 Test Acc: 0.550
Validation loss decreased (-0.549982 --> -0.549982).  Saving model ...
Epoch: 41 cost time: 5.617488622665405
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.560 Test Loss: 1.749 Test Acc: 0.560
Validation loss decreased (-0.549982 --> -0.559983).  Saving model ...
Epoch: 42 cost time: 5.477399826049805
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.744 Vali Acc: 0.560 Test Loss: 1.744 Test Acc: 0.560
Validation loss decreased (-0.559983 --> -0.559983).  Saving model ...
Epoch: 43 cost time: 5.5312230587005615
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.736 Vali Acc: 0.573 Test Loss: 1.736 Test Acc: 0.573
Validation loss decreased (-0.559983 --> -0.573316).  Saving model ...
Epoch: 44 cost time: 5.934674263000488
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.730 Vali Acc: 0.567 Test Loss: 1.730 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.371774911880493
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.577 Test Loss: 1.727 Test Acc: 0.577
Validation loss decreased (-0.573316 --> -0.576649).  Saving model ...
Epoch: 46 cost time: 5.7284629344940186
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.573 Test Loss: 1.721 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.8388590812683105
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.577 Test Loss: 1.715 Test Acc: 0.577
Validation loss decreased (-0.576649 --> -0.576650).  Saving model ...
Epoch: 48 cost time: 5.9525306224823
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.711 Vali Acc: 0.580 Test Loss: 1.711 Test Acc: 0.580
Validation loss decreased (-0.576650 --> -0.579983).  Saving model ...
Epoch: 49 cost time: 5.428245306015015
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.710 Vali Acc: 0.577 Test Loss: 1.710 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.657573461532593
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.708 Vali Acc: 0.577 Test Loss: 1.708 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 6.022187232971191
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.583 Test Loss: 1.706 Test Acc: 0.583
Validation loss decreased (-0.579983 --> -0.583316).  Saving model ...
Epoch: 52 cost time: 5.922947406768799
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.590 Test Loss: 1.700 Test Acc: 0.590
Validation loss decreased (-0.583316 --> -0.589983).  Saving model ...
Epoch: 53 cost time: 5.945914268493652
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.693 Vali Acc: 0.590 Test Loss: 1.693 Test Acc: 0.590
Validation loss decreased (-0.589983 --> -0.589983).  Saving model ...
Epoch: 54 cost time: 5.998855829238892
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.590 Test Loss: 1.689 Test Acc: 0.590
Validation loss decreased (-0.589983 --> -0.589983).  Saving model ...
Epoch: 55 cost time: 6.30823278427124
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.597 Test Loss: 1.685 Test Acc: 0.597
Validation loss decreased (-0.589983 --> -0.596650).  Saving model ...
Epoch: 56 cost time: 5.8986029624938965
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.682 Vali Acc: 0.597 Test Loss: 1.682 Test Acc: 0.597
Validation loss decreased (-0.596650 --> -0.596650).  Saving model ...
Epoch: 57 cost time: 5.86398458480835
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.679 Vali Acc: 0.610 Test Loss: 1.679 Test Acc: 0.610
Validation loss decreased (-0.596650 --> -0.609983).  Saving model ...
Epoch: 58 cost time: 5.3704774379730225
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.675 Vali Acc: 0.597 Test Loss: 1.675 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 5.501210689544678
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.674 Vali Acc: 0.597 Test Loss: 1.674 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 5.8589160442352295
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.671 Vali Acc: 0.617 Test Loss: 1.671 Test Acc: 0.617
Validation loss decreased (-0.609983 --> -0.616650).  Saving model ...
Epoch: 61 cost time: 5.639135360717773
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.668 Vali Acc: 0.617 Test Loss: 1.668 Test Acc: 0.617
Validation loss decreased (-0.616650 --> -0.616650).  Saving model ...
Epoch: 62 cost time: 5.716254234313965
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.665 Vali Acc: 0.617 Test Loss: 1.665 Test Acc: 0.617
Validation loss decreased (-0.616650 --> -0.616650).  Saving model ...
Epoch: 63 cost time: 6.29956579208374
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.660 Vali Acc: 0.620 Test Loss: 1.660 Test Acc: 0.620
Validation loss decreased (-0.616650 --> -0.619983).  Saving model ...
Epoch: 64 cost time: 5.793993234634399
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.664 Vali Acc: 0.620 Test Loss: 1.664 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 5.931673526763916
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.662 Vali Acc: 0.620 Test Loss: 1.662 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 5.586360692977905
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.656 Vali Acc: 0.623 Test Loss: 1.656 Test Acc: 0.623
Validation loss decreased (-0.619983 --> -0.623317).  Saving model ...
Epoch: 67 cost time: 5.533292770385742
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.649 Vali Acc: 0.623 Test Loss: 1.649 Test Acc: 0.623
Validation loss decreased (-0.623317 --> -0.623317).  Saving model ...
Epoch: 68 cost time: 5.5238871574401855
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.652 Vali Acc: 0.627 Test Loss: 1.652 Test Acc: 0.627
Validation loss decreased (-0.623317 --> -0.626650).  Saving model ...
Epoch: 69 cost time: 5.490509510040283
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.651 Vali Acc: 0.623 Test Loss: 1.651 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 5.470430374145508
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.652 Vali Acc: 0.633 Test Loss: 1.652 Test Acc: 0.633
Validation loss decreased (-0.626650 --> -0.633317).  Saving model ...
Epoch: 71 cost time: 5.567150115966797
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.633 Test Loss: 1.647 Test Acc: 0.633
Validation loss decreased (-0.633317 --> -0.633317).  Saving model ...
Epoch: 72 cost time: 5.8704986572265625
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.637 Test Loss: 1.645 Test Acc: 0.637
Validation loss decreased (-0.633317 --> -0.636650).  Saving model ...
Epoch: 73 cost time: 5.947084188461304
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.637 Test Loss: 1.645 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 5.681965589523315
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.640 Test Loss: 1.643 Test Acc: 0.640
Validation loss decreased (-0.636650 --> -0.639984).  Saving model ...
Epoch: 75 cost time: 5.402597188949585
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.638 Vali Acc: 0.643 Test Loss: 1.638 Test Acc: 0.643
Validation loss decreased (-0.639984 --> -0.643317).  Saving model ...
Epoch: 76 cost time: 5.687541484832764
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.636 Vali Acc: 0.640 Test Loss: 1.636 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 5.705171823501587
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.637 Test Loss: 1.633 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 5.556349754333496
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.640 Test Loss: 1.633 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 5.5713372230529785
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.629 Vali Acc: 0.640 Test Loss: 1.629 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 6.353691577911377
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.640 Test Loss: 1.628 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 6.150614976882935
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.640 Test Loss: 1.627 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 5.684919357299805
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.643 Test Loss: 1.624 Test Acc: 0.643
Validation loss decreased (-0.643317 --> -0.643317).  Saving model ...
Epoch: 83 cost time: 5.25704550743103
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.647 Test Loss: 1.625 Test Acc: 0.647
Validation loss decreased (-0.643317 --> -0.646650).  Saving model ...
Epoch: 84 cost time: 5.512218952178955
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.647 Test Loss: 1.624 Test Acc: 0.647
Validation loss decreased (-0.646650 --> -0.646650).  Saving model ...
Epoch: 85 cost time: 5.611255168914795
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.623 Vali Acc: 0.647 Test Loss: 1.623 Test Acc: 0.647
Validation loss decreased (-0.646650 --> -0.646650).  Saving model ...
Epoch: 86 cost time: 5.481807708740234
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.622 Vali Acc: 0.647 Test Loss: 1.622 Test Acc: 0.647
Validation loss decreased (-0.646650 --> -0.646650).  Saving model ...
Epoch: 87 cost time: 5.366207122802734
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.647 Test Loss: 1.620 Test Acc: 0.647
Validation loss decreased (-0.646650 --> -0.646650).  Saving model ...
Epoch: 88 cost time: 5.596758127212524
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.647 Test Loss: 1.620 Test Acc: 0.647
Validation loss decreased (-0.646650 --> -0.646650).  Saving model ...
Epoch: 89 cost time: 5.833827257156372
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.647 Test Loss: 1.619 Test Acc: 0.647
Validation loss decreased (-0.646650 --> -0.646650).  Saving model ...
Epoch: 90 cost time: 5.634891510009766
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.647 Test Loss: 1.616 Test Acc: 0.647
Validation loss decreased (-0.646650 --> -0.646651).  Saving model ...
Epoch: 91 cost time: 5.6649489402771
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.650 Test Loss: 1.616 Test Acc: 0.650
Validation loss decreased (-0.646651 --> -0.649984).  Saving model ...
Epoch: 92 cost time: 5.76689338684082
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.647 Test Loss: 1.614 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 5.484555959701538
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.650 Test Loss: 1.612 Test Acc: 0.650
Validation loss decreased (-0.649984 --> -0.649984).  Saving model ...
Epoch: 94 cost time: 5.609547138214111
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.650 Test Loss: 1.611 Test Acc: 0.650
Validation loss decreased (-0.649984 --> -0.649984).  Saving model ...
Epoch: 95 cost time: 5.802430152893066
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.653 Test Loss: 1.612 Test Acc: 0.653
Validation loss decreased (-0.649984 --> -0.653317).  Saving model ...
Epoch: 96 cost time: 5.38556694984436
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.657 Test Loss: 1.611 Test Acc: 0.657
Validation loss decreased (-0.653317 --> -0.656651).  Saving model ...
Epoch: 97 cost time: 5.545577526092529
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.657 Test Loss: 1.608 Test Acc: 0.657
Validation loss decreased (-0.656651 --> -0.656651).  Saving model ...
Epoch: 98 cost time: 5.916095018386841
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.657 Test Loss: 1.606 Test Acc: 0.657
Validation loss decreased (-0.656651 --> -0.656651).  Saving model ...
Epoch: 99 cost time: 6.023487567901611
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.657 Test Loss: 1.605 Test Acc: 0.657
Validation loss decreased (-0.656651 --> -0.656651).  Saving model ...
Epoch: 100 cost time: 5.721058368682861
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.657 Test Loss: 1.605 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6566666666666666
model parameter : 12761113
model size : 68.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.524017333984375
Epoch: 1, Steps: 18 | Train Loss: 3.218 Vali Loss: 3.076 Vali Acc: 0.083 Test Loss: 3.076 Test Acc: 0.083
Validation loss decreased (inf --> -0.083303).  Saving model ...
Epoch: 2 cost time: 5.486030340194702
Epoch: 2, Steps: 18 | Train Loss: 1.703 Vali Loss: 2.613 Vali Acc: 0.223 Test Loss: 2.613 Test Acc: 0.223
Validation loss decreased (-0.083303 --> -0.223307).  Saving model ...
Epoch: 3 cost time: 5.560343265533447
Epoch: 3, Steps: 18 | Train Loss: 0.370 Vali Loss: 2.320 Vali Acc: 0.310 Test Loss: 2.320 Test Acc: 0.310
Validation loss decreased (-0.223307 --> -0.309977).  Saving model ...
Epoch: 4 cost time: 5.509817123413086
Epoch: 4, Steps: 18 | Train Loss: 0.044 Vali Loss: 2.455 Vali Acc: 0.347 Test Loss: 2.455 Test Acc: 0.347
Validation loss decreased (-0.309977 --> -0.346642).  Saving model ...
Epoch: 5 cost time: 5.331826448440552
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.029 Vali Acc: 0.403 Test Loss: 2.029 Test Acc: 0.403
Validation loss decreased (-0.346642 --> -0.403313).  Saving model ...
Epoch: 6 cost time: 6.372788667678833
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.950 Vali Acc: 0.443 Test Loss: 1.950 Test Acc: 0.443
Validation loss decreased (-0.403313 --> -0.443314).  Saving model ...
Epoch: 7 cost time: 5.370838642120361
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.905 Vali Acc: 0.450 Test Loss: 1.905 Test Acc: 0.450
Validation loss decreased (-0.443314 --> -0.449981).  Saving model ...
Epoch: 8 cost time: 5.7613091468811035
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.493 Test Loss: 1.779 Test Acc: 0.493
Validation loss decreased (-0.449981 --> -0.493316).  Saving model ...
Epoch: 9 cost time: 5.540623664855957
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.754 Vali Acc: 0.490 Test Loss: 1.754 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.239120244979858
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.750 Vali Acc: 0.500 Test Loss: 1.750 Test Acc: 0.500
Validation loss decreased (-0.493316 --> -0.499982).  Saving model ...
Epoch: 11 cost time: 5.464412212371826
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.725 Vali Acc: 0.530 Test Loss: 1.725 Test Acc: 0.530
Validation loss decreased (-0.499982 --> -0.529983).  Saving model ...
Epoch: 12 cost time: 5.607617616653442
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.680 Vali Acc: 0.530 Test Loss: 1.680 Test Acc: 0.530
Validation loss decreased (-0.529983 --> -0.529983).  Saving model ...
Epoch: 13 cost time: 5.670890808105469
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.550 Test Loss: 1.643 Test Acc: 0.550
Validation loss decreased (-0.529983 --> -0.549984).  Saving model ...
Epoch: 14 cost time: 5.896832704544067
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.560 Test Loss: 1.608 Test Acc: 0.560
Validation loss decreased (-0.549984 --> -0.559984).  Saving model ...
Epoch: 15 cost time: 5.61514687538147
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.568 Vali Acc: 0.583 Test Loss: 1.568 Test Acc: 0.583
Validation loss decreased (-0.559984 --> -0.583318).  Saving model ...
Epoch: 16 cost time: 5.515896797180176
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.593 Test Loss: 1.554 Test Acc: 0.593
Validation loss decreased (-0.583318 --> -0.593318).  Saving model ...
Epoch: 17 cost time: 5.744916677474976
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.570 Vali Acc: 0.587 Test Loss: 1.570 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.878898620605469
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.593 Test Loss: 1.553 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 19 cost time: 5.527999639511108
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.600 Test Loss: 1.541 Test Acc: 0.600
Validation loss decreased (-0.593318 --> -0.599985).  Saving model ...
Epoch: 20 cost time: 5.366279363632202
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.610 Test Loss: 1.527 Test Acc: 0.610
Validation loss decreased (-0.599985 --> -0.609985).  Saving model ...
Epoch: 21 cost time: 5.90729284286499
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.610 Test Loss: 1.517 Test Acc: 0.610
Validation loss decreased (-0.609985 --> -0.609985).  Saving model ...
Epoch: 22 cost time: 5.943769216537476
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.603 Test Loss: 1.516 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.900691986083984
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.623 Test Loss: 1.496 Test Acc: 0.623
Validation loss decreased (-0.609985 --> -0.623318).  Saving model ...
Epoch: 24 cost time: 5.374236106872559
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.491 Vali Acc: 0.617 Test Loss: 1.491 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.568434715270996
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.627 Test Loss: 1.485 Test Acc: 0.627
Validation loss decreased (-0.623318 --> -0.626652).  Saving model ...
Epoch: 26 cost time: 5.5015952587127686
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.627 Test Loss: 1.476 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 27 cost time: 5.612299919128418
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.637 Test Loss: 1.455 Test Acc: 0.637
Validation loss decreased (-0.626652 --> -0.636652).  Saving model ...
Epoch: 28 cost time: 5.35819411277771
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.633 Test Loss: 1.451 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.687097787857056
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.633 Test Loss: 1.447 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.382602214813232
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.640 Test Loss: 1.443 Test Acc: 0.640
Validation loss decreased (-0.636652 --> -0.639986).  Saving model ...
Epoch: 31 cost time: 6.119040250778198
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.640 Test Loss: 1.441 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 32 cost time: 6.0048134326934814
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.643 Test Loss: 1.434 Test Acc: 0.643
Validation loss decreased (-0.639986 --> -0.643319).  Saving model ...
Epoch: 33 cost time: 5.390442371368408
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.643 Test Loss: 1.428 Test Acc: 0.643
Validation loss decreased (-0.643319 --> -0.643319).  Saving model ...
Epoch: 34 cost time: 5.188323259353638
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.643 Test Loss: 1.427 Test Acc: 0.643
Validation loss decreased (-0.643319 --> -0.643319).  Saving model ...
Epoch: 35 cost time: 5.3384294509887695
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.647 Test Loss: 1.426 Test Acc: 0.647
Validation loss decreased (-0.643319 --> -0.646652).  Saving model ...
Epoch: 36 cost time: 5.485793113708496
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.647 Test Loss: 1.423 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 37 cost time: 5.407235860824585
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.647 Test Loss: 1.418 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 38 cost time: 5.39491868019104
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.653 Test Loss: 1.418 Test Acc: 0.653
Validation loss decreased (-0.646652 --> -0.653319).  Saving model ...
Epoch: 39 cost time: 5.809524774551392
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.660 Test Loss: 1.413 Test Acc: 0.660
Validation loss decreased (-0.653319 --> -0.659986).  Saving model ...
Epoch: 40 cost time: 5.891186952590942
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.663 Test Loss: 1.405 Test Acc: 0.663
Validation loss decreased (-0.659986 --> -0.663319).  Saving model ...
Epoch: 41 cost time: 5.944387197494507
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.670 Test Loss: 1.403 Test Acc: 0.670
Validation loss decreased (-0.663319 --> -0.669986).  Saving model ...
Epoch: 42 cost time: 5.686046123504639
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.402 Vali Acc: 0.673 Test Loss: 1.402 Test Acc: 0.673
Validation loss decreased (-0.669986 --> -0.673319).  Saving model ...
Epoch: 43 cost time: 5.782681703567505
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.683 Test Loss: 1.398 Test Acc: 0.683
Validation loss decreased (-0.673319 --> -0.683319).  Saving model ...
Epoch: 44 cost time: 5.716951608657837
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.687 Test Loss: 1.398 Test Acc: 0.687
Validation loss decreased (-0.683319 --> -0.686653).  Saving model ...
Epoch: 45 cost time: 5.548424243927002
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.687 Test Loss: 1.395 Test Acc: 0.687
Validation loss decreased (-0.686653 --> -0.686653).  Saving model ...
Epoch: 46 cost time: 5.682907342910767
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.680 Test Loss: 1.395 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.6656084060668945
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.680 Test Loss: 1.391 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 5.6798255443573
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.680 Test Loss: 1.390 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 5.562937259674072
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.683 Test Loss: 1.389 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 5.2555155754089355
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.683 Test Loss: 1.386 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 5.245870351791382
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.683 Test Loss: 1.382 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 5.526222229003906
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.379 Vali Acc: 0.687 Test Loss: 1.379 Test Acc: 0.687
Validation loss decreased (-0.686653 --> -0.686653).  Saving model ...
Epoch: 53 cost time: 5.962595462799072
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.378 Vali Acc: 0.687 Test Loss: 1.378 Test Acc: 0.687
Validation loss decreased (-0.686653 --> -0.686653).  Saving model ...
Epoch: 54 cost time: 5.403770208358765
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.683 Test Loss: 1.380 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.155439138412476
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.693 Test Loss: 1.376 Test Acc: 0.693
Validation loss decreased (-0.686653 --> -0.693320).  Saving model ...
Epoch: 56 cost time: 5.875329256057739
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.690 Test Loss: 1.376 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.957643270492554
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.697 Test Loss: 1.374 Test Acc: 0.697
Validation loss decreased (-0.693320 --> -0.696653).  Saving model ...
Epoch: 58 cost time: 5.911876916885376
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.693 Test Loss: 1.371 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 5.75673770904541
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.690 Test Loss: 1.370 Test Acc: 0.690
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 5.588501214981079
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.693 Test Loss: 1.371 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 5.569217205047607
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.693 Test Loss: 1.369 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 5.474579095840454
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.693 Test Loss: 1.369 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 5.681051254272461
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.697 Test Loss: 1.370 Test Acc: 0.697
Validation loss decreased (-0.696653 --> -0.696653).  Saving model ...
Epoch: 64 cost time: 5.467575550079346
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.697 Test Loss: 1.368 Test Acc: 0.697
Validation loss decreased (-0.696653 --> -0.696653).  Saving model ...
Epoch: 65 cost time: 5.5413432121276855
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.703 Test Loss: 1.365 Test Acc: 0.703
Validation loss decreased (-0.696653 --> -0.703320).  Saving model ...
Epoch: 66 cost time: 5.309943914413452
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.703 Test Loss: 1.365 Test Acc: 0.703
Validation loss decreased (-0.703320 --> -0.703320).  Saving model ...
Epoch: 67 cost time: 5.604884386062622
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.700 Test Loss: 1.365 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 5.6425461769104
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.703 Test Loss: 1.368 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 5.856413841247559
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.703 Test Loss: 1.369 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 6.167579889297485
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.707 Test Loss: 1.369 Test Acc: 0.707
Validation loss decreased (-0.703320 --> -0.706653).  Saving model ...
Epoch: 71 cost time: 5.826287746429443
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.707 Test Loss: 1.370 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.442815542221069
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.707 Test Loss: 1.371 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 5.547524690628052
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.700 Test Loss: 1.373 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 5.66091513633728
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.707 Test Loss: 1.370 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 5.601088762283325
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.707 Test Loss: 1.367 Test Acc: 0.707
Validation loss decreased (-0.706653 --> -0.706653).  Saving model ...
Epoch: 76 cost time: 5.770604372024536
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.707 Test Loss: 1.365 Test Acc: 0.707
Validation loss decreased (-0.706653 --> -0.706653).  Saving model ...
Epoch: 77 cost time: 5.672093152999878
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.710 Test Loss: 1.369 Test Acc: 0.710
Validation loss decreased (-0.706653 --> -0.709986).  Saving model ...
Epoch: 78 cost time: 5.713206052780151
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.710 Test Loss: 1.373 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 5.319486379623413
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.707 Test Loss: 1.374 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 5.598459482192993
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.707 Test Loss: 1.374 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 5.921722650527954
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.375 Vali Acc: 0.713 Test Loss: 1.375 Test Acc: 0.713
Validation loss decreased (-0.709986 --> -0.713320).  Saving model ...
Epoch: 82 cost time: 5.714260578155518
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.378 Vali Acc: 0.710 Test Loss: 1.378 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 5.609630823135376
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.710 Test Loss: 1.381 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 5.969038009643555
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.713 Test Loss: 1.381 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 5.651129484176636
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.710 Test Loss: 1.385 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 5.749161720275879
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.710 Test Loss: 1.389 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 5.356899738311768
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.710 Test Loss: 1.387 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 5.425482273101807
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.713 Test Loss: 1.384 Test Acc: 0.713
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 5.426704406738281
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.713 Test Loss: 1.384 Test Acc: 0.713
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 5.410995006561279
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.713 Test Loss: 1.382 Test Acc: 0.713
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 5.550922155380249
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.713 Test Loss: 1.380 Test Acc: 0.713
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7133333333333334
model parameter : 12761113
model size : 68.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.7478296756744385
Epoch: 1, Steps: 18 | Train Loss: 3.263 Vali Loss: 3.122 Vali Acc: 0.080 Test Loss: 3.122 Test Acc: 0.080
Validation loss decreased (inf --> -0.079969).  Saving model ...
Epoch: 2 cost time: 5.665999412536621
Epoch: 2, Steps: 18 | Train Loss: 1.792 Vali Loss: 2.698 Vali Acc: 0.210 Test Loss: 2.698 Test Acc: 0.210
Validation loss decreased (-0.079969 --> -0.209973).  Saving model ...
Epoch: 3 cost time: 5.570820569992065
Epoch: 3, Steps: 18 | Train Loss: 0.403 Vali Loss: 2.299 Vali Acc: 0.267 Test Loss: 2.299 Test Acc: 0.267
Validation loss decreased (-0.209973 --> -0.266644).  Saving model ...
Epoch: 4 cost time: 5.140730619430542
Epoch: 4, Steps: 18 | Train Loss: 0.044 Vali Loss: 2.286 Vali Acc: 0.347 Test Loss: 2.286 Test Acc: 0.347
Validation loss decreased (-0.266644 --> -0.346644).  Saving model ...
Epoch: 5 cost time: 5.186834812164307
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.887 Vali Acc: 0.420 Test Loss: 1.887 Test Acc: 0.420
Validation loss decreased (-0.346644 --> -0.419981).  Saving model ...
Epoch: 6 cost time: 5.465467691421509
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.902 Vali Acc: 0.420 Test Loss: 1.902 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.146449089050293
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.775 Vali Acc: 0.490 Test Loss: 1.775 Test Acc: 0.490
Validation loss decreased (-0.419981 --> -0.489982).  Saving model ...
Epoch: 8 cost time: 5.396121978759766
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.681 Vali Acc: 0.507 Test Loss: 1.681 Test Acc: 0.507
Validation loss decreased (-0.489982 --> -0.506650).  Saving model ...
Epoch: 9 cost time: 5.480698347091675
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.676 Vali Acc: 0.507 Test Loss: 1.676 Test Acc: 0.507
Validation loss decreased (-0.506650 --> -0.506650).  Saving model ...
Epoch: 10 cost time: 5.581457614898682
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.662 Vali Acc: 0.493 Test Loss: 1.662 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.532907724380493
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.637 Vali Acc: 0.510 Test Loss: 1.637 Test Acc: 0.510
Validation loss decreased (-0.506650 --> -0.509984).  Saving model ...
Epoch: 12 cost time: 5.442063570022583
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.603 Vali Acc: 0.527 Test Loss: 1.603 Test Acc: 0.527
Validation loss decreased (-0.509984 --> -0.526651).  Saving model ...
Epoch: 13 cost time: 5.7888712882995605
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.550 Test Loss: 1.566 Test Acc: 0.550
Validation loss decreased (-0.526651 --> -0.549984).  Saving model ...
Epoch: 14 cost time: 5.32539176940918
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.557 Test Loss: 1.539 Test Acc: 0.557
Validation loss decreased (-0.549984 --> -0.556651).  Saving model ...
Epoch: 15 cost time: 5.538646936416626
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.567 Test Loss: 1.519 Test Acc: 0.567
Validation loss decreased (-0.556651 --> -0.566651).  Saving model ...
Epoch: 16 cost time: 5.471914291381836
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.590 Test Loss: 1.492 Test Acc: 0.590
Validation loss decreased (-0.566651 --> -0.589985).  Saving model ...
Epoch: 17 cost time: 5.7889015674591064
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.491 Vali Acc: 0.583 Test Loss: 1.491 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.731791973114014
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.597 Test Loss: 1.481 Test Acc: 0.597
Validation loss decreased (-0.589985 --> -0.596652).  Saving model ...
Epoch: 19 cost time: 5.598182201385498
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.610 Test Loss: 1.470 Test Acc: 0.610
Validation loss decreased (-0.596652 --> -0.609985).  Saving model ...
Epoch: 20 cost time: 5.402193546295166
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.613 Test Loss: 1.456 Test Acc: 0.613
Validation loss decreased (-0.609985 --> -0.613319).  Saving model ...
Epoch: 21 cost time: 5.32871675491333
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.620 Test Loss: 1.442 Test Acc: 0.620
Validation loss decreased (-0.613319 --> -0.619986).  Saving model ...
Epoch: 22 cost time: 5.167954683303833
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.627 Test Loss: 1.431 Test Acc: 0.627
Validation loss decreased (-0.619986 --> -0.626652).  Saving model ...
Epoch: 23 cost time: 5.310828447341919
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.627 Test Loss: 1.419 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 24 cost time: 5.113286018371582
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.620 Test Loss: 1.422 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.085491180419922
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.623 Test Loss: 1.410 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.4813148975372314
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.627 Test Loss: 1.398 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626653).  Saving model ...
Epoch: 27 cost time: 5.5164995193481445
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.647 Test Loss: 1.386 Test Acc: 0.647
Validation loss decreased (-0.626653 --> -0.646653).  Saving model ...
Epoch: 28 cost time: 5.714010715484619
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.650 Test Loss: 1.384 Test Acc: 0.650
Validation loss decreased (-0.646653 --> -0.649986).  Saving model ...
Epoch: 29 cost time: 5.162233114242554
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.660 Test Loss: 1.377 Test Acc: 0.660
Validation loss decreased (-0.649986 --> -0.659986).  Saving model ...
Epoch: 30 cost time: 5.153890132904053
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.657 Test Loss: 1.380 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.368241786956787
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.378 Vali Acc: 0.653 Test Loss: 1.378 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.672208547592163
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.663 Test Loss: 1.373 Test Acc: 0.663
Validation loss decreased (-0.659986 --> -0.663320).  Saving model ...
Epoch: 33 cost time: 5.344429969787598
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.667 Test Loss: 1.368 Test Acc: 0.667
Validation loss decreased (-0.663320 --> -0.666653).  Saving model ...
Epoch: 34 cost time: 5.644934415817261
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.667 Test Loss: 1.364 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
Epoch: 35 cost time: 5.502298831939697
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.670 Test Loss: 1.357 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.669986).  Saving model ...
Epoch: 36 cost time: 5.979734897613525
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.657 Test Loss: 1.356 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.585082769393921
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.660 Test Loss: 1.365 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.305049180984497
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.667 Test Loss: 1.363 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 5.88453483581543
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.677 Test Loss: 1.355 Test Acc: 0.677
Validation loss decreased (-0.669986 --> -0.676653).  Saving model ...
Epoch: 40 cost time: 5.3585288524627686
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.677 Test Loss: 1.346 Test Acc: 0.677
Validation loss decreased (-0.676653 --> -0.676653).  Saving model ...
Epoch: 41 cost time: 5.460855484008789
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.673 Test Loss: 1.344 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.914714336395264
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.680 Test Loss: 1.343 Test Acc: 0.680
Validation loss decreased (-0.676653 --> -0.679987).  Saving model ...
Epoch: 43 cost time: 6.239845275878906
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.680 Test Loss: 1.339 Test Acc: 0.680
Validation loss decreased (-0.679987 --> -0.679987).  Saving model ...
Epoch: 44 cost time: 6.007145404815674
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.677 Test Loss: 1.336 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 6.148024320602417
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.334 Vali Acc: 0.680 Test Loss: 1.334 Test Acc: 0.680
Validation loss decreased (-0.679987 --> -0.679987).  Saving model ...
Epoch: 46 cost time: 5.889430999755859
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.331 Vali Acc: 0.683 Test Loss: 1.331 Test Acc: 0.683
Validation loss decreased (-0.679987 --> -0.683320).  Saving model ...
Epoch: 47 cost time: 5.448866605758667
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.687 Test Loss: 1.328 Test Acc: 0.687
Validation loss decreased (-0.683320 --> -0.686653).  Saving model ...
Epoch: 48 cost time: 5.770330190658569
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.687 Test Loss: 1.327 Test Acc: 0.687
Validation loss decreased (-0.686653 --> -0.686653).  Saving model ...
Epoch: 49 cost time: 5.5076024532318115
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.683 Test Loss: 1.327 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.563512563705444
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.325 Vali Acc: 0.687 Test Loss: 1.325 Test Acc: 0.687
Validation loss decreased (-0.686653 --> -0.686653).  Saving model ...
Epoch: 51 cost time: 5.683649301528931
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.690 Test Loss: 1.322 Test Acc: 0.690
Validation loss decreased (-0.686653 --> -0.689987).  Saving model ...
Epoch: 52 cost time: 5.950418472290039
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.690 Test Loss: 1.321 Test Acc: 0.690
Validation loss decreased (-0.689987 --> -0.689987).  Saving model ...
Epoch: 53 cost time: 6.1329967975616455
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.690 Test Loss: 1.321 Test Acc: 0.690
Validation loss decreased (-0.689987 --> -0.689987).  Saving model ...
Epoch: 54 cost time: 5.826448440551758
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.687 Test Loss: 1.321 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.552250623703003
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.693 Test Loss: 1.320 Test Acc: 0.693
Validation loss decreased (-0.689987 --> -0.693320).  Saving model ...
Epoch: 56 cost time: 5.551573753356934
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.697 Test Loss: 1.321 Test Acc: 0.697
Validation loss decreased (-0.693320 --> -0.696653).  Saving model ...
Epoch: 57 cost time: 5.624027967453003
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.687 Test Loss: 1.320 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 5.8879430294036865
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.697 Test Loss: 1.318 Test Acc: 0.697
Validation loss decreased (-0.696653 --> -0.696653).  Saving model ...
Epoch: 59 cost time: 5.843419790267944
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.700 Test Loss: 1.319 Test Acc: 0.700
Validation loss decreased (-0.696653 --> -0.699987).  Saving model ...
Epoch: 60 cost time: 5.851961135864258
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.700 Test Loss: 1.318 Test Acc: 0.700
Validation loss decreased (-0.699987 --> -0.699987).  Saving model ...
Epoch: 61 cost time: 5.604596376419067
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.703 Test Loss: 1.316 Test Acc: 0.703
Validation loss decreased (-0.699987 --> -0.703320).  Saving model ...
Epoch: 62 cost time: 5.77983021736145
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.710 Test Loss: 1.319 Test Acc: 0.710
Validation loss decreased (-0.703320 --> -0.709987).  Saving model ...
Epoch: 63 cost time: 5.642487287521362
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.700 Test Loss: 1.317 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.986469030380249
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.697 Test Loss: 1.316 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 6.188645601272583
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.700 Test Loss: 1.314 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 6.081347465515137
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.697 Test Loss: 1.314 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 5.602328300476074
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.700 Test Loss: 1.316 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 5.896760940551758
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.700 Test Loss: 1.318 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 5.900078535079956
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.703 Test Loss: 1.319 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 5.735849857330322
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.707 Test Loss: 1.319 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 5.869420289993286
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.707 Test Loss: 1.319 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 5.4491612911224365
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.710 Test Loss: 1.320 Test Acc: 0.710
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.71
model parameter : 12761113
model size : 68.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.891008138656616
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 5.597007989883423
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.59552264213562
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.01063346862793
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 5 cost time: 5.8376476764678955
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 6 cost time: 5.840849876403809
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 7 cost time: 5.6344523429870605
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 8 cost time: 5.810929298400879
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.102893352508545
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.858114957809448
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.741165399551392
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.744853258132935
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.62947678565979
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.468217849731445
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.273019552230835
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.367839574813843
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.860942840576172
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 12761113
model size : 68.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.340365648269653
Epoch: 1, Steps: 18 | Train Loss: 2.847 Vali Loss: 1.614 Vali Acc: 0.777 Test Loss: 1.614 Test Acc: 0.777
Validation loss decreased (inf --> -0.776651).  Saving model ...
Epoch: 2 cost time: 5.741816997528076
Epoch: 2, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.594 Vali Acc: 0.860 Test Loss: 0.594 Test Acc: 0.860
Validation loss decreased (-0.776651 --> -0.859994).  Saving model ...
Epoch: 3 cost time: 5.876915693283081
Epoch: 3, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.468 Vali Acc: 0.870 Test Loss: 0.468 Test Acc: 0.870
Validation loss decreased (-0.859994 --> -0.869995).  Saving model ...
Epoch: 4 cost time: 6.009725093841553
Epoch: 4, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.378 Vali Acc: 0.897 Test Loss: 0.378 Test Acc: 0.897
Validation loss decreased (-0.869995 --> -0.896663).  Saving model ...
Epoch: 5 cost time: 5.935025215148926
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.381 Vali Acc: 0.897 Test Loss: 0.381 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.774789571762085
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
Validation loss decreased (-0.896663 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 5.503919363021851
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.343 Vali Acc: 0.913 Test Loss: 0.343 Test Acc: 0.913
Validation loss decreased (-0.899996 --> -0.913330).  Saving model ...
Epoch: 8 cost time: 5.776089429855347
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.343 Vali Acc: 0.907 Test Loss: 0.343 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.580020427703857
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.343 Vali Acc: 0.907 Test Loss: 0.343 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.764364004135132
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.920 Test Loss: 0.338 Test Acc: 0.920
Validation loss decreased (-0.913330 --> -0.919997).  Saving model ...
Epoch: 11 cost time: 6.275878429412842
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.658535003662109
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.250498294830322
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.920 Test Loss: 0.337 Test Acc: 0.920
Validation loss decreased (-0.919997 --> -0.919997).  Saving model ...
Epoch: 14 cost time: 5.80805516242981
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.923 Test Loss: 0.335 Test Acc: 0.923
Validation loss decreased (-0.919997 --> -0.923330).  Saving model ...
Epoch: 15 cost time: 6.416110038757324
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.920 Test Loss: 0.335 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.829078674316406
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.920 Test Loss: 0.336 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.808816432952881
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.920 Test Loss: 0.336 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.1148905754089355
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.920 Test Loss: 0.336 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.875713586807251
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.920 Test Loss: 0.337 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.510055780410767
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.920 Test Loss: 0.336 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.405027627944946
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.613130569458008
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.913 Test Loss: 0.335 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.597642660140991
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.641902208328247
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9233333333333333
model parameter : 6708249
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.955090761184692
Epoch: 1, Steps: 18 | Train Loss: 2.969 Vali Loss: 1.956 Vali Acc: 0.683 Test Loss: 1.956 Test Acc: 0.683
Validation loss decreased (inf --> -0.683314).  Saving model ...
Epoch: 2 cost time: 5.473192930221558
Epoch: 2, Steps: 18 | Train Loss: 0.992 Vali Loss: 0.836 Vali Acc: 0.793 Test Loss: 0.836 Test Acc: 0.793
Validation loss decreased (-0.683314 --> -0.793325).  Saving model ...
Epoch: 3 cost time: 5.467963933944702
Epoch: 3, Steps: 18 | Train Loss: 0.182 Vali Loss: 0.654 Vali Acc: 0.830 Test Loss: 0.654 Test Acc: 0.830
Validation loss decreased (-0.793325 --> -0.829993).  Saving model ...
Epoch: 4 cost time: 5.428338289260864
Epoch: 4, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.587 Vali Acc: 0.837 Test Loss: 0.587 Test Acc: 0.837
Validation loss decreased (-0.829993 --> -0.836661).  Saving model ...
Epoch: 5 cost time: 5.2981016635894775
Epoch: 5, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.506 Vali Acc: 0.840 Test Loss: 0.506 Test Acc: 0.840
Validation loss decreased (-0.836661 --> -0.839995).  Saving model ...
Epoch: 6 cost time: 5.384490966796875
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.521 Vali Acc: 0.860 Test Loss: 0.521 Test Acc: 0.860
Validation loss decreased (-0.839995 --> -0.859995).  Saving model ...
Epoch: 7 cost time: 5.126742839813232
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.863 Test Loss: 0.519 Test Acc: 0.863
Validation loss decreased (-0.859995 --> -0.863328).  Saving model ...
Epoch: 8 cost time: 5.137964963912964
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.860 Test Loss: 0.515 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.186521053314209
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.860 Test Loss: 0.510 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.2565531730651855
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.863 Test Loss: 0.509 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 11 cost time: 5.380269765853882
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.863 Test Loss: 0.509 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 12 cost time: 5.640109062194824
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.863 Test Loss: 0.508 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 13 cost time: 5.427567481994629
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 14 cost time: 5.536324501037598
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.863 Test Loss: 0.503 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 15 cost time: 5.648599863052368
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.863 Test Loss: 0.503 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.460711479187012
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.863 Test Loss: 0.506 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.430565357208252
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.288628578186035
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.863 Test Loss: 0.506 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.473517656326294
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.867 Test Loss: 0.507 Test Acc: 0.867
Validation loss decreased (-0.863328 --> -0.866662).  Saving model ...
Epoch: 20 cost time: 4.855088949203491
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.870 Test Loss: 0.507 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.869995).  Saving model ...
Epoch: 21 cost time: 5.3889923095703125
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.870 Test Loss: 0.508 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.4148523807525635
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.38199782371521
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.873 Test Loss: 0.509 Test Acc: 0.873
Validation loss decreased (-0.869995 --> -0.873328).  Saving model ...
Epoch: 24 cost time: 5.101154327392578
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.873 Test Loss: 0.508 Test Acc: 0.873
Validation loss decreased (-0.873328 --> -0.873328).  Saving model ...
Epoch: 25 cost time: 5.3681089878082275
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.040906190872192
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.286563158035278
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.873 Test Loss: 0.509 Test Acc: 0.873
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.226941347122192
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.870 Test Loss: 0.508 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.572612524032593
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.873 Test Loss: 0.510 Test Acc: 0.873
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.523110389709473
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.873 Test Loss: 0.510 Test Acc: 0.873
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.620261192321777
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.870 Test Loss: 0.511 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.502906560897827
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.870 Test Loss: 0.511 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.466111898422241
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.873 Test Loss: 0.510 Test Acc: 0.873
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.118511199951172
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.873 Test Loss: 0.509 Test Acc: 0.873
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8733333333333333
model parameter : 6708249
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.681023120880127
Epoch: 1, Steps: 18 | Train Loss: 3.114 Vali Loss: 2.374 Vali Acc: 0.477 Test Loss: 2.374 Test Acc: 0.477
Validation loss decreased (inf --> -0.476643).  Saving model ...
Epoch: 2 cost time: 5.402392148971558
Epoch: 2, Steps: 18 | Train Loss: 1.416 Vali Loss: 1.320 Vali Acc: 0.697 Test Loss: 1.320 Test Acc: 0.697
Validation loss decreased (-0.476643 --> -0.696653).  Saving model ...
Epoch: 3 cost time: 5.304651498794556
Epoch: 3, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.010 Vali Acc: 0.750 Test Loss: 1.010 Test Acc: 0.750
Validation loss decreased (-0.696653 --> -0.749990).  Saving model ...
Epoch: 4 cost time: 5.4450201988220215
Epoch: 4, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.901 Vali Acc: 0.750 Test Loss: 0.901 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 5.604491710662842
Epoch: 5, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.785 Vali Acc: 0.800 Test Loss: 0.785 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 6 cost time: 5.849939346313477
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.820 Vali Acc: 0.793 Test Loss: 0.820 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.968529939651489
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.790 Test Loss: 0.816 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.474622011184692
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.807 Test Loss: 0.807 Test Acc: 0.807
Validation loss decreased (-0.799992 --> -0.806659).  Saving model ...
Epoch: 9 cost time: 5.8591742515563965
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.807 Test Loss: 0.800 Test Acc: 0.807
Validation loss decreased (-0.806659 --> -0.806659).  Saving model ...
Epoch: 10 cost time: 5.7039501667022705
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.807 Test Loss: 0.798 Test Acc: 0.807
Validation loss decreased (-0.806659 --> -0.806659).  Saving model ...
Epoch: 11 cost time: 6.073973894119263
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.813 Test Loss: 0.800 Test Acc: 0.813
Validation loss decreased (-0.806659 --> -0.813325).  Saving model ...
Epoch: 12 cost time: 5.4984376430511475
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.804 Vali Acc: 0.813 Test Loss: 0.804 Test Acc: 0.813
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.715312480926514
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.813 Test Loss: 0.803 Test Acc: 0.813
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.357203960418701
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.813 Test Loss: 0.801 Test Acc: 0.813
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.90982723236084
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.807 Test Loss: 0.805 Test Acc: 0.807
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.667827129364014
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.807 Test Loss: 0.808 Test Acc: 0.807
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.65054988861084
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.807 Test Loss: 0.809 Test Acc: 0.807
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.632704973220825
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.803 Test Loss: 0.811 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.534562587738037
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.800 Test Loss: 0.814 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.8608174324035645
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.800 Test Loss: 0.815 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.760693311691284
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.803 Test Loss: 0.818 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8133333333333334
model parameter : 6708249
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.993894577026367
Epoch: 1, Steps: 18 | Train Loss: 3.212 Vali Loss: 2.720 Vali Acc: 0.333 Test Loss: 2.720 Test Acc: 0.333
Validation loss decreased (inf --> -0.333306).  Saving model ...
Epoch: 2 cost time: 5.563535928726196
Epoch: 2, Steps: 18 | Train Loss: 1.885 Vali Loss: 1.963 Vali Acc: 0.433 Test Loss: 1.963 Test Acc: 0.433
Validation loss decreased (-0.333306 --> -0.433314).  Saving model ...
Epoch: 3 cost time: 5.2756428718566895
Epoch: 3, Steps: 18 | Train Loss: 0.584 Vali Loss: 1.595 Vali Acc: 0.513 Test Loss: 1.595 Test Acc: 0.513
Validation loss decreased (-0.433314 --> -0.513317).  Saving model ...
Epoch: 4 cost time: 5.52602219581604
Epoch: 4, Steps: 18 | Train Loss: 0.106 Vali Loss: 1.536 Vali Acc: 0.490 Test Loss: 1.536 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.330030679702759
Epoch: 5, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.300 Vali Acc: 0.620 Test Loss: 1.300 Test Acc: 0.620
Validation loss decreased (-0.513317 --> -0.619987).  Saving model ...
Epoch: 6 cost time: 5.5426905155181885
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.186 Vali Acc: 0.650 Test Loss: 1.186 Test Acc: 0.650
Validation loss decreased (-0.619987 --> -0.649988).  Saving model ...
Epoch: 7 cost time: 5.637092351913452
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.147 Vali Acc: 0.663 Test Loss: 1.147 Test Acc: 0.663
Validation loss decreased (-0.649988 --> -0.663322).  Saving model ...
Epoch: 8 cost time: 5.491415023803711
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.143 Vali Acc: 0.663 Test Loss: 1.143 Test Acc: 0.663
Validation loss decreased (-0.663322 --> -0.663322).  Saving model ...
Epoch: 9 cost time: 6.076859474182129
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.144 Vali Acc: 0.677 Test Loss: 1.144 Test Acc: 0.677
Validation loss decreased (-0.663322 --> -0.676655).  Saving model ...
Epoch: 10 cost time: 6.033296346664429
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.140 Vali Acc: 0.680 Test Loss: 1.140 Test Acc: 0.680
Validation loss decreased (-0.676655 --> -0.679989).  Saving model ...
Epoch: 11 cost time: 5.532710552215576
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.134 Vali Acc: 0.677 Test Loss: 1.134 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.773445129394531
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.138 Vali Acc: 0.673 Test Loss: 1.138 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.419457912445068
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.136 Vali Acc: 0.673 Test Loss: 1.136 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.443906307220459
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.131 Vali Acc: 0.680 Test Loss: 1.131 Test Acc: 0.680
Validation loss decreased (-0.679989 --> -0.679989).  Saving model ...
Epoch: 15 cost time: 6.059801816940308
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.126 Vali Acc: 0.683 Test Loss: 1.126 Test Acc: 0.683
Validation loss decreased (-0.679989 --> -0.683322).  Saving model ...
Epoch: 16 cost time: 5.238199472427368
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.125 Vali Acc: 0.683 Test Loss: 1.125 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 17 cost time: 5.530237436294556
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.125 Vali Acc: 0.693 Test Loss: 1.125 Test Acc: 0.693
Validation loss decreased (-0.683322 --> -0.693322).  Saving model ...
Epoch: 18 cost time: 5.668679714202881
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.123 Vali Acc: 0.687 Test Loss: 1.123 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.6772072315216064
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.126 Vali Acc: 0.683 Test Loss: 1.126 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.484522819519043
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.121 Vali Acc: 0.683 Test Loss: 1.121 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.552706956863403
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.120 Vali Acc: 0.687 Test Loss: 1.120 Test Acc: 0.687
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.598346471786499
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.118 Vali Acc: 0.680 Test Loss: 1.118 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.584402799606323
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.117 Vali Acc: 0.687 Test Loss: 1.117 Test Acc: 0.687
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.574058532714844
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.111 Vali Acc: 0.677 Test Loss: 1.111 Test Acc: 0.677
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.355106592178345
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.109 Vali Acc: 0.683 Test Loss: 1.109 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.576781749725342
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.109 Vali Acc: 0.687 Test Loss: 1.109 Test Acc: 0.687
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.347891092300415
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.106 Vali Acc: 0.680 Test Loss: 1.106 Test Acc: 0.680
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6933333333333334
model parameter : 6708249
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.6002843379974365
Epoch: 1, Steps: 18 | Train Loss: 3.261 Vali Loss: 2.941 Vali Acc: 0.200 Test Loss: 2.941 Test Acc: 0.200
Validation loss decreased (inf --> -0.199971).  Saving model ...
Epoch: 2 cost time: 5.517006158828735
Epoch: 2, Steps: 18 | Train Loss: 2.113 Vali Loss: 2.448 Vali Acc: 0.280 Test Loss: 2.448 Test Acc: 0.280
Validation loss decreased (-0.199971 --> -0.279976).  Saving model ...
Epoch: 3 cost time: 5.499615669250488
Epoch: 3, Steps: 18 | Train Loss: 0.838 Vali Loss: 2.248 Vali Acc: 0.277 Test Loss: 2.248 Test Acc: 0.277
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.274731397628784
Epoch: 4, Steps: 18 | Train Loss: 0.187 Vali Loss: 1.927 Vali Acc: 0.390 Test Loss: 1.927 Test Acc: 0.390
Validation loss decreased (-0.279976 --> -0.389981).  Saving model ...
Epoch: 5 cost time: 5.953341245651245
Epoch: 5, Steps: 18 | Train Loss: 0.045 Vali Loss: 1.820 Vali Acc: 0.427 Test Loss: 1.820 Test Acc: 0.427
Validation loss decreased (-0.389981 --> -0.426648).  Saving model ...
Epoch: 6 cost time: 5.8113110065460205
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.719 Vali Acc: 0.470 Test Loss: 1.719 Test Acc: 0.470
Validation loss decreased (-0.426648 --> -0.469983).  Saving model ...
Epoch: 7 cost time: 5.851066827774048
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.658 Vali Acc: 0.473 Test Loss: 1.658 Test Acc: 0.473
Validation loss decreased (-0.469983 --> -0.473317).  Saving model ...
Epoch: 8 cost time: 6.121139287948608
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.606 Vali Acc: 0.503 Test Loss: 1.606 Test Acc: 0.503
Validation loss decreased (-0.473317 --> -0.503317).  Saving model ...
Epoch: 9 cost time: 6.049999952316284
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.599 Vali Acc: 0.503 Test Loss: 1.599 Test Acc: 0.503
Validation loss decreased (-0.503317 --> -0.503317).  Saving model ...
Epoch: 10 cost time: 5.522712230682373
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.581 Vali Acc: 0.500 Test Loss: 1.581 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.131635904312134
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.575 Vali Acc: 0.510 Test Loss: 1.575 Test Acc: 0.510
Validation loss decreased (-0.503317 --> -0.509984).  Saving model ...
Epoch: 12 cost time: 4.553647041320801
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.523 Test Loss: 1.566 Test Acc: 0.523
Validation loss decreased (-0.509984 --> -0.523318).  Saving model ...
Epoch: 13 cost time: 5.299681901931763
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.558 Vali Acc: 0.527 Test Loss: 1.558 Test Acc: 0.527
Validation loss decreased (-0.523318 --> -0.526651).  Saving model ...
Epoch: 14 cost time: 5.040575742721558
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.550 Vali Acc: 0.537 Test Loss: 1.550 Test Acc: 0.537
Validation loss decreased (-0.526651 --> -0.536651).  Saving model ...
Epoch: 15 cost time: 5.437185287475586
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.533 Vali Acc: 0.537 Test Loss: 1.533 Test Acc: 0.537
Validation loss decreased (-0.536651 --> -0.536651).  Saving model ...
Epoch: 16 cost time: 5.4323766231536865
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.533 Test Loss: 1.532 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.577062606811523
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.524 Vali Acc: 0.540 Test Loss: 1.524 Test Acc: 0.540
Validation loss decreased (-0.536651 --> -0.539985).  Saving model ...
Epoch: 18 cost time: 5.338760852813721
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.519 Vali Acc: 0.543 Test Loss: 1.519 Test Acc: 0.543
Validation loss decreased (-0.539985 --> -0.543318).  Saving model ...
Epoch: 19 cost time: 5.531597137451172
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.543 Test Loss: 1.515 Test Acc: 0.543
Validation loss decreased (-0.543318 --> -0.543318).  Saving model ...
Epoch: 20 cost time: 5.364755153656006
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.550 Test Loss: 1.496 Test Acc: 0.550
Validation loss decreased (-0.543318 --> -0.549985).  Saving model ...
Epoch: 21 cost time: 5.324540615081787
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.543 Test Loss: 1.489 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.149750709533691
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.557 Test Loss: 1.482 Test Acc: 0.557
Validation loss decreased (-0.549985 --> -0.556652).  Saving model ...
Epoch: 23 cost time: 5.392573833465576
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.560 Test Loss: 1.476 Test Acc: 0.560
Validation loss decreased (-0.556652 --> -0.559985).  Saving model ...
Epoch: 24 cost time: 5.447213649749756
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.560 Test Loss: 1.467 Test Acc: 0.560
Validation loss decreased (-0.559985 --> -0.559985).  Saving model ...
Epoch: 25 cost time: 5.382927179336548
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.567 Test Loss: 1.463 Test Acc: 0.567
Validation loss decreased (-0.559985 --> -0.566652).  Saving model ...
Epoch: 26 cost time: 5.152456998825073
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.457 Vali Acc: 0.570 Test Loss: 1.457 Test Acc: 0.570
Validation loss decreased (-0.566652 --> -0.569985).  Saving model ...
Epoch: 27 cost time: 5.561185598373413
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.570 Test Loss: 1.454 Test Acc: 0.570
Validation loss decreased (-0.569985 --> -0.569985).  Saving model ...
Epoch: 28 cost time: 5.145254135131836
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.573 Test Loss: 1.447 Test Acc: 0.573
Validation loss decreased (-0.569985 --> -0.573319).  Saving model ...
Epoch: 29 cost time: 5.233034372329712
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.577 Test Loss: 1.441 Test Acc: 0.577
Validation loss decreased (-0.573319 --> -0.576652).  Saving model ...
Epoch: 30 cost time: 5.224750518798828
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.573 Test Loss: 1.436 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.4284045696258545
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.573 Test Loss: 1.435 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.401549577713013
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.580 Test Loss: 1.427 Test Acc: 0.580
Validation loss decreased (-0.576652 --> -0.579986).  Saving model ...
Epoch: 33 cost time: 5.456954479217529
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.580 Test Loss: 1.422 Test Acc: 0.580
Validation loss decreased (-0.579986 --> -0.579986).  Saving model ...
Epoch: 34 cost time: 5.445352077484131
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.417 Vali Acc: 0.583 Test Loss: 1.417 Test Acc: 0.583
Validation loss decreased (-0.579986 --> -0.583319).  Saving model ...
Epoch: 35 cost time: 5.30894923210144
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.587 Test Loss: 1.414 Test Acc: 0.587
Validation loss decreased (-0.583319 --> -0.586653).  Saving model ...
Epoch: 36 cost time: 5.436866998672485
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.590 Test Loss: 1.409 Test Acc: 0.590
Validation loss decreased (-0.586653 --> -0.589986).  Saving model ...
Epoch: 37 cost time: 5.356951475143433
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.597 Test Loss: 1.404 Test Acc: 0.597
Validation loss decreased (-0.589986 --> -0.596653).  Saving model ...
Epoch: 38 cost time: 5.41449236869812
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.593 Test Loss: 1.403 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.228118658065796
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.597 Test Loss: 1.400 Test Acc: 0.597
Validation loss decreased (-0.596653 --> -0.596653).  Saving model ...
Epoch: 40 cost time: 5.187782287597656
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.597 Test Loss: 1.397 Test Acc: 0.597
Validation loss decreased (-0.596653 --> -0.596653).  Saving model ...
Epoch: 41 cost time: 5.310024738311768
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.597 Test Loss: 1.395 Test Acc: 0.597
Validation loss decreased (-0.596653 --> -0.596653).  Saving model ...
Epoch: 42 cost time: 5.216936349868774
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.597 Test Loss: 1.391 Test Acc: 0.597
Validation loss decreased (-0.596653 --> -0.596653).  Saving model ...
Epoch: 43 cost time: 5.46119236946106
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.600 Test Loss: 1.390 Test Acc: 0.600
Validation loss decreased (-0.596653 --> -0.599986).  Saving model ...
Epoch: 44 cost time: 5.260755300521851
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.607 Test Loss: 1.384 Test Acc: 0.607
Validation loss decreased (-0.599986 --> -0.606653).  Saving model ...
Epoch: 45 cost time: 5.5635504722595215
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.607 Test Loss: 1.382 Test Acc: 0.607
Validation loss decreased (-0.606653 --> -0.606653).  Saving model ...
Epoch: 46 cost time: 5.197511911392212
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.610 Test Loss: 1.380 Test Acc: 0.610
Validation loss decreased (-0.606653 --> -0.609986).  Saving model ...
Epoch: 47 cost time: 5.090153455734253
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.613 Test Loss: 1.376 Test Acc: 0.613
Validation loss decreased (-0.609986 --> -0.613320).  Saving model ...
Epoch: 48 cost time: 5.483948707580566
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.613 Test Loss: 1.374 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 49 cost time: 5.48186731338501
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.617 Test Loss: 1.369 Test Acc: 0.617
Validation loss decreased (-0.613320 --> -0.616653).  Saving model ...
Epoch: 50 cost time: 5.382552862167358
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.617 Test Loss: 1.368 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616653).  Saving model ...
Epoch: 51 cost time: 5.603461503982544
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.623 Test Loss: 1.368 Test Acc: 0.623
Validation loss decreased (-0.616653 --> -0.623320).  Saving model ...
Epoch: 52 cost time: 5.4097137451171875
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.627 Test Loss: 1.366 Test Acc: 0.627
Validation loss decreased (-0.623320 --> -0.626653).  Saving model ...
Epoch: 53 cost time: 5.46790885925293
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.620 Test Loss: 1.366 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.297238111495972
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.623 Test Loss: 1.360 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 5.417740345001221
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.623 Test Loss: 1.358 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 5.18298864364624
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.623 Test Loss: 1.357 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 5.2413105964660645
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.620 Test Loss: 1.356 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 5.360757350921631
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.620 Test Loss: 1.354 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 5.408475160598755
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.617 Test Loss: 1.355 Test Acc: 0.617
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 5.510645389556885
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.617 Test Loss: 1.353 Test Acc: 0.617
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 5.749157667160034
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.617 Test Loss: 1.350 Test Acc: 0.617
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 5.6245105266571045
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.620 Test Loss: 1.347 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6266666666666667
model parameter : 6708249
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.800242185592651
Epoch: 1, Steps: 18 | Train Loss: 3.272 Vali Loss: 3.050 Vali Acc: 0.123 Test Loss: 3.050 Test Acc: 0.123
Validation loss decreased (inf --> -0.123303).  Saving model ...
Epoch: 2 cost time: 5.665194749832153
Epoch: 2, Steps: 18 | Train Loss: 2.173 Vali Loss: 2.670 Vali Acc: 0.223 Test Loss: 2.670 Test Acc: 0.223
Validation loss decreased (-0.123303 --> -0.223307).  Saving model ...
Epoch: 3 cost time: 6.048033714294434
Epoch: 3, Steps: 18 | Train Loss: 0.907 Vali Loss: 2.449 Vali Acc: 0.280 Test Loss: 2.449 Test Acc: 0.280
Validation loss decreased (-0.223307 --> -0.279976).  Saving model ...
Epoch: 4 cost time: 5.871480226516724
Epoch: 4, Steps: 18 | Train Loss: 0.218 Vali Loss: 2.300 Vali Acc: 0.297 Test Loss: 2.300 Test Acc: 0.297
Validation loss decreased (-0.279976 --> -0.296644).  Saving model ...
Epoch: 5 cost time: 5.7078773975372314
Epoch: 5, Steps: 18 | Train Loss: 0.050 Vali Loss: 2.154 Vali Acc: 0.383 Test Loss: 2.154 Test Acc: 0.383
Validation loss decreased (-0.296644 --> -0.383312).  Saving model ...
Epoch: 6 cost time: 5.462887525558472
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.116 Vali Acc: 0.330 Test Loss: 2.116 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.575815677642822
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.081 Vali Acc: 0.367 Test Loss: 2.081 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.016651630401611
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.006 Vali Acc: 0.403 Test Loss: 2.006 Test Acc: 0.403
Validation loss decreased (-0.383312 --> -0.403313).  Saving model ...
Epoch: 9 cost time: 6.109498977661133
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.987 Vali Acc: 0.403 Test Loss: 1.987 Test Acc: 0.403
Validation loss decreased (-0.403313 --> -0.403313).  Saving model ...
Epoch: 10 cost time: 5.164167642593384
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.950 Vali Acc: 0.407 Test Loss: 1.950 Test Acc: 0.407
Validation loss decreased (-0.403313 --> -0.406647).  Saving model ...
Epoch: 11 cost time: 5.865355968475342
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.933 Vali Acc: 0.433 Test Loss: 1.933 Test Acc: 0.433
Validation loss decreased (-0.406647 --> -0.433314).  Saving model ...
Epoch: 12 cost time: 5.463574171066284
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.921 Vali Acc: 0.440 Test Loss: 1.921 Test Acc: 0.440
Validation loss decreased (-0.433314 --> -0.439981).  Saving model ...
Epoch: 13 cost time: 5.6219401359558105
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.911 Vali Acc: 0.447 Test Loss: 1.911 Test Acc: 0.447
Validation loss decreased (-0.439981 --> -0.446648).  Saving model ...
Epoch: 14 cost time: 5.609669923782349
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.898 Vali Acc: 0.440 Test Loss: 1.898 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.535258769989014
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.884 Vali Acc: 0.440 Test Loss: 1.884 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.001258850097656
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.867 Vali Acc: 0.460 Test Loss: 1.867 Test Acc: 0.460
Validation loss decreased (-0.446648 --> -0.459981).  Saving model ...
Epoch: 17 cost time: 5.944291830062866
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.851 Vali Acc: 0.470 Test Loss: 1.851 Test Acc: 0.470
Validation loss decreased (-0.459981 --> -0.469981).  Saving model ...
Epoch: 18 cost time: 5.886354684829712
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.847 Vali Acc: 0.467 Test Loss: 1.847 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.549655199050903
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.836 Vali Acc: 0.470 Test Loss: 1.836 Test Acc: 0.470
Validation loss decreased (-0.469981 --> -0.469982).  Saving model ...
Epoch: 20 cost time: 5.523665428161621
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.814 Vali Acc: 0.487 Test Loss: 1.814 Test Acc: 0.487
Validation loss decreased (-0.469982 --> -0.486649).  Saving model ...
Epoch: 21 cost time: 5.413763046264648
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.490 Test Loss: 1.796 Test Acc: 0.490
Validation loss decreased (-0.486649 --> -0.489982).  Saving model ...
Epoch: 22 cost time: 5.3526270389556885
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.783 Vali Acc: 0.493 Test Loss: 1.783 Test Acc: 0.493
Validation loss decreased (-0.489982 --> -0.493315).  Saving model ...
Epoch: 23 cost time: 5.528479337692261
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.775 Vali Acc: 0.497 Test Loss: 1.775 Test Acc: 0.497
Validation loss decreased (-0.493315 --> -0.496649).  Saving model ...
Epoch: 24 cost time: 5.575732469558716
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.766 Vali Acc: 0.503 Test Loss: 1.766 Test Acc: 0.503
Validation loss decreased (-0.496649 --> -0.503316).  Saving model ...
Epoch: 25 cost time: 5.683654308319092
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.517 Test Loss: 1.760 Test Acc: 0.517
Validation loss decreased (-0.503316 --> -0.516649).  Saving model ...
Epoch: 26 cost time: 5.558743000030518
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.523 Test Loss: 1.756 Test Acc: 0.523
Validation loss decreased (-0.516649 --> -0.523316).  Saving model ...
Epoch: 27 cost time: 5.730314493179321
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.751 Vali Acc: 0.520 Test Loss: 1.751 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.988802671432495
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.527 Test Loss: 1.739 Test Acc: 0.527
Validation loss decreased (-0.523316 --> -0.526649).  Saving model ...
Epoch: 29 cost time: 5.554833650588989
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.728 Vali Acc: 0.523 Test Loss: 1.728 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.763448476791382
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.520 Test Loss: 1.721 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.385531902313232
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.530 Test Loss: 1.717 Test Acc: 0.530
Validation loss decreased (-0.526649 --> -0.529983).  Saving model ...
Epoch: 32 cost time: 5.4201061725616455
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.708 Vali Acc: 0.523 Test Loss: 1.708 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.313943147659302
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.702 Vali Acc: 0.530 Test Loss: 1.702 Test Acc: 0.530
Validation loss decreased (-0.529983 --> -0.529983).  Saving model ...
Epoch: 34 cost time: 5.674671411514282
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.695 Vali Acc: 0.533 Test Loss: 1.695 Test Acc: 0.533
Validation loss decreased (-0.529983 --> -0.533316).  Saving model ...
Epoch: 35 cost time: 5.666358709335327
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.690 Vali Acc: 0.537 Test Loss: 1.690 Test Acc: 0.537
Validation loss decreased (-0.533316 --> -0.536650).  Saving model ...
Epoch: 36 cost time: 5.724494934082031
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.687 Vali Acc: 0.540 Test Loss: 1.687 Test Acc: 0.540
Validation loss decreased (-0.536650 --> -0.539983).  Saving model ...
Epoch: 37 cost time: 5.586884498596191
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.680 Vali Acc: 0.547 Test Loss: 1.680 Test Acc: 0.547
Validation loss decreased (-0.539983 --> -0.546650).  Saving model ...
Epoch: 38 cost time: 6.139830589294434
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.675 Vali Acc: 0.553 Test Loss: 1.675 Test Acc: 0.553
Validation loss decreased (-0.546650 --> -0.553317).  Saving model ...
Epoch: 39 cost time: 6.208584308624268
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.553 Test Loss: 1.669 Test Acc: 0.553
Validation loss decreased (-0.553317 --> -0.553317).  Saving model ...
Epoch: 40 cost time: 6.13238525390625
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.664 Vali Acc: 0.553 Test Loss: 1.664 Test Acc: 0.553
Validation loss decreased (-0.553317 --> -0.553317).  Saving model ...
Epoch: 41 cost time: 5.895303010940552
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.661 Vali Acc: 0.553 Test Loss: 1.661 Test Acc: 0.553
Validation loss decreased (-0.553317 --> -0.553317).  Saving model ...
Epoch: 42 cost time: 5.465175628662109
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.656 Vali Acc: 0.550 Test Loss: 1.656 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.1654052734375
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.653 Vali Acc: 0.557 Test Loss: 1.653 Test Acc: 0.557
Validation loss decreased (-0.553317 --> -0.556650).  Saving model ...
Epoch: 44 cost time: 5.727876424789429
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.557 Test Loss: 1.647 Test Acc: 0.557
Validation loss decreased (-0.556650 --> -0.556650).  Saving model ...
Epoch: 45 cost time: 5.36569619178772
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.553 Test Loss: 1.645 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.406142711639404
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.560 Test Loss: 1.639 Test Acc: 0.560
Validation loss decreased (-0.556650 --> -0.559984).  Saving model ...
Epoch: 47 cost time: 5.570436954498291
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.563 Test Loss: 1.633 Test Acc: 0.563
Validation loss decreased (-0.559984 --> -0.563317).  Saving model ...
Epoch: 48 cost time: 5.821006774902344
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.567 Test Loss: 1.627 Test Acc: 0.567
Validation loss decreased (-0.563317 --> -0.566650).  Saving model ...
Epoch: 49 cost time: 5.907915830612183
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.580 Test Loss: 1.626 Test Acc: 0.580
Validation loss decreased (-0.566650 --> -0.579984).  Saving model ...
Epoch: 50 cost time: 5.448354005813599
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.577 Test Loss: 1.625 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 6.167436361312866
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.621 Vali Acc: 0.580 Test Loss: 1.621 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579984).  Saving model ...
Epoch: 52 cost time: 5.6156415939331055
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.583 Test Loss: 1.619 Test Acc: 0.583
Validation loss decreased (-0.579984 --> -0.583317).  Saving model ...
Epoch: 53 cost time: 5.89842963218689
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.590 Test Loss: 1.616 Test Acc: 0.590
Validation loss decreased (-0.583317 --> -0.589984).  Saving model ...
Epoch: 54 cost time: 5.555475473403931
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.587 Test Loss: 1.611 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.902010917663574
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.587 Test Loss: 1.606 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 5.722392559051514
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.590 Test Loss: 1.605 Test Acc: 0.590
Validation loss decreased (-0.589984 --> -0.589984).  Saving model ...
Epoch: 57 cost time: 5.904340028762817
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.590 Test Loss: 1.602 Test Acc: 0.590
Validation loss decreased (-0.589984 --> -0.589984).  Saving model ...
Epoch: 58 cost time: 5.503357410430908
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.590 Test Loss: 1.602 Test Acc: 0.590
Validation loss decreased (-0.589984 --> -0.589984).  Saving model ...
Epoch: 59 cost time: 5.766414403915405
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.599 Vali Acc: 0.593 Test Loss: 1.599 Test Acc: 0.593
Validation loss decreased (-0.589984 --> -0.593317).  Saving model ...
Epoch: 60 cost time: 5.995558500289917
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.594 Vali Acc: 0.593 Test Loss: 1.594 Test Acc: 0.593
Validation loss decreased (-0.593317 --> -0.593317).  Saving model ...
Epoch: 61 cost time: 5.665674924850464
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.590 Test Loss: 1.587 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 5.737144470214844
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.590 Test Loss: 1.583 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 5.9384236335754395
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.590 Test Loss: 1.583 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 5.918313026428223
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.590 Test Loss: 1.580 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 5.868736743927002
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.584 Vali Acc: 0.590 Test Loss: 1.584 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 5.72418737411499
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.584 Vali Acc: 0.590 Test Loss: 1.584 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 5.481208324432373
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.593 Test Loss: 1.583 Test Acc: 0.593
Validation loss decreased (-0.593317 --> -0.593318).  Saving model ...
Epoch: 68 cost time: 5.4451377391815186
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.597 Test Loss: 1.581 Test Acc: 0.597
Validation loss decreased (-0.593318 --> -0.596651).  Saving model ...
Epoch: 69 cost time: 5.699546813964844
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.597 Test Loss: 1.579 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 70 cost time: 5.612036228179932
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.593 Test Loss: 1.575 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 5.73856258392334
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.597 Test Loss: 1.572 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 72 cost time: 5.613163709640503
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.600 Test Loss: 1.569 Test Acc: 0.600
Validation loss decreased (-0.596651 --> -0.599984).  Saving model ...
Epoch: 73 cost time: 5.928250312805176
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.600 Test Loss: 1.567 Test Acc: 0.600
Validation loss decreased (-0.599984 --> -0.599984).  Saving model ...
Epoch: 74 cost time: 6.179044246673584
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.565 Vali Acc: 0.603 Test Loss: 1.565 Test Acc: 0.603
Validation loss decreased (-0.599984 --> -0.603318).  Saving model ...
Epoch: 75 cost time: 5.7801313400268555
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.607 Test Loss: 1.561 Test Acc: 0.607
Validation loss decreased (-0.603318 --> -0.606651).  Saving model ...
Epoch: 76 cost time: 6.0582122802734375
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.607 Test Loss: 1.558 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606651).  Saving model ...
Epoch: 77 cost time: 5.675450086593628
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.555 Vali Acc: 0.607 Test Loss: 1.555 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606651).  Saving model ...
Epoch: 78 cost time: 5.913742303848267
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.607 Test Loss: 1.554 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606651).  Saving model ...
Epoch: 79 cost time: 5.674014329910278
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.552 Vali Acc: 0.607 Test Loss: 1.552 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606651).  Saving model ...
Epoch: 80 cost time: 5.6248860359191895
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.552 Vali Acc: 0.603 Test Loss: 1.552 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 5.465984344482422
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.603 Test Loss: 1.550 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 6.027533769607544
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.610 Test Loss: 1.549 Test Acc: 0.610
Validation loss decreased (-0.606651 --> -0.609985).  Saving model ...
Epoch: 83 cost time: 5.886995792388916
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.548 Vali Acc: 0.610 Test Loss: 1.548 Test Acc: 0.610
Validation loss decreased (-0.609985 --> -0.609985).  Saving model ...
Epoch: 84 cost time: 5.427000284194946
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.546 Vali Acc: 0.610 Test Loss: 1.546 Test Acc: 0.610
Validation loss decreased (-0.609985 --> -0.609985).  Saving model ...
Epoch: 85 cost time: 5.418338060379028
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.546 Vali Acc: 0.610 Test Loss: 1.546 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 5.574092864990234
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.545 Vali Acc: 0.610 Test Loss: 1.545 Test Acc: 0.610
Validation loss decreased (-0.609985 --> -0.609985).  Saving model ...
Epoch: 87 cost time: 5.537478923797607
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.542 Vali Acc: 0.613 Test Loss: 1.542 Test Acc: 0.613
Validation loss decreased (-0.609985 --> -0.613318).  Saving model ...
Epoch: 88 cost time: 5.921629190444946
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.613 Test Loss: 1.539 Test Acc: 0.613
Validation loss decreased (-0.613318 --> -0.613318).  Saving model ...
Epoch: 89 cost time: 5.955316066741943
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.617 Test Loss: 1.539 Test Acc: 0.617
Validation loss decreased (-0.613318 --> -0.616651).  Saving model ...
Epoch: 90 cost time: 5.934699773788452
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.613 Test Loss: 1.539 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 6.074754476547241
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.617 Test Loss: 1.536 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616651).  Saving model ...
Epoch: 92 cost time: 5.685419321060181
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.620 Test Loss: 1.534 Test Acc: 0.620
Validation loss decreased (-0.616651 --> -0.619985).  Saving model ...
Epoch: 93 cost time: 5.693978786468506
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.620 Test Loss: 1.534 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 5.805646181106567
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.627 Test Loss: 1.533 Test Acc: 0.627
Validation loss decreased (-0.619985 --> -0.626651).  Saving model ...
Epoch: 95 cost time: 5.4833290576934814
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.627 Test Loss: 1.532 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 96 cost time: 5.622921466827393
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.627 Test Loss: 1.531 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 97 cost time: 5.875319957733154
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.627 Test Loss: 1.530 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 98 cost time: 6.108227252960205
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.627 Test Loss: 1.528 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 99 cost time: 5.740971088409424
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.627 Test Loss: 1.527 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 100 cost time: 5.977838516235352
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.627 Test Loss: 1.525 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6266666666666667
model parameter : 6708249
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.794154167175293
Epoch: 1, Steps: 18 | Train Loss: 3.232 Vali Loss: 3.137 Vali Acc: 0.063 Test Loss: 3.137 Test Acc: 0.063
Validation loss decreased (inf --> -0.063302).  Saving model ...
Epoch: 2 cost time: 6.169007062911987
Epoch: 2, Steps: 18 | Train Loss: 2.235 Vali Loss: 2.861 Vali Acc: 0.150 Test Loss: 2.861 Test Acc: 0.150
Validation loss decreased (-0.063302 --> -0.149971).  Saving model ...
Epoch: 3 cost time: 5.712465047836304
Epoch: 3, Steps: 18 | Train Loss: 0.954 Vali Loss: 2.751 Vali Acc: 0.167 Test Loss: 2.751 Test Acc: 0.167
Validation loss decreased (-0.149971 --> -0.166639).  Saving model ...
Epoch: 4 cost time: 5.5982818603515625
Epoch: 4, Steps: 18 | Train Loss: 0.248 Vali Loss: 2.856 Vali Acc: 0.197 Test Loss: 2.856 Test Acc: 0.197
Validation loss decreased (-0.166639 --> -0.196638).  Saving model ...
Epoch: 5 cost time: 5.436955690383911
Epoch: 5, Steps: 18 | Train Loss: 0.060 Vali Loss: 2.537 Vali Acc: 0.277 Test Loss: 2.537 Test Acc: 0.277
Validation loss decreased (-0.196638 --> -0.276641).  Saving model ...
Epoch: 6 cost time: 5.9091596603393555
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 2.497 Vali Acc: 0.263 Test Loss: 2.497 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.930855751037598
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.509 Vali Acc: 0.287 Test Loss: 2.509 Test Acc: 0.287
Validation loss decreased (-0.276641 --> -0.286642).  Saving model ...
Epoch: 8 cost time: 5.769080877304077
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 2.425 Vali Acc: 0.280 Test Loss: 2.425 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.677569150924683
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.350 Vali Acc: 0.317 Test Loss: 2.350 Test Acc: 0.317
Validation loss decreased (-0.286642 --> -0.316643).  Saving model ...
Epoch: 10 cost time: 5.5877721309661865
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.322 Vali Acc: 0.327 Test Loss: 2.322 Test Acc: 0.327
Validation loss decreased (-0.316643 --> -0.326643).  Saving model ...
Epoch: 11 cost time: 5.609470367431641
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.280 Vali Acc: 0.350 Test Loss: 2.280 Test Acc: 0.350
Validation loss decreased (-0.326643 --> -0.349977).  Saving model ...
Epoch: 12 cost time: 5.892791271209717
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.209 Vali Acc: 0.347 Test Loss: 2.209 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.705327033996582
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.186 Vali Acc: 0.363 Test Loss: 2.186 Test Acc: 0.363
Validation loss decreased (-0.349977 --> -0.363311).  Saving model ...
Epoch: 14 cost time: 5.914904594421387
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.162 Vali Acc: 0.367 Test Loss: 2.162 Test Acc: 0.367
Validation loss decreased (-0.363311 --> -0.366645).  Saving model ...
Epoch: 15 cost time: 5.686631202697754
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.148 Vali Acc: 0.377 Test Loss: 2.148 Test Acc: 0.377
Validation loss decreased (-0.366645 --> -0.376645).  Saving model ...
Epoch: 16 cost time: 5.675418138504028
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.105 Vali Acc: 0.397 Test Loss: 2.105 Test Acc: 0.397
Validation loss decreased (-0.376645 --> -0.396646).  Saving model ...
Epoch: 17 cost time: 5.787921190261841
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.069 Vali Acc: 0.403 Test Loss: 2.069 Test Acc: 0.403
Validation loss decreased (-0.396646 --> -0.403313).  Saving model ...
Epoch: 18 cost time: 5.845367431640625
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.046 Vali Acc: 0.403 Test Loss: 2.046 Test Acc: 0.403
Validation loss decreased (-0.403313 --> -0.403313).  Saving model ...
Epoch: 19 cost time: 5.533898591995239
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.022 Vali Acc: 0.413 Test Loss: 2.022 Test Acc: 0.413
Validation loss decreased (-0.403313 --> -0.413313).  Saving model ...
Epoch: 20 cost time: 5.66235876083374
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.005 Vali Acc: 0.430 Test Loss: 2.005 Test Acc: 0.430
Validation loss decreased (-0.413313 --> -0.429980).  Saving model ...
Epoch: 21 cost time: 5.653582811355591
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.979 Vali Acc: 0.430 Test Loss: 1.979 Test Acc: 0.430
Validation loss decreased (-0.429980 --> -0.429980).  Saving model ...
Epoch: 22 cost time: 5.894373655319214
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.453 Test Loss: 1.967 Test Acc: 0.453
Validation loss decreased (-0.429980 --> -0.453314).  Saving model ...
Epoch: 23 cost time: 6.1967597007751465
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.942 Vali Acc: 0.453 Test Loss: 1.942 Test Acc: 0.453
Validation loss decreased (-0.453314 --> -0.453314).  Saving model ...
Epoch: 24 cost time: 5.732743978500366
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.924 Vali Acc: 0.463 Test Loss: 1.924 Test Acc: 0.463
Validation loss decreased (-0.453314 --> -0.463314).  Saving model ...
Epoch: 25 cost time: 5.668943405151367
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.908 Vali Acc: 0.463 Test Loss: 1.908 Test Acc: 0.463
Validation loss decreased (-0.463314 --> -0.463314).  Saving model ...
Epoch: 26 cost time: 5.534164667129517
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.903 Vali Acc: 0.463 Test Loss: 1.903 Test Acc: 0.463
Validation loss decreased (-0.463314 --> -0.463314).  Saving model ...
Epoch: 27 cost time: 5.705939531326294
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.904 Vali Acc: 0.473 Test Loss: 1.904 Test Acc: 0.473
Validation loss decreased (-0.463314 --> -0.473314).  Saving model ...
Epoch: 28 cost time: 5.8608479499816895
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.884 Vali Acc: 0.480 Test Loss: 1.884 Test Acc: 0.480
Validation loss decreased (-0.473314 --> -0.479981).  Saving model ...
Epoch: 29 cost time: 5.691616058349609
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.865 Vali Acc: 0.483 Test Loss: 1.865 Test Acc: 0.483
Validation loss decreased (-0.479981 --> -0.483315).  Saving model ...
Epoch: 30 cost time: 5.939355850219727
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.844 Vali Acc: 0.483 Test Loss: 1.844 Test Acc: 0.483
Validation loss decreased (-0.483315 --> -0.483315).  Saving model ...
Epoch: 31 cost time: 5.927612543106079
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.497 Test Loss: 1.829 Test Acc: 0.497
Validation loss decreased (-0.483315 --> -0.496648).  Saving model ...
Epoch: 32 cost time: 6.033127069473267
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.497 Test Loss: 1.811 Test Acc: 0.497
Validation loss decreased (-0.496648 --> -0.496649).  Saving model ...
Epoch: 33 cost time: 6.165626525878906
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.795 Vali Acc: 0.513 Test Loss: 1.795 Test Acc: 0.513
Validation loss decreased (-0.496649 --> -0.513315).  Saving model ...
Epoch: 34 cost time: 5.911981105804443
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.785 Vali Acc: 0.513 Test Loss: 1.785 Test Acc: 0.513
Validation loss decreased (-0.513315 --> -0.513315).  Saving model ...
Epoch: 35 cost time: 6.272240877151489
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.523 Test Loss: 1.772 Test Acc: 0.523
Validation loss decreased (-0.513315 --> -0.523316).  Saving model ...
Epoch: 36 cost time: 5.629456043243408
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.523 Test Loss: 1.772 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.376399517059326
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.765 Vali Acc: 0.530 Test Loss: 1.765 Test Acc: 0.530
Validation loss decreased (-0.523316 --> -0.529982).  Saving model ...
Epoch: 38 cost time: 6.023071765899658
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.755 Vali Acc: 0.527 Test Loss: 1.755 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.807892560958862
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.540 Test Loss: 1.742 Test Acc: 0.540
Validation loss decreased (-0.529982 --> -0.539983).  Saving model ...
Epoch: 40 cost time: 6.003480911254883
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.735 Vali Acc: 0.543 Test Loss: 1.735 Test Acc: 0.543
Validation loss decreased (-0.539983 --> -0.543316).  Saving model ...
Epoch: 41 cost time: 5.772822856903076
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.728 Vali Acc: 0.547 Test Loss: 1.728 Test Acc: 0.547
Validation loss decreased (-0.543316 --> -0.546649).  Saving model ...
Epoch: 42 cost time: 6.024423122406006
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.716 Vali Acc: 0.560 Test Loss: 1.716 Test Acc: 0.560
Validation loss decreased (-0.546649 --> -0.559983).  Saving model ...
Epoch: 43 cost time: 5.685978412628174
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.702 Vali Acc: 0.563 Test Loss: 1.702 Test Acc: 0.563
Validation loss decreased (-0.559983 --> -0.563316).  Saving model ...
Epoch: 44 cost time: 5.481748580932617
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.557 Test Loss: 1.696 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.736407041549683
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.560 Test Loss: 1.689 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 5.623652935028076
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.676 Vali Acc: 0.563 Test Loss: 1.676 Test Acc: 0.563
Validation loss decreased (-0.563316 --> -0.563317).  Saving model ...
Epoch: 47 cost time: 5.536848545074463
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.671 Vali Acc: 0.560 Test Loss: 1.671 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.762511491775513
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.661 Vali Acc: 0.563 Test Loss: 1.661 Test Acc: 0.563
Validation loss decreased (-0.563317 --> -0.563317).  Saving model ...
Epoch: 49 cost time: 5.682583570480347
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.657 Vali Acc: 0.580 Test Loss: 1.657 Test Acc: 0.580
Validation loss decreased (-0.563317 --> -0.579983).  Saving model ...
Epoch: 50 cost time: 6.026134014129639
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.650 Vali Acc: 0.577 Test Loss: 1.650 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.7055628299713135
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.580 Test Loss: 1.644 Test Acc: 0.580
Validation loss decreased (-0.579983 --> -0.579984).  Saving model ...
Epoch: 52 cost time: 5.757653713226318
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.641 Vali Acc: 0.583 Test Loss: 1.641 Test Acc: 0.583
Validation loss decreased (-0.579984 --> -0.583317).  Saving model ...
Epoch: 53 cost time: 5.361030340194702
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.636 Vali Acc: 0.583 Test Loss: 1.636 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 54 cost time: 5.910217523574829
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.580 Test Loss: 1.631 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.823846340179443
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.577 Test Loss: 1.626 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 5.511497497558594
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.580 Test Loss: 1.624 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 5.897818565368652
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.622 Vali Acc: 0.580 Test Loss: 1.622 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 6.064297199249268
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.580 Test Loss: 1.624 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 6.001428127288818
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.580 Test Loss: 1.620 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 5.608941316604614
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.583 Test Loss: 1.614 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 61 cost time: 5.496216297149658
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.583 Test Loss: 1.607 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 62 cost time: 5.856255531311035
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.580 Test Loss: 1.607 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 5.716272592544556
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.590 Test Loss: 1.605 Test Acc: 0.590
Validation loss decreased (-0.583317 --> -0.589984).  Saving model ...
Epoch: 64 cost time: 5.394031047821045
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.600 Vali Acc: 0.597 Test Loss: 1.600 Test Acc: 0.597
Validation loss decreased (-0.589984 --> -0.596651).  Saving model ...
Epoch: 65 cost time: 5.760121583938599
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.587 Test Loss: 1.590 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 6.085383653640747
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.590 Test Loss: 1.587 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 5.888443231582642
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.593 Test Loss: 1.583 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 5.946479558944702
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.597 Test Loss: 1.581 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 69 cost time: 5.862323760986328
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.577 Vali Acc: 0.600 Test Loss: 1.577 Test Acc: 0.600
Validation loss decreased (-0.596651 --> -0.599984).  Saving model ...
Epoch: 70 cost time: 5.861530303955078
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.607 Test Loss: 1.573 Test Acc: 0.607
Validation loss decreased (-0.599984 --> -0.606651).  Saving model ...
Epoch: 71 cost time: 5.565242052078247
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.570 Vali Acc: 0.610 Test Loss: 1.570 Test Acc: 0.610
Validation loss decreased (-0.606651 --> -0.609984).  Saving model ...
Epoch: 72 cost time: 5.527810335159302
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.565 Vali Acc: 0.610 Test Loss: 1.565 Test Acc: 0.610
Validation loss decreased (-0.609984 --> -0.609984).  Saving model ...
Epoch: 73 cost time: 5.76893162727356
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.564 Vali Acc: 0.607 Test Loss: 1.564 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 5.787749290466309
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.560 Vali Acc: 0.610 Test Loss: 1.560 Test Acc: 0.610
Validation loss decreased (-0.609984 --> -0.609984).  Saving model ...
Epoch: 75 cost time: 6.011932849884033
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.610 Test Loss: 1.556 Test Acc: 0.610
Validation loss decreased (-0.609984 --> -0.609984).  Saving model ...
Epoch: 76 cost time: 5.717187166213989
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.613 Test Loss: 1.553 Test Acc: 0.613
Validation loss decreased (-0.609984 --> -0.613318).  Saving model ...
Epoch: 77 cost time: 5.824998617172241
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.610 Test Loss: 1.551 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.79678201675415
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.617 Test Loss: 1.551 Test Acc: 0.617
Validation loss decreased (-0.613318 --> -0.616651).  Saving model ...
Epoch: 79 cost time: 6.207108736038208
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.617 Test Loss: 1.549 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616651).  Saving model ...
Epoch: 80 cost time: 5.6883299350738525
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.623 Test Loss: 1.547 Test Acc: 0.623
Validation loss decreased (-0.616651 --> -0.623318).  Saving model ...
Epoch: 81 cost time: 5.874197483062744
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.543 Vali Acc: 0.627 Test Loss: 1.543 Test Acc: 0.627
Validation loss decreased (-0.623318 --> -0.626651).  Saving model ...
Epoch: 82 cost time: 6.130442380905151
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.542 Vali Acc: 0.623 Test Loss: 1.542 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 5.994138479232788
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.627 Test Loss: 1.539 Test Acc: 0.627
Validation loss decreased (-0.626651 --> -0.626651).  Saving model ...
Epoch: 84 cost time: 6.222463846206665
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.630 Test Loss: 1.539 Test Acc: 0.630
Validation loss decreased (-0.626651 --> -0.629985).  Saving model ...
Epoch: 85 cost time: 5.617523670196533
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.627 Test Loss: 1.539 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 5.496448755264282
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.633 Test Loss: 1.539 Test Acc: 0.633
Validation loss decreased (-0.629985 --> -0.633318).  Saving model ...
Epoch: 87 cost time: 5.833745718002319
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.633 Test Loss: 1.535 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633318).  Saving model ...
Epoch: 88 cost time: 5.8319432735443115
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.633 Test Loss: 1.532 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633318).  Saving model ...
Epoch: 89 cost time: 5.673215627670288
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.630 Test Loss: 1.528 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 5.668041467666626
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.627 Test Loss: 1.526 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 5.673475742340088
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.627 Test Loss: 1.523 Test Acc: 0.627
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 5.504161834716797
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.633 Test Loss: 1.520 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633318).  Saving model ...
Epoch: 93 cost time: 5.398024559020996
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.633 Test Loss: 1.519 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633318).  Saving model ...
Epoch: 94 cost time: 5.759492635726929
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.637 Test Loss: 1.519 Test Acc: 0.637
Validation loss decreased (-0.633318 --> -0.636651).  Saving model ...
Epoch: 95 cost time: 5.9449498653411865
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.518 Vali Acc: 0.637 Test Loss: 1.518 Test Acc: 0.637
Validation loss decreased (-0.636651 --> -0.636651).  Saving model ...
Epoch: 96 cost time: 6.088846921920776
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.643 Test Loss: 1.517 Test Acc: 0.643
Validation loss decreased (-0.636651 --> -0.643318).  Saving model ...
Epoch: 97 cost time: 5.546037673950195
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.643 Test Loss: 1.516 Test Acc: 0.643
Validation loss decreased (-0.643318 --> -0.643318).  Saving model ...
Epoch: 98 cost time: 5.257257461547852
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.647 Test Loss: 1.513 Test Acc: 0.647
Validation loss decreased (-0.643318 --> -0.646652).  Saving model ...
Epoch: 99 cost time: 5.590206861495972
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.650 Test Loss: 1.509 Test Acc: 0.650
Validation loss decreased (-0.646652 --> -0.649985).  Saving model ...
Epoch: 100 cost time: 5.6206841468811035
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.653 Test Loss: 1.508 Test Acc: 0.653
Validation loss decreased (-0.649985 --> -0.653318).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6533333333333333
model parameter : 6708249
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.604987859725952
Epoch: 1, Steps: 18 | Train Loss: 3.300 Vali Loss: 3.160 Vali Acc: 0.077 Test Loss: 3.160 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 5.914240837097168
Epoch: 2, Steps: 18 | Train Loss: 2.399 Vali Loss: 2.850 Vali Acc: 0.140 Test Loss: 2.850 Test Acc: 0.140
Validation loss decreased (-0.076635 --> -0.139972).  Saving model ...
Epoch: 3 cost time: 6.13762640953064
Epoch: 3, Steps: 18 | Train Loss: 1.194 Vali Loss: 2.699 Vali Acc: 0.180 Test Loss: 2.699 Test Acc: 0.180
Validation loss decreased (-0.139972 --> -0.179973).  Saving model ...
Epoch: 4 cost time: 5.647871494293213
Epoch: 4, Steps: 18 | Train Loss: 0.375 Vali Loss: 2.734 Vali Acc: 0.220 Test Loss: 2.734 Test Acc: 0.220
Validation loss decreased (-0.179973 --> -0.219973).  Saving model ...
Epoch: 5 cost time: 5.584437608718872
Epoch: 5, Steps: 18 | Train Loss: 0.114 Vali Loss: 2.344 Vali Acc: 0.293 Test Loss: 2.344 Test Acc: 0.293
Validation loss decreased (-0.219973 --> -0.293310).  Saving model ...
Epoch: 6 cost time: 5.3100786209106445
Epoch: 6, Steps: 18 | Train Loss: 0.027 Vali Loss: 2.235 Vali Acc: 0.323 Test Loss: 2.235 Test Acc: 0.323
Validation loss decreased (-0.293310 --> -0.323311).  Saving model ...
Epoch: 7 cost time: 5.920109987258911
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.120 Vali Acc: 0.377 Test Loss: 2.120 Test Acc: 0.377
Validation loss decreased (-0.323311 --> -0.376645).  Saving model ...
Epoch: 8 cost time: 5.848109722137451
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 2.047 Vali Acc: 0.400 Test Loss: 2.047 Test Acc: 0.400
Validation loss decreased (-0.376645 --> -0.399980).  Saving model ...
Epoch: 9 cost time: 6.270700454711914
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.982 Vali Acc: 0.417 Test Loss: 1.982 Test Acc: 0.417
Validation loss decreased (-0.399980 --> -0.416647).  Saving model ...
Epoch: 10 cost time: 5.847071886062622
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.931 Vali Acc: 0.417 Test Loss: 1.931 Test Acc: 0.417
Validation loss decreased (-0.416647 --> -0.416647).  Saving model ...
Epoch: 11 cost time: 5.802900075912476
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.896 Vali Acc: 0.423 Test Loss: 1.896 Test Acc: 0.423
Validation loss decreased (-0.416647 --> -0.423314).  Saving model ...
Epoch: 12 cost time: 6.0721306800842285
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.822 Vali Acc: 0.453 Test Loss: 1.822 Test Acc: 0.453
Validation loss decreased (-0.423314 --> -0.453315).  Saving model ...
Epoch: 13 cost time: 5.975934743881226
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.784 Vali Acc: 0.480 Test Loss: 1.784 Test Acc: 0.480
Validation loss decreased (-0.453315 --> -0.479982).  Saving model ...
Epoch: 14 cost time: 5.721167087554932
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.730 Vali Acc: 0.497 Test Loss: 1.730 Test Acc: 0.497
Validation loss decreased (-0.479982 --> -0.496649).  Saving model ...
Epoch: 15 cost time: 5.797181606292725
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.720 Vali Acc: 0.500 Test Loss: 1.720 Test Acc: 0.500
Validation loss decreased (-0.496649 --> -0.499983).  Saving model ...
Epoch: 16 cost time: 5.743874549865723
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.701 Vali Acc: 0.500 Test Loss: 1.701 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499983).  Saving model ...
Epoch: 17 cost time: 5.783790111541748
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.664 Vali Acc: 0.513 Test Loss: 1.664 Test Acc: 0.513
Validation loss decreased (-0.499983 --> -0.513317).  Saving model ...
Epoch: 18 cost time: 5.680137395858765
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.648 Vali Acc: 0.517 Test Loss: 1.648 Test Acc: 0.517
Validation loss decreased (-0.513317 --> -0.516650).  Saving model ...
Epoch: 19 cost time: 5.745177268981934
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.629 Vali Acc: 0.520 Test Loss: 1.629 Test Acc: 0.520
Validation loss decreased (-0.516650 --> -0.519984).  Saving model ...
Epoch: 20 cost time: 6.026479005813599
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.622 Vali Acc: 0.530 Test Loss: 1.622 Test Acc: 0.530
Validation loss decreased (-0.519984 --> -0.529984).  Saving model ...
Epoch: 21 cost time: 5.218173503875732
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.530 Test Loss: 1.610 Test Acc: 0.530
Validation loss decreased (-0.529984 --> -0.529984).  Saving model ...
Epoch: 22 cost time: 5.461609840393066
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.547 Test Loss: 1.587 Test Acc: 0.547
Validation loss decreased (-0.529984 --> -0.546651).  Saving model ...
Epoch: 23 cost time: 5.898676633834839
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.557 Test Loss: 1.559 Test Acc: 0.557
Validation loss decreased (-0.546651 --> -0.556651).  Saving model ...
Epoch: 24 cost time: 6.023712635040283
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.557 Test Loss: 1.547 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 25 cost time: 6.070575952529907
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.570 Test Loss: 1.530 Test Acc: 0.570
Validation loss decreased (-0.556651 --> -0.569985).  Saving model ...
Epoch: 26 cost time: 5.924288272857666
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.570 Test Loss: 1.508 Test Acc: 0.570
Validation loss decreased (-0.569985 --> -0.569985).  Saving model ...
Epoch: 27 cost time: 6.000958204269409
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.495 Vali Acc: 0.570 Test Loss: 1.495 Test Acc: 0.570
Validation loss decreased (-0.569985 --> -0.569985).  Saving model ...
Epoch: 28 cost time: 5.991584777832031
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.483 Vali Acc: 0.593 Test Loss: 1.483 Test Acc: 0.593
Validation loss decreased (-0.569985 --> -0.593319).  Saving model ...
Epoch: 29 cost time: 5.860884666442871
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.583 Test Loss: 1.473 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.0112998485565186
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.590 Test Loss: 1.467 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.649135112762451
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.590 Test Loss: 1.473 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.721023321151733
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.593 Test Loss: 1.462 Test Acc: 0.593
Validation loss decreased (-0.593319 --> -0.593319).  Saving model ...
Epoch: 33 cost time: 5.670783758163452
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.600 Test Loss: 1.455 Test Acc: 0.600
Validation loss decreased (-0.593319 --> -0.599985).  Saving model ...
Epoch: 34 cost time: 5.898563861846924
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.600 Test Loss: 1.438 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599986).  Saving model ...
Epoch: 35 cost time: 5.870818138122559
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.603 Test Loss: 1.422 Test Acc: 0.603
Validation loss decreased (-0.599986 --> -0.603319).  Saving model ...
Epoch: 36 cost time: 5.961632490158081
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.593 Test Loss: 1.422 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.095158576965332
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.597 Test Loss: 1.416 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 6.147671699523926
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.600 Test Loss: 1.404 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 5.556185007095337
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.597 Test Loss: 1.397 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 5.65250563621521
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.603 Test Loss: 1.395 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 41 cost time: 5.59820556640625
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.607 Test Loss: 1.391 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606653).  Saving model ...
Epoch: 42 cost time: 5.545178174972534
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.597 Test Loss: 1.386 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.04235577583313
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.600 Test Loss: 1.370 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.771074533462524
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.607 Test Loss: 1.365 Test Acc: 0.607
Validation loss decreased (-0.606653 --> -0.606653).  Saving model ...
Epoch: 45 cost time: 5.990421295166016
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.613 Test Loss: 1.357 Test Acc: 0.613
Validation loss decreased (-0.606653 --> -0.613320).  Saving model ...
Epoch: 46 cost time: 5.914014101028442
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.613 Test Loss: 1.350 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 47 cost time: 5.798006296157837
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.617 Test Loss: 1.350 Test Acc: 0.617
Validation loss decreased (-0.613320 --> -0.616653).  Saving model ...
Epoch: 48 cost time: 5.759938955307007
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.613 Test Loss: 1.345 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.784368276596069
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.623 Test Loss: 1.344 Test Acc: 0.623
Validation loss decreased (-0.616653 --> -0.623320).  Saving model ...
Epoch: 50 cost time: 5.5515360832214355
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.620 Test Loss: 1.341 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.883955955505371
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.617 Test Loss: 1.337 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 5.865263938903809
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.334 Vali Acc: 0.630 Test Loss: 1.334 Test Acc: 0.630
Validation loss decreased (-0.623320 --> -0.629987).  Saving model ...
Epoch: 53 cost time: 5.45997428894043
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.633 Test Loss: 1.327 Test Acc: 0.633
Validation loss decreased (-0.629987 --> -0.633320).  Saving model ...
Epoch: 54 cost time: 5.4457879066467285
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.630 Test Loss: 1.323 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.862887859344482
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.640 Test Loss: 1.319 Test Acc: 0.640
Validation loss decreased (-0.633320 --> -0.639987).  Saving model ...
Epoch: 56 cost time: 5.613799333572388
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.637 Test Loss: 1.317 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.037091255187988
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.637 Test Loss: 1.315 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 5.924214601516724
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.633 Test Loss: 1.315 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 6.147982120513916
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.640 Test Loss: 1.314 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639987).  Saving model ...
Epoch: 60 cost time: 6.033060550689697
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.640 Test Loss: 1.312 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639987).  Saving model ...
Epoch: 61 cost time: 5.9131224155426025
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.311 Vali Acc: 0.643 Test Loss: 1.311 Test Acc: 0.643
Validation loss decreased (-0.639987 --> -0.643320).  Saving model ...
Epoch: 62 cost time: 5.819352626800537
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.313 Vali Acc: 0.650 Test Loss: 1.313 Test Acc: 0.650
Validation loss decreased (-0.643320 --> -0.649987).  Saving model ...
Epoch: 63 cost time: 5.791150093078613
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.650 Test Loss: 1.314 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.646764755249023
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.650 Test Loss: 1.312 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 65 cost time: 5.639518737792969
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.306 Vali Acc: 0.653 Test Loss: 1.306 Test Acc: 0.653
Validation loss decreased (-0.649987 --> -0.653320).  Saving model ...
Epoch: 66 cost time: 5.71807599067688
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.302 Vali Acc: 0.653 Test Loss: 1.302 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 67 cost time: 5.464558124542236
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.298 Vali Acc: 0.653 Test Loss: 1.298 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 68 cost time: 5.529122352600098
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.653 Test Loss: 1.299 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.033374547958374
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.294 Vali Acc: 0.647 Test Loss: 1.294 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 5.563496828079224
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.657 Test Loss: 1.292 Test Acc: 0.657
Validation loss decreased (-0.653320 --> -0.656654).  Saving model ...
Epoch: 71 cost time: 5.646216869354248
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.293 Vali Acc: 0.657 Test Loss: 1.293 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.887683153152466
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.289 Vali Acc: 0.657 Test Loss: 1.289 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656654).  Saving model ...
Epoch: 73 cost time: 5.6112329959869385
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.290 Vali Acc: 0.653 Test Loss: 1.290 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 5.914631605148315
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.290 Vali Acc: 0.653 Test Loss: 1.290 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 6.103413820266724
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.660 Test Loss: 1.285 Test Acc: 0.660
Validation loss decreased (-0.656654 --> -0.659987).  Saving model ...
Epoch: 76 cost time: 5.8835976123809814
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.287 Vali Acc: 0.663 Test Loss: 1.287 Test Acc: 0.663
Validation loss decreased (-0.659987 --> -0.663320).  Saving model ...
Epoch: 77 cost time: 5.732372760772705
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.283 Vali Acc: 0.660 Test Loss: 1.283 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.917220830917358
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.280 Vali Acc: 0.660 Test Loss: 1.280 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 5.747689962387085
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.667 Test Loss: 1.276 Test Acc: 0.667
Validation loss decreased (-0.663320 --> -0.666654).  Saving model ...
Epoch: 80 cost time: 5.413743495941162
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.670 Test Loss: 1.275 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669987).  Saving model ...
Epoch: 81 cost time: 5.370101690292358
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.670 Test Loss: 1.274 Test Acc: 0.670
Validation loss decreased (-0.669987 --> -0.669987).  Saving model ...
Epoch: 82 cost time: 5.822503566741943
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.677 Test Loss: 1.273 Test Acc: 0.677
Validation loss decreased (-0.669987 --> -0.676654).  Saving model ...
Epoch: 83 cost time: 6.214903831481934
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.272 Vali Acc: 0.677 Test Loss: 1.272 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 84 cost time: 5.846967697143555
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.677 Test Loss: 1.274 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 5.930722713470459
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.271 Vali Acc: 0.677 Test Loss: 1.271 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 86 cost time: 6.1783835887908936
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.270 Vali Acc: 0.680 Test Loss: 1.270 Test Acc: 0.680
Validation loss decreased (-0.676654 --> -0.679987).  Saving model ...
Epoch: 87 cost time: 5.832225322723389
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.677 Test Loss: 1.268 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 6.084016561508179
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.677 Test Loss: 1.265 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 5.613380432128906
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.673 Test Loss: 1.266 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 5.4898412227630615
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.677 Test Loss: 1.266 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 5.76430344581604
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.683 Test Loss: 1.265 Test Acc: 0.683
Validation loss decreased (-0.679987 --> -0.683321).  Saving model ...
Epoch: 92 cost time: 5.683055877685547
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.683 Test Loss: 1.265 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 93 cost time: 5.858187198638916
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.683 Test Loss: 1.264 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 94 cost time: 5.591882705688477
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.687 Test Loss: 1.263 Test Acc: 0.687
Validation loss decreased (-0.683321 --> -0.686654).  Saving model ...
Epoch: 95 cost time: 5.567646741867065
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.693 Test Loss: 1.264 Test Acc: 0.693
Validation loss decreased (-0.686654 --> -0.693321).  Saving model ...
Epoch: 96 cost time: 5.933776140213013
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.687 Test Loss: 1.264 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 5.839372634887695
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.687 Test Loss: 1.265 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 5.409178733825684
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.697 Test Loss: 1.265 Test Acc: 0.697
Validation loss decreased (-0.693321 --> -0.696654).  Saving model ...
Epoch: 99 cost time: 5.883309841156006
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.697 Test Loss: 1.264 Test Acc: 0.697
Validation loss decreased (-0.696654 --> -0.696654).  Saving model ...
Epoch: 100 cost time: 5.553607940673828
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.700 Test Loss: 1.264 Test Acc: 0.700
Validation loss decreased (-0.696654 --> -0.699987).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7
model parameter : 6708249
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.965967416763306
Epoch: 1, Steps: 18 | Train Loss: 3.280 Vali Loss: 3.202 Vali Acc: 0.077 Test Loss: 3.202 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 5.840227127075195
Epoch: 2, Steps: 18 | Train Loss: 2.474 Vali Loss: 2.909 Vali Acc: 0.133 Test Loss: 2.909 Test Acc: 0.133
Validation loss decreased (-0.076635 --> -0.133304).  Saving model ...
Epoch: 3 cost time: 5.9676833152771
Epoch: 3, Steps: 18 | Train Loss: 1.292 Vali Loss: 2.718 Vali Acc: 0.180 Test Loss: 2.718 Test Acc: 0.180
Validation loss decreased (-0.133304 --> -0.179973).  Saving model ...
Epoch: 4 cost time: 6.364932537078857
Epoch: 4, Steps: 18 | Train Loss: 0.407 Vali Loss: 2.650 Vali Acc: 0.230 Test Loss: 2.650 Test Acc: 0.230
Validation loss decreased (-0.179973 --> -0.229974).  Saving model ...
Epoch: 5 cost time: 5.645845174789429
Epoch: 5, Steps: 18 | Train Loss: 0.115 Vali Loss: 2.243 Vali Acc: 0.313 Test Loss: 2.243 Test Acc: 0.313
Validation loss decreased (-0.229974 --> -0.313311).  Saving model ...
Epoch: 6 cost time: 5.603449821472168
Epoch: 6, Steps: 18 | Train Loss: 0.026 Vali Loss: 2.125 Vali Acc: 0.357 Test Loss: 2.125 Test Acc: 0.357
Validation loss decreased (-0.313311 --> -0.356645).  Saving model ...
Epoch: 7 cost time: 5.491214752197266
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.987 Vali Acc: 0.373 Test Loss: 1.987 Test Acc: 0.373
Validation loss decreased (-0.356645 --> -0.373313).  Saving model ...
Epoch: 8 cost time: 5.865690469741821
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.924 Vali Acc: 0.420 Test Loss: 1.924 Test Acc: 0.420
Validation loss decreased (-0.373313 --> -0.419981).  Saving model ...
Epoch: 9 cost time: 6.362206935882568
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.846 Vali Acc: 0.450 Test Loss: 1.846 Test Acc: 0.450
Validation loss decreased (-0.419981 --> -0.449982).  Saving model ...
Epoch: 10 cost time: 5.798069000244141
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.801 Vali Acc: 0.440 Test Loss: 1.801 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.837814092636108
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.762 Vali Acc: 0.453 Test Loss: 1.762 Test Acc: 0.453
Validation loss decreased (-0.449982 --> -0.453316).  Saving model ...
Epoch: 12 cost time: 5.908092737197876
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.709 Vali Acc: 0.470 Test Loss: 1.709 Test Acc: 0.470
Validation loss decreased (-0.453316 --> -0.469983).  Saving model ...
Epoch: 13 cost time: 5.770392417907715
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.675 Vali Acc: 0.497 Test Loss: 1.675 Test Acc: 0.497
Validation loss decreased (-0.469983 --> -0.496650).  Saving model ...
Epoch: 14 cost time: 5.572173357009888
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.507 Test Loss: 1.641 Test Acc: 0.507
Validation loss decreased (-0.496650 --> -0.506650).  Saving model ...
Epoch: 15 cost time: 5.782486438751221
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.621 Vali Acc: 0.517 Test Loss: 1.621 Test Acc: 0.517
Validation loss decreased (-0.506650 --> -0.516650).  Saving model ...
Epoch: 16 cost time: 5.349286317825317
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.590 Vali Acc: 0.530 Test Loss: 1.590 Test Acc: 0.530
Validation loss decreased (-0.516650 --> -0.529984).  Saving model ...
Epoch: 17 cost time: 6.117755651473999
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.553 Vali Acc: 0.537 Test Loss: 1.553 Test Acc: 0.537
Validation loss decreased (-0.529984 --> -0.536651).  Saving model ...
Epoch: 18 cost time: 5.68682599067688
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.528 Vali Acc: 0.547 Test Loss: 1.528 Test Acc: 0.547
Validation loss decreased (-0.536651 --> -0.546651).  Saving model ...
Epoch: 19 cost time: 5.682855844497681
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.506 Vali Acc: 0.553 Test Loss: 1.506 Test Acc: 0.553
Validation loss decreased (-0.546651 --> -0.553318).  Saving model ...
Epoch: 20 cost time: 5.798945665359497
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.557 Test Loss: 1.505 Test Acc: 0.557
Validation loss decreased (-0.553318 --> -0.556652).  Saving model ...
Epoch: 21 cost time: 5.669700860977173
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.553 Test Loss: 1.497 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.887828588485718
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.475 Vali Acc: 0.573 Test Loss: 1.475 Test Acc: 0.573
Validation loss decreased (-0.556652 --> -0.573319).  Saving model ...
Epoch: 23 cost time: 5.722023963928223
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.590 Test Loss: 1.450 Test Acc: 0.590
Validation loss decreased (-0.573319 --> -0.589985).  Saving model ...
Epoch: 24 cost time: 5.427683353424072
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.593 Test Loss: 1.433 Test Acc: 0.593
Validation loss decreased (-0.589985 --> -0.593319).  Saving model ...
Epoch: 25 cost time: 5.7507593631744385
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.600 Test Loss: 1.425 Test Acc: 0.600
Validation loss decreased (-0.593319 --> -0.599986).  Saving model ...
Epoch: 26 cost time: 5.910701274871826
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.603 Test Loss: 1.414 Test Acc: 0.603
Validation loss decreased (-0.599986 --> -0.603319).  Saving model ...
Epoch: 27 cost time: 5.9135119915008545
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.610 Test Loss: 1.411 Test Acc: 0.610
Validation loss decreased (-0.603319 --> -0.609986).  Saving model ...
Epoch: 28 cost time: 5.6424241065979
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.610 Test Loss: 1.393 Test Acc: 0.610
Validation loss decreased (-0.609986 --> -0.609986).  Saving model ...
Epoch: 29 cost time: 5.981281280517578
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.379 Vali Acc: 0.620 Test Loss: 1.379 Test Acc: 0.620
Validation loss decreased (-0.609986 --> -0.619986).  Saving model ...
Epoch: 30 cost time: 5.798169851303101
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.617 Test Loss: 1.370 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.908345699310303
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.630 Test Loss: 1.364 Test Acc: 0.630
Validation loss decreased (-0.619986 --> -0.629986).  Saving model ...
Epoch: 32 cost time: 5.756973028182983
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.637 Test Loss: 1.348 Test Acc: 0.637
Validation loss decreased (-0.629986 --> -0.636653).  Saving model ...
Epoch: 33 cost time: 6.003021478652954
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.640 Test Loss: 1.342 Test Acc: 0.640
Validation loss decreased (-0.636653 --> -0.639987).  Saving model ...
Epoch: 34 cost time: 5.630321502685547
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.334 Vali Acc: 0.640 Test Loss: 1.334 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639987).  Saving model ...
Epoch: 35 cost time: 5.571552276611328
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.643 Test Loss: 1.324 Test Acc: 0.643
Validation loss decreased (-0.639987 --> -0.643320).  Saving model ...
Epoch: 36 cost time: 5.916726350784302
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.643 Test Loss: 1.323 Test Acc: 0.643
Validation loss decreased (-0.643320 --> -0.643320).  Saving model ...
Epoch: 37 cost time: 5.369984149932861
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.650 Test Loss: 1.315 Test Acc: 0.650
Validation loss decreased (-0.643320 --> -0.649987).  Saving model ...
Epoch: 38 cost time: 5.718348741531372
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.307 Vali Acc: 0.657 Test Loss: 1.307 Test Acc: 0.657
Validation loss decreased (-0.649987 --> -0.656654).  Saving model ...
Epoch: 39 cost time: 5.424633026123047
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.298 Vali Acc: 0.660 Test Loss: 1.298 Test Acc: 0.660
Validation loss decreased (-0.656654 --> -0.659987).  Saving model ...
Epoch: 40 cost time: 5.531684160232544
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.663 Test Loss: 1.295 Test Acc: 0.663
Validation loss decreased (-0.659987 --> -0.663320).  Saving model ...
Epoch: 41 cost time: 5.48724889755249
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.657 Test Loss: 1.292 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.68496036529541
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.287 Vali Acc: 0.667 Test Loss: 1.287 Test Acc: 0.667
Validation loss decreased (-0.663320 --> -0.666654).  Saving model ...
Epoch: 43 cost time: 5.825868606567383
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.663 Test Loss: 1.281 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.545766592025757
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.663 Test Loss: 1.274 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 5.74311637878418
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.670 Test Loss: 1.266 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669987).  Saving model ...
Epoch: 46 cost time: 6.059247732162476
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.673 Test Loss: 1.259 Test Acc: 0.673
Validation loss decreased (-0.669987 --> -0.673321).  Saving model ...
Epoch: 47 cost time: 5.736797094345093
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.677 Test Loss: 1.259 Test Acc: 0.677
Validation loss decreased (-0.673321 --> -0.676654).  Saving model ...
Epoch: 48 cost time: 5.425211429595947
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.673 Test Loss: 1.255 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.243225812911987
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.680 Test Loss: 1.252 Test Acc: 0.680
Validation loss decreased (-0.676654 --> -0.679987).  Saving model ...
Epoch: 50 cost time: 6.112538576126099
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.683 Test Loss: 1.248 Test Acc: 0.683
Validation loss decreased (-0.679987 --> -0.683321).  Saving model ...
Epoch: 51 cost time: 6.070487022399902
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.244 Vali Acc: 0.683 Test Loss: 1.244 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 52 cost time: 5.50140118598938
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.243 Vali Acc: 0.690 Test Loss: 1.243 Test Acc: 0.690
Validation loss decreased (-0.683321 --> -0.689988).  Saving model ...
Epoch: 53 cost time: 6.443545579910278
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.690 Test Loss: 1.238 Test Acc: 0.690
Validation loss decreased (-0.689988 --> -0.689988).  Saving model ...
Epoch: 54 cost time: 5.9399940967559814
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.693 Test Loss: 1.233 Test Acc: 0.693
Validation loss decreased (-0.689988 --> -0.693321).  Saving model ...
Epoch: 55 cost time: 5.7129199504852295
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.697 Test Loss: 1.230 Test Acc: 0.697
Validation loss decreased (-0.693321 --> -0.696654).  Saving model ...
Epoch: 56 cost time: 5.649171352386475
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.700 Test Loss: 1.228 Test Acc: 0.700
Validation loss decreased (-0.696654 --> -0.699988).  Saving model ...
Epoch: 57 cost time: 6.04932713508606
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.697 Test Loss: 1.225 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 5.538023233413696
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.703 Test Loss: 1.224 Test Acc: 0.703
Validation loss decreased (-0.699988 --> -0.703321).  Saving model ...
Epoch: 59 cost time: 5.805515289306641
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.703 Test Loss: 1.221 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 60 cost time: 5.294262170791626
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.700 Test Loss: 1.222 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 5.631863832473755
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.700 Test Loss: 1.219 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 5.472737073898315
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.700 Test Loss: 1.218 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 5.898988485336304
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.700 Test Loss: 1.219 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 6.346312522888184
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.710 Test Loss: 1.216 Test Acc: 0.710
Validation loss decreased (-0.703321 --> -0.709988).  Saving model ...
Epoch: 65 cost time: 5.581120491027832
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.707 Test Loss: 1.210 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.630595684051514
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.707 Test Loss: 1.210 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 6.049218416213989
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.710 Test Loss: 1.207 Test Acc: 0.710
Validation loss decreased (-0.709988 --> -0.709988).  Saving model ...
Epoch: 68 cost time: 5.750040292739868
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.713 Test Loss: 1.207 Test Acc: 0.713
Validation loss decreased (-0.709988 --> -0.713321).  Saving model ...
Epoch: 69 cost time: 6.366701364517212
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.713 Test Loss: 1.204 Test Acc: 0.713
Validation loss decreased (-0.713321 --> -0.713321).  Saving model ...
Epoch: 70 cost time: 5.446314811706543
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.713 Test Loss: 1.203 Test Acc: 0.713
Validation loss decreased (-0.713321 --> -0.713321).  Saving model ...
Epoch: 71 cost time: 5.913288831710815
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.713 Test Loss: 1.204 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.797560214996338
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.713 Test Loss: 1.202 Test Acc: 0.713
Validation loss decreased (-0.713321 --> -0.713321).  Saving model ...
Epoch: 73 cost time: 5.754671335220337
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.713 Test Loss: 1.202 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 6.002213001251221
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.713 Test Loss: 1.202 Test Acc: 0.713
Validation loss decreased (-0.713321 --> -0.713321).  Saving model ...
Epoch: 75 cost time: 5.832921504974365
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.713 Test Loss: 1.198 Test Acc: 0.713
Validation loss decreased (-0.713321 --> -0.713321).  Saving model ...
Epoch: 76 cost time: 5.738397598266602
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.720 Test Loss: 1.201 Test Acc: 0.720
Validation loss decreased (-0.713321 --> -0.719988).  Saving model ...
Epoch: 77 cost time: 6.0196592807769775
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.720 Test Loss: 1.198 Test Acc: 0.720
Validation loss decreased (-0.719988 --> -0.719988).  Saving model ...
Epoch: 78 cost time: 5.3809661865234375
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.197 Vali Acc: 0.720 Test Loss: 1.197 Test Acc: 0.720
Validation loss decreased (-0.719988 --> -0.719988).  Saving model ...
Epoch: 79 cost time: 5.90786337852478
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.720 Test Loss: 1.194 Test Acc: 0.720
Validation loss decreased (-0.719988 --> -0.719988).  Saving model ...
Epoch: 80 cost time: 5.90852165222168
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.720 Test Loss: 1.192 Test Acc: 0.720
Validation loss decreased (-0.719988 --> -0.719988).  Saving model ...
Epoch: 81 cost time: 6.0152623653411865
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.720 Test Loss: 1.192 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 5.884753227233887
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.720 Test Loss: 1.192 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 5.411622524261475
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.720 Test Loss: 1.193 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 5.181572437286377
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.720 Test Loss: 1.193 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 4.962538719177246
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.191 Vali Acc: 0.720 Test Loss: 1.191 Test Acc: 0.720
Validation loss decreased (-0.719988 --> -0.719988).  Saving model ...
Epoch: 86 cost time: 6.014899015426636
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.720 Test Loss: 1.190 Test Acc: 0.720
Validation loss decreased (-0.719988 --> -0.719988).  Saving model ...
Epoch: 87 cost time: 5.450079441070557
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.720 Test Loss: 1.189 Test Acc: 0.720
Validation loss decreased (-0.719988 --> -0.719988).  Saving model ...
Epoch: 88 cost time: 5.65017294883728
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.723 Test Loss: 1.189 Test Acc: 0.723
Validation loss decreased (-0.719988 --> -0.723321).  Saving model ...
Epoch: 89 cost time: 6.013314247131348
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.720 Test Loss: 1.190 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 5.700087785720825
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.720 Test Loss: 1.190 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 6.362992286682129
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.720 Test Loss: 1.190 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 5.903540372848511
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.723 Test Loss: 1.188 Test Acc: 0.723
Validation loss decreased (-0.723321 --> -0.723321).  Saving model ...
Epoch: 93 cost time: 5.856060028076172
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.727 Test Loss: 1.187 Test Acc: 0.727
Validation loss decreased (-0.723321 --> -0.726655).  Saving model ...
Epoch: 94 cost time: 5.9131927490234375
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.727 Test Loss: 1.188 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 5.3504674434661865
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.727 Test Loss: 1.189 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 5.452716588973999
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.727 Test Loss: 1.188 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 5.431462287902832
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.727 Test Loss: 1.188 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 6.012218236923218
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.727 Test Loss: 1.188 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 5.678514242172241
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.727 Test Loss: 1.187 Test Acc: 0.727
Validation loss decreased (-0.726655 --> -0.726655).  Saving model ...
Epoch: 100 cost time: 5.96869421005249
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.727 Test Loss: 1.187 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7266666666666667
model parameter : 6708249
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.694382190704346
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 5.636751651763916
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.703192949295044
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.581751108169556
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.752325534820557
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 6 cost time: 5.867422580718994
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 7 cost time: 5.91313624382019
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.664990663528442
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 9 cost time: 5.5839314460754395
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 10 cost time: 5.728209018707275
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.925827503204346
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.761653661727905
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.463521718978882
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.7323157787323
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.6652772426605225
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 16 cost time: 5.581438779830933
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.5549397468566895
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.444644451141357
Epoch: 18, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 19 cost time: 5.35842490196228
Epoch: 19, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.445196866989136
Epoch: 20, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.79901647567749
Epoch: 21, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.833574056625366
Epoch: 22, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.5566887855529785
Epoch: 23, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.0516357421875
Epoch: 24, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.025144100189209
Epoch: 25, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.951277256011963
Epoch: 26, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.621019601821899
Epoch: 27, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.966350317001343
Epoch: 28, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 6708249
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.841400861740112
Epoch: 1, Steps: 18 | Train Loss: 2.846 Vali Loss: 1.658 Vali Acc: 0.747 Test Loss: 1.658 Test Acc: 0.747
Validation loss decreased (inf --> -0.746650).  Saving model ...
Epoch: 2 cost time: 5.842068672180176
Epoch: 2, Steps: 18 | Train Loss: 0.756 Vali Loss: 0.632 Vali Acc: 0.830 Test Loss: 0.632 Test Acc: 0.830
Validation loss decreased (-0.746650 --> -0.829994).  Saving model ...
Epoch: 3 cost time: 5.825422763824463
Epoch: 3, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.496 Vali Acc: 0.860 Test Loss: 0.496 Test Acc: 0.860
Validation loss decreased (-0.829994 --> -0.859995).  Saving model ...
Epoch: 4 cost time: 5.66322135925293
Epoch: 4, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.464 Vali Acc: 0.870 Test Loss: 0.464 Test Acc: 0.870
Validation loss decreased (-0.859995 --> -0.869995).  Saving model ...
Epoch: 5 cost time: 5.6360204219818115
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.408 Vali Acc: 0.893 Test Loss: 0.408 Test Acc: 0.893
Validation loss decreased (-0.869995 --> -0.893329).  Saving model ...
Epoch: 6 cost time: 5.853162527084351
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.396 Vali Acc: 0.890 Test Loss: 0.396 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.61675500869751
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.380 Vali Acc: 0.897 Test Loss: 0.380 Test Acc: 0.897
Validation loss decreased (-0.893329 --> -0.896663).  Saving model ...
Epoch: 8 cost time: 5.382695436477661
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.893 Test Loss: 0.377 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.715625047683716
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
Validation loss decreased (-0.896663 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 5.665117025375366
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 5.663544178009033
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.903 Test Loss: 0.366 Test Acc: 0.903
Validation loss decreased (-0.899996 --> -0.903330).  Saving model ...
Epoch: 12 cost time: 5.851497411727905
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.903 Test Loss: 0.366 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 13 cost time: 6.015136957168579
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 14 cost time: 6.265725612640381
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.907 Test Loss: 0.359 Test Acc: 0.907
Validation loss decreased (-0.903330 --> -0.906663).  Saving model ...
Epoch: 15 cost time: 6.032412767410278
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.251135349273682
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.753845691680908
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.517278671264648
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.659298658370972
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.776885271072388
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.646026372909546
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.076782941818237
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.692389011383057
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.649894952774048
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9066666666666666
model parameter : 5135385
model size : 29.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.01404881477356
Epoch: 1, Steps: 18 | Train Loss: 2.979 Vali Loss: 2.005 Vali Acc: 0.633 Test Loss: 2.005 Test Acc: 0.633
Validation loss decreased (inf --> -0.633313).  Saving model ...
Epoch: 2 cost time: 5.703014373779297
Epoch: 2, Steps: 18 | Train Loss: 1.031 Vali Loss: 0.888 Vali Acc: 0.793 Test Loss: 0.888 Test Acc: 0.793
Validation loss decreased (-0.633313 --> -0.793324).  Saving model ...
Epoch: 3 cost time: 5.2680885791778564
Epoch: 3, Steps: 18 | Train Loss: 0.185 Vali Loss: 0.643 Vali Acc: 0.827 Test Loss: 0.643 Test Acc: 0.827
Validation loss decreased (-0.793324 --> -0.826660).  Saving model ...
Epoch: 4 cost time: 5.543715238571167
Epoch: 4, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.607 Vali Acc: 0.843 Test Loss: 0.607 Test Acc: 0.843
Validation loss decreased (-0.826660 --> -0.843327).  Saving model ...
Epoch: 5 cost time: 6.013134002685547
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.558 Vali Acc: 0.853 Test Loss: 0.558 Test Acc: 0.853
Validation loss decreased (-0.843327 --> -0.853328).  Saving model ...
Epoch: 6 cost time: 5.346015691757202
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.530 Vali Acc: 0.860 Test Loss: 0.530 Test Acc: 0.860
Validation loss decreased (-0.853328 --> -0.859995).  Saving model ...
Epoch: 7 cost time: 5.602219343185425
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.860 Test Loss: 0.517 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 8 cost time: 5.527552843093872
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.866870164871216
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.857 Test Loss: 0.521 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.838522672653198
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.860 Test Loss: 0.516 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 11 cost time: 6.129162549972534
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.853 Test Loss: 0.514 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.0572710037231445
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.857 Test Loss: 0.515 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.5982911586761475
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.860 Test Loss: 0.514 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 14 cost time: 5.793086528778076
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.860 Test Loss: 0.511 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 15 cost time: 5.866898775100708
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.863 Test Loss: 0.514 Test Acc: 0.863
Validation loss decreased (-0.859995 --> -0.863328).  Saving model ...
Epoch: 16 cost time: 6.094370365142822
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.860 Test Loss: 0.515 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.595223903656006
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.863 Test Loss: 0.511 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 18 cost time: 5.797656536102295
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.863 Test Loss: 0.510 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 19 cost time: 5.797411680221558
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.863 Test Loss: 0.514 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.891185998916626
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
Validation loss decreased (-0.863328 --> -0.866662).  Saving model ...
Epoch: 21 cost time: 5.891682147979736
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.863 Test Loss: 0.516 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.038373231887817
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.860 Test Loss: 0.516 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.765648365020752
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.863 Test Loss: 0.515 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.739259719848633
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 25 cost time: 5.704394578933716
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.863 Test Loss: 0.514 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.85648775100708
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.863 Test Loss: 0.514 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.115896701812744
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.863 Test Loss: 0.516 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.794206380844116
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.867 Test Loss: 0.515 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.711294651031494
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.860 Test Loss: 0.516 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.94780421257019
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.860 Test Loss: 0.518 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.261003494262695
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.853 Test Loss: 0.518 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.657837152481079
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.860 Test Loss: 0.519 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.400503635406494
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.860 Test Loss: 0.518 Test Acc: 0.860
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.47784948348999
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8666666666666667
model parameter : 5135385
model size : 29.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.305625677108765
Epoch: 1, Steps: 18 | Train Loss: 3.122 Vali Loss: 2.414 Vali Acc: 0.503 Test Loss: 2.414 Test Acc: 0.503
Validation loss decreased (inf --> -0.503309).  Saving model ...
Epoch: 2 cost time: 5.806716680526733
Epoch: 2, Steps: 18 | Train Loss: 1.485 Vali Loss: 1.373 Vali Acc: 0.687 Test Loss: 1.373 Test Acc: 0.687
Validation loss decreased (-0.503309 --> -0.686653).  Saving model ...
Epoch: 3 cost time: 5.7246410846710205
Epoch: 3, Steps: 18 | Train Loss: 0.324 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
Validation loss decreased (-0.686653 --> -0.749990).  Saving model ...
Epoch: 4 cost time: 5.660759687423706
Epoch: 4, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.939 Vali Acc: 0.723 Test Loss: 0.939 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.56105899810791
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.815 Vali Acc: 0.787 Test Loss: 0.815 Test Acc: 0.787
Validation loss decreased (-0.749990 --> -0.786659).  Saving model ...
Epoch: 6 cost time: 5.622341632843018
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.881 Vali Acc: 0.753 Test Loss: 0.881 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.5001466274261475
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.837 Vali Acc: 0.787 Test Loss: 0.837 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.131415605545044
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.831 Vali Acc: 0.787 Test Loss: 0.831 Test Acc: 0.787
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.444265365600586
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.780 Test Loss: 0.829 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.819650888442993
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.787 Test Loss: 0.828 Test Acc: 0.787
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.858560085296631
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.826 Vali Acc: 0.783 Test Loss: 0.826 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.582047939300537
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.783 Test Loss: 0.827 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.72097373008728
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.826 Vali Acc: 0.790 Test Loss: 0.826 Test Acc: 0.790
Validation loss decreased (-0.786659 --> -0.789992).  Saving model ...
Epoch: 14 cost time: 5.797682046890259
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.800 Test Loss: 0.827 Test Acc: 0.800
Validation loss decreased (-0.789992 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 5.265812158584595
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.793 Test Loss: 0.834 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.654417991638184
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.790 Test Loss: 0.835 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.5715651512146
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.830 Vali Acc: 0.800 Test Loss: 0.830 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.974957227706909
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.793 Test Loss: 0.833 Test Acc: 0.793
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.731294393539429
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.790 Test Loss: 0.837 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.5140345096588135
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.793 Test Loss: 0.838 Test Acc: 0.793
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.092582702636719
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.790 Test Loss: 0.840 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.801845073699951
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.790 Test Loss: 0.841 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.43708610534668
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.800 Test Loss: 0.840 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.6385276317596436
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.800 Test Loss: 0.839 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8
model parameter : 5135385
model size : 29.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.646538734436035
Epoch: 1, Steps: 18 | Train Loss: 3.200 Vali Loss: 2.732 Vali Acc: 0.347 Test Loss: 2.732 Test Acc: 0.347
Validation loss decreased (inf --> -0.346639).  Saving model ...
Epoch: 2 cost time: 5.524601697921753
Epoch: 2, Steps: 18 | Train Loss: 1.937 Vali Loss: 1.996 Vali Acc: 0.470 Test Loss: 1.996 Test Acc: 0.470
Validation loss decreased (-0.346639 --> -0.469980).  Saving model ...
Epoch: 3 cost time: 5.408376455307007
Epoch: 3, Steps: 18 | Train Loss: 0.611 Vali Loss: 1.451 Vali Acc: 0.543 Test Loss: 1.451 Test Acc: 0.543
Validation loss decreased (-0.469980 --> -0.543319).  Saving model ...
Epoch: 4 cost time: 5.408346891403198
Epoch: 4, Steps: 18 | Train Loss: 0.131 Vali Loss: 1.458 Vali Acc: 0.547 Test Loss: 1.458 Test Acc: 0.547
Validation loss decreased (-0.543319 --> -0.546652).  Saving model ...
Epoch: 5 cost time: 5.2818443775177
Epoch: 5, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.243 Vali Acc: 0.593 Test Loss: 1.243 Test Acc: 0.593
Validation loss decreased (-0.546652 --> -0.593321).  Saving model ...
Epoch: 6 cost time: 5.236481666564941
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.235 Vali Acc: 0.627 Test Loss: 1.235 Test Acc: 0.627
Validation loss decreased (-0.593321 --> -0.626654).  Saving model ...
Epoch: 7 cost time: 5.415808916091919
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.173 Vali Acc: 0.647 Test Loss: 1.173 Test Acc: 0.647
Validation loss decreased (-0.626654 --> -0.646655).  Saving model ...
Epoch: 8 cost time: 5.365020036697388
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.146 Vali Acc: 0.653 Test Loss: 1.146 Test Acc: 0.653
Validation loss decreased (-0.646655 --> -0.653322).  Saving model ...
Epoch: 9 cost time: 5.155274152755737
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.138 Vali Acc: 0.660 Test Loss: 1.138 Test Acc: 0.660
Validation loss decreased (-0.653322 --> -0.659989).  Saving model ...
Epoch: 10 cost time: 5.189520835876465
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.128 Vali Acc: 0.663 Test Loss: 1.128 Test Acc: 0.663
Validation loss decreased (-0.659989 --> -0.663322).  Saving model ...
Epoch: 11 cost time: 5.61205530166626
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.128 Vali Acc: 0.653 Test Loss: 1.128 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.553754091262817
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.126 Vali Acc: 0.660 Test Loss: 1.126 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.4627015590667725
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.121 Vali Acc: 0.660 Test Loss: 1.121 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.386484146118164
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.116 Vali Acc: 0.663 Test Loss: 1.116 Test Acc: 0.663
Validation loss decreased (-0.663322 --> -0.663322).  Saving model ...
Epoch: 15 cost time: 5.274549961090088
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.116 Vali Acc: 0.663 Test Loss: 1.116 Test Acc: 0.663
Validation loss decreased (-0.663322 --> -0.663322).  Saving model ...
Epoch: 16 cost time: 5.1513352394104
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.112 Vali Acc: 0.670 Test Loss: 1.112 Test Acc: 0.670
Validation loss decreased (-0.663322 --> -0.669989).  Saving model ...
Epoch: 17 cost time: 5.5600316524505615
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.104 Vali Acc: 0.667 Test Loss: 1.104 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.568359375
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.107 Vali Acc: 0.667 Test Loss: 1.107 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.000100374221802
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.667 Test Loss: 1.108 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.848670721054077
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.107 Vali Acc: 0.667 Test Loss: 1.107 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.239725112915039
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.104 Vali Acc: 0.670 Test Loss: 1.104 Test Acc: 0.670
Validation loss decreased (-0.669989 --> -0.669989).  Saving model ...
Epoch: 22 cost time: 5.475847005844116
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.101 Vali Acc: 0.667 Test Loss: 1.101 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.378877878189087
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.093 Vali Acc: 0.673 Test Loss: 1.093 Test Acc: 0.673
Validation loss decreased (-0.669989 --> -0.673322).  Saving model ...
Epoch: 24 cost time: 5.27215051651001
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.677 Test Loss: 1.090 Test Acc: 0.677
Validation loss decreased (-0.673322 --> -0.676656).  Saving model ...
Epoch: 25 cost time: 5.3634192943573
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.091 Vali Acc: 0.673 Test Loss: 1.091 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.4692301750183105
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.088 Vali Acc: 0.673 Test Loss: 1.088 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.23962926864624
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.673 Test Loss: 1.087 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.483953952789307
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.083 Vali Acc: 0.677 Test Loss: 1.083 Test Acc: 0.677
Validation loss decreased (-0.676656 --> -0.676656).  Saving model ...
Epoch: 29 cost time: 5.242156505584717
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.083 Vali Acc: 0.677 Test Loss: 1.083 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.359058856964111
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.084 Vali Acc: 0.683 Test Loss: 1.084 Test Acc: 0.683
Validation loss decreased (-0.676656 --> -0.683322).  Saving model ...
Epoch: 31 cost time: 5.64902400970459
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.680 Test Loss: 1.081 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.40925407409668
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.079 Vali Acc: 0.687 Test Loss: 1.079 Test Acc: 0.687
Validation loss decreased (-0.683322 --> -0.686656).  Saving model ...
Epoch: 33 cost time: 5.594434499740601
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.079 Vali Acc: 0.687 Test Loss: 1.079 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.153710842132568
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.693 Test Loss: 1.074 Test Acc: 0.693
Validation loss decreased (-0.686656 --> -0.693323).  Saving model ...
Epoch: 35 cost time: 5.573461055755615
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.693 Test Loss: 1.075 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.225006818771362
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.693 Test Loss: 1.074 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 37 cost time: 5.0661022663116455
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.697 Test Loss: 1.074 Test Acc: 0.697
Validation loss decreased (-0.693323 --> -0.696656).  Saving model ...
Epoch: 38 cost time: 5.209109783172607
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.693 Test Loss: 1.073 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.138816595077515
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.697 Test Loss: 1.075 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 5.4633893966674805
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.697 Test Loss: 1.072 Test Acc: 0.697
Validation loss decreased (-0.696656 --> -0.696656).  Saving model ...
Epoch: 41 cost time: 5.511432409286499
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.693 Test Loss: 1.073 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.410449504852295
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.697 Test Loss: 1.072 Test Acc: 0.697
Validation loss decreased (-0.696656 --> -0.696656).  Saving model ...
Epoch: 43 cost time: 5.2780139446258545
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.697 Test Loss: 1.071 Test Acc: 0.697
Validation loss decreased (-0.696656 --> -0.696656).  Saving model ...
Epoch: 44 cost time: 5.196606636047363
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.067 Vali Acc: 0.697 Test Loss: 1.067 Test Acc: 0.697
Validation loss decreased (-0.696656 --> -0.696656).  Saving model ...
Epoch: 45 cost time: 5.607560157775879
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.700 Test Loss: 1.069 Test Acc: 0.700
Validation loss decreased (-0.696656 --> -0.699989).  Saving model ...
Epoch: 46 cost time: 5.235702753067017
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.703 Test Loss: 1.069 Test Acc: 0.703
Validation loss decreased (-0.699989 --> -0.703323).  Saving model ...
Epoch: 47 cost time: 5.272172451019287
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.700 Test Loss: 1.069 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.522757053375244
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.697 Test Loss: 1.069 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 5.563733100891113
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.703 Test Loss: 1.068 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 50 cost time: 5.4356935024261475
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.066 Vali Acc: 0.703 Test Loss: 1.066 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 51 cost time: 5.265722990036011
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.179409742355347
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.064 Vali Acc: 0.707 Test Loss: 1.064 Test Acc: 0.707
Validation loss decreased (-0.703323 --> -0.706656).  Saving model ...
Epoch: 53 cost time: 5.504642963409424
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.063 Vali Acc: 0.710 Test Loss: 1.063 Test Acc: 0.710
Validation loss decreased (-0.706656 --> -0.709989).  Saving model ...
Epoch: 54 cost time: 5.556575536727905
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.713 Test Loss: 1.059 Test Acc: 0.713
Validation loss decreased (-0.709989 --> -0.713323).  Saving model ...
Epoch: 55 cost time: 5.537607431411743
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.710 Test Loss: 1.058 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 5.5510337352752686
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.713 Test Loss: 1.059 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 57 cost time: 5.494235277175903
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.713 Test Loss: 1.058 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 58 cost time: 5.4844677448272705
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.717 Test Loss: 1.057 Test Acc: 0.717
Validation loss decreased (-0.713323 --> -0.716656).  Saving model ...
Epoch: 59 cost time: 5.346991777420044
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.713 Test Loss: 1.059 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.277597904205322
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.713 Test Loss: 1.061 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 5.300093650817871
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.717 Test Loss: 1.058 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 5.316255807876587
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.717 Test Loss: 1.059 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 5.015423774719238
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.717 Test Loss: 1.060 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 5.251976251602173
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.713 Test Loss: 1.061 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 5.105566740036011
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.717 Test Loss: 1.059 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 5.324122190475464
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.717 Test Loss: 1.058 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 5.448933839797974
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.717 Test Loss: 1.059 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 5.340083360671997
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.720 Test Loss: 1.057 Test Acc: 0.720
Validation loss decreased (-0.716656 --> -0.719989).  Saving model ...
Epoch: 69 cost time: 5.13978385925293
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.720 Test Loss: 1.057 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 5.451945066452026
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.720 Test Loss: 1.057 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 5.396462440490723
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.720 Test Loss: 1.057 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 5.524566411972046
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.720 Test Loss: 1.056 Test Acc: 0.720
Validation loss decreased (-0.719989 --> -0.719989).  Saving model ...
Epoch: 73 cost time: 5.011426687240601
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.720 Test Loss: 1.056 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 5.13045859336853
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.723 Test Loss: 1.055 Test Acc: 0.723
Validation loss decreased (-0.719989 --> -0.723323).  Saving model ...
Epoch: 75 cost time: 5.0043230056762695
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.720 Test Loss: 1.056 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 5.221492528915405
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.727 Test Loss: 1.056 Test Acc: 0.727
Validation loss decreased (-0.723323 --> -0.726656).  Saving model ...
Epoch: 77 cost time: 5.209948301315308
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.723 Test Loss: 1.055 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.337339401245117
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.727 Test Loss: 1.055 Test Acc: 0.727
Validation loss decreased (-0.726656 --> -0.726656).  Saving model ...
Epoch: 79 cost time: 5.4174964427948
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.727 Test Loss: 1.053 Test Acc: 0.727
Validation loss decreased (-0.726656 --> -0.726656).  Saving model ...
Epoch: 80 cost time: 5.246648788452148
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.727 Test Loss: 1.056 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 5.341026782989502
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.723 Test Loss: 1.055 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 5.319758415222168
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.727 Test Loss: 1.054 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 5.3338963985443115
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.727 Test Loss: 1.054 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 5.241352796554565
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.727 Test Loss: 1.055 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 5.495711803436279
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.727 Test Loss: 1.055 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 5.319873094558716
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.727 Test Loss: 1.056 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 5.36606764793396
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.727 Test Loss: 1.056 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 5.359447717666626
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.730 Test Loss: 1.055 Test Acc: 0.730
Validation loss decreased (-0.726656 --> -0.729989).  Saving model ...
Epoch: 89 cost time: 5.183253765106201
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.730 Test Loss: 1.055 Test Acc: 0.730
Validation loss decreased (-0.729989 --> -0.729989).  Saving model ...
Epoch: 90 cost time: 5.088894367218018
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.730 Test Loss: 1.054 Test Acc: 0.730
Validation loss decreased (-0.729989 --> -0.729989).  Saving model ...
Epoch: 91 cost time: 4.995166063308716
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.737 Test Loss: 1.053 Test Acc: 0.737
Validation loss decreased (-0.729989 --> -0.736656).  Saving model ...
Epoch: 92 cost time: 4.888054847717285
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.737 Test Loss: 1.053 Test Acc: 0.737
Validation loss decreased (-0.736656 --> -0.736656).  Saving model ...
Epoch: 93 cost time: 5.462080955505371
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.740 Test Loss: 1.052 Test Acc: 0.740
Validation loss decreased (-0.736656 --> -0.739989).  Saving model ...
Epoch: 94 cost time: 5.404066324234009
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.740 Test Loss: 1.052 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 5.357452154159546
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.737 Test Loss: 1.052 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 5.526425361633301
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.740 Test Loss: 1.051 Test Acc: 0.740
Validation loss decreased (-0.739989 --> -0.739989).  Saving model ...
Epoch: 97 cost time: 5.847546100616455
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.743 Test Loss: 1.052 Test Acc: 0.743
Validation loss decreased (-0.739989 --> -0.743323).  Saving model ...
Epoch: 98 cost time: 5.414324998855591
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.743 Test Loss: 1.052 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 5.5102880001068115
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.743 Test Loss: 1.051 Test Acc: 0.743
Validation loss decreased (-0.743323 --> -0.743323).  Saving model ...
Epoch: 100 cost time: 5.018516540527344
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.743 Test Loss: 1.050 Test Acc: 0.743
Validation loss decreased (-0.743323 --> -0.743323).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7433333333333333
model parameter : 5135385
model size : 29.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.689153432846069
Epoch: 1, Steps: 18 | Train Loss: 3.241 Vali Loss: 2.945 Vali Acc: 0.160 Test Loss: 2.945 Test Acc: 0.160
Validation loss decreased (inf --> -0.159971).  Saving model ...
Epoch: 2 cost time: 5.114388465881348
Epoch: 2, Steps: 18 | Train Loss: 2.182 Vali Loss: 2.477 Vali Acc: 0.287 Test Loss: 2.477 Test Acc: 0.287
Validation loss decreased (-0.159971 --> -0.286642).  Saving model ...
Epoch: 3 cost time: 5.483151912689209
Epoch: 3, Steps: 18 | Train Loss: 0.911 Vali Loss: 2.023 Vali Acc: 0.400 Test Loss: 2.023 Test Acc: 0.400
Validation loss decreased (-0.286642 --> -0.399980).  Saving model ...
Epoch: 4 cost time: 5.450928688049316
Epoch: 4, Steps: 18 | Train Loss: 0.226 Vali Loss: 1.999 Vali Acc: 0.367 Test Loss: 1.999 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.358779430389404
Epoch: 5, Steps: 18 | Train Loss: 0.054 Vali Loss: 1.928 Vali Acc: 0.430 Test Loss: 1.928 Test Acc: 0.430
Validation loss decreased (-0.399980 --> -0.429981).  Saving model ...
Epoch: 6 cost time: 5.226094961166382
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.835 Vali Acc: 0.463 Test Loss: 1.835 Test Acc: 0.463
Validation loss decreased (-0.429981 --> -0.463315).  Saving model ...
Epoch: 7 cost time: 5.692273855209351
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.780 Vali Acc: 0.483 Test Loss: 1.780 Test Acc: 0.483
Validation loss decreased (-0.463315 --> -0.483316).  Saving model ...
Epoch: 8 cost time: 5.711473703384399
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.641 Vali Acc: 0.527 Test Loss: 1.641 Test Acc: 0.527
Validation loss decreased (-0.483316 --> -0.526650).  Saving model ...
Epoch: 9 cost time: 5.7867820262908936
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.625 Vali Acc: 0.520 Test Loss: 1.625 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.208134174346924
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.599 Vali Acc: 0.527 Test Loss: 1.599 Test Acc: 0.527
Validation loss decreased (-0.526650 --> -0.526651).  Saving model ...
Epoch: 11 cost time: 5.642183065414429
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.589 Vali Acc: 0.533 Test Loss: 1.589 Test Acc: 0.533
Validation loss decreased (-0.526651 --> -0.533317).  Saving model ...
Epoch: 12 cost time: 5.970623731613159
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.575 Vali Acc: 0.537 Test Loss: 1.575 Test Acc: 0.537
Validation loss decreased (-0.533317 --> -0.536651).  Saving model ...
Epoch: 13 cost time: 5.96185040473938
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.557 Vali Acc: 0.533 Test Loss: 1.557 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.743567705154419
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.545 Vali Acc: 0.553 Test Loss: 1.545 Test Acc: 0.553
Validation loss decreased (-0.536651 --> -0.553318).  Saving model ...
Epoch: 15 cost time: 5.522068500518799
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.542 Vali Acc: 0.553 Test Loss: 1.542 Test Acc: 0.553
Validation loss decreased (-0.553318 --> -0.553318).  Saving model ...
Epoch: 16 cost time: 5.370371103286743
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.550 Test Loss: 1.530 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.268699407577515
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.520 Vali Acc: 0.550 Test Loss: 1.520 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.972148418426514
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.515 Vali Acc: 0.553 Test Loss: 1.515 Test Acc: 0.553
Validation loss decreased (-0.553318 --> -0.553318).  Saving model ...
Epoch: 19 cost time: 5.805250644683838
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.560 Test Loss: 1.511 Test Acc: 0.560
Validation loss decreased (-0.553318 --> -0.559985).  Saving model ...
Epoch: 20 cost time: 5.64816427230835
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.563 Test Loss: 1.506 Test Acc: 0.563
Validation loss decreased (-0.559985 --> -0.563318).  Saving model ...
Epoch: 21 cost time: 5.75356650352478
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.570 Test Loss: 1.501 Test Acc: 0.570
Validation loss decreased (-0.563318 --> -0.569985).  Saving model ...
Epoch: 22 cost time: 5.801910161972046
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.567 Test Loss: 1.492 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.128507137298584
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.573 Test Loss: 1.479 Test Acc: 0.573
Validation loss decreased (-0.569985 --> -0.573319).  Saving model ...
Epoch: 24 cost time: 5.655252695083618
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.475 Vali Acc: 0.577 Test Loss: 1.475 Test Acc: 0.577
Validation loss decreased (-0.573319 --> -0.576652).  Saving model ...
Epoch: 25 cost time: 5.4443604946136475
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.580 Test Loss: 1.467 Test Acc: 0.580
Validation loss decreased (-0.576652 --> -0.579985).  Saving model ...
Epoch: 26 cost time: 5.149130821228027
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.577 Test Loss: 1.462 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.510786056518555
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.459 Vali Acc: 0.587 Test Loss: 1.459 Test Acc: 0.587
Validation loss decreased (-0.579985 --> -0.586652).  Saving model ...
Epoch: 28 cost time: 5.4377663135528564
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.590 Test Loss: 1.452 Test Acc: 0.590
Validation loss decreased (-0.586652 --> -0.589985).  Saving model ...
Epoch: 29 cost time: 5.6589272022247314
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.597 Test Loss: 1.447 Test Acc: 0.597
Validation loss decreased (-0.589985 --> -0.596652).  Saving model ...
Epoch: 30 cost time: 5.652641534805298
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.446 Vali Acc: 0.593 Test Loss: 1.446 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.596118927001953
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.607 Test Loss: 1.442 Test Acc: 0.607
Validation loss decreased (-0.596652 --> -0.606652).  Saving model ...
Epoch: 32 cost time: 5.962245464324951
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.607 Test Loss: 1.439 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 33 cost time: 5.826159954071045
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.597 Test Loss: 1.437 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.685041666030884
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.610 Test Loss: 1.431 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 35 cost time: 5.7941553592681885
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.607 Test Loss: 1.430 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.514636039733887
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.607 Test Loss: 1.430 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 5.393633604049683
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.610 Test Loss: 1.427 Test Acc: 0.610
Validation loss decreased (-0.609986 --> -0.609986).  Saving model ...
Epoch: 38 cost time: 6.096464395523071
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.610 Test Loss: 1.424 Test Acc: 0.610
Validation loss decreased (-0.609986 --> -0.609986).  Saving model ...
Epoch: 39 cost time: 6.059389114379883
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.617 Test Loss: 1.425 Test Acc: 0.617
Validation loss decreased (-0.609986 --> -0.616652).  Saving model ...
Epoch: 40 cost time: 5.879049777984619
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.623 Test Loss: 1.420 Test Acc: 0.623
Validation loss decreased (-0.616652 --> -0.623319).  Saving model ...
Epoch: 41 cost time: 5.376364469528198
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.620 Test Loss: 1.420 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.45409083366394
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.623 Test Loss: 1.415 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 43 cost time: 5.258532762527466
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.620 Test Loss: 1.411 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 5.984491348266602
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.623 Test Loss: 1.405 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 45 cost time: 5.409175634384155
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.623 Test Loss: 1.404 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 46 cost time: 6.140872001647949
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.623 Test Loss: 1.401 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 47 cost time: 5.581416130065918
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.623 Test Loss: 1.399 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 48 cost time: 5.6494834423065186
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.627 Test Loss: 1.396 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626653).  Saving model ...
Epoch: 49 cost time: 5.567762613296509
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.394 Vali Acc: 0.630 Test Loss: 1.394 Test Acc: 0.630
Validation loss decreased (-0.626653 --> -0.629986).  Saving model ...
Epoch: 50 cost time: 5.39607572555542
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.630 Test Loss: 1.391 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 51 cost time: 5.747679948806763
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.633 Test Loss: 1.388 Test Acc: 0.633
Validation loss decreased (-0.629986 --> -0.633319).  Saving model ...
Epoch: 52 cost time: 5.591943979263306
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.633 Test Loss: 1.386 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 53 cost time: 5.675307512283325
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.633 Test Loss: 1.385 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 54 cost time: 5.684229612350464
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.637 Test Loss: 1.382 Test Acc: 0.637
Validation loss decreased (-0.633319 --> -0.636653).  Saving model ...
Epoch: 55 cost time: 5.878202199935913
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.633 Test Loss: 1.381 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 5.920978307723999
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.378 Vali Acc: 0.633 Test Loss: 1.378 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 5.537767171859741
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.378 Vali Acc: 0.633 Test Loss: 1.378 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 5.654935359954834
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.633 Test Loss: 1.377 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 5.735446929931641
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.378 Vali Acc: 0.637 Test Loss: 1.378 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 60 cost time: 5.740688323974609
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.378 Vali Acc: 0.637 Test Loss: 1.378 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 61 cost time: 5.852643966674805
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.633 Test Loss: 1.373 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 5.553575038909912
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.375 Vali Acc: 0.633 Test Loss: 1.375 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 5.3621673583984375
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.633 Test Loss: 1.374 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 5.636799573898315
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.637 Test Loss: 1.374 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 65 cost time: 5.237553119659424
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.637 Test Loss: 1.372 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 66 cost time: 5.2483131885528564
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.640 Test Loss: 1.372 Test Acc: 0.640
Validation loss decreased (-0.636653 --> -0.639986).  Saving model ...
Epoch: 67 cost time: 5.467105150222778
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.640 Test Loss: 1.371 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 68 cost time: 5.443466901779175
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.640 Test Loss: 1.371 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 69 cost time: 5.473090887069702
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.640 Test Loss: 1.370 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 70 cost time: 5.70978856086731
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.647 Test Loss: 1.368 Test Acc: 0.647
Validation loss decreased (-0.639986 --> -0.646653).  Saving model ...
Epoch: 71 cost time: 5.610533714294434
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.647 Test Loss: 1.367 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 72 cost time: 5.6583170890808105
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.647 Test Loss: 1.367 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 5.447689533233643
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.647 Test Loss: 1.367 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 74 cost time: 5.5042877197265625
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.647 Test Loss: 1.366 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 75 cost time: 5.067857980728149
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.650 Test Loss: 1.365 Test Acc: 0.650
Validation loss decreased (-0.646653 --> -0.649986).  Saving model ...
Epoch: 76 cost time: 5.527191400527954
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.650 Test Loss: 1.363 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 77 cost time: 5.322754383087158
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.647 Test Loss: 1.363 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.171961784362793
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.362 Vali Acc: 0.647 Test Loss: 1.362 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 5.684665679931641
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.647 Test Loss: 1.360 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 5.452094316482544
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.650 Test Loss: 1.361 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 81 cost time: 4.8484580516815186
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.653 Test Loss: 1.359 Test Acc: 0.653
Validation loss decreased (-0.649986 --> -0.653320).  Saving model ...
Epoch: 82 cost time: 5.602915048599243
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.653 Test Loss: 1.357 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 83 cost time: 5.704634428024292
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.653 Test Loss: 1.357 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 84 cost time: 5.69614839553833
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.650 Test Loss: 1.357 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 5.518747329711914
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.650 Test Loss: 1.357 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 5.533934593200684
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.650 Test Loss: 1.356 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 5.431597948074341
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.653 Test Loss: 1.356 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 88 cost time: 5.445195913314819
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.653 Test Loss: 1.355 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 89 cost time: 5.342559337615967
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.653 Test Loss: 1.354 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 90 cost time: 5.61570143699646
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.653 Test Loss: 1.354 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 91 cost time: 5.968149662017822
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.653 Test Loss: 1.351 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 92 cost time: 5.598608016967773
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.653 Test Loss: 1.351 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 5.811997652053833
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.653 Test Loss: 1.350 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 94 cost time: 5.6995508670806885
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.653 Test Loss: 1.348 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 95 cost time: 5.450947523117065
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.653 Test Loss: 1.346 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 96 cost time: 5.675530672073364
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.653 Test Loss: 1.346 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 97 cost time: 5.684746980667114
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.653 Test Loss: 1.348 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 5.7238287925720215
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.653 Test Loss: 1.348 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 5.720149040222168
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.657 Test Loss: 1.347 Test Acc: 0.657
Validation loss decreased (-0.653320 --> -0.656653).  Saving model ...
Epoch: 100 cost time: 5.542158842086792
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.657 Test Loss: 1.345 Test Acc: 0.657
Validation loss decreased (-0.656653 --> -0.656653).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6566666666666666
model parameter : 5135385
model size : 29.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.972479581832886
Epoch: 1, Steps: 18 | Train Loss: 3.293 Vali Loss: 3.070 Vali Acc: 0.110 Test Loss: 3.070 Test Acc: 0.110
Validation loss decreased (inf --> -0.109969).  Saving model ...
Epoch: 2 cost time: 5.393452405929565
Epoch: 2, Steps: 18 | Train Loss: 2.240 Vali Loss: 2.696 Vali Acc: 0.230 Test Loss: 2.696 Test Acc: 0.230
Validation loss decreased (-0.109969 --> -0.229973).  Saving model ...
Epoch: 3 cost time: 5.502355337142944
Epoch: 3, Steps: 18 | Train Loss: 0.930 Vali Loss: 2.368 Vali Acc: 0.340 Test Loss: 2.368 Test Acc: 0.340
Validation loss decreased (-0.229973 --> -0.339976).  Saving model ...
Epoch: 4 cost time: 5.578629493713379
Epoch: 4, Steps: 18 | Train Loss: 0.233 Vali Loss: 2.267 Vali Acc: 0.363 Test Loss: 2.267 Test Acc: 0.363
Validation loss decreased (-0.339976 --> -0.363311).  Saving model ...
Epoch: 5 cost time: 5.52493953704834
Epoch: 5, Steps: 18 | Train Loss: 0.048 Vali Loss: 2.159 Vali Acc: 0.357 Test Loss: 2.159 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.663327693939209
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.050 Vali Acc: 0.380 Test Loss: 2.050 Test Acc: 0.380
Validation loss decreased (-0.363311 --> -0.379980).  Saving model ...
Epoch: 7 cost time: 5.605010271072388
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.001 Vali Acc: 0.393 Test Loss: 2.001 Test Acc: 0.393
Validation loss decreased (-0.379980 --> -0.393313).  Saving model ...
Epoch: 8 cost time: 5.724193334579468
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.955 Vali Acc: 0.427 Test Loss: 1.955 Test Acc: 0.427
Validation loss decreased (-0.393313 --> -0.426647).  Saving model ...
Epoch: 9 cost time: 5.62426495552063
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.920 Vali Acc: 0.437 Test Loss: 1.920 Test Acc: 0.437
Validation loss decreased (-0.426647 --> -0.436647).  Saving model ...
Epoch: 10 cost time: 5.456909418106079
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.892 Vali Acc: 0.447 Test Loss: 1.892 Test Acc: 0.447
Validation loss decreased (-0.436647 --> -0.446648).  Saving model ...
Epoch: 11 cost time: 5.608645677566528
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.875 Vali Acc: 0.453 Test Loss: 1.875 Test Acc: 0.453
Validation loss decreased (-0.446648 --> -0.453315).  Saving model ...
Epoch: 12 cost time: 5.1227569580078125
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.858 Vali Acc: 0.477 Test Loss: 1.858 Test Acc: 0.477
Validation loss decreased (-0.453315 --> -0.476648).  Saving model ...
Epoch: 13 cost time: 5.563058376312256
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.836 Vali Acc: 0.480 Test Loss: 1.836 Test Acc: 0.480
Validation loss decreased (-0.476648 --> -0.479982).  Saving model ...
Epoch: 14 cost time: 5.322844505310059
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.815 Vali Acc: 0.490 Test Loss: 1.815 Test Acc: 0.490
Validation loss decreased (-0.479982 --> -0.489982).  Saving model ...
Epoch: 15 cost time: 5.820027112960815
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.801 Vali Acc: 0.493 Test Loss: 1.801 Test Acc: 0.493
Validation loss decreased (-0.489982 --> -0.493315).  Saving model ...
Epoch: 16 cost time: 5.77739143371582
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.784 Vali Acc: 0.490 Test Loss: 1.784 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.689356565475464
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.760 Vali Acc: 0.500 Test Loss: 1.760 Test Acc: 0.500
Validation loss decreased (-0.493315 --> -0.499982).  Saving model ...
Epoch: 18 cost time: 5.9799888134002686
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.748 Vali Acc: 0.510 Test Loss: 1.748 Test Acc: 0.510
Validation loss decreased (-0.499982 --> -0.509983).  Saving model ...
Epoch: 19 cost time: 5.5552146434783936
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.733 Vali Acc: 0.517 Test Loss: 1.733 Test Acc: 0.517
Validation loss decreased (-0.509983 --> -0.516649).  Saving model ...
Epoch: 20 cost time: 5.400913238525391
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.527 Test Loss: 1.717 Test Acc: 0.527
Validation loss decreased (-0.516649 --> -0.526650).  Saving model ...
Epoch: 21 cost time: 5.830000638961792
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.708 Vali Acc: 0.527 Test Loss: 1.708 Test Acc: 0.527
Validation loss decreased (-0.526650 --> -0.526650).  Saving model ...
Epoch: 22 cost time: 5.397433042526245
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.527 Test Loss: 1.700 Test Acc: 0.527
Validation loss decreased (-0.526650 --> -0.526650).  Saving model ...
Epoch: 23 cost time: 5.567768335342407
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.683 Vali Acc: 0.530 Test Loss: 1.683 Test Acc: 0.530
Validation loss decreased (-0.526650 --> -0.529983).  Saving model ...
Epoch: 24 cost time: 5.413643836975098
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.678 Vali Acc: 0.537 Test Loss: 1.678 Test Acc: 0.537
Validation loss decreased (-0.529983 --> -0.536650).  Saving model ...
Epoch: 25 cost time: 5.702320098876953
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.668 Vali Acc: 0.527 Test Loss: 1.668 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.395620107650757
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.659 Vali Acc: 0.540 Test Loss: 1.659 Test Acc: 0.540
Validation loss decreased (-0.536650 --> -0.539983).  Saving model ...
Epoch: 27 cost time: 5.436173677444458
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.653 Vali Acc: 0.543 Test Loss: 1.653 Test Acc: 0.543
Validation loss decreased (-0.539983 --> -0.543317).  Saving model ...
Epoch: 28 cost time: 5.406594514846802
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.646 Vali Acc: 0.557 Test Loss: 1.646 Test Acc: 0.557
Validation loss decreased (-0.543317 --> -0.556650).  Saving model ...
Epoch: 29 cost time: 5.844741106033325
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.638 Vali Acc: 0.553 Test Loss: 1.638 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.815248489379883
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.632 Vali Acc: 0.553 Test Loss: 1.632 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.052311897277832
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.553 Test Loss: 1.625 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.373722791671753
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.613 Vali Acc: 0.567 Test Loss: 1.613 Test Acc: 0.567
Validation loss decreased (-0.556650 --> -0.566651).  Saving model ...
Epoch: 33 cost time: 5.53182053565979
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.567 Test Loss: 1.607 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 34 cost time: 5.346378326416016
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.567 Test Loss: 1.608 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.65802264213562
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.567 Test Loss: 1.604 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 36 cost time: 5.835473299026489
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.560 Test Loss: 1.601 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.242833375930786
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.594 Vali Acc: 0.567 Test Loss: 1.594 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 38 cost time: 5.420727729797363
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.570 Test Loss: 1.586 Test Acc: 0.570
Validation loss decreased (-0.566651 --> -0.569984).  Saving model ...
Epoch: 39 cost time: 5.423470735549927
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.583 Test Loss: 1.578 Test Acc: 0.583
Validation loss decreased (-0.569984 --> -0.583318).  Saving model ...
Epoch: 40 cost time: 5.3534910678863525
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.577 Test Loss: 1.573 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.333264350891113
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.580 Test Loss: 1.573 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.922835350036621
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.568 Vali Acc: 0.580 Test Loss: 1.568 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 5.622645378112793
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.577 Test Loss: 1.567 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 5.9417595863342285
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.563 Vali Acc: 0.580 Test Loss: 1.563 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 5.5484020709991455
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.580 Test Loss: 1.561 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 5.517930030822754
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.555 Vali Acc: 0.580 Test Loss: 1.555 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 6.069369077682495
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.587 Test Loss: 1.549 Test Acc: 0.587
Validation loss decreased (-0.583318 --> -0.586651).  Saving model ...
Epoch: 48 cost time: 5.411765098571777
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.546 Vali Acc: 0.587 Test Loss: 1.546 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 49 cost time: 5.422292947769165
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.546 Vali Acc: 0.590 Test Loss: 1.546 Test Acc: 0.590
Validation loss decreased (-0.586651 --> -0.589985).  Saving model ...
Epoch: 50 cost time: 5.4667723178863525
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.593 Test Loss: 1.541 Test Acc: 0.593
Validation loss decreased (-0.589985 --> -0.593318).  Saving model ...
Epoch: 51 cost time: 5.420640707015991
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.597 Test Loss: 1.539 Test Acc: 0.597
Validation loss decreased (-0.593318 --> -0.596651).  Saving model ...
Epoch: 52 cost time: 5.802679777145386
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.600 Test Loss: 1.539 Test Acc: 0.600
Validation loss decreased (-0.596651 --> -0.599985).  Saving model ...
Epoch: 53 cost time: 5.198444604873657
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.600 Test Loss: 1.535 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599985).  Saving model ...
Epoch: 54 cost time: 5.433095932006836
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.600 Test Loss: 1.528 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599985).  Saving model ...
Epoch: 55 cost time: 5.436633110046387
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.603 Test Loss: 1.526 Test Acc: 0.603
Validation loss decreased (-0.599985 --> -0.603318).  Saving model ...
Epoch: 56 cost time: 5.441153049468994
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.607 Test Loss: 1.521 Test Acc: 0.607
Validation loss decreased (-0.603318 --> -0.606651).  Saving model ...
Epoch: 57 cost time: 5.7143237590789795
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.607 Test Loss: 1.520 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606651).  Saving model ...
Epoch: 58 cost time: 5.576001405715942
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.518 Vali Acc: 0.607 Test Loss: 1.518 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606651).  Saving model ...
Epoch: 59 cost time: 5.677279472351074
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.607 Test Loss: 1.516 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606652).  Saving model ...
Epoch: 60 cost time: 5.608311891555786
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.514 Vali Acc: 0.600 Test Loss: 1.514 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 5.415785074234009
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.600 Test Loss: 1.512 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 5.50971245765686
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.603 Test Loss: 1.512 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 5.670589447021484
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.603 Test Loss: 1.509 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 5.4652769565582275
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.607 Test Loss: 1.508 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 65 cost time: 5.6163170337677
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.610 Test Loss: 1.506 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609985).  Saving model ...
Epoch: 66 cost time: 5.597064018249512
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.613 Test Loss: 1.503 Test Acc: 0.613
Validation loss decreased (-0.609985 --> -0.613318).  Saving model ...
Epoch: 67 cost time: 5.959909439086914
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.613 Test Loss: 1.501 Test Acc: 0.613
Validation loss decreased (-0.613318 --> -0.613318).  Saving model ...
Epoch: 68 cost time: 5.216834545135498
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.613 Test Loss: 1.500 Test Acc: 0.613
Validation loss decreased (-0.613318 --> -0.613318).  Saving model ...
Epoch: 69 cost time: 5.526876211166382
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.617 Test Loss: 1.499 Test Acc: 0.617
Validation loss decreased (-0.613318 --> -0.616652).  Saving model ...
Epoch: 70 cost time: 5.580102205276489
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.498 Vali Acc: 0.613 Test Loss: 1.498 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 5.759837865829468
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.613 Test Loss: 1.496 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 5.526960611343384
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.613 Test Loss: 1.494 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 5.617352724075317
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.491 Vali Acc: 0.617 Test Loss: 1.491 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 74 cost time: 5.535651206970215
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.620 Test Loss: 1.489 Test Acc: 0.620
Validation loss decreased (-0.616652 --> -0.619985).  Saving model ...
Epoch: 75 cost time: 5.637732267379761
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.623 Test Loss: 1.488 Test Acc: 0.623
Validation loss decreased (-0.619985 --> -0.623318).  Saving model ...
Epoch: 76 cost time: 5.240960121154785
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.623 Test Loss: 1.486 Test Acc: 0.623
Validation loss decreased (-0.623318 --> -0.623318).  Saving model ...
Epoch: 77 cost time: 5.224281549453735
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.487 Vali Acc: 0.617 Test Loss: 1.487 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.114630937576294
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.623 Test Loss: 1.484 Test Acc: 0.623
Validation loss decreased (-0.623318 --> -0.623318).  Saving model ...
Epoch: 79 cost time: 5.70006537437439
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.620 Test Loss: 1.482 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 5.462936162948608
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.623 Test Loss: 1.482 Test Acc: 0.623
Validation loss decreased (-0.623318 --> -0.623319).  Saving model ...
Epoch: 81 cost time: 5.694729804992676
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.620 Test Loss: 1.480 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 5.9037065505981445
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.623 Test Loss: 1.479 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 83 cost time: 5.906248569488525
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.623 Test Loss: 1.477 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 84 cost time: 5.647802829742432
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.633 Test Loss: 1.476 Test Acc: 0.633
Validation loss decreased (-0.623319 --> -0.633319).  Saving model ...
Epoch: 85 cost time: 5.397135972976685
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.633 Test Loss: 1.477 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 5.583039045333862
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.475 Vali Acc: 0.633 Test Loss: 1.475 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 87 cost time: 6.082142114639282
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.474 Vali Acc: 0.633 Test Loss: 1.474 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 88 cost time: 5.85918402671814
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.637 Test Loss: 1.473 Test Acc: 0.637
Validation loss decreased (-0.633319 --> -0.636652).  Saving model ...
Epoch: 89 cost time: 5.475783348083496
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.640 Test Loss: 1.472 Test Acc: 0.640
Validation loss decreased (-0.636652 --> -0.639985).  Saving model ...
Epoch: 90 cost time: 5.871838808059692
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.630 Test Loss: 1.471 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 5.766998291015625
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.630 Test Loss: 1.469 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 5.957711935043335
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.633 Test Loss: 1.468 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 5.495288372039795
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.630 Test Loss: 1.467 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 5.228116750717163
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.465 Vali Acc: 0.630 Test Loss: 1.465 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 5.134560585021973
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.630 Test Loss: 1.461 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 5.223975419998169
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.637 Test Loss: 1.462 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 5.379542827606201
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.633 Test Loss: 1.462 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 5.4191858768463135
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.630 Test Loss: 1.461 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 5.555306434631348
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.630 Test Loss: 1.460 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.64
model parameter : 5135385
model size : 29.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.560738563537598
Epoch: 1, Steps: 18 | Train Loss: 3.259 Vali Loss: 3.190 Vali Acc: 0.073 Test Loss: 3.190 Test Acc: 0.073
Validation loss decreased (inf --> -0.073301).  Saving model ...
Epoch: 2 cost time: 5.341510534286499
Epoch: 2, Steps: 18 | Train Loss: 2.297 Vali Loss: 2.903 Vali Acc: 0.133 Test Loss: 2.903 Test Acc: 0.133
Validation loss decreased (-0.073301 --> -0.133304).  Saving model ...
Epoch: 3 cost time: 5.356273651123047
Epoch: 3, Steps: 18 | Train Loss: 1.037 Vali Loss: 2.831 Vali Acc: 0.150 Test Loss: 2.831 Test Acc: 0.150
Validation loss decreased (-0.133304 --> -0.149972).  Saving model ...
Epoch: 4 cost time: 5.232639789581299
Epoch: 4, Steps: 18 | Train Loss: 0.268 Vali Loss: 2.819 Vali Acc: 0.173 Test Loss: 2.819 Test Acc: 0.173
Validation loss decreased (-0.149972 --> -0.173305).  Saving model ...
Epoch: 5 cost time: 5.287565469741821
Epoch: 5, Steps: 18 | Train Loss: 0.060 Vali Loss: 2.682 Vali Acc: 0.270 Test Loss: 2.682 Test Acc: 0.270
Validation loss decreased (-0.173305 --> -0.269973).  Saving model ...
Epoch: 6 cost time: 5.186784029006958
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.484 Vali Acc: 0.297 Test Loss: 2.484 Test Acc: 0.297
Validation loss decreased (-0.269973 --> -0.296642).  Saving model ...
Epoch: 7 cost time: 5.41257119178772
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.462 Vali Acc: 0.273 Test Loss: 2.462 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.795835971832275
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 2.421 Vali Acc: 0.290 Test Loss: 2.421 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.848374843597412
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.347 Vali Acc: 0.310 Test Loss: 2.347 Test Acc: 0.310
Validation loss decreased (-0.296642 --> -0.309977).  Saving model ...
Epoch: 10 cost time: 5.854736089706421
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.312 Vali Acc: 0.327 Test Loss: 2.312 Test Acc: 0.327
Validation loss decreased (-0.309977 --> -0.326644).  Saving model ...
Epoch: 11 cost time: 6.171825885772705
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.281 Vali Acc: 0.327 Test Loss: 2.281 Test Acc: 0.327
Validation loss decreased (-0.326644 --> -0.326644).  Saving model ...
Epoch: 12 cost time: 5.734193325042725
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.242 Vali Acc: 0.343 Test Loss: 2.242 Test Acc: 0.343
Validation loss decreased (-0.326644 --> -0.343311).  Saving model ...
Epoch: 13 cost time: 5.729759693145752
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.206 Vali Acc: 0.347 Test Loss: 2.206 Test Acc: 0.347
Validation loss decreased (-0.343311 --> -0.346645).  Saving model ...
Epoch: 14 cost time: 5.83414363861084
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.182 Vali Acc: 0.357 Test Loss: 2.182 Test Acc: 0.357
Validation loss decreased (-0.346645 --> -0.356645).  Saving model ...
Epoch: 15 cost time: 5.362952470779419
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.161 Vali Acc: 0.370 Test Loss: 2.161 Test Acc: 0.370
Validation loss decreased (-0.356645 --> -0.369978).  Saving model ...
Epoch: 16 cost time: 5.737834215164185
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.138 Vali Acc: 0.377 Test Loss: 2.138 Test Acc: 0.377
Validation loss decreased (-0.369978 --> -0.376645).  Saving model ...
Epoch: 17 cost time: 5.583115577697754
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.114 Vali Acc: 0.387 Test Loss: 2.114 Test Acc: 0.387
Validation loss decreased (-0.376645 --> -0.386646).  Saving model ...
Epoch: 18 cost time: 5.8043272495269775
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.082 Vali Acc: 0.397 Test Loss: 2.082 Test Acc: 0.397
Validation loss decreased (-0.386646 --> -0.396646).  Saving model ...
Epoch: 19 cost time: 5.713978052139282
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.064 Vali Acc: 0.410 Test Loss: 2.064 Test Acc: 0.410
Validation loss decreased (-0.396646 --> -0.409979).  Saving model ...
Epoch: 20 cost time: 5.800940036773682
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.031 Vali Acc: 0.423 Test Loss: 2.031 Test Acc: 0.423
Validation loss decreased (-0.409979 --> -0.423313).  Saving model ...
Epoch: 21 cost time: 5.451460123062134
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 2.006 Vali Acc: 0.427 Test Loss: 2.006 Test Acc: 0.427
Validation loss decreased (-0.423313 --> -0.426647).  Saving model ...
Epoch: 22 cost time: 5.790279865264893
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.989 Vali Acc: 0.433 Test Loss: 1.989 Test Acc: 0.433
Validation loss decreased (-0.426647 --> -0.433313).  Saving model ...
Epoch: 23 cost time: 5.791743755340576
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.433 Test Loss: 1.973 Test Acc: 0.433
Validation loss decreased (-0.433313 --> -0.433314).  Saving model ...
Epoch: 24 cost time: 5.708209037780762
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.443 Test Loss: 1.956 Test Acc: 0.443
Validation loss decreased (-0.433314 --> -0.443314).  Saving model ...
Epoch: 25 cost time: 6.103353977203369
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.932 Vali Acc: 0.440 Test Loss: 1.932 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.736143589019775
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.921 Vali Acc: 0.453 Test Loss: 1.921 Test Acc: 0.453
Validation loss decreased (-0.443314 --> -0.453314).  Saving model ...
Epoch: 27 cost time: 5.9151084423065186
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.904 Vali Acc: 0.453 Test Loss: 1.904 Test Acc: 0.453
Validation loss decreased (-0.453314 --> -0.453314).  Saving model ...
Epoch: 28 cost time: 5.51720118522644
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.890 Vali Acc: 0.460 Test Loss: 1.890 Test Acc: 0.460
Validation loss decreased (-0.453314 --> -0.459981).  Saving model ...
Epoch: 29 cost time: 5.851767063140869
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.873 Vali Acc: 0.467 Test Loss: 1.873 Test Acc: 0.467
Validation loss decreased (-0.459981 --> -0.466648).  Saving model ...
Epoch: 30 cost time: 5.5316619873046875
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.865 Vali Acc: 0.473 Test Loss: 1.865 Test Acc: 0.473
Validation loss decreased (-0.466648 --> -0.473315).  Saving model ...
Epoch: 31 cost time: 5.957412481307983
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.856 Vali Acc: 0.487 Test Loss: 1.856 Test Acc: 0.487
Validation loss decreased (-0.473315 --> -0.486648).  Saving model ...
Epoch: 32 cost time: 5.679192543029785
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.836 Vali Acc: 0.483 Test Loss: 1.836 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.39297890663147
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.480 Test Loss: 1.822 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.787057638168335
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.826 Vali Acc: 0.487 Test Loss: 1.826 Test Acc: 0.487
Validation loss decreased (-0.486648 --> -0.486648).  Saving model ...
Epoch: 35 cost time: 5.52843976020813
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.487 Test Loss: 1.815 Test Acc: 0.487
Validation loss decreased (-0.486648 --> -0.486649).  Saving model ...
Epoch: 36 cost time: 5.785120248794556
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.503 Test Loss: 1.801 Test Acc: 0.503
Validation loss decreased (-0.486649 --> -0.503315).  Saving model ...
Epoch: 37 cost time: 5.459859609603882
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.789 Vali Acc: 0.500 Test Loss: 1.789 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.642382860183716
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.777 Vali Acc: 0.510 Test Loss: 1.777 Test Acc: 0.510
Validation loss decreased (-0.503315 --> -0.509982).  Saving model ...
Epoch: 39 cost time: 5.674582004547119
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.765 Vali Acc: 0.520 Test Loss: 1.765 Test Acc: 0.520
Validation loss decreased (-0.509982 --> -0.519982).  Saving model ...
Epoch: 40 cost time: 5.679836273193359
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.527 Test Loss: 1.758 Test Acc: 0.527
Validation loss decreased (-0.519982 --> -0.526649).  Saving model ...
Epoch: 41 cost time: 5.743754148483276
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.748 Vali Acc: 0.540 Test Loss: 1.748 Test Acc: 0.540
Validation loss decreased (-0.526649 --> -0.539983).  Saving model ...
Epoch: 42 cost time: 5.8533899784088135
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.741 Vali Acc: 0.547 Test Loss: 1.741 Test Acc: 0.547
Validation loss decreased (-0.539983 --> -0.546649).  Saving model ...
Epoch: 43 cost time: 5.911602973937988
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.732 Vali Acc: 0.540 Test Loss: 1.732 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 5.737329483032227
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.730 Vali Acc: 0.547 Test Loss: 1.730 Test Acc: 0.547
Validation loss decreased (-0.546649 --> -0.546649).  Saving model ...
Epoch: 45 cost time: 5.437567710876465
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.540 Test Loss: 1.727 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.5603132247924805
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.719 Vali Acc: 0.540 Test Loss: 1.719 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.491562604904175
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.707 Vali Acc: 0.557 Test Loss: 1.707 Test Acc: 0.557
Validation loss decreased (-0.546649 --> -0.556650).  Saving model ...
Epoch: 48 cost time: 5.487334728240967
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.560 Test Loss: 1.696 Test Acc: 0.560
Validation loss decreased (-0.556650 --> -0.559983).  Saving model ...
Epoch: 49 cost time: 5.481907606124878
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.694 Vali Acc: 0.560 Test Loss: 1.694 Test Acc: 0.560
Validation loss decreased (-0.559983 --> -0.559983).  Saving model ...
Epoch: 50 cost time: 5.690585136413574
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.688 Vali Acc: 0.560 Test Loss: 1.688 Test Acc: 0.560
Validation loss decreased (-0.559983 --> -0.559983).  Saving model ...
Epoch: 51 cost time: 5.651549816131592
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.684 Vali Acc: 0.567 Test Loss: 1.684 Test Acc: 0.567
Validation loss decreased (-0.559983 --> -0.566650).  Saving model ...
Epoch: 52 cost time: 5.802972316741943
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.567 Test Loss: 1.689 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 5.571300745010376
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.676 Vali Acc: 0.563 Test Loss: 1.676 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 5.529886722564697
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.666 Vali Acc: 0.573 Test Loss: 1.666 Test Acc: 0.573
Validation loss decreased (-0.566650 --> -0.573317).  Saving model ...
Epoch: 55 cost time: 6.15437650680542
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.659 Vali Acc: 0.573 Test Loss: 1.659 Test Acc: 0.573
Validation loss decreased (-0.573317 --> -0.573317).  Saving model ...
Epoch: 56 cost time: 5.81783390045166
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.653 Vali Acc: 0.580 Test Loss: 1.653 Test Acc: 0.580
Validation loss decreased (-0.573317 --> -0.579983).  Saving model ...
Epoch: 57 cost time: 6.211838960647583
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.654 Vali Acc: 0.573 Test Loss: 1.654 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 5.863857746124268
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.651 Vali Acc: 0.570 Test Loss: 1.651 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 6.002752780914307
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.580 Test Loss: 1.647 Test Acc: 0.580
Validation loss decreased (-0.579983 --> -0.579984).  Saving model ...
Epoch: 60 cost time: 5.686924457550049
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.580 Test Loss: 1.645 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579984).  Saving model ...
Epoch: 61 cost time: 5.564009428024292
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.587 Test Loss: 1.640 Test Acc: 0.587
Validation loss decreased (-0.579984 --> -0.586650).  Saving model ...
Epoch: 62 cost time: 5.7233710289001465
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.636 Vali Acc: 0.590 Test Loss: 1.636 Test Acc: 0.590
Validation loss decreased (-0.586650 --> -0.589984).  Saving model ...
Epoch: 63 cost time: 5.780472993850708
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.587 Test Loss: 1.633 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.573280334472656
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.587 Test Loss: 1.627 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 5.926802635192871
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.622 Vali Acc: 0.590 Test Loss: 1.622 Test Acc: 0.590
Validation loss decreased (-0.589984 --> -0.589984).  Saving model ...
Epoch: 66 cost time: 5.75351357460022
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.593 Test Loss: 1.618 Test Acc: 0.593
Validation loss decreased (-0.589984 --> -0.593317).  Saving model ...
Epoch: 67 cost time: 5.815256118774414
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.593 Test Loss: 1.614 Test Acc: 0.593
Validation loss decreased (-0.593317 --> -0.593317).  Saving model ...
Epoch: 68 cost time: 5.358741998672485
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.597 Test Loss: 1.611 Test Acc: 0.597
Validation loss decreased (-0.593317 --> -0.596651).  Saving model ...
Epoch: 69 cost time: 5.124555349349976
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.597 Test Loss: 1.611 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 70 cost time: 5.70285964012146
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.597 Test Loss: 1.609 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 71 cost time: 5.632214546203613
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.597 Test Loss: 1.605 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 72 cost time: 5.9435999393463135
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.597 Test Loss: 1.601 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 73 cost time: 5.527240753173828
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.597 Test Loss: 1.597 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 74 cost time: 5.565053701400757
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.595 Vali Acc: 0.600 Test Loss: 1.595 Test Acc: 0.600
Validation loss decreased (-0.596651 --> -0.599984).  Saving model ...
Epoch: 75 cost time: 5.694374084472656
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.603 Test Loss: 1.590 Test Acc: 0.603
Validation loss decreased (-0.599984 --> -0.603317).  Saving model ...
Epoch: 76 cost time: 5.79203200340271
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.603 Test Loss: 1.588 Test Acc: 0.603
Validation loss decreased (-0.603317 --> -0.603317).  Saving model ...
Epoch: 77 cost time: 5.54092812538147
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.603 Test Loss: 1.585 Test Acc: 0.603
Validation loss decreased (-0.603317 --> -0.603317).  Saving model ...
Epoch: 78 cost time: 5.477066516876221
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.607 Test Loss: 1.583 Test Acc: 0.607
Validation loss decreased (-0.603317 --> -0.606651).  Saving model ...
Epoch: 79 cost time: 5.938350677490234
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.610 Test Loss: 1.583 Test Acc: 0.610
Validation loss decreased (-0.606651 --> -0.609984).  Saving model ...
Epoch: 80 cost time: 5.603015422821045
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.610 Test Loss: 1.580 Test Acc: 0.610
Validation loss decreased (-0.609984 --> -0.609984).  Saving model ...
Epoch: 81 cost time: 5.589253187179565
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.607 Test Loss: 1.578 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 5.574589014053345
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.577 Vali Acc: 0.607 Test Loss: 1.577 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 5.114480018615723
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.610 Test Loss: 1.573 Test Acc: 0.610
Validation loss decreased (-0.609984 --> -0.609984).  Saving model ...
Epoch: 84 cost time: 5.476168394088745
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.570 Vali Acc: 0.620 Test Loss: 1.570 Test Acc: 0.620
Validation loss decreased (-0.609984 --> -0.619984).  Saving model ...
Epoch: 85 cost time: 5.686185121536255
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.607 Test Loss: 1.569 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 5.356822729110718
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.570 Vali Acc: 0.617 Test Loss: 1.570 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 5.445938587188721
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.620 Test Loss: 1.569 Test Acc: 0.620
Validation loss decreased (-0.619984 --> -0.619984).  Saving model ...
Epoch: 88 cost time: 5.596720218658447
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.620 Test Loss: 1.569 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 5.671030044555664
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.627 Test Loss: 1.566 Test Acc: 0.627
Validation loss decreased (-0.619984 --> -0.626651).  Saving model ...
Epoch: 90 cost time: 5.651825904846191
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.630 Test Loss: 1.562 Test Acc: 0.630
Validation loss decreased (-0.626651 --> -0.629984).  Saving model ...
Epoch: 91 cost time: 5.634607791900635
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.623 Test Loss: 1.561 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 5.686683893203735
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.630 Test Loss: 1.561 Test Acc: 0.630
Validation loss decreased (-0.629984 --> -0.629984).  Saving model ...
Epoch: 93 cost time: 5.020325422286987
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.630 Test Loss: 1.561 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 5.4291322231292725
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.630 Test Loss: 1.559 Test Acc: 0.630
Validation loss decreased (-0.629984 --> -0.629984).  Saving model ...
Epoch: 95 cost time: 5.848983287811279
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.633 Test Loss: 1.556 Test Acc: 0.633
Validation loss decreased (-0.629984 --> -0.633318).  Saving model ...
Epoch: 96 cost time: 6.022570371627808
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.637 Test Loss: 1.554 Test Acc: 0.637
Validation loss decreased (-0.633318 --> -0.636651).  Saving model ...
Epoch: 97 cost time: 5.593852758407593
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.552 Vali Acc: 0.640 Test Loss: 1.552 Test Acc: 0.640
Validation loss decreased (-0.636651 --> -0.639984).  Saving model ...
Epoch: 98 cost time: 6.200942754745483
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.643 Test Loss: 1.553 Test Acc: 0.643
Validation loss decreased (-0.639984 --> -0.643318).  Saving model ...
Epoch: 99 cost time: 5.639400243759155
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.643 Test Loss: 1.551 Test Acc: 0.643
Validation loss decreased (-0.643318 --> -0.643318).  Saving model ...
Epoch: 100 cost time: 5.795569658279419
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.548 Vali Acc: 0.643 Test Loss: 1.548 Test Acc: 0.643
Validation loss decreased (-0.643318 --> -0.643318).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6433333333333333
model parameter : 5135385
model size : 29.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.7124433517456055
Epoch: 1, Steps: 18 | Train Loss: 3.246 Vali Loss: 3.171 Vali Acc: 0.077 Test Loss: 3.171 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 5.79569411277771
Epoch: 2, Steps: 18 | Train Loss: 2.408 Vali Loss: 2.846 Vali Acc: 0.180 Test Loss: 2.846 Test Acc: 0.180
Validation loss decreased (-0.076635 --> -0.179972).  Saving model ...
Epoch: 3 cost time: 6.0346057415008545
Epoch: 3, Steps: 18 | Train Loss: 1.224 Vali Loss: 2.737 Vali Acc: 0.197 Test Loss: 2.737 Test Acc: 0.197
Validation loss decreased (-0.179972 --> -0.196639).  Saving model ...
Epoch: 4 cost time: 5.707464933395386
Epoch: 4, Steps: 18 | Train Loss: 0.412 Vali Loss: 2.557 Vali Acc: 0.213 Test Loss: 2.557 Test Acc: 0.213
Validation loss decreased (-0.196639 --> -0.213308).  Saving model ...
Epoch: 5 cost time: 6.001321077346802
Epoch: 5, Steps: 18 | Train Loss: 0.092 Vali Loss: 2.340 Vali Acc: 0.313 Test Loss: 2.340 Test Acc: 0.313
Validation loss decreased (-0.213308 --> -0.313310).  Saving model ...
Epoch: 6 cost time: 5.008593559265137
Epoch: 6, Steps: 18 | Train Loss: 0.024 Vali Loss: 2.161 Vali Acc: 0.347 Test Loss: 2.161 Test Acc: 0.347
Validation loss decreased (-0.313310 --> -0.346645).  Saving model ...
Epoch: 7 cost time: 5.261996746063232
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.083 Vali Acc: 0.397 Test Loss: 2.083 Test Acc: 0.397
Validation loss decreased (-0.346645 --> -0.396646).  Saving model ...
Epoch: 8 cost time: 5.191991567611694
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.963 Vali Acc: 0.413 Test Loss: 1.963 Test Acc: 0.413
Validation loss decreased (-0.396646 --> -0.413314).  Saving model ...
Epoch: 9 cost time: 4.992780923843384
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.879 Vali Acc: 0.447 Test Loss: 1.879 Test Acc: 0.447
Validation loss decreased (-0.413314 --> -0.446648).  Saving model ...
Epoch: 10 cost time: 5.803513765335083
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.859 Vali Acc: 0.457 Test Loss: 1.859 Test Acc: 0.457
Validation loss decreased (-0.446648 --> -0.456648).  Saving model ...
Epoch: 11 cost time: 5.612762689590454
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.858 Vali Acc: 0.460 Test Loss: 1.858 Test Acc: 0.460
Validation loss decreased (-0.456648 --> -0.459981).  Saving model ...
Epoch: 12 cost time: 5.636632919311523
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.799 Vali Acc: 0.467 Test Loss: 1.799 Test Acc: 0.467
Validation loss decreased (-0.459981 --> -0.466649).  Saving model ...
Epoch: 13 cost time: 5.618935823440552
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.752 Vali Acc: 0.497 Test Loss: 1.752 Test Acc: 0.497
Validation loss decreased (-0.466649 --> -0.496649).  Saving model ...
Epoch: 14 cost time: 6.20941948890686
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.725 Vali Acc: 0.510 Test Loss: 1.725 Test Acc: 0.510
Validation loss decreased (-0.496649 --> -0.509983).  Saving model ...
Epoch: 15 cost time: 5.634649276733398
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.709 Vali Acc: 0.507 Test Loss: 1.709 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.912057638168335
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.673 Vali Acc: 0.513 Test Loss: 1.673 Test Acc: 0.513
Validation loss decreased (-0.509983 --> -0.513317).  Saving model ...
Epoch: 17 cost time: 5.6675543785095215
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.649 Vali Acc: 0.533 Test Loss: 1.649 Test Acc: 0.533
Validation loss decreased (-0.513317 --> -0.533317).  Saving model ...
Epoch: 18 cost time: 5.668298721313477
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.533 Test Loss: 1.633 Test Acc: 0.533
Validation loss decreased (-0.533317 --> -0.533317).  Saving model ...
Epoch: 19 cost time: 5.596091270446777
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.631 Vali Acc: 0.537 Test Loss: 1.631 Test Acc: 0.537
Validation loss decreased (-0.533317 --> -0.536650).  Saving model ...
Epoch: 20 cost time: 5.303905963897705
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.604 Vali Acc: 0.550 Test Loss: 1.604 Test Acc: 0.550
Validation loss decreased (-0.536650 --> -0.549984).  Saving model ...
Epoch: 21 cost time: 6.134138345718384
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.557 Test Loss: 1.588 Test Acc: 0.557
Validation loss decreased (-0.549984 --> -0.556651).  Saving model ...
Epoch: 22 cost time: 5.5810723304748535
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.557 Test Loss: 1.579 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 23 cost time: 5.575753211975098
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.567 Test Loss: 1.549 Test Acc: 0.567
Validation loss decreased (-0.556651 --> -0.566651).  Saving model ...
Epoch: 24 cost time: 5.922156572341919
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.570 Test Loss: 1.540 Test Acc: 0.570
Validation loss decreased (-0.566651 --> -0.569985).  Saving model ...
Epoch: 25 cost time: 5.584803819656372
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.573 Test Loss: 1.529 Test Acc: 0.573
Validation loss decreased (-0.569985 --> -0.573318).  Saving model ...
Epoch: 26 cost time: 5.482614517211914
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.580 Test Loss: 1.533 Test Acc: 0.580
Validation loss decreased (-0.573318 --> -0.579985).  Saving model ...
Epoch: 27 cost time: 5.953701496124268
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.587 Test Loss: 1.519 Test Acc: 0.587
Validation loss decreased (-0.579985 --> -0.586651).  Saving model ...
Epoch: 28 cost time: 5.297540903091431
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.590 Test Loss: 1.522 Test Acc: 0.590
Validation loss decreased (-0.586651 --> -0.589985).  Saving model ...
Epoch: 29 cost time: 6.084221363067627
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.593 Test Loss: 1.511 Test Acc: 0.593
Validation loss decreased (-0.589985 --> -0.593318).  Saving model ...
Epoch: 30 cost time: 5.721376657485962
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.607 Test Loss: 1.499 Test Acc: 0.607
Validation loss decreased (-0.593318 --> -0.606652).  Saving model ...
Epoch: 31 cost time: 5.778266429901123
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.607 Test Loss: 1.481 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 32 cost time: 5.237356901168823
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.607 Test Loss: 1.466 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 33 cost time: 5.777626276016235
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.607 Test Loss: 1.468 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.8763508796691895
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.597 Test Loss: 1.482 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.9896628856658936
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.607 Test Loss: 1.472 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.93859076499939
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.458 Vali Acc: 0.617 Test Loss: 1.458 Test Acc: 0.617
Validation loss decreased (-0.606652 --> -0.616652).  Saving model ...
Epoch: 37 cost time: 5.789082050323486
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.617 Test Loss: 1.448 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 38 cost time: 5.800786972045898
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.620 Test Loss: 1.440 Test Acc: 0.620
Validation loss decreased (-0.616652 --> -0.619986).  Saving model ...
Epoch: 39 cost time: 5.679852485656738
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.617 Test Loss: 1.430 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.0881054401397705
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.623 Test Loss: 1.420 Test Acc: 0.623
Validation loss decreased (-0.619986 --> -0.623319).  Saving model ...
Epoch: 41 cost time: 5.454285621643066
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.630 Test Loss: 1.413 Test Acc: 0.630
Validation loss decreased (-0.623319 --> -0.629986).  Saving model ...
Epoch: 42 cost time: 5.7812066078186035
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.627 Test Loss: 1.407 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.773602485656738
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.633 Test Loss: 1.392 Test Acc: 0.633
Validation loss decreased (-0.629986 --> -0.633319).  Saving model ...
Epoch: 44 cost time: 5.625929117202759
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.630 Test Loss: 1.393 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.194683790206909
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.627 Test Loss: 1.396 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 5.741105556488037
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.627 Test Loss: 1.395 Test Acc: 0.627
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 5.942877292633057
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.630 Test Loss: 1.395 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 5.639047145843506
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.633 Test Loss: 1.389 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 49 cost time: 5.741478443145752
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.633 Test Loss: 1.386 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 50 cost time: 5.998124361038208
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.640 Test Loss: 1.381 Test Acc: 0.640
Validation loss decreased (-0.633319 --> -0.639986).  Saving model ...
Epoch: 51 cost time: 5.62492036819458
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.640 Test Loss: 1.381 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 52 cost time: 5.940567255020142
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.640 Test Loss: 1.382 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 5.558794975280762
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.650 Test Loss: 1.376 Test Acc: 0.650
Validation loss decreased (-0.639986 --> -0.649986).  Saving model ...
Epoch: 54 cost time: 5.8049046993255615
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.650 Test Loss: 1.371 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 55 cost time: 5.556197166442871
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.657 Test Loss: 1.369 Test Acc: 0.657
Validation loss decreased (-0.649986 --> -0.656653).  Saving model ...
Epoch: 56 cost time: 5.750035047531128
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.657 Test Loss: 1.369 Test Acc: 0.657
Validation loss decreased (-0.656653 --> -0.656653).  Saving model ...
Epoch: 57 cost time: 5.227651596069336
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.660 Test Loss: 1.366 Test Acc: 0.660
Validation loss decreased (-0.656653 --> -0.659986).  Saving model ...
Epoch: 58 cost time: 5.232583045959473
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.657 Test Loss: 1.358 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 5.629278182983398
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.657 Test Loss: 1.361 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 5.079204797744751
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.653 Test Loss: 1.361 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 5.779300689697266
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.653 Test Loss: 1.355 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 5.646891832351685
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.660 Test Loss: 1.355 Test Acc: 0.660
Validation loss decreased (-0.659986 --> -0.659986).  Saving model ...
Epoch: 63 cost time: 5.738661289215088
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.660 Test Loss: 1.357 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.805430173873901
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.660 Test Loss: 1.356 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 5.1250715255737305
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.663 Test Loss: 1.352 Test Acc: 0.663
Validation loss decreased (-0.659986 --> -0.663320).  Saving model ...
Epoch: 66 cost time: 5.07404899597168
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.663 Test Loss: 1.346 Test Acc: 0.663
Validation loss decreased (-0.663320 --> -0.663320).  Saving model ...
Epoch: 67 cost time: 5.7273805141448975
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.667 Test Loss: 1.342 Test Acc: 0.667
Validation loss decreased (-0.663320 --> -0.666653).  Saving model ...
Epoch: 68 cost time: 5.583626747131348
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.673 Test Loss: 1.340 Test Acc: 0.673
Validation loss decreased (-0.666653 --> -0.673320).  Saving model ...
Epoch: 69 cost time: 5.26634407043457
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.663 Test Loss: 1.342 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 5.502077579498291
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.663 Test Loss: 1.342 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 5.855747699737549
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.663 Test Loss: 1.342 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 5.700080871582031
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.667 Test Loss: 1.338 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 5.657079219818115
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.334 Vali Acc: 0.667 Test Loss: 1.334 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 5.641266107559204
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.331 Vali Acc: 0.673 Test Loss: 1.331 Test Acc: 0.673
Validation loss decreased (-0.673320 --> -0.673320).  Saving model ...
Epoch: 75 cost time: 5.70371675491333
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.677 Test Loss: 1.329 Test Acc: 0.677
Validation loss decreased (-0.673320 --> -0.676653).  Saving model ...
Epoch: 76 cost time: 5.60071587562561
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.677 Test Loss: 1.332 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 5.709359169006348
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.330 Vali Acc: 0.673 Test Loss: 1.330 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 5.183432579040527
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.331 Vali Acc: 0.677 Test Loss: 1.331 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 5.157747030258179
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.330 Vali Acc: 0.677 Test Loss: 1.330 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 6.224913120269775
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.677 Test Loss: 1.328 Test Acc: 0.677
Validation loss decreased (-0.676653 --> -0.676653).  Saving model ...
Epoch: 81 cost time: 5.774956703186035
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.677 Test Loss: 1.327 Test Acc: 0.677
Validation loss decreased (-0.676653 --> -0.676653).  Saving model ...
Epoch: 82 cost time: 6.116455078125
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.683 Test Loss: 1.326 Test Acc: 0.683
Validation loss decreased (-0.676653 --> -0.683320).  Saving model ...
Epoch: 83 cost time: 5.769080400466919
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.680 Test Loss: 1.324 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 5.083195209503174
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.673 Test Loss: 1.322 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 5.6417014598846436
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.673 Test Loss: 1.322 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 5.391331672668457
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.677 Test Loss: 1.320 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 5.616340637207031
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.677 Test Loss: 1.319 Test Acc: 0.677
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 5.865653991699219
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.680 Test Loss: 1.323 Test Acc: 0.680
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 5.5990331172943115
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.687 Test Loss: 1.324 Test Acc: 0.687
Validation loss decreased (-0.683320 --> -0.686653).  Saving model ...
Epoch: 90 cost time: 5.656833171844482
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.680 Test Loss: 1.322 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 5.900880336761475
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.683 Test Loss: 1.320 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 5.626033067703247
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.687 Test Loss: 1.318 Test Acc: 0.687
Validation loss decreased (-0.686653 --> -0.686653).  Saving model ...
Epoch: 93 cost time: 5.538663387298584
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.687 Test Loss: 1.320 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 5.5039238929748535
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.687 Test Loss: 1.322 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 5.880451202392578
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.683 Test Loss: 1.321 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 5.700507402420044
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.680 Test Loss: 1.320 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 5.52996039390564
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.680 Test Loss: 1.319 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 5.80674147605896
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.690 Test Loss: 1.320 Test Acc: 0.690
Validation loss decreased (-0.686653 --> -0.689987).  Saving model ...
Epoch: 99 cost time: 5.960604429244995
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.680 Test Loss: 1.319 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 5.660780429840088
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.683 Test Loss: 1.316 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.69
model parameter : 5135385
model size : 29.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.254328727722168
Epoch: 1, Steps: 18 | Train Loss: 3.297 Vali Loss: 3.208 Vali Acc: 0.047 Test Loss: 3.208 Test Acc: 0.047
Validation loss decreased (inf --> -0.046635).  Saving model ...
Epoch: 2 cost time: 4.3929619789123535
Epoch: 2, Steps: 18 | Train Loss: 2.437 Vali Loss: 2.928 Vali Acc: 0.153 Test Loss: 2.928 Test Acc: 0.153
Validation loss decreased (-0.046635 --> -0.153304).  Saving model ...
Epoch: 3 cost time: 4.715786933898926
Epoch: 3, Steps: 18 | Train Loss: 1.298 Vali Loss: 2.789 Vali Acc: 0.157 Test Loss: 2.789 Test Acc: 0.157
Validation loss decreased (-0.153304 --> -0.156639).  Saving model ...
Epoch: 4 cost time: 4.966342210769653
Epoch: 4, Steps: 18 | Train Loss: 0.442 Vali Loss: 2.539 Vali Acc: 0.207 Test Loss: 2.539 Test Acc: 0.207
Validation loss decreased (-0.156639 --> -0.206641).  Saving model ...
Epoch: 5 cost time: 5.120263338088989
Epoch: 5, Steps: 18 | Train Loss: 0.094 Vali Loss: 2.208 Vali Acc: 0.313 Test Loss: 2.208 Test Acc: 0.313
Validation loss decreased (-0.206641 --> -0.313311).  Saving model ...
Epoch: 6 cost time: 5.773794651031494
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 2.015 Vali Acc: 0.387 Test Loss: 2.015 Test Acc: 0.387
Validation loss decreased (-0.313311 --> -0.386647).  Saving model ...
Epoch: 7 cost time: 5.392293453216553
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.963 Vali Acc: 0.383 Test Loss: 1.963 Test Acc: 0.383
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.446842908859253
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.898 Vali Acc: 0.393 Test Loss: 1.898 Test Acc: 0.393
Validation loss decreased (-0.386647 --> -0.393314).  Saving model ...
Epoch: 9 cost time: 5.548670291900635
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.801 Vali Acc: 0.440 Test Loss: 1.801 Test Acc: 0.440
Validation loss decreased (-0.393314 --> -0.439982).  Saving model ...
Epoch: 10 cost time: 5.623810291290283
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.735 Vali Acc: 0.473 Test Loss: 1.735 Test Acc: 0.473
Validation loss decreased (-0.439982 --> -0.473316).  Saving model ...
Epoch: 11 cost time: 5.567791223526001
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.706 Vali Acc: 0.473 Test Loss: 1.706 Test Acc: 0.473
Validation loss decreased (-0.473316 --> -0.473316).  Saving model ...
Epoch: 12 cost time: 5.441053152084351
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.672 Vali Acc: 0.500 Test Loss: 1.672 Test Acc: 0.500
Validation loss decreased (-0.473316 --> -0.499983).  Saving model ...
Epoch: 13 cost time: 5.521590232849121
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.645 Vali Acc: 0.513 Test Loss: 1.645 Test Acc: 0.513
Validation loss decreased (-0.499983 --> -0.513317).  Saving model ...
Epoch: 14 cost time: 5.659167528152466
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.611 Vali Acc: 0.513 Test Loss: 1.611 Test Acc: 0.513
Validation loss decreased (-0.513317 --> -0.513317).  Saving model ...
Epoch: 15 cost time: 5.4567954540252686
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.591 Vali Acc: 0.527 Test Loss: 1.591 Test Acc: 0.527
Validation loss decreased (-0.513317 --> -0.526651).  Saving model ...
Epoch: 16 cost time: 5.726386785507202
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.557 Vali Acc: 0.533 Test Loss: 1.557 Test Acc: 0.533
Validation loss decreased (-0.526651 --> -0.533318).  Saving model ...
Epoch: 17 cost time: 4.9900963306427
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.525 Vali Acc: 0.550 Test Loss: 1.525 Test Acc: 0.550
Validation loss decreased (-0.533318 --> -0.549985).  Saving model ...
Epoch: 18 cost time: 5.13240122795105
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.506 Vali Acc: 0.557 Test Loss: 1.506 Test Acc: 0.557
Validation loss decreased (-0.549985 --> -0.556652).  Saving model ...
Epoch: 19 cost time: 5.082679986953735
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.490 Vali Acc: 0.557 Test Loss: 1.490 Test Acc: 0.557
Validation loss decreased (-0.556652 --> -0.556652).  Saving model ...
Epoch: 20 cost time: 4.940111875534058
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.557 Test Loss: 1.470 Test Acc: 0.557
Validation loss decreased (-0.556652 --> -0.556652).  Saving model ...
Epoch: 21 cost time: 5.128056287765503
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.570 Test Loss: 1.452 Test Acc: 0.570
Validation loss decreased (-0.556652 --> -0.569985).  Saving model ...
Epoch: 22 cost time: 5.456206798553467
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.587 Test Loss: 1.439 Test Acc: 0.587
Validation loss decreased (-0.569985 --> -0.586652).  Saving model ...
Epoch: 23 cost time: 5.733975172042847
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.587 Test Loss: 1.410 Test Acc: 0.587
Validation loss decreased (-0.586652 --> -0.586653).  Saving model ...
Epoch: 24 cost time: 5.649001359939575
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.603 Test Loss: 1.400 Test Acc: 0.603
Validation loss decreased (-0.586653 --> -0.603319).  Saving model ...
Epoch: 25 cost time: 5.554059267044067
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.610 Test Loss: 1.393 Test Acc: 0.610
Validation loss decreased (-0.603319 --> -0.609986).  Saving model ...
Epoch: 26 cost time: 5.247333526611328
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.610 Test Loss: 1.387 Test Acc: 0.610
Validation loss decreased (-0.609986 --> -0.609986).  Saving model ...
Epoch: 27 cost time: 5.216345310211182
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.613 Test Loss: 1.372 Test Acc: 0.613
Validation loss decreased (-0.609986 --> -0.613320).  Saving model ...
Epoch: 28 cost time: 5.2700090408325195
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.613 Test Loss: 1.370 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 29 cost time: 5.155678749084473
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.362 Vali Acc: 0.623 Test Loss: 1.362 Test Acc: 0.623
Validation loss decreased (-0.613320 --> -0.623320).  Saving model ...
Epoch: 30 cost time: 5.2437543869018555
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.627 Test Loss: 1.352 Test Acc: 0.627
Validation loss decreased (-0.623320 --> -0.626653).  Saving model ...
Epoch: 31 cost time: 5.2952492237091064
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.620 Test Loss: 1.341 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.320099592208862
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.330 Vali Acc: 0.623 Test Loss: 1.330 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.9523584842681885
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.623 Test Loss: 1.326 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 5.846031427383423
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.630 Test Loss: 1.323 Test Acc: 0.630
Validation loss decreased (-0.626653 --> -0.629987).  Saving model ...
Epoch: 35 cost time: 5.8975958824157715
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.633 Test Loss: 1.314 Test Acc: 0.633
Validation loss decreased (-0.629987 --> -0.633320).  Saving model ...
Epoch: 36 cost time: 5.737517833709717
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.307 Vali Acc: 0.637 Test Loss: 1.307 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.636654).  Saving model ...
Epoch: 37 cost time: 5.5477752685546875
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.650 Test Loss: 1.295 Test Acc: 0.650
Validation loss decreased (-0.636654 --> -0.649987).  Saving model ...
Epoch: 38 cost time: 5.653311252593994
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.653 Test Loss: 1.292 Test Acc: 0.653
Validation loss decreased (-0.649987 --> -0.653320).  Saving model ...
Epoch: 39 cost time: 5.753270149230957
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.286 Vali Acc: 0.647 Test Loss: 1.286 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.492729425430298
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.650 Test Loss: 1.281 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 5.9396562576293945
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.277 Vali Acc: 0.663 Test Loss: 1.277 Test Acc: 0.663
Validation loss decreased (-0.653320 --> -0.663321).  Saving model ...
Epoch: 42 cost time: 5.804657936096191
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.657 Test Loss: 1.275 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.690179347991943
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.660 Test Loss: 1.267 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.7644922733306885
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.663 Test Loss: 1.266 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 45 cost time: 5.799678802490234
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.667 Test Loss: 1.262 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666654).  Saving model ...
Epoch: 46 cost time: 5.722631931304932
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.670 Test Loss: 1.257 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669987).  Saving model ...
Epoch: 47 cost time: 5.512797832489014
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.670 Test Loss: 1.253 Test Acc: 0.670
Validation loss decreased (-0.669987 --> -0.669987).  Saving model ...
Epoch: 48 cost time: 5.86648154258728
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.673 Test Loss: 1.248 Test Acc: 0.673
Validation loss decreased (-0.669987 --> -0.673321).  Saving model ...
Epoch: 49 cost time: 6.004515647888184
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.673 Test Loss: 1.246 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 50 cost time: 5.475291967391968
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.670 Test Loss: 1.242 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.834656715393066
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.667 Test Loss: 1.241 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 5.7463483810424805
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.244 Vali Acc: 0.667 Test Loss: 1.244 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 5.742316246032715
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.673 Test Loss: 1.241 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 54 cost time: 5.7605180740356445
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.677 Test Loss: 1.235 Test Acc: 0.677
Validation loss decreased (-0.673321 --> -0.676654).  Saving model ...
Epoch: 55 cost time: 5.764988660812378
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.683 Test Loss: 1.231 Test Acc: 0.683
Validation loss decreased (-0.676654 --> -0.683321).  Saving model ...
Epoch: 56 cost time: 6.074609756469727
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.680 Test Loss: 1.230 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.8732733726501465
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.683 Test Loss: 1.226 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 58 cost time: 6.107986927032471
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.690 Test Loss: 1.221 Test Acc: 0.690
Validation loss decreased (-0.683321 --> -0.689988).  Saving model ...
Epoch: 59 cost time: 6.020465850830078
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.687 Test Loss: 1.223 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.903799533843994
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.693 Test Loss: 1.221 Test Acc: 0.693
Validation loss decreased (-0.689988 --> -0.693321).  Saving model ...
Epoch: 61 cost time: 5.715541124343872
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.700 Test Loss: 1.217 Test Acc: 0.700
Validation loss decreased (-0.693321 --> -0.699988).  Saving model ...
Epoch: 62 cost time: 4.465896844863892
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.697 Test Loss: 1.216 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 5.477063179016113
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.693 Test Loss: 1.214 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 5.476841688156128
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.690 Test Loss: 1.213 Test Acc: 0.690
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 4.974883556365967
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.690 Test Loss: 1.206 Test Acc: 0.690
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 5.979287624359131
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.697 Test Loss: 1.203 Test Acc: 0.697
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 5.6155149936676025
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.700 Test Loss: 1.202 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 68 cost time: 5.691201686859131
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.700 Test Loss: 1.202 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.3038554191589355
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.700 Test Loss: 1.204 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 5.893982648849487
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.693 Test Loss: 1.204 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 6.323291778564453
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.697 Test Loss: 1.204 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 5.826447248458862
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.700 Test Loss: 1.201 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 73 cost time: 5.853702068328857
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.197 Vali Acc: 0.703 Test Loss: 1.197 Test Acc: 0.703
Validation loss decreased (-0.699988 --> -0.703321).  Saving model ...
Epoch: 74 cost time: 5.4671971797943115
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.703 Test Loss: 1.195 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 75 cost time: 5.850646734237671
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.710 Test Loss: 1.195 Test Acc: 0.710
Validation loss decreased (-0.703321 --> -0.709988).  Saving model ...
Epoch: 76 cost time: 5.856950044631958
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.196 Vali Acc: 0.703 Test Loss: 1.196 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 5.833287477493286
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.703 Test Loss: 1.195 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 4.796292304992676
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.196 Vali Acc: 0.707 Test Loss: 1.196 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 5.2434093952178955
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.710 Test Loss: 1.194 Test Acc: 0.710
Validation loss decreased (-0.709988 --> -0.709988).  Saving model ...
Epoch: 80 cost time: 5.362150192260742
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.707 Test Loss: 1.193 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 5.90809440612793
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.191 Vali Acc: 0.707 Test Loss: 1.191 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 5.915797472000122
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.191 Vali Acc: 0.707 Test Loss: 1.191 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 6.197021484375
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.707 Test Loss: 1.190 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 5.798152685165405
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.710 Test Loss: 1.189 Test Acc: 0.710
Validation loss decreased (-0.709988 --> -0.709988).  Saving model ...
Epoch: 85 cost time: 5.654047250747681
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.707 Test Loss: 1.187 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 5.839329481124878
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.710 Test Loss: 1.185 Test Acc: 0.710
Validation loss decreased (-0.709988 --> -0.709988).  Saving model ...
Epoch: 87 cost time: 6.07465934753418
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.713 Test Loss: 1.185 Test Acc: 0.713
Validation loss decreased (-0.709988 --> -0.713321).  Saving model ...
Epoch: 88 cost time: 5.851884365081787
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.713 Test Loss: 1.188 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 5.703952789306641
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.717 Test Loss: 1.189 Test Acc: 0.717
Validation loss decreased (-0.713321 --> -0.716655).  Saving model ...
Epoch: 90 cost time: 5.116584300994873
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.710 Test Loss: 1.187 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 5.472869157791138
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.713 Test Loss: 1.187 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 5.883637428283691
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.717 Test Loss: 1.187 Test Acc: 0.717
Validation loss decreased (-0.716655 --> -0.716655).  Saving model ...
Epoch: 93 cost time: 6.269247531890869
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.717 Test Loss: 1.188 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 5.54622483253479
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.720 Test Loss: 1.187 Test Acc: 0.720
Validation loss decreased (-0.716655 --> -0.719988).  Saving model ...
Epoch: 95 cost time: 5.578345775604248
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.186 Vali Acc: 0.720 Test Loss: 1.186 Test Acc: 0.720
Validation loss decreased (-0.719988 --> -0.719988).  Saving model ...
Epoch: 96 cost time: 6.1681296825408936
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.186 Vali Acc: 0.717 Test Loss: 1.186 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 6.382207632064819
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.720 Test Loss: 1.185 Test Acc: 0.720
Validation loss decreased (-0.719988 --> -0.719988).  Saving model ...
Epoch: 98 cost time: 6.058217287063599
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.717 Test Loss: 1.188 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 5.960890769958496
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.720 Test Loss: 1.187 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 6.042173385620117
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.720 Test Loss: 1.184 Test Acc: 0.720
Validation loss decreased (-0.719988 --> -0.719988).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.72
model parameter : 5135385
model size : 29.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.05733585357666
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 5.080793857574463
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.793270587921143
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.738545894622803
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.6306846141815186
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.299795389175415
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.705441236495972
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.608790874481201
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.528829097747803
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.039092063903809
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.185210466384888
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 5135385
model size : 29.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.0793492794036865
Epoch: 1, Steps: 18 | Train Loss: 2.794 Vali Loss: 1.619 Vali Acc: 0.740 Test Loss: 1.619 Test Acc: 0.740
Validation loss decreased (inf --> -0.739984).  Saving model ...
Epoch: 2 cost time: 6.210325002670288
Epoch: 2, Steps: 18 | Train Loss: 0.726 Vali Loss: 0.600 Vali Acc: 0.857 Test Loss: 0.600 Test Acc: 0.857
Validation loss decreased (-0.739984 --> -0.856661).  Saving model ...
Epoch: 3 cost time: 5.786266326904297
Epoch: 3, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.485 Vali Acc: 0.877 Test Loss: 0.485 Test Acc: 0.877
Validation loss decreased (-0.856661 --> -0.876662).  Saving model ...
Epoch: 4 cost time: 4.903825283050537
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.876662 --> -0.899996).  Saving model ...
Epoch: 5 cost time: 5.123385667800903
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.400 Vali Acc: 0.893 Test Loss: 0.400 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.848772764205933
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 4.979945182800293
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
Validation loss decreased (-0.899996 --> -0.903330).  Saving model ...
Epoch: 8 cost time: 5.1653032302856445
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.652445077896118
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.574868440628052
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.903 Test Loss: 0.374 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 11 cost time: 5.573113679885864
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.371 Vali Acc: 0.903 Test Loss: 0.371 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 12 cost time: 5.693101406097412
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.873377799987793
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.544778347015381
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 15 cost time: 5.514686346054077
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 16 cost time: 5.776736497879028
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.903 Test Loss: 0.366 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 17 cost time: 5.882136821746826
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 18 cost time: 6.038701772689819
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 19 cost time: 5.9946887493133545
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 20 cost time: 5.639004230499268
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 21 cost time: 5.459151268005371
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 22 cost time: 5.506734132766724
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.9863197803497314
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.288738965988159
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.205869913101196
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.62615966796875
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 27 cost time: 5.7343738079071045
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.8101277351379395
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 29 cost time: 5.516064167022705
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 30 cost time: 5.485308408737183
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 31 cost time: 5.603927373886108
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.004706144332886
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.849205255508423
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 5.520985126495361
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 5.444875955581665
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 5.746150732040405
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 5.86692476272583
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 5.241068363189697
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 5.095612525939941
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.907 Test Loss: 0.362 Test Acc: 0.907
Validation loss decreased (-0.903330 --> -0.906663).  Saving model ...
Epoch: 40 cost time: 5.289911985397339
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.910 Test Loss: 0.362 Test Acc: 0.910
Validation loss decreased (-0.906663 --> -0.909996).  Saving model ...
Epoch: 41 cost time: 5.71221399307251
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.510076522827148
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 5.261537313461304
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 5.634148359298706
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 5.570708513259888
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.907 Test Loss: 0.362 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 5.804622411727905
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 5.79805326461792
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 5.490326881408691
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 4.9889209270477295
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.907 Test Loss: 0.361 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 5.694773435592651
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.91
model parameter : 4348953
model size : 26.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.576794147491455
Epoch: 1, Steps: 18 | Train Loss: 2.896 Vali Loss: 1.976 Vali Acc: 0.637 Test Loss: 1.976 Test Acc: 0.637
Validation loss decreased (inf --> -0.636647).  Saving model ...
Epoch: 2 cost time: 5.257375240325928
Epoch: 2, Steps: 18 | Train Loss: 0.976 Vali Loss: 0.853 Vali Acc: 0.807 Test Loss: 0.853 Test Acc: 0.807
Validation loss decreased (-0.636647 --> -0.806658).  Saving model ...
Epoch: 3 cost time: 5.554373502731323
Epoch: 3, Steps: 18 | Train Loss: 0.197 Vali Loss: 0.665 Vali Acc: 0.817 Test Loss: 0.665 Test Acc: 0.817
Validation loss decreased (-0.806658 --> -0.816660).  Saving model ...
Epoch: 4 cost time: 5.836759090423584
Epoch: 4, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 5.868032693862915
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 6 cost time: 5.873294353485107
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.534 Vali Acc: 0.863 Test Loss: 0.534 Test Acc: 0.863
Validation loss decreased (-0.849994 --> -0.863328).  Saving model ...
Epoch: 7 cost time: 5.905200719833374
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.3696300983428955
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.857 Test Loss: 0.527 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.6771111488342285
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.7610023021698
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.860 Test Loss: 0.534 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.320080995559692
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.853 Test Loss: 0.527 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.746475696563721
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.853 Test Loss: 0.529 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.589185953140259
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.853 Test Loss: 0.527 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.209068536758423
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.857 Test Loss: 0.526 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.694077968597412
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.853 Test Loss: 0.527 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.0149078369140625
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.857 Test Loss: 0.528 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8633333333333333
model parameter : 4348953
model size : 26.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.538347959518433
Epoch: 1, Steps: 18 | Train Loss: 3.035 Vali Loss: 2.430 Vali Acc: 0.483 Test Loss: 2.430 Test Acc: 0.483
Validation loss decreased (inf --> -0.483309).  Saving model ...
Epoch: 2 cost time: 5.980546951293945
Epoch: 2, Steps: 18 | Train Loss: 1.399 Vali Loss: 1.334 Vali Acc: 0.713 Test Loss: 1.334 Test Acc: 0.713
Validation loss decreased (-0.483309 --> -0.713320).  Saving model ...
Epoch: 3 cost time: 5.6006011962890625
Epoch: 3, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.995 Vali Acc: 0.727 Test Loss: 0.995 Test Acc: 0.727
Validation loss decreased (-0.713320 --> -0.726657).  Saving model ...
Epoch: 4 cost time: 5.7815327644348145
Epoch: 4, Steps: 18 | Train Loss: 0.056 Vali Loss: 1.024 Vali Acc: 0.733 Test Loss: 1.024 Test Acc: 0.733
Validation loss decreased (-0.726657 --> -0.733323).  Saving model ...
Epoch: 5 cost time: 5.681911468505859
Epoch: 5, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.886 Vali Acc: 0.747 Test Loss: 0.886 Test Acc: 0.747
Validation loss decreased (-0.733323 --> -0.746658).  Saving model ...
Epoch: 6 cost time: 6.080536603927612
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.866 Vali Acc: 0.773 Test Loss: 0.866 Test Acc: 0.773
Validation loss decreased (-0.746658 --> -0.773325).  Saving model ...
Epoch: 7 cost time: 5.418233633041382
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.830 Vali Acc: 0.783 Test Loss: 0.830 Test Acc: 0.783
Validation loss decreased (-0.773325 --> -0.783325).  Saving model ...
Epoch: 8 cost time: 5.421669006347656
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.815 Vali Acc: 0.783 Test Loss: 0.815 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783325).  Saving model ...
Epoch: 9 cost time: 4.9789040088653564
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.809 Vali Acc: 0.787 Test Loss: 0.809 Test Acc: 0.787
Validation loss decreased (-0.783325 --> -0.786659).  Saving model ...
Epoch: 10 cost time: 5.700582265853882
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.790 Test Loss: 0.807 Test Acc: 0.790
Validation loss decreased (-0.786659 --> -0.789992).  Saving model ...
Epoch: 11 cost time: 5.3541646003723145
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.808 Vali Acc: 0.793 Test Loss: 0.808 Test Acc: 0.793
Validation loss decreased (-0.789992 --> -0.793325).  Saving model ...
Epoch: 12 cost time: 5.486169815063477
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.815 Vali Acc: 0.783 Test Loss: 0.815 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.901734828948975
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.790 Test Loss: 0.812 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.584225177764893
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.790 Test Loss: 0.813 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.56436562538147
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.790 Test Loss: 0.813 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.6658313274383545
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.815 Vali Acc: 0.793 Test Loss: 0.815 Test Acc: 0.793
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.637265920639038
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.819 Vali Acc: 0.787 Test Loss: 0.819 Test Acc: 0.787
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.099889516830444
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.819 Vali Acc: 0.783 Test Loss: 0.819 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.648063659667969
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.787 Test Loss: 0.818 Test Acc: 0.787
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.139788866043091
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.790 Test Loss: 0.821 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.710839509963989
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.787 Test Loss: 0.821 Test Acc: 0.787
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7933333333333333
model parameter : 4348953
model size : 26.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.787911653518677
Epoch: 1, Steps: 18 | Train Loss: 3.156 Vali Loss: 2.759 Vali Acc: 0.330 Test Loss: 2.759 Test Acc: 0.330
Validation loss decreased (inf --> -0.329972).  Saving model ...
Epoch: 2 cost time: 5.448939323425293
Epoch: 2, Steps: 18 | Train Loss: 1.861 Vali Loss: 1.945 Vali Acc: 0.533 Test Loss: 1.945 Test Acc: 0.533
Validation loss decreased (-0.329972 --> -0.533314).  Saving model ...
Epoch: 3 cost time: 5.452762603759766
Epoch: 3, Steps: 18 | Train Loss: 0.684 Vali Loss: 1.539 Vali Acc: 0.513 Test Loss: 1.539 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.52016806602478
Epoch: 4, Steps: 18 | Train Loss: 0.146 Vali Loss: 1.552 Vali Acc: 0.523 Test Loss: 1.552 Test Acc: 0.523
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.497246265411377
Epoch: 5, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.266 Vali Acc: 0.617 Test Loss: 1.266 Test Acc: 0.617
Validation loss decreased (-0.533314 --> -0.616654).  Saving model ...
Epoch: 6 cost time: 5.520425319671631
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.209 Vali Acc: 0.640 Test Loss: 1.209 Test Acc: 0.640
Validation loss decreased (-0.616654 --> -0.639988).  Saving model ...
Epoch: 7 cost time: 5.267169237136841
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.147 Vali Acc: 0.640 Test Loss: 1.147 Test Acc: 0.640
Validation loss decreased (-0.639988 --> -0.639989).  Saving model ...
Epoch: 8 cost time: 5.690393447875977
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.160 Vali Acc: 0.647 Test Loss: 1.160 Test Acc: 0.647
Validation loss decreased (-0.639989 --> -0.646655).  Saving model ...
Epoch: 9 cost time: 5.399640083312988
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.159 Vali Acc: 0.663 Test Loss: 1.159 Test Acc: 0.663
Validation loss decreased (-0.646655 --> -0.663322).  Saving model ...
Epoch: 10 cost time: 5.289701461791992
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.158 Vali Acc: 0.650 Test Loss: 1.158 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.579523324966431
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.157 Vali Acc: 0.653 Test Loss: 1.157 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.608814239501953
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.151 Vali Acc: 0.650 Test Loss: 1.151 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.905282020568848
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.144 Vali Acc: 0.673 Test Loss: 1.144 Test Acc: 0.673
Validation loss decreased (-0.663322 --> -0.673322).  Saving model ...
Epoch: 14 cost time: 5.4178078174591064
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.138 Vali Acc: 0.660 Test Loss: 1.138 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.357765197753906
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.135 Vali Acc: 0.677 Test Loss: 1.135 Test Acc: 0.677
Validation loss decreased (-0.673322 --> -0.676655).  Saving model ...
Epoch: 16 cost time: 5.443371295928955
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.131 Vali Acc: 0.667 Test Loss: 1.131 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.597101449966431
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.132 Vali Acc: 0.677 Test Loss: 1.132 Test Acc: 0.677
Validation loss decreased (-0.676655 --> -0.676655).  Saving model ...
Epoch: 18 cost time: 5.394484519958496
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.129 Vali Acc: 0.680 Test Loss: 1.129 Test Acc: 0.680
Validation loss decreased (-0.676655 --> -0.679989).  Saving model ...
Epoch: 19 cost time: 5.409160614013672
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.126 Vali Acc: 0.683 Test Loss: 1.126 Test Acc: 0.683
Validation loss decreased (-0.679989 --> -0.683322).  Saving model ...
Epoch: 20 cost time: 5.147039413452148
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.690 Test Loss: 1.122 Test Acc: 0.690
Validation loss decreased (-0.683322 --> -0.689989).  Saving model ...
Epoch: 21 cost time: 5.7471230030059814
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.121 Vali Acc: 0.693 Test Loss: 1.121 Test Acc: 0.693
Validation loss decreased (-0.689989 --> -0.693322).  Saving model ...
Epoch: 22 cost time: 4.839517593383789
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.118 Vali Acc: 0.693 Test Loss: 1.118 Test Acc: 0.693
Validation loss decreased (-0.693322 --> -0.693322).  Saving model ...
Epoch: 23 cost time: 5.628798007965088
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.110 Vali Acc: 0.687 Test Loss: 1.110 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.389484405517578
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.687 Test Loss: 1.108 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.536959409713745
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.109 Vali Acc: 0.683 Test Loss: 1.109 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.5891618728637695
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.110 Vali Acc: 0.683 Test Loss: 1.110 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.236307144165039
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.110 Vali Acc: 0.700 Test Loss: 1.110 Test Acc: 0.700
Validation loss decreased (-0.693322 --> -0.699989).  Saving model ...
Epoch: 28 cost time: 5.404117584228516
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.102 Vali Acc: 0.700 Test Loss: 1.102 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 29 cost time: 5.890795946121216
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.100 Vali Acc: 0.700 Test Loss: 1.100 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 30 cost time: 5.477412939071655
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.099 Vali Acc: 0.697 Test Loss: 1.099 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.77883505821228
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.104 Vali Acc: 0.707 Test Loss: 1.104 Test Acc: 0.707
Validation loss decreased (-0.699989 --> -0.706656).  Saving model ...
Epoch: 32 cost time: 5.426392316818237
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.100 Vali Acc: 0.700 Test Loss: 1.100 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.776365756988525
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.096 Vali Acc: 0.697 Test Loss: 1.096 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.7475426197052
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.093 Vali Acc: 0.690 Test Loss: 1.093 Test Acc: 0.690
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.557517051696777
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.092 Vali Acc: 0.690 Test Loss: 1.092 Test Acc: 0.690
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 5.710973739624023
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.693 Test Loss: 1.089 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 5.1088573932647705
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.697 Test Loss: 1.089 Test Acc: 0.697
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 5.391679048538208
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.703 Test Loss: 1.087 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 5.621103763580322
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.703 Test Loss: 1.090 Test Acc: 0.703
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 5.7211594581604
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.703 Test Loss: 1.087 Test Acc: 0.703
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 5.804628610610962
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.085 Vali Acc: 0.697 Test Loss: 1.085 Test Acc: 0.697
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7066666666666667
model parameter : 4348953
model size : 26.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.658091068267822
Epoch: 1, Steps: 18 | Train Loss: 3.232 Vali Loss: 3.010 Vali Acc: 0.123 Test Loss: 3.010 Test Acc: 0.123
Validation loss decreased (inf --> -0.123303).  Saving model ...
Epoch: 2 cost time: 5.41809868812561
Epoch: 2, Steps: 18 | Train Loss: 2.153 Vali Loss: 2.458 Vali Acc: 0.343 Test Loss: 2.458 Test Acc: 0.343
Validation loss decreased (-0.123303 --> -0.343309).  Saving model ...
Epoch: 3 cost time: 5.25991415977478
Epoch: 3, Steps: 18 | Train Loss: 0.960 Vali Loss: 2.161 Vali Acc: 0.310 Test Loss: 2.161 Test Acc: 0.310
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.3326311111450195
Epoch: 4, Steps: 18 | Train Loss: 0.252 Vali Loss: 2.000 Vali Acc: 0.383 Test Loss: 2.000 Test Acc: 0.383
Validation loss decreased (-0.343309 --> -0.383313).  Saving model ...
Epoch: 5 cost time: 4.686009168624878
Epoch: 5, Steps: 18 | Train Loss: 0.055 Vali Loss: 1.748 Vali Acc: 0.450 Test Loss: 1.748 Test Acc: 0.450
Validation loss decreased (-0.383313 --> -0.449983).  Saving model ...
Epoch: 6 cost time: 4.985193490982056
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.714 Vali Acc: 0.483 Test Loss: 1.714 Test Acc: 0.483
Validation loss decreased (-0.449983 --> -0.483316).  Saving model ...
Epoch: 7 cost time: 5.117709636688232
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.664 Vali Acc: 0.500 Test Loss: 1.664 Test Acc: 0.500
Validation loss decreased (-0.483316 --> -0.499983).  Saving model ...
Epoch: 8 cost time: 4.960747003555298
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.600 Vali Acc: 0.510 Test Loss: 1.600 Test Acc: 0.510
Validation loss decreased (-0.499983 --> -0.509984).  Saving model ...
Epoch: 9 cost time: 4.739001989364624
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.593 Vali Acc: 0.557 Test Loss: 1.593 Test Acc: 0.557
Validation loss decreased (-0.509984 --> -0.556651).  Saving model ...
Epoch: 10 cost time: 5.343210697174072
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.582 Vali Acc: 0.543 Test Loss: 1.582 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.468064308166504
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.569 Vali Acc: 0.550 Test Loss: 1.569 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.306094169616699
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.555 Vali Acc: 0.543 Test Loss: 1.555 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.4770872592926025
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.540 Vali Acc: 0.560 Test Loss: 1.540 Test Acc: 0.560
Validation loss decreased (-0.556651 --> -0.559985).  Saving model ...
Epoch: 14 cost time: 5.066103458404541
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.557 Test Loss: 1.530 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.24688458442688
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.518 Vali Acc: 0.567 Test Loss: 1.518 Test Acc: 0.567
Validation loss decreased (-0.559985 --> -0.566651).  Saving model ...
Epoch: 16 cost time: 5.436290502548218
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.506 Vali Acc: 0.570 Test Loss: 1.506 Test Acc: 0.570
Validation loss decreased (-0.566651 --> -0.569985).  Saving model ...
Epoch: 17 cost time: 5.253086566925049
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.501 Vali Acc: 0.567 Test Loss: 1.501 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.059582948684692
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.494 Vali Acc: 0.573 Test Loss: 1.494 Test Acc: 0.573
Validation loss decreased (-0.569985 --> -0.573318).  Saving model ...
Epoch: 19 cost time: 5.216751337051392
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.488 Vali Acc: 0.583 Test Loss: 1.488 Test Acc: 0.583
Validation loss decreased (-0.573318 --> -0.583318).  Saving model ...
Epoch: 20 cost time: 5.118837833404541
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.583 Test Loss: 1.479 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583319).  Saving model ...
Epoch: 21 cost time: 4.908599615097046
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.577 Test Loss: 1.472 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.252577304840088
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.580 Test Loss: 1.467 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.742218732833862
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.590 Test Loss: 1.460 Test Acc: 0.590
Validation loss decreased (-0.583319 --> -0.589985).  Saving model ...
Epoch: 24 cost time: 4.181852102279663
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.590 Test Loss: 1.455 Test Acc: 0.590
Validation loss decreased (-0.589985 --> -0.589985).  Saving model ...
Epoch: 25 cost time: 4.820820093154907
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.587 Test Loss: 1.453 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.8780670166015625
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.590 Test Loss: 1.450 Test Acc: 0.590
Validation loss decreased (-0.589985 --> -0.589985).  Saving model ...
Epoch: 27 cost time: 4.948842763900757
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.597 Test Loss: 1.448 Test Acc: 0.597
Validation loss decreased (-0.589985 --> -0.596652).  Saving model ...
Epoch: 28 cost time: 5.153919458389282
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.597 Test Loss: 1.436 Test Acc: 0.597
Validation loss decreased (-0.596652 --> -0.596652).  Saving model ...
Epoch: 29 cost time: 5.517267227172852
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.597 Test Loss: 1.434 Test Acc: 0.597
Validation loss decreased (-0.596652 --> -0.596652).  Saving model ...
Epoch: 30 cost time: 5.862004995346069
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.597 Test Loss: 1.432 Test Acc: 0.597
Validation loss decreased (-0.596652 --> -0.596652).  Saving model ...
Epoch: 31 cost time: 5.470060586929321
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.597 Test Loss: 1.433 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.644569158554077
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.607 Test Loss: 1.425 Test Acc: 0.607
Validation loss decreased (-0.596652 --> -0.606652).  Saving model ...
Epoch: 33 cost time: 5.29643177986145
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.610 Test Loss: 1.418 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 34 cost time: 5.1116485595703125
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.610 Test Loss: 1.413 Test Acc: 0.610
Validation loss decreased (-0.609986 --> -0.609986).  Saving model ...
Epoch: 35 cost time: 4.368589639663696
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.617 Test Loss: 1.413 Test Acc: 0.617
Validation loss decreased (-0.609986 --> -0.616653).  Saving model ...
Epoch: 36 cost time: 4.6502275466918945
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.630 Test Loss: 1.410 Test Acc: 0.630
Validation loss decreased (-0.616653 --> -0.629986).  Saving model ...
Epoch: 37 cost time: 5.036500692367554
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.623 Test Loss: 1.407 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.435184717178345
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.623 Test Loss: 1.405 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 5.344825029373169
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.623 Test Loss: 1.406 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 5.265475511550903
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.623 Test Loss: 1.404 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 5.47036337852478
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.402 Vali Acc: 0.623 Test Loss: 1.402 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 5.23427152633667
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.620 Test Loss: 1.398 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 4.562760353088379
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.623 Test Loss: 1.393 Test Acc: 0.623
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 5.013577699661255
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.623 Test Loss: 1.391 Test Acc: 0.623
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 4.832733392715454
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.623 Test Loss: 1.389 Test Acc: 0.623
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 5.241461753845215
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.627 Test Loss: 1.386 Test Acc: 0.627
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.63
model parameter : 4348953
model size : 26.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.635718822479248
Epoch: 1, Steps: 18 | Train Loss: 3.223 Vali Loss: 3.094 Vali Acc: 0.113 Test Loss: 3.094 Test Acc: 0.113
Validation loss decreased (inf --> -0.113302).  Saving model ...
Epoch: 2 cost time: 5.354597091674805
Epoch: 2, Steps: 18 | Train Loss: 2.194 Vali Loss: 2.674 Vali Acc: 0.267 Test Loss: 2.674 Test Acc: 0.267
Validation loss decreased (-0.113302 --> -0.266640).  Saving model ...
Epoch: 3 cost time: 5.231032371520996
Epoch: 3, Steps: 18 | Train Loss: 1.004 Vali Loss: 2.431 Vali Acc: 0.283 Test Loss: 2.431 Test Acc: 0.283
Validation loss decreased (-0.266640 --> -0.283309).  Saving model ...
Epoch: 4 cost time: 5.462978363037109
Epoch: 4, Steps: 18 | Train Loss: 0.262 Vali Loss: 2.376 Vali Acc: 0.360 Test Loss: 2.376 Test Acc: 0.360
Validation loss decreased (-0.283309 --> -0.359976).  Saving model ...
Epoch: 5 cost time: 5.202206134796143
Epoch: 5, Steps: 18 | Train Loss: 0.056 Vali Loss: 2.153 Vali Acc: 0.340 Test Loss: 2.153 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.6472251415252686
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 2.027 Vali Acc: 0.440 Test Loss: 2.027 Test Acc: 0.440
Validation loss decreased (-0.359976 --> -0.439980).  Saving model ...
Epoch: 7 cost time: 5.343129873275757
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.036 Vali Acc: 0.417 Test Loss: 2.036 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.536874771118164
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.995 Vali Acc: 0.443 Test Loss: 1.995 Test Acc: 0.443
Validation loss decreased (-0.439980 --> -0.443313).  Saving model ...
Epoch: 9 cost time: 5.257176160812378
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.973 Vali Acc: 0.453 Test Loss: 1.973 Test Acc: 0.453
Validation loss decreased (-0.443313 --> -0.453314).  Saving model ...
Epoch: 10 cost time: 5.283938407897949
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.957 Vali Acc: 0.460 Test Loss: 1.957 Test Acc: 0.460
Validation loss decreased (-0.453314 --> -0.459980).  Saving model ...
Epoch: 11 cost time: 5.2675697803497314
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.936 Vali Acc: 0.477 Test Loss: 1.936 Test Acc: 0.477
Validation loss decreased (-0.459980 --> -0.476647).  Saving model ...
Epoch: 12 cost time: 5.40533447265625
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.922 Vali Acc: 0.467 Test Loss: 1.922 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.179506301879883
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.903 Vali Acc: 0.477 Test Loss: 1.903 Test Acc: 0.477
Validation loss decreased (-0.476647 --> -0.476648).  Saving model ...
Epoch: 14 cost time: 4.363364219665527
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.893 Vali Acc: 0.490 Test Loss: 1.893 Test Acc: 0.490
Validation loss decreased (-0.476648 --> -0.489981).  Saving model ...
Epoch: 15 cost time: 4.328908443450928
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.875 Vali Acc: 0.483 Test Loss: 1.875 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.261406660079956
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.860 Vali Acc: 0.493 Test Loss: 1.860 Test Acc: 0.493
Validation loss decreased (-0.489981 --> -0.493315).  Saving model ...
Epoch: 17 cost time: 5.16113543510437
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.850 Vali Acc: 0.497 Test Loss: 1.850 Test Acc: 0.497
Validation loss decreased (-0.493315 --> -0.496648).  Saving model ...
Epoch: 18 cost time: 5.290972471237183
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.837 Vali Acc: 0.503 Test Loss: 1.837 Test Acc: 0.503
Validation loss decreased (-0.496648 --> -0.503315).  Saving model ...
Epoch: 19 cost time: 5.540590524673462
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.831 Vali Acc: 0.503 Test Loss: 1.831 Test Acc: 0.503
Validation loss decreased (-0.503315 --> -0.503315).  Saving model ...
Epoch: 20 cost time: 5.526480674743652
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.818 Vali Acc: 0.510 Test Loss: 1.818 Test Acc: 0.510
Validation loss decreased (-0.503315 --> -0.509982).  Saving model ...
Epoch: 21 cost time: 5.6929004192352295
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.808 Vali Acc: 0.527 Test Loss: 1.808 Test Acc: 0.527
Validation loss decreased (-0.509982 --> -0.526649).  Saving model ...
Epoch: 22 cost time: 5.424237489700317
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.793 Vali Acc: 0.527 Test Loss: 1.793 Test Acc: 0.527
Validation loss decreased (-0.526649 --> -0.526649).  Saving model ...
Epoch: 23 cost time: 5.302099704742432
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.783 Vali Acc: 0.537 Test Loss: 1.783 Test Acc: 0.537
Validation loss decreased (-0.526649 --> -0.536649).  Saving model ...
Epoch: 24 cost time: 5.402275800704956
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.770 Vali Acc: 0.547 Test Loss: 1.770 Test Acc: 0.547
Validation loss decreased (-0.536649 --> -0.546649).  Saving model ...
Epoch: 25 cost time: 5.251554489135742
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.762 Vali Acc: 0.540 Test Loss: 1.762 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.754440784454346
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.754 Vali Acc: 0.550 Test Loss: 1.754 Test Acc: 0.550
Validation loss decreased (-0.546649 --> -0.549982).  Saving model ...
Epoch: 27 cost time: 5.018576622009277
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.547 Test Loss: 1.742 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.9737255573272705
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.729 Vali Acc: 0.553 Test Loss: 1.729 Test Acc: 0.553
Validation loss decreased (-0.549982 --> -0.553316).  Saving model ...
Epoch: 29 cost time: 5.390820741653442
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.553 Test Loss: 1.721 Test Acc: 0.553
Validation loss decreased (-0.553316 --> -0.553316).  Saving model ...
Epoch: 30 cost time: 5.343811988830566
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.718 Vali Acc: 0.563 Test Loss: 1.718 Test Acc: 0.563
Validation loss decreased (-0.553316 --> -0.563316).  Saving model ...
Epoch: 31 cost time: 5.544250011444092
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.711 Vali Acc: 0.563 Test Loss: 1.711 Test Acc: 0.563
Validation loss decreased (-0.563316 --> -0.563316).  Saving model ...
Epoch: 32 cost time: 5.436279535293579
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.705 Vali Acc: 0.553 Test Loss: 1.705 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.39116907119751
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.695 Vali Acc: 0.560 Test Loss: 1.695 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.368102550506592
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.690 Vali Acc: 0.560 Test Loss: 1.690 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.212220907211304
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.687 Vali Acc: 0.563 Test Loss: 1.687 Test Acc: 0.563
Validation loss decreased (-0.563316 --> -0.563316).  Saving model ...
Epoch: 36 cost time: 5.297762870788574
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.678 Vali Acc: 0.563 Test Loss: 1.678 Test Acc: 0.563
Validation loss decreased (-0.563316 --> -0.563317).  Saving model ...
Epoch: 37 cost time: 5.5960917472839355
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.672 Vali Acc: 0.580 Test Loss: 1.672 Test Acc: 0.580
Validation loss decreased (-0.563317 --> -0.579983).  Saving model ...
Epoch: 38 cost time: 5.708721876144409
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.670 Vali Acc: 0.570 Test Loss: 1.670 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.762977123260498
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.674 Vali Acc: 0.570 Test Loss: 1.674 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 5.3643128871917725
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.570 Test Loss: 1.669 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 5.272685289382935
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.662 Vali Acc: 0.573 Test Loss: 1.662 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 5.734948396682739
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.657 Vali Acc: 0.580 Test Loss: 1.657 Test Acc: 0.580
Validation loss decreased (-0.579983 --> -0.579983).  Saving model ...
Epoch: 43 cost time: 5.656299352645874
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.652 Vali Acc: 0.583 Test Loss: 1.652 Test Acc: 0.583
Validation loss decreased (-0.579983 --> -0.583317).  Saving model ...
Epoch: 44 cost time: 6.195942401885986
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.580 Test Loss: 1.645 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.4152631759643555
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.590 Test Loss: 1.639 Test Acc: 0.590
Validation loss decreased (-0.583317 --> -0.589984).  Saving model ...
Epoch: 46 cost time: 5.243504762649536
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.632 Vali Acc: 0.593 Test Loss: 1.632 Test Acc: 0.593
Validation loss decreased (-0.589984 --> -0.593317).  Saving model ...
Epoch: 47 cost time: 5.775260925292969
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.593 Test Loss: 1.630 Test Acc: 0.593
Validation loss decreased (-0.593317 --> -0.593317).  Saving model ...
Epoch: 48 cost time: 5.586653232574463
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.590 Test Loss: 1.627 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.798649072647095
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.587 Test Loss: 1.627 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 5.603668689727783
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.623 Vali Acc: 0.587 Test Loss: 1.623 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 5.6035685539245605
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.587 Test Loss: 1.620 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 5.388672590255737
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.615 Vali Acc: 0.587 Test Loss: 1.615 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 5.465479612350464
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.593 Test Loss: 1.611 Test Acc: 0.593
Validation loss decreased (-0.593317 --> -0.593317).  Saving model ...
Epoch: 54 cost time: 5.477298736572266
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.593 Test Loss: 1.606 Test Acc: 0.593
Validation loss decreased (-0.593317 --> -0.593317).  Saving model ...
Epoch: 55 cost time: 5.78774881362915
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.597 Test Loss: 1.604 Test Acc: 0.597
Validation loss decreased (-0.593317 --> -0.596651).  Saving model ...
Epoch: 56 cost time: 5.7158143520355225
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.600 Vali Acc: 0.600 Test Loss: 1.600 Test Acc: 0.600
Validation loss decreased (-0.596651 --> -0.599984).  Saving model ...
Epoch: 57 cost time: 5.563635349273682
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.600 Test Loss: 1.597 Test Acc: 0.600
Validation loss decreased (-0.599984 --> -0.599984).  Saving model ...
Epoch: 58 cost time: 5.872168064117432
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.593 Vali Acc: 0.597 Test Loss: 1.593 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 5.850712537765503
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.600 Test Loss: 1.591 Test Acc: 0.600
Validation loss decreased (-0.599984 --> -0.599984).  Saving model ...
Epoch: 60 cost time: 5.884196519851685
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.603 Test Loss: 1.590 Test Acc: 0.603
Validation loss decreased (-0.599984 --> -0.603317).  Saving model ...
Epoch: 61 cost time: 5.942808628082275
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.603 Test Loss: 1.587 Test Acc: 0.603
Validation loss decreased (-0.603317 --> -0.603317).  Saving model ...
Epoch: 62 cost time: 5.736455917358398
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.603 Test Loss: 1.585 Test Acc: 0.603
Validation loss decreased (-0.603317 --> -0.603317).  Saving model ...
Epoch: 63 cost time: 5.506420612335205
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.603 Test Loss: 1.580 Test Acc: 0.603
Validation loss decreased (-0.603317 --> -0.603318).  Saving model ...
Epoch: 64 cost time: 5.897287845611572
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.603 Test Loss: 1.579 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 65 cost time: 6.018547058105469
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.603 Test Loss: 1.580 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.492019414901733
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.603 Test Loss: 1.578 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 67 cost time: 5.7672834396362305
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.607 Test Loss: 1.574 Test Acc: 0.607
Validation loss decreased (-0.603318 --> -0.606651).  Saving model ...
Epoch: 68 cost time: 5.709498167037964
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.607 Test Loss: 1.572 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606651).  Saving model ...
Epoch: 69 cost time: 5.463892936706543
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.570 Vali Acc: 0.607 Test Loss: 1.570 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606651).  Saving model ...
Epoch: 70 cost time: 5.67083740234375
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.603 Test Loss: 1.572 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 5.948993921279907
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.603 Test Loss: 1.569 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 5.535348176956177
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.603 Test Loss: 1.567 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 5.727730989456177
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.603 Test Loss: 1.566 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 5.615823268890381
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.564 Vali Acc: 0.607 Test Loss: 1.564 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606651).  Saving model ...
Epoch: 75 cost time: 5.890209436416626
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.610 Test Loss: 1.562 Test Acc: 0.610
Validation loss decreased (-0.606651 --> -0.609984).  Saving model ...
Epoch: 76 cost time: 5.445485591888428
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.610 Test Loss: 1.559 Test Acc: 0.610
Validation loss decreased (-0.609984 --> -0.609984).  Saving model ...
Epoch: 77 cost time: 5.352921485900879
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.610 Test Loss: 1.558 Test Acc: 0.610
Validation loss decreased (-0.609984 --> -0.609984).  Saving model ...
Epoch: 78 cost time: 5.538249492645264
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.610 Test Loss: 1.559 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 5.368732213973999
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.610 Test Loss: 1.556 Test Acc: 0.610
Validation loss decreased (-0.609984 --> -0.609984).  Saving model ...
Epoch: 80 cost time: 5.759391784667969
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.555 Vali Acc: 0.607 Test Loss: 1.555 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 5.7965004444122314
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.610 Test Loss: 1.553 Test Acc: 0.610
Validation loss decreased (-0.609984 --> -0.609984).  Saving model ...
Epoch: 82 cost time: 5.7413671016693115
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.607 Test Loss: 1.551 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 5.966431617736816
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.607 Test Loss: 1.550 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 5.761162281036377
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.607 Test Loss: 1.551 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 5.88925576210022
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.617 Test Loss: 1.549 Test Acc: 0.617
Validation loss decreased (-0.609984 --> -0.616651).  Saving model ...
Epoch: 86 cost time: 5.437563896179199
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.613 Test Loss: 1.547 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 5.181930065155029
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.543 Vali Acc: 0.613 Test Loss: 1.543 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 5.462631702423096
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.617 Test Loss: 1.541 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616651).  Saving model ...
Epoch: 89 cost time: 4.980588912963867
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.617 Test Loss: 1.541 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616651).  Saving model ...
Epoch: 90 cost time: 5.402227163314819
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.620 Test Loss: 1.538 Test Acc: 0.620
Validation loss decreased (-0.616651 --> -0.619985).  Saving model ...
Epoch: 91 cost time: 5.357993841171265
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.617 Test Loss: 1.540 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 5.559370279312134
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.617 Test Loss: 1.539 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 5.634024381637573
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.617 Test Loss: 1.539 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 5.680764675140381
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.620 Test Loss: 1.540 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 5.320721864700317
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.617 Test Loss: 1.539 Test Acc: 0.617
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 5.106025457382202
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.537 Vali Acc: 0.617 Test Loss: 1.537 Test Acc: 0.617
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 5.2611939907073975
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.617 Test Loss: 1.536 Test Acc: 0.617
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 5.2386415004730225
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.620 Test Loss: 1.534 Test Acc: 0.620
Validation loss decreased (-0.619985 --> -0.619985).  Saving model ...
Epoch: 99 cost time: 5.504046440124512
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.620 Test Loss: 1.532 Test Acc: 0.620
Validation loss decreased (-0.619985 --> -0.619985).  Saving model ...
Epoch: 100 cost time: 5.381380558013916
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.617 Test Loss: 1.532 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.62
model parameter : 4348953
model size : 26.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.769515037536621
Epoch: 1, Steps: 18 | Train Loss: 3.260 Vali Loss: 3.197 Vali Acc: 0.070 Test Loss: 3.197 Test Acc: 0.070
Validation loss decreased (inf --> -0.069968).  Saving model ...
Epoch: 2 cost time: 5.262738227844238
Epoch: 2, Steps: 18 | Train Loss: 2.260 Vali Loss: 2.890 Vali Acc: 0.130 Test Loss: 2.890 Test Acc: 0.130
Validation loss decreased (-0.069968 --> -0.129971).  Saving model ...
Epoch: 3 cost time: 5.863170862197876
Epoch: 3, Steps: 18 | Train Loss: 1.089 Vali Loss: 2.825 Vali Acc: 0.170 Test Loss: 2.825 Test Acc: 0.170
Validation loss decreased (-0.129971 --> -0.169972).  Saving model ...
Epoch: 4 cost time: 5.663990259170532
Epoch: 4, Steps: 18 | Train Loss: 0.300 Vali Loss: 2.671 Vali Acc: 0.193 Test Loss: 2.671 Test Acc: 0.193
Validation loss decreased (-0.169972 --> -0.193307).  Saving model ...
Epoch: 5 cost time: 5.052278757095337
Epoch: 5, Steps: 18 | Train Loss: 0.070 Vali Loss: 2.708 Vali Acc: 0.213 Test Loss: 2.708 Test Acc: 0.213
Validation loss decreased (-0.193307 --> -0.213306).  Saving model ...
Epoch: 6 cost time: 5.469074487686157
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.456 Vali Acc: 0.263 Test Loss: 2.456 Test Acc: 0.263
Validation loss decreased (-0.213306 --> -0.263309).  Saving model ...
Epoch: 7 cost time: 5.544764280319214
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.403 Vali Acc: 0.290 Test Loss: 2.403 Test Acc: 0.290
Validation loss decreased (-0.263309 --> -0.289976).  Saving model ...
Epoch: 8 cost time: 5.687420845031738
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 2.367 Vali Acc: 0.290 Test Loss: 2.367 Test Acc: 0.290
Validation loss decreased (-0.289976 --> -0.289976).  Saving model ...
Epoch: 9 cost time: 5.553106307983398
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.312 Vali Acc: 0.297 Test Loss: 2.312 Test Acc: 0.297
Validation loss decreased (-0.289976 --> -0.296644).  Saving model ...
Epoch: 10 cost time: 5.56839656829834
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.253 Vali Acc: 0.323 Test Loss: 2.253 Test Acc: 0.323
Validation loss decreased (-0.296644 --> -0.323311).  Saving model ...
Epoch: 11 cost time: 5.749098777770996
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.197 Vali Acc: 0.330 Test Loss: 2.197 Test Acc: 0.330
Validation loss decreased (-0.323311 --> -0.329978).  Saving model ...
Epoch: 12 cost time: 5.464994668960571
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.168 Vali Acc: 0.340 Test Loss: 2.168 Test Acc: 0.340
Validation loss decreased (-0.329978 --> -0.339978).  Saving model ...
Epoch: 13 cost time: 6.0617005825042725
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.130 Vali Acc: 0.370 Test Loss: 2.130 Test Acc: 0.370
Validation loss decreased (-0.339978 --> -0.369979).  Saving model ...
Epoch: 14 cost time: 5.816089630126953
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.101 Vali Acc: 0.377 Test Loss: 2.101 Test Acc: 0.377
Validation loss decreased (-0.369979 --> -0.376646).  Saving model ...
Epoch: 15 cost time: 5.761893033981323
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.082 Vali Acc: 0.387 Test Loss: 2.082 Test Acc: 0.387
Validation loss decreased (-0.376646 --> -0.386646).  Saving model ...
Epoch: 16 cost time: 5.588430881500244
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.051 Vali Acc: 0.403 Test Loss: 2.051 Test Acc: 0.403
Validation loss decreased (-0.386646 --> -0.403313).  Saving model ...
Epoch: 17 cost time: 6.124166965484619
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.025 Vali Acc: 0.413 Test Loss: 2.025 Test Acc: 0.413
Validation loss decreased (-0.403313 --> -0.413313).  Saving model ...
Epoch: 18 cost time: 5.5145487785339355
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.993 Vali Acc: 0.433 Test Loss: 1.993 Test Acc: 0.433
Validation loss decreased (-0.413313 --> -0.433313).  Saving model ...
Epoch: 19 cost time: 5.7857842445373535
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.972 Vali Acc: 0.447 Test Loss: 1.972 Test Acc: 0.447
Validation loss decreased (-0.433313 --> -0.446647).  Saving model ...
Epoch: 20 cost time: 5.453685760498047
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.952 Vali Acc: 0.450 Test Loss: 1.952 Test Acc: 0.450
Validation loss decreased (-0.446647 --> -0.449980).  Saving model ...
Epoch: 21 cost time: 5.400305271148682
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.931 Vali Acc: 0.470 Test Loss: 1.931 Test Acc: 0.470
Validation loss decreased (-0.449980 --> -0.469981).  Saving model ...
Epoch: 22 cost time: 5.85267448425293
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.908 Vali Acc: 0.473 Test Loss: 1.908 Test Acc: 0.473
Validation loss decreased (-0.469981 --> -0.473314).  Saving model ...
Epoch: 23 cost time: 5.829183578491211
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.483 Test Loss: 1.886 Test Acc: 0.483
Validation loss decreased (-0.473314 --> -0.483314).  Saving model ...
Epoch: 24 cost time: 5.338941335678101
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.868 Vali Acc: 0.493 Test Loss: 1.868 Test Acc: 0.493
Validation loss decreased (-0.483314 --> -0.493315).  Saving model ...
Epoch: 25 cost time: 6.218556642532349
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.844 Vali Acc: 0.497 Test Loss: 1.844 Test Acc: 0.497
Validation loss decreased (-0.493315 --> -0.496648).  Saving model ...
Epoch: 26 cost time: 4.520483016967773
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.503 Test Loss: 1.827 Test Acc: 0.503
Validation loss decreased (-0.496648 --> -0.503315).  Saving model ...
Epoch: 27 cost time: 4.724074840545654
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.810 Vali Acc: 0.503 Test Loss: 1.810 Test Acc: 0.503
Validation loss decreased (-0.503315 --> -0.503315).  Saving model ...
Epoch: 28 cost time: 5.891847372055054
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.795 Vali Acc: 0.507 Test Loss: 1.795 Test Acc: 0.507
Validation loss decreased (-0.503315 --> -0.506649).  Saving model ...
Epoch: 29 cost time: 5.379873752593994
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.780 Vali Acc: 0.507 Test Loss: 1.780 Test Acc: 0.507
Validation loss decreased (-0.506649 --> -0.506649).  Saving model ...
Epoch: 30 cost time: 5.532039642333984
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.769 Vali Acc: 0.513 Test Loss: 1.769 Test Acc: 0.513
Validation loss decreased (-0.506649 --> -0.513316).  Saving model ...
Epoch: 31 cost time: 5.4842095375061035
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.537 Test Loss: 1.758 Test Acc: 0.537
Validation loss decreased (-0.513316 --> -0.536649).  Saving model ...
Epoch: 32 cost time: 6.048106670379639
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.748 Vali Acc: 0.533 Test Loss: 1.748 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.9320151805877686
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.737 Vali Acc: 0.547 Test Loss: 1.737 Test Acc: 0.547
Validation loss decreased (-0.536649 --> -0.546649).  Saving model ...
Epoch: 34 cost time: 5.935845136642456
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.740 Vali Acc: 0.533 Test Loss: 1.740 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.477490425109863
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.730 Vali Acc: 0.537 Test Loss: 1.730 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.882903099060059
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.719 Vali Acc: 0.550 Test Loss: 1.719 Test Acc: 0.550
Validation loss decreased (-0.546649 --> -0.549983).  Saving model ...
Epoch: 37 cost time: 5.380678415298462
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.709 Vali Acc: 0.557 Test Loss: 1.709 Test Acc: 0.557
Validation loss decreased (-0.549983 --> -0.556650).  Saving model ...
Epoch: 38 cost time: 5.3754448890686035
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.563 Test Loss: 1.700 Test Acc: 0.563
Validation loss decreased (-0.556650 --> -0.563316).  Saving model ...
Epoch: 39 cost time: 5.4657838344573975
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.703 Vali Acc: 0.560 Test Loss: 1.703 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.7762978076934814
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.560 Test Loss: 1.696 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 5.933948040008545
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.681 Vali Acc: 0.563 Test Loss: 1.681 Test Acc: 0.563
Validation loss decreased (-0.563316 --> -0.563317).  Saving model ...
Epoch: 42 cost time: 6.01872706413269
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.672 Vali Acc: 0.573 Test Loss: 1.672 Test Acc: 0.573
Validation loss decreased (-0.563317 --> -0.573317).  Saving model ...
Epoch: 43 cost time: 6.04232931137085
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.577 Test Loss: 1.669 Test Acc: 0.577
Validation loss decreased (-0.573317 --> -0.576650).  Saving model ...
Epoch: 44 cost time: 5.750925779342651
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.664 Vali Acc: 0.577 Test Loss: 1.664 Test Acc: 0.577
Validation loss decreased (-0.576650 --> -0.576650).  Saving model ...
Epoch: 45 cost time: 5.760122537612915
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.657 Vali Acc: 0.577 Test Loss: 1.657 Test Acc: 0.577
Validation loss decreased (-0.576650 --> -0.576650).  Saving model ...
Epoch: 46 cost time: 5.377049922943115
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.646 Vali Acc: 0.580 Test Loss: 1.646 Test Acc: 0.580
Validation loss decreased (-0.576650 --> -0.579984).  Saving model ...
Epoch: 47 cost time: 4.82168173789978
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.587 Test Loss: 1.643 Test Acc: 0.587
Validation loss decreased (-0.579984 --> -0.586650).  Saving model ...
Epoch: 48 cost time: 5.240323781967163
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.583 Test Loss: 1.637 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.915169954299927
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.635 Vali Acc: 0.583 Test Loss: 1.635 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 5.743255138397217
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.635 Vali Acc: 0.583 Test Loss: 1.635 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 5.775388956069946
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.590 Test Loss: 1.631 Test Acc: 0.590
Validation loss decreased (-0.586650 --> -0.589984).  Saving model ...
Epoch: 52 cost time: 6.110318422317505
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.590 Test Loss: 1.627 Test Acc: 0.590
Validation loss decreased (-0.589984 --> -0.589984).  Saving model ...
Epoch: 53 cost time: 5.640850782394409
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.622 Vali Acc: 0.590 Test Loss: 1.622 Test Acc: 0.590
Validation loss decreased (-0.589984 --> -0.589984).  Saving model ...
Epoch: 54 cost time: 5.718906402587891
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.593 Test Loss: 1.619 Test Acc: 0.593
Validation loss decreased (-0.589984 --> -0.593317).  Saving model ...
Epoch: 55 cost time: 5.700963258743286
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.613 Vali Acc: 0.593 Test Loss: 1.613 Test Acc: 0.593
Validation loss decreased (-0.593317 --> -0.593317).  Saving model ...
Epoch: 56 cost time: 6.255993127822876
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.590 Test Loss: 1.607 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.659842491149902
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.590 Test Loss: 1.602 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 5.7627809047698975
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.595 Vali Acc: 0.600 Test Loss: 1.595 Test Acc: 0.600
Validation loss decreased (-0.593317 --> -0.599984).  Saving model ...
Epoch: 59 cost time: 5.748344421386719
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.600 Test Loss: 1.591 Test Acc: 0.600
Validation loss decreased (-0.599984 --> -0.599984).  Saving model ...
Epoch: 60 cost time: 4.674752235412598
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.603 Test Loss: 1.586 Test Acc: 0.603
Validation loss decreased (-0.599984 --> -0.603317).  Saving model ...
Epoch: 61 cost time: 5.791488409042358
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.607 Test Loss: 1.582 Test Acc: 0.607
Validation loss decreased (-0.603317 --> -0.606651).  Saving model ...
Epoch: 62 cost time: 5.264191389083862
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.613 Test Loss: 1.579 Test Acc: 0.613
Validation loss decreased (-0.606651 --> -0.613318).  Saving model ...
Epoch: 63 cost time: 5.369534969329834
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.613 Test Loss: 1.575 Test Acc: 0.613
Validation loss decreased (-0.613318 --> -0.613318).  Saving model ...
Epoch: 64 cost time: 5.636718511581421
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.571 Vali Acc: 0.610 Test Loss: 1.571 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 5.607167482376099
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.613 Test Loss: 1.569 Test Acc: 0.613
Validation loss decreased (-0.613318 --> -0.613318).  Saving model ...
Epoch: 66 cost time: 5.904557704925537
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.613 Test Loss: 1.566 Test Acc: 0.613
Validation loss decreased (-0.613318 --> -0.613318).  Saving model ...
Epoch: 67 cost time: 5.647964239120483
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.564 Vali Acc: 0.617 Test Loss: 1.564 Test Acc: 0.617
Validation loss decreased (-0.613318 --> -0.616651).  Saving model ...
Epoch: 68 cost time: 5.533034801483154
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.617 Test Loss: 1.562 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616651).  Saving model ...
Epoch: 69 cost time: 5.560201406478882
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.617 Test Loss: 1.561 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616651).  Saving model ...
Epoch: 70 cost time: 5.702352523803711
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.617 Test Loss: 1.559 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616651).  Saving model ...
Epoch: 71 cost time: 5.803097486495972
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.620 Test Loss: 1.556 Test Acc: 0.620
Validation loss decreased (-0.616651 --> -0.619984).  Saving model ...
Epoch: 72 cost time: 5.743512868881226
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.555 Vali Acc: 0.620 Test Loss: 1.555 Test Acc: 0.620
Validation loss decreased (-0.619984 --> -0.619984).  Saving model ...
Epoch: 73 cost time: 5.851605176925659
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.623 Test Loss: 1.556 Test Acc: 0.623
Validation loss decreased (-0.619984 --> -0.623318).  Saving model ...
Epoch: 74 cost time: 5.762902736663818
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.555 Vali Acc: 0.623 Test Loss: 1.555 Test Acc: 0.623
Validation loss decreased (-0.623318 --> -0.623318).  Saving model ...
Epoch: 75 cost time: 5.6221747398376465
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.620 Test Loss: 1.553 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 5.320829629898071
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.620 Test Loss: 1.549 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 5.488951921463013
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.545 Vali Acc: 0.623 Test Loss: 1.545 Test Acc: 0.623
Validation loss decreased (-0.623318 --> -0.623318).  Saving model ...
Epoch: 78 cost time: 5.88801383972168
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.544 Vali Acc: 0.623 Test Loss: 1.544 Test Acc: 0.623
Validation loss decreased (-0.623318 --> -0.623318).  Saving model ...
Epoch: 79 cost time: 5.958611965179443
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.620 Test Loss: 1.541 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 5.5464019775390625
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.623 Test Loss: 1.538 Test Acc: 0.623
Validation loss decreased (-0.623318 --> -0.623318).  Saving model ...
Epoch: 81 cost time: 5.812436103820801
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.627 Test Loss: 1.536 Test Acc: 0.627
Validation loss decreased (-0.623318 --> -0.626651).  Saving model ...
Epoch: 82 cost time: 6.32229471206665
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.623 Test Loss: 1.534 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 5.901067018508911
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.630 Test Loss: 1.532 Test Acc: 0.630
Validation loss decreased (-0.626651 --> -0.629985).  Saving model ...
Epoch: 84 cost time: 6.008677005767822
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.637 Test Loss: 1.530 Test Acc: 0.637
Validation loss decreased (-0.629985 --> -0.636651).  Saving model ...
Epoch: 85 cost time: 5.840151071548462
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.637 Test Loss: 1.530 Test Acc: 0.637
Validation loss decreased (-0.636651 --> -0.636651).  Saving model ...
Epoch: 86 cost time: 4.965454339981079
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.633 Test Loss: 1.528 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 5.056201219558716
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.640 Test Loss: 1.526 Test Acc: 0.640
Validation loss decreased (-0.636651 --> -0.639985).  Saving model ...
Epoch: 88 cost time: 4.817052602767944
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.637 Test Loss: 1.525 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 5.246474981307983
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.643 Test Loss: 1.526 Test Acc: 0.643
Validation loss decreased (-0.639985 --> -0.643318).  Saving model ...
Epoch: 90 cost time: 5.584165096282959
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.643 Test Loss: 1.524 Test Acc: 0.643
Validation loss decreased (-0.643318 --> -0.643318).  Saving model ...
Epoch: 91 cost time: 5.982114791870117
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.640 Test Loss: 1.525 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 5.6812450885772705
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.643 Test Loss: 1.525 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 5.709279537200928
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.643 Test Loss: 1.523 Test Acc: 0.643
Validation loss decreased (-0.643318 --> -0.643318).  Saving model ...
Epoch: 94 cost time: 5.4411420822143555
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.647 Test Loss: 1.523 Test Acc: 0.647
Validation loss decreased (-0.643318 --> -0.646651).  Saving model ...
Epoch: 95 cost time: 5.537118673324585
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.647 Test Loss: 1.524 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 5.731461763381958
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.653 Test Loss: 1.521 Test Acc: 0.653
Validation loss decreased (-0.646651 --> -0.653318).  Saving model ...
Epoch: 97 cost time: 4.6435370445251465
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.650 Test Loss: 1.519 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 5.401439666748047
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.518 Vali Acc: 0.647 Test Loss: 1.518 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 5.44835352897644
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.650 Test Loss: 1.517 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 5.52363133430481
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.650 Test Loss: 1.517 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6533333333333333
model parameter : 4348953
model size : 26.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.6851277351379395
Epoch: 1, Steps: 18 | Train Loss: 3.211 Vali Loss: 3.181 Vali Acc: 0.100 Test Loss: 3.181 Test Acc: 0.100
Validation loss decreased (inf --> -0.099968).  Saving model ...
Epoch: 2 cost time: 5.24736213684082
Epoch: 2, Steps: 18 | Train Loss: 2.384 Vali Loss: 2.870 Vali Acc: 0.173 Test Loss: 2.870 Test Acc: 0.173
Validation loss decreased (-0.099968 --> -0.173305).  Saving model ...
Epoch: 3 cost time: 5.356094837188721
Epoch: 3, Steps: 18 | Train Loss: 1.275 Vali Loss: 2.756 Vali Acc: 0.190 Test Loss: 2.756 Test Acc: 0.190
Validation loss decreased (-0.173305 --> -0.189972).  Saving model ...
Epoch: 4 cost time: 5.325281858444214
Epoch: 4, Steps: 18 | Train Loss: 0.434 Vali Loss: 2.472 Vali Acc: 0.250 Test Loss: 2.472 Test Acc: 0.250
Validation loss decreased (-0.189972 --> -0.249975).  Saving model ...
Epoch: 5 cost time: 5.491049766540527
Epoch: 5, Steps: 18 | Train Loss: 0.110 Vali Loss: 2.505 Vali Acc: 0.250 Test Loss: 2.505 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.31119441986084
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 2.118 Vali Acc: 0.373 Test Loss: 2.118 Test Acc: 0.373
Validation loss decreased (-0.249975 --> -0.373312).  Saving model ...
Epoch: 7 cost time: 5.651901483535767
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.080 Vali Acc: 0.383 Test Loss: 2.080 Test Acc: 0.383
Validation loss decreased (-0.373312 --> -0.383313).  Saving model ...
Epoch: 8 cost time: 5.379338026046753
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.970 Vali Acc: 0.413 Test Loss: 1.970 Test Acc: 0.413
Validation loss decreased (-0.383313 --> -0.413314).  Saving model ...
Epoch: 9 cost time: 4.840102910995483
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.916 Vali Acc: 0.443 Test Loss: 1.916 Test Acc: 0.443
Validation loss decreased (-0.413314 --> -0.443314).  Saving model ...
Epoch: 10 cost time: 4.963603734970093
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.851 Vali Acc: 0.457 Test Loss: 1.851 Test Acc: 0.457
Validation loss decreased (-0.443314 --> -0.456648).  Saving model ...
Epoch: 11 cost time: 5.185649633407593
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.803 Vali Acc: 0.473 Test Loss: 1.803 Test Acc: 0.473
Validation loss decreased (-0.456648 --> -0.473315).  Saving model ...
Epoch: 12 cost time: 5.2293713092803955
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.760 Vali Acc: 0.480 Test Loss: 1.760 Test Acc: 0.480
Validation loss decreased (-0.473315 --> -0.479982).  Saving model ...
Epoch: 13 cost time: 5.019945383071899
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.718 Vali Acc: 0.493 Test Loss: 1.718 Test Acc: 0.493
Validation loss decreased (-0.479982 --> -0.493316).  Saving model ...
Epoch: 14 cost time: 5.325190305709839
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.696 Vali Acc: 0.510 Test Loss: 1.696 Test Acc: 0.510
Validation loss decreased (-0.493316 --> -0.509983).  Saving model ...
Epoch: 15 cost time: 5.3636794090271
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.702 Vali Acc: 0.507 Test Loss: 1.702 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.202754259109497
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.672 Vali Acc: 0.527 Test Loss: 1.672 Test Acc: 0.527
Validation loss decreased (-0.509983 --> -0.526650).  Saving model ...
Epoch: 17 cost time: 5.397291898727417
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.644 Vali Acc: 0.527 Test Loss: 1.644 Test Acc: 0.527
Validation loss decreased (-0.526650 --> -0.526650).  Saving model ...
Epoch: 18 cost time: 5.513289451599121
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.622 Vali Acc: 0.530 Test Loss: 1.622 Test Acc: 0.530
Validation loss decreased (-0.526650 --> -0.529984).  Saving model ...
Epoch: 19 cost time: 5.34182333946228
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.599 Vali Acc: 0.533 Test Loss: 1.599 Test Acc: 0.533
Validation loss decreased (-0.529984 --> -0.533317).  Saving model ...
Epoch: 20 cost time: 5.321102619171143
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.550 Test Loss: 1.576 Test Acc: 0.550
Validation loss decreased (-0.533317 --> -0.549984).  Saving model ...
Epoch: 21 cost time: 5.348530054092407
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.567 Vali Acc: 0.553 Test Loss: 1.567 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553318).  Saving model ...
Epoch: 22 cost time: 4.903564691543579
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.573 Test Loss: 1.541 Test Acc: 0.573
Validation loss decreased (-0.553318 --> -0.573318).  Saving model ...
Epoch: 23 cost time: 5.303715705871582
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.570 Test Loss: 1.517 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.302655458450317
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.587 Test Loss: 1.493 Test Acc: 0.587
Validation loss decreased (-0.573318 --> -0.586652).  Saving model ...
Epoch: 25 cost time: 5.379729509353638
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.590 Test Loss: 1.467 Test Acc: 0.590
Validation loss decreased (-0.586652 --> -0.589985).  Saving model ...
Epoch: 26 cost time: 5.545423269271851
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.603 Test Loss: 1.444 Test Acc: 0.603
Validation loss decreased (-0.589985 --> -0.603319).  Saving model ...
Epoch: 27 cost time: 5.4261345863342285
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.603 Test Loss: 1.440 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 28 cost time: 5.51508092880249
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.603 Test Loss: 1.435 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 29 cost time: 4.566329717636108
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.603 Test Loss: 1.423 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 30 cost time: 5.052165985107422
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.617 Test Loss: 1.411 Test Acc: 0.617
Validation loss decreased (-0.603319 --> -0.616653).  Saving model ...
Epoch: 31 cost time: 4.91979193687439
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.620 Test Loss: 1.403 Test Acc: 0.620
Validation loss decreased (-0.616653 --> -0.619986).  Saving model ...
Epoch: 32 cost time: 4.959182262420654
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.623 Test Loss: 1.405 Test Acc: 0.623
Validation loss decreased (-0.619986 --> -0.623319).  Saving model ...
Epoch: 33 cost time: 5.331587076187134
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.620 Test Loss: 1.392 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.512171506881714
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.627 Test Loss: 1.389 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626653).  Saving model ...
Epoch: 35 cost time: 5.728261232376099
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.627 Test Loss: 1.384 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 36 cost time: 5.465713262557983
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.627 Test Loss: 1.376 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 37 cost time: 5.756468057632446
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.630 Test Loss: 1.367 Test Acc: 0.630
Validation loss decreased (-0.626653 --> -0.629986).  Saving model ...
Epoch: 38 cost time: 4.845463275909424
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.362 Vali Acc: 0.633 Test Loss: 1.362 Test Acc: 0.633
Validation loss decreased (-0.629986 --> -0.633320).  Saving model ...
Epoch: 39 cost time: 4.7563393115997314
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.640 Test Loss: 1.369 Test Acc: 0.640
Validation loss decreased (-0.633320 --> -0.639986).  Saving model ...
Epoch: 40 cost time: 4.47285532951355
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.637 Test Loss: 1.364 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.9818642139434814
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.637 Test Loss: 1.355 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.6246867179870605
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.640 Test Loss: 1.348 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639987).  Saving model ...
Epoch: 43 cost time: 4.480762243270874
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.637 Test Loss: 1.344 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 5.332544326782227
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.647 Test Loss: 1.346 Test Acc: 0.647
Validation loss decreased (-0.639987 --> -0.646653).  Saving model ...
Epoch: 45 cost time: 5.670332670211792
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.647 Test Loss: 1.339 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 46 cost time: 5.6361985206604
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.657 Test Loss: 1.333 Test Acc: 0.657
Validation loss decreased (-0.646653 --> -0.656653).  Saving model ...
Epoch: 47 cost time: 5.259246587753296
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.660 Test Loss: 1.335 Test Acc: 0.660
Validation loss decreased (-0.656653 --> -0.659987).  Saving model ...
Epoch: 48 cost time: 5.452141523361206
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.331 Vali Acc: 0.647 Test Loss: 1.331 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.233059883117676
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.653 Test Loss: 1.329 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 5.3501152992248535
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.325 Vali Acc: 0.650 Test Loss: 1.325 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 5.170154333114624
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.653 Test Loss: 1.318 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 4.491715908050537
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.653 Test Loss: 1.314 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 5.480132579803467
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.650 Test Loss: 1.314 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 5.3641746044158936
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.660 Test Loss: 1.314 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
Epoch: 55 cost time: 5.4777679443359375
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.310 Vali Acc: 0.663 Test Loss: 1.310 Test Acc: 0.663
Validation loss decreased (-0.659987 --> -0.663320).  Saving model ...
Epoch: 56 cost time: 5.261904001235962
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.304 Vali Acc: 0.677 Test Loss: 1.304 Test Acc: 0.677
Validation loss decreased (-0.663320 --> -0.676654).  Saving model ...
Epoch: 57 cost time: 5.453470945358276
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.304 Vali Acc: 0.673 Test Loss: 1.304 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 5.471703290939331
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.300 Vali Acc: 0.673 Test Loss: 1.300 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 5.4655797481536865
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.673 Test Loss: 1.295 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 5.667382717132568
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.293 Vali Acc: 0.677 Test Loss: 1.293 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 61 cost time: 5.540439605712891
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.291 Vali Acc: 0.677 Test Loss: 1.291 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 62 cost time: 5.985538005828857
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.680 Test Loss: 1.292 Test Acc: 0.680
Validation loss decreased (-0.676654 --> -0.679987).  Saving model ...
Epoch: 63 cost time: 5.972650766372681
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.291 Vali Acc: 0.680 Test Loss: 1.291 Test Acc: 0.680
Validation loss decreased (-0.679987 --> -0.679987).  Saving model ...
Epoch: 64 cost time: 5.690370321273804
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.289 Vali Acc: 0.680 Test Loss: 1.289 Test Acc: 0.680
Validation loss decreased (-0.679987 --> -0.679987).  Saving model ...
Epoch: 65 cost time: 5.323821544647217
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.680 Test Loss: 1.285 Test Acc: 0.680
Validation loss decreased (-0.679987 --> -0.679987).  Saving model ...
Epoch: 66 cost time: 5.955180883407593
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.283 Vali Acc: 0.680 Test Loss: 1.283 Test Acc: 0.680
Validation loss decreased (-0.679987 --> -0.679987).  Saving model ...
Epoch: 67 cost time: 5.827733278274536
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.680 Test Loss: 1.281 Test Acc: 0.680
Validation loss decreased (-0.679987 --> -0.679987).  Saving model ...
Epoch: 68 cost time: 6.027955055236816
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.278 Vali Acc: 0.683 Test Loss: 1.278 Test Acc: 0.683
Validation loss decreased (-0.679987 --> -0.683321).  Saving model ...
Epoch: 69 cost time: 5.797198057174683
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.680 Test Loss: 1.275 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 5.848344802856445
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.683 Test Loss: 1.276 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 71 cost time: 5.8110597133636475
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.680 Test Loss: 1.274 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.964410305023193
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.680 Test Loss: 1.275 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 5.681365251541138
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.677 Test Loss: 1.274 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 5.6821088790893555
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.677 Test Loss: 1.274 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 5.946617603302002
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.680 Test Loss: 1.273 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 5.602295637130737
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.270 Vali Acc: 0.683 Test Loss: 1.270 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 77 cost time: 5.695662498474121
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.680 Test Loss: 1.266 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.848945617675781
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.680 Test Loss: 1.265 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 5.507623910903931
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.683 Test Loss: 1.264 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 80 cost time: 6.051966428756714
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.683 Test Loss: 1.263 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 81 cost time: 5.058250188827515
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.261 Vali Acc: 0.683 Test Loss: 1.261 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 82 cost time: 5.435760974884033
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.683 Test Loss: 1.262 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 5.270115613937378
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.683 Test Loss: 1.263 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 5.515915632247925
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.683 Test Loss: 1.264 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 5.681941986083984
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.690 Test Loss: 1.264 Test Acc: 0.690
Validation loss decreased (-0.683321 --> -0.689987).  Saving model ...
Epoch: 86 cost time: 5.7609169483184814
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.261 Vali Acc: 0.690 Test Loss: 1.261 Test Acc: 0.690
Validation loss decreased (-0.689987 --> -0.689987).  Saving model ...
Epoch: 87 cost time: 5.864481449127197
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.261 Vali Acc: 0.687 Test Loss: 1.261 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 6.205061674118042
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.683 Test Loss: 1.260 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 5.3306334018707275
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.687 Test Loss: 1.262 Test Acc: 0.687
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 5.743530511856079
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.687 Test Loss: 1.260 Test Acc: 0.687
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 5.328128814697266
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.687 Test Loss: 1.260 Test Acc: 0.687
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 4.948283910751343
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.683 Test Loss: 1.266 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 5.333943605422974
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.683 Test Loss: 1.267 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 5.646389007568359
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.683 Test Loss: 1.266 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 5.796079635620117
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.687 Test Loss: 1.263 Test Acc: 0.687
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 6.053115606307983
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.690 Test Loss: 1.262 Test Acc: 0.690
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.69
model parameter : 4348953
model size : 26.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.9843833446502686
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.140 Vali Acc: 0.083 Test Loss: 3.140 Test Acc: 0.083
Validation loss decreased (inf --> -0.083302).  Saving model ...
Epoch: 2 cost time: 5.3372416496276855
Epoch: 2, Steps: 18 | Train Loss: 2.449 Vali Loss: 2.876 Vali Acc: 0.160 Test Loss: 2.876 Test Acc: 0.160
Validation loss decreased (-0.083302 --> -0.159971).  Saving model ...
Epoch: 3 cost time: 5.30153751373291
Epoch: 3, Steps: 18 | Train Loss: 1.344 Vali Loss: 2.715 Vali Acc: 0.183 Test Loss: 2.715 Test Acc: 0.183
Validation loss decreased (-0.159971 --> -0.183306).  Saving model ...
Epoch: 4 cost time: 4.739186763763428
Epoch: 4, Steps: 18 | Train Loss: 0.466 Vali Loss: 2.423 Vali Acc: 0.287 Test Loss: 2.423 Test Acc: 0.287
Validation loss decreased (-0.183306 --> -0.286642).  Saving model ...
Epoch: 5 cost time: 4.627984285354614
Epoch: 5, Steps: 18 | Train Loss: 0.123 Vali Loss: 2.336 Vali Acc: 0.277 Test Loss: 2.336 Test Acc: 0.277
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.453399181365967
Epoch: 6, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.969 Vali Acc: 0.367 Test Loss: 1.969 Test Acc: 0.367
Validation loss decreased (-0.286642 --> -0.366647).  Saving model ...
Epoch: 7 cost time: 5.551012277603149
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.968 Vali Acc: 0.360 Test Loss: 1.968 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.942397594451904
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.811 Vali Acc: 0.430 Test Loss: 1.811 Test Acc: 0.430
Validation loss decreased (-0.366647 --> -0.429982).  Saving model ...
Epoch: 9 cost time: 5.3585381507873535
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.751 Vali Acc: 0.467 Test Loss: 1.751 Test Acc: 0.467
Validation loss decreased (-0.429982 --> -0.466649).  Saving model ...
Epoch: 10 cost time: 5.195852041244507
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.674 Vali Acc: 0.480 Test Loss: 1.674 Test Acc: 0.480
Validation loss decreased (-0.466649 --> -0.479983).  Saving model ...
Epoch: 11 cost time: 5.5960304737091064
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.636 Vali Acc: 0.507 Test Loss: 1.636 Test Acc: 0.507
Validation loss decreased (-0.479983 --> -0.506650).  Saving model ...
Epoch: 12 cost time: 5.4797117710113525
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.624 Vali Acc: 0.493 Test Loss: 1.624 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.200711250305176
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.566 Vali Acc: 0.523 Test Loss: 1.566 Test Acc: 0.523
Validation loss decreased (-0.506650 --> -0.523318).  Saving model ...
Epoch: 14 cost time: 5.958184719085693
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.556 Vali Acc: 0.533 Test Loss: 1.556 Test Acc: 0.533
Validation loss decreased (-0.523318 --> -0.533318).  Saving model ...
Epoch: 15 cost time: 5.577555418014526
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.533 Test Loss: 1.551 Test Acc: 0.533
Validation loss decreased (-0.533318 --> -0.533318).  Saving model ...
Epoch: 16 cost time: 5.469881057739258
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.523 Vali Acc: 0.553 Test Loss: 1.523 Test Acc: 0.553
Validation loss decreased (-0.533318 --> -0.553318).  Saving model ...
Epoch: 17 cost time: 5.273468732833862
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.501 Vali Acc: 0.573 Test Loss: 1.501 Test Acc: 0.573
Validation loss decreased (-0.553318 --> -0.573318).  Saving model ...
Epoch: 18 cost time: 5.708942890167236
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.484 Vali Acc: 0.583 Test Loss: 1.484 Test Acc: 0.583
Validation loss decreased (-0.573318 --> -0.583318).  Saving model ...
Epoch: 19 cost time: 4.678907155990601
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.471 Vali Acc: 0.583 Test Loss: 1.471 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583319).  Saving model ...
Epoch: 20 cost time: 5.169553518295288
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.454 Vali Acc: 0.593 Test Loss: 1.454 Test Acc: 0.593
Validation loss decreased (-0.583319 --> -0.593319).  Saving model ...
Epoch: 21 cost time: 5.470182418823242
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.439 Vali Acc: 0.607 Test Loss: 1.439 Test Acc: 0.607
Validation loss decreased (-0.593319 --> -0.606652).  Saving model ...
Epoch: 22 cost time: 6.0020763874053955
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.421 Vali Acc: 0.607 Test Loss: 1.421 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 23 cost time: 5.850638151168823
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.603 Test Loss: 1.405 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.78427791595459
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.603 Test Loss: 1.388 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.377631902694702
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.610 Test Loss: 1.367 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 26 cost time: 5.692556142807007
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.620 Test Loss: 1.352 Test Acc: 0.620
Validation loss decreased (-0.609986 --> -0.619986).  Saving model ...
Epoch: 27 cost time: 5.251890182495117
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.627 Test Loss: 1.345 Test Acc: 0.627
Validation loss decreased (-0.619986 --> -0.626653).  Saving model ...
Epoch: 28 cost time: 5.116157293319702
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.627 Test Loss: 1.338 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 29 cost time: 5.495575428009033
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.330 Vali Acc: 0.630 Test Loss: 1.330 Test Acc: 0.630
Validation loss decreased (-0.626653 --> -0.629987).  Saving model ...
Epoch: 30 cost time: 5.599930286407471
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.633 Test Loss: 1.324 Test Acc: 0.633
Validation loss decreased (-0.629987 --> -0.633320).  Saving model ...
Epoch: 31 cost time: 4.959593296051025
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.637 Test Loss: 1.317 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.636654).  Saving model ...
Epoch: 32 cost time: 5.324588298797607
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.311 Vali Acc: 0.633 Test Loss: 1.311 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.823820114135742
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.300 Vali Acc: 0.633 Test Loss: 1.300 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.70880913734436
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.301 Vali Acc: 0.643 Test Loss: 1.301 Test Acc: 0.643
Validation loss decreased (-0.636654 --> -0.643320).  Saving model ...
Epoch: 35 cost time: 5.822225332260132
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.300 Vali Acc: 0.637 Test Loss: 1.300 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.801922559738159
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.291 Vali Acc: 0.637 Test Loss: 1.291 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 5.644364833831787
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.286 Vali Acc: 0.637 Test Loss: 1.286 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 5.439976930618286
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.282 Vali Acc: 0.643 Test Loss: 1.282 Test Acc: 0.643
Validation loss decreased (-0.643320 --> -0.643321).  Saving model ...
Epoch: 39 cost time: 5.438709497451782
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.287 Vali Acc: 0.643 Test Loss: 1.287 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.627865314483643
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.653 Test Loss: 1.281 Test Acc: 0.653
Validation loss decreased (-0.643321 --> -0.653321).  Saving model ...
Epoch: 41 cost time: 5.632226943969727
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.663 Test Loss: 1.265 Test Acc: 0.663
Validation loss decreased (-0.653321 --> -0.663321).  Saving model ...
Epoch: 42 cost time: 5.442327260971069
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.663 Test Loss: 1.257 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 43 cost time: 5.45257043838501
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.663 Test Loss: 1.254 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 44 cost time: 5.477094650268555
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.657 Test Loss: 1.256 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 4.854922294616699
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.667 Test Loss: 1.252 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666654).  Saving model ...
Epoch: 46 cost time: 5.24211311340332
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.667 Test Loss: 1.247 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 47 cost time: 5.435763597488403
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.249 Vali Acc: 0.663 Test Loss: 1.249 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.6923136711120605
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.663 Test Loss: 1.246 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 5.454979419708252
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.244 Vali Acc: 0.663 Test Loss: 1.244 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 5.3853371143341064
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.660 Test Loss: 1.241 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 5.502264022827148
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.237 Vali Acc: 0.673 Test Loss: 1.237 Test Acc: 0.673
Validation loss decreased (-0.666654 --> -0.673321).  Saving model ...
Epoch: 52 cost time: 5.373018026351929
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.680 Test Loss: 1.233 Test Acc: 0.680
Validation loss decreased (-0.673321 --> -0.679988).  Saving model ...
Epoch: 53 cost time: 5.4753265380859375
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.677 Test Loss: 1.231 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.199821949005127
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.683 Test Loss: 1.230 Test Acc: 0.683
Validation loss decreased (-0.679988 --> -0.683321).  Saving model ...
Epoch: 55 cost time: 5.195811986923218
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.683 Test Loss: 1.226 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 56 cost time: 4.8174214363098145
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.690 Test Loss: 1.223 Test Acc: 0.690
Validation loss decreased (-0.683321 --> -0.689988).  Saving model ...
Epoch: 57 cost time: 4.6089513301849365
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.690 Test Loss: 1.223 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 4.495724201202393
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.677 Test Loss: 1.225 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 5.375324964523315
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.690 Test Loss: 1.222 Test Acc: 0.690
Validation loss decreased (-0.689988 --> -0.689988).  Saving model ...
Epoch: 60 cost time: 5.520882606506348
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.687 Test Loss: 1.218 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 5.543512582778931
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.683 Test Loss: 1.215 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 5.665181875228882
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.683 Test Loss: 1.215 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 5.407292127609253
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.683 Test Loss: 1.212 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 5.168283939361572
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.687 Test Loss: 1.211 Test Acc: 0.687
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 4.734928369522095
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.690 Test Loss: 1.209 Test Acc: 0.690
Validation loss decreased (-0.689988 --> -0.689988).  Saving model ...
Epoch: 66 cost time: 4.971506118774414
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.687 Test Loss: 1.208 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 4.664877891540527
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.687 Test Loss: 1.207 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 5.047932386398315
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.693 Test Loss: 1.206 Test Acc: 0.693
Validation loss decreased (-0.689988 --> -0.693321).  Saving model ...
Epoch: 69 cost time: 4.990710258483887
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.693 Test Loss: 1.205 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 70 cost time: 5.40254545211792
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.697 Test Loss: 1.206 Test Acc: 0.697
Validation loss decreased (-0.693321 --> -0.696655).  Saving model ...
Epoch: 71 cost time: 5.451033115386963
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.697 Test Loss: 1.205 Test Acc: 0.697
Validation loss decreased (-0.696655 --> -0.696655).  Saving model ...
Epoch: 72 cost time: 5.517390966415405
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.690 Test Loss: 1.207 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 5.19377875328064
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.690 Test Loss: 1.207 Test Acc: 0.690
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 5.406809568405151
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.697 Test Loss: 1.205 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 5.401078939437866
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.697 Test Loss: 1.204 Test Acc: 0.697
Validation loss decreased (-0.696655 --> -0.696655).  Saving model ...
Epoch: 76 cost time: 5.389090299606323
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.700 Test Loss: 1.201 Test Acc: 0.700
Validation loss decreased (-0.696655 --> -0.699988).  Saving model ...
Epoch: 77 cost time: 5.62526798248291
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.700 Test Loss: 1.198 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 78 cost time: 5.4037697315216064
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.700 Test Loss: 1.199 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 5.456334114074707
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.200 Vali Acc: 0.700 Test Loss: 1.200 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 5.396334886550903
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.697 Test Loss: 1.203 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 5.621455907821655
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.697 Test Loss: 1.202 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 5.759075403213501
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.697 Test Loss: 1.199 Test Acc: 0.697
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 5.069329738616943
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.697 Test Loss: 1.198 Test Acc: 0.697
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 5.485402584075928
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.196 Vali Acc: 0.703 Test Loss: 1.196 Test Acc: 0.703
Validation loss decreased (-0.699988 --> -0.703321).  Saving model ...
Epoch: 85 cost time: 5.55641508102417
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.196 Vali Acc: 0.703 Test Loss: 1.196 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 86 cost time: 5.7414984703063965
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.703 Test Loss: 1.193 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 87 cost time: 5.73194146156311
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.707 Test Loss: 1.194 Test Acc: 0.707
Validation loss decreased (-0.703321 --> -0.706655).  Saving model ...
Epoch: 88 cost time: 6.04336142539978
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.707 Test Loss: 1.193 Test Acc: 0.707
Validation loss decreased (-0.706655 --> -0.706655).  Saving model ...
Epoch: 89 cost time: 5.516029357910156
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.703 Test Loss: 1.195 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 5.408794164657593
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.703 Test Loss: 1.193 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 5.0667970180511475
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.700 Test Loss: 1.192 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 5.228894233703613
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.700 Test Loss: 1.195 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 4.598891019821167
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.700 Test Loss: 1.195 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 4.496928453445435
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.697 Test Loss: 1.193 Test Acc: 0.697
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 5.1836676597595215
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.700 Test Loss: 1.193 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 5.310168266296387
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.697 Test Loss: 1.193 Test Acc: 0.697
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 5.726875066757202
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.700 Test Loss: 1.192 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 5.8803675174713135
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.191 Vali Acc: 0.703 Test Loss: 1.191 Test Acc: 0.703
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7066666666666667
model parameter : 4348953
model size : 26.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.810479164123535
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 5.499765872955322
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.23118782043457
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.325371503829956
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.495693206787109
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 6 cost time: 5.5373663902282715
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 7 cost time: 5.826772689819336
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.910409927368164
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.867356777191162
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.713913679122925
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.751634836196899
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.641583681106567
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.480314016342163
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.2117578983306885
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.0308520793914795
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.78382134437561
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 4348953
model size : 26.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.553483486175537
Epoch: 1, Steps: 18 | Train Loss: 2.923 Vali Loss: 1.645 Vali Acc: 0.757 Test Loss: 1.645 Test Acc: 0.757
Validation loss decreased (inf --> -0.756650).  Saving model ...
Epoch: 2 cost time: 5.417123794555664
Epoch: 2, Steps: 18 | Train Loss: 0.782 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
Validation loss decreased (-0.756650 --> -0.866661).  Saving model ...
Epoch: 3 cost time: 5.209062814712524
Epoch: 3, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.904349088668823
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.435 Vali Acc: 0.870 Test Loss: 0.435 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.869996).  Saving model ...
Epoch: 5 cost time: 4.697844505310059
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.399 Vali Acc: 0.897 Test Loss: 0.399 Test Acc: 0.897
Validation loss decreased (-0.869996 --> -0.896663).  Saving model ...
Epoch: 6 cost time: 4.633092880249023
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.394 Vali Acc: 0.893 Test Loss: 0.394 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.016561985015869
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.388 Vali Acc: 0.893 Test Loss: 0.388 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.484173536300659
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.383 Vali Acc: 0.897 Test Loss: 0.383 Test Acc: 0.897
Validation loss decreased (-0.896663 --> -0.896663).  Saving model ...
Epoch: 9 cost time: 5.267263650894165
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.893 Test Loss: 0.378 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.33601450920105
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.893 Test Loss: 0.377 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.410285234451294
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
Validation loss decreased (-0.896663 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 5.463982343673706
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 5.221516132354736
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 5.39197039604187
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 15 cost time: 5.454540967941284
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.365 Vali Acc: 0.897 Test Loss: 0.365 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.585331201553345
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.363 Vali Acc: 0.897 Test Loss: 0.363 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.399507284164429
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.897 Test Loss: 0.366 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.081024169921875
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.367 Vali Acc: 0.897 Test Loss: 0.367 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.435267210006714
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
Validation loss decreased (-0.899996 --> -0.903330).  Saving model ...
Epoch: 20 cost time: 4.583197593688965
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.026365518569946
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.370 Vali Acc: 0.903 Test Loss: 0.370 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.717223167419434
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.1065428256988525
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.40854811668396
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.254099369049072
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.787257194519043
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.03634238243103
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.903 Test Loss: 0.366 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 28 cost time: 5.688067674636841
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.344435214996338
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.897 Test Loss: 0.368 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.892586708068848
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.367 Vali Acc: 0.897 Test Loss: 0.367 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.052964210510254
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.652088642120361
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.724376201629639
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.436892986297607
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 5.8028435707092285
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 5.788586378097534
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 5.217814207077026
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9033333333333333
model parameter : 3955737
model size : 24.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.827812194824219
Epoch: 1, Steps: 18 | Train Loss: 3.042 Vali Loss: 2.003 Vali Acc: 0.683 Test Loss: 2.003 Test Acc: 0.683
Validation loss decreased (inf --> -0.683313).  Saving model ...
Epoch: 2 cost time: 5.368744611740112
Epoch: 2, Steps: 18 | Train Loss: 1.052 Vali Loss: 0.848 Vali Acc: 0.813 Test Loss: 0.848 Test Acc: 0.813
Validation loss decreased (-0.683313 --> -0.813325).  Saving model ...
Epoch: 3 cost time: 5.635256052017212
Epoch: 3, Steps: 18 | Train Loss: 0.188 Vali Loss: 0.756 Vali Acc: 0.787 Test Loss: 0.756 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.341933488845825
Epoch: 4, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
Validation loss decreased (-0.813325 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 5.105045795440674
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.578 Vali Acc: 0.860 Test Loss: 0.578 Test Acc: 0.860
Validation loss decreased (-0.833327 --> -0.859994).  Saving model ...
Epoch: 6 cost time: 4.9892048835754395
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.557 Vali Acc: 0.857 Test Loss: 0.557 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.37908148765564
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.857 Test Loss: 0.540 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.440596342086792
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.860 Test Loss: 0.537 Test Acc: 0.860
Validation loss decreased (-0.859994 --> -0.859995).  Saving model ...
Epoch: 9 cost time: 5.469494104385376
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.860 Test Loss: 0.535 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 10 cost time: 6.217736482620239
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.863 Test Loss: 0.536 Test Acc: 0.863
Validation loss decreased (-0.859995 --> -0.863328).  Saving model ...
Epoch: 11 cost time: 5.536742448806763
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.863 Test Loss: 0.534 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 12 cost time: 5.966295003890991
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.863 Test Loss: 0.536 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.436835289001465
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.863 Test Loss: 0.538 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.287772178649902
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.863 Test Loss: 0.537 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.572036027908325
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.863 Test Loss: 0.534 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.651916265487671
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.867 Test Loss: 0.531 Test Acc: 0.867
Validation loss decreased (-0.863328 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 5.713967561721802
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.390805006027222
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.867 Test Loss: 0.537 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.400148630142212
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.867 Test Loss: 0.539 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.216261386871338
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.384536266326904
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.870 Test Loss: 0.540 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.869995).  Saving model ...
Epoch: 22 cost time: 5.466756820678711
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.870 Test Loss: 0.539 Test Acc: 0.870
Validation loss decreased (-0.869995 --> -0.869995).  Saving model ...
Epoch: 23 cost time: 5.870489120483398
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.870 Test Loss: 0.540 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.721548318862915
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.863 Test Loss: 0.542 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.644541263580322
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.072732448577881
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.83188009262085
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.870 Test Loss: 0.540 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.455087900161743
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.867 Test Loss: 0.543 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.320610523223877
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.867 Test Loss: 0.543 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.329522132873535
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.867 Test Loss: 0.543 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.52734637260437
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.867 Test Loss: 0.544 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.467963218688965
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.87
model parameter : 3955737
model size : 24.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.832920789718628
Epoch: 1, Steps: 18 | Train Loss: 3.150 Vali Loss: 2.433 Vali Acc: 0.527 Test Loss: 2.433 Test Acc: 0.527
Validation loss decreased (inf --> -0.526642).  Saving model ...
Epoch: 2 cost time: 4.838542222976685
Epoch: 2, Steps: 18 | Train Loss: 1.474 Vali Loss: 1.351 Vali Acc: 0.693 Test Loss: 1.351 Test Acc: 0.693
Validation loss decreased (-0.526642 --> -0.693320).  Saving model ...
Epoch: 3 cost time: 4.504248142242432
Epoch: 3, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.093 Vali Acc: 0.700 Test Loss: 1.093 Test Acc: 0.700
Validation loss decreased (-0.693320 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 5.330010890960693
Epoch: 4, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.924 Vali Acc: 0.753 Test Loss: 0.924 Test Acc: 0.753
Validation loss decreased (-0.699989 --> -0.753324).  Saving model ...
Epoch: 5 cost time: 4.518229722976685
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.905 Vali Acc: 0.753 Test Loss: 0.905 Test Acc: 0.753
Validation loss decreased (-0.753324 --> -0.753324).  Saving model ...
Epoch: 6 cost time: 5.112948417663574
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.844 Vali Acc: 0.770 Test Loss: 0.844 Test Acc: 0.770
Validation loss decreased (-0.753324 --> -0.769992).  Saving model ...
Epoch: 7 cost time: 5.194463729858398
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.845 Vali Acc: 0.773 Test Loss: 0.845 Test Acc: 0.773
Validation loss decreased (-0.769992 --> -0.773325).  Saving model ...
Epoch: 8 cost time: 5.408160924911499
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.834 Vali Acc: 0.783 Test Loss: 0.834 Test Acc: 0.783
Validation loss decreased (-0.773325 --> -0.783325).  Saving model ...
Epoch: 9 cost time: 4.794201850891113
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.831 Vali Acc: 0.780 Test Loss: 0.831 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.840925931930542
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.838 Vali Acc: 0.783 Test Loss: 0.838 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.133930683135986
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.780 Test Loss: 0.828 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.113884210586548
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.830 Vali Acc: 0.790 Test Loss: 0.830 Test Acc: 0.790
Validation loss decreased (-0.783325 --> -0.789992).  Saving model ...
Epoch: 13 cost time: 5.26967716217041
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.838 Vali Acc: 0.780 Test Loss: 0.838 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.412729501724243
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.840 Vali Acc: 0.783 Test Loss: 0.840 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.4113450050354
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.787 Test Loss: 0.834 Test Acc: 0.787
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.5205981731414795
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.790 Test Loss: 0.829 Test Acc: 0.790
Validation loss decreased (-0.789992 --> -0.789992).  Saving model ...
Epoch: 17 cost time: 5.205786466598511
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.790 Test Loss: 0.836 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.426260948181152
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.787 Test Loss: 0.843 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.807007074356079
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.793 Test Loss: 0.844 Test Acc: 0.793
Validation loss decreased (-0.789992 --> -0.793325).  Saving model ...
Epoch: 20 cost time: 4.340519428253174
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.793 Test Loss: 0.843 Test Acc: 0.793
Validation loss decreased (-0.793325 --> -0.793325).  Saving model ...
Epoch: 21 cost time: 5.497217178344727
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.793 Test Loss: 0.843 Test Acc: 0.793
Validation loss decreased (-0.793325 --> -0.793325).  Saving model ...
Epoch: 22 cost time: 5.200630187988281
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.797 Test Loss: 0.842 Test Acc: 0.797
Validation loss decreased (-0.793325 --> -0.796658).  Saving model ...
Epoch: 23 cost time: 5.222230434417725
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.793 Test Loss: 0.844 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.707892894744873
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.793 Test Loss: 0.850 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.2321388721466064
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.800 Test Loss: 0.850 Test Acc: 0.800
Validation loss decreased (-0.796658 --> -0.799991).  Saving model ...
Epoch: 26 cost time: 4.209414958953857
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.851 Vali Acc: 0.790 Test Loss: 0.851 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.269405364990234
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.793 Test Loss: 0.850 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.5174336433410645
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.800 Test Loss: 0.853 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.1573498249053955
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.790 Test Loss: 0.856 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.6089417934417725
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.793 Test Loss: 0.858 Test Acc: 0.793
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.481611013412476
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.797 Test Loss: 0.859 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.945313215255737
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.793 Test Loss: 0.863 Test Acc: 0.793
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.934823036193848
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.790 Test Loss: 0.862 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 5.1971282958984375
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.800 Test Loss: 0.860 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 5.4130260944366455
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.800 Test Loss: 0.858 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8
model parameter : 3955737
model size : 24.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.6999571323394775
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 2.759 Vali Acc: 0.283 Test Loss: 2.759 Test Acc: 0.283
Validation loss decreased (inf --> -0.283306).  Saving model ...
Epoch: 2 cost time: 5.924883127212524
Epoch: 2, Steps: 18 | Train Loss: 1.927 Vali Loss: 1.985 Vali Acc: 0.430 Test Loss: 1.985 Test Acc: 0.430
Validation loss decreased (-0.283306 --> -0.429980).  Saving model ...
Epoch: 3 cost time: 4.94423508644104
Epoch: 3, Steps: 18 | Train Loss: 0.646 Vali Loss: 1.582 Vali Acc: 0.527 Test Loss: 1.582 Test Acc: 0.527
Validation loss decreased (-0.429980 --> -0.526651).  Saving model ...
Epoch: 4 cost time: 4.630666971206665
Epoch: 4, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.440 Vali Acc: 0.540 Test Loss: 1.440 Test Acc: 0.540
Validation loss decreased (-0.526651 --> -0.539986).  Saving model ...
Epoch: 5 cost time: 4.792410850524902
Epoch: 5, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.282 Vali Acc: 0.600 Test Loss: 1.282 Test Acc: 0.600
Validation loss decreased (-0.539986 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 4.843230962753296
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.227 Vali Acc: 0.643 Test Loss: 1.227 Test Acc: 0.643
Validation loss decreased (-0.599987 --> -0.643321).  Saving model ...
Epoch: 7 cost time: 4.921089172363281
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.195 Vali Acc: 0.630 Test Loss: 1.195 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.548304557800293
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.159 Vali Acc: 0.637 Test Loss: 1.159 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.228949069976807
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.144 Vali Acc: 0.643 Test Loss: 1.144 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643322).  Saving model ...
Epoch: 10 cost time: 5.5197014808654785
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.145 Vali Acc: 0.647 Test Loss: 1.145 Test Acc: 0.647
Validation loss decreased (-0.643322 --> -0.646655).  Saving model ...
Epoch: 11 cost time: 5.027317047119141
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.134 Vali Acc: 0.650 Test Loss: 1.134 Test Acc: 0.650
Validation loss decreased (-0.646655 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 5.354699611663818
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.124 Vali Acc: 0.653 Test Loss: 1.124 Test Acc: 0.653
Validation loss decreased (-0.649989 --> -0.653322).  Saving model ...
Epoch: 13 cost time: 4.796933889389038
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.130 Vali Acc: 0.660 Test Loss: 1.130 Test Acc: 0.660
Validation loss decreased (-0.653322 --> -0.659989).  Saving model ...
Epoch: 14 cost time: 5.477028846740723
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.120 Vali Acc: 0.660 Test Loss: 1.120 Test Acc: 0.660
Validation loss decreased (-0.659989 --> -0.659989).  Saving model ...
Epoch: 15 cost time: 5.64171028137207
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.104 Vali Acc: 0.657 Test Loss: 1.104 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.436910152435303
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.090 Vali Acc: 0.660 Test Loss: 1.090 Test Acc: 0.660
Validation loss decreased (-0.659989 --> -0.659989).  Saving model ...
Epoch: 17 cost time: 5.512092351913452
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.089 Vali Acc: 0.650 Test Loss: 1.089 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.5639190673828125
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.085 Vali Acc: 0.650 Test Loss: 1.085 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.767713785171509
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.082 Vali Acc: 0.667 Test Loss: 1.082 Test Acc: 0.667
Validation loss decreased (-0.659989 --> -0.666656).  Saving model ...
Epoch: 20 cost time: 4.3157057762146
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.077 Vali Acc: 0.667 Test Loss: 1.077 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 21 cost time: 4.680819034576416
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.079 Vali Acc: 0.673 Test Loss: 1.079 Test Acc: 0.673
Validation loss decreased (-0.666656 --> -0.673323).  Saving model ...
Epoch: 22 cost time: 4.092724084854126
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.677 Test Loss: 1.071 Test Acc: 0.677
Validation loss decreased (-0.673323 --> -0.676656).  Saving model ...
Epoch: 23 cost time: 5.442852735519409
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.066 Vali Acc: 0.673 Test Loss: 1.066 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.7203404903411865
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.062 Vali Acc: 0.677 Test Loss: 1.062 Test Acc: 0.677
Validation loss decreased (-0.676656 --> -0.676656).  Saving model ...
Epoch: 25 cost time: 6.437286615371704
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.683 Test Loss: 1.056 Test Acc: 0.683
Validation loss decreased (-0.676656 --> -0.683323).  Saving model ...
Epoch: 26 cost time: 5.75856614112854
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.690 Test Loss: 1.054 Test Acc: 0.690
Validation loss decreased (-0.683323 --> -0.689989).  Saving model ...
Epoch: 27 cost time: 5.130711793899536
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.687 Test Loss: 1.048 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.694676876068115
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.693 Test Loss: 1.050 Test Acc: 0.693
Validation loss decreased (-0.689989 --> -0.693323).  Saving model ...
Epoch: 29 cost time: 5.136716365814209
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.710 Test Loss: 1.048 Test Acc: 0.710
Validation loss decreased (-0.693323 --> -0.709990).  Saving model ...
Epoch: 30 cost time: 6.008926630020142
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.703 Test Loss: 1.047 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.56667160987854
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.044 Vali Acc: 0.700 Test Loss: 1.044 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.85398268699646
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.700 Test Loss: 1.046 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.241641521453857
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.700 Test Loss: 1.042 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.107970476150513
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.703 Test Loss: 1.039 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.690046787261963
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.700 Test Loss: 1.036 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 4.898724555969238
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.697 Test Loss: 1.032 Test Acc: 0.697
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 4.861800193786621
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.707 Test Loss: 1.031 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.807218074798584
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.027 Vali Acc: 0.707 Test Loss: 1.027 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.749539852142334
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.707 Test Loss: 1.026 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.71
model parameter : 3955737
model size : 24.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.457836866378784
Epoch: 1, Steps: 18 | Train Loss: 3.267 Vali Loss: 2.947 Vali Acc: 0.193 Test Loss: 2.947 Test Acc: 0.193
Validation loss decreased (inf --> -0.193304).  Saving model ...
Epoch: 2 cost time: 5.51927924156189
Epoch: 2, Steps: 18 | Train Loss: 2.157 Vali Loss: 2.447 Vali Acc: 0.297 Test Loss: 2.447 Test Acc: 0.297
Validation loss decreased (-0.193304 --> -0.296642).  Saving model ...
Epoch: 3 cost time: 5.31370210647583
Epoch: 3, Steps: 18 | Train Loss: 0.911 Vali Loss: 2.172 Vali Acc: 0.363 Test Loss: 2.172 Test Acc: 0.363
Validation loss decreased (-0.296642 --> -0.363312).  Saving model ...
Epoch: 4 cost time: 4.337874174118042
Epoch: 4, Steps: 18 | Train Loss: 0.245 Vali Loss: 2.026 Vali Acc: 0.350 Test Loss: 2.026 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.88797926902771
Epoch: 5, Steps: 18 | Train Loss: 0.052 Vali Loss: 1.737 Vali Acc: 0.460 Test Loss: 1.737 Test Acc: 0.460
Validation loss decreased (-0.363312 --> -0.459983).  Saving model ...
Epoch: 6 cost time: 4.494538307189941
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.653 Vali Acc: 0.487 Test Loss: 1.653 Test Acc: 0.487
Validation loss decreased (-0.459983 --> -0.486650).  Saving model ...
Epoch: 7 cost time: 5.748202800750732
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.588 Vali Acc: 0.517 Test Loss: 1.588 Test Acc: 0.517
Validation loss decreased (-0.486650 --> -0.516651).  Saving model ...
Epoch: 8 cost time: 5.989644289016724
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.560 Vali Acc: 0.530 Test Loss: 1.560 Test Acc: 0.530
Validation loss decreased (-0.516651 --> -0.529984).  Saving model ...
Epoch: 9 cost time: 5.520165681838989
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.521 Vali Acc: 0.540 Test Loss: 1.521 Test Acc: 0.540
Validation loss decreased (-0.529984 --> -0.539985).  Saving model ...
Epoch: 10 cost time: 5.718186855316162
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.515 Vali Acc: 0.530 Test Loss: 1.515 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.351357460021973
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.489 Vali Acc: 0.560 Test Loss: 1.489 Test Acc: 0.560
Validation loss decreased (-0.539985 --> -0.559985).  Saving model ...
Epoch: 12 cost time: 5.94671106338501
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.464 Vali Acc: 0.577 Test Loss: 1.464 Test Acc: 0.577
Validation loss decreased (-0.559985 --> -0.576652).  Saving model ...
Epoch: 13 cost time: 5.869917631149292
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.452 Vali Acc: 0.560 Test Loss: 1.452 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.120468378067017
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.441 Vali Acc: 0.570 Test Loss: 1.441 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.778676271438599
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.425 Vali Acc: 0.577 Test Loss: 1.425 Test Acc: 0.577
Validation loss decreased (-0.576652 --> -0.576652).  Saving model ...
Epoch: 16 cost time: 5.76683783531189
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.404 Vali Acc: 0.583 Test Loss: 1.404 Test Acc: 0.583
Validation loss decreased (-0.576652 --> -0.583319).  Saving model ...
Epoch: 17 cost time: 5.799145221710205
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.393 Vali Acc: 0.587 Test Loss: 1.393 Test Acc: 0.587
Validation loss decreased (-0.583319 --> -0.586653).  Saving model ...
Epoch: 18 cost time: 5.428933382034302
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.385 Vali Acc: 0.593 Test Loss: 1.385 Test Acc: 0.593
Validation loss decreased (-0.586653 --> -0.593319).  Saving model ...
Epoch: 19 cost time: 4.865586280822754
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.370 Vali Acc: 0.603 Test Loss: 1.370 Test Acc: 0.603
Validation loss decreased (-0.593319 --> -0.603320).  Saving model ...
Epoch: 20 cost time: 4.7176642417907715
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.597 Test Loss: 1.360 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.70112681388855
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.603 Test Loss: 1.358 Test Acc: 0.603
Validation loss decreased (-0.603320 --> -0.603320).  Saving model ...
Epoch: 22 cost time: 5.512859582901001
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.617 Test Loss: 1.350 Test Acc: 0.617
Validation loss decreased (-0.603320 --> -0.616653).  Saving model ...
Epoch: 23 cost time: 5.745812654495239
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.613 Test Loss: 1.339 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.397363662719727
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.330 Vali Acc: 0.607 Test Loss: 1.330 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.219146251678467
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.620 Test Loss: 1.322 Test Acc: 0.620
Validation loss decreased (-0.616653 --> -0.619987).  Saving model ...
Epoch: 26 cost time: 5.313004016876221
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.617 Test Loss: 1.315 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.959412336349487
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.309 Vali Acc: 0.613 Test Loss: 1.309 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.7002646923065186
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.308 Vali Acc: 0.620 Test Loss: 1.308 Test Acc: 0.620
Validation loss decreased (-0.619987 --> -0.619987).  Saving model ...
Epoch: 29 cost time: 4.923109769821167
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.304 Vali Acc: 0.620 Test Loss: 1.304 Test Acc: 0.620
Validation loss decreased (-0.619987 --> -0.619987).  Saving model ...
Epoch: 30 cost time: 5.46755576133728
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.620 Test Loss: 1.299 Test Acc: 0.620
Validation loss decreased (-0.619987 --> -0.619987).  Saving model ...
Epoch: 31 cost time: 5.916902303695679
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.620 Test Loss: 1.295 Test Acc: 0.620
Validation loss decreased (-0.619987 --> -0.619987).  Saving model ...
Epoch: 32 cost time: 6.248191595077515
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.294 Vali Acc: 0.627 Test Loss: 1.294 Test Acc: 0.627
Validation loss decreased (-0.619987 --> -0.626654).  Saving model ...
Epoch: 33 cost time: 5.097983360290527
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.290 Vali Acc: 0.627 Test Loss: 1.290 Test Acc: 0.627
Validation loss decreased (-0.626654 --> -0.626654).  Saving model ...
Epoch: 34 cost time: 5.088067293167114
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.620 Test Loss: 1.285 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.129943609237671
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.277 Vali Acc: 0.627 Test Loss: 1.277 Test Acc: 0.627
Validation loss decreased (-0.626654 --> -0.626654).  Saving model ...
Epoch: 36 cost time: 4.822693824768066
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.269 Vali Acc: 0.640 Test Loss: 1.269 Test Acc: 0.640
Validation loss decreased (-0.626654 --> -0.639987).  Saving model ...
Epoch: 37 cost time: 5.6392982006073
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.270 Vali Acc: 0.640 Test Loss: 1.270 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.749941110610962
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.650 Test Loss: 1.264 Test Acc: 0.650
Validation loss decreased (-0.639987 --> -0.649987).  Saving model ...
Epoch: 39 cost time: 5.603236436843872
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.647 Test Loss: 1.258 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.337334394454956
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.653 Test Loss: 1.256 Test Acc: 0.653
Validation loss decreased (-0.649987 --> -0.653321).  Saving model ...
Epoch: 41 cost time: 5.761239290237427
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.650 Test Loss: 1.255 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.873680114746094
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.650 Test Loss: 1.254 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 5.931981325149536
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.660 Test Loss: 1.250 Test Acc: 0.660
Validation loss decreased (-0.653321 --> -0.659987).  Saving model ...
Epoch: 44 cost time: 5.731407880783081
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.249 Vali Acc: 0.660 Test Loss: 1.249 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659988).  Saving model ...
Epoch: 45 cost time: 5.566409587860107
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.660 Test Loss: 1.245 Test Acc: 0.660
Validation loss decreased (-0.659988 --> -0.659988).  Saving model ...
Epoch: 46 cost time: 5.667178392410278
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.653 Test Loss: 1.245 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.283613920211792
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.663 Test Loss: 1.245 Test Acc: 0.663
Validation loss decreased (-0.659988 --> -0.663321).  Saving model ...
Epoch: 48 cost time: 5.531419038772583
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.670 Test Loss: 1.242 Test Acc: 0.670
Validation loss decreased (-0.663321 --> -0.669988).  Saving model ...
Epoch: 49 cost time: 4.466161012649536
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.677 Test Loss: 1.240 Test Acc: 0.677
Validation loss decreased (-0.669988 --> -0.676654).  Saving model ...
Epoch: 50 cost time: 4.950096845626831
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.677 Test Loss: 1.236 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 51 cost time: 5.080328702926636
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.677 Test Loss: 1.232 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 52 cost time: 5.923904895782471
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.673 Test Loss: 1.233 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 5.604178428649902
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.670 Test Loss: 1.234 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 5.13478422164917
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.670 Test Loss: 1.233 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 4.734520196914673
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.670 Test Loss: 1.233 Test Acc: 0.670
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 4.356822967529297
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.673 Test Loss: 1.231 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 5.157209634780884
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.673 Test Loss: 1.228 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 5.307611465454102
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.673 Test Loss: 1.227 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 5.786156177520752
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.680 Test Loss: 1.224 Test Acc: 0.680
Validation loss decreased (-0.676654 --> -0.679988).  Saving model ...
Epoch: 60 cost time: 5.9555418491363525
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.677 Test Loss: 1.226 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 5.6326727867126465
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.677 Test Loss: 1.224 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 5.064993619918823
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.677 Test Loss: 1.223 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 5.13501238822937
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.677 Test Loss: 1.225 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 5.373878479003906
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.677 Test Loss: 1.223 Test Acc: 0.677
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 5.9879374504089355
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.680 Test Loss: 1.223 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 66 cost time: 5.579100131988525
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.677 Test Loss: 1.224 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 5.759051084518433
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.680 Test Loss: 1.223 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 5.258449554443359
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.680 Test Loss: 1.222 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 69 cost time: 5.0152342319488525
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.683 Test Loss: 1.220 Test Acc: 0.683
Validation loss decreased (-0.679988 --> -0.683321).  Saving model ...
Epoch: 70 cost time: 5.079146385192871
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.683 Test Loss: 1.219 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 71 cost time: 5.358746767044067
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.683 Test Loss: 1.216 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 72 cost time: 4.135538578033447
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.683 Test Loss: 1.216 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 73 cost time: 4.789140462875366
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.680 Test Loss: 1.214 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 5.685746908187866
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.680 Test Loss: 1.211 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 5.756728887557983
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.683 Test Loss: 1.212 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 76 cost time: 5.221713542938232
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.683 Test Loss: 1.214 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 4.183404922485352
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.687 Test Loss: 1.212 Test Acc: 0.687
Validation loss decreased (-0.683321 --> -0.686655).  Saving model ...
Epoch: 78 cost time: 4.406750440597534
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.693 Test Loss: 1.212 Test Acc: 0.693
Validation loss decreased (-0.686655 --> -0.693321).  Saving model ...
Epoch: 79 cost time: 4.375263214111328
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.693 Test Loss: 1.213 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 4.848006725311279
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.687 Test Loss: 1.212 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 5.051180601119995
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.687 Test Loss: 1.211 Test Acc: 0.687
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 5.631108522415161
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.687 Test Loss: 1.212 Test Acc: 0.687
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 6.104026794433594
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.687 Test Loss: 1.212 Test Acc: 0.687
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 5.5414698123931885
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.687 Test Loss: 1.211 Test Acc: 0.687
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 6.135883569717407
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.690 Test Loss: 1.209 Test Acc: 0.690
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 5.162677764892578
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.690 Test Loss: 1.211 Test Acc: 0.690
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 5.446462392807007
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.690 Test Loss: 1.211 Test Acc: 0.690
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 5.529622316360474
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.690 Test Loss: 1.211 Test Acc: 0.690
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6933333333333334
model parameter : 3955737
model size : 24.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.591959476470947
Epoch: 1, Steps: 18 | Train Loss: 3.282 Vali Loss: 3.060 Vali Acc: 0.090 Test Loss: 3.060 Test Acc: 0.090
Validation loss decreased (inf --> -0.089969).  Saving model ...
Epoch: 2 cost time: 5.279741048812866
Epoch: 2, Steps: 18 | Train Loss: 2.236 Vali Loss: 2.673 Vali Acc: 0.237 Test Loss: 2.673 Test Acc: 0.237
Validation loss decreased (-0.089969 --> -0.236640).  Saving model ...
Epoch: 3 cost time: 4.605876684188843
Epoch: 3, Steps: 18 | Train Loss: 0.939 Vali Loss: 2.460 Vali Acc: 0.327 Test Loss: 2.460 Test Acc: 0.327
Validation loss decreased (-0.236640 --> -0.326642).  Saving model ...
Epoch: 4 cost time: 4.589303493499756
Epoch: 4, Steps: 18 | Train Loss: 0.255 Vali Loss: 2.289 Vali Acc: 0.303 Test Loss: 2.289 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.568746089935303
Epoch: 5, Steps: 18 | Train Loss: 0.055 Vali Loss: 2.062 Vali Acc: 0.370 Test Loss: 2.062 Test Acc: 0.370
Validation loss decreased (-0.326642 --> -0.369979).  Saving model ...
Epoch: 6 cost time: 4.3024303913116455
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.997 Vali Acc: 0.430 Test Loss: 1.997 Test Acc: 0.430
Validation loss decreased (-0.369979 --> -0.429980).  Saving model ...
Epoch: 7 cost time: 4.08771824836731
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.977 Vali Acc: 0.420 Test Loss: 1.977 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.28338885307312
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.915 Vali Acc: 0.427 Test Loss: 1.915 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.124347686767578
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.872 Vali Acc: 0.440 Test Loss: 1.872 Test Acc: 0.440
Validation loss decreased (-0.429980 --> -0.439981).  Saving model ...
Epoch: 10 cost time: 5.1701085567474365
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.856 Vali Acc: 0.450 Test Loss: 1.856 Test Acc: 0.450
Validation loss decreased (-0.439981 --> -0.449981).  Saving model ...
Epoch: 11 cost time: 4.466599225997925
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.817 Vali Acc: 0.457 Test Loss: 1.817 Test Acc: 0.457
Validation loss decreased (-0.449981 --> -0.456648).  Saving model ...
Epoch: 12 cost time: 4.610681772232056
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.795 Vali Acc: 0.467 Test Loss: 1.795 Test Acc: 0.467
Validation loss decreased (-0.456648 --> -0.466649).  Saving model ...
Epoch: 13 cost time: 4.449111461639404
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.773 Vali Acc: 0.487 Test Loss: 1.773 Test Acc: 0.487
Validation loss decreased (-0.466649 --> -0.486649).  Saving model ...
Epoch: 14 cost time: 5.062072277069092
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.761 Vali Acc: 0.480 Test Loss: 1.761 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.95792555809021
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.738 Vali Acc: 0.487 Test Loss: 1.738 Test Acc: 0.487
Validation loss decreased (-0.486649 --> -0.486649).  Saving model ...
Epoch: 16 cost time: 5.45923638343811
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.715 Vali Acc: 0.507 Test Loss: 1.715 Test Acc: 0.507
Validation loss decreased (-0.486649 --> -0.506650).  Saving model ...
Epoch: 17 cost time: 5.3160412311553955
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.700 Vali Acc: 0.513 Test Loss: 1.700 Test Acc: 0.513
Validation loss decreased (-0.506650 --> -0.513316).  Saving model ...
Epoch: 18 cost time: 5.368721961975098
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.687 Vali Acc: 0.527 Test Loss: 1.687 Test Acc: 0.527
Validation loss decreased (-0.513316 --> -0.526650).  Saving model ...
Epoch: 19 cost time: 5.2844462394714355
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.666 Vali Acc: 0.527 Test Loss: 1.666 Test Acc: 0.527
Validation loss decreased (-0.526650 --> -0.526650).  Saving model ...
Epoch: 20 cost time: 5.534280776977539
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.653 Vali Acc: 0.540 Test Loss: 1.653 Test Acc: 0.540
Validation loss decreased (-0.526650 --> -0.539983).  Saving model ...
Epoch: 21 cost time: 5.295736789703369
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.550 Test Loss: 1.640 Test Acc: 0.550
Validation loss decreased (-0.539983 --> -0.549984).  Saving model ...
Epoch: 22 cost time: 4.976799249649048
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.629 Vali Acc: 0.553 Test Loss: 1.629 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553317).  Saving model ...
Epoch: 23 cost time: 5.714100360870361
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.613 Vali Acc: 0.553 Test Loss: 1.613 Test Acc: 0.553
Validation loss decreased (-0.553317 --> -0.553317).  Saving model ...
Epoch: 24 cost time: 5.679810523986816
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.599 Vali Acc: 0.570 Test Loss: 1.599 Test Acc: 0.570
Validation loss decreased (-0.553317 --> -0.569984).  Saving model ...
Epoch: 25 cost time: 5.736349105834961
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.570 Test Loss: 1.583 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 26 cost time: 4.991970777511597
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.580 Test Loss: 1.574 Test Acc: 0.580
Validation loss decreased (-0.569984 --> -0.579984).  Saving model ...
Epoch: 27 cost time: 4.862240552902222
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.564 Vali Acc: 0.577 Test Loss: 1.564 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.660249948501587
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.577 Test Loss: 1.561 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.020208120346069
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.583 Test Loss: 1.550 Test Acc: 0.583
Validation loss decreased (-0.579984 --> -0.583318).  Saving model ...
Epoch: 30 cost time: 5.099419355392456
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.587 Test Loss: 1.541 Test Acc: 0.587
Validation loss decreased (-0.583318 --> -0.586651).  Saving model ...
Epoch: 31 cost time: 5.3244452476501465
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.537 Vali Acc: 0.587 Test Loss: 1.537 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 32 cost time: 5.3438496589660645
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.593 Test Loss: 1.536 Test Acc: 0.593
Validation loss decreased (-0.586651 --> -0.593318).  Saving model ...
Epoch: 33 cost time: 5.447611570358276
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.597 Test Loss: 1.527 Test Acc: 0.597
Validation loss decreased (-0.593318 --> -0.596651).  Saving model ...
Epoch: 34 cost time: 4.52991795539856
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.597 Test Loss: 1.525 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 35 cost time: 4.402900457382202
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.597 Test Loss: 1.512 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596652).  Saving model ...
Epoch: 36 cost time: 4.666449308395386
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.610 Test Loss: 1.503 Test Acc: 0.610
Validation loss decreased (-0.596652 --> -0.609985).  Saving model ...
Epoch: 37 cost time: 5.0468292236328125
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.495 Vali Acc: 0.607 Test Loss: 1.495 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.325412750244141
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.610 Test Loss: 1.488 Test Acc: 0.610
Validation loss decreased (-0.609985 --> -0.609985).  Saving model ...
Epoch: 39 cost time: 5.362133264541626
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.617 Test Loss: 1.482 Test Acc: 0.617
Validation loss decreased (-0.609985 --> -0.616652).  Saving model ...
Epoch: 40 cost time: 5.325299263000488
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.613 Test Loss: 1.478 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.882277727127075
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.617 Test Loss: 1.480 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 42 cost time: 4.450672626495361
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.475 Vali Acc: 0.617 Test Loss: 1.475 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 43 cost time: 4.247216463088989
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.620 Test Loss: 1.467 Test Acc: 0.620
Validation loss decreased (-0.616652 --> -0.619985).  Saving model ...
Epoch: 44 cost time: 4.670140504837036
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.623 Test Loss: 1.466 Test Acc: 0.623
Validation loss decreased (-0.619985 --> -0.623319).  Saving model ...
Epoch: 45 cost time: 4.909534215927124
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.623 Test Loss: 1.461 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 46 cost time: 4.9805614948272705
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.627 Test Loss: 1.456 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626652).  Saving model ...
Epoch: 47 cost time: 5.335568904876709
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.630 Test Loss: 1.453 Test Acc: 0.630
Validation loss decreased (-0.626652 --> -0.629985).  Saving model ...
Epoch: 48 cost time: 5.419509410858154
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.633 Test Loss: 1.449 Test Acc: 0.633
Validation loss decreased (-0.629985 --> -0.633319).  Saving model ...
Epoch: 49 cost time: 5.171911954879761
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.633 Test Loss: 1.445 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 50 cost time: 5.688875913619995
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.630 Test Loss: 1.442 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.6543920040130615
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.633 Test Loss: 1.440 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 52 cost time: 5.460346221923828
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.637 Test Loss: 1.437 Test Acc: 0.637
Validation loss decreased (-0.633319 --> -0.636652).  Saving model ...
Epoch: 53 cost time: 5.15972900390625
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.633 Test Loss: 1.436 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.33727240562439
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.640 Test Loss: 1.434 Test Acc: 0.640
Validation loss decreased (-0.636652 --> -0.639986).  Saving model ...
Epoch: 55 cost time: 5.482434988021851
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.640 Test Loss: 1.432 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 56 cost time: 4.990578651428223
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.640 Test Loss: 1.428 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 57 cost time: 5.555872678756714
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.640 Test Loss: 1.425 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 58 cost time: 4.974639177322388
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.640 Test Loss: 1.425 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 5.274778127670288
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.640 Test Loss: 1.424 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 60 cost time: 4.622338533401489
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.643 Test Loss: 1.424 Test Acc: 0.643
Validation loss decreased (-0.639986 --> -0.643319).  Saving model ...
Epoch: 61 cost time: 4.293481349945068
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.643 Test Loss: 1.420 Test Acc: 0.643
Validation loss decreased (-0.643319 --> -0.643319).  Saving model ...
Epoch: 62 cost time: 4.417683362960815
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.650 Test Loss: 1.419 Test Acc: 0.650
Validation loss decreased (-0.643319 --> -0.649986).  Saving model ...
Epoch: 63 cost time: 4.107091665267944
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.647 Test Loss: 1.418 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 4.3767335414886475
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.647 Test Loss: 1.416 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 5.574386119842529
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.647 Test Loss: 1.414 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 5.465369939804077
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.647 Test Loss: 1.413 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 5.714564800262451
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.647 Test Loss: 1.415 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 4.741286277770996
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.647 Test Loss: 1.416 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 5.063918352127075
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.647 Test Loss: 1.414 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 5.0797600746154785
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.647 Test Loss: 1.413 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 5.190903663635254
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.647 Test Loss: 1.411 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 5.531505584716797
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.647 Test Loss: 1.411 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.65
model parameter : 3955737
model size : 24.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.387343406677246
Epoch: 1, Steps: 18 | Train Loss: 3.317 Vali Loss: 3.191 Vali Acc: 0.047 Test Loss: 3.191 Test Acc: 0.047
Validation loss decreased (inf --> -0.046635).  Saving model ...
Epoch: 2 cost time: 4.914003372192383
Epoch: 2, Steps: 18 | Train Loss: 2.264 Vali Loss: 2.962 Vali Acc: 0.113 Test Loss: 2.962 Test Acc: 0.113
Validation loss decreased (-0.046635 --> -0.113304).  Saving model ...
Epoch: 3 cost time: 4.374070644378662
Epoch: 3, Steps: 18 | Train Loss: 1.019 Vali Loss: 2.813 Vali Acc: 0.173 Test Loss: 2.813 Test Acc: 0.173
Validation loss decreased (-0.113304 --> -0.173305).  Saving model ...
Epoch: 4 cost time: 4.331550598144531
Epoch: 4, Steps: 18 | Train Loss: 0.285 Vali Loss: 2.685 Vali Acc: 0.233 Test Loss: 2.685 Test Acc: 0.233
Validation loss decreased (-0.173305 --> -0.233306).  Saving model ...
Epoch: 5 cost time: 4.741505861282349
Epoch: 5, Steps: 18 | Train Loss: 0.061 Vali Loss: 2.533 Vali Acc: 0.243 Test Loss: 2.533 Test Acc: 0.243
Validation loss decreased (-0.233306 --> -0.243308).  Saving model ...
Epoch: 6 cost time: 4.94736123085022
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.406 Vali Acc: 0.287 Test Loss: 2.406 Test Acc: 0.287
Validation loss decreased (-0.243308 --> -0.286643).  Saving model ...
Epoch: 7 cost time: 5.371516942977905
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.318 Vali Acc: 0.297 Test Loss: 2.318 Test Acc: 0.297
Validation loss decreased (-0.286643 --> -0.296643).  Saving model ...
Epoch: 8 cost time: 5.427927255630493
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 2.268 Vali Acc: 0.323 Test Loss: 2.268 Test Acc: 0.323
Validation loss decreased (-0.296643 --> -0.323311).  Saving model ...
Epoch: 9 cost time: 5.443734884262085
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.235 Vali Acc: 0.347 Test Loss: 2.235 Test Acc: 0.347
Validation loss decreased (-0.323311 --> -0.346644).  Saving model ...
Epoch: 10 cost time: 4.662678241729736
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.178 Vali Acc: 0.370 Test Loss: 2.178 Test Acc: 0.370
Validation loss decreased (-0.346644 --> -0.369978).  Saving model ...
Epoch: 11 cost time: 4.472927570343018
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.118 Vali Acc: 0.397 Test Loss: 2.118 Test Acc: 0.397
Validation loss decreased (-0.369978 --> -0.396645).  Saving model ...
Epoch: 12 cost time: 4.208424091339111
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.099 Vali Acc: 0.407 Test Loss: 2.099 Test Acc: 0.407
Validation loss decreased (-0.396645 --> -0.406646).  Saving model ...
Epoch: 13 cost time: 4.7376508712768555
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.059 Vali Acc: 0.420 Test Loss: 2.059 Test Acc: 0.420
Validation loss decreased (-0.406646 --> -0.419979).  Saving model ...
Epoch: 14 cost time: 5.069735050201416
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.042 Vali Acc: 0.440 Test Loss: 2.042 Test Acc: 0.440
Validation loss decreased (-0.419979 --> -0.439980).  Saving model ...
Epoch: 15 cost time: 5.254048824310303
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.013 Vali Acc: 0.433 Test Loss: 2.013 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.327618837356567
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.980 Vali Acc: 0.450 Test Loss: 1.980 Test Acc: 0.450
Validation loss decreased (-0.439980 --> -0.449980).  Saving model ...
Epoch: 17 cost time: 5.561024904251099
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.945 Vali Acc: 0.460 Test Loss: 1.945 Test Acc: 0.460
Validation loss decreased (-0.449980 --> -0.459981).  Saving model ...
Epoch: 18 cost time: 4.573161363601685
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.921 Vali Acc: 0.473 Test Loss: 1.921 Test Acc: 0.473
Validation loss decreased (-0.459981 --> -0.473314).  Saving model ...
Epoch: 19 cost time: 5.1316328048706055
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.894 Vali Acc: 0.487 Test Loss: 1.894 Test Acc: 0.487
Validation loss decreased (-0.473314 --> -0.486648).  Saving model ...
Epoch: 20 cost time: 4.720985174179077
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.885 Vali Acc: 0.490 Test Loss: 1.885 Test Acc: 0.490
Validation loss decreased (-0.486648 --> -0.489981).  Saving model ...
Epoch: 21 cost time: 4.431712627410889
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.869 Vali Acc: 0.497 Test Loss: 1.869 Test Acc: 0.497
Validation loss decreased (-0.489981 --> -0.496648).  Saving model ...
Epoch: 22 cost time: 5.626686096191406
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.850 Vali Acc: 0.493 Test Loss: 1.850 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.591860055923462
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.507 Test Loss: 1.833 Test Acc: 0.507
Validation loss decreased (-0.496648 --> -0.506648).  Saving model ...
Epoch: 24 cost time: 5.711050748825073
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.821 Vali Acc: 0.510 Test Loss: 1.821 Test Acc: 0.510
Validation loss decreased (-0.506648 --> -0.509982).  Saving model ...
Epoch: 25 cost time: 5.356301307678223
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.806 Vali Acc: 0.503 Test Loss: 1.806 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.5817060470581055
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.507 Test Loss: 1.786 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.133269786834717
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.771 Vali Acc: 0.517 Test Loss: 1.771 Test Acc: 0.517
Validation loss decreased (-0.509982 --> -0.516649).  Saving model ...
Epoch: 28 cost time: 5.657311677932739
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.762 Vali Acc: 0.520 Test Loss: 1.762 Test Acc: 0.520
Validation loss decreased (-0.516649 --> -0.519982).  Saving model ...
Epoch: 29 cost time: 5.789518117904663
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.752 Vali Acc: 0.523 Test Loss: 1.752 Test Acc: 0.523
Validation loss decreased (-0.519982 --> -0.523316).  Saving model ...
Epoch: 30 cost time: 6.279694080352783
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.520 Test Loss: 1.739 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.916667461395264
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.533 Test Loss: 1.725 Test Acc: 0.533
Validation loss decreased (-0.523316 --> -0.533316).  Saving model ...
Epoch: 32 cost time: 5.2939629554748535
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.723 Vali Acc: 0.530 Test Loss: 1.723 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.456965684890747
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.530 Test Loss: 1.715 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.7786993980407715
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.530 Test Loss: 1.715 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.410114765167236
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.707 Vali Acc: 0.530 Test Loss: 1.707 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 5.736268043518066
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.702 Vali Acc: 0.533 Test Loss: 1.702 Test Acc: 0.533
Validation loss decreased (-0.533316 --> -0.533316).  Saving model ...
Epoch: 37 cost time: 5.654918909072876
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.690 Vali Acc: 0.540 Test Loss: 1.690 Test Acc: 0.540
Validation loss decreased (-0.533316 --> -0.539983).  Saving model ...
Epoch: 38 cost time: 5.1682960987091064
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.678 Vali Acc: 0.530 Test Loss: 1.678 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.141823053359985
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.668 Vali Acc: 0.543 Test Loss: 1.668 Test Acc: 0.543
Validation loss decreased (-0.539983 --> -0.543317).  Saving model ...
Epoch: 40 cost time: 4.8367979526519775
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.661 Vali Acc: 0.547 Test Loss: 1.661 Test Acc: 0.547
Validation loss decreased (-0.543317 --> -0.546650).  Saving model ...
Epoch: 41 cost time: 4.912881374359131
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.659 Vali Acc: 0.547 Test Loss: 1.659 Test Acc: 0.547
Validation loss decreased (-0.546650 --> -0.546650).  Saving model ...
Epoch: 42 cost time: 5.023367404937744
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.653 Vali Acc: 0.547 Test Loss: 1.653 Test Acc: 0.547
Validation loss decreased (-0.546650 --> -0.546650).  Saving model ...
Epoch: 43 cost time: 4.961859464645386
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.650 Vali Acc: 0.547 Test Loss: 1.650 Test Acc: 0.547
Validation loss decreased (-0.546650 --> -0.546650).  Saving model ...
Epoch: 44 cost time: 5.413494110107422
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.560 Test Loss: 1.644 Test Acc: 0.560
Validation loss decreased (-0.546650 --> -0.559984).  Saving model ...
Epoch: 45 cost time: 5.246628284454346
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.560 Test Loss: 1.640 Test Acc: 0.560
Validation loss decreased (-0.559984 --> -0.559984).  Saving model ...
Epoch: 46 cost time: 5.9676513671875
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.632 Vali Acc: 0.563 Test Loss: 1.632 Test Acc: 0.563
Validation loss decreased (-0.559984 --> -0.563317).  Saving model ...
Epoch: 47 cost time: 5.699239253997803
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.570 Test Loss: 1.626 Test Acc: 0.570
Validation loss decreased (-0.563317 --> -0.569984).  Saving model ...
Epoch: 48 cost time: 5.446549892425537
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.567 Test Loss: 1.624 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.598145961761475
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.570 Test Loss: 1.619 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 50 cost time: 6.048744201660156
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.570 Test Loss: 1.616 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 51 cost time: 5.651395797729492
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.570 Test Loss: 1.617 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.6532301902771
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.570 Test Loss: 1.612 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 53 cost time: 5.358928442001343
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.570 Test Loss: 1.604 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 54 cost time: 5.260731220245361
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.573 Test Loss: 1.602 Test Acc: 0.573
Validation loss decreased (-0.569984 --> -0.573317).  Saving model ...
Epoch: 55 cost time: 5.115063905715942
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.598 Vali Acc: 0.577 Test Loss: 1.598 Test Acc: 0.577
Validation loss decreased (-0.573317 --> -0.576651).  Saving model ...
Epoch: 56 cost time: 5.163291931152344
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.593 Vali Acc: 0.583 Test Loss: 1.593 Test Acc: 0.583
Validation loss decreased (-0.576651 --> -0.583317).  Saving model ...
Epoch: 57 cost time: 5.371384382247925
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.590 Test Loss: 1.590 Test Acc: 0.590
Validation loss decreased (-0.583317 --> -0.589984).  Saving model ...
Epoch: 58 cost time: 5.43008828163147
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.593 Test Loss: 1.590 Test Acc: 0.593
Validation loss decreased (-0.589984 --> -0.593317).  Saving model ...
Epoch: 59 cost time: 5.702719211578369
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.597 Test Loss: 1.587 Test Acc: 0.597
Validation loss decreased (-0.593317 --> -0.596651).  Saving model ...
Epoch: 60 cost time: 5.64129900932312
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.603 Test Loss: 1.583 Test Acc: 0.603
Validation loss decreased (-0.596651 --> -0.603318).  Saving model ...
Epoch: 61 cost time: 4.8870604038238525
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.603 Test Loss: 1.580 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 62 cost time: 5.539351940155029
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.584 Vali Acc: 0.600 Test Loss: 1.584 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 4.6640424728393555
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.600 Test Loss: 1.579 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 5.0671539306640625
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.603 Test Loss: 1.576 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 65 cost time: 5.873696804046631
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.603 Test Loss: 1.572 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 66 cost time: 5.5876805782318115
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.570 Vali Acc: 0.607 Test Loss: 1.570 Test Acc: 0.607
Validation loss decreased (-0.603318 --> -0.606651).  Saving model ...
Epoch: 67 cost time: 5.475045919418335
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.610 Test Loss: 1.569 Test Acc: 0.610
Validation loss decreased (-0.606651 --> -0.609984).  Saving model ...
Epoch: 68 cost time: 5.225687265396118
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.613 Test Loss: 1.566 Test Acc: 0.613
Validation loss decreased (-0.609984 --> -0.613318).  Saving model ...
Epoch: 69 cost time: 5.209459543228149
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.613 Test Loss: 1.561 Test Acc: 0.613
Validation loss decreased (-0.613318 --> -0.613318).  Saving model ...
Epoch: 70 cost time: 5.575382471084595
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.610 Test Loss: 1.559 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 5.347008943557739
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.613 Test Loss: 1.553 Test Acc: 0.613
Validation loss decreased (-0.613318 --> -0.613318).  Saving model ...
Epoch: 72 cost time: 5.513807058334351
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.552 Vali Acc: 0.617 Test Loss: 1.552 Test Acc: 0.617
Validation loss decreased (-0.613318 --> -0.616651).  Saving model ...
Epoch: 73 cost time: 4.994809865951538
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.620 Test Loss: 1.553 Test Acc: 0.620
Validation loss decreased (-0.616651 --> -0.619984).  Saving model ...
Epoch: 74 cost time: 6.0870866775512695
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.623 Test Loss: 1.550 Test Acc: 0.623
Validation loss decreased (-0.619984 --> -0.623318).  Saving model ...
Epoch: 75 cost time: 5.133500814437866
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.630 Test Loss: 1.550 Test Acc: 0.630
Validation loss decreased (-0.623318 --> -0.629984).  Saving model ...
Epoch: 76 cost time: 5.075888395309448
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.545 Vali Acc: 0.630 Test Loss: 1.545 Test Acc: 0.630
Validation loss decreased (-0.629984 --> -0.629985).  Saving model ...
Epoch: 77 cost time: 5.134523391723633
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.542 Vali Acc: 0.627 Test Loss: 1.542 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.275257587432861
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.627 Test Loss: 1.540 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 5.79079270362854
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.633 Test Loss: 1.538 Test Acc: 0.633
Validation loss decreased (-0.629985 --> -0.633318).  Saving model ...
Epoch: 80 cost time: 5.401087522506714
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.633 Test Loss: 1.535 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633318).  Saving model ...
Epoch: 81 cost time: 5.483910799026489
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.637 Test Loss: 1.531 Test Acc: 0.637
Validation loss decreased (-0.633318 --> -0.636651).  Saving model ...
Epoch: 82 cost time: 5.180274963378906
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.637 Test Loss: 1.529 Test Acc: 0.637
Validation loss decreased (-0.636651 --> -0.636651).  Saving model ...
Epoch: 83 cost time: 5.554415225982666
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.643 Test Loss: 1.530 Test Acc: 0.643
Validation loss decreased (-0.636651 --> -0.643318).  Saving model ...
Epoch: 84 cost time: 5.1750311851501465
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.643 Test Loss: 1.534 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 5.25356388092041
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.643 Test Loss: 1.533 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 5.137699127197266
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.643 Test Loss: 1.527 Test Acc: 0.643
Validation loss decreased (-0.643318 --> -0.643318).  Saving model ...
Epoch: 87 cost time: 5.1802825927734375
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.647 Test Loss: 1.526 Test Acc: 0.647
Validation loss decreased (-0.643318 --> -0.646651).  Saving model ...
Epoch: 88 cost time: 5.310783624649048
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.650 Test Loss: 1.524 Test Acc: 0.650
Validation loss decreased (-0.646651 --> -0.649985).  Saving model ...
Epoch: 89 cost time: 4.8238654136657715
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.647 Test Loss: 1.525 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 5.681387186050415
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.647 Test Loss: 1.527 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 5.619743824005127
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.643 Test Loss: 1.527 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 5.806936025619507
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.643 Test Loss: 1.525 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 4.919205188751221
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.643 Test Loss: 1.525 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 4.400128602981567
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.647 Test Loss: 1.524 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 5.105626106262207
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.643 Test Loss: 1.524 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 4.961545944213867
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.643 Test Loss: 1.522 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 5.6618945598602295
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.650 Test Loss: 1.520 Test Acc: 0.650
Validation loss decreased (-0.649985 --> -0.649985).  Saving model ...
Epoch: 98 cost time: 5.777365207672119
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.650 Test Loss: 1.521 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 5.628151893615723
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.650 Test Loss: 1.520 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 5.648080110549927
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.650 Test Loss: 1.519 Test Acc: 0.650
Validation loss decreased (-0.649985 --> -0.649985).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.65
model parameter : 3955737
model size : 24.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.563692569732666
Epoch: 1, Steps: 18 | Train Loss: 3.297 Vali Loss: 3.181 Vali Acc: 0.063 Test Loss: 3.181 Test Acc: 0.063
Validation loss decreased (inf --> -0.063302).  Saving model ...
Epoch: 2 cost time: 5.730854272842407
Epoch: 2, Steps: 18 | Train Loss: 2.393 Vali Loss: 2.917 Vali Acc: 0.127 Test Loss: 2.917 Test Acc: 0.127
Validation loss decreased (-0.063302 --> -0.126637).  Saving model ...
Epoch: 3 cost time: 5.623674631118774
Epoch: 3, Steps: 18 | Train Loss: 1.248 Vali Loss: 2.675 Vali Acc: 0.200 Test Loss: 2.675 Test Acc: 0.200
Validation loss decreased (-0.126637 --> -0.199973).  Saving model ...
Epoch: 4 cost time: 5.547595262527466
Epoch: 4, Steps: 18 | Train Loss: 0.429 Vali Loss: 2.426 Vali Acc: 0.300 Test Loss: 2.426 Test Acc: 0.300
Validation loss decreased (-0.199973 --> -0.299976).  Saving model ...
Epoch: 5 cost time: 5.647997856140137
Epoch: 5, Steps: 18 | Train Loss: 0.123 Vali Loss: 2.403 Vali Acc: 0.273 Test Loss: 2.403 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.709829568862915
Epoch: 6, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.996 Vali Acc: 0.397 Test Loss: 1.996 Test Acc: 0.397
Validation loss decreased (-0.299976 --> -0.396647).  Saving model ...
Epoch: 7 cost time: 4.422685623168945
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.023 Vali Acc: 0.393 Test Loss: 2.023 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.369266986846924
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.872 Vali Acc: 0.443 Test Loss: 1.872 Test Acc: 0.443
Validation loss decreased (-0.396647 --> -0.443315).  Saving model ...
Epoch: 9 cost time: 5.44376015663147
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.816 Vali Acc: 0.453 Test Loss: 1.816 Test Acc: 0.453
Validation loss decreased (-0.443315 --> -0.453315).  Saving model ...
Epoch: 10 cost time: 5.69786262512207
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.758 Vali Acc: 0.507 Test Loss: 1.758 Test Acc: 0.507
Validation loss decreased (-0.453315 --> -0.506649).  Saving model ...
Epoch: 11 cost time: 5.672548532485962
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.720 Vali Acc: 0.500 Test Loss: 1.720 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.30318546295166
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.727 Vali Acc: 0.500 Test Loss: 1.727 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.443015098571777
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.656 Vali Acc: 0.530 Test Loss: 1.656 Test Acc: 0.530
Validation loss decreased (-0.506649 --> -0.529983).  Saving model ...
Epoch: 14 cost time: 5.079243183135986
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.520 Test Loss: 1.633 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.140898704528809
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.622 Vali Acc: 0.527 Test Loss: 1.622 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.698456764221191
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.603 Vali Acc: 0.547 Test Loss: 1.603 Test Acc: 0.547
Validation loss decreased (-0.529983 --> -0.546651).  Saving model ...
Epoch: 17 cost time: 5.5261125564575195
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.585 Vali Acc: 0.540 Test Loss: 1.585 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.517633676528931
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.564 Vali Acc: 0.550 Test Loss: 1.564 Test Acc: 0.550
Validation loss decreased (-0.546651 --> -0.549984).  Saving model ...
Epoch: 19 cost time: 5.929332971572876
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.550 Vali Acc: 0.563 Test Loss: 1.550 Test Acc: 0.563
Validation loss decreased (-0.549984 --> -0.563318).  Saving model ...
Epoch: 20 cost time: 5.365234851837158
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.535 Vali Acc: 0.570 Test Loss: 1.535 Test Acc: 0.570
Validation loss decreased (-0.563318 --> -0.569985).  Saving model ...
Epoch: 21 cost time: 5.374178886413574
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.515 Vali Acc: 0.573 Test Loss: 1.515 Test Acc: 0.573
Validation loss decreased (-0.569985 --> -0.573318).  Saving model ...
Epoch: 22 cost time: 5.667124032974243
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.508 Vali Acc: 0.570 Test Loss: 1.508 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.1796159744262695
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.567 Test Loss: 1.521 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.498829364776611
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.577 Test Loss: 1.488 Test Acc: 0.577
Validation loss decreased (-0.573318 --> -0.576652).  Saving model ...
Epoch: 25 cost time: 5.708284854888916
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.573 Test Loss: 1.478 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.7925286293029785
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.580 Test Loss: 1.464 Test Acc: 0.580
Validation loss decreased (-0.576652 --> -0.579985).  Saving model ...
Epoch: 27 cost time: 5.125446557998657
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.580 Test Loss: 1.449 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579986).  Saving model ...
Epoch: 28 cost time: 5.016200304031372
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.593 Test Loss: 1.448 Test Acc: 0.593
Validation loss decreased (-0.579986 --> -0.593319).  Saving model ...
Epoch: 29 cost time: 4.774352788925171
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.603 Test Loss: 1.437 Test Acc: 0.603
Validation loss decreased (-0.593319 --> -0.603319).  Saving model ...
Epoch: 30 cost time: 5.271944046020508
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.600 Test Loss: 1.424 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.257409572601318
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.600 Test Loss: 1.415 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.462984085083008
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.610 Test Loss: 1.408 Test Acc: 0.610
Validation loss decreased (-0.603319 --> -0.609986).  Saving model ...
Epoch: 33 cost time: 5.68088436126709
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.617 Test Loss: 1.398 Test Acc: 0.617
Validation loss decreased (-0.609986 --> -0.616653).  Saving model ...
Epoch: 34 cost time: 5.461283206939697
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.617 Test Loss: 1.397 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616653).  Saving model ...
Epoch: 35 cost time: 5.55520486831665
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.620 Test Loss: 1.387 Test Acc: 0.620
Validation loss decreased (-0.616653 --> -0.619986).  Saving model ...
Epoch: 36 cost time: 5.531809329986572
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.627 Test Loss: 1.386 Test Acc: 0.627
Validation loss decreased (-0.619986 --> -0.626653).  Saving model ...
Epoch: 37 cost time: 5.449975252151489
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.627 Test Loss: 1.385 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 38 cost time: 5.35548734664917
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.620 Test Loss: 1.390 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.49323296546936
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.620 Test Loss: 1.376 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 5.260855197906494
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.620 Test Loss: 1.370 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 6.009217977523804
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.630 Test Loss: 1.372 Test Acc: 0.630
Validation loss decreased (-0.626653 --> -0.629986).  Saving model ...
Epoch: 42 cost time: 5.498789310455322
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.627 Test Loss: 1.368 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.044933319091797
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.627 Test Loss: 1.366 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.1453940868377686
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.630 Test Loss: 1.365 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 45 cost time: 5.06944465637207
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.640 Test Loss: 1.360 Test Acc: 0.640
Validation loss decreased (-0.629986 --> -0.639986).  Saving model ...
Epoch: 46 cost time: 5.44420599937439
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.640 Test Loss: 1.353 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 47 cost time: 5.5233728885650635
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.640 Test Loss: 1.346 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639987).  Saving model ...
Epoch: 48 cost time: 5.705807685852051
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.643 Test Loss: 1.342 Test Acc: 0.643
Validation loss decreased (-0.639987 --> -0.643320).  Saving model ...
Epoch: 49 cost time: 5.2031049728393555
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.630 Test Loss: 1.346 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.547066688537598
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.623 Test Loss: 1.347 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 4.784046649932861
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.623 Test Loss: 1.348 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 5.470541000366211
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.620 Test Loss: 1.347 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 5.886336088180542
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.623 Test Loss: 1.343 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 6.026476860046387
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.627 Test Loss: 1.343 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 5.430477142333984
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.627 Test Loss: 1.339 Test Acc: 0.627
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 5.340864658355713
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.633 Test Loss: 1.335 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 4.996617794036865
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.650 Test Loss: 1.332 Test Acc: 0.650
Validation loss decreased (-0.643320 --> -0.649987).  Saving model ...
Epoch: 58 cost time: 5.576397895812988
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.653 Test Loss: 1.335 Test Acc: 0.653
Validation loss decreased (-0.649987 --> -0.653320).  Saving model ...
Epoch: 59 cost time: 4.961984634399414
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.650 Test Loss: 1.337 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.341821908950806
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.650 Test Loss: 1.340 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 5.328751564025879
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.643 Test Loss: 1.339 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 5.624155521392822
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.640 Test Loss: 1.340 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 5.623138666152954
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.650 Test Loss: 1.333 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 5.144287109375
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.650 Test Loss: 1.333 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 4.923806667327881
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.653 Test Loss: 1.333 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 66 cost time: 5.741390943527222
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.650 Test Loss: 1.332 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 5.105163812637329
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.650 Test Loss: 1.333 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 5.614843130111694
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.334 Vali Acc: 0.653 Test Loss: 1.334 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 5.395756721496582
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.330 Vali Acc: 0.657 Test Loss: 1.330 Test Acc: 0.657
Validation loss decreased (-0.653320 --> -0.656653).  Saving model ...
Epoch: 70 cost time: 5.1977152824401855
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.660 Test Loss: 1.326 Test Acc: 0.660
Validation loss decreased (-0.656653 --> -0.659987).  Saving model ...
Epoch: 71 cost time: 5.591564416885376
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.660 Test Loss: 1.323 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
Epoch: 72 cost time: 5.516594171524048
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.667 Test Loss: 1.321 Test Acc: 0.667
Validation loss decreased (-0.659987 --> -0.666653).  Saving model ...
Epoch: 73 cost time: 5.471308946609497
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.667 Test Loss: 1.320 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
Epoch: 74 cost time: 5.57895302772522
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.670 Test Loss: 1.319 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.669987).  Saving model ...
Epoch: 75 cost time: 5.687245845794678
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.677 Test Loss: 1.316 Test Acc: 0.677
Validation loss decreased (-0.669987 --> -0.676654).  Saving model ...
Epoch: 76 cost time: 6.005158185958862
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.313 Vali Acc: 0.677 Test Loss: 1.313 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 77 cost time: 5.401034832000732
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.677 Test Loss: 1.314 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.012915372848511
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.680 Test Loss: 1.316 Test Acc: 0.680
Validation loss decreased (-0.676654 --> -0.679987).  Saving model ...
Epoch: 79 cost time: 5.8029937744140625
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.673 Test Loss: 1.319 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 5.162606477737427
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.673 Test Loss: 1.315 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 5.047333478927612
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.311 Vali Acc: 0.677 Test Loss: 1.311 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 5.825486421585083
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.310 Vali Acc: 0.680 Test Loss: 1.310 Test Acc: 0.680
Validation loss decreased (-0.679987 --> -0.679987).  Saving model ...
Epoch: 83 cost time: 5.733781337738037
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.308 Vali Acc: 0.680 Test Loss: 1.308 Test Acc: 0.680
Validation loss decreased (-0.679987 --> -0.679987).  Saving model ...
Epoch: 84 cost time: 5.572040796279907
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.677 Test Loss: 1.314 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 5.097819089889526
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.683 Test Loss: 1.318 Test Acc: 0.683
Validation loss decreased (-0.679987 --> -0.683320).  Saving model ...
Epoch: 86 cost time: 5.368964433670044
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.683 Test Loss: 1.320 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 5.141175746917725
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.683 Test Loss: 1.319 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 4.763731002807617
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.683 Test Loss: 1.320 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 5.425838470458984
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.693 Test Loss: 1.319 Test Acc: 0.693
Validation loss decreased (-0.683320 --> -0.693320).  Saving model ...
Epoch: 90 cost time: 5.656197547912598
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.693 Test Loss: 1.319 Test Acc: 0.693
Validation loss decreased (-0.693320 --> -0.693320).  Saving model ...
Epoch: 91 cost time: 5.71884298324585
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.697 Test Loss: 1.319 Test Acc: 0.697
Validation loss decreased (-0.693320 --> -0.696653).  Saving model ...
Epoch: 92 cost time: 5.0744547843933105
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.697 Test Loss: 1.317 Test Acc: 0.697
Validation loss decreased (-0.696653 --> -0.696653).  Saving model ...
Epoch: 93 cost time: 5.535793781280518
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.697 Test Loss: 1.314 Test Acc: 0.697
Validation loss decreased (-0.696653 --> -0.696654).  Saving model ...
Epoch: 94 cost time: 5.38380765914917
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.697 Test Loss: 1.314 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 4.838494062423706
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.697 Test Loss: 1.314 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 4.75495171546936
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.693 Test Loss: 1.314 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 5.801753759384155
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.693 Test Loss: 1.315 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 5.695388078689575
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.693 Test Loss: 1.316 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 5.5686962604522705
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.693 Test Loss: 1.317 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 5.152065277099609
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.693 Test Loss: 1.315 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6966666666666667
model parameter : 3955737
model size : 24.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.37608003616333
Epoch: 1, Steps: 18 | Train Loss: 3.297 Vali Loss: 3.200 Vali Acc: 0.053 Test Loss: 3.200 Test Acc: 0.053
Validation loss decreased (inf --> -0.053301).  Saving model ...
Epoch: 2 cost time: 5.477606534957886
Epoch: 2, Steps: 18 | Train Loss: 2.480 Vali Loss: 2.965 Vali Acc: 0.117 Test Loss: 2.965 Test Acc: 0.117
Validation loss decreased (-0.053301 --> -0.116637).  Saving model ...
Epoch: 3 cost time: 5.748227596282959
Epoch: 3, Steps: 18 | Train Loss: 1.341 Vali Loss: 2.711 Vali Acc: 0.243 Test Loss: 2.711 Test Acc: 0.243
Validation loss decreased (-0.116637 --> -0.243306).  Saving model ...
Epoch: 4 cost time: 5.425146102905273
Epoch: 4, Steps: 18 | Train Loss: 0.465 Vali Loss: 2.450 Vali Acc: 0.293 Test Loss: 2.450 Test Acc: 0.293
Validation loss decreased (-0.243306 --> -0.293309).  Saving model ...
Epoch: 5 cost time: 5.321443319320679
Epoch: 5, Steps: 18 | Train Loss: 0.128 Vali Loss: 2.237 Vali Acc: 0.310 Test Loss: 2.237 Test Acc: 0.310
Validation loss decreased (-0.293309 --> -0.309978).  Saving model ...
Epoch: 6 cost time: 4.861361503601074
Epoch: 6, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.926 Vali Acc: 0.393 Test Loss: 1.926 Test Acc: 0.393
Validation loss decreased (-0.309978 --> -0.393314).  Saving model ...
Epoch: 7 cost time: 4.5939977169036865
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.895 Vali Acc: 0.413 Test Loss: 1.895 Test Acc: 0.413
Validation loss decreased (-0.393314 --> -0.413314).  Saving model ...
Epoch: 8 cost time: 4.517147541046143
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.772 Vali Acc: 0.450 Test Loss: 1.772 Test Acc: 0.450
Validation loss decreased (-0.413314 --> -0.449982).  Saving model ...
Epoch: 9 cost time: 4.602940082550049
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.707 Vali Acc: 0.490 Test Loss: 1.707 Test Acc: 0.490
Validation loss decreased (-0.449982 --> -0.489983).  Saving model ...
Epoch: 10 cost time: 5.678563833236694
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.657 Vali Acc: 0.507 Test Loss: 1.657 Test Acc: 0.507
Validation loss decreased (-0.489983 --> -0.506650).  Saving model ...
Epoch: 11 cost time: 5.626868486404419
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.616 Vali Acc: 0.487 Test Loss: 1.616 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.776489734649658
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.628 Vali Acc: 0.513 Test Loss: 1.628 Test Acc: 0.513
Validation loss decreased (-0.506650 --> -0.513317).  Saving model ...
Epoch: 13 cost time: 5.245667934417725
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.566 Vali Acc: 0.530 Test Loss: 1.566 Test Acc: 0.530
Validation loss decreased (-0.513317 --> -0.529984).  Saving model ...
Epoch: 14 cost time: 5.125039339065552
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.543 Vali Acc: 0.547 Test Loss: 1.543 Test Acc: 0.547
Validation loss decreased (-0.529984 --> -0.546651).  Saving model ...
Epoch: 15 cost time: 4.881022691726685
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.505 Vali Acc: 0.540 Test Loss: 1.505 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.1901936531066895
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.487 Vali Acc: 0.550 Test Loss: 1.487 Test Acc: 0.550
Validation loss decreased (-0.546651 --> -0.549985).  Saving model ...
Epoch: 17 cost time: 5.506688356399536
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.573 Test Loss: 1.477 Test Acc: 0.573
Validation loss decreased (-0.549985 --> -0.573319).  Saving model ...
Epoch: 18 cost time: 5.8126137256622314
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.458 Vali Acc: 0.580 Test Loss: 1.458 Test Acc: 0.580
Validation loss decreased (-0.573319 --> -0.579985).  Saving model ...
Epoch: 19 cost time: 5.940664768218994
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.442 Vali Acc: 0.573 Test Loss: 1.442 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.287292718887329
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.580 Test Loss: 1.430 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579986).  Saving model ...
Epoch: 21 cost time: 5.76488733291626
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.414 Vali Acc: 0.587 Test Loss: 1.414 Test Acc: 0.587
Validation loss decreased (-0.579986 --> -0.586653).  Saving model ...
Epoch: 22 cost time: 5.664646863937378
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.593 Test Loss: 1.400 Test Acc: 0.593
Validation loss decreased (-0.586653 --> -0.593319).  Saving model ...
Epoch: 23 cost time: 5.375368118286133
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.597 Test Loss: 1.399 Test Acc: 0.597
Validation loss decreased (-0.593319 --> -0.596653).  Saving model ...
Epoch: 24 cost time: 5.015389680862427
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.603 Test Loss: 1.374 Test Acc: 0.603
Validation loss decreased (-0.596653 --> -0.603320).  Saving model ...
Epoch: 25 cost time: 5.0316081047058105
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.603 Test Loss: 1.370 Test Acc: 0.603
Validation loss decreased (-0.603320 --> -0.603320).  Saving model ...
Epoch: 26 cost time: 5.411011695861816
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.362 Vali Acc: 0.607 Test Loss: 1.362 Test Acc: 0.607
Validation loss decreased (-0.603320 --> -0.606653).  Saving model ...
Epoch: 27 cost time: 6.038067817687988
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.617 Test Loss: 1.351 Test Acc: 0.617
Validation loss decreased (-0.606653 --> -0.616653).  Saving model ...
Epoch: 28 cost time: 5.786696672439575
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.610 Test Loss: 1.348 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.469382047653198
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.623 Test Loss: 1.336 Test Acc: 0.623
Validation loss decreased (-0.616653 --> -0.623320).  Saving model ...
Epoch: 30 cost time: 4.532712697982788
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.630 Test Loss: 1.329 Test Acc: 0.630
Validation loss decreased (-0.623320 --> -0.629987).  Saving model ...
Epoch: 31 cost time: 4.518234491348267
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.637 Test Loss: 1.322 Test Acc: 0.637
Validation loss decreased (-0.629987 --> -0.636653).  Saving model ...
Epoch: 32 cost time: 5.462875127792358
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.643 Test Loss: 1.315 Test Acc: 0.643
Validation loss decreased (-0.636653 --> -0.643320).  Saving model ...
Epoch: 33 cost time: 5.341022253036499
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.306 Vali Acc: 0.650 Test Loss: 1.306 Test Acc: 0.650
Validation loss decreased (-0.643320 --> -0.649987).  Saving model ...
Epoch: 34 cost time: 5.674081087112427
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.298 Vali Acc: 0.653 Test Loss: 1.298 Test Acc: 0.653
Validation loss decreased (-0.649987 --> -0.653320).  Saving model ...
Epoch: 35 cost time: 5.670785903930664
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.287 Vali Acc: 0.653 Test Loss: 1.287 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 36 cost time: 5.561039447784424
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.657 Test Loss: 1.281 Test Acc: 0.657
Validation loss decreased (-0.653320 --> -0.656654).  Saving model ...
Epoch: 37 cost time: 5.556668281555176
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.278 Vali Acc: 0.663 Test Loss: 1.278 Test Acc: 0.663
Validation loss decreased (-0.656654 --> -0.663321).  Saving model ...
Epoch: 38 cost time: 5.355286598205566
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.278 Vali Acc: 0.667 Test Loss: 1.278 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666654).  Saving model ...
Epoch: 39 cost time: 5.267087697982788
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.670 Test Loss: 1.268 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669987).  Saving model ...
Epoch: 40 cost time: 5.751095533370972
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.677 Test Loss: 1.266 Test Acc: 0.677
Validation loss decreased (-0.669987 --> -0.676654).  Saving model ...
Epoch: 41 cost time: 5.632831335067749
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.269 Vali Acc: 0.673 Test Loss: 1.269 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.12695574760437
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.677 Test Loss: 1.265 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 43 cost time: 5.131730794906616
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.680 Test Loss: 1.262 Test Acc: 0.680
Validation loss decreased (-0.676654 --> -0.679987).  Saving model ...
Epoch: 44 cost time: 5.061812877655029
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.677 Test Loss: 1.263 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.040889739990234
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.261 Vali Acc: 0.677 Test Loss: 1.261 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 4.459249973297119
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.690 Test Loss: 1.257 Test Acc: 0.690
Validation loss decreased (-0.679987 --> -0.689987).  Saving model ...
Epoch: 47 cost time: 5.447407007217407
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.690 Test Loss: 1.252 Test Acc: 0.690
Validation loss decreased (-0.689987 --> -0.689987).  Saving model ...
Epoch: 48 cost time: 5.642195463180542
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.687 Test Loss: 1.247 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.406377792358398
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.693 Test Loss: 1.247 Test Acc: 0.693
Validation loss decreased (-0.689987 --> -0.693321).  Saving model ...
Epoch: 50 cost time: 5.0971832275390625
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.693 Test Loss: 1.246 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 51 cost time: 5.390296220779419
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.690 Test Loss: 1.245 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.211857318878174
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.690 Test Loss: 1.245 Test Acc: 0.690
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 5.574045896530151
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.690 Test Loss: 1.245 Test Acc: 0.690
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 6.372223377227783
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.690 Test Loss: 1.242 Test Acc: 0.690
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 5.851208209991455
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.690 Test Loss: 1.239 Test Acc: 0.690
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 5.852637529373169
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.693 Test Loss: 1.236 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 57 cost time: 5.505823850631714
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.690 Test Loss: 1.234 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 5.831278085708618
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.693 Test Loss: 1.235 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 59 cost time: 5.866907835006714
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.693 Test Loss: 1.233 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 60 cost time: 5.88637900352478
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.697 Test Loss: 1.234 Test Acc: 0.697
Validation loss decreased (-0.693321 --> -0.696654).  Saving model ...
Epoch: 61 cost time: 5.6176745891571045
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.697 Test Loss: 1.234 Test Acc: 0.697
Validation loss decreased (-0.696654 --> -0.696654).  Saving model ...
Epoch: 62 cost time: 6.00762677192688
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.697 Test Loss: 1.236 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 5.1269145011901855
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.697 Test Loss: 1.231 Test Acc: 0.697
Validation loss decreased (-0.696654 --> -0.696654).  Saving model ...
Epoch: 64 cost time: 5.594677209854126
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.693 Test Loss: 1.233 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 5.4681947231292725
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.697 Test Loss: 1.233 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 4.986986398696899
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.693 Test Loss: 1.233 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 5.723055839538574
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.693 Test Loss: 1.231 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 6.13547945022583
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.693 Test Loss: 1.232 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 6.214522838592529
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.693 Test Loss: 1.229 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 5.432999134063721
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.693 Test Loss: 1.226 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 5.7788238525390625
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.700 Test Loss: 1.223 Test Acc: 0.700
Validation loss decreased (-0.696654 --> -0.699988).  Saving model ...
Epoch: 72 cost time: 5.3190412521362305
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.700 Test Loss: 1.223 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 73 cost time: 5.597484111785889
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.700 Test Loss: 1.222 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 74 cost time: 5.708853244781494
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.697 Test Loss: 1.220 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 5.423970460891724
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.697 Test Loss: 1.218 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 5.519690036773682
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.700 Test Loss: 1.216 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 77 cost time: 5.206942796707153
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.697 Test Loss: 1.217 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.019836187362671
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.697 Test Loss: 1.218 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 5.512430429458618
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.697 Test Loss: 1.218 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 5.254733562469482
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.703 Test Loss: 1.215 Test Acc: 0.703
Validation loss decreased (-0.699988 --> -0.703321).  Saving model ...
Epoch: 81 cost time: 5.752755403518677
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.703 Test Loss: 1.211 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 82 cost time: 5.628332853317261
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.703 Test Loss: 1.209 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 83 cost time: 5.366111755371094
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.703 Test Loss: 1.209 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 84 cost time: 5.285083055496216
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.703 Test Loss: 1.213 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 5.669475078582764
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.707 Test Loss: 1.217 Test Acc: 0.707
Validation loss decreased (-0.703321 --> -0.706655).  Saving model ...
Epoch: 86 cost time: 5.3013596534729
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.707 Test Loss: 1.218 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 5.838175535202026
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.707 Test Loss: 1.218 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 5.6471171379089355
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.707 Test Loss: 1.218 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 5.761272430419922
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.710 Test Loss: 1.218 Test Acc: 0.710
Validation loss decreased (-0.706655 --> -0.709988).  Saving model ...
Epoch: 90 cost time: 4.5718207359313965
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.710 Test Loss: 1.219 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 4.550416946411133
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.710 Test Loss: 1.218 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 4.819961071014404
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.710 Test Loss: 1.218 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 4.83521032333374
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.710 Test Loss: 1.218 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 5.306751012802124
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.710 Test Loss: 1.219 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 5.482120037078857
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.710 Test Loss: 1.219 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 5.729917526245117
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.713 Test Loss: 1.218 Test Acc: 0.713
Validation loss decreased (-0.709988 --> -0.713321).  Saving model ...
Epoch: 97 cost time: 5.400595664978027
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.707 Test Loss: 1.218 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 4.8626015186309814
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.707 Test Loss: 1.217 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 4.827183246612549
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.710 Test Loss: 1.217 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 4.736447811126709
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.710 Test Loss: 1.216 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7133333333333334
model parameter : 3955737
model size : 24.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.726093769073486
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 5.522284269332886
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.124888896942139
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.2056169509887695
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.138855934143066
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.220442295074463
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.030360221862793
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.569772005081177
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.593839645385742
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.851269006729126
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.321583032608032
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 12 cost time: 5.025666952133179
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.910740613937378
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.327890157699585
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.553146600723267
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.533140182495117
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.1657490730285645
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.196939945220947
Epoch: 18, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.549134016036987
Epoch: 19, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 20 cost time: 5.36398720741272
Epoch: 20, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 21 cost time: 5.410691738128662
Epoch: 21, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.214736223220825
Epoch: 22, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.7278969287872314
Epoch: 23, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.969034910202026
Epoch: 24, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.779674291610718
Epoch: 25, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.3446338176727295
Epoch: 26, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.423560857772827
Epoch: 27, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.086588382720947
Epoch: 28, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.685979604721069
Epoch: 29, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.931817531585693
Epoch: 30, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 3955737
model size : 24.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.664703845977783
Epoch: 1, Steps: 18 | Train Loss: 2.849 Vali Loss: 1.638 Vali Acc: 0.767 Test Loss: 1.638 Test Acc: 0.767
Validation loss decreased (inf --> -0.766650).  Saving model ...
Epoch: 2 cost time: 5.786759376525879
Epoch: 2, Steps: 18 | Train Loss: 0.819 Vali Loss: 0.662 Vali Acc: 0.853 Test Loss: 0.662 Test Acc: 0.853
Validation loss decreased (-0.766650 --> -0.853327).  Saving model ...
Epoch: 3 cost time: 5.366225719451904
Epoch: 3, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.492 Vali Acc: 0.857 Test Loss: 0.492 Test Acc: 0.857
Validation loss decreased (-0.853327 --> -0.856662).  Saving model ...
Epoch: 4 cost time: 5.252640962600708
Epoch: 4, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.432 Vali Acc: 0.880 Test Loss: 0.432 Test Acc: 0.880
Validation loss decreased (-0.856662 --> -0.879996).  Saving model ...
Epoch: 5 cost time: 5.588397026062012
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.417 Vali Acc: 0.887 Test Loss: 0.417 Test Acc: 0.887
Validation loss decreased (-0.879996 --> -0.886662).  Saving model ...
Epoch: 6 cost time: 5.384765863418579
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.416 Vali Acc: 0.887 Test Loss: 0.416 Test Acc: 0.887
Validation loss decreased (-0.886662 --> -0.886663).  Saving model ...
Epoch: 7 cost time: 5.922490835189819
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.404 Vali Acc: 0.893 Test Loss: 0.404 Test Acc: 0.893
Validation loss decreased (-0.886663 --> -0.893329).  Saving model ...
Epoch: 8 cost time: 5.742997169494629
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.903 Test Loss: 0.408 Test Acc: 0.903
Validation loss decreased (-0.893329 --> -0.903329).  Saving model ...
Epoch: 9 cost time: 5.999151945114136
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.903 Test Loss: 0.405 Test Acc: 0.903
Validation loss decreased (-0.903329 --> -0.903329).  Saving model ...
Epoch: 10 cost time: 5.107405424118042
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
Validation loss decreased (-0.903329 --> -0.903329).  Saving model ...
Epoch: 11 cost time: 5.389574289321899
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
Validation loss decreased (-0.903329 --> -0.903329).  Saving model ...
Epoch: 12 cost time: 5.509069204330444
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
Validation loss decreased (-0.903329 --> -0.903329).  Saving model ...
Epoch: 13 cost time: 5.447872161865234
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.967410326004028
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.897 Test Loss: 0.396 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.869366645812988
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.499805450439453
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.768847227096558
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.673417091369629
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.778501033782959
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.694088935852051
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.242977142333984
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.108472585678101
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9033333333333333
model parameter : 3759129
model size : 24.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.671281337738037
Epoch: 1, Steps: 18 | Train Loss: 2.968 Vali Loss: 1.974 Vali Acc: 0.717 Test Loss: 1.974 Test Acc: 0.717
Validation loss decreased (inf --> -0.716647).  Saving model ...
Epoch: 2 cost time: 5.4813232421875
Epoch: 2, Steps: 18 | Train Loss: 1.068 Vali Loss: 0.894 Vali Acc: 0.803 Test Loss: 0.894 Test Acc: 0.803
Validation loss decreased (-0.716647 --> -0.803324).  Saving model ...
Epoch: 3 cost time: 5.495701313018799
Epoch: 3, Steps: 18 | Train Loss: 0.214 Vali Loss: 0.714 Vali Acc: 0.817 Test Loss: 0.714 Test Acc: 0.817
Validation loss decreased (-0.803324 --> -0.816660).  Saving model ...
Epoch: 4 cost time: 5.930256366729736
Epoch: 4, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
Validation loss decreased (-0.816660 --> -0.849994).  Saving model ...
Epoch: 5 cost time: 5.905478239059448
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.486217021942139
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.573 Vali Acc: 0.833 Test Loss: 0.573 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.956777095794678
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.538 Vali Acc: 0.863 Test Loss: 0.538 Test Acc: 0.863
Validation loss decreased (-0.849994 --> -0.863328).  Saving model ...
Epoch: 8 cost time: 4.477388620376587
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.863 Test Loss: 0.548 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.009810447692871
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.863 Test Loss: 0.545 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.5735955238342285
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.853 Test Loss: 0.544 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.588317394256592
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.853 Test Loss: 0.545 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.849103212356567
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.853 Test Loss: 0.544 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.5942769050598145
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.853 Test Loss: 0.543 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.210878610610962
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.853 Test Loss: 0.542 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.188665866851807
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.857 Test Loss: 0.540 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.912846565246582
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.853 Test Loss: 0.542 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.904724359512329
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.857 Test Loss: 0.541 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8633333333333333
model parameter : 3759129
model size : 24.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.807408332824707
Epoch: 1, Steps: 18 | Train Loss: 3.090 Vali Loss: 2.391 Vali Acc: 0.543 Test Loss: 2.391 Test Acc: 0.543
Validation loss decreased (inf --> -0.543309).  Saving model ...
Epoch: 2 cost time: 6.345982789993286
Epoch: 2, Steps: 18 | Train Loss: 1.473 Vali Loss: 1.362 Vali Acc: 0.707 Test Loss: 1.362 Test Acc: 0.707
Validation loss decreased (-0.543309 --> -0.706653).  Saving model ...
Epoch: 3 cost time: 5.4368908405303955
Epoch: 3, Steps: 18 | Train Loss: 0.365 Vali Loss: 1.132 Vali Acc: 0.700 Test Loss: 1.132 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.581435203552246
Epoch: 4, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.925 Vali Acc: 0.737 Test Loss: 0.925 Test Acc: 0.737
Validation loss decreased (-0.706653 --> -0.736657).  Saving model ...
Epoch: 5 cost time: 5.509567737579346
Epoch: 5, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.902 Vali Acc: 0.747 Test Loss: 0.902 Test Acc: 0.747
Validation loss decreased (-0.736657 --> -0.746658).  Saving model ...
Epoch: 6 cost time: 5.538161277770996
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.867 Vali Acc: 0.770 Test Loss: 0.867 Test Acc: 0.770
Validation loss decreased (-0.746658 --> -0.769991).  Saving model ...
Epoch: 7 cost time: 5.723718166351318
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.851 Vali Acc: 0.773 Test Loss: 0.851 Test Acc: 0.773
Validation loss decreased (-0.769991 --> -0.773325).  Saving model ...
Epoch: 8 cost time: 5.742387056350708
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.877 Vali Acc: 0.763 Test Loss: 0.877 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.156200647354126
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.840 Vali Acc: 0.773 Test Loss: 0.840 Test Acc: 0.773
Validation loss decreased (-0.773325 --> -0.773325).  Saving model ...
Epoch: 10 cost time: 5.01510763168335
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.767 Test Loss: 0.842 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.45316743850708
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.840 Vali Acc: 0.767 Test Loss: 0.840 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.1048665046691895
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.845 Vali Acc: 0.773 Test Loss: 0.845 Test Acc: 0.773
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.320631265640259
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.847 Vali Acc: 0.770 Test Loss: 0.847 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.247641563415527
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.849 Vali Acc: 0.783 Test Loss: 0.849 Test Acc: 0.783
Validation loss decreased (-0.773325 --> -0.783325).  Saving model ...
Epoch: 15 cost time: 5.89754843711853
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.773 Test Loss: 0.842 Test Acc: 0.773
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.866101026535034
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.773 Test Loss: 0.844 Test Acc: 0.773
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.771588563919067
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.777 Test Loss: 0.844 Test Acc: 0.777
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.88093638420105
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.773 Test Loss: 0.841 Test Acc: 0.773
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.259809732437134
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.773 Test Loss: 0.841 Test Acc: 0.773
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.7428061962127686
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.773 Test Loss: 0.847 Test Acc: 0.773
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.912431240081787
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.770 Test Loss: 0.849 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.459047317504883
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.773 Test Loss: 0.855 Test Acc: 0.773
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.820072650909424
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.777 Test Loss: 0.859 Test Acc: 0.777
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.454512596130371
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.777 Test Loss: 0.855 Test Acc: 0.777
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7833333333333333
model parameter : 3759129
model size : 24.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.088399410247803
Epoch: 1, Steps: 18 | Train Loss: 3.188 Vali Loss: 2.741 Vali Acc: 0.337 Test Loss: 2.741 Test Acc: 0.337
Validation loss decreased (inf --> -0.336639).  Saving model ...
Epoch: 2 cost time: 5.241806268692017
Epoch: 2, Steps: 18 | Train Loss: 1.906 Vali Loss: 1.980 Vali Acc: 0.487 Test Loss: 1.980 Test Acc: 0.487
Validation loss decreased (-0.336639 --> -0.486647).  Saving model ...
Epoch: 3 cost time: 5.527994871139526
Epoch: 3, Steps: 18 | Train Loss: 0.653 Vali Loss: 1.647 Vali Acc: 0.513 Test Loss: 1.647 Test Acc: 0.513
Validation loss decreased (-0.486647 --> -0.513317).  Saving model ...
Epoch: 4 cost time: 5.498644828796387
Epoch: 4, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.426 Vali Acc: 0.550 Test Loss: 1.426 Test Acc: 0.550
Validation loss decreased (-0.513317 --> -0.549986).  Saving model ...
Epoch: 5 cost time: 5.80559515953064
Epoch: 5, Steps: 18 | Train Loss: 0.033 Vali Loss: 1.285 Vali Acc: 0.603 Test Loss: 1.285 Test Acc: 0.603
Validation loss decreased (-0.549986 --> -0.603320).  Saving model ...
Epoch: 6 cost time: 5.482523679733276
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.260 Vali Acc: 0.623 Test Loss: 1.260 Test Acc: 0.623
Validation loss decreased (-0.603320 --> -0.623321).  Saving model ...
Epoch: 7 cost time: 5.237149953842163
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.214 Vali Acc: 0.650 Test Loss: 1.214 Test Acc: 0.650
Validation loss decreased (-0.623321 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 5.202601432800293
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.182 Vali Acc: 0.637 Test Loss: 1.182 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.1996965408325195
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.149 Vali Acc: 0.643 Test Loss: 1.149 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.671425819396973
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.142 Vali Acc: 0.653 Test Loss: 1.142 Test Acc: 0.653
Validation loss decreased (-0.649988 --> -0.653322).  Saving model ...
Epoch: 11 cost time: 5.807701587677002
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.140 Vali Acc: 0.657 Test Loss: 1.140 Test Acc: 0.657
Validation loss decreased (-0.653322 --> -0.656655).  Saving model ...
Epoch: 12 cost time: 6.100203990936279
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.130 Vali Acc: 0.657 Test Loss: 1.130 Test Acc: 0.657
Validation loss decreased (-0.656655 --> -0.656655).  Saving model ...
Epoch: 13 cost time: 5.025409460067749
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.129 Vali Acc: 0.663 Test Loss: 1.129 Test Acc: 0.663
Validation loss decreased (-0.656655 --> -0.663322).  Saving model ...
Epoch: 14 cost time: 4.981077432632446
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.123 Vali Acc: 0.667 Test Loss: 1.123 Test Acc: 0.667
Validation loss decreased (-0.663322 --> -0.666655).  Saving model ...
Epoch: 15 cost time: 5.439408540725708
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.109 Vali Acc: 0.677 Test Loss: 1.109 Test Acc: 0.677
Validation loss decreased (-0.666655 --> -0.676656).  Saving model ...
Epoch: 16 cost time: 5.464922666549683
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.099 Vali Acc: 0.677 Test Loss: 1.099 Test Acc: 0.677
Validation loss decreased (-0.676656 --> -0.676656).  Saving model ...
Epoch: 17 cost time: 5.6734702587127686
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.092 Vali Acc: 0.663 Test Loss: 1.092 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.423853635787964
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.082 Vali Acc: 0.673 Test Loss: 1.082 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.852888107299805
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.074 Vali Acc: 0.687 Test Loss: 1.074 Test Acc: 0.687
Validation loss decreased (-0.676656 --> -0.686656).  Saving model ...
Epoch: 20 cost time: 5.565695762634277
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.693 Test Loss: 1.073 Test Acc: 0.693
Validation loss decreased (-0.686656 --> -0.693323).  Saving model ...
Epoch: 21 cost time: 5.652925729751587
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.690 Test Loss: 1.068 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.768296718597412
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.693 Test Loss: 1.061 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 23 cost time: 5.672659635543823
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.703 Test Loss: 1.060 Test Acc: 0.703
Validation loss decreased (-0.693323 --> -0.703323).  Saving model ...
Epoch: 24 cost time: 5.80670428276062
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.703 Test Loss: 1.052 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 25 cost time: 6.424088954925537
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.710 Test Loss: 1.051 Test Acc: 0.710
Validation loss decreased (-0.703323 --> -0.709989).  Saving model ...
Epoch: 26 cost time: 5.578216552734375
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.717 Test Loss: 1.047 Test Acc: 0.717
Validation loss decreased (-0.709989 --> -0.716656).  Saving model ...
Epoch: 27 cost time: 5.387394189834595
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.723 Test Loss: 1.041 Test Acc: 0.723
Validation loss decreased (-0.716656 --> -0.723323).  Saving model ...
Epoch: 28 cost time: 5.257040977478027
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.723 Test Loss: 1.039 Test Acc: 0.723
Validation loss decreased (-0.723323 --> -0.723323).  Saving model ...
Epoch: 29 cost time: 4.696587324142456
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.723 Test Loss: 1.037 Test Acc: 0.723
Validation loss decreased (-0.723323 --> -0.723323).  Saving model ...
Epoch: 30 cost time: 5.179350137710571
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.723 Test Loss: 1.037 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.713367938995361
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.723 Test Loss: 1.032 Test Acc: 0.723
Validation loss decreased (-0.723323 --> -0.723323).  Saving model ...
Epoch: 32 cost time: 5.826481819152832
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.727 Test Loss: 1.026 Test Acc: 0.727
Validation loss decreased (-0.723323 --> -0.726656).  Saving model ...
Epoch: 33 cost time: 5.326828718185425
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.025 Vali Acc: 0.727 Test Loss: 1.025 Test Acc: 0.727
Validation loss decreased (-0.726656 --> -0.726656).  Saving model ...
Epoch: 34 cost time: 5.49611496925354
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.021 Vali Acc: 0.727 Test Loss: 1.021 Test Acc: 0.727
Validation loss decreased (-0.726656 --> -0.726656).  Saving model ...
Epoch: 35 cost time: 5.535648822784424
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.733 Test Loss: 1.018 Test Acc: 0.733
Validation loss decreased (-0.726656 --> -0.733323).  Saving model ...
Epoch: 36 cost time: 5.795109033584595
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.733 Test Loss: 1.015 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 37 cost time: 5.899348020553589
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.737 Test Loss: 1.014 Test Acc: 0.737
Validation loss decreased (-0.733323 --> -0.736657).  Saving model ...
Epoch: 38 cost time: 5.914034605026245
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.737 Test Loss: 1.014 Test Acc: 0.737
Validation loss decreased (-0.736657 --> -0.736657).  Saving model ...
Epoch: 39 cost time: 6.033127307891846
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.730 Test Loss: 1.019 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.398214101791382
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.733 Test Loss: 1.017 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 5.2763001918792725
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.737 Test Loss: 1.013 Test Acc: 0.737
Validation loss decreased (-0.736657 --> -0.736657).  Saving model ...
Epoch: 42 cost time: 5.245846748352051
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.737 Test Loss: 1.013 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.2069525718688965
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.740 Test Loss: 1.013 Test Acc: 0.740
Validation loss decreased (-0.736657 --> -0.739990).  Saving model ...
Epoch: 44 cost time: 5.581599235534668
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.743 Test Loss: 1.012 Test Acc: 0.743
Validation loss decreased (-0.739990 --> -0.743323).  Saving model ...
Epoch: 45 cost time: 5.5899176597595215
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.740 Test Loss: 1.008 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.454689025878906
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.733 Test Loss: 1.009 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 4.617703914642334
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.743 Test Loss: 1.007 Test Acc: 0.743
Validation loss decreased (-0.743323 --> -0.743323).  Saving model ...
Epoch: 48 cost time: 4.786599159240723
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.743 Test Loss: 1.005 Test Acc: 0.743
Validation loss decreased (-0.743323 --> -0.743323).  Saving model ...
Epoch: 49 cost time: 5.315412998199463
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.743 Test Loss: 1.005 Test Acc: 0.743
Validation loss decreased (-0.743323 --> -0.743323).  Saving model ...
Epoch: 50 cost time: 5.259175062179565
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.740 Test Loss: 1.004 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.761842727661133
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.006 Vali Acc: 0.737 Test Loss: 1.006 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 5.855835676193237
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.743 Test Loss: 1.004 Test Acc: 0.743
Validation loss decreased (-0.743323 --> -0.743323).  Saving model ...
Epoch: 53 cost time: 5.889435291290283
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.743 Test Loss: 1.004 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.58310866355896
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.737 Test Loss: 1.005 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 5.6294121742248535
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.740 Test Loss: 1.005 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 5.864589214324951
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.743 Test Loss: 1.004 Test Acc: 0.743
Validation loss decreased (-0.743323 --> -0.743323).  Saving model ...
Epoch: 57 cost time: 5.562984228134155
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.743 Test Loss: 1.003 Test Acc: 0.743
Validation loss decreased (-0.743323 --> -0.743323).  Saving model ...
Epoch: 58 cost time: 5.861948490142822
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.743 Test Loss: 0.998 Test Acc: 0.743
Validation loss decreased (-0.743323 --> -0.743323).  Saving model ...
Epoch: 59 cost time: 5.091869831085205
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.743 Test Loss: 0.995 Test Acc: 0.743
Validation loss decreased (-0.743323 --> -0.743323).  Saving model ...
Epoch: 60 cost time: 5.3633129596710205
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.747 Test Loss: 0.997 Test Acc: 0.747
Validation loss decreased (-0.743323 --> -0.746657).  Saving model ...
Epoch: 61 cost time: 4.605971574783325
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.747 Test Loss: 0.993 Test Acc: 0.747
Validation loss decreased (-0.746657 --> -0.746657).  Saving model ...
Epoch: 62 cost time: 6.08434796333313
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.743 Test Loss: 0.996 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 5.728413820266724
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.740 Test Loss: 0.997 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 5.417675495147705
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.740 Test Loss: 0.997 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 4.544599533081055
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.740 Test Loss: 0.998 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 4.690090179443359
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.740 Test Loss: 0.999 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 5.357301712036133
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.740 Test Loss: 0.998 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 6.121637344360352
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.740 Test Loss: 0.998 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 5.89443826675415
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.747 Test Loss: 0.997 Test Acc: 0.747
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 5.796521425247192
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.747 Test Loss: 0.997 Test Acc: 0.747
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 5.70246148109436
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.750 Test Loss: 0.995 Test Acc: 0.750
Validation loss decreased (-0.746657 --> -0.749990).  Saving model ...
Epoch: 72 cost time: 5.784137487411499
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.750 Test Loss: 0.996 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 5.375234842300415
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.750 Test Loss: 0.996 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 5.4758079051971436
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.753 Test Loss: 0.995 Test Acc: 0.753
Validation loss decreased (-0.749990 --> -0.753323).  Saving model ...
Epoch: 75 cost time: 5.562168121337891
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.750 Test Loss: 0.995 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 5.5798280239105225
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.750 Test Loss: 0.993 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 5.872859239578247
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.753 Test Loss: 0.995 Test Acc: 0.753
Validation loss decreased (-0.753323 --> -0.753323).  Saving model ...
Epoch: 78 cost time: 5.82676362991333
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.750 Test Loss: 0.996 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 5.354710578918457
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.753 Test Loss: 0.997 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 5.152460098266602
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.753 Test Loss: 0.998 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 4.7344746589660645
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.747 Test Loss: 0.998 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 5.371645927429199
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.750 Test Loss: 0.998 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 5.708444833755493
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.750 Test Loss: 0.999 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 5.805880308151245
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.750 Test Loss: 0.997 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 5.3968892097473145
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.750 Test Loss: 0.999 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 5.439896821975708
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.743 Test Loss: 1.000 Test Acc: 0.743
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 4.932521104812622
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.737 Test Loss: 0.999 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7533333333333333
model parameter : 3759129
model size : 24.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.782765865325928
Epoch: 1, Steps: 18 | Train Loss: 3.189 Vali Loss: 2.909 Vali Acc: 0.177 Test Loss: 2.909 Test Acc: 0.177
Validation loss decreased (inf --> -0.176638).  Saving model ...
Epoch: 2 cost time: 5.721406936645508
Epoch: 2, Steps: 18 | Train Loss: 2.131 Vali Loss: 2.429 Vali Acc: 0.330 Test Loss: 2.429 Test Acc: 0.330
Validation loss decreased (-0.176638 --> -0.329976).  Saving model ...
Epoch: 3 cost time: 5.961098670959473
Epoch: 3, Steps: 18 | Train Loss: 0.922 Vali Loss: 2.194 Vali Acc: 0.387 Test Loss: 2.194 Test Acc: 0.387
Validation loss decreased (-0.329976 --> -0.386645).  Saving model ...
Epoch: 4 cost time: 5.346050500869751
Epoch: 4, Steps: 18 | Train Loss: 0.271 Vali Loss: 1.887 Vali Acc: 0.420 Test Loss: 1.887 Test Acc: 0.420
Validation loss decreased (-0.386645 --> -0.419981).  Saving model ...
Epoch: 5 cost time: 5.7415931224823
Epoch: 5, Steps: 18 | Train Loss: 0.057 Vali Loss: 1.811 Vali Acc: 0.427 Test Loss: 1.811 Test Acc: 0.427
Validation loss decreased (-0.419981 --> -0.426649).  Saving model ...
Epoch: 6 cost time: 5.338606119155884
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.867 Vali Acc: 0.413 Test Loss: 1.867 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.117638111114502
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.598 Vali Acc: 0.487 Test Loss: 1.598 Test Acc: 0.487
Validation loss decreased (-0.426649 --> -0.486651).  Saving model ...
Epoch: 8 cost time: 5.655420303344727
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.577 Vali Acc: 0.497 Test Loss: 1.577 Test Acc: 0.497
Validation loss decreased (-0.486651 --> -0.496651).  Saving model ...
Epoch: 9 cost time: 5.832169055938721
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.535 Vali Acc: 0.520 Test Loss: 1.535 Test Acc: 0.520
Validation loss decreased (-0.496651 --> -0.519985).  Saving model ...
Epoch: 10 cost time: 5.65487265586853
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.507 Vali Acc: 0.530 Test Loss: 1.507 Test Acc: 0.530
Validation loss decreased (-0.519985 --> -0.529985).  Saving model ...
Epoch: 11 cost time: 5.459901809692383
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.506 Vali Acc: 0.527 Test Loss: 1.506 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.140872001647949
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.486 Vali Acc: 0.543 Test Loss: 1.486 Test Acc: 0.543
Validation loss decreased (-0.529985 --> -0.543318).  Saving model ...
Epoch: 13 cost time: 5.403623342514038
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.466 Vali Acc: 0.553 Test Loss: 1.466 Test Acc: 0.553
Validation loss decreased (-0.543318 --> -0.553319).  Saving model ...
Epoch: 14 cost time: 5.240163803100586
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.454 Vali Acc: 0.557 Test Loss: 1.454 Test Acc: 0.557
Validation loss decreased (-0.553319 --> -0.556652).  Saving model ...
Epoch: 15 cost time: 5.778615474700928
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.434 Vali Acc: 0.573 Test Loss: 1.434 Test Acc: 0.573
Validation loss decreased (-0.556652 --> -0.573319).  Saving model ...
Epoch: 16 cost time: 5.768864393234253
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.416 Vali Acc: 0.580 Test Loss: 1.416 Test Acc: 0.580
Validation loss decreased (-0.573319 --> -0.579986).  Saving model ...
Epoch: 17 cost time: 5.692195892333984
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.408 Vali Acc: 0.593 Test Loss: 1.408 Test Acc: 0.593
Validation loss decreased (-0.579986 --> -0.593319).  Saving model ...
Epoch: 18 cost time: 5.143910884857178
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.391 Vali Acc: 0.597 Test Loss: 1.391 Test Acc: 0.597
Validation loss decreased (-0.593319 --> -0.596653).  Saving model ...
Epoch: 19 cost time: 4.7003796100616455
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.617 Test Loss: 1.386 Test Acc: 0.617
Validation loss decreased (-0.596653 --> -0.616653).  Saving model ...
Epoch: 20 cost time: 4.645071983337402
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.382 Vali Acc: 0.613 Test Loss: 1.382 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.640854358673096
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.380 Vali Acc: 0.617 Test Loss: 1.380 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616653).  Saving model ...
Epoch: 22 cost time: 5.954547166824341
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.623 Test Loss: 1.372 Test Acc: 0.623
Validation loss decreased (-0.616653 --> -0.623320).  Saving model ...
Epoch: 23 cost time: 5.871885061264038
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.362 Vali Acc: 0.623 Test Loss: 1.362 Test Acc: 0.623
Validation loss decreased (-0.623320 --> -0.623320).  Saving model ...
Epoch: 24 cost time: 5.509254217147827
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.623 Test Loss: 1.354 Test Acc: 0.623
Validation loss decreased (-0.623320 --> -0.623320).  Saving model ...
Epoch: 25 cost time: 5.336796522140503
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.617 Test Loss: 1.348 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.7382965087890625
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.630 Test Loss: 1.338 Test Acc: 0.630
Validation loss decreased (-0.623320 --> -0.629987).  Saving model ...
Epoch: 27 cost time: 5.696804761886597
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.633 Test Loss: 1.333 Test Acc: 0.633
Validation loss decreased (-0.629987 --> -0.633320).  Saving model ...
Epoch: 28 cost time: 5.706628322601318
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.633 Test Loss: 1.329 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 29 cost time: 5.939276456832886
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.633 Test Loss: 1.323 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 30 cost time: 5.961791515350342
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.637 Test Loss: 1.319 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.636653).  Saving model ...
Epoch: 31 cost time: 5.171299695968628
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.311 Vali Acc: 0.637 Test Loss: 1.311 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636654).  Saving model ...
Epoch: 32 cost time: 5.411284446716309
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.305 Vali Acc: 0.643 Test Loss: 1.305 Test Acc: 0.643
Validation loss decreased (-0.636654 --> -0.643320).  Saving model ...
Epoch: 33 cost time: 5.2648704051971436
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.301 Vali Acc: 0.640 Test Loss: 1.301 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.200426340103149
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.640 Test Loss: 1.295 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.641174077987671
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.291 Vali Acc: 0.640 Test Loss: 1.291 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.486564636230469
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.284 Vali Acc: 0.653 Test Loss: 1.284 Test Acc: 0.653
Validation loss decreased (-0.643320 --> -0.653320).  Saving model ...
Epoch: 37 cost time: 5.790894508361816
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.278 Vali Acc: 0.657 Test Loss: 1.278 Test Acc: 0.657
Validation loss decreased (-0.653320 --> -0.656654).  Saving model ...
Epoch: 38 cost time: 5.236726522445679
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.657 Test Loss: 1.274 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656654).  Saving model ...
Epoch: 39 cost time: 5.432661771774292
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.663 Test Loss: 1.274 Test Acc: 0.663
Validation loss decreased (-0.656654 --> -0.663321).  Saving model ...
Epoch: 40 cost time: 5.328357219696045
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.667 Test Loss: 1.273 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666654).  Saving model ...
Epoch: 41 cost time: 4.978380441665649
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.272 Vali Acc: 0.667 Test Loss: 1.272 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 42 cost time: 5.778816223144531
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.271 Vali Acc: 0.667 Test Loss: 1.271 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 43 cost time: 6.042119026184082
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.667 Test Loss: 1.266 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 44 cost time: 6.229440450668335
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.667 Test Loss: 1.264 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 45 cost time: 5.558976888656616
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.663 Test Loss: 1.258 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.461893320083618
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.663 Test Loss: 1.257 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.716568470001221
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.667 Test Loss: 1.257 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 48 cost time: 5.747441530227661
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.670 Test Loss: 1.254 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669987).  Saving model ...
Epoch: 49 cost time: 5.783555030822754
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.673 Test Loss: 1.251 Test Acc: 0.673
Validation loss decreased (-0.669987 --> -0.673321).  Saving model ...
Epoch: 50 cost time: 5.627624988555908
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.249 Vali Acc: 0.670 Test Loss: 1.249 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.644797325134277
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.673 Test Loss: 1.251 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 52 cost time: 4.659722566604614
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.677 Test Loss: 1.247 Test Acc: 0.677
Validation loss decreased (-0.673321 --> -0.676654).  Saving model ...
Epoch: 53 cost time: 4.854968547821045
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.673 Test Loss: 1.247 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 4.677173376083374
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.673 Test Loss: 1.248 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 4.793091535568237
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.677 Test Loss: 1.245 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 56 cost time: 5.850435733795166
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.677 Test Loss: 1.242 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 57 cost time: 5.789716482162476
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.677 Test Loss: 1.240 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 58 cost time: 5.864614963531494
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.237 Vali Acc: 0.683 Test Loss: 1.237 Test Acc: 0.683
Validation loss decreased (-0.676654 --> -0.683321).  Saving model ...
Epoch: 59 cost time: 5.273139476776123
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.680 Test Loss: 1.235 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.209470272064209
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.680 Test Loss: 1.235 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 5.729199409484863
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.680 Test Loss: 1.232 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 5.8875412940979
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.237 Vali Acc: 0.693 Test Loss: 1.237 Test Acc: 0.693
Validation loss decreased (-0.683321 --> -0.693321).  Saving model ...
Epoch: 63 cost time: 6.037378549575806
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.680 Test Loss: 1.234 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.873448610305786
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.683 Test Loss: 1.233 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 5.744002819061279
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.683 Test Loss: 1.232 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 5.779003143310547
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.687 Test Loss: 1.233 Test Acc: 0.687
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 5.186388969421387
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.690 Test Loss: 1.231 Test Acc: 0.690
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 5.368839740753174
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.693 Test Loss: 1.229 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 69 cost time: 5.4079270362854
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.697 Test Loss: 1.231 Test Acc: 0.697
Validation loss decreased (-0.693321 --> -0.696654).  Saving model ...
Epoch: 70 cost time: 5.435401439666748
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.697 Test Loss: 1.231 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 5.726649761199951
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.693 Test Loss: 1.229 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 5.496766090393066
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.697 Test Loss: 1.228 Test Acc: 0.697
Validation loss decreased (-0.696654 --> -0.696654).  Saving model ...
Epoch: 73 cost time: 4.793693542480469
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.690 Test Loss: 1.227 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 5.404576063156128
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.693 Test Loss: 1.228 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 5.4226744174957275
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.700 Test Loss: 1.226 Test Acc: 0.700
Validation loss decreased (-0.696654 --> -0.699988).  Saving model ...
Epoch: 76 cost time: 6.109767198562622
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.700 Test Loss: 1.223 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 77 cost time: 5.650218725204468
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.703 Test Loss: 1.223 Test Acc: 0.703
Validation loss decreased (-0.699988 --> -0.703321).  Saving model ...
Epoch: 78 cost time: 5.553800344467163
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.703 Test Loss: 1.221 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 79 cost time: 4.805717706680298
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.700 Test Loss: 1.221 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 5.492016553878784
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.700 Test Loss: 1.220 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 5.724457740783691
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.700 Test Loss: 1.220 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 5.1711039543151855
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.700 Test Loss: 1.218 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 5.745281457901001
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.703 Test Loss: 1.219 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 84 cost time: 5.710683345794678
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.703 Test Loss: 1.217 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 85 cost time: 5.779439449310303
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.700 Test Loss: 1.218 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 4.7468578815460205
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.700 Test Loss: 1.218 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 4.952862977981567
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.700 Test Loss: 1.217 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 5.0739216804504395
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.700 Test Loss: 1.216 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 4.9907145500183105
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.703 Test Loss: 1.216 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 90 cost time: 5.476266860961914
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.707 Test Loss: 1.215 Test Acc: 0.707
Validation loss decreased (-0.703321 --> -0.706655).  Saving model ...
Epoch: 91 cost time: 4.966550350189209
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.707 Test Loss: 1.216 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 5.096896648406982
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.707 Test Loss: 1.216 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 5.597851753234863
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.707 Test Loss: 1.216 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 5.876490592956543
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.707 Test Loss: 1.219 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 6.015643358230591
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.707 Test Loss: 1.218 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 5.778043270111084
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.707 Test Loss: 1.217 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 5.045007705688477
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.707 Test Loss: 1.217 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 5.185061454772949
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.707 Test Loss: 1.216 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 4.868929862976074
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.703 Test Loss: 1.216 Test Acc: 0.703
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 5.053122282028198
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.707 Test Loss: 1.215 Test Acc: 0.707
Validation loss decreased (-0.706655 --> -0.706655).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7066666666666667
model parameter : 3759129
model size : 24.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.950892686843872
Epoch: 1, Steps: 18 | Train Loss: 3.242 Vali Loss: 3.045 Vali Acc: 0.120 Test Loss: 3.045 Test Acc: 0.120
Validation loss decreased (inf --> -0.119970).  Saving model ...
Epoch: 2 cost time: 4.927655458450317
Epoch: 2, Steps: 18 | Train Loss: 2.186 Vali Loss: 2.665 Vali Acc: 0.267 Test Loss: 2.665 Test Acc: 0.267
Validation loss decreased (-0.119970 --> -0.266640).  Saving model ...
Epoch: 3 cost time: 5.065392971038818
Epoch: 3, Steps: 18 | Train Loss: 0.977 Vali Loss: 2.517 Vali Acc: 0.307 Test Loss: 2.517 Test Acc: 0.307
Validation loss decreased (-0.266640 --> -0.306641).  Saving model ...
Epoch: 4 cost time: 5.199458837509155
Epoch: 4, Steps: 18 | Train Loss: 0.272 Vali Loss: 2.244 Vali Acc: 0.290 Test Loss: 2.244 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.636953115463257
Epoch: 5, Steps: 18 | Train Loss: 0.053 Vali Loss: 2.160 Vali Acc: 0.360 Test Loss: 2.160 Test Acc: 0.360
Validation loss decreased (-0.306641 --> -0.359978).  Saving model ...
Epoch: 6 cost time: 5.791290760040283
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 2.067 Vali Acc: 0.413 Test Loss: 2.067 Test Acc: 0.413
Validation loss decreased (-0.359978 --> -0.413313).  Saving model ...
Epoch: 7 cost time: 5.644603490829468
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.958 Vali Acc: 0.443 Test Loss: 1.958 Test Acc: 0.443
Validation loss decreased (-0.413313 --> -0.443314).  Saving model ...
Epoch: 8 cost time: 5.880399942398071
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.911 Vali Acc: 0.453 Test Loss: 1.911 Test Acc: 0.453
Validation loss decreased (-0.443314 --> -0.453314).  Saving model ...
Epoch: 9 cost time: 5.38404655456543
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.827 Vali Acc: 0.490 Test Loss: 1.827 Test Acc: 0.490
Validation loss decreased (-0.453314 --> -0.489982).  Saving model ...
Epoch: 10 cost time: 5.53912615776062
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.816 Vali Acc: 0.490 Test Loss: 1.816 Test Acc: 0.490
Validation loss decreased (-0.489982 --> -0.489982).  Saving model ...
Epoch: 11 cost time: 5.493101596832275
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.790 Vali Acc: 0.503 Test Loss: 1.790 Test Acc: 0.503
Validation loss decreased (-0.489982 --> -0.503315).  Saving model ...
Epoch: 12 cost time: 5.625551462173462
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.769 Vali Acc: 0.527 Test Loss: 1.769 Test Acc: 0.527
Validation loss decreased (-0.503315 --> -0.526649).  Saving model ...
Epoch: 13 cost time: 5.763955354690552
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.747 Vali Acc: 0.533 Test Loss: 1.747 Test Acc: 0.533
Validation loss decreased (-0.526649 --> -0.533316).  Saving model ...
Epoch: 14 cost time: 5.7999231815338135
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.725 Vali Acc: 0.543 Test Loss: 1.725 Test Acc: 0.543
Validation loss decreased (-0.533316 --> -0.543316).  Saving model ...
Epoch: 15 cost time: 4.787748336791992
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.699 Vali Acc: 0.550 Test Loss: 1.699 Test Acc: 0.550
Validation loss decreased (-0.543316 --> -0.549983).  Saving model ...
Epoch: 16 cost time: 4.716005086898804
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.682 Vali Acc: 0.567 Test Loss: 1.682 Test Acc: 0.567
Validation loss decreased (-0.549983 --> -0.566650).  Saving model ...
Epoch: 17 cost time: 4.574318885803223
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.667 Vali Acc: 0.567 Test Loss: 1.667 Test Acc: 0.567
Validation loss decreased (-0.566650 --> -0.566650).  Saving model ...
Epoch: 18 cost time: 4.724165439605713
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.652 Vali Acc: 0.557 Test Loss: 1.652 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.519157886505127
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.639 Vali Acc: 0.557 Test Loss: 1.639 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.79170298576355
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.553 Test Loss: 1.630 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.539213180541992
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.618 Vali Acc: 0.570 Test Loss: 1.618 Test Acc: 0.570
Validation loss decreased (-0.566650 --> -0.569984).  Saving model ...
Epoch: 22 cost time: 5.5612640380859375
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.570 Test Loss: 1.614 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 23 cost time: 5.6417999267578125
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.570 Test Loss: 1.604 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 24 cost time: 5.365947961807251
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.595 Vali Acc: 0.580 Test Loss: 1.595 Test Acc: 0.580
Validation loss decreased (-0.569984 --> -0.579984).  Saving model ...
Epoch: 25 cost time: 5.576125144958496
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.580 Test Loss: 1.580 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579984).  Saving model ...
Epoch: 26 cost time: 5.631301164627075
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.577 Test Loss: 1.573 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.08905291557312
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.573 Test Loss: 1.566 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.209819793701172
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.563 Vali Acc: 0.580 Test Loss: 1.563 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579984).  Saving model ...
Epoch: 29 cost time: 5.1422247886657715
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.587 Test Loss: 1.556 Test Acc: 0.587
Validation loss decreased (-0.579984 --> -0.586651).  Saving model ...
Epoch: 30 cost time: 4.781225204467773
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.603 Test Loss: 1.549 Test Acc: 0.603
Validation loss decreased (-0.586651 --> -0.603318).  Saving model ...
Epoch: 31 cost time: 4.663196563720703
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.600 Test Loss: 1.540 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.899465560913086
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.607 Test Loss: 1.533 Test Acc: 0.607
Validation loss decreased (-0.603318 --> -0.606651).  Saving model ...
Epoch: 33 cost time: 5.465055704116821
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.603 Test Loss: 1.527 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.889364004135132
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.597 Test Loss: 1.519 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.570758104324341
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.607 Test Loss: 1.516 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606652).  Saving model ...
Epoch: 36 cost time: 4.872022867202759
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.610 Test Loss: 1.509 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609985).  Saving model ...
Epoch: 37 cost time: 5.182832956314087
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.617 Test Loss: 1.505 Test Acc: 0.617
Validation loss decreased (-0.609985 --> -0.616652).  Saving model ...
Epoch: 38 cost time: 5.083064794540405
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.617 Test Loss: 1.504 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 39 cost time: 5.3962721824646
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.502 Vali Acc: 0.623 Test Loss: 1.502 Test Acc: 0.623
Validation loss decreased (-0.616652 --> -0.623318).  Saving model ...
Epoch: 40 cost time: 6.006366014480591
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.498 Vali Acc: 0.620 Test Loss: 1.498 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.636563301086426
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.627 Test Loss: 1.493 Test Acc: 0.627
Validation loss decreased (-0.623318 --> -0.626652).  Saving model ...
Epoch: 42 cost time: 5.841118335723877
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.627 Test Loss: 1.490 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 43 cost time: 6.238435983657837
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.633 Test Loss: 1.488 Test Acc: 0.633
Validation loss decreased (-0.626652 --> -0.633318).  Saving model ...
Epoch: 44 cost time: 5.422536611557007
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.637 Test Loss: 1.485 Test Acc: 0.637
Validation loss decreased (-0.633318 --> -0.636652).  Saving model ...
Epoch: 45 cost time: 5.571257829666138
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.637 Test Loss: 1.481 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 46 cost time: 5.749161720275879
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.643 Test Loss: 1.482 Test Acc: 0.643
Validation loss decreased (-0.636652 --> -0.643319).  Saving model ...
Epoch: 47 cost time: 5.864763259887695
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.643 Test Loss: 1.482 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.519592046737671
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.643 Test Loss: 1.478 Test Acc: 0.643
Validation loss decreased (-0.643319 --> -0.643319).  Saving model ...
Epoch: 49 cost time: 4.828063249588013
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.643 Test Loss: 1.471 Test Acc: 0.643
Validation loss decreased (-0.643319 --> -0.643319).  Saving model ...
Epoch: 50 cost time: 4.470287084579468
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.647 Test Loss: 1.467 Test Acc: 0.647
Validation loss decreased (-0.643319 --> -0.646652).  Saving model ...
Epoch: 51 cost time: 5.016220331192017
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.647 Test Loss: 1.468 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 4.571479558944702
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.647 Test Loss: 1.466 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 53 cost time: 4.688574552536011
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.647 Test Loss: 1.468 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.758469343185425
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.465 Vali Acc: 0.640 Test Loss: 1.465 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 5.774849891662598
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.647 Test Loss: 1.460 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 56 cost time: 5.269818544387817
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.647 Test Loss: 1.455 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 57 cost time: 5.181727409362793
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.650 Test Loss: 1.451 Test Acc: 0.650
Validation loss decreased (-0.646652 --> -0.649985).  Saving model ...
Epoch: 58 cost time: 4.989957332611084
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.650 Test Loss: 1.444 Test Acc: 0.650
Validation loss decreased (-0.649985 --> -0.649986).  Saving model ...
Epoch: 59 cost time: 4.881145477294922
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.650 Test Loss: 1.442 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 60 cost time: 5.857455253601074
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.640 Test Loss: 1.442 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 5.651752948760986
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.647 Test Loss: 1.444 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 5.864690780639648
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.647 Test Loss: 1.442 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 5.3938586711883545
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.657 Test Loss: 1.439 Test Acc: 0.657
Validation loss decreased (-0.649986 --> -0.656652).  Saving model ...
Epoch: 64 cost time: 5.208495378494263
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.663 Test Loss: 1.438 Test Acc: 0.663
Validation loss decreased (-0.656652 --> -0.663319).  Saving model ...
Epoch: 65 cost time: 5.1908464431762695
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.663 Test Loss: 1.438 Test Acc: 0.663
Validation loss decreased (-0.663319 --> -0.663319).  Saving model ...
Epoch: 66 cost time: 4.769796133041382
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.663 Test Loss: 1.438 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 5.910564184188843
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.663 Test Loss: 1.436 Test Acc: 0.663
Validation loss decreased (-0.663319 --> -0.663319).  Saving model ...
Epoch: 68 cost time: 5.668199062347412
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.660 Test Loss: 1.432 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 5.520840406417847
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.663 Test Loss: 1.432 Test Acc: 0.663
Validation loss decreased (-0.663319 --> -0.663319).  Saving model ...
Epoch: 70 cost time: 4.848121643066406
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.667 Test Loss: 1.428 Test Acc: 0.667
Validation loss decreased (-0.663319 --> -0.666652).  Saving model ...
Epoch: 71 cost time: 4.8526246547698975
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.667 Test Loss: 1.426 Test Acc: 0.667
Validation loss decreased (-0.666652 --> -0.666652).  Saving model ...
Epoch: 72 cost time: 4.64773416519165
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.663 Test Loss: 1.422 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 4.8629491329193115
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.421 Vali Acc: 0.663 Test Loss: 1.421 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 5.697604417800903
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.663 Test Loss: 1.420 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 5.966785907745361
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.663 Test Loss: 1.419 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 5.398526191711426
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.667 Test Loss: 1.416 Test Acc: 0.667
Validation loss decreased (-0.666652 --> -0.666653).  Saving model ...
Epoch: 77 cost time: 5.322873115539551
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.667 Test Loss: 1.415 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
Epoch: 78 cost time: 5.456096649169922
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.667 Test Loss: 1.414 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
Epoch: 79 cost time: 5.32635760307312
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.667 Test Loss: 1.414 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 5.077799558639526
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.670 Test Loss: 1.412 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.669986).  Saving model ...
Epoch: 81 cost time: 6.147704124450684
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.667 Test Loss: 1.411 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 5.561105012893677
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.667 Test Loss: 1.410 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 5.684820175170898
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.670 Test Loss: 1.412 Test Acc: 0.670
Validation loss decreased (-0.669986 --> -0.669986).  Saving model ...
Epoch: 84 cost time: 4.383072137832642
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.667 Test Loss: 1.410 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 4.622400999069214
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.670 Test Loss: 1.410 Test Acc: 0.670
Validation loss decreased (-0.669986 --> -0.669986).  Saving model ...
Epoch: 86 cost time: 5.343947887420654
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.670 Test Loss: 1.410 Test Acc: 0.670
Validation loss decreased (-0.669986 --> -0.669986).  Saving model ...
Epoch: 87 cost time: 5.534340858459473
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.670 Test Loss: 1.408 Test Acc: 0.670
Validation loss decreased (-0.669986 --> -0.669986).  Saving model ...
Epoch: 88 cost time: 5.9088475704193115
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.670 Test Loss: 1.406 Test Acc: 0.670
Validation loss decreased (-0.669986 --> -0.669986).  Saving model ...
Epoch: 89 cost time: 5.583142995834351
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.670 Test Loss: 1.406 Test Acc: 0.670
Validation loss decreased (-0.669986 --> -0.669986).  Saving model ...
Epoch: 90 cost time: 5.344508171081543
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.673 Test Loss: 1.406 Test Acc: 0.673
Validation loss decreased (-0.669986 --> -0.673319).  Saving model ...
Epoch: 91 cost time: 5.376759052276611
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.673 Test Loss: 1.405 Test Acc: 0.673
Validation loss decreased (-0.673319 --> -0.673319).  Saving model ...
Epoch: 92 cost time: 5.4766905307769775
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.673 Test Loss: 1.406 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 5.727556467056274
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.673 Test Loss: 1.404 Test Acc: 0.673
Validation loss decreased (-0.673319 --> -0.673319).  Saving model ...
Epoch: 94 cost time: 6.150893211364746
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.673 Test Loss: 1.407 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 5.645152807235718
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.673 Test Loss: 1.408 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 5.48492693901062
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.673 Test Loss: 1.409 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 4.636323928833008
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.673 Test Loss: 1.408 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 4.347835302352905
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.673 Test Loss: 1.407 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 5.041704893112183
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.677 Test Loss: 1.404 Test Acc: 0.677
Validation loss decreased (-0.673319 --> -0.676653).  Saving model ...
Epoch: 100 cost time: 4.540605068206787
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.677 Test Loss: 1.403 Test Acc: 0.677
Validation loss decreased (-0.676653 --> -0.676653).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6766666666666666
model parameter : 3759129
model size : 24.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.012130975723267
Epoch: 1, Steps: 18 | Train Loss: 3.226 Vali Loss: 3.127 Vali Acc: 0.063 Test Loss: 3.127 Test Acc: 0.063
Validation loss decreased (inf --> -0.063302).  Saving model ...
Epoch: 2 cost time: 5.92825984954834
Epoch: 2, Steps: 18 | Train Loss: 2.260 Vali Loss: 2.864 Vali Acc: 0.153 Test Loss: 2.864 Test Acc: 0.153
Validation loss decreased (-0.063302 --> -0.153305).  Saving model ...
Epoch: 3 cost time: 5.67978310585022
Epoch: 3, Steps: 18 | Train Loss: 1.038 Vali Loss: 2.846 Vali Acc: 0.177 Test Loss: 2.846 Test Acc: 0.177
Validation loss decreased (-0.153305 --> -0.176638).  Saving model ...
Epoch: 4 cost time: 5.634646654129028
Epoch: 4, Steps: 18 | Train Loss: 0.308 Vali Loss: 2.653 Vali Acc: 0.230 Test Loss: 2.653 Test Acc: 0.230
Validation loss decreased (-0.176638 --> -0.229973).  Saving model ...
Epoch: 5 cost time: 5.636596202850342
Epoch: 5, Steps: 18 | Train Loss: 0.066 Vali Loss: 2.652 Vali Acc: 0.230 Test Loss: 2.652 Test Acc: 0.230
Validation loss decreased (-0.229973 --> -0.229973).  Saving model ...
Epoch: 6 cost time: 5.8856201171875
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 2.527 Vali Acc: 0.267 Test Loss: 2.527 Test Acc: 0.267
Validation loss decreased (-0.229973 --> -0.266641).  Saving model ...
Epoch: 7 cost time: 5.503351449966431
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.344 Vali Acc: 0.320 Test Loss: 2.344 Test Acc: 0.320
Validation loss decreased (-0.266641 --> -0.319977).  Saving model ...
Epoch: 8 cost time: 5.232403516769409
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.283 Vali Acc: 0.323 Test Loss: 2.283 Test Acc: 0.323
Validation loss decreased (-0.319977 --> -0.323311).  Saving model ...
Epoch: 9 cost time: 5.200474500656128
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 2.233 Vali Acc: 0.340 Test Loss: 2.233 Test Acc: 0.340
Validation loss decreased (-0.323311 --> -0.339978).  Saving model ...
Epoch: 10 cost time: 5.927851676940918
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.202 Vali Acc: 0.350 Test Loss: 2.202 Test Acc: 0.350
Validation loss decreased (-0.339978 --> -0.349978).  Saving model ...
Epoch: 11 cost time: 5.89676833152771
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.155 Vali Acc: 0.377 Test Loss: 2.155 Test Acc: 0.377
Validation loss decreased (-0.349978 --> -0.376645).  Saving model ...
Epoch: 12 cost time: 5.552931070327759
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.110 Vali Acc: 0.393 Test Loss: 2.110 Test Acc: 0.393
Validation loss decreased (-0.376645 --> -0.393312).  Saving model ...
Epoch: 13 cost time: 5.319847822189331
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.070 Vali Acc: 0.397 Test Loss: 2.070 Test Acc: 0.397
Validation loss decreased (-0.393312 --> -0.396646).  Saving model ...
Epoch: 14 cost time: 5.058885335922241
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.026 Vali Acc: 0.420 Test Loss: 2.026 Test Acc: 0.420
Validation loss decreased (-0.396646 --> -0.419980).  Saving model ...
Epoch: 15 cost time: 5.401723146438599
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.992 Vali Acc: 0.437 Test Loss: 1.992 Test Acc: 0.437
Validation loss decreased (-0.419980 --> -0.436647).  Saving model ...
Epoch: 16 cost time: 5.5284647941589355
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.967 Vali Acc: 0.453 Test Loss: 1.967 Test Acc: 0.453
Validation loss decreased (-0.436647 --> -0.453314).  Saving model ...
Epoch: 17 cost time: 5.731317043304443
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.936 Vali Acc: 0.457 Test Loss: 1.936 Test Acc: 0.457
Validation loss decreased (-0.453314 --> -0.456647).  Saving model ...
Epoch: 18 cost time: 5.77098536491394
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.926 Vali Acc: 0.457 Test Loss: 1.926 Test Acc: 0.457
Validation loss decreased (-0.456647 --> -0.456647).  Saving model ...
Epoch: 19 cost time: 5.6522886753082275
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.907 Vali Acc: 0.457 Test Loss: 1.907 Test Acc: 0.457
Validation loss decreased (-0.456647 --> -0.456648).  Saving model ...
Epoch: 20 cost time: 5.441540718078613
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.876 Vali Acc: 0.480 Test Loss: 1.876 Test Acc: 0.480
Validation loss decreased (-0.456648 --> -0.479981).  Saving model ...
Epoch: 21 cost time: 5.7199766635894775
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.861 Vali Acc: 0.480 Test Loss: 1.861 Test Acc: 0.480
Validation loss decreased (-0.479981 --> -0.479981).  Saving model ...
Epoch: 22 cost time: 5.930875778198242
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.848 Vali Acc: 0.487 Test Loss: 1.848 Test Acc: 0.487
Validation loss decreased (-0.479981 --> -0.486648).  Saving model ...
Epoch: 23 cost time: 5.725340127944946
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.830 Vali Acc: 0.497 Test Loss: 1.830 Test Acc: 0.497
Validation loss decreased (-0.486648 --> -0.496648).  Saving model ...
Epoch: 24 cost time: 5.673186540603638
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.809 Vali Acc: 0.500 Test Loss: 1.809 Test Acc: 0.500
Validation loss decreased (-0.496648 --> -0.499982).  Saving model ...
Epoch: 25 cost time: 5.593144416809082
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.790 Vali Acc: 0.510 Test Loss: 1.790 Test Acc: 0.510
Validation loss decreased (-0.499982 --> -0.509982).  Saving model ...
Epoch: 26 cost time: 5.030454635620117
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.773 Vali Acc: 0.517 Test Loss: 1.773 Test Acc: 0.517
Validation loss decreased (-0.509982 --> -0.516649).  Saving model ...
Epoch: 27 cost time: 4.342677354812622
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.762 Vali Acc: 0.523 Test Loss: 1.762 Test Acc: 0.523
Validation loss decreased (-0.516649 --> -0.523316).  Saving model ...
Epoch: 28 cost time: 4.53459906578064
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.746 Vali Acc: 0.533 Test Loss: 1.746 Test Acc: 0.533
Validation loss decreased (-0.523316 --> -0.533316).  Saving model ...
Epoch: 29 cost time: 4.374492645263672
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.736 Vali Acc: 0.537 Test Loss: 1.736 Test Acc: 0.537
Validation loss decreased (-0.533316 --> -0.536649).  Saving model ...
Epoch: 30 cost time: 4.79492449760437
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.540 Test Loss: 1.731 Test Acc: 0.540
Validation loss decreased (-0.536649 --> -0.539983).  Saving model ...
Epoch: 31 cost time: 5.786661624908447
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.723 Vali Acc: 0.543 Test Loss: 1.723 Test Acc: 0.543
Validation loss decreased (-0.539983 --> -0.543316).  Saving model ...
Epoch: 32 cost time: 5.645827531814575
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.714 Vali Acc: 0.540 Test Loss: 1.714 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.339767932891846
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.547 Test Loss: 1.704 Test Acc: 0.547
Validation loss decreased (-0.543316 --> -0.546650).  Saving model ...
Epoch: 34 cost time: 5.330094575881958
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.695 Vali Acc: 0.553 Test Loss: 1.695 Test Acc: 0.553
Validation loss decreased (-0.546650 --> -0.553316).  Saving model ...
Epoch: 35 cost time: 5.7463366985321045
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.553 Test Loss: 1.685 Test Acc: 0.553
Validation loss decreased (-0.553316 --> -0.553316).  Saving model ...
Epoch: 36 cost time: 5.654386758804321
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.671 Vali Acc: 0.563 Test Loss: 1.671 Test Acc: 0.563
Validation loss decreased (-0.553316 --> -0.563317).  Saving model ...
Epoch: 37 cost time: 6.269478797912598
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.664 Vali Acc: 0.567 Test Loss: 1.664 Test Acc: 0.567
Validation loss decreased (-0.563317 --> -0.566650).  Saving model ...
Epoch: 38 cost time: 5.875151634216309
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.666 Vali Acc: 0.567 Test Loss: 1.666 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.558245420455933
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.657 Vali Acc: 0.567 Test Loss: 1.657 Test Acc: 0.567
Validation loss decreased (-0.566650 --> -0.566650).  Saving model ...
Epoch: 40 cost time: 4.885096073150635
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.648 Vali Acc: 0.577 Test Loss: 1.648 Test Acc: 0.577
Validation loss decreased (-0.566650 --> -0.576650).  Saving model ...
Epoch: 41 cost time: 4.706889867782593
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.577 Test Loss: 1.639 Test Acc: 0.577
Validation loss decreased (-0.576650 --> -0.576650).  Saving model ...
Epoch: 42 cost time: 4.7662882804870605
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.580 Test Loss: 1.633 Test Acc: 0.580
Validation loss decreased (-0.576650 --> -0.579984).  Saving model ...
Epoch: 43 cost time: 4.725545883178711
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.634 Vali Acc: 0.577 Test Loss: 1.634 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 5.946479558944702
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.580 Test Loss: 1.625 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579984).  Saving model ...
Epoch: 45 cost time: 5.759986639022827
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.573 Test Loss: 1.624 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.779987812042236
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.577 Test Loss: 1.619 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 4.916567802429199
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.577 Test Loss: 1.612 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 5.708866119384766
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.583 Test Loss: 1.606 Test Acc: 0.583
Validation loss decreased (-0.579984 --> -0.583317).  Saving model ...
Epoch: 49 cost time: 5.4099626541137695
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.580 Test Loss: 1.602 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.672494411468506
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.583 Test Loss: 1.597 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 51 cost time: 5.514038324356079
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.583 Test Loss: 1.592 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 52 cost time: 5.31354832649231
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.587 Test Loss: 1.586 Test Acc: 0.587
Validation loss decreased (-0.583317 --> -0.586651).  Saving model ...
Epoch: 53 cost time: 5.5740697383880615
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.593 Test Loss: 1.581 Test Acc: 0.593
Validation loss decreased (-0.586651 --> -0.593318).  Saving model ...
Epoch: 54 cost time: 5.588294267654419
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.597 Test Loss: 1.573 Test Acc: 0.597
Validation loss decreased (-0.593318 --> -0.596651).  Saving model ...
Epoch: 55 cost time: 5.118301153182983
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.597 Test Loss: 1.573 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 4.701509237289429
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.568 Vali Acc: 0.600 Test Loss: 1.568 Test Acc: 0.600
Validation loss decreased (-0.596651 --> -0.599984).  Saving model ...
Epoch: 57 cost time: 5.707106590270996
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.603 Test Loss: 1.561 Test Acc: 0.603
Validation loss decreased (-0.599984 --> -0.603318).  Saving model ...
Epoch: 58 cost time: 6.266009569168091
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.607 Test Loss: 1.558 Test Acc: 0.607
Validation loss decreased (-0.603318 --> -0.606651).  Saving model ...
Epoch: 59 cost time: 5.978886127471924
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.603 Test Loss: 1.556 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.245843410491943
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.610 Test Loss: 1.554 Test Acc: 0.610
Validation loss decreased (-0.606651 --> -0.609984).  Saving model ...
Epoch: 61 cost time: 5.225287199020386
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.548 Vali Acc: 0.607 Test Loss: 1.548 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 4.751352071762085
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.542 Vali Acc: 0.607 Test Loss: 1.542 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 5.279267311096191
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.543 Vali Acc: 0.603 Test Loss: 1.543 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 5.941720485687256
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.610 Test Loss: 1.539 Test Acc: 0.610
Validation loss decreased (-0.609984 --> -0.609985).  Saving model ...
Epoch: 65 cost time: 5.658645391464233
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.537 Vali Acc: 0.610 Test Loss: 1.537 Test Acc: 0.610
Validation loss decreased (-0.609985 --> -0.609985).  Saving model ...
Epoch: 66 cost time: 5.709104299545288
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.613 Test Loss: 1.531 Test Acc: 0.613
Validation loss decreased (-0.609985 --> -0.613318).  Saving model ...
Epoch: 67 cost time: 5.8553595542907715
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.613 Test Loss: 1.531 Test Acc: 0.613
Validation loss decreased (-0.613318 --> -0.613318).  Saving model ...
Epoch: 68 cost time: 5.874371528625488
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.620 Test Loss: 1.532 Test Acc: 0.620
Validation loss decreased (-0.613318 --> -0.619985).  Saving model ...
Epoch: 69 cost time: 5.7232725620269775
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.623 Test Loss: 1.531 Test Acc: 0.623
Validation loss decreased (-0.619985 --> -0.623318).  Saving model ...
Epoch: 70 cost time: 5.138973712921143
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.620 Test Loss: 1.526 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 5.804056406021118
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.620 Test Loss: 1.520 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 5.5829691886901855
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.620 Test Loss: 1.516 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 5.089225769042969
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.623 Test Loss: 1.513 Test Acc: 0.623
Validation loss decreased (-0.623318 --> -0.623318).  Saving model ...
Epoch: 74 cost time: 4.530151128768921
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.623 Test Loss: 1.510 Test Acc: 0.623
Validation loss decreased (-0.623318 --> -0.623318).  Saving model ...
Epoch: 75 cost time: 4.46097993850708
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.623 Test Loss: 1.507 Test Acc: 0.623
Validation loss decreased (-0.623318 --> -0.623318).  Saving model ...
Epoch: 76 cost time: 4.405612945556641
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.623 Test Loss: 1.507 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 4.320527791976929
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.623 Test Loss: 1.505 Test Acc: 0.623
Validation loss decreased (-0.623318 --> -0.623318).  Saving model ...
Epoch: 78 cost time: 6.086590051651001
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.627 Test Loss: 1.501 Test Acc: 0.627
Validation loss decreased (-0.623318 --> -0.626652).  Saving model ...
Epoch: 79 cost time: 5.909091234207153
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.630 Test Loss: 1.500 Test Acc: 0.630
Validation loss decreased (-0.626652 --> -0.629985).  Saving model ...
Epoch: 80 cost time: 5.65903377532959
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.633 Test Loss: 1.500 Test Acc: 0.633
Validation loss decreased (-0.629985 --> -0.633318).  Saving model ...
Epoch: 81 cost time: 5.339278221130371
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.630 Test Loss: 1.500 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 5.674156904220581
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.627 Test Loss: 1.500 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 5.917832374572754
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.633 Test Loss: 1.499 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633318).  Saving model ...
Epoch: 84 cost time: 5.4079749584198
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.633 Test Loss: 1.496 Test Acc: 0.633
Validation loss decreased (-0.633318 --> -0.633318).  Saving model ...
Epoch: 85 cost time: 5.592497825622559
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.637 Test Loss: 1.493 Test Acc: 0.637
Validation loss decreased (-0.633318 --> -0.636652).  Saving model ...
Epoch: 86 cost time: 6.170994758605957
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.637 Test Loss: 1.492 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 87 cost time: 5.130298376083374
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.633 Test Loss: 1.492 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 4.852771997451782
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.633 Test Loss: 1.492 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 5.014349460601807
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.491 Vali Acc: 0.633 Test Loss: 1.491 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 4.3630290031433105
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.633 Test Loss: 1.494 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 5.157991170883179
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.640 Test Loss: 1.493 Test Acc: 0.640
Validation loss decreased (-0.636652 --> -0.639985).  Saving model ...
Epoch: 92 cost time: 5.121235609054565
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.643 Test Loss: 1.492 Test Acc: 0.643
Validation loss decreased (-0.639985 --> -0.643318).  Saving model ...
Epoch: 93 cost time: 4.870903253555298
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.647 Test Loss: 1.490 Test Acc: 0.647
Validation loss decreased (-0.643318 --> -0.646652).  Saving model ...
Epoch: 94 cost time: 5.397799253463745
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.647 Test Loss: 1.489 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 95 cost time: 5.721230745315552
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.647 Test Loss: 1.489 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 96 cost time: 5.74620246887207
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.647 Test Loss: 1.486 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 97 cost time: 5.4333930015563965
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.643 Test Loss: 1.485 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 5.802196502685547
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.487 Vali Acc: 0.647 Test Loss: 1.487 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 5.273917198181152
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.647 Test Loss: 1.485 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 100 cost time: 5.030755043029785
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.647 Test Loss: 1.486 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6466666666666666
model parameter : 3759129
model size : 24.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.930739164352417
Epoch: 1, Steps: 18 | Train Loss: 3.200 Vali Loss: 3.121 Vali Acc: 0.077 Test Loss: 3.121 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 5.612268686294556
Epoch: 2, Steps: 18 | Train Loss: 2.388 Vali Loss: 2.832 Vali Acc: 0.173 Test Loss: 2.832 Test Acc: 0.173
Validation loss decreased (-0.076635 --> -0.173305).  Saving model ...
Epoch: 3 cost time: 4.929606914520264
Epoch: 3, Steps: 18 | Train Loss: 1.290 Vali Loss: 2.782 Vali Acc: 0.180 Test Loss: 2.782 Test Acc: 0.180
Validation loss decreased (-0.173305 --> -0.179972).  Saving model ...
Epoch: 4 cost time: 4.367253065109253
Epoch: 4, Steps: 18 | Train Loss: 0.464 Vali Loss: 2.435 Vali Acc: 0.237 Test Loss: 2.435 Test Acc: 0.237
Validation loss decreased (-0.179972 --> -0.236642).  Saving model ...
Epoch: 5 cost time: 4.434967279434204
Epoch: 5, Steps: 18 | Train Loss: 0.119 Vali Loss: 2.599 Vali Acc: 0.230 Test Loss: 2.599 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.816538095474243
Epoch: 6, Steps: 18 | Train Loss: 0.030 Vali Loss: 2.235 Vali Acc: 0.397 Test Loss: 2.235 Test Acc: 0.397
Validation loss decreased (-0.236642 --> -0.396644).  Saving model ...
Epoch: 7 cost time: 5.87046217918396
Epoch: 7, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.896 Vali Acc: 0.407 Test Loss: 1.896 Test Acc: 0.407
Validation loss decreased (-0.396644 --> -0.406648).  Saving model ...
Epoch: 8 cost time: 5.710595607757568
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.907 Vali Acc: 0.437 Test Loss: 1.907 Test Acc: 0.437
Validation loss decreased (-0.406648 --> -0.436648).  Saving model ...
Epoch: 9 cost time: 5.925033807754517
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.895 Vali Acc: 0.433 Test Loss: 1.895 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.3101887702941895
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.759 Vali Acc: 0.487 Test Loss: 1.759 Test Acc: 0.487
Validation loss decreased (-0.436648 --> -0.486649).  Saving model ...
Epoch: 11 cost time: 5.567290544509888
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.727 Vali Acc: 0.497 Test Loss: 1.727 Test Acc: 0.497
Validation loss decreased (-0.486649 --> -0.496649).  Saving model ...
Epoch: 12 cost time: 5.919050931930542
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.704 Vali Acc: 0.510 Test Loss: 1.704 Test Acc: 0.510
Validation loss decreased (-0.496649 --> -0.509983).  Saving model ...
Epoch: 13 cost time: 5.760442495346069
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.657 Vali Acc: 0.513 Test Loss: 1.657 Test Acc: 0.513
Validation loss decreased (-0.509983 --> -0.513317).  Saving model ...
Epoch: 14 cost time: 5.609644412994385
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.643 Vali Acc: 0.517 Test Loss: 1.643 Test Acc: 0.517
Validation loss decreased (-0.513317 --> -0.516650).  Saving model ...
Epoch: 15 cost time: 5.616888761520386
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.623 Vali Acc: 0.540 Test Loss: 1.623 Test Acc: 0.540
Validation loss decreased (-0.516650 --> -0.539984).  Saving model ...
Epoch: 16 cost time: 5.263027906417847
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.615 Vali Acc: 0.547 Test Loss: 1.615 Test Acc: 0.547
Validation loss decreased (-0.539984 --> -0.546651).  Saving model ...
Epoch: 17 cost time: 5.4560346603393555
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.593 Vali Acc: 0.537 Test Loss: 1.593 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.1511924266815186
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.583 Vali Acc: 0.553 Test Loss: 1.583 Test Acc: 0.553
Validation loss decreased (-0.546651 --> -0.553317).  Saving model ...
Epoch: 19 cost time: 4.849043369293213
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.573 Vali Acc: 0.560 Test Loss: 1.573 Test Acc: 0.560
Validation loss decreased (-0.553317 --> -0.559984).  Saving model ...
Epoch: 20 cost time: 6.224323034286499
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.533 Vali Acc: 0.560 Test Loss: 1.533 Test Acc: 0.560
Validation loss decreased (-0.559984 --> -0.559985).  Saving model ...
Epoch: 21 cost time: 5.869051933288574
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.516 Vali Acc: 0.570 Test Loss: 1.516 Test Acc: 0.570
Validation loss decreased (-0.559985 --> -0.569985).  Saving model ...
Epoch: 22 cost time: 5.732256889343262
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.514 Vali Acc: 0.557 Test Loss: 1.514 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.3613622188568115
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.500 Vali Acc: 0.563 Test Loss: 1.500 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.605813503265381
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.570 Test Loss: 1.497 Test Acc: 0.570
Validation loss decreased (-0.569985 --> -0.569985).  Saving model ...
Epoch: 25 cost time: 5.668736934661865
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.577 Test Loss: 1.484 Test Acc: 0.577
Validation loss decreased (-0.569985 --> -0.576652).  Saving model ...
Epoch: 26 cost time: 6.150334596633911
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.580 Test Loss: 1.462 Test Acc: 0.580
Validation loss decreased (-0.576652 --> -0.579985).  Saving model ...
Epoch: 27 cost time: 5.92445182800293
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.597 Test Loss: 1.440 Test Acc: 0.597
Validation loss decreased (-0.579985 --> -0.596652).  Saving model ...
Epoch: 28 cost time: 5.770017623901367
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.603 Test Loss: 1.432 Test Acc: 0.603
Validation loss decreased (-0.596652 --> -0.603319).  Saving model ...
Epoch: 29 cost time: 5.544658184051514
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.603 Test Loss: 1.435 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.378012657165527
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.603 Test Loss: 1.432 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.588356971740723
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.607 Test Loss: 1.423 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606652).  Saving model ...
Epoch: 32 cost time: 5.0959999561309814
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.613 Test Loss: 1.418 Test Acc: 0.613
Validation loss decreased (-0.606652 --> -0.613319).  Saving model ...
Epoch: 33 cost time: 5.769800901412964
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.623 Test Loss: 1.416 Test Acc: 0.623
Validation loss decreased (-0.613319 --> -0.623319).  Saving model ...
Epoch: 34 cost time: 5.649578809738159
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.620 Test Loss: 1.404 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.595914125442505
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.620 Test Loss: 1.397 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.825928688049316
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.617 Test Loss: 1.383 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 5.778330326080322
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.620 Test Loss: 1.370 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 5.535534381866455
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.630 Test Loss: 1.364 Test Acc: 0.630
Validation loss decreased (-0.623319 --> -0.629986).  Saving model ...
Epoch: 39 cost time: 5.448613166809082
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.630 Test Loss: 1.359 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 40 cost time: 5.94911789894104
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.623 Test Loss: 1.360 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.9366068840026855
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.627 Test Loss: 1.358 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.906419515609741
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.633 Test Loss: 1.352 Test Acc: 0.633
Validation loss decreased (-0.629986 --> -0.633320).  Saving model ...
Epoch: 43 cost time: 5.207079648971558
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.640 Test Loss: 1.352 Test Acc: 0.640
Validation loss decreased (-0.633320 --> -0.639986).  Saving model ...
Epoch: 44 cost time: 5.579722881317139
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.637 Test Loss: 1.337 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.136623859405518
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.334 Vali Acc: 0.640 Test Loss: 1.334 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639987).  Saving model ...
Epoch: 46 cost time: 5.850034952163696
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.647 Test Loss: 1.329 Test Acc: 0.647
Validation loss decreased (-0.639987 --> -0.646653).  Saving model ...
Epoch: 47 cost time: 5.7469117641448975
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.650 Test Loss: 1.326 Test Acc: 0.650
Validation loss decreased (-0.646653 --> -0.649987).  Saving model ...
Epoch: 48 cost time: 5.984183311462402
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.650 Test Loss: 1.322 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 49 cost time: 5.1433446407318115
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.653 Test Loss: 1.318 Test Acc: 0.653
Validation loss decreased (-0.649987 --> -0.653320).  Saving model ...
Epoch: 50 cost time: 4.864649772644043
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.647 Test Loss: 1.323 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.489435195922852
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.650 Test Loss: 1.321 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 5.589766979217529
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.650 Test Loss: 1.314 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 5.7692015171051025
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.653 Test Loss: 1.312 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 54 cost time: 6.235442399978638
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.307 Vali Acc: 0.660 Test Loss: 1.307 Test Acc: 0.660
Validation loss decreased (-0.653320 --> -0.659987).  Saving model ...
Epoch: 55 cost time: 5.754192352294922
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.306 Vali Acc: 0.653 Test Loss: 1.306 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 5.244444131851196
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.300 Vali Acc: 0.660 Test Loss: 1.300 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
Epoch: 57 cost time: 5.591668367385864
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.294 Vali Acc: 0.663 Test Loss: 1.294 Test Acc: 0.663
Validation loss decreased (-0.659987 --> -0.663320).  Saving model ...
Epoch: 58 cost time: 5.450901508331299
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.290 Vali Acc: 0.663 Test Loss: 1.290 Test Acc: 0.663
Validation loss decreased (-0.663320 --> -0.663320).  Saving model ...
Epoch: 59 cost time: 5.405139684677124
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.283 Vali Acc: 0.663 Test Loss: 1.283 Test Acc: 0.663
Validation loss decreased (-0.663320 --> -0.663321).  Saving model ...
Epoch: 60 cost time: 6.237887859344482
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.667 Test Loss: 1.276 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666654).  Saving model ...
Epoch: 61 cost time: 5.531611204147339
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.667 Test Loss: 1.276 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 62 cost time: 5.70437216758728
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.670 Test Loss: 1.275 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669987).  Saving model ...
Epoch: 63 cost time: 5.352968454360962
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.280 Vali Acc: 0.667 Test Loss: 1.280 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.440342426300049
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.279 Vali Acc: 0.670 Test Loss: 1.279 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 4.9458396434783936
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.680 Test Loss: 1.275 Test Acc: 0.680
Validation loss decreased (-0.669987 --> -0.679987).  Saving model ...
Epoch: 66 cost time: 5.006953477859497
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.677 Test Loss: 1.273 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 5.681914567947388
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.677 Test Loss: 1.273 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 5.9703991413116455
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.673 Test Loss: 1.276 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 5.611156940460205
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.680 Test Loss: 1.276 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 5.483369827270508
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.680 Test Loss: 1.273 Test Acc: 0.680
Validation loss decreased (-0.679987 --> -0.679987).  Saving model ...
Epoch: 71 cost time: 5.691798448562622
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.680 Test Loss: 1.268 Test Acc: 0.680
Validation loss decreased (-0.679987 --> -0.679987).  Saving model ...
Epoch: 72 cost time: 5.774834394454956
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.683 Test Loss: 1.267 Test Acc: 0.683
Validation loss decreased (-0.679987 --> -0.683321).  Saving model ...
Epoch: 73 cost time: 5.939493179321289
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.680 Test Loss: 1.265 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 5.5535972118377686
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.683 Test Loss: 1.265 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 75 cost time: 6.252299785614014
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.677 Test Loss: 1.255 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 5.344348430633545
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.680 Test Loss: 1.254 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 5.575787544250488
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.680 Test Loss: 1.252 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 5.520252704620361
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.677 Test Loss: 1.252 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 4.665318250656128
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.670 Test Loss: 1.254 Test Acc: 0.670
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 4.7929065227508545
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.670 Test Loss: 1.253 Test Acc: 0.670
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 5.026787042617798
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.673 Test Loss: 1.254 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 5.347330808639526
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.680 Test Loss: 1.253 Test Acc: 0.680
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 5.54774808883667
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.677 Test Loss: 1.252 Test Acc: 0.677
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 5.954555034637451
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.680 Test Loss: 1.250 Test Acc: 0.680
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6833333333333333
model parameter : 3759129
model size : 24.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.644602537155151
Epoch: 1, Steps: 18 | Train Loss: 3.284 Vali Loss: 3.163 Vali Acc: 0.067 Test Loss: 3.163 Test Acc: 0.067
Validation loss decreased (inf --> -0.066635).  Saving model ...
Epoch: 2 cost time: 5.44921875
Epoch: 2, Steps: 18 | Train Loss: 2.440 Vali Loss: 2.903 Vali Acc: 0.143 Test Loss: 2.903 Test Acc: 0.143
Validation loss decreased (-0.066635 --> -0.143304).  Saving model ...
Epoch: 3 cost time: 5.223849534988403
Epoch: 3, Steps: 18 | Train Loss: 1.355 Vali Loss: 2.796 Vali Acc: 0.187 Test Loss: 2.796 Test Acc: 0.187
Validation loss decreased (-0.143304 --> -0.186639).  Saving model ...
Epoch: 4 cost time: 5.058575868606567
Epoch: 4, Steps: 18 | Train Loss: 0.473 Vali Loss: 2.404 Vali Acc: 0.237 Test Loss: 2.404 Test Acc: 0.237
Validation loss decreased (-0.186639 --> -0.236643).  Saving model ...
Epoch: 5 cost time: 6.085804462432861
Epoch: 5, Steps: 18 | Train Loss: 0.122 Vali Loss: 2.473 Vali Acc: 0.240 Test Loss: 2.473 Test Acc: 0.240
Validation loss decreased (-0.236643 --> -0.239975).  Saving model ...
Epoch: 6 cost time: 5.68625545501709
Epoch: 6, Steps: 18 | Train Loss: 0.027 Vali Loss: 2.049 Vali Acc: 0.377 Test Loss: 2.049 Test Acc: 0.377
Validation loss decreased (-0.239975 --> -0.376646).  Saving model ...
Epoch: 7 cost time: 5.638120412826538
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.764 Vali Acc: 0.443 Test Loss: 1.764 Test Acc: 0.443
Validation loss decreased (-0.376646 --> -0.443316).  Saving model ...
Epoch: 8 cost time: 5.186120271682739
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.839 Vali Acc: 0.453 Test Loss: 1.839 Test Acc: 0.453
Validation loss decreased (-0.443316 --> -0.453315).  Saving model ...
Epoch: 9 cost time: 4.999436378479004
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.852 Vali Acc: 0.437 Test Loss: 1.852 Test Acc: 0.437
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.542664289474487
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.669 Vali Acc: 0.477 Test Loss: 1.669 Test Acc: 0.477
Validation loss decreased (-0.453315 --> -0.476650).  Saving model ...
Epoch: 11 cost time: 4.62844181060791
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.615 Vali Acc: 0.493 Test Loss: 1.615 Test Acc: 0.493
Validation loss decreased (-0.476650 --> -0.493317).  Saving model ...
Epoch: 12 cost time: 5.927469968795776
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.602 Vali Acc: 0.513 Test Loss: 1.602 Test Acc: 0.513
Validation loss decreased (-0.493317 --> -0.513317).  Saving model ...
Epoch: 13 cost time: 5.831406116485596
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.568 Vali Acc: 0.520 Test Loss: 1.568 Test Acc: 0.520
Validation loss decreased (-0.513317 --> -0.519984).  Saving model ...
Epoch: 14 cost time: 5.596578598022461
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.540 Test Loss: 1.551 Test Acc: 0.540
Validation loss decreased (-0.519984 --> -0.539984).  Saving model ...
Epoch: 15 cost time: 5.142037868499756
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.527 Vali Acc: 0.537 Test Loss: 1.527 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.74825119972229
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.514 Vali Acc: 0.547 Test Loss: 1.514 Test Acc: 0.547
Validation loss decreased (-0.539984 --> -0.546652).  Saving model ...
Epoch: 17 cost time: 5.613404273986816
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.480 Vali Acc: 0.567 Test Loss: 1.480 Test Acc: 0.567
Validation loss decreased (-0.546652 --> -0.566652).  Saving model ...
Epoch: 18 cost time: 5.478922605514526
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.469 Vali Acc: 0.567 Test Loss: 1.469 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566652).  Saving model ...
Epoch: 19 cost time: 5.801568031311035
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.455 Vali Acc: 0.577 Test Loss: 1.455 Test Acc: 0.577
Validation loss decreased (-0.566652 --> -0.576652).  Saving model ...
Epoch: 20 cost time: 5.86476469039917
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.423 Vali Acc: 0.587 Test Loss: 1.423 Test Acc: 0.587
Validation loss decreased (-0.576652 --> -0.586652).  Saving model ...
Epoch: 21 cost time: 5.1033265590667725
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.412 Vali Acc: 0.593 Test Loss: 1.412 Test Acc: 0.593
Validation loss decreased (-0.586652 --> -0.593319).  Saving model ...
Epoch: 22 cost time: 5.534355401992798
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.603 Test Loss: 1.400 Test Acc: 0.603
Validation loss decreased (-0.593319 --> -0.603319).  Saving model ...
Epoch: 23 cost time: 5.572289228439331
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.603 Test Loss: 1.381 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603320).  Saving model ...
Epoch: 24 cost time: 5.3215508460998535
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.607 Test Loss: 1.374 Test Acc: 0.607
Validation loss decreased (-0.603320 --> -0.606653).  Saving model ...
Epoch: 25 cost time: 6.28570818901062
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.613 Test Loss: 1.363 Test Acc: 0.613
Validation loss decreased (-0.606653 --> -0.613320).  Saving model ...
Epoch: 26 cost time: 5.622442960739136
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.620 Test Loss: 1.351 Test Acc: 0.620
Validation loss decreased (-0.613320 --> -0.619986).  Saving model ...
Epoch: 27 cost time: 6.183715343475342
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.630 Test Loss: 1.339 Test Acc: 0.630
Validation loss decreased (-0.619986 --> -0.629987).  Saving model ...
Epoch: 28 cost time: 5.0757715702056885
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.630 Test Loss: 1.327 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 29 cost time: 5.26435112953186
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.643 Test Loss: 1.323 Test Acc: 0.643
Validation loss decreased (-0.629987 --> -0.643320).  Saving model ...
Epoch: 30 cost time: 5.735826253890991
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.643 Test Loss: 1.319 Test Acc: 0.643
Validation loss decreased (-0.643320 --> -0.643320).  Saving model ...
Epoch: 31 cost time: 5.467308282852173
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.637 Test Loss: 1.315 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.666321039199829
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.643 Test Loss: 1.312 Test Acc: 0.643
Validation loss decreased (-0.643320 --> -0.643320).  Saving model ...
Epoch: 33 cost time: 5.72310209274292
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.309 Vali Acc: 0.650 Test Loss: 1.309 Test Acc: 0.650
Validation loss decreased (-0.643320 --> -0.649987).  Saving model ...
Epoch: 34 cost time: 5.826471567153931
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.647 Test Loss: 1.297 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.364562273025513
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.650 Test Loss: 1.285 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 36 cost time: 4.832279920578003
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.653 Test Loss: 1.273 Test Acc: 0.653
Validation loss decreased (-0.649987 --> -0.653321).  Saving model ...
Epoch: 37 cost time: 5.25221586227417
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.269 Vali Acc: 0.643 Test Loss: 1.269 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.591869115829468
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.653 Test Loss: 1.264 Test Acc: 0.653
Validation loss decreased (-0.653321 --> -0.653321).  Saving model ...
Epoch: 39 cost time: 5.6302618980407715
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.663 Test Loss: 1.257 Test Acc: 0.663
Validation loss decreased (-0.653321 --> -0.663321).  Saving model ...
Epoch: 40 cost time: 5.71227502822876
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.660 Test Loss: 1.253 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.158879041671753
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.249 Vali Acc: 0.653 Test Loss: 1.249 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.508639574050903
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.244 Vali Acc: 0.660 Test Loss: 1.244 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 5.35581111907959
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.660 Test Loss: 1.247 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 5.383975505828857
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.657 Test Loss: 1.239 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 6.050300359725952
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.663 Test Loss: 1.241 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 46 cost time: 5.572927474975586
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.667 Test Loss: 1.238 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666654).  Saving model ...
Epoch: 47 cost time: 5.339375257492065
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.237 Vali Acc: 0.667 Test Loss: 1.237 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 48 cost time: 5.487938642501831
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.667 Test Loss: 1.236 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 49 cost time: 4.963573217391968
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.667 Test Loss: 1.231 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 50 cost time: 5.365349054336548
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.673 Test Loss: 1.231 Test Acc: 0.673
Validation loss decreased (-0.666654 --> -0.673321).  Saving model ...
Epoch: 51 cost time: 5.148434400558472
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.673 Test Loss: 1.228 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 52 cost time: 5.7192699909210205
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.670 Test Loss: 1.224 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 5.594204664230347
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.673 Test Loss: 1.225 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 54 cost time: 5.808694839477539
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.677 Test Loss: 1.222 Test Acc: 0.677
Validation loss decreased (-0.673321 --> -0.676654).  Saving model ...
Epoch: 55 cost time: 4.726730585098267
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.680 Test Loss: 1.222 Test Acc: 0.680
Validation loss decreased (-0.676654 --> -0.679988).  Saving model ...
Epoch: 56 cost time: 5.4494030475616455
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.687 Test Loss: 1.219 Test Acc: 0.687
Validation loss decreased (-0.679988 --> -0.686654).  Saving model ...
Epoch: 57 cost time: 4.922645092010498
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.690 Test Loss: 1.215 Test Acc: 0.690
Validation loss decreased (-0.686654 --> -0.689988).  Saving model ...
Epoch: 58 cost time: 5.1951518058776855
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.687 Test Loss: 1.214 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 5.51773738861084
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.690 Test Loss: 1.211 Test Acc: 0.690
Validation loss decreased (-0.689988 --> -0.689988).  Saving model ...
Epoch: 60 cost time: 5.620541095733643
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.703 Test Loss: 1.210 Test Acc: 0.703
Validation loss decreased (-0.689988 --> -0.703321).  Saving model ...
Epoch: 61 cost time: 5.862454891204834
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.700 Test Loss: 1.207 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 5.061866521835327
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.710 Test Loss: 1.206 Test Acc: 0.710
Validation loss decreased (-0.703321 --> -0.709988).  Saving model ...
Epoch: 63 cost time: 5.020654201507568
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.707 Test Loss: 1.205 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.457227945327759
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.713 Test Loss: 1.204 Test Acc: 0.713
Validation loss decreased (-0.709988 --> -0.713321).  Saving model ...
Epoch: 65 cost time: 5.733694791793823
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.200 Vali Acc: 0.713 Test Loss: 1.200 Test Acc: 0.713
Validation loss decreased (-0.713321 --> -0.713321).  Saving model ...
Epoch: 66 cost time: 5.471491813659668
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.197 Vali Acc: 0.713 Test Loss: 1.197 Test Acc: 0.713
Validation loss decreased (-0.713321 --> -0.713321).  Saving model ...
Epoch: 67 cost time: 5.558942079544067
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.713 Test Loss: 1.198 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 5.159861087799072
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.707 Test Loss: 1.199 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 5.206952333450317
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.710 Test Loss: 1.199 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 5.161666631698608
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.717 Test Loss: 1.194 Test Acc: 0.717
Validation loss decreased (-0.713321 --> -0.716655).  Saving model ...
Epoch: 71 cost time: 5.571904182434082
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.191 Vali Acc: 0.720 Test Loss: 1.191 Test Acc: 0.720
Validation loss decreased (-0.716655 --> -0.719988).  Saving model ...
Epoch: 72 cost time: 6.02568507194519
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.720 Test Loss: 1.189 Test Acc: 0.720
Validation loss decreased (-0.719988 --> -0.719988).  Saving model ...
Epoch: 73 cost time: 5.585772752761841
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.723 Test Loss: 1.190 Test Acc: 0.723
Validation loss decreased (-0.719988 --> -0.723321).  Saving model ...
Epoch: 74 cost time: 5.779230117797852
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.727 Test Loss: 1.189 Test Acc: 0.727
Validation loss decreased (-0.723321 --> -0.726655).  Saving model ...
Epoch: 75 cost time: 5.219170808792114
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.727 Test Loss: 1.183 Test Acc: 0.727
Validation loss decreased (-0.726655 --> -0.726655).  Saving model ...
Epoch: 76 cost time: 5.409794330596924
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.730 Test Loss: 1.183 Test Acc: 0.730
Validation loss decreased (-0.726655 --> -0.729988).  Saving model ...
Epoch: 77 cost time: 4.858518600463867
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.727 Test Loss: 1.181 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.417764186859131
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.733 Test Loss: 1.181 Test Acc: 0.733
Validation loss decreased (-0.729988 --> -0.733322).  Saving model ...
Epoch: 79 cost time: 5.819096326828003
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.733 Test Loss: 1.182 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 6.0312371253967285
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.730 Test Loss: 1.183 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 5.464788436889648
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.727 Test Loss: 1.185 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 4.944718599319458
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.186 Vali Acc: 0.730 Test Loss: 1.186 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 5.266118049621582
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.186 Vali Acc: 0.727 Test Loss: 1.186 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 5.131972789764404
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.727 Test Loss: 1.184 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 5.933944940567017
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.737 Test Loss: 1.183 Test Acc: 0.737
Validation loss decreased (-0.733322 --> -0.736655).  Saving model ...
Epoch: 86 cost time: 5.962905406951904
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.733 Test Loss: 1.184 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 5.4978086948394775
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.733 Test Loss: 1.183 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 5.036646842956543
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.737 Test Loss: 1.181 Test Acc: 0.737
Validation loss decreased (-0.736655 --> -0.736655).  Saving model ...
Epoch: 89 cost time: 5.230499267578125
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.737 Test Loss: 1.182 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 5.577568769454956
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.733 Test Loss: 1.185 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 5.287046194076538
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.733 Test Loss: 1.185 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 5.6792731285095215
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.737 Test Loss: 1.184 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 5.599527835845947
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.740 Test Loss: 1.184 Test Acc: 0.740
Validation loss decreased (-0.736655 --> -0.739988).  Saving model ...
Epoch: 94 cost time: 5.855121850967407
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.733 Test Loss: 1.182 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 5.367460250854492
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.733 Test Loss: 1.184 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 5.167539834976196
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.733 Test Loss: 1.184 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 5.54913067817688
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.737 Test Loss: 1.184 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 5.257350921630859
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.737 Test Loss: 1.184 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 5.527985095977783
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.733 Test Loss: 1.185 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 5.614763975143433
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.730 Test Loss: 1.185 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.74
model parameter : 3759129
model size : 24.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.455246686935425
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 5.199807643890381
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 3 cost time: 5.348376750946045
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 4 cost time: 6.13727593421936
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.719037294387817
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.5352208614349365
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.590136528015137
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.555359840393066
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.288150072097778
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.47716498374939
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.763225793838501
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.696704149246216
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.573553085327148
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 14 cost time: 5.503599405288696
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.669013500213623
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.264369487762451
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 17 cost time: 5.1562488079071045
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.714678525924683
Epoch: 18, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.5375075340271
Epoch: 19, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.789319753646851
Epoch: 20, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.2164318561553955
Epoch: 21, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.827228546142578
Epoch: 22, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.5843775272369385
Epoch: 23, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.025536060333252
Epoch: 24, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 25 cost time: 4.879191637039185
Epoch: 25, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 26 cost time: 5.0656116008758545
Epoch: 26, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 27 cost time: 5.365743398666382
Epoch: 27, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 28 cost time: 5.725016832351685
Epoch: 28, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.6848835945129395
Epoch: 29, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 30 cost time: 5.117299318313599
Epoch: 30, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 31 cost time: 5.565159320831299
Epoch: 31, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.074254035949707
Epoch: 32, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.520158767700195
Epoch: 33, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 34 cost time: 5.75796365737915
Epoch: 34, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.520779848098755
Epoch: 35, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.397955417633057
Epoch: 36, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 4.421187400817871
Epoch: 37, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.37987208366394
Epoch: 38, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 4.788416862487793
Epoch: 39, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 5.246658563613892
Epoch: 40, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 41 cost time: 5.842616558074951
Epoch: 41, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 42 cost time: 5.856919288635254
Epoch: 42, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.085144758224487
Epoch: 43, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 4.930181264877319
Epoch: 44, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 45 cost time: 5.032093048095703
Epoch: 45, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 46 cost time: 4.903238773345947
Epoch: 46, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.794163465499878
Epoch: 47, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 5.885391712188721
Epoch: 48, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 6.072730541229248
Epoch: 49, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 5.428347110748291
Epoch: 50, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 4.889381170272827
Epoch: 51, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 5.200356960296631
Epoch: 52, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 5.789477348327637
Epoch: 53, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 5.901906490325928
Epoch: 54, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 5.658772230148315
Epoch: 55, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 3759129
model size : 24.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.268339395523071
Epoch: 1, Steps: 18 | Train Loss: 3.049 Vali Loss: 2.288 Vali Acc: 0.677 Test Loss: 2.288 Test Acc: 0.677
Validation loss decreased (inf --> -0.676644).  Saving model ...
Epoch: 2 cost time: 4.96319842338562
Epoch: 2, Steps: 18 | Train Loss: 1.540 Vali Loss: 1.003 Vali Acc: 0.830 Test Loss: 1.003 Test Acc: 0.830
Validation loss decreased (-0.676644 --> -0.829990).  Saving model ...
Epoch: 3 cost time: 5.105157136917114
Epoch: 3, Steps: 18 | Train Loss: 0.446 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
Validation loss decreased (-0.829990 --> -0.866661).  Saving model ...
Epoch: 4 cost time: 5.604759454727173
Epoch: 4, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.432 Vali Acc: 0.863 Test Loss: 0.432 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.785501480102539
Epoch: 5, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.390 Vali Acc: 0.883 Test Loss: 0.390 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883329).  Saving model ...
Epoch: 6 cost time: 5.775323390960693
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.356 Vali Acc: 0.893 Test Loss: 0.356 Test Acc: 0.893
Validation loss decreased (-0.883329 --> -0.893330).  Saving model ...
Epoch: 7 cost time: 5.338629722595215
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.352 Vali Acc: 0.907 Test Loss: 0.352 Test Acc: 0.907
Validation loss decreased (-0.893330 --> -0.906663).  Saving model ...
Epoch: 8 cost time: 5.2506818771362305
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.349 Vali Acc: 0.907 Test Loss: 0.349 Test Acc: 0.907
Validation loss decreased (-0.906663 --> -0.906663).  Saving model ...
Epoch: 9 cost time: 5.424668073654175
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.122274398803711
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.746097564697266
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.536527395248413
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.330 Vali Acc: 0.913 Test Loss: 0.330 Test Acc: 0.913
Validation loss decreased (-0.906663 --> -0.913330).  Saving model ...
Epoch: 13 cost time: 5.62230372428894
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.329 Vali Acc: 0.913 Test Loss: 0.329 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 14 cost time: 5.509584426879883
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 15 cost time: 4.971218824386597
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.329 Vali Acc: 0.913 Test Loss: 0.329 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.52327561378479
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.24634313583374
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.325 Vali Acc: 0.913 Test Loss: 0.325 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 18 cost time: 5.629558086395264
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.326 Vali Acc: 0.907 Test Loss: 0.326 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.731072664260864
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.326 Vali Acc: 0.913 Test Loss: 0.326 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.413710355758667
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.323 Vali Acc: 0.910 Test Loss: 0.323 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.2400963306427
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.322 Vali Acc: 0.910 Test Loss: 0.322 Test Acc: 0.910
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.437153577804565
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.913 Test Loss: 0.321 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 23 cost time: 5.619258642196655
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.910 Test Loss: 0.319 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.049134731292725
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.913 Test Loss: 0.319 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 25 cost time: 5.84213924407959
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.913 Test Loss: 0.318 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 26 cost time: 5.888489246368408
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.913 Test Loss: 0.319 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.515114068984985
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.913 Test Loss: 0.319 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.84539794921875
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.913 Test Loss: 0.321 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.875442266464233
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.913 Test Loss: 0.321 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.14032244682312
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.913 Test Loss: 0.320 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.1761744022369385
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.913 Test Loss: 0.318 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.038124084472656
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.913 Test Loss: 0.319 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 5.540107727050781
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.913 Test Loss: 0.320 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 5.338641166687012
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.913 Test Loss: 0.320 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 5.457381725311279
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.913 Test Loss: 0.319 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9133333333333333
model parameter : 2698777
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.267343282699585
Epoch: 1, Steps: 18 | Train Loss: 3.090 Vali Loss: 2.508 Vali Acc: 0.533 Test Loss: 2.508 Test Acc: 0.533
Validation loss decreased (inf --> -0.533308).  Saving model ...
Epoch: 2 cost time: 5.8565404415130615
Epoch: 2, Steps: 18 | Train Loss: 1.816 Vali Loss: 1.343 Vali Acc: 0.790 Test Loss: 1.343 Test Acc: 0.790
Validation loss decreased (-0.533308 --> -0.789987).  Saving model ...
Epoch: 3 cost time: 5.719043493270874
Epoch: 3, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.765 Vali Acc: 0.833 Test Loss: 0.765 Test Acc: 0.833
Validation loss decreased (-0.789987 --> -0.833326).  Saving model ...
Epoch: 4 cost time: 5.6596457958221436
Epoch: 4, Steps: 18 | Train Loss: 0.195 Vali Loss: 0.614 Vali Acc: 0.840 Test Loss: 0.614 Test Acc: 0.840
Validation loss decreased (-0.833326 --> -0.839994).  Saving model ...
Epoch: 5 cost time: 5.829587697982788
Epoch: 5, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.520 Vali Acc: 0.883 Test Loss: 0.520 Test Acc: 0.883
Validation loss decreased (-0.839994 --> -0.883328).  Saving model ...
Epoch: 6 cost time: 5.735223770141602
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.494 Vali Acc: 0.890 Test Loss: 0.494 Test Acc: 0.890
Validation loss decreased (-0.883328 --> -0.889995).  Saving model ...
Epoch: 7 cost time: 6.193268299102783
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.494 Vali Acc: 0.870 Test Loss: 0.494 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.905345916748047
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.485 Vali Acc: 0.890 Test Loss: 0.485 Test Acc: 0.890
Validation loss decreased (-0.889995 --> -0.889995).  Saving model ...
Epoch: 9 cost time: 5.717285394668579
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.481 Vali Acc: 0.887 Test Loss: 0.481 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.349742412567139
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.483 Vali Acc: 0.890 Test Loss: 0.483 Test Acc: 0.890
Validation loss decreased (-0.889995 --> -0.889995).  Saving model ...
Epoch: 11 cost time: 5.18766713142395
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.482 Vali Acc: 0.887 Test Loss: 0.482 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.59788703918457
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.478 Vali Acc: 0.887 Test Loss: 0.478 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.577807188034058
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.476 Vali Acc: 0.883 Test Loss: 0.476 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.554772853851318
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.887 Test Loss: 0.475 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.6635589599609375
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.890 Test Loss: 0.472 Test Acc: 0.890
Validation loss decreased (-0.889995 --> -0.889995).  Saving model ...
Epoch: 16 cost time: 5.383067607879639
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.887 Test Loss: 0.475 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.541843414306641
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.890 Test Loss: 0.473 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.524655818939209
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.883 Test Loss: 0.472 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.97558331489563
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.890 Test Loss: 0.470 Test Acc: 0.890
Validation loss decreased (-0.889995 --> -0.889995).  Saving model ...
Epoch: 20 cost time: 5.9159886837005615
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.890 Test Loss: 0.470 Test Acc: 0.890
Validation loss decreased (-0.889995 --> -0.889995).  Saving model ...
Epoch: 21 cost time: 5.992549657821655
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.890 Test Loss: 0.469 Test Acc: 0.890
Validation loss decreased (-0.889995 --> -0.889995).  Saving model ...
Epoch: 22 cost time: 5.923787593841553
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.890 Test Loss: 0.467 Test Acc: 0.890
Validation loss decreased (-0.889995 --> -0.889995).  Saving model ...
Epoch: 23 cost time: 5.683896064758301
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.890 Test Loss: 0.467 Test Acc: 0.890
Validation loss decreased (-0.889995 --> -0.889995).  Saving model ...
Epoch: 24 cost time: 5.702472686767578
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.890 Test Loss: 0.469 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.063689470291138
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.887 Test Loss: 0.468 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.984382629394531
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.890 Test Loss: 0.468 Test Acc: 0.890
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.216589450836182
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.890 Test Loss: 0.467 Test Acc: 0.890
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.670014142990112
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.890 Test Loss: 0.469 Test Acc: 0.890
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.414906978607178
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.890 Test Loss: 0.471 Test Acc: 0.890
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.491906642913818
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.893 Test Loss: 0.471 Test Acc: 0.893
Validation loss decreased (-0.889995 --> -0.893329).  Saving model ...
Epoch: 31 cost time: 6.0775604248046875
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.893 Test Loss: 0.471 Test Acc: 0.893
Validation loss decreased (-0.893329 --> -0.893329).  Saving model ...
Epoch: 32 cost time: 5.791170358657837
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.890 Test Loss: 0.471 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.982414722442627
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.893 Test Loss: 0.471 Test Acc: 0.893
Validation loss decreased (-0.893329 --> -0.893329).  Saving model ...
Epoch: 34 cost time: 5.6663126945495605
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.887 Test Loss: 0.471 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.851156711578369
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.890 Test Loss: 0.470 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.847962379455566
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.887 Test Loss: 0.471 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 6.289710283279419
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.887 Test Loss: 0.471 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 6.109330415725708
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.890 Test Loss: 0.472 Test Acc: 0.890
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 6.089611530303955
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.890 Test Loss: 0.473 Test Acc: 0.890
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 5.841050624847412
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.890 Test Loss: 0.473 Test Acc: 0.890
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 5.891193151473999
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.893 Test Loss: 0.472 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 6.119385004043579
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.890 Test Loss: 0.473 Test Acc: 0.890
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 6.046389102935791
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.890 Test Loss: 0.473 Test Acc: 0.890
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8933333333333333
model parameter : 2698777
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.922783374786377
Epoch: 1, Steps: 18 | Train Loss: 3.163 Vali Loss: 2.773 Vali Acc: 0.410 Test Loss: 2.773 Test Acc: 0.410
Validation loss decreased (inf --> -0.409972).  Saving model ...
Epoch: 2 cost time: 5.745999336242676
Epoch: 2, Steps: 18 | Train Loss: 2.190 Vali Loss: 1.880 Vali Acc: 0.697 Test Loss: 1.880 Test Acc: 0.697
Validation loss decreased (-0.409972 --> -0.696648).  Saving model ...
Epoch: 3 cost time: 5.761334180831909
Epoch: 3, Steps: 18 | Train Loss: 0.993 Vali Loss: 1.206 Vali Acc: 0.750 Test Loss: 1.206 Test Acc: 0.750
Validation loss decreased (-0.696648 --> -0.749988).  Saving model ...
Epoch: 4 cost time: 5.487414598464966
Epoch: 4, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.919 Vali Acc: 0.777 Test Loss: 0.919 Test Acc: 0.777
Validation loss decreased (-0.749988 --> -0.776657).  Saving model ...
Epoch: 5 cost time: 6.009702920913696
Epoch: 5, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.798 Vali Acc: 0.803 Test Loss: 0.798 Test Acc: 0.803
Validation loss decreased (-0.776657 --> -0.803325).  Saving model ...
Epoch: 6 cost time: 6.378834009170532
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.753 Vali Acc: 0.820 Test Loss: 0.753 Test Acc: 0.820
Validation loss decreased (-0.803325 --> -0.819992).  Saving model ...
Epoch: 7 cost time: 6.534138202667236
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.757 Vali Acc: 0.803 Test Loss: 0.757 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.979466676712036
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.085119962692261
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.746 Vali Acc: 0.810 Test Loss: 0.746 Test Acc: 0.810
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.456503868103027
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.747 Vali Acc: 0.807 Test Loss: 0.747 Test Acc: 0.807
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.095747709274292
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.370437860488892
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.741 Vali Acc: 0.810 Test Loss: 0.741 Test Acc: 0.810
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.996225595474243
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.740 Vali Acc: 0.807 Test Loss: 0.740 Test Acc: 0.807
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.9469194412231445
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.743 Vali Acc: 0.810 Test Loss: 0.743 Test Acc: 0.810
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.764510631561279
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.744 Vali Acc: 0.807 Test Loss: 0.744 Test Acc: 0.807
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.267184734344482
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.810 Test Loss: 0.747 Test Acc: 0.810
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.82
model parameter : 2698777
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.502680540084839
Epoch: 1, Steps: 18 | Train Loss: 3.206 Vali Loss: 2.959 Vali Acc: 0.237 Test Loss: 2.959 Test Acc: 0.237
Validation loss decreased (inf --> -0.236637).  Saving model ...
Epoch: 2 cost time: 6.4997899532318115
Epoch: 2, Steps: 18 | Train Loss: 2.516 Vali Loss: 2.398 Vali Acc: 0.477 Test Loss: 2.398 Test Acc: 0.477
Validation loss decreased (-0.236637 --> -0.476643).  Saving model ...
Epoch: 3 cost time: 6.0657923221588135
Epoch: 3, Steps: 18 | Train Loss: 1.488 Vali Loss: 1.848 Vali Acc: 0.547 Test Loss: 1.848 Test Acc: 0.547
Validation loss decreased (-0.476643 --> -0.546648).  Saving model ...
Epoch: 4 cost time: 6.552847146987915
Epoch: 4, Steps: 18 | Train Loss: 0.651 Vali Loss: 1.473 Vali Acc: 0.580 Test Loss: 1.473 Test Acc: 0.580
Validation loss decreased (-0.546648 --> -0.579985).  Saving model ...
Epoch: 5 cost time: 6.027036666870117
Epoch: 5, Steps: 18 | Train Loss: 0.175 Vali Loss: 1.236 Vali Acc: 0.633 Test Loss: 1.236 Test Acc: 0.633
Validation loss decreased (-0.579985 --> -0.633321).  Saving model ...
Epoch: 6 cost time: 6.049838066101074
Epoch: 6, Steps: 18 | Train Loss: 0.052 Vali Loss: 1.213 Vali Acc: 0.627 Test Loss: 1.213 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.898090600967407
Epoch: 7, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.120 Vali Acc: 0.663 Test Loss: 1.120 Test Acc: 0.663
Validation loss decreased (-0.633321 --> -0.663322).  Saving model ...
Epoch: 8 cost time: 6.231493234634399
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.088 Vali Acc: 0.670 Test Loss: 1.088 Test Acc: 0.670
Validation loss decreased (-0.663322 --> -0.669989).  Saving model ...
Epoch: 9 cost time: 6.0367114543914795
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.083 Vali Acc: 0.677 Test Loss: 1.083 Test Acc: 0.677
Validation loss decreased (-0.669989 --> -0.676656).  Saving model ...
Epoch: 10 cost time: 5.888142347335815
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.062 Vali Acc: 0.683 Test Loss: 1.062 Test Acc: 0.683
Validation loss decreased (-0.676656 --> -0.683323).  Saving model ...
Epoch: 11 cost time: 5.830578088760376
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.050 Vali Acc: 0.683 Test Loss: 1.050 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683323).  Saving model ...
Epoch: 12 cost time: 6.0015833377838135
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.039 Vali Acc: 0.687 Test Loss: 1.039 Test Acc: 0.687
Validation loss decreased (-0.683323 --> -0.686656).  Saving model ...
Epoch: 13 cost time: 5.66370415687561
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.032 Vali Acc: 0.697 Test Loss: 1.032 Test Acc: 0.697
Validation loss decreased (-0.686656 --> -0.696656).  Saving model ...
Epoch: 14 cost time: 6.380207777023315
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
Validation loss decreased (-0.696656 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 6.724993705749512
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.024 Vali Acc: 0.697 Test Loss: 1.024 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.00894570350647
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.020 Vali Acc: 0.697 Test Loss: 1.020 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.180571794509888
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.006 Vali Acc: 0.703 Test Loss: 1.006 Test Acc: 0.703
Validation loss decreased (-0.699990 --> -0.703323).  Saving model ...
Epoch: 18 cost time: 6.2738776206970215
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.693 Test Loss: 1.000 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.210267782211304
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.999 Vali Acc: 0.697 Test Loss: 0.999 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.197573900222778
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.703 Test Loss: 0.995 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 21 cost time: 6.423202753067017
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.992 Vali Acc: 0.707 Test Loss: 0.992 Test Acc: 0.707
Validation loss decreased (-0.703323 --> -0.706657).  Saving model ...
Epoch: 22 cost time: 6.14000129699707
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.703 Test Loss: 0.985 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.160374641418457
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.982 Vali Acc: 0.707 Test Loss: 0.982 Test Acc: 0.707
Validation loss decreased (-0.706657 --> -0.706657).  Saving model ...
Epoch: 24 cost time: 5.936332941055298
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.978 Vali Acc: 0.707 Test Loss: 0.978 Test Acc: 0.707
Validation loss decreased (-0.706657 --> -0.706657).  Saving model ...
Epoch: 25 cost time: 6.478482246398926
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.975 Vali Acc: 0.710 Test Loss: 0.975 Test Acc: 0.710
Validation loss decreased (-0.706657 --> -0.709990).  Saving model ...
Epoch: 26 cost time: 6.163459777832031
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.978 Vali Acc: 0.720 Test Loss: 0.978 Test Acc: 0.720
Validation loss decreased (-0.709990 --> -0.719990).  Saving model ...
Epoch: 27 cost time: 6.334142446517944
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.975 Vali Acc: 0.717 Test Loss: 0.975 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.0475945472717285
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.976 Vali Acc: 0.730 Test Loss: 0.976 Test Acc: 0.730
Validation loss decreased (-0.719990 --> -0.729990).  Saving model ...
Epoch: 29 cost time: 6.435377359390259
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.974 Vali Acc: 0.730 Test Loss: 0.974 Test Acc: 0.730
Validation loss decreased (-0.729990 --> -0.729990).  Saving model ...
Epoch: 30 cost time: 5.975870609283447
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.970 Vali Acc: 0.730 Test Loss: 0.970 Test Acc: 0.730
Validation loss decreased (-0.729990 --> -0.729990).  Saving model ...
Epoch: 31 cost time: 6.4094836711883545
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.966 Vali Acc: 0.733 Test Loss: 0.966 Test Acc: 0.733
Validation loss decreased (-0.729990 --> -0.733324).  Saving model ...
Epoch: 32 cost time: 6.1403210163116455
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.730 Test Loss: 0.964 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.235917568206787
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.733 Test Loss: 0.963 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 34 cost time: 5.89141058921814
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.730 Test Loss: 0.962 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.769845485687256
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.733 Test Loss: 0.957 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 36 cost time: 5.870804309844971
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.737 Test Loss: 0.959 Test Acc: 0.737
Validation loss decreased (-0.733324 --> -0.736657).  Saving model ...
Epoch: 37 cost time: 6.3484063148498535
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.733 Test Loss: 0.955 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.984864234924316
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.952 Vali Acc: 0.733 Test Loss: 0.952 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 5.916829586029053
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.733 Test Loss: 0.953 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 6.1753764152526855
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.733 Test Loss: 0.951 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 5.770025014877319
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.946 Vali Acc: 0.733 Test Loss: 0.946 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 5.803102016448975
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.733 Test Loss: 0.945 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 5.967142105102539
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.737 Test Loss: 0.945 Test Acc: 0.737
Validation loss decreased (-0.736657 --> -0.736657).  Saving model ...
Epoch: 44 cost time: 6.343999624252319
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.737 Test Loss: 0.943 Test Acc: 0.737
Validation loss decreased (-0.736657 --> -0.736657).  Saving model ...
Epoch: 45 cost time: 7.04696798324585
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.940 Vali Acc: 0.737 Test Loss: 0.940 Test Acc: 0.737
Validation loss decreased (-0.736657 --> -0.736657).  Saving model ...
Epoch: 46 cost time: 6.325915098190308
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.937 Vali Acc: 0.737 Test Loss: 0.937 Test Acc: 0.737
Validation loss decreased (-0.736657 --> -0.736657).  Saving model ...
Epoch: 47 cost time: 6.11363410949707
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.737 Test Loss: 0.934 Test Acc: 0.737
Validation loss decreased (-0.736657 --> -0.736657).  Saving model ...
Epoch: 48 cost time: 6.8366780281066895
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.937 Vali Acc: 0.737 Test Loss: 0.937 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.731340646743774
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.936 Vali Acc: 0.737 Test Loss: 0.936 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 6.595384359359741
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.937 Vali Acc: 0.737 Test Loss: 0.937 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.366090297698975
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.737 Test Loss: 0.934 Test Acc: 0.737
Validation loss decreased (-0.736657 --> -0.736657).  Saving model ...
Epoch: 52 cost time: 6.375591516494751
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.737 Test Loss: 0.934 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 6.051429748535156
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.936 Vali Acc: 0.737 Test Loss: 0.936 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 6.65758752822876
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.936 Vali Acc: 0.733 Test Loss: 0.936 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 6.543353796005249
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.730 Test Loss: 0.934 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 6.652802467346191
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.730 Test Loss: 0.932 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 5.97218656539917
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.733 Test Loss: 0.932 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 5.915878057479858
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.730 Test Loss: 0.932 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 6.068699359893799
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.931 Vali Acc: 0.737 Test Loss: 0.931 Test Acc: 0.737
Validation loss decreased (-0.736657 --> -0.736657).  Saving model ...
Epoch: 60 cost time: 6.505312442779541
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.740 Test Loss: 0.930 Test Acc: 0.740
Validation loss decreased (-0.736657 --> -0.739991).  Saving model ...
Epoch: 61 cost time: 7.004181623458862
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.928 Vali Acc: 0.740 Test Loss: 0.928 Test Acc: 0.740
Validation loss decreased (-0.739991 --> -0.739991).  Saving model ...
Epoch: 62 cost time: 6.527473211288452
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.737 Test Loss: 0.927 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 6.040953874588013
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.733 Test Loss: 0.927 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 6.253926038742065
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.737 Test Loss: 0.927 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 6.277186393737793
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.740 Test Loss: 0.927 Test Acc: 0.740
Validation loss decreased (-0.739991 --> -0.739991).  Saving model ...
Epoch: 66 cost time: 6.616210222244263
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.926 Vali Acc: 0.740 Test Loss: 0.926 Test Acc: 0.740
Validation loss decreased (-0.739991 --> -0.739991).  Saving model ...
Epoch: 67 cost time: 6.3717546463012695
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.740 Test Loss: 0.927 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 6.578507661819458
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.740 Test Loss: 0.925 Test Acc: 0.740
Validation loss decreased (-0.739991 --> -0.739991).  Saving model ...
Epoch: 69 cost time: 6.179469585418701
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.737 Test Loss: 0.925 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 6.066669225692749
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.743 Test Loss: 0.923 Test Acc: 0.743
Validation loss decreased (-0.739991 --> -0.743324).  Saving model ...
Epoch: 71 cost time: 5.662444591522217
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.747 Test Loss: 0.922 Test Acc: 0.747
Validation loss decreased (-0.743324 --> -0.746657).  Saving model ...
Epoch: 72 cost time: 6.271948337554932
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.747 Test Loss: 0.922 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 6.225208044052124
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.747 Test Loss: 0.925 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 6.807605504989624
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.743 Test Loss: 0.924 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 6.124841213226318
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.747 Test Loss: 0.924 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 6.084944486618042
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.743 Test Loss: 0.923 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 5.86462140083313
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.747 Test Loss: 0.920 Test Acc: 0.747
Validation loss decreased (-0.746657 --> -0.746657).  Saving model ...
Epoch: 78 cost time: 6.3297741413116455
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.747 Test Loss: 0.920 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 6.386884450912476
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.750 Test Loss: 0.922 Test Acc: 0.750
Validation loss decreased (-0.746657 --> -0.749991).  Saving model ...
Epoch: 80 cost time: 6.047339677810669
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.750 Test Loss: 0.920 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 81 cost time: 5.880106687545776
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.753 Test Loss: 0.919 Test Acc: 0.753
Validation loss decreased (-0.749991 --> -0.753324).  Saving model ...
Epoch: 82 cost time: 5.7774670124053955
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.757 Test Loss: 0.920 Test Acc: 0.757
Validation loss decreased (-0.753324 --> -0.756657).  Saving model ...
Epoch: 83 cost time: 5.909087181091309
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.753 Test Loss: 0.922 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 6.000199556350708
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.757 Test Loss: 0.921 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 6.126224040985107
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.757 Test Loss: 0.919 Test Acc: 0.757
Validation loss decreased (-0.756657 --> -0.756657).  Saving model ...
Epoch: 86 cost time: 6.093085050582886
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.753 Test Loss: 0.919 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 6.278184413909912
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.753 Test Loss: 0.919 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 6.302196025848389
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.753 Test Loss: 0.920 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 5.911590814590454
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.753 Test Loss: 0.920 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 5.920234680175781
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.757 Test Loss: 0.920 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 6.033871412277222
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.753 Test Loss: 0.921 Test Acc: 0.753
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 6.168593168258667
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.750 Test Loss: 0.919 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 6.335876941680908
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.750 Test Loss: 0.917 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 6.284792423248291
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.750 Test Loss: 0.916 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 6.04037618637085
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.750 Test Loss: 0.917 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7566666666666667
model parameter : 2698777
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.602937936782837
Epoch: 1, Steps: 18 | Train Loss: 3.238 Vali Loss: 3.064 Vali Acc: 0.143 Test Loss: 3.064 Test Acc: 0.143
Validation loss decreased (inf --> -0.143303).  Saving model ...
Epoch: 2 cost time: 6.162500619888306
Epoch: 2, Steps: 18 | Train Loss: 2.660 Vali Loss: 2.696 Vali Acc: 0.353 Test Loss: 2.696 Test Acc: 0.353
Validation loss decreased (-0.143303 --> -0.353306).  Saving model ...
Epoch: 3 cost time: 6.7505316734313965
Epoch: 3, Steps: 18 | Train Loss: 1.761 Vali Loss: 2.315 Vali Acc: 0.387 Test Loss: 2.315 Test Acc: 0.387
Validation loss decreased (-0.353306 --> -0.386644).  Saving model ...
Epoch: 4 cost time: 6.123824834823608
Epoch: 4, Steps: 18 | Train Loss: 0.901 Vali Loss: 2.023 Vali Acc: 0.450 Test Loss: 2.023 Test Acc: 0.450
Validation loss decreased (-0.386644 --> -0.449980).  Saving model ...
Epoch: 5 cost time: 5.822706460952759
Epoch: 5, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.796 Vali Acc: 0.473 Test Loss: 1.796 Test Acc: 0.473
Validation loss decreased (-0.449980 --> -0.473315).  Saving model ...
Epoch: 6 cost time: 5.563448190689087
Epoch: 6, Steps: 18 | Train Loss: 0.102 Vali Loss: 1.705 Vali Acc: 0.453 Test Loss: 1.705 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.14042329788208
Epoch: 7, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.596 Vali Acc: 0.513 Test Loss: 1.596 Test Acc: 0.513
Validation loss decreased (-0.473315 --> -0.513317).  Saving model ...
Epoch: 8 cost time: 6.415544271469116
Epoch: 8, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.558 Vali Acc: 0.537 Test Loss: 1.558 Test Acc: 0.537
Validation loss decreased (-0.513317 --> -0.536651).  Saving model ...
Epoch: 9 cost time: 6.1266162395477295
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.538 Vali Acc: 0.533 Test Loss: 1.538 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.170517921447754
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.502 Vali Acc: 0.563 Test Loss: 1.502 Test Acc: 0.563
Validation loss decreased (-0.536651 --> -0.563318).  Saving model ...
Epoch: 11 cost time: 5.732288360595703
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.484 Vali Acc: 0.563 Test Loss: 1.484 Test Acc: 0.563
Validation loss decreased (-0.563318 --> -0.563318).  Saving model ...
Epoch: 12 cost time: 6.328261613845825
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.463 Vali Acc: 0.567 Test Loss: 1.463 Test Acc: 0.567
Validation loss decreased (-0.563318 --> -0.566652).  Saving model ...
Epoch: 13 cost time: 6.672137022018433
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.448 Vali Acc: 0.560 Test Loss: 1.448 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.586966514587402
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.433 Vali Acc: 0.580 Test Loss: 1.433 Test Acc: 0.580
Validation loss decreased (-0.566652 --> -0.579986).  Saving model ...
Epoch: 15 cost time: 6.163471460342407
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.418 Vali Acc: 0.593 Test Loss: 1.418 Test Acc: 0.593
Validation loss decreased (-0.579986 --> -0.593319).  Saving model ...
Epoch: 16 cost time: 6.163322925567627
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.407 Vali Acc: 0.587 Test Loss: 1.407 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.052471876144409
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.392 Vali Acc: 0.583 Test Loss: 1.392 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.8990373611450195
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.384 Vali Acc: 0.593 Test Loss: 1.384 Test Acc: 0.593
Validation loss decreased (-0.593319 --> -0.593319).  Saving model ...
Epoch: 19 cost time: 5.972071170806885
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.377 Vali Acc: 0.597 Test Loss: 1.377 Test Acc: 0.597
Validation loss decreased (-0.593319 --> -0.596653).  Saving model ...
Epoch: 20 cost time: 6.218810081481934
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.370 Vali Acc: 0.600 Test Loss: 1.370 Test Acc: 0.600
Validation loss decreased (-0.596653 --> -0.599986).  Saving model ...
Epoch: 21 cost time: 6.174503564834595
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.359 Vali Acc: 0.610 Test Loss: 1.359 Test Acc: 0.610
Validation loss decreased (-0.599986 --> -0.609986).  Saving model ...
Epoch: 22 cost time: 6.503000497817993
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.352 Vali Acc: 0.610 Test Loss: 1.352 Test Acc: 0.610
Validation loss decreased (-0.609986 --> -0.609986).  Saving model ...
Epoch: 23 cost time: 6.383248805999756
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.347 Vali Acc: 0.603 Test Loss: 1.347 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.126535177230835
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.343 Vali Acc: 0.613 Test Loss: 1.343 Test Acc: 0.613
Validation loss decreased (-0.609986 --> -0.613320).  Saving model ...
Epoch: 25 cost time: 6.413037300109863
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.333 Vali Acc: 0.610 Test Loss: 1.333 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.353298902511597
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.337 Vali Acc: 0.610 Test Loss: 1.337 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.143095254898071
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.329 Vali Acc: 0.610 Test Loss: 1.329 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.394737720489502
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.613 Test Loss: 1.323 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 29 cost time: 6.192087888717651
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.317 Vali Acc: 0.613 Test Loss: 1.317 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 30 cost time: 6.046968698501587
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.310 Vali Acc: 0.623 Test Loss: 1.310 Test Acc: 0.623
Validation loss decreased (-0.613320 --> -0.623320).  Saving model ...
Epoch: 31 cost time: 6.447857141494751
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.308 Vali Acc: 0.617 Test Loss: 1.308 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.365807294845581
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.304 Vali Acc: 0.620 Test Loss: 1.304 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.966414928436279
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.300 Vali Acc: 0.623 Test Loss: 1.300 Test Acc: 0.623
Validation loss decreased (-0.623320 --> -0.623320).  Saving model ...
Epoch: 34 cost time: 6.294052839279175
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.630 Test Loss: 1.295 Test Acc: 0.630
Validation loss decreased (-0.623320 --> -0.629987).  Saving model ...
Epoch: 35 cost time: 6.158174991607666
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.630 Test Loss: 1.292 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 36 cost time: 6.13439416885376
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.637 Test Loss: 1.292 Test Acc: 0.637
Validation loss decreased (-0.629987 --> -0.636654).  Saving model ...
Epoch: 37 cost time: 6.283430337905884
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.289 Vali Acc: 0.640 Test Loss: 1.289 Test Acc: 0.640
Validation loss decreased (-0.636654 --> -0.639987).  Saving model ...
Epoch: 38 cost time: 6.6832969188690186
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.286 Vali Acc: 0.633 Test Loss: 1.286 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.662033796310425
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.286 Vali Acc: 0.647 Test Loss: 1.286 Test Acc: 0.647
Validation loss decreased (-0.639987 --> -0.646654).  Saving model ...
Epoch: 40 cost time: 5.864279747009277
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.643 Test Loss: 1.285 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.0956196784973145
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.647 Test Loss: 1.281 Test Acc: 0.647
Validation loss decreased (-0.646654 --> -0.646654).  Saving model ...
Epoch: 42 cost time: 6.4324421882629395
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.278 Vali Acc: 0.643 Test Loss: 1.278 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.685971260070801
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.650 Test Loss: 1.275 Test Acc: 0.650
Validation loss decreased (-0.646654 --> -0.649987).  Saving model ...
Epoch: 44 cost time: 6.251163482666016
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.272 Vali Acc: 0.657 Test Loss: 1.272 Test Acc: 0.657
Validation loss decreased (-0.649987 --> -0.656654).  Saving model ...
Epoch: 45 cost time: 5.838702440261841
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.650 Test Loss: 1.268 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.856108665466309
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.650 Test Loss: 1.266 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.736762046813965
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.653 Test Loss: 1.263 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 6.249489068984985
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.657 Test Loss: 1.262 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656654).  Saving model ...
Epoch: 49 cost time: 6.541446685791016
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.650 Test Loss: 1.259 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.759326457977295
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.657 Test Loss: 1.259 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656654).  Saving model ...
Epoch: 51 cost time: 6.021978139877319
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.660 Test Loss: 1.255 Test Acc: 0.660
Validation loss decreased (-0.656654 --> -0.659987).  Saving model ...
Epoch: 52 cost time: 5.90505051612854
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.660 Test Loss: 1.253 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
Epoch: 53 cost time: 6.172383785247803
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.660 Test Loss: 1.250 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
Epoch: 54 cost time: 6.4030210971832275
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.667 Test Loss: 1.248 Test Acc: 0.667
Validation loss decreased (-0.659987 --> -0.666654).  Saving model ...
Epoch: 55 cost time: 6.585023880004883
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.663 Test Loss: 1.246 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 5.771019697189331
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.667 Test Loss: 1.246 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 57 cost time: 5.883121490478516
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.670 Test Loss: 1.246 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669988).  Saving model ...
Epoch: 58 cost time: 6.149451732635498
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.670 Test Loss: 1.247 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.511666297912598
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.670 Test Loss: 1.247 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 6.265161752700806
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.667 Test Loss: 1.246 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 6.173350095748901
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.244 Vali Acc: 0.667 Test Loss: 1.244 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 5.742892026901245
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.673 Test Loss: 1.242 Test Acc: 0.673
Validation loss decreased (-0.669988 --> -0.673321).  Saving model ...
Epoch: 63 cost time: 6.205532550811768
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.670 Test Loss: 1.242 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.973299026489258
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.673 Test Loss: 1.241 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 65 cost time: 6.025365352630615
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.667 Test Loss: 1.239 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 6.294689178466797
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.677 Test Loss: 1.236 Test Acc: 0.677
Validation loss decreased (-0.673321 --> -0.676654).  Saving model ...
Epoch: 67 cost time: 6.4150519371032715
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.677 Test Loss: 1.234 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 68 cost time: 5.98527979850769
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.677 Test Loss: 1.232 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 69 cost time: 6.188760042190552
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.677 Test Loss: 1.231 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 70 cost time: 6.582406759262085
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.673 Test Loss: 1.229 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 6.259973526000977
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.677 Test Loss: 1.230 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 72 cost time: 6.623691558837891
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.677 Test Loss: 1.229 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 73 cost time: 6.179657697677612
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.673 Test Loss: 1.234 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 6.486114025115967
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.677 Test Loss: 1.234 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 5.871939659118652
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.677 Test Loss: 1.232 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 6.0464699268341064
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.673 Test Loss: 1.232 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 5.5600762367248535
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.677 Test Loss: 1.230 Test Acc: 0.677
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 5.708365440368652
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.677 Test Loss: 1.228 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 79 cost time: 6.0569236278533936
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.677 Test Loss: 1.229 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 6.479612827301025
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.680 Test Loss: 1.230 Test Acc: 0.680
Validation loss decreased (-0.676654 --> -0.679988).  Saving model ...
Epoch: 81 cost time: 6.334042072296143
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.680 Test Loss: 1.229 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 82 cost time: 6.142319917678833
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.683 Test Loss: 1.227 Test Acc: 0.683
Validation loss decreased (-0.679988 --> -0.683321).  Saving model ...
Epoch: 83 cost time: 5.562261343002319
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.680 Test Loss: 1.226 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 6.023725986480713
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.680 Test Loss: 1.224 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 6.606585502624512
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.687 Test Loss: 1.224 Test Acc: 0.687
Validation loss decreased (-0.683321 --> -0.686654).  Saving model ...
Epoch: 86 cost time: 6.1561195850372314
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.683 Test Loss: 1.225 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 6.079225540161133
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.683 Test Loss: 1.222 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 5.809504508972168
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.680 Test Loss: 1.222 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 5.891839504241943
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.680 Test Loss: 1.220 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 5.627742767333984
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.687 Test Loss: 1.218 Test Acc: 0.687
Validation loss decreased (-0.686654 --> -0.686654).  Saving model ...
Epoch: 91 cost time: 6.191186189651489
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.690 Test Loss: 1.220 Test Acc: 0.690
Validation loss decreased (-0.686654 --> -0.689988).  Saving model ...
Epoch: 92 cost time: 5.848336696624756
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.683 Test Loss: 1.220 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 5.90055775642395
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.690 Test Loss: 1.217 Test Acc: 0.690
Validation loss decreased (-0.689988 --> -0.689988).  Saving model ...
Epoch: 94 cost time: 5.584031343460083
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.690 Test Loss: 1.217 Test Acc: 0.690
Validation loss decreased (-0.689988 --> -0.689988).  Saving model ...
Epoch: 95 cost time: 5.476248264312744
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.687 Test Loss: 1.217 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 5.55512261390686
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.683 Test Loss: 1.216 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 6.342005491256714
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.690 Test Loss: 1.214 Test Acc: 0.690
Validation loss decreased (-0.689988 --> -0.689988).  Saving model ...
Epoch: 98 cost time: 6.352697372436523
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.683 Test Loss: 1.214 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 5.983891010284424
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.690 Test Loss: 1.216 Test Acc: 0.690
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 5.88703989982605
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.690 Test Loss: 1.215 Test Acc: 0.690
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.69
model parameter : 2698777
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.10981822013855
Epoch: 1, Steps: 18 | Train Loss: 3.245 Vali Loss: 3.141 Vali Acc: 0.100 Test Loss: 3.141 Test Acc: 0.100
Validation loss decreased (inf --> -0.099969).  Saving model ...
Epoch: 2 cost time: 6.504692554473877
Epoch: 2, Steps: 18 | Train Loss: 2.739 Vali Loss: 2.877 Vali Acc: 0.220 Test Loss: 2.877 Test Acc: 0.220
Validation loss decreased (-0.099969 --> -0.219971).  Saving model ...
Epoch: 3 cost time: 6.424405097961426
Epoch: 3, Steps: 18 | Train Loss: 1.830 Vali Loss: 2.595 Vali Acc: 0.277 Test Loss: 2.595 Test Acc: 0.277
Validation loss decreased (-0.219971 --> -0.276641).  Saving model ...
Epoch: 4 cost time: 5.8461689949035645
Epoch: 4, Steps: 18 | Train Loss: 1.014 Vali Loss: 2.366 Vali Acc: 0.357 Test Loss: 2.366 Test Acc: 0.357
Validation loss decreased (-0.276641 --> -0.356643).  Saving model ...
Epoch: 5 cost time: 5.519838333129883
Epoch: 5, Steps: 18 | Train Loss: 0.385 Vali Loss: 2.224 Vali Acc: 0.347 Test Loss: 2.224 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.809372186660767
Epoch: 6, Steps: 18 | Train Loss: 0.137 Vali Loss: 2.151 Vali Acc: 0.347 Test Loss: 2.151 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.1736345291137695
Epoch: 7, Steps: 18 | Train Loss: 0.041 Vali Loss: 2.015 Vali Acc: 0.387 Test Loss: 2.015 Test Acc: 0.387
Validation loss decreased (-0.356643 --> -0.386647).  Saving model ...
Epoch: 8 cost time: 6.069761037826538
Epoch: 8, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.937 Vali Acc: 0.427 Test Loss: 1.937 Test Acc: 0.427
Validation loss decreased (-0.386647 --> -0.426647).  Saving model ...
Epoch: 9 cost time: 6.198918581008911
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.914 Vali Acc: 0.407 Test Loss: 1.914 Test Acc: 0.407
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.681591033935547
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.860 Vali Acc: 0.423 Test Loss: 1.860 Test Acc: 0.423
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.171664476394653
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.823 Vali Acc: 0.437 Test Loss: 1.823 Test Acc: 0.437
Validation loss decreased (-0.426647 --> -0.436648).  Saving model ...
Epoch: 12 cost time: 6.217091083526611
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.785 Vali Acc: 0.470 Test Loss: 1.785 Test Acc: 0.470
Validation loss decreased (-0.436648 --> -0.469982).  Saving model ...
Epoch: 13 cost time: 6.8781702518463135
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.763 Vali Acc: 0.477 Test Loss: 1.763 Test Acc: 0.477
Validation loss decreased (-0.469982 --> -0.476649).  Saving model ...
Epoch: 14 cost time: 6.398275136947632
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.731 Vali Acc: 0.503 Test Loss: 1.731 Test Acc: 0.503
Validation loss decreased (-0.476649 --> -0.503316).  Saving model ...
Epoch: 15 cost time: 5.840848445892334
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.718 Vali Acc: 0.507 Test Loss: 1.718 Test Acc: 0.507
Validation loss decreased (-0.503316 --> -0.506649).  Saving model ...
Epoch: 16 cost time: 6.286638498306274
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.699 Vali Acc: 0.520 Test Loss: 1.699 Test Acc: 0.520
Validation loss decreased (-0.506649 --> -0.519983).  Saving model ...
Epoch: 17 cost time: 5.98948335647583
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.684 Vali Acc: 0.517 Test Loss: 1.684 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.4928648471832275
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.660 Vali Acc: 0.527 Test Loss: 1.660 Test Acc: 0.527
Validation loss decreased (-0.519983 --> -0.526650).  Saving model ...
Epoch: 19 cost time: 6.198458433151245
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.647 Vali Acc: 0.530 Test Loss: 1.647 Test Acc: 0.530
Validation loss decreased (-0.526650 --> -0.529984).  Saving model ...
Epoch: 20 cost time: 6.109128952026367
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.628 Vali Acc: 0.537 Test Loss: 1.628 Test Acc: 0.537
Validation loss decreased (-0.529984 --> -0.536650).  Saving model ...
Epoch: 21 cost time: 6.117437362670898
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.612 Vali Acc: 0.540 Test Loss: 1.612 Test Acc: 0.540
Validation loss decreased (-0.536650 --> -0.539984).  Saving model ...
Epoch: 22 cost time: 5.959749221801758
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.547 Test Loss: 1.600 Test Acc: 0.547
Validation loss decreased (-0.539984 --> -0.546651).  Saving model ...
Epoch: 23 cost time: 5.826615571975708
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.589 Vali Acc: 0.547 Test Loss: 1.589 Test Acc: 0.547
Validation loss decreased (-0.546651 --> -0.546651).  Saving model ...
Epoch: 24 cost time: 6.8079962730407715
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.577 Vali Acc: 0.550 Test Loss: 1.577 Test Acc: 0.550
Validation loss decreased (-0.546651 --> -0.549984).  Saving model ...
Epoch: 25 cost time: 6.557216167449951
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.560 Vali Acc: 0.563 Test Loss: 1.560 Test Acc: 0.563
Validation loss decreased (-0.549984 --> -0.563318).  Saving model ...
Epoch: 26 cost time: 6.2204999923706055
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.559 Vali Acc: 0.560 Test Loss: 1.559 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.951910495758057
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.548 Vali Acc: 0.583 Test Loss: 1.548 Test Acc: 0.583
Validation loss decreased (-0.563318 --> -0.583318).  Saving model ...
Epoch: 28 cost time: 6.0101189613342285
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.531 Vali Acc: 0.590 Test Loss: 1.531 Test Acc: 0.590
Validation loss decreased (-0.583318 --> -0.589985).  Saving model ...
Epoch: 29 cost time: 6.4721691608428955
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.522 Vali Acc: 0.583 Test Loss: 1.522 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.673005104064941
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.511 Vali Acc: 0.583 Test Loss: 1.511 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.212594270706177
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.504 Vali Acc: 0.587 Test Loss: 1.504 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 6.448016166687012
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.497 Vali Acc: 0.587 Test Loss: 1.497 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 6.111687183380127
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.495 Vali Acc: 0.583 Test Loss: 1.495 Test Acc: 0.583
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.972836017608643
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.491 Vali Acc: 0.580 Test Loss: 1.491 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 6.5631372928619385
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.483 Vali Acc: 0.580 Test Loss: 1.483 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 6.531978607177734
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.593 Test Loss: 1.477 Test Acc: 0.593
Validation loss decreased (-0.589985 --> -0.593319).  Saving model ...
Epoch: 37 cost time: 6.77613091468811
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.597 Test Loss: 1.478 Test Acc: 0.597
Validation loss decreased (-0.593319 --> -0.596652).  Saving model ...
Epoch: 38 cost time: 5.573772192001343
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.475 Vali Acc: 0.597 Test Loss: 1.475 Test Acc: 0.597
Validation loss decreased (-0.596652 --> -0.596652).  Saving model ...
Epoch: 39 cost time: 5.578190565109253
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.610 Test Loss: 1.471 Test Acc: 0.610
Validation loss decreased (-0.596652 --> -0.609985).  Saving model ...
Epoch: 40 cost time: 5.698137521743774
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.600 Test Loss: 1.464 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.000438213348389
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.607 Test Loss: 1.462 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.083089113235474
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.607 Test Loss: 1.456 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.34885311126709
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.603 Test Loss: 1.452 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.03375506401062
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.610 Test Loss: 1.445 Test Acc: 0.610
Validation loss decreased (-0.609985 --> -0.609986).  Saving model ...
Epoch: 45 cost time: 5.655165672302246
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.610 Test Loss: 1.442 Test Acc: 0.610
Validation loss decreased (-0.609986 --> -0.609986).  Saving model ...
Epoch: 46 cost time: 6.2114880084991455
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.610 Test Loss: 1.434 Test Acc: 0.610
Validation loss decreased (-0.609986 --> -0.609986).  Saving model ...
Epoch: 47 cost time: 6.258975982666016
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.610 Test Loss: 1.429 Test Acc: 0.610
Validation loss decreased (-0.609986 --> -0.609986).  Saving model ...
Epoch: 48 cost time: 6.686429977416992
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.610 Test Loss: 1.428 Test Acc: 0.610
Validation loss decreased (-0.609986 --> -0.609986).  Saving model ...
Epoch: 49 cost time: 6.156803131103516
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.613 Test Loss: 1.426 Test Acc: 0.613
Validation loss decreased (-0.609986 --> -0.613319).  Saving model ...
Epoch: 50 cost time: 6.480154275894165
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.610 Test Loss: 1.423 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 6.164381265640259
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.623 Test Loss: 1.416 Test Acc: 0.623
Validation loss decreased (-0.613319 --> -0.623319).  Saving model ...
Epoch: 52 cost time: 6.498608827590942
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.623 Test Loss: 1.412 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 53 cost time: 6.245968580245972
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.623 Test Loss: 1.409 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 54 cost time: 6.071850538253784
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.627 Test Loss: 1.405 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626653).  Saving model ...
Epoch: 55 cost time: 5.383811712265015
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.623 Test Loss: 1.401 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 5.919005632400513
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.623 Test Loss: 1.396 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 5.488513946533203
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.623 Test Loss: 1.393 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 6.213263750076294
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.623 Test Loss: 1.390 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 6.683809041976929
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.623 Test Loss: 1.387 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 5.586900949478149
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.627 Test Loss: 1.384 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 61 cost time: 6.0533998012542725
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.620 Test Loss: 1.386 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.013020753860474
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.627 Test Loss: 1.383 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 63 cost time: 5.890093564987183
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.627 Test Loss: 1.381 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 64 cost time: 6.425847053527832
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.627 Test Loss: 1.376 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 65 cost time: 6.380598068237305
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.375 Vali Acc: 0.627 Test Loss: 1.375 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 66 cost time: 5.983215093612671
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.627 Test Loss: 1.373 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 67 cost time: 6.096658945083618
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.627 Test Loss: 1.371 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 68 cost time: 6.1519739627838135
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.633 Test Loss: 1.367 Test Acc: 0.633
Validation loss decreased (-0.626653 --> -0.633320).  Saving model ...
Epoch: 69 cost time: 6.382354497909546
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.633 Test Loss: 1.365 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 70 cost time: 6.151087284088135
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.633 Test Loss: 1.363 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 71 cost time: 5.898946046829224
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.630 Test Loss: 1.364 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.913804769515991
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.630 Test Loss: 1.363 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 5.715451955795288
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.630 Test Loss: 1.364 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 5.961681127548218
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.633 Test Loss: 1.365 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 6.157520771026611
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.633 Test Loss: 1.365 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 5.736382961273193
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.362 Vali Acc: 0.633 Test Loss: 1.362 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 77 cost time: 5.947577476501465
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.633 Test Loss: 1.359 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 78 cost time: 6.906763076782227
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.640 Test Loss: 1.357 Test Acc: 0.640
Validation loss decreased (-0.633320 --> -0.639986).  Saving model ...
Epoch: 79 cost time: 6.382138967514038
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.637 Test Loss: 1.354 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 6.322873830795288
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.633 Test Loss: 1.352 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 5.925329923629761
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.637 Test Loss: 1.350 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 6.004125356674194
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.637 Test Loss: 1.349 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 6.007537841796875
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.637 Test Loss: 1.347 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 6.240829944610596
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.647 Test Loss: 1.345 Test Acc: 0.647
Validation loss decreased (-0.639986 --> -0.646653).  Saving model ...
Epoch: 85 cost time: 6.392864465713501
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.643 Test Loss: 1.343 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 5.921622037887573
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.637 Test Loss: 1.345 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 5.770285129547119
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.647 Test Loss: 1.343 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 88 cost time: 5.84686541557312
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.650 Test Loss: 1.340 Test Acc: 0.650
Validation loss decreased (-0.646653 --> -0.649987).  Saving model ...
Epoch: 89 cost time: 6.41303014755249
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.647 Test Loss: 1.338 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 6.790658473968506
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.650 Test Loss: 1.337 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 91 cost time: 6.323827505111694
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.657 Test Loss: 1.339 Test Acc: 0.657
Validation loss decreased (-0.649987 --> -0.656653).  Saving model ...
Epoch: 92 cost time: 6.055227994918823
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.657 Test Loss: 1.338 Test Acc: 0.657
Validation loss decreased (-0.656653 --> -0.656653).  Saving model ...
Epoch: 93 cost time: 6.875231742858887
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.660 Test Loss: 1.335 Test Acc: 0.660
Validation loss decreased (-0.656653 --> -0.659987).  Saving model ...
Epoch: 94 cost time: 6.250401735305786
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.334 Vali Acc: 0.660 Test Loss: 1.334 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
Epoch: 95 cost time: 6.8989293575286865
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.660 Test Loss: 1.333 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
Epoch: 96 cost time: 6.131769418716431
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.330 Vali Acc: 0.660 Test Loss: 1.330 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
Epoch: 97 cost time: 5.934338092803955
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.660 Test Loss: 1.327 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
Epoch: 98 cost time: 6.1380133628845215
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.657 Test Loss: 1.328 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 6.3061134815216064
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.650 Test Loss: 1.332 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 6.0174336433410645
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.653 Test Loss: 1.329 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.66
model parameter : 2698777
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.9944212436676025
Epoch: 1, Steps: 18 | Train Loss: 3.244 Vali Loss: 3.167 Vali Acc: 0.070 Test Loss: 3.167 Test Acc: 0.070
Validation loss decreased (inf --> -0.069968).  Saving model ...
Epoch: 2 cost time: 5.617918491363525
Epoch: 2, Steps: 18 | Train Loss: 2.730 Vali Loss: 3.000 Vali Acc: 0.143 Test Loss: 3.000 Test Acc: 0.143
Validation loss decreased (-0.069968 --> -0.143303).  Saving model ...
Epoch: 3 cost time: 6.163750410079956
Epoch: 3, Steps: 18 | Train Loss: 1.921 Vali Loss: 2.839 Vali Acc: 0.180 Test Loss: 2.839 Test Acc: 0.180
Validation loss decreased (-0.143303 --> -0.179972).  Saving model ...
Epoch: 4 cost time: 6.1335999965667725
Epoch: 4, Steps: 18 | Train Loss: 1.118 Vali Loss: 2.689 Vali Acc: 0.217 Test Loss: 2.689 Test Acc: 0.217
Validation loss decreased (-0.179972 --> -0.216640).  Saving model ...
Epoch: 5 cost time: 6.52259087562561
Epoch: 5, Steps: 18 | Train Loss: 0.494 Vali Loss: 2.610 Vali Acc: 0.220 Test Loss: 2.610 Test Acc: 0.220
Validation loss decreased (-0.216640 --> -0.219974).  Saving model ...
Epoch: 6 cost time: 6.511724948883057
Epoch: 6, Steps: 18 | Train Loss: 0.195 Vali Loss: 2.476 Vali Acc: 0.270 Test Loss: 2.476 Test Acc: 0.270
Validation loss decreased (-0.219974 --> -0.269975).  Saving model ...
Epoch: 7 cost time: 6.3396759033203125
Epoch: 7, Steps: 18 | Train Loss: 0.058 Vali Loss: 2.384 Vali Acc: 0.277 Test Loss: 2.384 Test Acc: 0.277
Validation loss decreased (-0.269975 --> -0.276643).  Saving model ...
Epoch: 8 cost time: 5.866623401641846
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 2.242 Vali Acc: 0.320 Test Loss: 2.242 Test Acc: 0.320
Validation loss decreased (-0.276643 --> -0.319978).  Saving model ...
Epoch: 9 cost time: 6.146055459976196
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 2.152 Vali Acc: 0.363 Test Loss: 2.152 Test Acc: 0.363
Validation loss decreased (-0.319978 --> -0.363312).  Saving model ...
Epoch: 10 cost time: 6.520516633987427
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.053 Vali Acc: 0.370 Test Loss: 2.053 Test Acc: 0.370
Validation loss decreased (-0.363312 --> -0.369979).  Saving model ...
Epoch: 11 cost time: 6.479721546173096
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.994 Vali Acc: 0.403 Test Loss: 1.994 Test Acc: 0.403
Validation loss decreased (-0.369979 --> -0.403313).  Saving model ...
Epoch: 12 cost time: 6.52841854095459
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.950 Vali Acc: 0.413 Test Loss: 1.950 Test Acc: 0.413
Validation loss decreased (-0.403313 --> -0.413314).  Saving model ...
Epoch: 13 cost time: 5.730247735977173
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.907 Vali Acc: 0.423 Test Loss: 1.907 Test Acc: 0.423
Validation loss decreased (-0.413314 --> -0.423314).  Saving model ...
Epoch: 14 cost time: 6.425557374954224
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.858 Vali Acc: 0.450 Test Loss: 1.858 Test Acc: 0.450
Validation loss decreased (-0.423314 --> -0.449981).  Saving model ...
Epoch: 15 cost time: 5.969133377075195
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.821 Vali Acc: 0.470 Test Loss: 1.821 Test Acc: 0.470
Validation loss decreased (-0.449981 --> -0.469982).  Saving model ...
Epoch: 16 cost time: 6.696398019790649
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.794 Vali Acc: 0.477 Test Loss: 1.794 Test Acc: 0.477
Validation loss decreased (-0.469982 --> -0.476649).  Saving model ...
Epoch: 17 cost time: 6.5356764793396
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.783 Vali Acc: 0.463 Test Loss: 1.783 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.612066030502319
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.751 Vali Acc: 0.480 Test Loss: 1.751 Test Acc: 0.480
Validation loss decreased (-0.476649 --> -0.479982).  Saving model ...
Epoch: 19 cost time: 6.023782730102539
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.725 Vali Acc: 0.493 Test Loss: 1.725 Test Acc: 0.493
Validation loss decreased (-0.479982 --> -0.493316).  Saving model ...
Epoch: 20 cost time: 6.356279134750366
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.694 Vali Acc: 0.503 Test Loss: 1.694 Test Acc: 0.503
Validation loss decreased (-0.493316 --> -0.503316).  Saving model ...
Epoch: 21 cost time: 6.438817262649536
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.667 Vali Acc: 0.530 Test Loss: 1.667 Test Acc: 0.530
Validation loss decreased (-0.503316 --> -0.529983).  Saving model ...
Epoch: 22 cost time: 6.347534418106079
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.658 Vali Acc: 0.523 Test Loss: 1.658 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.5093324184417725
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.530 Test Loss: 1.633 Test Acc: 0.530
Validation loss decreased (-0.529983 --> -0.529984).  Saving model ...
Epoch: 24 cost time: 5.928631782531738
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.617 Vali Acc: 0.547 Test Loss: 1.617 Test Acc: 0.547
Validation loss decreased (-0.529984 --> -0.546651).  Saving model ...
Epoch: 25 cost time: 6.2938315868377686
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.597 Vali Acc: 0.560 Test Loss: 1.597 Test Acc: 0.560
Validation loss decreased (-0.546651 --> -0.559984).  Saving model ...
Epoch: 26 cost time: 6.005695343017578
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.587 Vali Acc: 0.567 Test Loss: 1.587 Test Acc: 0.567
Validation loss decreased (-0.559984 --> -0.566651).  Saving model ...
Epoch: 27 cost time: 6.26709508895874
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.563 Test Loss: 1.576 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.482683420181274
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.553 Test Loss: 1.566 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.609647512435913
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.557 Vali Acc: 0.560 Test Loss: 1.557 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.711798906326294
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.548 Vali Acc: 0.570 Test Loss: 1.548 Test Acc: 0.570
Validation loss decreased (-0.566651 --> -0.569985).  Saving model ...
Epoch: 31 cost time: 6.35429835319519
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.577 Test Loss: 1.532 Test Acc: 0.577
Validation loss decreased (-0.569985 --> -0.576651).  Saving model ...
Epoch: 32 cost time: 6.524746656417847
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.514 Vali Acc: 0.587 Test Loss: 1.514 Test Acc: 0.587
Validation loss decreased (-0.576651 --> -0.586652).  Saving model ...
Epoch: 33 cost time: 6.362506151199341
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.506 Vali Acc: 0.583 Test Loss: 1.506 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.557260990142822
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.580 Test Loss: 1.500 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.434869766235352
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.577 Test Loss: 1.496 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 6.435596227645874
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.487 Vali Acc: 0.590 Test Loss: 1.487 Test Acc: 0.590
Validation loss decreased (-0.586652 --> -0.589985).  Saving model ...
Epoch: 37 cost time: 5.688180923461914
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.483 Vali Acc: 0.597 Test Loss: 1.483 Test Acc: 0.597
Validation loss decreased (-0.589985 --> -0.596652).  Saving model ...
Epoch: 38 cost time: 6.339730978012085
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.597 Test Loss: 1.477 Test Acc: 0.597
Validation loss decreased (-0.596652 --> -0.596652).  Saving model ...
Epoch: 39 cost time: 6.499980449676514
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.603 Test Loss: 1.471 Test Acc: 0.603
Validation loss decreased (-0.596652 --> -0.603319).  Saving model ...
Epoch: 40 cost time: 6.442591190338135
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.603 Test Loss: 1.464 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 41 cost time: 5.616704940795898
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.459 Vali Acc: 0.603 Test Loss: 1.459 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 42 cost time: 6.4917685985565186
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.607 Test Loss: 1.453 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606652).  Saving model ...
Epoch: 43 cost time: 6.075161695480347
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.607 Test Loss: 1.447 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 44 cost time: 6.802645683288574
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.607 Test Loss: 1.440 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 45 cost time: 6.5802648067474365
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.610 Test Loss: 1.434 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 46 cost time: 5.8758862018585205
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.617 Test Loss: 1.426 Test Acc: 0.617
Validation loss decreased (-0.609986 --> -0.616652).  Saving model ...
Epoch: 47 cost time: 6.363963603973389
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.613 Test Loss: 1.420 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 6.206574440002441
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.627 Test Loss: 1.414 Test Acc: 0.627
Validation loss decreased (-0.616652 --> -0.626653).  Saving model ...
Epoch: 49 cost time: 6.799548625946045
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.627 Test Loss: 1.413 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 50 cost time: 6.268134355545044
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.627 Test Loss: 1.410 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 51 cost time: 6.222315311431885
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.623 Test Loss: 1.405 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.650746583938599
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.620 Test Loss: 1.401 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 5.672505140304565
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.627 Test Loss: 1.395 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 54 cost time: 5.929340839385986
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.630 Test Loss: 1.388 Test Acc: 0.630
Validation loss decreased (-0.626653 --> -0.629986).  Saving model ...
Epoch: 55 cost time: 6.317430019378662
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.630 Test Loss: 1.383 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 56 cost time: 6.104055166244507
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.630 Test Loss: 1.382 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 57 cost time: 6.4153618812561035
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.637 Test Loss: 1.382 Test Acc: 0.637
Validation loss decreased (-0.629986 --> -0.636653).  Saving model ...
Epoch: 58 cost time: 6.168564796447754
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.633 Test Loss: 1.380 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.549126386642456
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.375 Vali Acc: 0.633 Test Loss: 1.375 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 6.599701404571533
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.633 Test Loss: 1.371 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 6.565413236618042
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.637 Test Loss: 1.368 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 62 cost time: 6.604550838470459
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.633 Test Loss: 1.369 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 6.446680068969727
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.630 Test Loss: 1.366 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 6.139480113983154
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.637 Test Loss: 1.361 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 65 cost time: 5.949087858200073
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.637 Test Loss: 1.359 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 66 cost time: 6.627201795578003
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.637 Test Loss: 1.355 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 67 cost time: 6.585318565368652
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.640 Test Loss: 1.355 Test Acc: 0.640
Validation loss decreased (-0.636653 --> -0.639986).  Saving model ...
Epoch: 68 cost time: 5.797579765319824
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.630 Test Loss: 1.355 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 5.894447565078735
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.633 Test Loss: 1.354 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 5.978088140487671
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.637 Test Loss: 1.351 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 6.749985694885254
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.637 Test Loss: 1.349 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 6.604637622833252
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.640 Test Loss: 1.345 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639987).  Saving model ...
Epoch: 73 cost time: 6.428388833999634
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.640 Test Loss: 1.345 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639987).  Saving model ...
Epoch: 74 cost time: 6.136459112167358
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.640 Test Loss: 1.346 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 6.172201871871948
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.643 Test Loss: 1.346 Test Acc: 0.643
Validation loss decreased (-0.639987 --> -0.643320).  Saving model ...
Epoch: 76 cost time: 6.560192346572876
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.647 Test Loss: 1.342 Test Acc: 0.647
Validation loss decreased (-0.643320 --> -0.646653).  Saving model ...
Epoch: 77 cost time: 6.138484001159668
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.647 Test Loss: 1.340 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 78 cost time: 5.941119909286499
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.647 Test Loss: 1.338 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 79 cost time: 6.202232599258423
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.647 Test Loss: 1.336 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 80 cost time: 6.517176628112793
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.650 Test Loss: 1.336 Test Acc: 0.650
Validation loss decreased (-0.646653 --> -0.649987).  Saving model ...
Epoch: 81 cost time: 6.4002416133880615
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.334 Vali Acc: 0.650 Test Loss: 1.334 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 82 cost time: 5.872546195983887
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.331 Vali Acc: 0.653 Test Loss: 1.331 Test Acc: 0.653
Validation loss decreased (-0.649987 --> -0.653320).  Saving model ...
Epoch: 83 cost time: 6.204338312149048
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.653 Test Loss: 1.328 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 84 cost time: 6.759421110153198
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.325 Vali Acc: 0.650 Test Loss: 1.325 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 6.558579444885254
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.650 Test Loss: 1.324 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 6.483043670654297
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.650 Test Loss: 1.324 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 6.6351940631866455
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.650 Test Loss: 1.322 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 5.985184907913208
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.653 Test Loss: 1.320 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 89 cost time: 6.094433069229126
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.657 Test Loss: 1.317 Test Acc: 0.657
Validation loss decreased (-0.653320 --> -0.656653).  Saving model ...
Epoch: 90 cost time: 6.995273113250732
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.653 Test Loss: 1.315 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 6.649754047393799
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.653 Test Loss: 1.317 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 6.433764219284058
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.653 Test Loss: 1.316 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 6.0205323696136475
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.653 Test Loss: 1.315 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 6.315290689468384
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.653 Test Loss: 1.314 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 6.099247694015503
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.311 Vali Acc: 0.653 Test Loss: 1.311 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 6.0916383266448975
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.310 Vali Acc: 0.653 Test Loss: 1.310 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 6.235698461532593
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.309 Vali Acc: 0.657 Test Loss: 1.309 Test Acc: 0.657
Validation loss decreased (-0.656653 --> -0.656654).  Saving model ...
Epoch: 98 cost time: 6.117701768875122
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.309 Vali Acc: 0.667 Test Loss: 1.309 Test Acc: 0.667
Validation loss decreased (-0.656654 --> -0.666654).  Saving model ...
Epoch: 99 cost time: 6.38273811340332
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.309 Vali Acc: 0.663 Test Loss: 1.309 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 6.085162401199341
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.306 Vali Acc: 0.670 Test Loss: 1.306 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669987).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.67
model parameter : 2698777
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.377451419830322
Epoch: 1, Steps: 18 | Train Loss: 3.236 Vali Loss: 3.199 Vali Acc: 0.073 Test Loss: 3.199 Test Acc: 0.073
Validation loss decreased (inf --> -0.073301).  Saving model ...
Epoch: 2 cost time: 5.894105434417725
Epoch: 2, Steps: 18 | Train Loss: 2.836 Vali Loss: 3.035 Vali Acc: 0.110 Test Loss: 3.035 Test Acc: 0.110
Validation loss decreased (-0.073301 --> -0.109970).  Saving model ...
Epoch: 3 cost time: 6.313030958175659
Epoch: 3, Steps: 18 | Train Loss: 2.097 Vali Loss: 2.873 Vali Acc: 0.147 Test Loss: 2.873 Test Acc: 0.147
Validation loss decreased (-0.109970 --> -0.146638).  Saving model ...
Epoch: 4 cost time: 5.985328197479248
Epoch: 4, Steps: 18 | Train Loss: 1.286 Vali Loss: 2.721 Vali Acc: 0.163 Test Loss: 2.721 Test Acc: 0.163
Validation loss decreased (-0.146638 --> -0.163306).  Saving model ...
Epoch: 5 cost time: 6.03540563583374
Epoch: 5, Steps: 18 | Train Loss: 0.644 Vali Loss: 2.619 Vali Acc: 0.213 Test Loss: 2.619 Test Acc: 0.213
Validation loss decreased (-0.163306 --> -0.213307).  Saving model ...
Epoch: 6 cost time: 6.293614625930786
Epoch: 6, Steps: 18 | Train Loss: 0.306 Vali Loss: 2.429 Vali Acc: 0.240 Test Loss: 2.429 Test Acc: 0.240
Validation loss decreased (-0.213307 --> -0.239976).  Saving model ...
Epoch: 7 cost time: 5.516448497772217
Epoch: 7, Steps: 18 | Train Loss: 0.096 Vali Loss: 2.260 Vali Acc: 0.303 Test Loss: 2.260 Test Acc: 0.303
Validation loss decreased (-0.239976 --> -0.303311).  Saving model ...
Epoch: 8 cost time: 5.669832944869995
Epoch: 8, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.987 Vali Acc: 0.370 Test Loss: 1.987 Test Acc: 0.370
Validation loss decreased (-0.303311 --> -0.369980).  Saving model ...
Epoch: 9 cost time: 6.240800142288208
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.895 Vali Acc: 0.427 Test Loss: 1.895 Test Acc: 0.427
Validation loss decreased (-0.369980 --> -0.426648).  Saving model ...
Epoch: 10 cost time: 7.148114442825317
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.797 Vali Acc: 0.457 Test Loss: 1.797 Test Acc: 0.457
Validation loss decreased (-0.426648 --> -0.456649).  Saving model ...
Epoch: 11 cost time: 6.462158918380737
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.730 Vali Acc: 0.473 Test Loss: 1.730 Test Acc: 0.473
Validation loss decreased (-0.456649 --> -0.473316).  Saving model ...
Epoch: 12 cost time: 5.604885816574097
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.703 Vali Acc: 0.483 Test Loss: 1.703 Test Acc: 0.483
Validation loss decreased (-0.473316 --> -0.483316).  Saving model ...
Epoch: 13 cost time: 6.280675172805786
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.645 Vali Acc: 0.507 Test Loss: 1.645 Test Acc: 0.507
Validation loss decreased (-0.483316 --> -0.506650).  Saving model ...
Epoch: 14 cost time: 5.990784406661987
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.589 Vali Acc: 0.523 Test Loss: 1.589 Test Acc: 0.523
Validation loss decreased (-0.506650 --> -0.523317).  Saving model ...
Epoch: 15 cost time: 6.556825399398804
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.559 Vali Acc: 0.533 Test Loss: 1.559 Test Acc: 0.533
Validation loss decreased (-0.523317 --> -0.533318).  Saving model ...
Epoch: 16 cost time: 6.3879477977752686
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.551 Vali Acc: 0.533 Test Loss: 1.551 Test Acc: 0.533
Validation loss decreased (-0.533318 --> -0.533318).  Saving model ...
Epoch: 17 cost time: 5.9386820793151855
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.534 Vali Acc: 0.543 Test Loss: 1.534 Test Acc: 0.543
Validation loss decreased (-0.533318 --> -0.543318).  Saving model ...
Epoch: 18 cost time: 5.9527788162231445
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.528 Vali Acc: 0.543 Test Loss: 1.528 Test Acc: 0.543
Validation loss decreased (-0.543318 --> -0.543318).  Saving model ...
Epoch: 19 cost time: 5.760677337646484
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.521 Vali Acc: 0.550 Test Loss: 1.521 Test Acc: 0.550
Validation loss decreased (-0.543318 --> -0.549985).  Saving model ...
Epoch: 20 cost time: 6.32286810874939
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.488 Vali Acc: 0.563 Test Loss: 1.488 Test Acc: 0.563
Validation loss decreased (-0.549985 --> -0.563318).  Saving model ...
Epoch: 21 cost time: 6.587855339050293
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.476 Vali Acc: 0.567 Test Loss: 1.476 Test Acc: 0.567
Validation loss decreased (-0.563318 --> -0.566652).  Saving model ...
Epoch: 22 cost time: 6.224061489105225
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.469 Vali Acc: 0.567 Test Loss: 1.469 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566652).  Saving model ...
Epoch: 23 cost time: 6.04968786239624
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.446 Vali Acc: 0.573 Test Loss: 1.446 Test Acc: 0.573
Validation loss decreased (-0.566652 --> -0.573319).  Saving model ...
Epoch: 24 cost time: 6.136656761169434
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.431 Vali Acc: 0.573 Test Loss: 1.431 Test Acc: 0.573
Validation loss decreased (-0.573319 --> -0.573319).  Saving model ...
Epoch: 25 cost time: 6.751383543014526
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.417 Vali Acc: 0.580 Test Loss: 1.417 Test Acc: 0.580
Validation loss decreased (-0.573319 --> -0.579986).  Saving model ...
Epoch: 26 cost time: 6.525054693222046
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.407 Vali Acc: 0.590 Test Loss: 1.407 Test Acc: 0.590
Validation loss decreased (-0.579986 --> -0.589986).  Saving model ...
Epoch: 27 cost time: 6.369337797164917
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.397 Vali Acc: 0.597 Test Loss: 1.397 Test Acc: 0.597
Validation loss decreased (-0.589986 --> -0.596653).  Saving model ...
Epoch: 28 cost time: 6.127610206604004
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.385 Vali Acc: 0.603 Test Loss: 1.385 Test Acc: 0.603
Validation loss decreased (-0.596653 --> -0.603319).  Saving model ...
Epoch: 29 cost time: 6.131600856781006
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.369 Vali Acc: 0.607 Test Loss: 1.369 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606653).  Saving model ...
Epoch: 30 cost time: 6.138650178909302
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.365 Vali Acc: 0.613 Test Loss: 1.365 Test Acc: 0.613
Validation loss decreased (-0.606653 --> -0.613320).  Saving model ...
Epoch: 31 cost time: 6.294522523880005
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.359 Vali Acc: 0.623 Test Loss: 1.359 Test Acc: 0.623
Validation loss decreased (-0.613320 --> -0.623320).  Saving model ...
Epoch: 32 cost time: 6.340565204620361
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.353 Vali Acc: 0.613 Test Loss: 1.353 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.805984735488892
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.352 Vali Acc: 0.610 Test Loss: 1.352 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.155971527099609
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.347 Vali Acc: 0.610 Test Loss: 1.347 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 6.275222539901733
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.620 Test Loss: 1.346 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 6.478386878967285
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.331 Vali Acc: 0.627 Test Loss: 1.331 Test Acc: 0.627
Validation loss decreased (-0.623320 --> -0.626653).  Saving model ...
Epoch: 37 cost time: 6.0850207805633545
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.630 Test Loss: 1.321 Test Acc: 0.630
Validation loss decreased (-0.626653 --> -0.629987).  Saving model ...
Epoch: 38 cost time: 5.759111166000366
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.311 Vali Acc: 0.630 Test Loss: 1.311 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 39 cost time: 5.942225694656372
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.305 Vali Acc: 0.630 Test Loss: 1.305 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 40 cost time: 6.435362100601196
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.301 Vali Acc: 0.633 Test Loss: 1.301 Test Acc: 0.633
Validation loss decreased (-0.629987 --> -0.633320).  Saving model ...
Epoch: 41 cost time: 6.574256181716919
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.630 Test Loss: 1.297 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.86331582069397
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.637 Test Loss: 1.292 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.636654).  Saving model ...
Epoch: 43 cost time: 5.601361513137817
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.293 Vali Acc: 0.637 Test Loss: 1.293 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 5.810270309448242
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.289 Vali Acc: 0.637 Test Loss: 1.289 Test Acc: 0.637
Validation loss decreased (-0.636654 --> -0.636654).  Saving model ...
Epoch: 45 cost time: 6.172325611114502
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.637 Test Loss: 1.285 Test Acc: 0.637
Validation loss decreased (-0.636654 --> -0.636654).  Saving model ...
Epoch: 46 cost time: 6.44120454788208
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.286 Vali Acc: 0.640 Test Loss: 1.286 Test Acc: 0.640
Validation loss decreased (-0.636654 --> -0.639987).  Saving model ...
Epoch: 47 cost time: 5.866955518722534
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.278 Vali Acc: 0.640 Test Loss: 1.278 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639987).  Saving model ...
Epoch: 48 cost time: 5.727855205535889
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.643 Test Loss: 1.273 Test Acc: 0.643
Validation loss decreased (-0.639987 --> -0.643321).  Saving model ...
Epoch: 49 cost time: 6.20586085319519
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.272 Vali Acc: 0.640 Test Loss: 1.272 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.1882734298706055
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.643 Test Loss: 1.268 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 51 cost time: 6.830571413040161
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.643 Test Loss: 1.268 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 52 cost time: 6.253744840621948
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.643 Test Loss: 1.267 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 53 cost time: 6.283286094665527
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.650 Test Loss: 1.259 Test Acc: 0.650
Validation loss decreased (-0.643321 --> -0.649987).  Saving model ...
Epoch: 54 cost time: 6.071496963500977
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.657 Test Loss: 1.251 Test Acc: 0.657
Validation loss decreased (-0.649987 --> -0.656654).  Saving model ...
Epoch: 55 cost time: 6.099352121353149
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.650 Test Loss: 1.246 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 6.29260778427124
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.653 Test Loss: 1.245 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 5.836481332778931
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.650 Test Loss: 1.239 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 6.072091579437256
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.660 Test Loss: 1.235 Test Acc: 0.660
Validation loss decreased (-0.656654 --> -0.659988).  Saving model ...
Epoch: 59 cost time: 5.589454650878906
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.667 Test Loss: 1.231 Test Acc: 0.667
Validation loss decreased (-0.659988 --> -0.666654).  Saving model ...
Epoch: 60 cost time: 6.322052955627441
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.663 Test Loss: 1.230 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.21328330039978
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.663 Test Loss: 1.230 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 6.092550039291382
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.660 Test Loss: 1.233 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 6.369527578353882
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.653 Test Loss: 1.235 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 6.03366231918335
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.653 Test Loss: 1.235 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 6.370103597640991
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.667 Test Loss: 1.233 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 6.182314872741699
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.663 Test Loss: 1.229 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 5.970381736755371
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.673 Test Loss: 1.227 Test Acc: 0.673
Validation loss decreased (-0.666654 --> -0.673321).  Saving model ...
Epoch: 68 cost time: 5.799839973449707
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.677 Test Loss: 1.226 Test Acc: 0.677
Validation loss decreased (-0.673321 --> -0.676654).  Saving model ...
Epoch: 69 cost time: 5.5621724128723145
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.677 Test Loss: 1.223 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 70 cost time: 5.673660039901733
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.683 Test Loss: 1.220 Test Acc: 0.683
Validation loss decreased (-0.676654 --> -0.683321).  Saving model ...
Epoch: 71 cost time: 5.503304958343506
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.683 Test Loss: 1.223 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.745641231536865
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.680 Test Loss: 1.221 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 5.708819150924683
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.680 Test Loss: 1.219 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 5.719385623931885
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.677 Test Loss: 1.218 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 5.970790147781372
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.680 Test Loss: 1.217 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 5.665886878967285
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.680 Test Loss: 1.215 Test Acc: 0.680
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 5.579103708267212
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.680 Test Loss: 1.214 Test Acc: 0.680
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 5.591067552566528
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.680 Test Loss: 1.214 Test Acc: 0.680
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 6.120563507080078
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.680 Test Loss: 1.215 Test Acc: 0.680
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 5.962926626205444
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.683 Test Loss: 1.216 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 81 cost time: 5.869866847991943
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.687 Test Loss: 1.214 Test Acc: 0.687
Validation loss decreased (-0.683321 --> -0.686655).  Saving model ...
Epoch: 82 cost time: 6.099409818649292
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.690 Test Loss: 1.213 Test Acc: 0.690
Validation loss decreased (-0.686655 --> -0.689988).  Saving model ...
Epoch: 83 cost time: 6.018187761306763
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.687 Test Loss: 1.211 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 6.314049959182739
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.690 Test Loss: 1.209 Test Acc: 0.690
Validation loss decreased (-0.689988 --> -0.689988).  Saving model ...
Epoch: 85 cost time: 6.008104562759399
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.683 Test Loss: 1.209 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 5.871469259262085
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.683 Test Loss: 1.208 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 5.9833738803863525
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.680 Test Loss: 1.206 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 5.470674991607666
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.687 Test Loss: 1.206 Test Acc: 0.687
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 6.390933990478516
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.687 Test Loss: 1.206 Test Acc: 0.687
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 6.540461301803589
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.690 Test Loss: 1.204 Test Acc: 0.690
Validation loss decreased (-0.689988 --> -0.689988).  Saving model ...
Epoch: 91 cost time: 6.371049165725708
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.690 Test Loss: 1.204 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 5.798001050949097
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.693 Test Loss: 1.203 Test Acc: 0.693
Validation loss decreased (-0.689988 --> -0.693321).  Saving model ...
Epoch: 93 cost time: 6.017801284790039
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.200 Vali Acc: 0.690 Test Loss: 1.200 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 7.154965877532959
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.690 Test Loss: 1.199 Test Acc: 0.690
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 6.660910606384277
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.196 Vali Acc: 0.693 Test Loss: 1.196 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 96 cost time: 5.885418891906738
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.693 Test Loss: 1.198 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 5.64760422706604
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.697 Test Loss: 1.199 Test Acc: 0.697
Validation loss decreased (-0.693321 --> -0.696655).  Saving model ...
Epoch: 98 cost time: 5.5233659744262695
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.703 Test Loss: 1.204 Test Acc: 0.703
Validation loss decreased (-0.696655 --> -0.703321).  Saving model ...
Epoch: 99 cost time: 5.782480239868164
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.700 Test Loss: 1.204 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 5.966619253158569
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.697 Test Loss: 1.203 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7033333333333334
model parameter : 2698777
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.834513187408447
Epoch: 1, Steps: 18 | Train Loss: 3.271 Vali Loss: 3.207 Vali Acc: 0.047 Test Loss: 3.207 Test Acc: 0.047
Validation loss decreased (inf --> -0.046635).  Saving model ...
Epoch: 2 cost time: 5.93003249168396
Epoch: 2, Steps: 18 | Train Loss: 2.878 Vali Loss: 3.068 Vali Acc: 0.117 Test Loss: 3.068 Test Acc: 0.117
Validation loss decreased (-0.046635 --> -0.116636).  Saving model ...
Epoch: 3 cost time: 6.218991994857788
Epoch: 3, Steps: 18 | Train Loss: 2.122 Vali Loss: 2.913 Vali Acc: 0.147 Test Loss: 2.913 Test Acc: 0.147
Validation loss decreased (-0.116636 --> -0.146638).  Saving model ...
Epoch: 4 cost time: 6.61528754234314
Epoch: 4, Steps: 18 | Train Loss: 1.358 Vali Loss: 2.736 Vali Acc: 0.213 Test Loss: 2.736 Test Acc: 0.213
Validation loss decreased (-0.146638 --> -0.213306).  Saving model ...
Epoch: 5 cost time: 6.250296115875244
Epoch: 5, Steps: 18 | Train Loss: 0.679 Vali Loss: 2.615 Vali Acc: 0.213 Test Loss: 2.615 Test Acc: 0.213
Validation loss decreased (-0.213306 --> -0.213307).  Saving model ...
Epoch: 6 cost time: 6.477939605712891
Epoch: 6, Steps: 18 | Train Loss: 0.306 Vali Loss: 2.410 Vali Acc: 0.290 Test Loss: 2.410 Test Acc: 0.290
Validation loss decreased (-0.213307 --> -0.289976).  Saving model ...
Epoch: 7 cost time: 5.952288389205933
Epoch: 7, Steps: 18 | Train Loss: 0.095 Vali Loss: 2.188 Vali Acc: 0.303 Test Loss: 2.188 Test Acc: 0.303
Validation loss decreased (-0.289976 --> -0.303311).  Saving model ...
Epoch: 8 cost time: 6.748061895370483
Epoch: 8, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.955 Vali Acc: 0.363 Test Loss: 1.955 Test Acc: 0.363
Validation loss decreased (-0.303311 --> -0.363314).  Saving model ...
Epoch: 9 cost time: 6.249718189239502
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.850 Vali Acc: 0.433 Test Loss: 1.850 Test Acc: 0.433
Validation loss decreased (-0.363314 --> -0.433315).  Saving model ...
Epoch: 10 cost time: 5.808592319488525
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.741 Vali Acc: 0.457 Test Loss: 1.741 Test Acc: 0.457
Validation loss decreased (-0.433315 --> -0.456649).  Saving model ...
Epoch: 11 cost time: 5.9130775928497314
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.678 Vali Acc: 0.490 Test Loss: 1.678 Test Acc: 0.490
Validation loss decreased (-0.456649 --> -0.489983).  Saving model ...
Epoch: 12 cost time: 6.1237571239471436
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.642 Vali Acc: 0.497 Test Loss: 1.642 Test Acc: 0.497
Validation loss decreased (-0.489983 --> -0.496650).  Saving model ...
Epoch: 13 cost time: 6.158498525619507
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.596 Vali Acc: 0.520 Test Loss: 1.596 Test Acc: 0.520
Validation loss decreased (-0.496650 --> -0.519984).  Saving model ...
Epoch: 14 cost time: 6.241601228713989
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.553 Vali Acc: 0.510 Test Loss: 1.553 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.1479527950286865
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.526 Vali Acc: 0.530 Test Loss: 1.526 Test Acc: 0.530
Validation loss decreased (-0.519984 --> -0.529985).  Saving model ...
Epoch: 16 cost time: 6.27705979347229
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.501 Vali Acc: 0.547 Test Loss: 1.501 Test Acc: 0.547
Validation loss decreased (-0.529985 --> -0.546652).  Saving model ...
Epoch: 17 cost time: 5.964084625244141
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.481 Vali Acc: 0.533 Test Loss: 1.481 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.440589189529419
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.468 Vali Acc: 0.543 Test Loss: 1.468 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.32001519203186
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.457 Vali Acc: 0.550 Test Loss: 1.457 Test Acc: 0.550
Validation loss decreased (-0.546652 --> -0.549985).  Saving model ...
Epoch: 20 cost time: 6.375363111495972
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.429 Vali Acc: 0.567 Test Loss: 1.429 Test Acc: 0.567
Validation loss decreased (-0.549985 --> -0.566652).  Saving model ...
Epoch: 21 cost time: 5.925649404525757
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.409 Vali Acc: 0.570 Test Loss: 1.409 Test Acc: 0.570
Validation loss decreased (-0.566652 --> -0.569986).  Saving model ...
Epoch: 22 cost time: 5.969494581222534
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.570 Test Loss: 1.400 Test Acc: 0.570
Validation loss decreased (-0.569986 --> -0.569986).  Saving model ...
Epoch: 23 cost time: 5.898369789123535
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.573 Test Loss: 1.379 Test Acc: 0.573
Validation loss decreased (-0.569986 --> -0.573320).  Saving model ...
Epoch: 24 cost time: 6.214068412780762
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.365 Vali Acc: 0.577 Test Loss: 1.365 Test Acc: 0.577
Validation loss decreased (-0.573320 --> -0.576653).  Saving model ...
Epoch: 25 cost time: 6.2371275424957275
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.353 Vali Acc: 0.583 Test Loss: 1.353 Test Acc: 0.583
Validation loss decreased (-0.576653 --> -0.583320).  Saving model ...
Epoch: 26 cost time: 5.591883182525635
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.368 Vali Acc: 0.583 Test Loss: 1.368 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.696539640426636
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.349 Vali Acc: 0.580 Test Loss: 1.349 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.108052968978882
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.327 Vali Acc: 0.593 Test Loss: 1.327 Test Acc: 0.593
Validation loss decreased (-0.583320 --> -0.593320).  Saving model ...
Epoch: 29 cost time: 6.55439305305481
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.311 Vali Acc: 0.607 Test Loss: 1.311 Test Acc: 0.607
Validation loss decreased (-0.593320 --> -0.606654).  Saving model ...
Epoch: 30 cost time: 6.488073110580444
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.301 Vali Acc: 0.610 Test Loss: 1.301 Test Acc: 0.610
Validation loss decreased (-0.606654 --> -0.609987).  Saving model ...
Epoch: 31 cost time: 5.792546272277832
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.617 Test Loss: 1.288 Test Acc: 0.617
Validation loss decreased (-0.609987 --> -0.616654).  Saving model ...
Epoch: 32 cost time: 5.968406677246094
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.281 Vali Acc: 0.620 Test Loss: 1.281 Test Acc: 0.620
Validation loss decreased (-0.616654 --> -0.619987).  Saving model ...
Epoch: 33 cost time: 5.768770694732666
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.280 Vali Acc: 0.613 Test Loss: 1.280 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.527881622314453
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.272 Vali Acc: 0.610 Test Loss: 1.272 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.144348382949829
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.617 Test Loss: 1.266 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.715115547180176
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.623 Test Loss: 1.258 Test Acc: 0.623
Validation loss decreased (-0.619987 --> -0.623321).  Saving model ...
Epoch: 37 cost time: 5.6765501499176025
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.627 Test Loss: 1.254 Test Acc: 0.627
Validation loss decreased (-0.623321 --> -0.626654).  Saving model ...
Epoch: 38 cost time: 5.964916467666626
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.637 Test Loss: 1.247 Test Acc: 0.637
Validation loss decreased (-0.626654 --> -0.636654).  Saving model ...
Epoch: 39 cost time: 6.078767538070679
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.244 Vali Acc: 0.640 Test Loss: 1.244 Test Acc: 0.640
Validation loss decreased (-0.636654 --> -0.639988).  Saving model ...
Epoch: 40 cost time: 6.205404043197632
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.640 Test Loss: 1.235 Test Acc: 0.640
Validation loss decreased (-0.639988 --> -0.639988).  Saving model ...
Epoch: 41 cost time: 5.959455490112305
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.640 Test Loss: 1.235 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.41331934928894
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.643 Test Loss: 1.232 Test Acc: 0.643
Validation loss decreased (-0.639988 --> -0.643321).  Saving model ...
Epoch: 43 cost time: 5.957611560821533
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.643 Test Loss: 1.229 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 44 cost time: 6.438853979110718
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.647 Test Loss: 1.221 Test Acc: 0.647
Validation loss decreased (-0.643321 --> -0.646654).  Saving model ...
Epoch: 45 cost time: 6.1464338302612305
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.650 Test Loss: 1.212 Test Acc: 0.650
Validation loss decreased (-0.646654 --> -0.649988).  Saving model ...
Epoch: 46 cost time: 6.218493223190308
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.647 Test Loss: 1.210 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.224384307861328
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.640 Test Loss: 1.201 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 5.941773176193237
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.650 Test Loss: 1.199 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 49 cost time: 5.677435398101807
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.653 Test Loss: 1.195 Test Acc: 0.653
Validation loss decreased (-0.649988 --> -0.653321).  Saving model ...
Epoch: 50 cost time: 6.073192834854126
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.653 Test Loss: 1.190 Test Acc: 0.653
Validation loss decreased (-0.653321 --> -0.653321).  Saving model ...
Epoch: 51 cost time: 6.0045764446258545
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.650 Test Loss: 1.187 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.757175445556641
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.657 Test Loss: 1.187 Test Acc: 0.657
Validation loss decreased (-0.653321 --> -0.656655).  Saving model ...
Epoch: 53 cost time: 6.022996425628662
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.660 Test Loss: 1.185 Test Acc: 0.660
Validation loss decreased (-0.656655 --> -0.659988).  Saving model ...
Epoch: 54 cost time: 6.108415603637695
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.663 Test Loss: 1.180 Test Acc: 0.663
Validation loss decreased (-0.659988 --> -0.663322).  Saving model ...
Epoch: 55 cost time: 6.621644735336304
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.660 Test Loss: 1.177 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 5.878115177154541
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.174 Vali Acc: 0.660 Test Loss: 1.174 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 6.172444820404053
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.172 Vali Acc: 0.660 Test Loss: 1.172 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 6.1912102699279785
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.168 Vali Acc: 0.663 Test Loss: 1.168 Test Acc: 0.663
Validation loss decreased (-0.663322 --> -0.663322).  Saving model ...
Epoch: 59 cost time: 6.5230934619903564
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.164 Vali Acc: 0.667 Test Loss: 1.164 Test Acc: 0.667
Validation loss decreased (-0.663322 --> -0.666655).  Saving model ...
Epoch: 60 cost time: 6.040956020355225
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.162 Vali Acc: 0.660 Test Loss: 1.162 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.41460394859314
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.162 Vali Acc: 0.660 Test Loss: 1.162 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 6.535491228103638
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.164 Vali Acc: 0.663 Test Loss: 1.164 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 6.25400710105896
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.163 Vali Acc: 0.667 Test Loss: 1.163 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 64 cost time: 6.23459267616272
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.159 Vali Acc: 0.667 Test Loss: 1.159 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 65 cost time: 5.664448022842407
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.154 Vali Acc: 0.663 Test Loss: 1.154 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.573763847351074
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.673 Test Loss: 1.150 Test Acc: 0.673
Validation loss decreased (-0.666655 --> -0.673322).  Saving model ...
Epoch: 67 cost time: 5.66984748840332
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.148 Vali Acc: 0.673 Test Loss: 1.148 Test Acc: 0.673
Validation loss decreased (-0.673322 --> -0.673322).  Saving model ...
Epoch: 68 cost time: 6.609851360321045
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.147 Vali Acc: 0.670 Test Loss: 1.147 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.925621509552002
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.146 Vali Acc: 0.667 Test Loss: 1.146 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 6.466515302658081
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.143 Vali Acc: 0.680 Test Loss: 1.143 Test Acc: 0.680
Validation loss decreased (-0.673322 --> -0.679989).  Saving model ...
Epoch: 71 cost time: 6.118387699127197
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.680 Test Loss: 1.144 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.92343282699585
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.677 Test Loss: 1.144 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.482759475708008
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.673 Test Loss: 1.142 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 6.916952848434448
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.667 Test Loss: 1.141 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 6.263948202133179
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.140 Vali Acc: 0.667 Test Loss: 1.140 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 5.934371709823608
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.673 Test Loss: 1.137 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 6.3582165241241455
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.680 Test Loss: 1.134 Test Acc: 0.680
Validation loss decreased (-0.679989 --> -0.679989).  Saving model ...
Epoch: 78 cost time: 6.221765518188477
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.683 Test Loss: 1.134 Test Acc: 0.683
Validation loss decreased (-0.679989 --> -0.683322).  Saving model ...
Epoch: 79 cost time: 6.282550096511841
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.677 Test Loss: 1.134 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 5.969504356384277
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.677 Test Loss: 1.134 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 5.988076448440552
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.677 Test Loss: 1.132 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 5.813967227935791
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.680 Test Loss: 1.132 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 6.337335109710693
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.131 Vali Acc: 0.680 Test Loss: 1.131 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 6.307830810546875
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.130 Vali Acc: 0.680 Test Loss: 1.130 Test Acc: 0.680
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 6.21102237701416
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.129 Vali Acc: 0.680 Test Loss: 1.129 Test Acc: 0.680
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 6.19832968711853
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.127 Vali Acc: 0.680 Test Loss: 1.127 Test Acc: 0.680
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 6.168295860290527
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.125 Vali Acc: 0.683 Test Loss: 1.125 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 88 cost time: 6.213340997695923
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.125 Vali Acc: 0.683 Test Loss: 1.125 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 89 cost time: 6.197371244430542
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.125 Vali Acc: 0.683 Test Loss: 1.125 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 5.93258810043335
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.683 Test Loss: 1.124 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 91 cost time: 6.01144552230835
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.125 Vali Acc: 0.687 Test Loss: 1.125 Test Acc: 0.687
Validation loss decreased (-0.683322 --> -0.686655).  Saving model ...
Epoch: 92 cost time: 5.90826678276062
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.690 Test Loss: 1.124 Test Acc: 0.690
Validation loss decreased (-0.686655 --> -0.689989).  Saving model ...
Epoch: 93 cost time: 6.103057384490967
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.687 Test Loss: 1.122 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 6.135524272918701
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.121 Vali Acc: 0.690 Test Loss: 1.121 Test Acc: 0.690
Validation loss decreased (-0.689989 --> -0.689989).  Saving model ...
Epoch: 95 cost time: 6.0730414390563965
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.119 Vali Acc: 0.693 Test Loss: 1.119 Test Acc: 0.693
Validation loss decreased (-0.689989 --> -0.693322).  Saving model ...
Epoch: 96 cost time: 6.181647300720215
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.118 Vali Acc: 0.693 Test Loss: 1.118 Test Acc: 0.693
Validation loss decreased (-0.693322 --> -0.693322).  Saving model ...
Epoch: 97 cost time: 5.943036317825317
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.118 Vali Acc: 0.697 Test Loss: 1.118 Test Acc: 0.697
Validation loss decreased (-0.693322 --> -0.696655).  Saving model ...
Epoch: 98 cost time: 5.971513271331787
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.121 Vali Acc: 0.693 Test Loss: 1.121 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 6.549264907836914
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.120 Vali Acc: 0.697 Test Loss: 1.120 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 6.322812557220459
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.120 Vali Acc: 0.697 Test Loss: 1.120 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6966666666666667
model parameter : 2698777
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.505807399749756
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 5.782434463500977
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.992684841156006
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.787426233291626
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.797925710678101
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.473339557647705
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.513602018356323
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.750187873840332
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.179047584533691
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.020158290863037
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.46428370475769
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 2698777
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.433575391769409
Epoch: 1, Steps: 18 | Train Loss: 3.047 Vali Loss: 2.291 Vali Acc: 0.683 Test Loss: 2.291 Test Acc: 0.683
Validation loss decreased (inf --> -0.683310).  Saving model ...
Epoch: 2 cost time: 5.93812108039856
Epoch: 2, Steps: 18 | Train Loss: 1.554 Vali Loss: 1.013 Vali Acc: 0.843 Test Loss: 1.013 Test Acc: 0.843
Validation loss decreased (-0.683310 --> -0.843323).  Saving model ...
Epoch: 3 cost time: 5.822262763977051
Epoch: 3, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.567 Vali Acc: 0.877 Test Loss: 0.567 Test Acc: 0.877
Validation loss decreased (-0.843323 --> -0.876661).  Saving model ...
Epoch: 4 cost time: 5.473584413528442
Epoch: 4, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.418 Vali Acc: 0.897 Test Loss: 0.418 Test Acc: 0.897
Validation loss decreased (-0.876661 --> -0.896662).  Saving model ...
Epoch: 5 cost time: 5.614487886428833
Epoch: 5, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.394 Vali Acc: 0.897 Test Loss: 0.394 Test Acc: 0.897
Validation loss decreased (-0.896662 --> -0.896663).  Saving model ...
Epoch: 6 cost time: 5.406190633773804
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.407 Vali Acc: 0.887 Test Loss: 0.407 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.735436916351318
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.896663 --> -0.899996).  Saving model ...
Epoch: 8 cost time: 6.017886638641357
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.360 Vali Acc: 0.897 Test Loss: 0.360 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.354509353637695
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
Validation loss decreased (-0.899996 --> -0.903330).  Saving model ...
Epoch: 10 cost time: 6.20684027671814
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.9764909744262695
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.22904634475708
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.345 Vali Acc: 0.903 Test Loss: 0.345 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 13 cost time: 6.418370485305786
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.342 Vali Acc: 0.910 Test Loss: 0.342 Test Acc: 0.910
Validation loss decreased (-0.903330 --> -0.909997).  Saving model ...
Epoch: 14 cost time: 6.333297252655029
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.907 Test Loss: 0.339 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.178686618804932
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.910 Test Loss: 0.338 Test Acc: 0.910
Validation loss decreased (-0.909997 --> -0.909997).  Saving model ...
Epoch: 16 cost time: 5.791095495223999
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.939746856689453
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.323991060256958
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.3864827156066895
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.753056049346924
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.907 Test Loss: 0.335 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.12050199508667
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.907 Test Loss: 0.333 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.978010892868042
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.907 Test Loss: 0.333 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.429765462875366
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.73020076751709
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.907 Test Loss: 0.332 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.37879753112793
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.907 Test Loss: 0.332 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.91
model parameter : 1912345
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.05495548248291
Epoch: 1, Steps: 18 | Train Loss: 3.112 Vali Loss: 2.515 Vali Acc: 0.537 Test Loss: 2.515 Test Acc: 0.537
Validation loss decreased (inf --> -0.536642).  Saving model ...
Epoch: 2 cost time: 6.146551847457886
Epoch: 2, Steps: 18 | Train Loss: 1.843 Vali Loss: 1.364 Vali Acc: 0.767 Test Loss: 1.364 Test Acc: 0.767
Validation loss decreased (-0.536642 --> -0.766653).  Saving model ...
Epoch: 3 cost time: 5.709282159805298
Epoch: 3, Steps: 18 | Train Loss: 0.649 Vali Loss: 0.796 Vali Acc: 0.830 Test Loss: 0.796 Test Acc: 0.830
Validation loss decreased (-0.766653 --> -0.829992).  Saving model ...
Epoch: 4 cost time: 5.988265037536621
Epoch: 4, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.601 Vali Acc: 0.840 Test Loss: 0.601 Test Acc: 0.840
Validation loss decreased (-0.829992 --> -0.839994).  Saving model ...
Epoch: 5 cost time: 5.523832082748413
Epoch: 5, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
Validation loss decreased (-0.839994 --> -0.849994).  Saving model ...
Epoch: 6 cost time: 5.530106782913208
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.573 Vali Acc: 0.830 Test Loss: 0.573 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.689830780029297
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.523 Vali Acc: 0.857 Test Loss: 0.523 Test Acc: 0.857
Validation loss decreased (-0.849994 --> -0.856661).  Saving model ...
Epoch: 8 cost time: 5.736341953277588
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.521 Vali Acc: 0.873 Test Loss: 0.521 Test Acc: 0.873
Validation loss decreased (-0.856661 --> -0.873328).  Saving model ...
Epoch: 9 cost time: 6.0778398513793945
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.514 Vali Acc: 0.863 Test Loss: 0.514 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.547392845153809
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.503 Vali Acc: 0.860 Test Loss: 0.503 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.726271629333496
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.500 Vali Acc: 0.873 Test Loss: 0.500 Test Acc: 0.873
Validation loss decreased (-0.873328 --> -0.873328).  Saving model ...
Epoch: 12 cost time: 5.800182104110718
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.501 Vali Acc: 0.883 Test Loss: 0.501 Test Acc: 0.883
Validation loss decreased (-0.873328 --> -0.883328).  Saving model ...
Epoch: 13 cost time: 6.178077936172485
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.880 Test Loss: 0.498 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.146949052810669
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.880 Test Loss: 0.495 Test Acc: 0.880
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.327108860015869
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.877 Test Loss: 0.492 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.7721052169799805
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.873 Test Loss: 0.493 Test Acc: 0.873
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.527039527893066
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.739610195159912
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.880 Test Loss: 0.493 Test Acc: 0.880
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.040049314498901
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.880 Test Loss: 0.495 Test Acc: 0.880
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.990464925765991
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.880 Test Loss: 0.493 Test Acc: 0.880
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.65522837638855
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.880 Test Loss: 0.491 Test Acc: 0.880
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.27017068862915
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.880 Test Loss: 0.491 Test Acc: 0.880
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8833333333333333
model parameter : 1912345
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.61613130569458
Epoch: 1, Steps: 18 | Train Loss: 3.185 Vali Loss: 2.764 Vali Acc: 0.390 Test Loss: 2.764 Test Acc: 0.390
Validation loss decreased (inf --> -0.389972).  Saving model ...
Epoch: 2 cost time: 6.41830587387085
Epoch: 2, Steps: 18 | Train Loss: 2.213 Vali Loss: 1.887 Vali Acc: 0.653 Test Loss: 1.887 Test Acc: 0.653
Validation loss decreased (-0.389972 --> -0.653314).  Saving model ...
Epoch: 3 cost time: 6.043696641921997
Epoch: 3, Steps: 18 | Train Loss: 1.042 Vali Loss: 1.243 Vali Acc: 0.740 Test Loss: 1.243 Test Acc: 0.740
Validation loss decreased (-0.653314 --> -0.739988).  Saving model ...
Epoch: 4 cost time: 6.067139387130737
Epoch: 4, Steps: 18 | Train Loss: 0.341 Vali Loss: 0.939 Vali Acc: 0.787 Test Loss: 0.939 Test Acc: 0.787
Validation loss decreased (-0.739988 --> -0.786657).  Saving model ...
Epoch: 5 cost time: 6.246453523635864
Epoch: 5, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.885 Vali Acc: 0.763 Test Loss: 0.885 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.979225158691406
Epoch: 6, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.805 Vali Acc: 0.783 Test Loss: 0.805 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.176270008087158
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.762 Vali Acc: 0.800 Test Loss: 0.762 Test Acc: 0.800
Validation loss decreased (-0.786657 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 6.24755597114563
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.770 Vali Acc: 0.800 Test Loss: 0.770 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.900630950927734
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.762 Vali Acc: 0.800 Test Loss: 0.762 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.830063104629517
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.753 Vali Acc: 0.810 Test Loss: 0.753 Test Acc: 0.810
Validation loss decreased (-0.799992 --> -0.809992).  Saving model ...
Epoch: 11 cost time: 6.100375413894653
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.751 Vali Acc: 0.807 Test Loss: 0.751 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.721510171890259
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.755 Vali Acc: 0.807 Test Loss: 0.755 Test Acc: 0.807
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.836100101470947
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.754 Vali Acc: 0.810 Test Loss: 0.754 Test Acc: 0.810
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.445044994354248
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.750 Vali Acc: 0.810 Test Loss: 0.750 Test Acc: 0.810
Validation loss decreased (-0.809992 --> -0.809992).  Saving model ...
Epoch: 15 cost time: 6.153735399246216
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.750 Vali Acc: 0.810 Test Loss: 0.750 Test Acc: 0.810
Validation loss decreased (-0.809992 --> -0.809992).  Saving model ...
Epoch: 16 cost time: 5.541733980178833
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.753 Vali Acc: 0.807 Test Loss: 0.753 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.08320689201355
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.807 Test Loss: 0.754 Test Acc: 0.807
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.726429462432861
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.757 Vali Acc: 0.807 Test Loss: 0.757 Test Acc: 0.807
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.2983314990997314
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.810 Test Loss: 0.760 Test Acc: 0.810
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.706320285797119
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.807 Test Loss: 0.760 Test Acc: 0.807
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.260323524475098
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.758 Vali Acc: 0.807 Test Loss: 0.758 Test Acc: 0.807
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.9346022605896
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.757 Vali Acc: 0.807 Test Loss: 0.757 Test Acc: 0.807
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.793868541717529
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.810 Test Loss: 0.756 Test Acc: 0.810
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.232592821121216
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.813 Test Loss: 0.756 Test Acc: 0.813
Validation loss decreased (-0.809992 --> -0.813326).  Saving model ...
Epoch: 25 cost time: 6.819224834442139
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.813 Test Loss: 0.760 Test Acc: 0.813
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.361599683761597
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.763 Vali Acc: 0.810 Test Loss: 0.763 Test Acc: 0.810
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.740571975708008
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.767 Vali Acc: 0.813 Test Loss: 0.767 Test Acc: 0.813
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.727249622344971
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.810 Test Loss: 0.764 Test Acc: 0.810
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.729487895965576
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.810 Test Loss: 0.767 Test Acc: 0.810
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.6225128173828125
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.807 Test Loss: 0.767 Test Acc: 0.807
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.330543279647827
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.807 Test Loss: 0.769 Test Acc: 0.807
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.93759822845459
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.810 Test Loss: 0.771 Test Acc: 0.810
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.993441581726074
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.810 Test Loss: 0.772 Test Acc: 0.810
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.203584671020508
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.807 Test Loss: 0.771 Test Acc: 0.807
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8133333333333334
model parameter : 1912345
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.935518741607666
Epoch: 1, Steps: 18 | Train Loss: 3.237 Vali Loss: 2.997 Vali Acc: 0.200 Test Loss: 2.997 Test Acc: 0.200
Validation loss decreased (inf --> -0.199970).  Saving model ...
Epoch: 2 cost time: 5.501793622970581
Epoch: 2, Steps: 18 | Train Loss: 2.533 Vali Loss: 2.431 Vali Acc: 0.447 Test Loss: 2.431 Test Acc: 0.447
Validation loss decreased (-0.199970 --> -0.446642).  Saving model ...
Epoch: 3 cost time: 5.865992307662964
Epoch: 3, Steps: 18 | Train Loss: 1.540 Vali Loss: 1.900 Vali Acc: 0.533 Test Loss: 1.900 Test Acc: 0.533
Validation loss decreased (-0.446642 --> -0.533314).  Saving model ...
Epoch: 4 cost time: 5.999850034713745
Epoch: 4, Steps: 18 | Train Loss: 0.675 Vali Loss: 1.517 Vali Acc: 0.597 Test Loss: 1.517 Test Acc: 0.597
Validation loss decreased (-0.533314 --> -0.596651).  Saving model ...
Epoch: 5 cost time: 5.976261138916016
Epoch: 5, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.340 Vali Acc: 0.627 Test Loss: 1.340 Test Acc: 0.627
Validation loss decreased (-0.596651 --> -0.626653).  Saving model ...
Epoch: 6 cost time: 6.254091739654541
Epoch: 6, Steps: 18 | Train Loss: 0.060 Vali Loss: 1.183 Vali Acc: 0.650 Test Loss: 1.183 Test Acc: 0.650
Validation loss decreased (-0.626653 --> -0.649988).  Saving model ...
Epoch: 7 cost time: 5.631055593490601
Epoch: 7, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.180 Vali Acc: 0.630 Test Loss: 1.180 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.744035005569458
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.148 Vali Acc: 0.640 Test Loss: 1.148 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.421124696731567
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.126 Vali Acc: 0.653 Test Loss: 1.126 Test Acc: 0.653
Validation loss decreased (-0.649988 --> -0.653322).  Saving model ...
Epoch: 10 cost time: 6.261083602905273
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.098 Vali Acc: 0.660 Test Loss: 1.098 Test Acc: 0.660
Validation loss decreased (-0.653322 --> -0.659989).  Saving model ...
Epoch: 11 cost time: 6.225724935531616
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.083 Vali Acc: 0.667 Test Loss: 1.083 Test Acc: 0.667
Validation loss decreased (-0.659989 --> -0.666656).  Saving model ...
Epoch: 12 cost time: 6.073534250259399
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.083 Vali Acc: 0.663 Test Loss: 1.083 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.355172634124756
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.074 Vali Acc: 0.657 Test Loss: 1.074 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.7539145946502686
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.065 Vali Acc: 0.660 Test Loss: 1.065 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.093631982803345
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.063 Vali Acc: 0.667 Test Loss: 1.063 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 16 cost time: 6.2077860832214355
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.064 Vali Acc: 0.673 Test Loss: 1.064 Test Acc: 0.673
Validation loss decreased (-0.666656 --> -0.673323).  Saving model ...
Epoch: 17 cost time: 6.00573992729187
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.055 Vali Acc: 0.670 Test Loss: 1.055 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.254131078720093
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.059 Vali Acc: 0.677 Test Loss: 1.059 Test Acc: 0.677
Validation loss decreased (-0.673323 --> -0.676656).  Saving model ...
Epoch: 19 cost time: 5.631174802780151
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.052 Vali Acc: 0.670 Test Loss: 1.052 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.092989206314087
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.677 Test Loss: 1.045 Test Acc: 0.677
Validation loss decreased (-0.676656 --> -0.676656).  Saving model ...
Epoch: 21 cost time: 6.180862188339233
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.043 Vali Acc: 0.693 Test Loss: 1.043 Test Acc: 0.693
Validation loss decreased (-0.676656 --> -0.693323).  Saving model ...
Epoch: 22 cost time: 6.078513860702515
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.040 Vali Acc: 0.680 Test Loss: 1.040 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.832642555236816
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.687 Test Loss: 1.036 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.499207019805908
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.031 Vali Acc: 0.687 Test Loss: 1.031 Test Acc: 0.687
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.990986585617065
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.028 Vali Acc: 0.687 Test Loss: 1.028 Test Acc: 0.687
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.3542821407318115
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.026 Vali Acc: 0.697 Test Loss: 1.026 Test Acc: 0.697
Validation loss decreased (-0.693323 --> -0.696656).  Saving model ...
Epoch: 27 cost time: 6.918869972229004
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.022 Vali Acc: 0.693 Test Loss: 1.022 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.9701056480407715
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.690 Test Loss: 1.021 Test Acc: 0.690
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.821963548660278
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.023 Vali Acc: 0.693 Test Loss: 1.023 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.0125346183776855
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.700 Test Loss: 1.021 Test Acc: 0.700
Validation loss decreased (-0.696656 --> -0.699990).  Saving model ...
Epoch: 31 cost time: 6.423343181610107
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.710 Test Loss: 1.019 Test Acc: 0.710
Validation loss decreased (-0.699990 --> -0.709990).  Saving model ...
Epoch: 32 cost time: 6.494069576263428
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.707 Test Loss: 1.018 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.298843860626221
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.703 Test Loss: 1.017 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.892232179641724
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.707 Test Loss: 1.017 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.661582708358765
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.703 Test Loss: 1.015 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 5.744369983673096
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.707 Test Loss: 1.013 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 5.87104058265686
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.710 Test Loss: 1.013 Test Acc: 0.710
Validation loss decreased (-0.709990 --> -0.709990).  Saving model ...
Epoch: 38 cost time: 6.351398706436157
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.713 Test Loss: 1.011 Test Acc: 0.713
Validation loss decreased (-0.709990 --> -0.713323).  Saving model ...
Epoch: 39 cost time: 5.72100830078125
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.717 Test Loss: 1.008 Test Acc: 0.717
Validation loss decreased (-0.713323 --> -0.716657).  Saving model ...
Epoch: 40 cost time: 5.821215867996216
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.713 Test Loss: 1.007 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.750941753387451
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.710 Test Loss: 1.008 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.333046197891235
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.710 Test Loss: 1.004 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.110586881637573
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.710 Test Loss: 1.007 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.256067276000977
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.006 Vali Acc: 0.710 Test Loss: 1.006 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 6.036231994628906
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.713 Test Loss: 1.007 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 5.617234945297241
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.707 Test Loss: 1.005 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 6.653069734573364
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.710 Test Loss: 1.005 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 6.429384469985962
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.720 Test Loss: 1.004 Test Acc: 0.720
Validation loss decreased (-0.716657 --> -0.719990).  Saving model ...
Epoch: 49 cost time: 5.550577878952026
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.717 Test Loss: 1.002 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.69717264175415
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.720 Test Loss: 1.002 Test Acc: 0.720
Validation loss decreased (-0.719990 --> -0.719990).  Saving model ...
Epoch: 51 cost time: 5.637399911880493
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.717 Test Loss: 1.000 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.198327302932739
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.720 Test Loss: 1.001 Test Acc: 0.720
Validation loss decreased (-0.719990 --> -0.719990).  Saving model ...
Epoch: 53 cost time: 6.261786937713623
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.720 Test Loss: 1.001 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.806288957595825
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.723 Test Loss: 0.998 Test Acc: 0.723
Validation loss decreased (-0.719990 --> -0.723323).  Saving model ...
Epoch: 55 cost time: 5.773711204528809
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.723 Test Loss: 0.998 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 5.641044855117798
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.727 Test Loss: 1.000 Test Acc: 0.727
Validation loss decreased (-0.723323 --> -0.726657).  Saving model ...
Epoch: 57 cost time: 6.068992376327515
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.723 Test Loss: 1.000 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.196285963058472
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.727 Test Loss: 0.999 Test Acc: 0.727
Validation loss decreased (-0.726657 --> -0.726657).  Saving model ...
Epoch: 59 cost time: 6.01318097114563
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.727 Test Loss: 0.999 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.588403224945068
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.723 Test Loss: 0.998 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 5.708128452301025
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.730 Test Loss: 0.998 Test Acc: 0.730
Validation loss decreased (-0.726657 --> -0.729990).  Saving model ...
Epoch: 62 cost time: 5.954922199249268
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.727 Test Loss: 0.997 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 6.030527353286743
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.727 Test Loss: 0.996 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 6.0524656772613525
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.723 Test Loss: 0.995 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 5.377360105514526
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.723 Test Loss: 0.996 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 5.667647123336792
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.727 Test Loss: 0.996 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 5.5067901611328125
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.727 Test Loss: 0.996 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 5.396060466766357
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.730 Test Loss: 0.997 Test Acc: 0.730
Validation loss decreased (-0.729990 --> -0.729990).  Saving model ...
Epoch: 69 cost time: 5.7853076457977295
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.727 Test Loss: 1.000 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 5.757871627807617
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.727 Test Loss: 0.999 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 5.7818686962127686
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.727 Test Loss: 0.997 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 6.438903093338013
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.730 Test Loss: 0.997 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 6.108203172683716
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.730 Test Loss: 0.995 Test Acc: 0.730
Validation loss decreased (-0.729990 --> -0.729990).  Saving model ...
Epoch: 74 cost time: 5.852464199066162
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.727 Test Loss: 0.997 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 5.9091956615448
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.727 Test Loss: 0.996 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 5.7362751960754395
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.727 Test Loss: 0.997 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 6.309228897094727
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.727 Test Loss: 0.998 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 6.142222166061401
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.730 Test Loss: 0.997 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 5.491962432861328
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.727 Test Loss: 0.996 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 5.687074184417725
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.730 Test Loss: 0.996 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 5.616154670715332
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.733 Test Loss: 0.997 Test Acc: 0.733
Validation loss decreased (-0.729990 --> -0.733323).  Saving model ...
Epoch: 82 cost time: 6.252199411392212
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.733 Test Loss: 0.995 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 83 cost time: 6.464605331420898
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.730 Test Loss: 0.995 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 6.019643783569336
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.733 Test Loss: 0.996 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 5.883331298828125
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.733 Test Loss: 0.998 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 5.839575529098511
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.737 Test Loss: 0.997 Test Acc: 0.737
Validation loss decreased (-0.733323 --> -0.736657).  Saving model ...
Epoch: 87 cost time: 6.122371435165405
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.740 Test Loss: 0.996 Test Acc: 0.740
Validation loss decreased (-0.736657 --> -0.739990).  Saving model ...
Epoch: 88 cost time: 6.170332670211792
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.737 Test Loss: 0.996 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 6.175506830215454
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.737 Test Loss: 0.996 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 5.61894965171814
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.737 Test Loss: 0.995 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 5.606785297393799
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.737 Test Loss: 0.994 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 5.654162168502808
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.737 Test Loss: 0.994 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 6.223087549209595
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.737 Test Loss: 0.992 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 6.223155975341797
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.737 Test Loss: 0.993 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 5.772830963134766
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.737 Test Loss: 0.992 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 5.614248991012573
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.737 Test Loss: 0.993 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 5.711353302001953
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.737 Test Loss: 0.993 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.74
model parameter : 1912345
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.281665086746216
Epoch: 1, Steps: 18 | Train Loss: 3.245 Vali Loss: 3.084 Vali Acc: 0.117 Test Loss: 3.084 Test Acc: 0.117
Validation loss decreased (inf --> -0.116636).  Saving model ...
Epoch: 2 cost time: 6.156646728515625
Epoch: 2, Steps: 18 | Train Loss: 2.684 Vali Loss: 2.729 Vali Acc: 0.307 Test Loss: 2.729 Test Acc: 0.307
Validation loss decreased (-0.116636 --> -0.306639).  Saving model ...
Epoch: 3 cost time: 6.182886600494385
Epoch: 3, Steps: 18 | Train Loss: 1.805 Vali Loss: 2.356 Vali Acc: 0.400 Test Loss: 2.356 Test Acc: 0.400
Validation loss decreased (-0.306639 --> -0.399976).  Saving model ...
Epoch: 4 cost time: 6.152777433395386
Epoch: 4, Steps: 18 | Train Loss: 0.955 Vali Loss: 2.080 Vali Acc: 0.410 Test Loss: 2.080 Test Acc: 0.410
Validation loss decreased (-0.399976 --> -0.409979).  Saving model ...
Epoch: 5 cost time: 6.762169361114502
Epoch: 5, Steps: 18 | Train Loss: 0.376 Vali Loss: 1.900 Vali Acc: 0.437 Test Loss: 1.900 Test Acc: 0.437
Validation loss decreased (-0.409979 --> -0.436648).  Saving model ...
Epoch: 6 cost time: 6.515416145324707
Epoch: 6, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.762 Vali Acc: 0.440 Test Loss: 1.762 Test Acc: 0.440
Validation loss decreased (-0.436648 --> -0.439982).  Saving model ...
Epoch: 7 cost time: 5.7645087242126465
Epoch: 7, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.641 Vali Acc: 0.530 Test Loss: 1.641 Test Acc: 0.530
Validation loss decreased (-0.439982 --> -0.529984).  Saving model ...
Epoch: 8 cost time: 5.642058610916138
Epoch: 8, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.622 Vali Acc: 0.503 Test Loss: 1.622 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.659816265106201
Epoch: 9, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.555 Vali Acc: 0.507 Test Loss: 1.555 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.723234415054321
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.519 Vali Acc: 0.527 Test Loss: 1.519 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.053025245666504
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.499 Vali Acc: 0.540 Test Loss: 1.499 Test Acc: 0.540
Validation loss decreased (-0.529984 --> -0.539985).  Saving model ...
Epoch: 12 cost time: 5.7452073097229
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.487 Vali Acc: 0.537 Test Loss: 1.487 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.728212833404541
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.463 Vali Acc: 0.547 Test Loss: 1.463 Test Acc: 0.547
Validation loss decreased (-0.539985 --> -0.546652).  Saving model ...
Epoch: 14 cost time: 5.581153154373169
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.448 Vali Acc: 0.553 Test Loss: 1.448 Test Acc: 0.553
Validation loss decreased (-0.546652 --> -0.553319).  Saving model ...
Epoch: 15 cost time: 6.46413254737854
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.445 Vali Acc: 0.550 Test Loss: 1.445 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.006664514541626
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.437 Vali Acc: 0.553 Test Loss: 1.437 Test Acc: 0.553
Validation loss decreased (-0.553319 --> -0.553319).  Saving model ...
Epoch: 17 cost time: 6.398465633392334
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.421 Vali Acc: 0.557 Test Loss: 1.421 Test Acc: 0.557
Validation loss decreased (-0.553319 --> -0.556652).  Saving model ...
Epoch: 18 cost time: 5.579824924468994
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.415 Vali Acc: 0.563 Test Loss: 1.415 Test Acc: 0.563
Validation loss decreased (-0.556652 --> -0.563319).  Saving model ...
Epoch: 19 cost time: 5.714668035507202
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.403 Vali Acc: 0.567 Test Loss: 1.403 Test Acc: 0.567
Validation loss decreased (-0.563319 --> -0.566653).  Saving model ...
Epoch: 20 cost time: 6.009189605712891
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.394 Vali Acc: 0.570 Test Loss: 1.394 Test Acc: 0.570
Validation loss decreased (-0.566653 --> -0.569986).  Saving model ...
Epoch: 21 cost time: 5.726252555847168
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.570 Test Loss: 1.386 Test Acc: 0.570
Validation loss decreased (-0.569986 --> -0.569986).  Saving model ...
Epoch: 22 cost time: 6.236902236938477
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.567 Test Loss: 1.379 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.428720951080322
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.371 Vali Acc: 0.573 Test Loss: 1.371 Test Acc: 0.573
Validation loss decreased (-0.569986 --> -0.573320).  Saving model ...
Epoch: 24 cost time: 5.3244194984436035
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.366 Vali Acc: 0.577 Test Loss: 1.366 Test Acc: 0.577
Validation loss decreased (-0.573320 --> -0.576653).  Saving model ...
Epoch: 25 cost time: 5.426109552383423
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.358 Vali Acc: 0.587 Test Loss: 1.358 Test Acc: 0.587
Validation loss decreased (-0.576653 --> -0.586653).  Saving model ...
Epoch: 26 cost time: 6.115320682525635
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.356 Vali Acc: 0.593 Test Loss: 1.356 Test Acc: 0.593
Validation loss decreased (-0.586653 --> -0.593320).  Saving model ...
Epoch: 27 cost time: 6.072275161743164
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.354 Vali Acc: 0.593 Test Loss: 1.354 Test Acc: 0.593
Validation loss decreased (-0.593320 --> -0.593320).  Saving model ...
Epoch: 28 cost time: 5.771874904632568
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.349 Vali Acc: 0.593 Test Loss: 1.349 Test Acc: 0.593
Validation loss decreased (-0.593320 --> -0.593320).  Saving model ...
Epoch: 29 cost time: 5.864673376083374
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.607 Test Loss: 1.345 Test Acc: 0.607
Validation loss decreased (-0.593320 --> -0.606653).  Saving model ...
Epoch: 30 cost time: 6.011268854141235
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.339 Vali Acc: 0.610 Test Loss: 1.339 Test Acc: 0.610
Validation loss decreased (-0.606653 --> -0.609987).  Saving model ...
Epoch: 31 cost time: 6.608236074447632
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.333 Vali Acc: 0.610 Test Loss: 1.333 Test Acc: 0.610
Validation loss decreased (-0.609987 --> -0.609987).  Saving model ...
Epoch: 32 cost time: 6.681835651397705
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.600 Test Loss: 1.328 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.494304418563843
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.324 Vali Acc: 0.613 Test Loss: 1.324 Test Acc: 0.613
Validation loss decreased (-0.609987 --> -0.613320).  Saving model ...
Epoch: 34 cost time: 6.127241373062134
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.620 Test Loss: 1.323 Test Acc: 0.620
Validation loss decreased (-0.613320 --> -0.619987).  Saving model ...
Epoch: 35 cost time: 5.772719144821167
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.620 Test Loss: 1.320 Test Acc: 0.620
Validation loss decreased (-0.619987 --> -0.619987).  Saving model ...
Epoch: 36 cost time: 6.687385320663452
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.617 Test Loss: 1.318 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.167867422103882
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.620 Test Loss: 1.316 Test Acc: 0.620
Validation loss decreased (-0.619987 --> -0.619987).  Saving model ...
Epoch: 38 cost time: 5.835121154785156
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.630 Test Loss: 1.312 Test Acc: 0.630
Validation loss decreased (-0.619987 --> -0.629987).  Saving model ...
Epoch: 39 cost time: 6.044236421585083
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.305 Vali Acc: 0.620 Test Loss: 1.305 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.011040925979614
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.300 Vali Acc: 0.620 Test Loss: 1.300 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.51019811630249
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.623 Test Loss: 1.299 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 6.792168140411377
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.623 Test Loss: 1.295 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 6.329395532608032
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.293 Vali Acc: 0.620 Test Loss: 1.293 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 6.269620656967163
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.290 Vali Acc: 0.627 Test Loss: 1.290 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 6.121736526489258
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.291 Vali Acc: 0.633 Test Loss: 1.291 Test Acc: 0.633
Validation loss decreased (-0.629987 --> -0.633320).  Saving model ...
Epoch: 46 cost time: 6.469460487365723
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.288 Vali Acc: 0.640 Test Loss: 1.288 Test Acc: 0.640
Validation loss decreased (-0.633320 --> -0.639987).  Saving model ...
Epoch: 47 cost time: 6.744409084320068
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.287 Vali Acc: 0.640 Test Loss: 1.287 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639987).  Saving model ...
Epoch: 48 cost time: 6.904412746429443
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.283 Vali Acc: 0.637 Test Loss: 1.283 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.83434796333313
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.279 Vali Acc: 0.640 Test Loss: 1.279 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639987).  Saving model ...
Epoch: 50 cost time: 6.134216547012329
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.630 Test Loss: 1.275 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 6.131821870803833
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.643 Test Loss: 1.275 Test Acc: 0.643
Validation loss decreased (-0.639987 --> -0.643321).  Saving model ...
Epoch: 52 cost time: 6.4987711906433105
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.643 Test Loss: 1.276 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 6.229334354400635
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.643 Test Loss: 1.273 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 54 cost time: 6.348051309585571
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.272 Vali Acc: 0.640 Test Loss: 1.272 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.014793395996094
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.272 Vali Acc: 0.643 Test Loss: 1.272 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 56 cost time: 5.934963226318359
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.271 Vali Acc: 0.640 Test Loss: 1.271 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.347177505493164
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.643 Test Loss: 1.268 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 58 cost time: 6.42518162727356
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.643 Test Loss: 1.266 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 59 cost time: 6.352993965148926
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.643 Test Loss: 1.266 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 60 cost time: 5.859714984893799
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.647 Test Loss: 1.265 Test Acc: 0.647
Validation loss decreased (-0.643321 --> -0.646654).  Saving model ...
Epoch: 61 cost time: 6.17783784866333
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.643 Test Loss: 1.264 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.35362982749939
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.647 Test Loss: 1.260 Test Acc: 0.647
Validation loss decreased (-0.646654 --> -0.646654).  Saving model ...
Epoch: 63 cost time: 6.2223076820373535
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.647 Test Loss: 1.262 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.993358850479126
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.647 Test Loss: 1.260 Test Acc: 0.647
Validation loss decreased (-0.646654 --> -0.646654).  Saving model ...
Epoch: 65 cost time: 6.054617881774902
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.647 Test Loss: 1.256 Test Acc: 0.647
Validation loss decreased (-0.646654 --> -0.646654).  Saving model ...
Epoch: 66 cost time: 6.086493968963623
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.650 Test Loss: 1.254 Test Acc: 0.650
Validation loss decreased (-0.646654 --> -0.649987).  Saving model ...
Epoch: 67 cost time: 6.723773002624512
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.657 Test Loss: 1.253 Test Acc: 0.657
Validation loss decreased (-0.649987 --> -0.656654).  Saving model ...
Epoch: 68 cost time: 6.769884824752808
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.650 Test Loss: 1.252 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 5.932413101196289
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.653 Test Loss: 1.253 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 6.104815483093262
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.660 Test Loss: 1.251 Test Acc: 0.660
Validation loss decreased (-0.656654 --> -0.659987).  Saving model ...
Epoch: 71 cost time: 6.164299011230469
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.663 Test Loss: 1.247 Test Acc: 0.663
Validation loss decreased (-0.659987 --> -0.663321).  Saving model ...
Epoch: 72 cost time: 6.563405990600586
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.663 Test Loss: 1.248 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 7.057669639587402
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.663 Test Loss: 1.246 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 74 cost time: 6.276079177856445
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.663 Test Loss: 1.245 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 75 cost time: 5.943008661270142
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.663 Test Loss: 1.246 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 5.788076639175415
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.244 Vali Acc: 0.660 Test Loss: 1.244 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 5.548134803771973
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.243 Vali Acc: 0.660 Test Loss: 1.243 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 5.728158235549927
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.663 Test Loss: 1.242 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 79 cost time: 5.735610246658325
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.663 Test Loss: 1.240 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 80 cost time: 6.114040851593018
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.663 Test Loss: 1.238 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 81 cost time: 6.5401105880737305
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.667 Test Loss: 1.238 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666654).  Saving model ...
Epoch: 82 cost time: 6.25322413444519
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.663 Test Loss: 1.238 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 5.788474798202515
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.660 Test Loss: 1.239 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 6.220924139022827
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.660 Test Loss: 1.239 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 6.8781867027282715
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.663 Test Loss: 1.241 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 6.780665874481201
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.667 Test Loss: 1.240 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 6.335981130599976
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.667 Test Loss: 1.238 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 88 cost time: 5.837109804153442
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.667 Test Loss: 1.236 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 89 cost time: 6.127440929412842
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.670 Test Loss: 1.236 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669988).  Saving model ...
Epoch: 90 cost time: 6.454174757003784
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.670 Test Loss: 1.233 Test Acc: 0.670
Validation loss decreased (-0.669988 --> -0.669988).  Saving model ...
Epoch: 91 cost time: 6.564594745635986
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.667 Test Loss: 1.233 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 5.93281364440918
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.667 Test Loss: 1.231 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 5.851332902908325
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.670 Test Loss: 1.227 Test Acc: 0.670
Validation loss decreased (-0.669988 --> -0.669988).  Saving model ...
Epoch: 94 cost time: 6.125293016433716
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.673 Test Loss: 1.225 Test Acc: 0.673
Validation loss decreased (-0.669988 --> -0.673321).  Saving model ...
Epoch: 95 cost time: 6.533429861068726
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.673 Test Loss: 1.224 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 96 cost time: 6.824594020843506
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.670 Test Loss: 1.225 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 6.221747398376465
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.683 Test Loss: 1.225 Test Acc: 0.683
Validation loss decreased (-0.673321 --> -0.683321).  Saving model ...
Epoch: 98 cost time: 6.662375211715698
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.677 Test Loss: 1.225 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 6.6141791343688965
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.680 Test Loss: 1.224 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 6.684201002120972
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.680 Test Loss: 1.224 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6833333333333333
model parameter : 1912345
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.976606607437134
Epoch: 1, Steps: 18 | Train Loss: 3.255 Vali Loss: 3.166 Vali Acc: 0.060 Test Loss: 3.166 Test Acc: 0.060
Validation loss decreased (inf --> -0.059968).  Saving model ...
Epoch: 2 cost time: 5.378995418548584
Epoch: 2, Steps: 18 | Train Loss: 2.753 Vali Loss: 2.917 Vali Acc: 0.210 Test Loss: 2.917 Test Acc: 0.210
Validation loss decreased (-0.059968 --> -0.209971).  Saving model ...
Epoch: 3 cost time: 6.287293434143066
Epoch: 3, Steps: 18 | Train Loss: 1.871 Vali Loss: 2.638 Vali Acc: 0.310 Test Loss: 2.638 Test Acc: 0.310
Validation loss decreased (-0.209971 --> -0.309974).  Saving model ...
Epoch: 4 cost time: 6.0415472984313965
Epoch: 4, Steps: 18 | Train Loss: 1.015 Vali Loss: 2.412 Vali Acc: 0.293 Test Loss: 2.412 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.544392108917236
Epoch: 5, Steps: 18 | Train Loss: 0.449 Vali Loss: 2.270 Vali Acc: 0.343 Test Loss: 2.270 Test Acc: 0.343
Validation loss decreased (-0.309974 --> -0.343311).  Saving model ...
Epoch: 6 cost time: 6.372281551361084
Epoch: 6, Steps: 18 | Train Loss: 0.151 Vali Loss: 2.118 Vali Acc: 0.397 Test Loss: 2.118 Test Acc: 0.397
Validation loss decreased (-0.343311 --> -0.396645).  Saving model ...
Epoch: 7 cost time: 5.797497987747192
Epoch: 7, Steps: 18 | Train Loss: 0.048 Vali Loss: 2.010 Vali Acc: 0.413 Test Loss: 2.010 Test Acc: 0.413
Validation loss decreased (-0.396645 --> -0.413313).  Saving model ...
Epoch: 8 cost time: 6.239696979522705
Epoch: 8, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.970 Vali Acc: 0.437 Test Loss: 1.970 Test Acc: 0.437
Validation loss decreased (-0.413313 --> -0.436647).  Saving model ...
Epoch: 9 cost time: 6.578698396682739
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.898 Vali Acc: 0.437 Test Loss: 1.898 Test Acc: 0.437
Validation loss decreased (-0.436647 --> -0.436648).  Saving model ...
Epoch: 10 cost time: 6.248017072677612
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.858 Vali Acc: 0.450 Test Loss: 1.858 Test Acc: 0.450
Validation loss decreased (-0.436648 --> -0.449981).  Saving model ...
Epoch: 11 cost time: 5.654437303543091
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.830 Vali Acc: 0.433 Test Loss: 1.830 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.012094974517822
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.804 Vali Acc: 0.457 Test Loss: 1.804 Test Acc: 0.457
Validation loss decreased (-0.449981 --> -0.456649).  Saving model ...
Epoch: 13 cost time: 6.08274245262146
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.776 Vali Acc: 0.473 Test Loss: 1.776 Test Acc: 0.473
Validation loss decreased (-0.456649 --> -0.473316).  Saving model ...
Epoch: 14 cost time: 6.377497911453247
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.758 Vali Acc: 0.487 Test Loss: 1.758 Test Acc: 0.487
Validation loss decreased (-0.473316 --> -0.486649).  Saving model ...
Epoch: 15 cost time: 6.244245767593384
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.743 Vali Acc: 0.493 Test Loss: 1.743 Test Acc: 0.493
Validation loss decreased (-0.486649 --> -0.493316).  Saving model ...
Epoch: 16 cost time: 5.481756925582886
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.729 Vali Acc: 0.490 Test Loss: 1.729 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.352142810821533
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.711 Vali Acc: 0.503 Test Loss: 1.711 Test Acc: 0.503
Validation loss decreased (-0.493316 --> -0.503316).  Saving model ...
Epoch: 18 cost time: 5.620547294616699
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.689 Vali Acc: 0.510 Test Loss: 1.689 Test Acc: 0.510
Validation loss decreased (-0.503316 --> -0.509983).  Saving model ...
Epoch: 19 cost time: 6.769281625747681
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.676 Vali Acc: 0.527 Test Loss: 1.676 Test Acc: 0.527
Validation loss decreased (-0.509983 --> -0.526650).  Saving model ...
Epoch: 20 cost time: 6.079733371734619
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.661 Vali Acc: 0.533 Test Loss: 1.661 Test Acc: 0.533
Validation loss decreased (-0.526650 --> -0.533317).  Saving model ...
Epoch: 21 cost time: 6.018150806427002
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.645 Vali Acc: 0.527 Test Loss: 1.645 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.95191216468811
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.632 Vali Acc: 0.533 Test Loss: 1.632 Test Acc: 0.533
Validation loss decreased (-0.533317 --> -0.533317).  Saving model ...
Epoch: 23 cost time: 6.105082988739014
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.622 Vali Acc: 0.540 Test Loss: 1.622 Test Acc: 0.540
Validation loss decreased (-0.533317 --> -0.539984).  Saving model ...
Epoch: 24 cost time: 5.923900365829468
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.611 Vali Acc: 0.547 Test Loss: 1.611 Test Acc: 0.547
Validation loss decreased (-0.539984 --> -0.546651).  Saving model ...
Epoch: 25 cost time: 6.256083726882935
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.595 Vali Acc: 0.547 Test Loss: 1.595 Test Acc: 0.547
Validation loss decreased (-0.546651 --> -0.546651).  Saving model ...
Epoch: 26 cost time: 6.011007308959961
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.578 Vali Acc: 0.563 Test Loss: 1.578 Test Acc: 0.563
Validation loss decreased (-0.546651 --> -0.563318).  Saving model ...
Epoch: 27 cost time: 5.41274881362915
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.574 Vali Acc: 0.573 Test Loss: 1.574 Test Acc: 0.573
Validation loss decreased (-0.563318 --> -0.573318).  Saving model ...
Epoch: 28 cost time: 5.8451926708221436
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.569 Vali Acc: 0.557 Test Loss: 1.569 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.40137243270874
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.563 Vali Acc: 0.563 Test Loss: 1.563 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.045072793960571
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.556 Vali Acc: 0.577 Test Loss: 1.556 Test Acc: 0.577
Validation loss decreased (-0.573318 --> -0.576651).  Saving model ...
Epoch: 31 cost time: 6.3510777950286865
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.570 Test Loss: 1.551 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.971935510635376
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.541 Vali Acc: 0.580 Test Loss: 1.541 Test Acc: 0.580
Validation loss decreased (-0.576651 --> -0.579985).  Saving model ...
Epoch: 33 cost time: 5.643250465393066
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.531 Vali Acc: 0.577 Test Loss: 1.531 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.681294918060303
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.531 Vali Acc: 0.577 Test Loss: 1.531 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.917543411254883
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.580 Test Loss: 1.524 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 36 cost time: 6.436798572540283
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.518 Vali Acc: 0.580 Test Loss: 1.518 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 37 cost time: 6.456949710845947
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.514 Vali Acc: 0.583 Test Loss: 1.514 Test Acc: 0.583
Validation loss decreased (-0.579985 --> -0.583318).  Saving model ...
Epoch: 38 cost time: 6.305752277374268
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.583 Test Loss: 1.511 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583318).  Saving model ...
Epoch: 39 cost time: 5.955011367797852
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.587 Test Loss: 1.500 Test Acc: 0.587
Validation loss decreased (-0.583318 --> -0.586652).  Saving model ...
Epoch: 40 cost time: 5.52825927734375
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.593 Test Loss: 1.493 Test Acc: 0.593
Validation loss decreased (-0.586652 --> -0.593318).  Saving model ...
Epoch: 41 cost time: 5.951684951782227
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.593 Test Loss: 1.488 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 42 cost time: 6.257985830307007
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.590 Test Loss: 1.488 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.474522590637207
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.590 Test Loss: 1.478 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.536736726760864
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.597 Test Loss: 1.471 Test Acc: 0.597
Validation loss decreased (-0.593318 --> -0.596652).  Saving model ...
Epoch: 45 cost time: 5.958291530609131
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.465 Vali Acc: 0.593 Test Loss: 1.465 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.20399022102356
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.459 Vali Acc: 0.600 Test Loss: 1.459 Test Acc: 0.600
Validation loss decreased (-0.596652 --> -0.599985).  Saving model ...
Epoch: 47 cost time: 6.410202264785767
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.597 Test Loss: 1.456 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.7304418087005615
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.600 Test Loss: 1.454 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599985).  Saving model ...
Epoch: 49 cost time: 5.561162710189819
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.603 Test Loss: 1.449 Test Acc: 0.603
Validation loss decreased (-0.599985 --> -0.603319).  Saving model ...
Epoch: 50 cost time: 5.484751224517822
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.600 Test Loss: 1.444 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 6.278778553009033
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.607 Test Loss: 1.442 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606652).  Saving model ...
Epoch: 52 cost time: 6.080422401428223
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.610 Test Loss: 1.442 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 53 cost time: 6.2082929611206055
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.607 Test Loss: 1.436 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.150290012359619
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.603 Test Loss: 1.429 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.090457439422607
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.613 Test Loss: 1.425 Test Acc: 0.613
Validation loss decreased (-0.609986 --> -0.613319).  Saving model ...
Epoch: 56 cost time: 6.2487146854400635
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.620 Test Loss: 1.422 Test Acc: 0.620
Validation loss decreased (-0.613319 --> -0.619986).  Saving model ...
Epoch: 57 cost time: 6.0735883712768555
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.623 Test Loss: 1.419 Test Acc: 0.623
Validation loss decreased (-0.619986 --> -0.623319).  Saving model ...
Epoch: 58 cost time: 6.461498975753784
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.617 Test Loss: 1.419 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 5.641313552856445
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.620 Test Loss: 1.418 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 5.721603155136108
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.627 Test Loss: 1.413 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626653).  Saving model ...
Epoch: 61 cost time: 5.7389817237854
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.623 Test Loss: 1.410 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.098919630050659
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.623 Test Loss: 1.408 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 6.1999006271362305
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.623 Test Loss: 1.406 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 6.158935070037842
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.620 Test Loss: 1.406 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 5.49808406829834
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.402 Vali Acc: 0.620 Test Loss: 1.402 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 5.61265230178833
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.620 Test Loss: 1.401 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 5.591476678848267
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.620 Test Loss: 1.397 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 6.139832973480225
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.627 Test Loss: 1.391 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 69 cost time: 6.048081398010254
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.627 Test Loss: 1.390 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 70 cost time: 5.835907220840454
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.633 Test Loss: 1.387 Test Acc: 0.633
Validation loss decreased (-0.626653 --> -0.633319).  Saving model ...
Epoch: 71 cost time: 5.508435010910034
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.627 Test Loss: 1.387 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.812561750411987
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.620 Test Loss: 1.386 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.22704553604126
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.633 Test Loss: 1.383 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633320).  Saving model ...
Epoch: 74 cost time: 6.135004281997681
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.378 Vali Acc: 0.637 Test Loss: 1.378 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.636653).  Saving model ...
Epoch: 75 cost time: 6.424044370651245
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.637 Test Loss: 1.376 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 76 cost time: 6.355128526687622
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.643 Test Loss: 1.371 Test Acc: 0.643
Validation loss decreased (-0.636653 --> -0.643320).  Saving model ...
Epoch: 77 cost time: 6.020313739776611
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.643 Test Loss: 1.369 Test Acc: 0.643
Validation loss decreased (-0.643320 --> -0.643320).  Saving model ...
Epoch: 78 cost time: 5.7151570320129395
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.643 Test Loss: 1.366 Test Acc: 0.643
Validation loss decreased (-0.643320 --> -0.643320).  Saving model ...
Epoch: 79 cost time: 6.12641978263855
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.647 Test Loss: 1.365 Test Acc: 0.647
Validation loss decreased (-0.643320 --> -0.646653).  Saving model ...
Epoch: 80 cost time: 5.915429592132568
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.647 Test Loss: 1.364 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 81 cost time: 5.571686029434204
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.647 Test Loss: 1.360 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 82 cost time: 5.6858813762664795
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.647 Test Loss: 1.360 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 83 cost time: 5.8326826095581055
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.650 Test Loss: 1.358 Test Acc: 0.650
Validation loss decreased (-0.646653 --> -0.649986).  Saving model ...
Epoch: 84 cost time: 5.784576177597046
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.653 Test Loss: 1.356 Test Acc: 0.653
Validation loss decreased (-0.649986 --> -0.653320).  Saving model ...
Epoch: 85 cost time: 6.056446075439453
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.657 Test Loss: 1.357 Test Acc: 0.657
Validation loss decreased (-0.653320 --> -0.656653).  Saving model ...
Epoch: 86 cost time: 5.958446979522705
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.663 Test Loss: 1.357 Test Acc: 0.663
Validation loss decreased (-0.656653 --> -0.663320).  Saving model ...
Epoch: 87 cost time: 6.292067527770996
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.663 Test Loss: 1.356 Test Acc: 0.663
Validation loss decreased (-0.663320 --> -0.663320).  Saving model ...
Epoch: 88 cost time: 6.467300176620483
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.660 Test Loss: 1.356 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 6.428772211074829
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.660 Test Loss: 1.355 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 5.599691390991211
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.660 Test Loss: 1.353 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 5.6073830127716064
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.657 Test Loss: 1.350 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 5.578980922698975
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.657 Test Loss: 1.348 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 6.225405693054199
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.667 Test Loss: 1.344 Test Acc: 0.667
Validation loss decreased (-0.663320 --> -0.666653).  Saving model ...
Epoch: 94 cost time: 6.1672117710113525
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.670 Test Loss: 1.342 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.669987).  Saving model ...
Epoch: 95 cost time: 5.627344369888306
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.677 Test Loss: 1.341 Test Acc: 0.677
Validation loss decreased (-0.669987 --> -0.676653).  Saving model ...
Epoch: 96 cost time: 5.705111980438232
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.677 Test Loss: 1.340 Test Acc: 0.677
Validation loss decreased (-0.676653 --> -0.676653).  Saving model ...
Epoch: 97 cost time: 5.690223932266235
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.673 Test Loss: 1.337 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 6.174860239028931
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.680 Test Loss: 1.335 Test Acc: 0.680
Validation loss decreased (-0.676653 --> -0.679987).  Saving model ...
Epoch: 99 cost time: 6.632275104522705
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.677 Test Loss: 1.333 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 5.9571874141693115
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.331 Vali Acc: 0.673 Test Loss: 1.331 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.68
model parameter : 1912345
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.771152973175049
Epoch: 1, Steps: 18 | Train Loss: 3.260 Vali Loss: 3.202 Vali Acc: 0.067 Test Loss: 3.202 Test Acc: 0.067
Validation loss decreased (inf --> -0.066635).  Saving model ...
Epoch: 2 cost time: 6.252792835235596
Epoch: 2, Steps: 18 | Train Loss: 2.788 Vali Loss: 3.047 Vali Acc: 0.110 Test Loss: 3.047 Test Acc: 0.110
Validation loss decreased (-0.066635 --> -0.109970).  Saving model ...
Epoch: 3 cost time: 6.275648355484009
Epoch: 3, Steps: 18 | Train Loss: 1.988 Vali Loss: 2.885 Vali Acc: 0.160 Test Loss: 2.885 Test Acc: 0.160
Validation loss decreased (-0.109970 --> -0.159971).  Saving model ...
Epoch: 4 cost time: 6.197974920272827
Epoch: 4, Steps: 18 | Train Loss: 1.147 Vali Loss: 2.764 Vali Acc: 0.150 Test Loss: 2.764 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.795527935028076
Epoch: 5, Steps: 18 | Train Loss: 0.516 Vali Loss: 2.623 Vali Acc: 0.203 Test Loss: 2.623 Test Acc: 0.203
Validation loss decreased (-0.159971 --> -0.203307).  Saving model ...
Epoch: 6 cost time: 5.216008901596069
Epoch: 6, Steps: 18 | Train Loss: 0.191 Vali Loss: 2.557 Vali Acc: 0.223 Test Loss: 2.557 Test Acc: 0.223
Validation loss decreased (-0.203307 --> -0.223308).  Saving model ...
Epoch: 7 cost time: 5.875994443893433
Epoch: 7, Steps: 18 | Train Loss: 0.067 Vali Loss: 2.437 Vali Acc: 0.263 Test Loss: 2.437 Test Acc: 0.263
Validation loss decreased (-0.223308 --> -0.263309).  Saving model ...
Epoch: 8 cost time: 6.223133325576782
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 2.373 Vali Acc: 0.290 Test Loss: 2.373 Test Acc: 0.290
Validation loss decreased (-0.263309 --> -0.289976).  Saving model ...
Epoch: 9 cost time: 6.044923305511475
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 2.311 Vali Acc: 0.313 Test Loss: 2.311 Test Acc: 0.313
Validation loss decreased (-0.289976 --> -0.313310).  Saving model ...
Epoch: 10 cost time: 5.868793487548828
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.228 Vali Acc: 0.333 Test Loss: 2.228 Test Acc: 0.333
Validation loss decreased (-0.313310 --> -0.333311).  Saving model ...
Epoch: 11 cost time: 6.172559976577759
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.175 Vali Acc: 0.337 Test Loss: 2.175 Test Acc: 0.337
Validation loss decreased (-0.333311 --> -0.336645).  Saving model ...
Epoch: 12 cost time: 6.11714506149292
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.144 Vali Acc: 0.367 Test Loss: 2.144 Test Acc: 0.367
Validation loss decreased (-0.336645 --> -0.366645).  Saving model ...
Epoch: 13 cost time: 6.482254505157471
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.078 Vali Acc: 0.380 Test Loss: 2.078 Test Acc: 0.380
Validation loss decreased (-0.366645 --> -0.379979).  Saving model ...
Epoch: 14 cost time: 6.777770757675171
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 2.026 Vali Acc: 0.400 Test Loss: 2.026 Test Acc: 0.400
Validation loss decreased (-0.379979 --> -0.399980).  Saving model ...
Epoch: 15 cost time: 5.9430763721466064
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.995 Vali Acc: 0.413 Test Loss: 1.995 Test Acc: 0.413
Validation loss decreased (-0.399980 --> -0.413313).  Saving model ...
Epoch: 16 cost time: 5.8068132400512695
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.954 Vali Acc: 0.433 Test Loss: 1.954 Test Acc: 0.433
Validation loss decreased (-0.413313 --> -0.433314).  Saving model ...
Epoch: 17 cost time: 5.793469667434692
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.942 Vali Acc: 0.437 Test Loss: 1.942 Test Acc: 0.437
Validation loss decreased (-0.433314 --> -0.436647).  Saving model ...
Epoch: 18 cost time: 6.231236934661865
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.921 Vali Acc: 0.447 Test Loss: 1.921 Test Acc: 0.447
Validation loss decreased (-0.436647 --> -0.446647).  Saving model ...
Epoch: 19 cost time: 6.647519111633301
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.893 Vali Acc: 0.477 Test Loss: 1.893 Test Acc: 0.477
Validation loss decreased (-0.446647 --> -0.476648).  Saving model ...
Epoch: 20 cost time: 5.933029413223267
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.869 Vali Acc: 0.477 Test Loss: 1.869 Test Acc: 0.477
Validation loss decreased (-0.476648 --> -0.476648).  Saving model ...
Epoch: 21 cost time: 5.781708240509033
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.852 Vali Acc: 0.470 Test Loss: 1.852 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.610297918319702
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.827 Vali Acc: 0.487 Test Loss: 1.827 Test Acc: 0.487
Validation loss decreased (-0.476648 --> -0.486648).  Saving model ...
Epoch: 23 cost time: 5.957728862762451
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.816 Vali Acc: 0.490 Test Loss: 1.816 Test Acc: 0.490
Validation loss decreased (-0.486648 --> -0.489982).  Saving model ...
Epoch: 24 cost time: 6.088656663894653
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.805 Vali Acc: 0.490 Test Loss: 1.805 Test Acc: 0.490
Validation loss decreased (-0.489982 --> -0.489982).  Saving model ...
Epoch: 25 cost time: 5.5634448528289795
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.788 Vali Acc: 0.507 Test Loss: 1.788 Test Acc: 0.507
Validation loss decreased (-0.489982 --> -0.506649).  Saving model ...
Epoch: 26 cost time: 5.570133924484253
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.764 Vali Acc: 0.507 Test Loss: 1.764 Test Acc: 0.507
Validation loss decreased (-0.506649 --> -0.506649).  Saving model ...
Epoch: 27 cost time: 5.854928255081177
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.742 Vali Acc: 0.523 Test Loss: 1.742 Test Acc: 0.523
Validation loss decreased (-0.506649 --> -0.523316).  Saving model ...
Epoch: 28 cost time: 6.399684190750122
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.726 Vali Acc: 0.517 Test Loss: 1.726 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.344454765319824
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.713 Vali Acc: 0.520 Test Loss: 1.713 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.3266026973724365
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.699 Vali Acc: 0.530 Test Loss: 1.699 Test Acc: 0.530
Validation loss decreased (-0.523316 --> -0.529983).  Saving model ...
Epoch: 31 cost time: 6.076035737991333
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.686 Vali Acc: 0.533 Test Loss: 1.686 Test Acc: 0.533
Validation loss decreased (-0.529983 --> -0.533316).  Saving model ...
Epoch: 32 cost time: 5.986394643783569
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.674 Vali Acc: 0.550 Test Loss: 1.674 Test Acc: 0.550
Validation loss decreased (-0.533316 --> -0.549983).  Saving model ...
Epoch: 33 cost time: 6.194074630737305
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.657 Vali Acc: 0.550 Test Loss: 1.657 Test Acc: 0.550
Validation loss decreased (-0.549983 --> -0.549983).  Saving model ...
Epoch: 34 cost time: 6.097901821136475
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.640 Vali Acc: 0.563 Test Loss: 1.640 Test Acc: 0.563
Validation loss decreased (-0.549983 --> -0.563317).  Saving model ...
Epoch: 35 cost time: 6.103050231933594
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.634 Vali Acc: 0.573 Test Loss: 1.634 Test Acc: 0.573
Validation loss decreased (-0.563317 --> -0.573317).  Saving model ...
Epoch: 36 cost time: 5.666907548904419
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.623 Vali Acc: 0.567 Test Loss: 1.623 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.628340482711792
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.621 Vali Acc: 0.563 Test Loss: 1.621 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.581067800521851
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.563 Test Loss: 1.616 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 5.976187705993652
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.573 Test Loss: 1.606 Test Acc: 0.573
Validation loss decreased (-0.573317 --> -0.573317).  Saving model ...
Epoch: 40 cost time: 6.403757810592651
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.580 Test Loss: 1.596 Test Acc: 0.580
Validation loss decreased (-0.573317 --> -0.579984).  Saving model ...
Epoch: 41 cost time: 5.7979655265808105
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.577 Test Loss: 1.586 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.8195106983184814
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.580 Test Loss: 1.578 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579984).  Saving model ...
Epoch: 43 cost time: 5.7314293384552
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.577 Test Loss: 1.574 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.25151801109314
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.583 Test Loss: 1.573 Test Acc: 0.583
Validation loss decreased (-0.579984 --> -0.583318).  Saving model ...
Epoch: 45 cost time: 6.086512327194214
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.577 Test Loss: 1.569 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.1703479290008545
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.580 Test Loss: 1.561 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.84087610244751
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.577 Test Loss: 1.553 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 5.851517677307129
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.583 Test Loss: 1.547 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583318).  Saving model ...
Epoch: 49 cost time: 5.880707263946533
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.542 Vali Acc: 0.583 Test Loss: 1.542 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583318).  Saving model ...
Epoch: 50 cost time: 6.204240560531616
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.593 Test Loss: 1.536 Test Acc: 0.593
Validation loss decreased (-0.583318 --> -0.593318).  Saving model ...
Epoch: 51 cost time: 6.0922393798828125
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.590 Test Loss: 1.531 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.842785596847534
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.593 Test Loss: 1.530 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 53 cost time: 6.04092812538147
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.587 Test Loss: 1.526 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.796287775039673
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.590 Test Loss: 1.521 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.33500599861145
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.593 Test Loss: 1.517 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 56 cost time: 6.573201894760132
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.514 Vali Acc: 0.593 Test Loss: 1.514 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 57 cost time: 6.295091390609741
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.593 Test Loss: 1.513 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 58 cost time: 6.3096253871917725
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.597 Test Loss: 1.508 Test Acc: 0.597
Validation loss decreased (-0.593318 --> -0.596652).  Saving model ...
Epoch: 59 cost time: 5.812670946121216
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.603 Test Loss: 1.506 Test Acc: 0.603
Validation loss decreased (-0.596652 --> -0.603318).  Saving model ...
Epoch: 60 cost time: 6.124809265136719
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.607 Test Loss: 1.499 Test Acc: 0.607
Validation loss decreased (-0.603318 --> -0.606652).  Saving model ...
Epoch: 61 cost time: 5.801514148712158
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.600 Test Loss: 1.492 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 5.8724143505096436
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.603 Test Loss: 1.488 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 5.711511135101318
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.603 Test Loss: 1.482 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 5.804996728897095
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.603 Test Loss: 1.480 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 5.859681129455566
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.475 Vali Acc: 0.617 Test Loss: 1.475 Test Acc: 0.617
Validation loss decreased (-0.606652 --> -0.616652).  Saving model ...
Epoch: 66 cost time: 6.579039096832275
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.613 Test Loss: 1.473 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 6.483131647109985
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.610 Test Loss: 1.470 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 5.882506370544434
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.465 Vali Acc: 0.613 Test Loss: 1.465 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 5.735884666442871
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.620 Test Loss: 1.461 Test Acc: 0.620
Validation loss decreased (-0.616652 --> -0.619985).  Saving model ...
Epoch: 70 cost time: 5.785415887832642
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.623 Test Loss: 1.456 Test Acc: 0.623
Validation loss decreased (-0.619985 --> -0.623319).  Saving model ...
Epoch: 71 cost time: 6.248415946960449
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.620 Test Loss: 1.455 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 6.323633432388306
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.623 Test Loss: 1.453 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 73 cost time: 6.126283407211304
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.627 Test Loss: 1.448 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626652).  Saving model ...
Epoch: 74 cost time: 5.590935468673706
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.446 Vali Acc: 0.623 Test Loss: 1.446 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 5.646172761917114
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.627 Test Loss: 1.442 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 76 cost time: 5.597642421722412
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.627 Test Loss: 1.439 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 77 cost time: 6.20393705368042
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.630 Test Loss: 1.438 Test Acc: 0.630
Validation loss decreased (-0.626652 --> -0.629986).  Saving model ...
Epoch: 78 cost time: 5.958906888961792
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.627 Test Loss: 1.434 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 5.583392381668091
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.627 Test Loss: 1.429 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 6.152827739715576
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.630 Test Loss: 1.427 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 81 cost time: 6.102309703826904
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.637 Test Loss: 1.426 Test Acc: 0.637
Validation loss decreased (-0.629986 --> -0.636652).  Saving model ...
Epoch: 82 cost time: 6.108076572418213
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.637 Test Loss: 1.425 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 83 cost time: 5.91679310798645
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.630 Test Loss: 1.422 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 5.96752667427063
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.630 Test Loss: 1.420 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 6.244858741760254
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.633 Test Loss: 1.419 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 6.2572104930877686
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.417 Vali Acc: 0.637 Test Loss: 1.417 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 87 cost time: 5.932767391204834
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.637 Test Loss: 1.416 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636653).  Saving model ...
Epoch: 88 cost time: 5.626968860626221
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.417 Vali Acc: 0.633 Test Loss: 1.417 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 5.554760217666626
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.637 Test Loss: 1.415 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 90 cost time: 5.507636785507202
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.637 Test Loss: 1.411 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 91 cost time: 5.891880512237549
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.640 Test Loss: 1.412 Test Acc: 0.640
Validation loss decreased (-0.636653 --> -0.639986).  Saving model ...
Epoch: 92 cost time: 5.94104528427124
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.640 Test Loss: 1.411 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 93 cost time: 5.748058319091797
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.640 Test Loss: 1.408 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 94 cost time: 5.9957873821258545
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.643 Test Loss: 1.407 Test Acc: 0.643
Validation loss decreased (-0.639986 --> -0.643319).  Saving model ...
Epoch: 95 cost time: 5.913515567779541
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.643 Test Loss: 1.407 Test Acc: 0.643
Validation loss decreased (-0.643319 --> -0.643319).  Saving model ...
Epoch: 96 cost time: 6.2356791496276855
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.650 Test Loss: 1.403 Test Acc: 0.650
Validation loss decreased (-0.643319 --> -0.649986).  Saving model ...
Epoch: 97 cost time: 6.355226993560791
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.647 Test Loss: 1.400 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 6.850383758544922
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.650 Test Loss: 1.398 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 99 cost time: 5.8527116775512695
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.647 Test Loss: 1.398 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 5.560134172439575
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.650 Test Loss: 1.396 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.65
model parameter : 1912345
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.970028877258301
Epoch: 1, Steps: 18 | Train Loss: 3.232 Vali Loss: 3.180 Vali Acc: 0.057 Test Loss: 3.180 Test Acc: 0.057
Validation loss decreased (inf --> -0.056635).  Saving model ...
Epoch: 2 cost time: 5.962988615036011
Epoch: 2, Steps: 18 | Train Loss: 2.809 Vali Loss: 3.037 Vali Acc: 0.113 Test Loss: 3.037 Test Acc: 0.113
Validation loss decreased (-0.056635 --> -0.113303).  Saving model ...
Epoch: 3 cost time: 5.912426948547363
Epoch: 3, Steps: 18 | Train Loss: 2.091 Vali Loss: 2.865 Vali Acc: 0.147 Test Loss: 2.865 Test Acc: 0.147
Validation loss decreased (-0.113303 --> -0.146638).  Saving model ...
Epoch: 4 cost time: 5.964318037033081
Epoch: 4, Steps: 18 | Train Loss: 1.335 Vali Loss: 2.761 Vali Acc: 0.110 Test Loss: 2.761 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.099830627441406
Epoch: 5, Steps: 18 | Train Loss: 0.704 Vali Loss: 2.561 Vali Acc: 0.233 Test Loss: 2.561 Test Acc: 0.233
Validation loss decreased (-0.146638 --> -0.233308).  Saving model ...
Epoch: 6 cost time: 6.27142071723938
Epoch: 6, Steps: 18 | Train Loss: 0.303 Vali Loss: 2.490 Vali Acc: 0.210 Test Loss: 2.490 Test Acc: 0.210
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.367757081985474
Epoch: 7, Steps: 18 | Train Loss: 0.108 Vali Loss: 2.288 Vali Acc: 0.300 Test Loss: 2.288 Test Acc: 0.300
Validation loss decreased (-0.233308 --> -0.299977).  Saving model ...
Epoch: 8 cost time: 6.187021493911743
Epoch: 8, Steps: 18 | Train Loss: 0.047 Vali Loss: 2.121 Vali Acc: 0.343 Test Loss: 2.121 Test Acc: 0.343
Validation loss decreased (-0.299977 --> -0.343312).  Saving model ...
Epoch: 9 cost time: 6.113207817077637
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.983 Vali Acc: 0.383 Test Loss: 1.983 Test Acc: 0.383
Validation loss decreased (-0.343312 --> -0.383314).  Saving model ...
Epoch: 10 cost time: 6.064739227294922
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.872 Vali Acc: 0.447 Test Loss: 1.872 Test Acc: 0.447
Validation loss decreased (-0.383314 --> -0.446648).  Saving model ...
Epoch: 11 cost time: 6.0001115798950195
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.853 Vali Acc: 0.467 Test Loss: 1.853 Test Acc: 0.467
Validation loss decreased (-0.446648 --> -0.466648).  Saving model ...
Epoch: 12 cost time: 6.199209451675415
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.811 Vali Acc: 0.463 Test Loss: 1.811 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.035787105560303
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.757 Vali Acc: 0.487 Test Loss: 1.757 Test Acc: 0.487
Validation loss decreased (-0.466648 --> -0.486649).  Saving model ...
Epoch: 14 cost time: 5.610562324523926
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.687 Vali Acc: 0.510 Test Loss: 1.687 Test Acc: 0.510
Validation loss decreased (-0.486649 --> -0.509983).  Saving model ...
Epoch: 15 cost time: 6.003663063049316
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.667 Vali Acc: 0.520 Test Loss: 1.667 Test Acc: 0.520
Validation loss decreased (-0.509983 --> -0.519983).  Saving model ...
Epoch: 16 cost time: 6.79378604888916
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.644 Vali Acc: 0.523 Test Loss: 1.644 Test Acc: 0.523
Validation loss decreased (-0.519983 --> -0.523317).  Saving model ...
Epoch: 17 cost time: 6.619873762130737
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.631 Vali Acc: 0.527 Test Loss: 1.631 Test Acc: 0.527
Validation loss decreased (-0.523317 --> -0.526650).  Saving model ...
Epoch: 18 cost time: 6.629379034042358
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.600 Vali Acc: 0.527 Test Loss: 1.600 Test Acc: 0.527
Validation loss decreased (-0.526650 --> -0.526651).  Saving model ...
Epoch: 19 cost time: 6.689281463623047
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.574 Vali Acc: 0.550 Test Loss: 1.574 Test Acc: 0.550
Validation loss decreased (-0.526651 --> -0.549984).  Saving model ...
Epoch: 20 cost time: 6.3126304149627686
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.561 Vali Acc: 0.553 Test Loss: 1.561 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553318).  Saving model ...
Epoch: 21 cost time: 6.537792921066284
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.546 Vali Acc: 0.553 Test Loss: 1.546 Test Acc: 0.553
Validation loss decreased (-0.553318 --> -0.553318).  Saving model ...
Epoch: 22 cost time: 6.7471840381622314
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.521 Vali Acc: 0.563 Test Loss: 1.521 Test Acc: 0.563
Validation loss decreased (-0.553318 --> -0.563318).  Saving model ...
Epoch: 23 cost time: 6.643134117126465
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.510 Vali Acc: 0.573 Test Loss: 1.510 Test Acc: 0.573
Validation loss decreased (-0.563318 --> -0.573318).  Saving model ...
Epoch: 24 cost time: 5.970477342605591
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.504 Vali Acc: 0.573 Test Loss: 1.504 Test Acc: 0.573
Validation loss decreased (-0.573318 --> -0.573318).  Saving model ...
Epoch: 25 cost time: 5.684775352478027
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.498 Vali Acc: 0.573 Test Loss: 1.498 Test Acc: 0.573
Validation loss decreased (-0.573318 --> -0.573318).  Saving model ...
Epoch: 26 cost time: 6.278609991073608
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.481 Vali Acc: 0.577 Test Loss: 1.481 Test Acc: 0.577
Validation loss decreased (-0.573318 --> -0.576652).  Saving model ...
Epoch: 27 cost time: 5.925365209579468
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.465 Vali Acc: 0.580 Test Loss: 1.465 Test Acc: 0.580
Validation loss decreased (-0.576652 --> -0.579985).  Saving model ...
Epoch: 28 cost time: 6.210105895996094
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.452 Vali Acc: 0.587 Test Loss: 1.452 Test Acc: 0.587
Validation loss decreased (-0.579985 --> -0.586652).  Saving model ...
Epoch: 29 cost time: 5.979063034057617
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.440 Vali Acc: 0.583 Test Loss: 1.440 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.990760803222656
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.587 Test Loss: 1.430 Test Acc: 0.587
Validation loss decreased (-0.586652 --> -0.586652).  Saving model ...
Epoch: 31 cost time: 6.474971294403076
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.418 Vali Acc: 0.593 Test Loss: 1.418 Test Acc: 0.593
Validation loss decreased (-0.586652 --> -0.593319).  Saving model ...
Epoch: 32 cost time: 6.29879093170166
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.416 Vali Acc: 0.597 Test Loss: 1.416 Test Acc: 0.597
Validation loss decreased (-0.593319 --> -0.596653).  Saving model ...
Epoch: 33 cost time: 6.733531951904297
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.607 Test Loss: 1.400 Test Acc: 0.607
Validation loss decreased (-0.596653 --> -0.606653).  Saving model ...
Epoch: 34 cost time: 6.164887428283691
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.385 Vali Acc: 0.613 Test Loss: 1.385 Test Acc: 0.613
Validation loss decreased (-0.606653 --> -0.613319).  Saving model ...
Epoch: 35 cost time: 6.0788915157318115
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.607 Test Loss: 1.396 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.031126022338867
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.385 Vali Acc: 0.613 Test Loss: 1.385 Test Acc: 0.613
Validation loss decreased (-0.613319 --> -0.613319).  Saving model ...
Epoch: 37 cost time: 6.2400476932525635
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.607 Test Loss: 1.368 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.109614372253418
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.623 Test Loss: 1.353 Test Acc: 0.623
Validation loss decreased (-0.613319 --> -0.623320).  Saving model ...
Epoch: 39 cost time: 5.865243434906006
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.627 Test Loss: 1.342 Test Acc: 0.627
Validation loss decreased (-0.623320 --> -0.626653).  Saving model ...
Epoch: 40 cost time: 5.660971403121948
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.640 Test Loss: 1.339 Test Acc: 0.640
Validation loss decreased (-0.626653 --> -0.639987).  Saving model ...
Epoch: 41 cost time: 5.971529006958008
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.640 Test Loss: 1.333 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639987).  Saving model ...
Epoch: 42 cost time: 6.487444162368774
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.637 Test Loss: 1.327 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.935314893722534
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.633 Test Loss: 1.335 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 6.168073654174805
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.637 Test Loss: 1.342 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 6.029122591018677
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.334 Vali Acc: 0.630 Test Loss: 1.334 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 6.2783122062683105
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.637 Test Loss: 1.333 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 6.4595136642456055
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.330 Vali Acc: 0.640 Test Loss: 1.330 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639987).  Saving model ...
Epoch: 48 cost time: 6.552562952041626
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.643 Test Loss: 1.319 Test Acc: 0.643
Validation loss decreased (-0.639987 --> -0.643320).  Saving model ...
Epoch: 49 cost time: 5.739161729812622
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.647 Test Loss: 1.314 Test Acc: 0.647
Validation loss decreased (-0.643320 --> -0.646654).  Saving model ...
Epoch: 50 cost time: 5.78401255607605
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.310 Vali Acc: 0.647 Test Loss: 1.310 Test Acc: 0.647
Validation loss decreased (-0.646654 --> -0.646654).  Saving model ...
Epoch: 51 cost time: 5.683310270309448
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.305 Vali Acc: 0.650 Test Loss: 1.305 Test Acc: 0.650
Validation loss decreased (-0.646654 --> -0.649987).  Saving model ...
Epoch: 52 cost time: 6.5226829051971436
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.653 Test Loss: 1.299 Test Acc: 0.653
Validation loss decreased (-0.649987 --> -0.653320).  Saving model ...
Epoch: 53 cost time: 6.5341432094573975
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.657 Test Loss: 1.297 Test Acc: 0.657
Validation loss decreased (-0.653320 --> -0.656654).  Saving model ...
Epoch: 54 cost time: 6.2821314334869385
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.660 Test Loss: 1.297 Test Acc: 0.660
Validation loss decreased (-0.656654 --> -0.659987).  Saving model ...
Epoch: 55 cost time: 6.032147407531738
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.294 Vali Acc: 0.663 Test Loss: 1.294 Test Acc: 0.663
Validation loss decreased (-0.659987 --> -0.663320).  Saving model ...
Epoch: 56 cost time: 5.9719929695129395
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.663 Test Loss: 1.292 Test Acc: 0.663
Validation loss decreased (-0.663320 --> -0.663320).  Saving model ...
Epoch: 57 cost time: 6.350300312042236
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.287 Vali Acc: 0.657 Test Loss: 1.287 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.506178617477417
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.277 Vali Acc: 0.660 Test Loss: 1.277 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 6.118002891540527
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.663 Test Loss: 1.275 Test Acc: 0.663
Validation loss decreased (-0.663320 --> -0.663321).  Saving model ...
Epoch: 60 cost time: 5.951529026031494
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.271 Vali Acc: 0.663 Test Loss: 1.271 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 61 cost time: 6.009204149246216
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.660 Test Loss: 1.268 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.101860284805298
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.663 Test Loss: 1.265 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 63 cost time: 6.703539133071899
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.261 Vali Acc: 0.663 Test Loss: 1.261 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 64 cost time: 6.381176948547363
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.663 Test Loss: 1.258 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 65 cost time: 5.63486385345459
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.660 Test Loss: 1.251 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.734800577163696
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.667 Test Loss: 1.248 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666654).  Saving model ...
Epoch: 67 cost time: 6.141965627670288
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.667 Test Loss: 1.247 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 68 cost time: 6.50458288192749
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.667 Test Loss: 1.247 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 69 cost time: 6.5681774616241455
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.667 Test Loss: 1.250 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 6.393473863601685
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.249 Vali Acc: 0.667 Test Loss: 1.249 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 6.2017598152160645
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.670 Test Loss: 1.248 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669988).  Saving model ...
Epoch: 72 cost time: 6.933199167251587
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.670 Test Loss: 1.248 Test Acc: 0.670
Validation loss decreased (-0.669988 --> -0.669988).  Saving model ...
Epoch: 73 cost time: 6.3101606369018555
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.243 Vali Acc: 0.680 Test Loss: 1.243 Test Acc: 0.680
Validation loss decreased (-0.669988 --> -0.679988).  Saving model ...
Epoch: 74 cost time: 5.560174226760864
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.683 Test Loss: 1.240 Test Acc: 0.683
Validation loss decreased (-0.679988 --> -0.683321).  Saving model ...
Epoch: 75 cost time: 5.709884166717529
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.687 Test Loss: 1.242 Test Acc: 0.687
Validation loss decreased (-0.683321 --> -0.686654).  Saving model ...
Epoch: 76 cost time: 6.017807960510254
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.690 Test Loss: 1.239 Test Acc: 0.690
Validation loss decreased (-0.686654 --> -0.689988).  Saving model ...
Epoch: 77 cost time: 6.067142486572266
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.683 Test Loss: 1.238 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.733195066452026
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.683 Test Loss: 1.234 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 6.208572149276733
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.683 Test Loss: 1.230 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 6.491213798522949
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.683 Test Loss: 1.228 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 6.973077058792114
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.687 Test Loss: 1.230 Test Acc: 0.687
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 6.4541542530059814
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.690 Test Loss: 1.227 Test Acc: 0.690
Validation loss decreased (-0.689988 --> -0.689988).  Saving model ...
Epoch: 83 cost time: 5.891648292541504
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.697 Test Loss: 1.224 Test Acc: 0.697
Validation loss decreased (-0.689988 --> -0.696654).  Saving model ...
Epoch: 84 cost time: 6.354448318481445
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.697 Test Loss: 1.222 Test Acc: 0.697
Validation loss decreased (-0.696654 --> -0.696654).  Saving model ...
Epoch: 85 cost time: 6.601548910140991
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.690 Test Loss: 1.225 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 6.305015802383423
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.693 Test Loss: 1.224 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 6.163708209991455
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.690 Test Loss: 1.224 Test Acc: 0.690
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 5.5213847160339355
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.690 Test Loss: 1.227 Test Acc: 0.690
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 5.596725940704346
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.693 Test Loss: 1.226 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 5.700286149978638
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.693 Test Loss: 1.222 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 6.036353826522827
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.690 Test Loss: 1.220 Test Acc: 0.690
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 6.219020366668701
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.693 Test Loss: 1.220 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 5.832705736160278
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.693 Test Loss: 1.217 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 5.811237812042236
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.697 Test Loss: 1.215 Test Acc: 0.697
Validation loss decreased (-0.696654 --> -0.696655).  Saving model ...
Epoch: 95 cost time: 5.712996482849121
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.700 Test Loss: 1.213 Test Acc: 0.700
Validation loss decreased (-0.696655 --> -0.699988).  Saving model ...
Epoch: 96 cost time: 6.070911884307861
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.700 Test Loss: 1.211 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 97 cost time: 5.984210968017578
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.700 Test Loss: 1.212 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 6.185461759567261
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.697 Test Loss: 1.209 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 5.834921360015869
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.697 Test Loss: 1.208 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 5.841269254684448
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.700 Test Loss: 1.209 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7
model parameter : 1912345
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.035616874694824
Epoch: 1, Steps: 18 | Train Loss: 3.247 Vali Loss: 3.229 Vali Acc: 0.037 Test Loss: 3.229 Test Acc: 0.037
Validation loss decreased (inf --> -0.036634).  Saving model ...
Epoch: 2 cost time: 6.237617254257202
Epoch: 2, Steps: 18 | Train Loss: 2.832 Vali Loss: 3.108 Vali Acc: 0.077 Test Loss: 3.108 Test Acc: 0.077
Validation loss decreased (-0.036634 --> -0.076636).  Saving model ...
Epoch: 3 cost time: 5.3875627517700195
Epoch: 3, Steps: 18 | Train Loss: 2.115 Vali Loss: 2.942 Vali Acc: 0.093 Test Loss: 2.942 Test Acc: 0.093
Validation loss decreased (-0.076636 --> -0.093304).  Saving model ...
Epoch: 4 cost time: 5.661872625350952
Epoch: 4, Steps: 18 | Train Loss: 1.360 Vali Loss: 2.815 Vali Acc: 0.120 Test Loss: 2.815 Test Acc: 0.120
Validation loss decreased (-0.093304 --> -0.119972).  Saving model ...
Epoch: 5 cost time: 6.223793268203735
Epoch: 5, Steps: 18 | Train Loss: 0.741 Vali Loss: 2.590 Vali Acc: 0.233 Test Loss: 2.590 Test Acc: 0.233
Validation loss decreased (-0.119972 --> -0.233307).  Saving model ...
Epoch: 6 cost time: 6.325796842575073
Epoch: 6, Steps: 18 | Train Loss: 0.317 Vali Loss: 2.441 Vali Acc: 0.223 Test Loss: 2.441 Test Acc: 0.223
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.1890504360198975
Epoch: 7, Steps: 18 | Train Loss: 0.106 Vali Loss: 2.184 Vali Acc: 0.310 Test Loss: 2.184 Test Acc: 0.310
Validation loss decreased (-0.233307 --> -0.309978).  Saving model ...
Epoch: 8 cost time: 6.0997724533081055
Epoch: 8, Steps: 18 | Train Loss: 0.041 Vali Loss: 2.011 Vali Acc: 0.333 Test Loss: 2.011 Test Acc: 0.333
Validation loss decreased (-0.309978 --> -0.333313).  Saving model ...
Epoch: 9 cost time: 5.878545522689819
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.893 Vali Acc: 0.383 Test Loss: 1.893 Test Acc: 0.383
Validation loss decreased (-0.333313 --> -0.383314).  Saving model ...
Epoch: 10 cost time: 5.996584892272949
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.770 Vali Acc: 0.447 Test Loss: 1.770 Test Acc: 0.447
Validation loss decreased (-0.383314 --> -0.446649).  Saving model ...
Epoch: 11 cost time: 6.11460018157959
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.700 Vali Acc: 0.463 Test Loss: 1.700 Test Acc: 0.463
Validation loss decreased (-0.446649 --> -0.463316).  Saving model ...
Epoch: 12 cost time: 6.032968997955322
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.659 Vali Acc: 0.493 Test Loss: 1.659 Test Acc: 0.493
Validation loss decreased (-0.463316 --> -0.493317).  Saving model ...
Epoch: 13 cost time: 6.1962974071502686
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.629 Vali Acc: 0.480 Test Loss: 1.629 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.580337047576904
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.576 Vali Acc: 0.497 Test Loss: 1.576 Test Acc: 0.497
Validation loss decreased (-0.493317 --> -0.496651).  Saving model ...
Epoch: 15 cost time: 5.942786455154419
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.550 Vali Acc: 0.513 Test Loss: 1.550 Test Acc: 0.513
Validation loss decreased (-0.496651 --> -0.513318).  Saving model ...
Epoch: 16 cost time: 6.048128366470337
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.517 Vali Acc: 0.543 Test Loss: 1.517 Test Acc: 0.543
Validation loss decreased (-0.513318 --> -0.543318).  Saving model ...
Epoch: 17 cost time: 6.1610496044158936
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.501 Vali Acc: 0.540 Test Loss: 1.501 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.272327423095703
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.475 Vali Acc: 0.550 Test Loss: 1.475 Test Acc: 0.550
Validation loss decreased (-0.543318 --> -0.549985).  Saving model ...
Epoch: 19 cost time: 6.061411142349243
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.446 Vali Acc: 0.563 Test Loss: 1.446 Test Acc: 0.563
Validation loss decreased (-0.549985 --> -0.563319).  Saving model ...
Epoch: 20 cost time: 5.946126222610474
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.432 Vali Acc: 0.550 Test Loss: 1.432 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.5461156368255615
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.421 Vali Acc: 0.553 Test Loss: 1.421 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.403430461883545
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.399 Vali Acc: 0.560 Test Loss: 1.399 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.0877845287323
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.391 Vali Acc: 0.577 Test Loss: 1.391 Test Acc: 0.577
Validation loss decreased (-0.563319 --> -0.576653).  Saving model ...
Epoch: 24 cost time: 5.696766376495361
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.377 Vali Acc: 0.590 Test Loss: 1.377 Test Acc: 0.590
Validation loss decreased (-0.576653 --> -0.589986).  Saving model ...
Epoch: 25 cost time: 5.336972951889038
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.367 Vali Acc: 0.577 Test Loss: 1.367 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.479936122894287
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.351 Vali Acc: 0.597 Test Loss: 1.351 Test Acc: 0.597
Validation loss decreased (-0.589986 --> -0.596653).  Saving model ...
Epoch: 27 cost time: 5.797386884689331
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.335 Vali Acc: 0.603 Test Loss: 1.335 Test Acc: 0.603
Validation loss decreased (-0.596653 --> -0.603320).  Saving model ...
Epoch: 28 cost time: 5.911238193511963
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.320 Vali Acc: 0.610 Test Loss: 1.320 Test Acc: 0.610
Validation loss decreased (-0.603320 --> -0.609987).  Saving model ...
Epoch: 29 cost time: 5.67134690284729
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.315 Vali Acc: 0.620 Test Loss: 1.315 Test Acc: 0.620
Validation loss decreased (-0.609987 --> -0.619987).  Saving model ...
Epoch: 30 cost time: 5.261563539505005
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.308 Vali Acc: 0.617 Test Loss: 1.308 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.225201606750488
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.620 Test Loss: 1.296 Test Acc: 0.620
Validation loss decreased (-0.619987 --> -0.619987).  Saving model ...
Epoch: 32 cost time: 5.96523118019104
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.294 Vali Acc: 0.617 Test Loss: 1.294 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.203449726104736
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.284 Vali Acc: 0.630 Test Loss: 1.284 Test Acc: 0.630
Validation loss decreased (-0.619987 --> -0.629987).  Saving model ...
Epoch: 34 cost time: 6.390361785888672
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.276 Vali Acc: 0.633 Test Loss: 1.276 Test Acc: 0.633
Validation loss decreased (-0.629987 --> -0.633321).  Saving model ...
Epoch: 35 cost time: 5.748365879058838
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.613 Test Loss: 1.299 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.654294490814209
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.286 Vali Acc: 0.630 Test Loss: 1.286 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 5.727373361587524
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.633 Test Loss: 1.267 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633321).  Saving model ...
Epoch: 38 cost time: 6.209476470947266
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.647 Test Loss: 1.252 Test Acc: 0.647
Validation loss decreased (-0.633321 --> -0.646654).  Saving model ...
Epoch: 39 cost time: 6.01951789855957
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.243 Vali Acc: 0.650 Test Loss: 1.243 Test Acc: 0.650
Validation loss decreased (-0.646654 --> -0.649988).  Saving model ...
Epoch: 40 cost time: 5.500847101211548
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.650 Test Loss: 1.238 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 41 cost time: 5.47739315032959
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.657 Test Loss: 1.233 Test Acc: 0.657
Validation loss decreased (-0.649988 --> -0.656654).  Saving model ...
Epoch: 42 cost time: 5.3648152351379395
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.660 Test Loss: 1.226 Test Acc: 0.660
Validation loss decreased (-0.656654 --> -0.659988).  Saving model ...
Epoch: 43 cost time: 5.834210634231567
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.660 Test Loss: 1.223 Test Acc: 0.660
Validation loss decreased (-0.659988 --> -0.659988).  Saving model ...
Epoch: 44 cost time: 5.938026428222656
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.657 Test Loss: 1.221 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.7013185024261475
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.657 Test Loss: 1.219 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 5.509112119674683
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.657 Test Loss: 1.216 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 6.008358955383301
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.660 Test Loss: 1.211 Test Acc: 0.660
Validation loss decreased (-0.659988 --> -0.659988).  Saving model ...
Epoch: 48 cost time: 5.966657400131226
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.663 Test Loss: 1.207 Test Acc: 0.663
Validation loss decreased (-0.659988 --> -0.663321).  Saving model ...
Epoch: 49 cost time: 5.969423294067383
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.660 Test Loss: 1.205 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.821214914321899
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.667 Test Loss: 1.204 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666655).  Saving model ...
Epoch: 51 cost time: 5.90203332901001
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.670 Test Loss: 1.201 Test Acc: 0.670
Validation loss decreased (-0.666655 --> -0.669988).  Saving model ...
Epoch: 52 cost time: 5.949073791503906
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.667 Test Loss: 1.199 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 5.9420905113220215
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.663 Test Loss: 1.195 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 6.318825006484985
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.191 Vali Acc: 0.683 Test Loss: 1.191 Test Acc: 0.683
Validation loss decreased (-0.669988 --> -0.683321).  Saving model ...
Epoch: 55 cost time: 6.124109506607056
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.186 Vali Acc: 0.683 Test Loss: 1.186 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 56 cost time: 5.891350030899048
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.677 Test Loss: 1.184 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.290234565734863
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.673 Test Loss: 1.182 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 5.6846911907196045
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.667 Test Loss: 1.195 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 5.961536645889282
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.673 Test Loss: 1.187 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 5.640368223190308
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.673 Test Loss: 1.173 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 5.710568189620972
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.673 Test Loss: 1.169 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 5.7362587451934814
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.168 Vali Acc: 0.683 Test Loss: 1.168 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683322).  Saving model ...
Epoch: 63 cost time: 5.983046531677246
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.680 Test Loss: 1.167 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 6.033667325973511
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.165 Vali Acc: 0.673 Test Loss: 1.165 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 6.452522039413452
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.160 Vali Acc: 0.680 Test Loss: 1.160 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 5.967572212219238
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.157 Vali Acc: 0.683 Test Loss: 1.157 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 67 cost time: 5.9517741203308105
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.154 Vali Acc: 0.683 Test Loss: 1.154 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 68 cost time: 5.899062633514404
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.680 Test Loss: 1.150 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.170097351074219
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.147 Vali Acc: 0.677 Test Loss: 1.147 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 6.057052135467529
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.673 Test Loss: 1.144 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 6.205159425735474
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.677 Test Loss: 1.144 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 5.747203826904297
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.145 Vali Acc: 0.677 Test Loss: 1.145 Test Acc: 0.677
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 5.837610960006714
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.680 Test Loss: 1.142 Test Acc: 0.680
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 5.843633651733398
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.683 Test Loss: 1.142 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 75 cost time: 5.916884899139404
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.680 Test Loss: 1.142 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 5.509417772293091
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.683 Test Loss: 1.142 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 77 cost time: 5.557891130447388
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.143 Vali Acc: 0.680 Test Loss: 1.143 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.724113941192627
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.683 Test Loss: 1.142 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 6.5016984939575195
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.687 Test Loss: 1.139 Test Acc: 0.687
Validation loss decreased (-0.683322 --> -0.686655).  Saving model ...
Epoch: 80 cost time: 6.620991230010986
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.136 Vali Acc: 0.687 Test Loss: 1.136 Test Acc: 0.687
Validation loss decreased (-0.686655 --> -0.686655).  Saving model ...
Epoch: 81 cost time: 5.867852210998535
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.136 Vali Acc: 0.690 Test Loss: 1.136 Test Acc: 0.690
Validation loss decreased (-0.686655 --> -0.689989).  Saving model ...
Epoch: 82 cost time: 5.895457744598389
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.133 Vali Acc: 0.693 Test Loss: 1.133 Test Acc: 0.693
Validation loss decreased (-0.689989 --> -0.693322).  Saving model ...
Epoch: 83 cost time: 5.660174131393433
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.697 Test Loss: 1.132 Test Acc: 0.697
Validation loss decreased (-0.693322 --> -0.696655).  Saving model ...
Epoch: 84 cost time: 5.9952392578125
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.130 Vali Acc: 0.697 Test Loss: 1.130 Test Acc: 0.697
Validation loss decreased (-0.696655 --> -0.696655).  Saving model ...
Epoch: 85 cost time: 6.082331895828247
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.131 Vali Acc: 0.690 Test Loss: 1.131 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 5.719946384429932
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.130 Vali Acc: 0.693 Test Loss: 1.130 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 5.5589282512664795
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.129 Vali Acc: 0.697 Test Loss: 1.129 Test Acc: 0.697
Validation loss decreased (-0.696655 --> -0.696655).  Saving model ...
Epoch: 88 cost time: 5.341552257537842
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.697 Test Loss: 1.128 Test Acc: 0.697
Validation loss decreased (-0.696655 --> -0.696655).  Saving model ...
Epoch: 89 cost time: 6.159750938415527
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.126 Vali Acc: 0.697 Test Loss: 1.126 Test Acc: 0.697
Validation loss decreased (-0.696655 --> -0.696655).  Saving model ...
Epoch: 90 cost time: 5.969389915466309
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.127 Vali Acc: 0.693 Test Loss: 1.127 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 6.3669655323028564
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.127 Vali Acc: 0.693 Test Loss: 1.127 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 5.937090873718262
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.126 Vali Acc: 0.690 Test Loss: 1.126 Test Acc: 0.690
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 5.745552062988281
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.693 Test Loss: 1.124 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 6.532741546630859
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.697 Test Loss: 1.124 Test Acc: 0.697
Validation loss decreased (-0.696655 --> -0.696655).  Saving model ...
Epoch: 95 cost time: 6.488008975982666
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.123 Vali Acc: 0.700 Test Loss: 1.123 Test Acc: 0.700
Validation loss decreased (-0.696655 --> -0.699989).  Saving model ...
Epoch: 96 cost time: 6.236071348190308
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.700 Test Loss: 1.124 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 6.16552209854126
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.123 Vali Acc: 0.700 Test Loss: 1.123 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 5.831440448760986
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.121 Vali Acc: 0.697 Test Loss: 1.121 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 5.952070713043213
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.119 Vali Acc: 0.700 Test Loss: 1.119 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 100 cost time: 6.3759446144104
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.119 Vali Acc: 0.703 Test Loss: 1.119 Test Acc: 0.703
Validation loss decreased (-0.699989 --> -0.703322).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7033333333333334
model parameter : 1912345
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.3620312213897705
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 5.846281051635742
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.9617393016815186
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.156505346298218
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.342020034790039
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.817919969558716
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.865188121795654
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.768858432769775
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.46110463142395
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.189774036407471
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.095057487487793
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 1912345
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.2475128173828125
Epoch: 1, Steps: 18 | Train Loss: 3.011 Vali Loss: 2.334 Vali Acc: 0.653 Test Loss: 2.334 Test Acc: 0.653
Validation loss decreased (inf --> -0.653310).  Saving model ...
Epoch: 2 cost time: 5.9213292598724365
Epoch: 2, Steps: 18 | Train Loss: 1.581 Vali Loss: 1.062 Vali Acc: 0.843 Test Loss: 1.062 Test Acc: 0.843
Validation loss decreased (-0.653310 --> -0.843323).  Saving model ...
Epoch: 3 cost time: 5.972566604614258
Epoch: 3, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.588 Vali Acc: 0.873 Test Loss: 0.588 Test Acc: 0.873
Validation loss decreased (-0.843323 --> -0.873327).  Saving model ...
Epoch: 4 cost time: 6.378108501434326
Epoch: 4, Steps: 18 | Train Loss: 0.132 Vali Loss: 0.468 Vali Acc: 0.880 Test Loss: 0.468 Test Acc: 0.880
Validation loss decreased (-0.873327 --> -0.879995).  Saving model ...
Epoch: 5 cost time: 6.077488422393799
Epoch: 5, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.420 Vali Acc: 0.887 Test Loss: 0.420 Test Acc: 0.887
Validation loss decreased (-0.879995 --> -0.886662).  Saving model ...
Epoch: 6 cost time: 5.655273914337158
Epoch: 6, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
Validation loss decreased (-0.886662 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 6.079891204833984
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.391 Vali Acc: 0.893 Test Loss: 0.391 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.442944288253784
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.382 Vali Acc: 0.893 Test Loss: 0.382 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.427309036254883
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.374 Vali Acc: 0.897 Test Loss: 0.374 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.241239070892334
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.370 Vali Acc: 0.893 Test Loss: 0.370 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.939653158187866
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 5.573758125305176
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.364 Vali Acc: 0.907 Test Loss: 0.364 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.906663).  Saving model ...
Epoch: 13 cost time: 5.883164644241333
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.363 Vali Acc: 0.907 Test Loss: 0.363 Test Acc: 0.907
Validation loss decreased (-0.906663 --> -0.906663).  Saving model ...
Epoch: 14 cost time: 5.9693615436553955
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.078925371170044
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.36926007270813
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.803488492965698
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.288253545761108
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.656728267669678
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.58495569229126
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.358 Vali Acc: 0.907 Test Loss: 0.358 Test Acc: 0.907
Validation loss decreased (-0.906663 --> -0.906663).  Saving model ...
Epoch: 21 cost time: 6.218286037445068
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.353 Vali Acc: 0.907 Test Loss: 0.353 Test Acc: 0.907
Validation loss decreased (-0.906663 --> -0.906663).  Saving model ...
Epoch: 22 cost time: 5.6990766525268555
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.907 Test Loss: 0.354 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.683478116989136
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.353 Vali Acc: 0.907 Test Loss: 0.353 Test Acc: 0.907
Validation loss decreased (-0.906663 --> -0.906663).  Saving model ...
Epoch: 24 cost time: 6.335302829742432
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.910 Test Loss: 0.354 Test Acc: 0.910
Validation loss decreased (-0.906663 --> -0.909996).  Saving model ...
Epoch: 25 cost time: 5.799506664276123
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.353 Vali Acc: 0.910 Test Loss: 0.353 Test Acc: 0.910
Validation loss decreased (-0.909996 --> -0.909996).  Saving model ...
Epoch: 26 cost time: 6.208415985107422
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.910 Test Loss: 0.352 Test Acc: 0.910
Validation loss decreased (-0.909996 --> -0.909996).  Saving model ...
Epoch: 27 cost time: 6.036314964294434
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.129310131072998
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.769890069961548
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.907 Test Loss: 0.352 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.5586838722229
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.907 Test Loss: 0.352 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.918193340301514
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.907 Test Loss: 0.352 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.159022092819214
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.907 Test Loss: 0.353 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.645346164703369
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.907 Test Loss: 0.352 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 5.977226734161377
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.351 Vali Acc: 0.907 Test Loss: 0.351 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 6.23775053024292
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 5.848538637161255
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.350 Vali Acc: 0.907 Test Loss: 0.350 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.91
model parameter : 1519129
model size : 10.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.8432457447052
Epoch: 1, Steps: 18 | Train Loss: 3.087 Vali Loss: 2.559 Vali Acc: 0.560 Test Loss: 2.559 Test Acc: 0.560
Validation loss decreased (inf --> -0.559974).  Saving model ...
Epoch: 2 cost time: 5.973878860473633
Epoch: 2, Steps: 18 | Train Loss: 1.869 Vali Loss: 1.424 Vali Acc: 0.800 Test Loss: 1.424 Test Acc: 0.800
Validation loss decreased (-0.559974 --> -0.799986).  Saving model ...
Epoch: 3 cost time: 5.9850122928619385
Epoch: 3, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.842 Vali Acc: 0.820 Test Loss: 0.842 Test Acc: 0.820
Validation loss decreased (-0.799986 --> -0.819992).  Saving model ...
Epoch: 4 cost time: 5.560676574707031
Epoch: 4, Steps: 18 | Train Loss: 0.199 Vali Loss: 0.652 Vali Acc: 0.837 Test Loss: 0.652 Test Acc: 0.837
Validation loss decreased (-0.819992 --> -0.836660).  Saving model ...
Epoch: 5 cost time: 5.49068546295166
Epoch: 5, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.581 Vali Acc: 0.843 Test Loss: 0.581 Test Acc: 0.843
Validation loss decreased (-0.836660 --> -0.843328).  Saving model ...
Epoch: 6 cost time: 6.068833589553833
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.546 Vali Acc: 0.860 Test Loss: 0.546 Test Acc: 0.860
Validation loss decreased (-0.843328 --> -0.859995).  Saving model ...
Epoch: 7 cost time: 6.226512670516968
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.547 Vali Acc: 0.860 Test Loss: 0.547 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.3807220458984375
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.537 Vali Acc: 0.863 Test Loss: 0.537 Test Acc: 0.863
Validation loss decreased (-0.859995 --> -0.863328).  Saving model ...
Epoch: 9 cost time: 6.331338167190552
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.530 Vali Acc: 0.853 Test Loss: 0.530 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.75490140914917
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.530 Vali Acc: 0.863 Test Loss: 0.530 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 11 cost time: 5.95486044883728
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.523 Vali Acc: 0.877 Test Loss: 0.523 Test Acc: 0.877
Validation loss decreased (-0.863328 --> -0.876661).  Saving model ...
Epoch: 12 cost time: 6.214927911758423
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.521 Vali Acc: 0.860 Test Loss: 0.521 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.4047932624816895
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.863 Test Loss: 0.519 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.107635021209717
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.863 Test Loss: 0.518 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.466435432434082
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.860 Test Loss: 0.518 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.4736168384552
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.860 Test Loss: 0.518 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.029208660125732
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.860 Test Loss: 0.522 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.857046365737915
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.860 Test Loss: 0.522 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.2288923263549805
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.873 Test Loss: 0.517 Test Acc: 0.873
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.725611209869385
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.870 Test Loss: 0.516 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.795184373855591
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8766666666666667
model parameter : 1519129
model size : 10.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.063627004623413
Epoch: 1, Steps: 18 | Train Loss: 3.164 Vali Loss: 2.798 Vali Acc: 0.397 Test Loss: 2.798 Test Acc: 0.397
Validation loss decreased (inf --> -0.396639).  Saving model ...
Epoch: 2 cost time: 6.019113063812256
Epoch: 2, Steps: 18 | Train Loss: 2.230 Vali Loss: 1.942 Vali Acc: 0.720 Test Loss: 1.942 Test Acc: 0.720
Validation loss decreased (-0.396639 --> -0.719981).  Saving model ...
Epoch: 3 cost time: 5.8443968296051025
Epoch: 3, Steps: 18 | Train Loss: 1.108 Vali Loss: 1.316 Vali Acc: 0.717 Test Loss: 1.316 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.82388973236084
Epoch: 4, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.985 Vali Acc: 0.763 Test Loss: 0.985 Test Acc: 0.763
Validation loss decreased (-0.719981 --> -0.763323).  Saving model ...
Epoch: 5 cost time: 5.89671778678894
Epoch: 5, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.868 Vali Acc: 0.773 Test Loss: 0.868 Test Acc: 0.773
Validation loss decreased (-0.763323 --> -0.773325).  Saving model ...
Epoch: 6 cost time: 5.949095726013184
Epoch: 6, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.816 Vali Acc: 0.790 Test Loss: 0.816 Test Acc: 0.790
Validation loss decreased (-0.773325 --> -0.789992).  Saving model ...
Epoch: 7 cost time: 6.332162857055664
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.817 Vali Acc: 0.783 Test Loss: 0.817 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.859869480133057
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.791 Vali Acc: 0.780 Test Loss: 0.791 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.5422444343566895
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.783 Vali Acc: 0.783 Test Loss: 0.783 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.349614143371582
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.785 Vali Acc: 0.787 Test Loss: 0.785 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.117394685745239
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.778 Vali Acc: 0.800 Test Loss: 0.778 Test Acc: 0.800
Validation loss decreased (-0.789992 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 6.005781650543213
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.771 Vali Acc: 0.790 Test Loss: 0.771 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.198415040969849
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.777 Vali Acc: 0.790 Test Loss: 0.777 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.049913167953491
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.775 Vali Acc: 0.787 Test Loss: 0.775 Test Acc: 0.787
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.5698630809783936
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.776 Vali Acc: 0.790 Test Loss: 0.776 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.944347620010376
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.775 Vali Acc: 0.790 Test Loss: 0.775 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.051727294921875
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.784 Vali Acc: 0.780 Test Loss: 0.784 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.462826728820801
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.782 Vali Acc: 0.783 Test Loss: 0.782 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.27563214302063
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.783 Test Loss: 0.772 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.012175559997559
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.787 Test Loss: 0.774 Test Acc: 0.787
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.70543646812439
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.790 Test Loss: 0.775 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8
model parameter : 1519129
model size : 10.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.04653525352478
Epoch: 1, Steps: 18 | Train Loss: 3.211 Vali Loss: 2.973 Vali Acc: 0.210 Test Loss: 2.973 Test Acc: 0.210
Validation loss decreased (inf --> -0.209970).  Saving model ...
Epoch: 2 cost time: 6.189275503158569
Epoch: 2, Steps: 18 | Train Loss: 2.546 Vali Loss: 2.431 Vali Acc: 0.497 Test Loss: 2.431 Test Acc: 0.497
Validation loss decreased (-0.209970 --> -0.496642).  Saving model ...
Epoch: 3 cost time: 5.823899269104004
Epoch: 3, Steps: 18 | Train Loss: 1.593 Vali Loss: 1.951 Vali Acc: 0.483 Test Loss: 1.951 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.669186115264893
Epoch: 4, Steps: 18 | Train Loss: 0.731 Vali Loss: 1.554 Vali Acc: 0.603 Test Loss: 1.554 Test Acc: 0.603
Validation loss decreased (-0.496642 --> -0.603318).  Saving model ...
Epoch: 5 cost time: 5.924859523773193
Epoch: 5, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.386 Vali Acc: 0.610 Test Loss: 1.386 Test Acc: 0.610
Validation loss decreased (-0.603318 --> -0.609986).  Saving model ...
Epoch: 6 cost time: 6.477226972579956
Epoch: 6, Steps: 18 | Train Loss: 0.080 Vali Loss: 1.250 Vali Acc: 0.643 Test Loss: 1.250 Test Acc: 0.643
Validation loss decreased (-0.609986 --> -0.643321).  Saving model ...
Epoch: 7 cost time: 6.290785312652588
Epoch: 7, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.161 Vali Acc: 0.643 Test Loss: 1.161 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643322).  Saving model ...
Epoch: 8 cost time: 6.208705902099609
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.158 Vali Acc: 0.660 Test Loss: 1.158 Test Acc: 0.660
Validation loss decreased (-0.643322 --> -0.659988).  Saving model ...
Epoch: 9 cost time: 6.280745267868042
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.113 Vali Acc: 0.663 Test Loss: 1.113 Test Acc: 0.663
Validation loss decreased (-0.659988 --> -0.663322).  Saving model ...
Epoch: 10 cost time: 6.5498433113098145
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.119 Vali Acc: 0.673 Test Loss: 1.119 Test Acc: 0.673
Validation loss decreased (-0.663322 --> -0.673322).  Saving model ...
Epoch: 11 cost time: 6.9732489585876465
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.096 Vali Acc: 0.670 Test Loss: 1.096 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.774753093719482
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.084 Vali Acc: 0.667 Test Loss: 1.084 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.046599864959717
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.083 Vali Acc: 0.660 Test Loss: 1.083 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.782467842102051
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.066 Vali Acc: 0.683 Test Loss: 1.066 Test Acc: 0.683
Validation loss decreased (-0.673322 --> -0.683323).  Saving model ...
Epoch: 15 cost time: 5.888469696044922
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.061 Vali Acc: 0.670 Test Loss: 1.061 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.275848627090454
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.056 Vali Acc: 0.680 Test Loss: 1.056 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.143703937530518
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.051 Vali Acc: 0.677 Test Loss: 1.051 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.8253395557403564
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.046 Vali Acc: 0.683 Test Loss: 1.046 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683323).  Saving model ...
Epoch: 19 cost time: 5.952362775802612
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.035 Vali Acc: 0.690 Test Loss: 1.035 Test Acc: 0.690
Validation loss decreased (-0.683323 --> -0.689990).  Saving model ...
Epoch: 20 cost time: 5.990700006484985
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.693 Test Loss: 1.030 Test Acc: 0.693
Validation loss decreased (-0.689990 --> -0.693323).  Saving model ...
Epoch: 21 cost time: 6.219727516174316
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.687 Test Loss: 1.030 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.2967848777771
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.026 Vali Acc: 0.687 Test Loss: 1.026 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.770848751068115
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.690 Test Loss: 1.017 Test Acc: 0.690
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.113569021224976
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.693 Test Loss: 1.017 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 25 cost time: 5.718487501144409
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.690 Test Loss: 1.017 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.0881781578063965
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.693 Test Loss: 1.017 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 27 cost time: 6.2661590576171875
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.019 Vali Acc: 0.697 Test Loss: 1.019 Test Acc: 0.697
Validation loss decreased (-0.693323 --> -0.696656).  Saving model ...
Epoch: 28 cost time: 6.197362661361694
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.693 Test Loss: 1.011 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.919780969619751
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.700 Test Loss: 1.005 Test Acc: 0.700
Validation loss decreased (-0.696656 --> -0.699990).  Saving model ...
Epoch: 30 cost time: 5.534901857376099
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.700 Test Loss: 1.003 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 31 cost time: 5.887218952178955
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.703 Test Loss: 1.000 Test Acc: 0.703
Validation loss decreased (-0.699990 --> -0.703323).  Saving model ...
Epoch: 32 cost time: 6.713788270950317
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.700 Test Loss: 0.998 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.556227922439575
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.703 Test Loss: 0.997 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 34 cost time: 5.829910516738892
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.703 Test Loss: 0.995 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 35 cost time: 6.306341648101807
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.703 Test Loss: 0.994 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 36 cost time: 6.045844554901123
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.703 Test Loss: 0.994 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 37 cost time: 6.213847398757935
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.703 Test Loss: 0.991 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 38 cost time: 6.023257493972778
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.703 Test Loss: 0.990 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 39 cost time: 5.641412734985352
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.707 Test Loss: 0.991 Test Acc: 0.707
Validation loss decreased (-0.703323 --> -0.706657).  Saving model ...
Epoch: 40 cost time: 6.114505052566528
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.710 Test Loss: 0.985 Test Acc: 0.710
Validation loss decreased (-0.706657 --> -0.709990).  Saving model ...
Epoch: 41 cost time: 6.240160942077637
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.707 Test Loss: 0.987 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.721534013748169
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.707 Test Loss: 0.986 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 6.001533269882202
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.710 Test Loss: 0.986 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 5.85755729675293
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.984 Vali Acc: 0.707 Test Loss: 0.984 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 6.189404010772705
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.980 Vali Acc: 0.710 Test Loss: 0.980 Test Acc: 0.710
Validation loss decreased (-0.709990 --> -0.709990).  Saving model ...
Epoch: 46 cost time: 6.563897132873535
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.979 Vali Acc: 0.710 Test Loss: 0.979 Test Acc: 0.710
Validation loss decreased (-0.709990 --> -0.709990).  Saving model ...
Epoch: 47 cost time: 6.597188949584961
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.978 Vali Acc: 0.713 Test Loss: 0.978 Test Acc: 0.713
Validation loss decreased (-0.709990 --> -0.713324).  Saving model ...
Epoch: 48 cost time: 6.133965730667114
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.979 Vali Acc: 0.710 Test Loss: 0.979 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.920187473297119
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.982 Vali Acc: 0.713 Test Loss: 0.982 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 6.644235849380493
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.979 Vali Acc: 0.710 Test Loss: 0.979 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.5647642612457275
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.978 Vali Acc: 0.713 Test Loss: 0.978 Test Acc: 0.713
Validation loss decreased (-0.713324 --> -0.713324).  Saving model ...
Epoch: 52 cost time: 6.269613265991211
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.975 Vali Acc: 0.713 Test Loss: 0.975 Test Acc: 0.713
Validation loss decreased (-0.713324 --> -0.713324).  Saving model ...
Epoch: 53 cost time: 5.77489972114563
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.713 Test Loss: 0.974 Test Acc: 0.713
Validation loss decreased (-0.713324 --> -0.713324).  Saving model ...
Epoch: 54 cost time: 5.633509874343872
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.713 Test Loss: 0.972 Test Acc: 0.713
Validation loss decreased (-0.713324 --> -0.713324).  Saving model ...
Epoch: 55 cost time: 6.012202024459839
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.717 Test Loss: 0.971 Test Acc: 0.717
Validation loss decreased (-0.713324 --> -0.716657).  Saving model ...
Epoch: 56 cost time: 6.213788986206055
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.713 Test Loss: 0.972 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.098009824752808
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.710 Test Loss: 0.974 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 6.106310606002808
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.710 Test Loss: 0.973 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 6.533963918685913
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.710 Test Loss: 0.971 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 6.547169923782349
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.970 Vali Acc: 0.713 Test Loss: 0.970 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 6.712327480316162
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.970 Vali Acc: 0.713 Test Loss: 0.970 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 6.406220197677612
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.970 Vali Acc: 0.713 Test Loss: 0.970 Test Acc: 0.713
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 6.203554391860962
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.713 Test Loss: 0.969 Test Acc: 0.713
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 5.822135925292969
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.717 Test Loss: 0.969 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 65 cost time: 6.384857654571533
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.717 Test Loss: 0.969 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 66 cost time: 6.292573928833008
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.968 Vali Acc: 0.723 Test Loss: 0.968 Test Acc: 0.723
Validation loss decreased (-0.716657 --> -0.723324).  Saving model ...
Epoch: 67 cost time: 6.1988348960876465
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.727 Test Loss: 0.965 Test Acc: 0.727
Validation loss decreased (-0.723324 --> -0.726657).  Saving model ...
Epoch: 68 cost time: 5.595687389373779
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.720 Test Loss: 0.964 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.049047470092773
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.727 Test Loss: 0.963 Test Acc: 0.727
Validation loss decreased (-0.726657 --> -0.726657).  Saving model ...
Epoch: 70 cost time: 6.010942697525024
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.723 Test Loss: 0.964 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 6.056787967681885
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.720 Test Loss: 0.965 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 6.443879127502441
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.720 Test Loss: 0.964 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 5.924611568450928
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.720 Test Loss: 0.965 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 6.128179550170898
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.720 Test Loss: 0.965 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 6.316937208175659
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.723 Test Loss: 0.965 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 6.258736848831177
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.723 Test Loss: 0.964 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 6.191130638122559
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.723 Test Loss: 0.963 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 6.339699983596802
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.723 Test Loss: 0.964 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 5.766496658325195
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.966 Vali Acc: 0.720 Test Loss: 0.966 Test Acc: 0.720
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7266666666666667
model parameter : 1519129
model size : 10.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.392377853393555
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 3.093 Vali Acc: 0.113 Test Loss: 3.093 Test Acc: 0.113
Validation loss decreased (inf --> -0.113302).  Saving model ...
Epoch: 2 cost time: 5.782674789428711
Epoch: 2, Steps: 18 | Train Loss: 2.686 Vali Loss: 2.750 Vali Acc: 0.283 Test Loss: 2.750 Test Acc: 0.283
Validation loss decreased (-0.113302 --> -0.283306).  Saving model ...
Epoch: 3 cost time: 5.30220103263855
Epoch: 3, Steps: 18 | Train Loss: 1.863 Vali Loss: 2.424 Vali Acc: 0.323 Test Loss: 2.424 Test Acc: 0.323
Validation loss decreased (-0.283306 --> -0.323309).  Saving model ...
Epoch: 4 cost time: 5.658178091049194
Epoch: 4, Steps: 18 | Train Loss: 0.987 Vali Loss: 2.137 Vali Acc: 0.383 Test Loss: 2.137 Test Acc: 0.383
Validation loss decreased (-0.323309 --> -0.383312).  Saving model ...
Epoch: 5 cost time: 5.631969928741455
Epoch: 5, Steps: 18 | Train Loss: 0.395 Vali Loss: 1.959 Vali Acc: 0.413 Test Loss: 1.959 Test Acc: 0.413
Validation loss decreased (-0.383312 --> -0.413314).  Saving model ...
Epoch: 6 cost time: 6.257547616958618
Epoch: 6, Steps: 18 | Train Loss: 0.150 Vali Loss: 1.805 Vali Acc: 0.473 Test Loss: 1.805 Test Acc: 0.473
Validation loss decreased (-0.413314 --> -0.473315).  Saving model ...
Epoch: 7 cost time: 6.851925611495972
Epoch: 7, Steps: 18 | Train Loss: 0.050 Vali Loss: 1.711 Vali Acc: 0.460 Test Loss: 1.711 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.2637269496917725
Epoch: 8, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.640 Vali Acc: 0.493 Test Loss: 1.640 Test Acc: 0.493
Validation loss decreased (-0.473315 --> -0.493317).  Saving model ...
Epoch: 9 cost time: 6.324202299118042
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.534 Vali Acc: 0.550 Test Loss: 1.534 Test Acc: 0.550
Validation loss decreased (-0.493317 --> -0.549985).  Saving model ...
Epoch: 10 cost time: 5.857100248336792
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.546 Vali Acc: 0.543 Test Loss: 1.546 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.290861129760742
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.504 Vali Acc: 0.567 Test Loss: 1.504 Test Acc: 0.567
Validation loss decreased (-0.549985 --> -0.566652).  Saving model ...
Epoch: 12 cost time: 6.458877801895142
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.479 Vali Acc: 0.577 Test Loss: 1.479 Test Acc: 0.577
Validation loss decreased (-0.566652 --> -0.576652).  Saving model ...
Epoch: 13 cost time: 5.896430492401123
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.475 Vali Acc: 0.560 Test Loss: 1.475 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.58565616607666
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.443 Vali Acc: 0.577 Test Loss: 1.443 Test Acc: 0.577
Validation loss decreased (-0.576652 --> -0.576652).  Saving model ...
Epoch: 15 cost time: 5.576380014419556
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.415 Vali Acc: 0.590 Test Loss: 1.415 Test Acc: 0.590
Validation loss decreased (-0.576652 --> -0.589986).  Saving model ...
Epoch: 16 cost time: 5.978994607925415
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.403 Vali Acc: 0.597 Test Loss: 1.403 Test Acc: 0.597
Validation loss decreased (-0.589986 --> -0.596653).  Saving model ...
Epoch: 17 cost time: 5.934743165969849
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.399 Vali Acc: 0.603 Test Loss: 1.399 Test Acc: 0.603
Validation loss decreased (-0.596653 --> -0.603319).  Saving model ...
Epoch: 18 cost time: 6.188464403152466
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.392 Vali Acc: 0.603 Test Loss: 1.392 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 19 cost time: 5.52627968788147
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.378 Vali Acc: 0.613 Test Loss: 1.378 Test Acc: 0.613
Validation loss decreased (-0.603319 --> -0.613320).  Saving model ...
Epoch: 20 cost time: 5.435130834579468
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.369 Vali Acc: 0.607 Test Loss: 1.369 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.7990453243255615
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.358 Vali Acc: 0.617 Test Loss: 1.358 Test Acc: 0.617
Validation loss decreased (-0.613320 --> -0.616653).  Saving model ...
Epoch: 22 cost time: 6.177249431610107
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.350 Vali Acc: 0.623 Test Loss: 1.350 Test Acc: 0.623
Validation loss decreased (-0.616653 --> -0.623320).  Saving model ...
Epoch: 23 cost time: 6.13859486579895
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.340 Vali Acc: 0.620 Test Loss: 1.340 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.723059177398682
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.331 Vali Acc: 0.627 Test Loss: 1.331 Test Acc: 0.627
Validation loss decreased (-0.623320 --> -0.626653).  Saving model ...
Epoch: 25 cost time: 5.857919931411743
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.331 Vali Acc: 0.623 Test Loss: 1.331 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.875237941741943
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.633 Test Loss: 1.323 Test Acc: 0.633
Validation loss decreased (-0.626653 --> -0.633320).  Saving model ...
Epoch: 27 cost time: 6.003561735153198
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.318 Vali Acc: 0.627 Test Loss: 1.318 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.137202978134155
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.313 Vali Acc: 0.630 Test Loss: 1.313 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.904987096786499
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.307 Vali Acc: 0.623 Test Loss: 1.307 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.5247321128845215
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.301 Vali Acc: 0.627 Test Loss: 1.301 Test Acc: 0.627
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.327075004577637
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.298 Vali Acc: 0.633 Test Loss: 1.298 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 32 cost time: 5.328080177307129
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.294 Vali Acc: 0.637 Test Loss: 1.294 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.636654).  Saving model ...
Epoch: 33 cost time: 6.023360967636108
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.291 Vali Acc: 0.643 Test Loss: 1.291 Test Acc: 0.643
Validation loss decreased (-0.636654 --> -0.643320).  Saving model ...
Epoch: 34 cost time: 5.739165544509888
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.287 Vali Acc: 0.643 Test Loss: 1.287 Test Acc: 0.643
Validation loss decreased (-0.643320 --> -0.643320).  Saving model ...
Epoch: 35 cost time: 5.696962833404541
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.647 Test Loss: 1.281 Test Acc: 0.647
Validation loss decreased (-0.643320 --> -0.646654).  Saving model ...
Epoch: 36 cost time: 5.578030824661255
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.280 Vali Acc: 0.647 Test Loss: 1.280 Test Acc: 0.647
Validation loss decreased (-0.646654 --> -0.646654).  Saving model ...
Epoch: 37 cost time: 5.8327248096466064
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.640 Test Loss: 1.276 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.848024606704712
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.640 Test Loss: 1.276 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 6.206227540969849
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.647 Test Loss: 1.274 Test Acc: 0.647
Validation loss decreased (-0.646654 --> -0.646654).  Saving model ...
Epoch: 40 cost time: 6.245618581771851
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.271 Vali Acc: 0.643 Test Loss: 1.271 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.814380407333374
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.647 Test Loss: 1.267 Test Acc: 0.647
Validation loss decreased (-0.646654 --> -0.646654).  Saving model ...
Epoch: 42 cost time: 5.5991737842559814
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.647 Test Loss: 1.264 Test Acc: 0.647
Validation loss decreased (-0.646654 --> -0.646654).  Saving model ...
Epoch: 43 cost time: 5.565229415893555
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.650 Test Loss: 1.263 Test Acc: 0.650
Validation loss decreased (-0.646654 --> -0.649987).  Saving model ...
Epoch: 44 cost time: 6.1922767162323
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.650 Test Loss: 1.262 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 45 cost time: 5.701853513717651
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.650 Test Loss: 1.259 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 46 cost time: 5.82577109336853
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.650 Test Loss: 1.257 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 47 cost time: 5.647185325622559
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.657 Test Loss: 1.254 Test Acc: 0.657
Validation loss decreased (-0.649987 --> -0.656654).  Saving model ...
Epoch: 48 cost time: 5.39078164100647
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.650 Test Loss: 1.252 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.8646156787872314
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.653 Test Loss: 1.253 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 5.609408855438232
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.657 Test Loss: 1.250 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656654).  Saving model ...
Epoch: 51 cost time: 5.832947731018066
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.663 Test Loss: 1.250 Test Acc: 0.663
Validation loss decreased (-0.656654 --> -0.663321).  Saving model ...
Epoch: 52 cost time: 5.888806581497192
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.667 Test Loss: 1.247 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666654).  Saving model ...
Epoch: 53 cost time: 6.175658702850342
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.244 Vali Acc: 0.663 Test Loss: 1.244 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.480242729187012
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.660 Test Loss: 1.241 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 5.991008043289185
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.663 Test Loss: 1.238 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 5.515430688858032
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.663 Test Loss: 1.238 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 5.734185457229614
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.237 Vali Acc: 0.667 Test Loss: 1.237 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 58 cost time: 5.8982460498809814
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.670 Test Loss: 1.234 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669988).  Saving model ...
Epoch: 59 cost time: 6.498262405395508
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.677 Test Loss: 1.233 Test Acc: 0.677
Validation loss decreased (-0.669988 --> -0.676654).  Saving model ...
Epoch: 60 cost time: 5.876850128173828
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.677 Test Loss: 1.232 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 61 cost time: 5.818345308303833
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.677 Test Loss: 1.231 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 62 cost time: 5.934486389160156
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.677 Test Loss: 1.228 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 63 cost time: 6.369435787200928
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.677 Test Loss: 1.227 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 64 cost time: 6.69170069694519
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.677 Test Loss: 1.227 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 6.6835081577301025
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.673 Test Loss: 1.224 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 6.307261228561401
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.677 Test Loss: 1.222 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 67 cost time: 6.0510265827178955
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.680 Test Loss: 1.222 Test Acc: 0.680
Validation loss decreased (-0.676654 --> -0.679988).  Saving model ...
Epoch: 68 cost time: 6.522191047668457
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.673 Test Loss: 1.219 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.341115713119507
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.677 Test Loss: 1.218 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 6.417917251586914
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.677 Test Loss: 1.216 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 6.208921432495117
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.673 Test Loss: 1.217 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 5.976359605789185
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.680 Test Loss: 1.218 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 73 cost time: 5.5684919357299805
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.687 Test Loss: 1.217 Test Acc: 0.687
Validation loss decreased (-0.679988 --> -0.686654).  Saving model ...
Epoch: 74 cost time: 5.934676885604858
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.687 Test Loss: 1.215 Test Acc: 0.687
Validation loss decreased (-0.686654 --> -0.686655).  Saving model ...
Epoch: 75 cost time: 6.263999938964844
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.683 Test Loss: 1.217 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 6.9140403270721436
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.683 Test Loss: 1.218 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 6.032593250274658
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.693 Test Loss: 1.217 Test Acc: 0.693
Validation loss decreased (-0.686655 --> -0.693321).  Saving model ...
Epoch: 78 cost time: 6.1790771484375
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.690 Test Loss: 1.216 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 6.026196479797363
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.693 Test Loss: 1.216 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 80 cost time: 6.4590840339660645
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.693 Test Loss: 1.213 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 81 cost time: 6.34065842628479
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.693 Test Loss: 1.212 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 82 cost time: 5.9348838329315186
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.693 Test Loss: 1.210 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 83 cost time: 5.651430606842041
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.693 Test Loss: 1.211 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 5.716029167175293
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.693 Test Loss: 1.210 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 85 cost time: 6.061879873275757
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.690 Test Loss: 1.209 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 6.11799955368042
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.690 Test Loss: 1.207 Test Acc: 0.690
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 5.751646995544434
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.690 Test Loss: 1.207 Test Acc: 0.690
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 5.5457823276519775
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.690 Test Loss: 1.206 Test Acc: 0.690
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 6.033135652542114
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.690 Test Loss: 1.205 Test Acc: 0.690
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 6.881592273712158
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.690 Test Loss: 1.205 Test Acc: 0.690
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 7.96517276763916
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.690 Test Loss: 1.205 Test Acc: 0.690
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 6.773773670196533
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.690 Test Loss: 1.205 Test Acc: 0.690
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 6.740190744400024
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.690 Test Loss: 1.205 Test Acc: 0.690
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 6.794444561004639
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.693 Test Loss: 1.206 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 95 cost time: 6.447753190994263
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.693 Test Loss: 1.204 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 96 cost time: 6.657515525817871
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.700 Test Loss: 1.201 Test Acc: 0.700
Validation loss decreased (-0.693321 --> -0.699988).  Saving model ...
Epoch: 97 cost time: 6.99786901473999
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.200 Vali Acc: 0.700 Test Loss: 1.200 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 98 cost time: 6.316977262496948
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.700 Test Loss: 1.202 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 6.114867210388184
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.693 Test Loss: 1.202 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 5.970926761627197
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.700 Test Loss: 1.202 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7
model parameter : 1519129
model size : 10.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.553571939468384
Epoch: 1, Steps: 18 | Train Loss: 3.233 Vali Loss: 3.154 Vali Acc: 0.080 Test Loss: 3.154 Test Acc: 0.080
Validation loss decreased (inf --> -0.079968).  Saving model ...
Epoch: 2 cost time: 5.9666125774383545
Epoch: 2, Steps: 18 | Train Loss: 2.717 Vali Loss: 2.909 Vali Acc: 0.167 Test Loss: 2.909 Test Acc: 0.167
Validation loss decreased (-0.079968 --> -0.166638).  Saving model ...
Epoch: 3 cost time: 6.32227087020874
Epoch: 3, Steps: 18 | Train Loss: 1.931 Vali Loss: 2.661 Vali Acc: 0.263 Test Loss: 2.661 Test Acc: 0.263
Validation loss decreased (-0.166638 --> -0.263307).  Saving model ...
Epoch: 4 cost time: 6.55507230758667
Epoch: 4, Steps: 18 | Train Loss: 1.060 Vali Loss: 2.437 Vali Acc: 0.303 Test Loss: 2.437 Test Acc: 0.303
Validation loss decreased (-0.263307 --> -0.303309).  Saving model ...
Epoch: 5 cost time: 6.340899705886841
Epoch: 5, Steps: 18 | Train Loss: 0.448 Vali Loss: 2.291 Vali Acc: 0.333 Test Loss: 2.291 Test Acc: 0.333
Validation loss decreased (-0.303309 --> -0.333310).  Saving model ...
Epoch: 6 cost time: 7.173475742340088
Epoch: 6, Steps: 18 | Train Loss: 0.166 Vali Loss: 2.160 Vali Acc: 0.337 Test Loss: 2.160 Test Acc: 0.337
Validation loss decreased (-0.333310 --> -0.336645).  Saving model ...
Epoch: 7 cost time: 6.828711986541748
Epoch: 7, Steps: 18 | Train Loss: 0.052 Vali Loss: 2.092 Vali Acc: 0.367 Test Loss: 2.092 Test Acc: 0.367
Validation loss decreased (-0.336645 --> -0.366646).  Saving model ...
Epoch: 8 cost time: 6.789956092834473
Epoch: 8, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.011 Vali Acc: 0.403 Test Loss: 2.011 Test Acc: 0.403
Validation loss decreased (-0.366646 --> -0.403313).  Saving model ...
Epoch: 9 cost time: 6.7385406494140625
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.920 Vali Acc: 0.413 Test Loss: 1.920 Test Acc: 0.413
Validation loss decreased (-0.403313 --> -0.413314).  Saving model ...
Epoch: 10 cost time: 6.5561158657073975
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.864 Vali Acc: 0.430 Test Loss: 1.864 Test Acc: 0.430
Validation loss decreased (-0.413314 --> -0.429981).  Saving model ...
Epoch: 11 cost time: 6.382036447525024
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.830 Vali Acc: 0.460 Test Loss: 1.830 Test Acc: 0.460
Validation loss decreased (-0.429981 --> -0.459982).  Saving model ...
Epoch: 12 cost time: 6.684912919998169
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.800 Vali Acc: 0.460 Test Loss: 1.800 Test Acc: 0.460
Validation loss decreased (-0.459982 --> -0.459982).  Saving model ...
Epoch: 13 cost time: 6.3270955085754395
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.784 Vali Acc: 0.463 Test Loss: 1.784 Test Acc: 0.463
Validation loss decreased (-0.459982 --> -0.463315).  Saving model ...
Epoch: 14 cost time: 6.451669931411743
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.742 Vali Acc: 0.490 Test Loss: 1.742 Test Acc: 0.490
Validation loss decreased (-0.463315 --> -0.489983).  Saving model ...
Epoch: 15 cost time: 6.25553035736084
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.712 Vali Acc: 0.487 Test Loss: 1.712 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.526020288467407
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.685 Vali Acc: 0.493 Test Loss: 1.685 Test Acc: 0.493
Validation loss decreased (-0.489983 --> -0.493316).  Saving model ...
Epoch: 17 cost time: 6.20012354850769
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.669 Vali Acc: 0.493 Test Loss: 1.669 Test Acc: 0.493
Validation loss decreased (-0.493316 --> -0.493317).  Saving model ...
Epoch: 18 cost time: 6.389514207839966
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.656 Vali Acc: 0.497 Test Loss: 1.656 Test Acc: 0.497
Validation loss decreased (-0.493317 --> -0.496650).  Saving model ...
Epoch: 19 cost time: 6.546006441116333
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.642 Vali Acc: 0.517 Test Loss: 1.642 Test Acc: 0.517
Validation loss decreased (-0.496650 --> -0.516650).  Saving model ...
Epoch: 20 cost time: 6.289616584777832
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.627 Vali Acc: 0.523 Test Loss: 1.627 Test Acc: 0.523
Validation loss decreased (-0.516650 --> -0.523317).  Saving model ...
Epoch: 21 cost time: 6.621576309204102
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.603 Vali Acc: 0.513 Test Loss: 1.603 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.4081573486328125
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.596 Vali Acc: 0.510 Test Loss: 1.596 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.274994373321533
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.580 Vali Acc: 0.520 Test Loss: 1.580 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.4830968379974365
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.573 Vali Acc: 0.537 Test Loss: 1.573 Test Acc: 0.537
Validation loss decreased (-0.523317 --> -0.536651).  Saving model ...
Epoch: 25 cost time: 6.804896593093872
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.567 Vali Acc: 0.530 Test Loss: 1.567 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.0541672706604
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.554 Vali Acc: 0.527 Test Loss: 1.554 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.78380012512207
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.530 Test Loss: 1.544 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.454569339752197
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.535 Vali Acc: 0.550 Test Loss: 1.535 Test Acc: 0.550
Validation loss decreased (-0.536651 --> -0.549985).  Saving model ...
Epoch: 29 cost time: 6.758368730545044
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.547 Test Loss: 1.526 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.795361280441284
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.517 Vali Acc: 0.553 Test Loss: 1.517 Test Acc: 0.553
Validation loss decreased (-0.549985 --> -0.553318).  Saving model ...
Epoch: 31 cost time: 6.542902708053589
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.507 Vali Acc: 0.553 Test Loss: 1.507 Test Acc: 0.553
Validation loss decreased (-0.553318 --> -0.553318).  Saving model ...
Epoch: 32 cost time: 6.434937238693237
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.507 Vali Acc: 0.557 Test Loss: 1.507 Test Acc: 0.557
Validation loss decreased (-0.553318 --> -0.556652).  Saving model ...
Epoch: 33 cost time: 6.597968816757202
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.500 Vali Acc: 0.550 Test Loss: 1.500 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.806874513626099
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.557 Test Loss: 1.486 Test Acc: 0.557
Validation loss decreased (-0.556652 --> -0.556652).  Saving model ...
Epoch: 35 cost time: 6.387419700622559
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.563 Test Loss: 1.481 Test Acc: 0.563
Validation loss decreased (-0.556652 --> -0.563319).  Saving model ...
Epoch: 36 cost time: 6.407952308654785
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.573 Test Loss: 1.477 Test Acc: 0.573
Validation loss decreased (-0.563319 --> -0.573319).  Saving model ...
Epoch: 37 cost time: 5.973518371582031
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.573 Test Loss: 1.469 Test Acc: 0.573
Validation loss decreased (-0.573319 --> -0.573319).  Saving model ...
Epoch: 38 cost time: 6.341298580169678
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.583 Test Loss: 1.464 Test Acc: 0.583
Validation loss decreased (-0.573319 --> -0.583319).  Saving model ...
Epoch: 39 cost time: 6.613194227218628
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.458 Vali Acc: 0.593 Test Loss: 1.458 Test Acc: 0.593
Validation loss decreased (-0.583319 --> -0.593319).  Saving model ...
Epoch: 40 cost time: 6.269028663635254
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.583 Test Loss: 1.454 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.154032230377197
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.587 Test Loss: 1.453 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.102427244186401
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.583 Test Loss: 1.450 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.259310483932495
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.587 Test Loss: 1.448 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.353265047073364
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.587 Test Loss: 1.440 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 6.408703565597534
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.600 Test Loss: 1.433 Test Acc: 0.600
Validation loss decreased (-0.593319 --> -0.599986).  Saving model ...
Epoch: 46 cost time: 6.534408092498779
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.600 Test Loss: 1.428 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 47 cost time: 6.314734220504761
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.603 Test Loss: 1.425 Test Acc: 0.603
Validation loss decreased (-0.599986 --> -0.603319).  Saving model ...
Epoch: 48 cost time: 6.7322375774383545
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.607 Test Loss: 1.422 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606652).  Saving model ...
Epoch: 49 cost time: 6.484405517578125
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.607 Test Loss: 1.427 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.580333471298218
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.607 Test Loss: 1.422 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 51 cost time: 6.894282102584839
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.607 Test Loss: 1.418 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 52 cost time: 6.942469596862793
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.603 Test Loss: 1.412 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 6.998055458068848
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.600 Test Loss: 1.406 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 6.978301286697388
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.610 Test Loss: 1.403 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 55 cost time: 7.238438367843628
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.613 Test Loss: 1.396 Test Acc: 0.613
Validation loss decreased (-0.609986 --> -0.613319).  Saving model ...
Epoch: 56 cost time: 6.910064458847046
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.620 Test Loss: 1.393 Test Acc: 0.620
Validation loss decreased (-0.613319 --> -0.619986).  Saving model ...
Epoch: 57 cost time: 7.054987192153931
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.623 Test Loss: 1.393 Test Acc: 0.623
Validation loss decreased (-0.619986 --> -0.623319).  Saving model ...
Epoch: 58 cost time: 6.274877548217773
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.623 Test Loss: 1.388 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 59 cost time: 6.555256366729736
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.620 Test Loss: 1.386 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 6.720475196838379
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.627 Test Loss: 1.383 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626653).  Saving model ...
Epoch: 61 cost time: 6.722405672073364
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.630 Test Loss: 1.381 Test Acc: 0.630
Validation loss decreased (-0.626653 --> -0.629986).  Saving model ...
Epoch: 62 cost time: 7.11559796333313
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.378 Vali Acc: 0.630 Test Loss: 1.378 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 63 cost time: 7.09089469909668
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.630 Test Loss: 1.377 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 64 cost time: 6.232420921325684
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.379 Vali Acc: 0.623 Test Loss: 1.379 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 6.716792583465576
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.627 Test Loss: 1.372 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 6.383957624435425
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.633 Test Loss: 1.367 Test Acc: 0.633
Validation loss decreased (-0.629986 --> -0.633320).  Saving model ...
Epoch: 67 cost time: 6.404918670654297
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.630 Test Loss: 1.366 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 6.459808826446533
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.362 Vali Acc: 0.633 Test Loss: 1.362 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 69 cost time: 6.110149145126343
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.637 Test Loss: 1.358 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.636653).  Saving model ...
Epoch: 70 cost time: 6.626383304595947
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.637 Test Loss: 1.357 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 71 cost time: 6.260458946228027
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.637 Test Loss: 1.358 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 6.011670827865601
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.643 Test Loss: 1.355 Test Acc: 0.643
Validation loss decreased (-0.636653 --> -0.643320).  Saving model ...
Epoch: 73 cost time: 6.4365293979644775
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.647 Test Loss: 1.354 Test Acc: 0.647
Validation loss decreased (-0.643320 --> -0.646653).  Saving model ...
Epoch: 74 cost time: 6.094099044799805
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.643 Test Loss: 1.353 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 6.660194635391235
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.647 Test Loss: 1.353 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 76 cost time: 6.512065172195435
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.647 Test Loss: 1.353 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 6.109254837036133
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.647 Test Loss: 1.353 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 78 cost time: 6.9344401359558105
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.653 Test Loss: 1.350 Test Acc: 0.653
Validation loss decreased (-0.646653 --> -0.653320).  Saving model ...
Epoch: 79 cost time: 6.769920587539673
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.653 Test Loss: 1.346 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 80 cost time: 6.558478832244873
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.650 Test Loss: 1.342 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 6.420088529586792
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.653 Test Loss: 1.340 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 82 cost time: 6.171746492385864
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.657 Test Loss: 1.339 Test Acc: 0.657
Validation loss decreased (-0.653320 --> -0.656653).  Saving model ...
Epoch: 83 cost time: 6.641916036605835
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.663 Test Loss: 1.342 Test Acc: 0.663
Validation loss decreased (-0.656653 --> -0.663320).  Saving model ...
Epoch: 84 cost time: 6.932995080947876
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.663 Test Loss: 1.340 Test Acc: 0.663
Validation loss decreased (-0.663320 --> -0.663320).  Saving model ...
Epoch: 85 cost time: 6.065210819244385
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.660 Test Loss: 1.340 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 6.183520555496216
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.660 Test Loss: 1.338 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 6.221848487854004
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.663 Test Loss: 1.337 Test Acc: 0.663
Validation loss decreased (-0.663320 --> -0.663320).  Saving model ...
Epoch: 88 cost time: 6.870096921920776
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.667 Test Loss: 1.337 Test Acc: 0.667
Validation loss decreased (-0.663320 --> -0.666653).  Saving model ...
Epoch: 89 cost time: 6.862228870391846
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.663 Test Loss: 1.335 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 6.746003150939941
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.660 Test Loss: 1.333 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 6.644588232040405
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.660 Test Loss: 1.327 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 7.046395778656006
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.670 Test Loss: 1.326 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.669987).  Saving model ...
Epoch: 93 cost time: 6.496065616607666
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.670 Test Loss: 1.327 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 6.958386421203613
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.667 Test Loss: 1.324 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 6.608008623123169
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.670 Test Loss: 1.323 Test Acc: 0.670
Validation loss decreased (-0.669987 --> -0.669987).  Saving model ...
Epoch: 96 cost time: 6.903859853744507
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.673 Test Loss: 1.323 Test Acc: 0.673
Validation loss decreased (-0.669987 --> -0.673320).  Saving model ...
Epoch: 97 cost time: 6.622173309326172
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.670 Test Loss: 1.324 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 6.6989452838897705
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.670 Test Loss: 1.322 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 6.497365236282349
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.673 Test Loss: 1.322 Test Acc: 0.673
Validation loss decreased (-0.673320 --> -0.673320).  Saving model ...
Epoch: 100 cost time: 6.166712284088135
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.670 Test Loss: 1.322 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6733333333333333
model parameter : 1519129
model size : 10.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.192584037780762
Epoch: 1, Steps: 18 | Train Loss: 3.249 Vali Loss: 3.230 Vali Acc: 0.067 Test Loss: 3.230 Test Acc: 0.067
Validation loss decreased (inf --> -0.066634).  Saving model ...
Epoch: 2 cost time: 6.340860843658447
Epoch: 2, Steps: 18 | Train Loss: 2.763 Vali Loss: 3.079 Vali Acc: 0.087 Test Loss: 3.079 Test Acc: 0.087
Validation loss decreased (-0.066634 --> -0.086636).  Saving model ...
Epoch: 3 cost time: 6.3251307010650635
Epoch: 3, Steps: 18 | Train Loss: 1.989 Vali Loss: 2.914 Vali Acc: 0.133 Test Loss: 2.914 Test Acc: 0.133
Validation loss decreased (-0.086636 --> -0.133304).  Saving model ...
Epoch: 4 cost time: 6.176847457885742
Epoch: 4, Steps: 18 | Train Loss: 1.168 Vali Loss: 2.771 Vali Acc: 0.170 Test Loss: 2.771 Test Acc: 0.170
Validation loss decreased (-0.133304 --> -0.169972).  Saving model ...
Epoch: 5 cost time: 6.433672189712524
Epoch: 5, Steps: 18 | Train Loss: 0.529 Vali Loss: 2.642 Vali Acc: 0.190 Test Loss: 2.642 Test Acc: 0.190
Validation loss decreased (-0.169972 --> -0.189974).  Saving model ...
Epoch: 6 cost time: 6.5029237270355225
Epoch: 6, Steps: 18 | Train Loss: 0.202 Vali Loss: 2.613 Vali Acc: 0.207 Test Loss: 2.613 Test Acc: 0.207
Validation loss decreased (-0.189974 --> -0.206641).  Saving model ...
Epoch: 7 cost time: 7.054694890975952
Epoch: 7, Steps: 18 | Train Loss: 0.066 Vali Loss: 2.407 Vali Acc: 0.253 Test Loss: 2.407 Test Acc: 0.253
Validation loss decreased (-0.206641 --> -0.253309).  Saving model ...
Epoch: 8 cost time: 6.6806652545928955
Epoch: 8, Steps: 18 | Train Loss: 0.028 Vali Loss: 2.339 Vali Acc: 0.293 Test Loss: 2.339 Test Acc: 0.293
Validation loss decreased (-0.253309 --> -0.293310).  Saving model ...
Epoch: 9 cost time: 6.856342554092407
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 2.204 Vali Acc: 0.350 Test Loss: 2.204 Test Acc: 0.350
Validation loss decreased (-0.293310 --> -0.349978).  Saving model ...
Epoch: 10 cost time: 6.663059949874878
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.135 Vali Acc: 0.357 Test Loss: 2.135 Test Acc: 0.357
Validation loss decreased (-0.349978 --> -0.356645).  Saving model ...
Epoch: 11 cost time: 6.469662189483643
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.076 Vali Acc: 0.373 Test Loss: 2.076 Test Acc: 0.373
Validation loss decreased (-0.356645 --> -0.373313).  Saving model ...
Epoch: 12 cost time: 6.4988789558410645
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.049 Vali Acc: 0.383 Test Loss: 2.049 Test Acc: 0.383
Validation loss decreased (-0.373313 --> -0.383313).  Saving model ...
Epoch: 13 cost time: 6.463573932647705
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.991 Vali Acc: 0.420 Test Loss: 1.991 Test Acc: 0.420
Validation loss decreased (-0.383313 --> -0.419980).  Saving model ...
Epoch: 14 cost time: 6.308608531951904
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.950 Vali Acc: 0.420 Test Loss: 1.950 Test Acc: 0.420
Validation loss decreased (-0.419980 --> -0.419980).  Saving model ...
Epoch: 15 cost time: 6.523942708969116
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.898 Vali Acc: 0.450 Test Loss: 1.898 Test Acc: 0.450
Validation loss decreased (-0.419980 --> -0.449981).  Saving model ...
Epoch: 16 cost time: 6.266489267349243
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.864 Vali Acc: 0.457 Test Loss: 1.864 Test Acc: 0.457
Validation loss decreased (-0.449981 --> -0.456648).  Saving model ...
Epoch: 17 cost time: 6.4668660163879395
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.836 Vali Acc: 0.450 Test Loss: 1.836 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.0474021434783936
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.815 Vali Acc: 0.467 Test Loss: 1.815 Test Acc: 0.467
Validation loss decreased (-0.456648 --> -0.466649).  Saving model ...
Epoch: 19 cost time: 6.4106457233428955
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.808 Vali Acc: 0.480 Test Loss: 1.808 Test Acc: 0.480
Validation loss decreased (-0.466649 --> -0.479982).  Saving model ...
Epoch: 20 cost time: 6.1685240268707275
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.779 Vali Acc: 0.480 Test Loss: 1.779 Test Acc: 0.480
Validation loss decreased (-0.479982 --> -0.479982).  Saving model ...
Epoch: 21 cost time: 6.487224817276001
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.751 Vali Acc: 0.497 Test Loss: 1.751 Test Acc: 0.497
Validation loss decreased (-0.479982 --> -0.496649).  Saving model ...
Epoch: 22 cost time: 6.899553298950195
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.734 Vali Acc: 0.517 Test Loss: 1.734 Test Acc: 0.517
Validation loss decreased (-0.496649 --> -0.516649).  Saving model ...
Epoch: 23 cost time: 6.726458787918091
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.520 Test Loss: 1.719 Test Acc: 0.520
Validation loss decreased (-0.516649 --> -0.519983).  Saving model ...
Epoch: 24 cost time: 6.567674875259399
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.711 Vali Acc: 0.527 Test Loss: 1.711 Test Acc: 0.527
Validation loss decreased (-0.519983 --> -0.526650).  Saving model ...
Epoch: 25 cost time: 6.33111572265625
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.695 Vali Acc: 0.527 Test Loss: 1.695 Test Acc: 0.527
Validation loss decreased (-0.526650 --> -0.526650).  Saving model ...
Epoch: 26 cost time: 6.83170223236084
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.677 Vali Acc: 0.537 Test Loss: 1.677 Test Acc: 0.537
Validation loss decreased (-0.526650 --> -0.536650).  Saving model ...
Epoch: 27 cost time: 6.939059734344482
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.661 Vali Acc: 0.543 Test Loss: 1.661 Test Acc: 0.543
Validation loss decreased (-0.536650 --> -0.543317).  Saving model ...
Epoch: 28 cost time: 6.594667196273804
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.655 Vali Acc: 0.547 Test Loss: 1.655 Test Acc: 0.547
Validation loss decreased (-0.543317 --> -0.546650).  Saving model ...
Epoch: 29 cost time: 6.447850704193115
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.642 Vali Acc: 0.547 Test Loss: 1.642 Test Acc: 0.547
Validation loss decreased (-0.546650 --> -0.546650).  Saving model ...
Epoch: 30 cost time: 6.958050489425659
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.560 Test Loss: 1.630 Test Acc: 0.560
Validation loss decreased (-0.546650 --> -0.559984).  Saving model ...
Epoch: 31 cost time: 7.014962434768677
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.553 Test Loss: 1.619 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.664621353149414
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.611 Vali Acc: 0.570 Test Loss: 1.611 Test Acc: 0.570
Validation loss decreased (-0.559984 --> -0.569984).  Saving model ...
Epoch: 33 cost time: 6.254811763763428
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.599 Vali Acc: 0.570 Test Loss: 1.599 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 34 cost time: 6.3158018589019775
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.592 Vali Acc: 0.577 Test Loss: 1.592 Test Acc: 0.577
Validation loss decreased (-0.569984 --> -0.576651).  Saving model ...
Epoch: 35 cost time: 6.2311766147613525
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.583 Test Loss: 1.591 Test Acc: 0.583
Validation loss decreased (-0.576651 --> -0.583317).  Saving model ...
Epoch: 36 cost time: 6.322883129119873
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.583 Test Loss: 1.585 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 37 cost time: 6.826888799667358
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.577 Test Loss: 1.580 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.603052616119385
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.583 Test Loss: 1.575 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583318).  Saving model ...
Epoch: 39 cost time: 6.625924110412598
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.587 Test Loss: 1.567 Test Acc: 0.587
Validation loss decreased (-0.583318 --> -0.586651).  Saving model ...
Epoch: 40 cost time: 6.697916269302368
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.587 Test Loss: 1.561 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 41 cost time: 6.086023569107056
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.555 Vali Acc: 0.593 Test Loss: 1.555 Test Acc: 0.593
Validation loss decreased (-0.586651 --> -0.593318).  Saving model ...
Epoch: 42 cost time: 6.197952508926392
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.590 Test Loss: 1.550 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.768980026245117
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.543 Vali Acc: 0.590 Test Loss: 1.543 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 6.9781975746154785
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.537 Vali Acc: 0.597 Test Loss: 1.537 Test Acc: 0.597
Validation loss decreased (-0.593318 --> -0.596651).  Saving model ...
Epoch: 45 cost time: 6.677563190460205
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.600 Test Loss: 1.531 Test Acc: 0.600
Validation loss decreased (-0.596651 --> -0.599985).  Saving model ...
Epoch: 46 cost time: 6.72769570350647
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.603 Test Loss: 1.522 Test Acc: 0.603
Validation loss decreased (-0.599985 --> -0.603318).  Saving model ...
Epoch: 47 cost time: 7.246760368347168
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.607 Test Loss: 1.520 Test Acc: 0.607
Validation loss decreased (-0.603318 --> -0.606651).  Saving model ...
Epoch: 48 cost time: 6.7796995639801025
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.514 Vali Acc: 0.600 Test Loss: 1.514 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 7.040424346923828
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.600 Test Loss: 1.512 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 6.5403151512146
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.607 Test Loss: 1.507 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606652).  Saving model ...
Epoch: 51 cost time: 6.649211883544922
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.610 Test Loss: 1.505 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609985).  Saving model ...
Epoch: 52 cost time: 6.557264566421509
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.613 Test Loss: 1.503 Test Acc: 0.613
Validation loss decreased (-0.609985 --> -0.613318).  Saving model ...
Epoch: 53 cost time: 6.513890027999878
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.613 Test Loss: 1.500 Test Acc: 0.613
Validation loss decreased (-0.613318 --> -0.613318).  Saving model ...
Epoch: 54 cost time: 6.208637475967407
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.613 Test Loss: 1.499 Test Acc: 0.613
Validation loss decreased (-0.613318 --> -0.613318).  Saving model ...
Epoch: 55 cost time: 6.236492872238159
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.495 Vali Acc: 0.617 Test Loss: 1.495 Test Acc: 0.617
Validation loss decreased (-0.613318 --> -0.616652).  Saving model ...
Epoch: 56 cost time: 6.602907180786133
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.613 Test Loss: 1.493 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.241023778915405
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.613 Test Loss: 1.490 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 6.239488840103149
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.617 Test Loss: 1.485 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 59 cost time: 6.279972076416016
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.620 Test Loss: 1.480 Test Acc: 0.620
Validation loss decreased (-0.616652 --> -0.619985).  Saving model ...
Epoch: 60 cost time: 6.339038610458374
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.620 Test Loss: 1.481 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.430322647094727
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.623 Test Loss: 1.477 Test Acc: 0.623
Validation loss decreased (-0.619985 --> -0.623319).  Saving model ...
Epoch: 62 cost time: 6.56350564956665
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.620 Test Loss: 1.473 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 6.263447999954224
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.617 Test Loss: 1.473 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 6.867026090621948
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.620 Test Loss: 1.471 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 6.683115243911743
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.620 Test Loss: 1.466 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 6.495542049407959
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.623 Test Loss: 1.463 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 67 cost time: 6.508737564086914
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.627 Test Loss: 1.461 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626652).  Saving model ...
Epoch: 68 cost time: 6.342085599899292
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.458 Vali Acc: 0.627 Test Loss: 1.458 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 69 cost time: 6.779051065444946
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.623 Test Loss: 1.456 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 6.604974985122681
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.627 Test Loss: 1.456 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 71 cost time: 6.869892120361328
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.627 Test Loss: 1.456 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 72 cost time: 6.455397844314575
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.623 Test Loss: 1.454 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 6.283382892608643
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.623 Test Loss: 1.453 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 6.0654802322387695
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.623 Test Loss: 1.453 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 6.7249226570129395
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.623 Test Loss: 1.451 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 6.753230094909668
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.623 Test Loss: 1.449 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 6.237114906311035
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.623 Test Loss: 1.447 Test Acc: 0.623
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 6.137591123580933
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.627 Test Loss: 1.444 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 79 cost time: 6.5018932819366455
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.630 Test Loss: 1.441 Test Acc: 0.630
Validation loss decreased (-0.626652 --> -0.629986).  Saving model ...
Epoch: 80 cost time: 6.693556070327759
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.630 Test Loss: 1.440 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 81 cost time: 6.553328275680542
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.630 Test Loss: 1.438 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 82 cost time: 6.253790855407715
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.630 Test Loss: 1.435 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 83 cost time: 6.391033172607422
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.630 Test Loss: 1.438 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 6.793112754821777
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.633 Test Loss: 1.439 Test Acc: 0.633
Validation loss decreased (-0.629986 --> -0.633319).  Saving model ...
Epoch: 85 cost time: 6.637753248214722
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.633 Test Loss: 1.440 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 6.520737648010254
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.637 Test Loss: 1.439 Test Acc: 0.637
Validation loss decreased (-0.633319 --> -0.636652).  Saving model ...
Epoch: 87 cost time: 7.022689342498779
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.637 Test Loss: 1.435 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 88 cost time: 6.7409446239471436
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.637 Test Loss: 1.431 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 89 cost time: 6.271575450897217
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.637 Test Loss: 1.428 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 90 cost time: 6.640068054199219
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.640 Test Loss: 1.428 Test Acc: 0.640
Validation loss decreased (-0.636652 --> -0.639986).  Saving model ...
Epoch: 91 cost time: 6.620723247528076
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.643 Test Loss: 1.425 Test Acc: 0.643
Validation loss decreased (-0.639986 --> -0.643319).  Saving model ...
Epoch: 92 cost time: 6.19323992729187
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.640 Test Loss: 1.423 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 6.29288911819458
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.643 Test Loss: 1.425 Test Acc: 0.643
Validation loss decreased (-0.643319 --> -0.643319).  Saving model ...
Epoch: 94 cost time: 6.679870367050171
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.640 Test Loss: 1.423 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 6.624518394470215
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.640 Test Loss: 1.425 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 6.895758867263794
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.643 Test Loss: 1.423 Test Acc: 0.643
Validation loss decreased (-0.643319 --> -0.643319).  Saving model ...
Epoch: 97 cost time: 6.358370780944824
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.647 Test Loss: 1.423 Test Acc: 0.647
Validation loss decreased (-0.643319 --> -0.646652).  Saving model ...
Epoch: 98 cost time: 6.28136944770813
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.647 Test Loss: 1.422 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 99 cost time: 5.963230848312378
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.647 Test Loss: 1.422 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
Epoch: 100 cost time: 6.346749782562256
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.647 Test Loss: 1.422 Test Acc: 0.647
Validation loss decreased (-0.646652 --> -0.646652).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6466666666666666
model parameter : 1519129
model size : 10.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.660643815994263
Epoch: 1, Steps: 18 | Train Loss: 3.259 Vali Loss: 3.225 Vali Acc: 0.080 Test Loss: 3.225 Test Acc: 0.080
Validation loss decreased (inf --> -0.079968).  Saving model ...
Epoch: 2 cost time: 5.740640878677368
Epoch: 2, Steps: 18 | Train Loss: 2.824 Vali Loss: 3.074 Vali Acc: 0.087 Test Loss: 3.074 Test Acc: 0.087
Validation loss decreased (-0.079968 --> -0.086636).  Saving model ...
Epoch: 3 cost time: 5.802571058273315
Epoch: 3, Steps: 18 | Train Loss: 2.168 Vali Loss: 2.912 Vali Acc: 0.140 Test Loss: 2.912 Test Acc: 0.140
Validation loss decreased (-0.086636 --> -0.139971).  Saving model ...
Epoch: 4 cost time: 6.050809860229492
Epoch: 4, Steps: 18 | Train Loss: 1.384 Vali Loss: 2.763 Vali Acc: 0.150 Test Loss: 2.763 Test Acc: 0.150
Validation loss decreased (-0.139971 --> -0.149972).  Saving model ...
Epoch: 5 cost time: 6.0860755443573
Epoch: 5, Steps: 18 | Train Loss: 0.715 Vali Loss: 2.601 Vali Acc: 0.197 Test Loss: 2.601 Test Acc: 0.197
Validation loss decreased (-0.149972 --> -0.196641).  Saving model ...
Epoch: 6 cost time: 5.672827959060669
Epoch: 6, Steps: 18 | Train Loss: 0.322 Vali Loss: 2.454 Vali Acc: 0.257 Test Loss: 2.454 Test Acc: 0.257
Validation loss decreased (-0.196641 --> -0.256642).  Saving model ...
Epoch: 7 cost time: 6.002601623535156
Epoch: 7, Steps: 18 | Train Loss: 0.121 Vali Loss: 2.255 Vali Acc: 0.343 Test Loss: 2.255 Test Acc: 0.343
Validation loss decreased (-0.256642 --> -0.343311).  Saving model ...
Epoch: 8 cost time: 6.119719982147217
Epoch: 8, Steps: 18 | Train Loss: 0.047 Vali Loss: 2.163 Vali Acc: 0.367 Test Loss: 2.163 Test Acc: 0.367
Validation loss decreased (-0.343311 --> -0.366645).  Saving model ...
Epoch: 9 cost time: 6.113116264343262
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.995 Vali Acc: 0.417 Test Loss: 1.995 Test Acc: 0.417
Validation loss decreased (-0.366645 --> -0.416647).  Saving model ...
Epoch: 10 cost time: 6.412826299667358
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.873 Vali Acc: 0.467 Test Loss: 1.873 Test Acc: 0.467
Validation loss decreased (-0.416647 --> -0.466648).  Saving model ...
Epoch: 11 cost time: 5.881624937057495
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.882 Vali Acc: 0.470 Test Loss: 1.882 Test Acc: 0.470
Validation loss decreased (-0.466648 --> -0.469981).  Saving model ...
Epoch: 12 cost time: 6.023901462554932
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.855 Vali Acc: 0.477 Test Loss: 1.855 Test Acc: 0.477
Validation loss decreased (-0.469981 --> -0.476648).  Saving model ...
Epoch: 13 cost time: 5.951428413391113
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.789 Vali Acc: 0.480 Test Loss: 1.789 Test Acc: 0.480
Validation loss decreased (-0.476648 --> -0.479982).  Saving model ...
Epoch: 14 cost time: 6.4865758419036865
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.734 Vali Acc: 0.510 Test Loss: 1.734 Test Acc: 0.510
Validation loss decreased (-0.479982 --> -0.509983).  Saving model ...
Epoch: 15 cost time: 6.079472780227661
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.701 Vali Acc: 0.507 Test Loss: 1.701 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.118577241897583
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.664 Vali Acc: 0.520 Test Loss: 1.664 Test Acc: 0.520
Validation loss decreased (-0.509983 --> -0.519983).  Saving model ...
Epoch: 17 cost time: 6.070235013961792
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.640 Vali Acc: 0.553 Test Loss: 1.640 Test Acc: 0.553
Validation loss decreased (-0.519983 --> -0.553317).  Saving model ...
Epoch: 18 cost time: 6.1688244342803955
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.614 Vali Acc: 0.547 Test Loss: 1.614 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.833411693572998
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.615 Vali Acc: 0.550 Test Loss: 1.615 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.179872035980225
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.597 Vali Acc: 0.550 Test Loss: 1.597 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.9766247272491455
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.570 Vali Acc: 0.567 Test Loss: 1.570 Test Acc: 0.567
Validation loss decreased (-0.553317 --> -0.566651).  Saving model ...
Epoch: 22 cost time: 6.217132329940796
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.553 Vali Acc: 0.577 Test Loss: 1.553 Test Acc: 0.577
Validation loss decreased (-0.566651 --> -0.576651).  Saving model ...
Epoch: 23 cost time: 6.17605996131897
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.577 Test Loss: 1.544 Test Acc: 0.577
Validation loss decreased (-0.576651 --> -0.576651).  Saving model ...
Epoch: 24 cost time: 6.225250244140625
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.580 Test Loss: 1.530 Test Acc: 0.580
Validation loss decreased (-0.576651 --> -0.579985).  Saving model ...
Epoch: 25 cost time: 6.26117730140686
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.515 Vali Acc: 0.583 Test Loss: 1.515 Test Acc: 0.583
Validation loss decreased (-0.579985 --> -0.583318).  Saving model ...
Epoch: 26 cost time: 6.332677364349365
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.504 Vali Acc: 0.563 Test Loss: 1.504 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.248786687850952
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.580 Test Loss: 1.475 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.659363269805908
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.468 Vali Acc: 0.587 Test Loss: 1.468 Test Acc: 0.587
Validation loss decreased (-0.583318 --> -0.586652).  Saving model ...
Epoch: 29 cost time: 6.539482831954956
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.469 Vali Acc: 0.580 Test Loss: 1.469 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.5299859046936035
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.457 Vali Acc: 0.587 Test Loss: 1.457 Test Acc: 0.587
Validation loss decreased (-0.586652 --> -0.586652).  Saving model ...
Epoch: 31 cost time: 6.705170154571533
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.449 Vali Acc: 0.587 Test Loss: 1.449 Test Acc: 0.587
Validation loss decreased (-0.586652 --> -0.586652).  Saving model ...
Epoch: 32 cost time: 6.467015743255615
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.460 Vali Acc: 0.597 Test Loss: 1.460 Test Acc: 0.597
Validation loss decreased (-0.586652 --> -0.596652).  Saving model ...
Epoch: 33 cost time: 6.544861555099487
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.438 Vali Acc: 0.607 Test Loss: 1.438 Test Acc: 0.607
Validation loss decreased (-0.596652 --> -0.606652).  Saving model ...
Epoch: 34 cost time: 6.034296274185181
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.429 Vali Acc: 0.607 Test Loss: 1.429 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 35 cost time: 6.191929340362549
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.413 Vali Acc: 0.603 Test Loss: 1.413 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.303326368331909
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.405 Vali Acc: 0.603 Test Loss: 1.405 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 6.425603866577148
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.600 Test Loss: 1.406 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 6.175485610961914
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.610 Test Loss: 1.393 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 39 cost time: 6.388958215713501
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.617 Test Loss: 1.390 Test Acc: 0.617
Validation loss decreased (-0.609986 --> -0.616653).  Saving model ...
Epoch: 40 cost time: 6.588907241821289
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.610 Test Loss: 1.385 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.189350366592407
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.613 Test Loss: 1.383 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.112818956375122
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.607 Test Loss: 1.382 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.172285318374634
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.610 Test Loss: 1.377 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.0261170864105225
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.610 Test Loss: 1.367 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 5.697197198867798
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.620 Test Loss: 1.361 Test Acc: 0.620
Validation loss decreased (-0.616653 --> -0.619986).  Saving model ...
Epoch: 46 cost time: 6.275110960006714
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.627 Test Loss: 1.347 Test Acc: 0.627
Validation loss decreased (-0.619986 --> -0.626653).  Saving model ...
Epoch: 47 cost time: 5.9524712562561035
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.633 Test Loss: 1.345 Test Acc: 0.633
Validation loss decreased (-0.626653 --> -0.633320).  Saving model ...
Epoch: 48 cost time: 6.081870079040527
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.627 Test Loss: 1.346 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.326708555221558
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.633 Test Loss: 1.336 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 50 cost time: 5.955292224884033
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.640 Test Loss: 1.327 Test Acc: 0.640
Validation loss decreased (-0.633320 --> -0.639987).  Saving model ...
Epoch: 51 cost time: 6.176434278488159
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.325 Vali Acc: 0.643 Test Loss: 1.325 Test Acc: 0.643
Validation loss decreased (-0.639987 --> -0.643320).  Saving model ...
Epoch: 52 cost time: 6.363616228103638
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.643 Test Loss: 1.329 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 6.13923716545105
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.637 Test Loss: 1.327 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 6.208134174346924
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.640 Test Loss: 1.320 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 5.7609312534332275
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.643 Test Loss: 1.317 Test Acc: 0.643
Validation loss decreased (-0.643320 --> -0.643320).  Saving model ...
Epoch: 56 cost time: 6.191393613815308
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.640 Test Loss: 1.318 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.128268718719482
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.313 Vali Acc: 0.643 Test Loss: 1.313 Test Acc: 0.643
Validation loss decreased (-0.643320 --> -0.643320).  Saving model ...
Epoch: 58 cost time: 6.226997375488281
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.305 Vali Acc: 0.650 Test Loss: 1.305 Test Acc: 0.650
Validation loss decreased (-0.643320 --> -0.649987).  Saving model ...
Epoch: 59 cost time: 6.024930953979492
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.643 Test Loss: 1.299 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 6.026381731033325
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.300 Vali Acc: 0.657 Test Loss: 1.300 Test Acc: 0.657
Validation loss decreased (-0.649987 --> -0.656654).  Saving model ...
Epoch: 61 cost time: 6.407270431518555
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.300 Vali Acc: 0.653 Test Loss: 1.300 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 5.879204988479614
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.653 Test Loss: 1.295 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 6.052338600158691
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.294 Vali Acc: 0.650 Test Loss: 1.294 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 6.745733737945557
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.294 Vali Acc: 0.647 Test Loss: 1.294 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 6.239247560501099
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.290 Vali Acc: 0.650 Test Loss: 1.290 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 6.041081428527832
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.284 Vali Acc: 0.653 Test Loss: 1.284 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 6.569299936294556
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.653 Test Loss: 1.281 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 6.084700584411621
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.279 Vali Acc: 0.657 Test Loss: 1.279 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656654).  Saving model ...
Epoch: 69 cost time: 6.231171131134033
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.280 Vali Acc: 0.657 Test Loss: 1.280 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 6.652430057525635
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.272 Vali Acc: 0.660 Test Loss: 1.272 Test Acc: 0.660
Validation loss decreased (-0.656654 --> -0.659987).  Saving model ...
Epoch: 71 cost time: 6.044301271438599
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.269 Vali Acc: 0.653 Test Loss: 1.269 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 6.217573642730713
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.657 Test Loss: 1.267 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 5.9548516273498535
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.657 Test Loss: 1.266 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 6.183291435241699
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.660 Test Loss: 1.265 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
Epoch: 75 cost time: 6.1893885135650635
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.657 Test Loss: 1.267 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 6.304261207580566
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.663 Test Loss: 1.265 Test Acc: 0.663
Validation loss decreased (-0.659987 --> -0.663321).  Saving model ...
Epoch: 77 cost time: 6.00189733505249
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.667 Test Loss: 1.262 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666654).  Saving model ...
Epoch: 78 cost time: 6.060171365737915
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.667 Test Loss: 1.256 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 79 cost time: 5.978700160980225
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.670 Test Loss: 1.248 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669988).  Saving model ...
Epoch: 80 cost time: 6.072028875350952
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.670 Test Loss: 1.247 Test Acc: 0.670
Validation loss decreased (-0.669988 --> -0.669988).  Saving model ...
Epoch: 81 cost time: 6.091796875
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.667 Test Loss: 1.247 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 6.121935844421387
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.667 Test Loss: 1.245 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 6.234305143356323
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.670 Test Loss: 1.246 Test Acc: 0.670
Validation loss decreased (-0.669988 --> -0.669988).  Saving model ...
Epoch: 84 cost time: 6.408404111862183
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.673 Test Loss: 1.245 Test Acc: 0.673
Validation loss decreased (-0.669988 --> -0.673321).  Saving model ...
Epoch: 85 cost time: 6.127429485321045
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.673 Test Loss: 1.246 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 5.9875617027282715
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.673 Test Loss: 1.241 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 87 cost time: 6.424344778060913
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.673 Test Loss: 1.239 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 88 cost time: 5.945033550262451
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.677 Test Loss: 1.238 Test Acc: 0.677
Validation loss decreased (-0.673321 --> -0.676654).  Saving model ...
Epoch: 89 cost time: 5.885037422180176
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.677 Test Loss: 1.239 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 6.158565044403076
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.677 Test Loss: 1.238 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 6.119079113006592
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.680 Test Loss: 1.235 Test Acc: 0.680
Validation loss decreased (-0.676654 --> -0.679988).  Saving model ...
Epoch: 92 cost time: 6.277653455734253
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.683 Test Loss: 1.235 Test Acc: 0.683
Validation loss decreased (-0.679988 --> -0.683321).  Saving model ...
Epoch: 93 cost time: 6.070597410202026
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.237 Vali Acc: 0.683 Test Loss: 1.237 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 5.920283794403076
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.680 Test Loss: 1.232 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 6.185657978057861
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.687 Test Loss: 1.238 Test Acc: 0.687
Validation loss decreased (-0.683321 --> -0.686654).  Saving model ...
Epoch: 96 cost time: 5.859770059585571
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.687 Test Loss: 1.233 Test Acc: 0.687
Validation loss decreased (-0.686654 --> -0.686654).  Saving model ...
Epoch: 97 cost time: 5.757640361785889
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.677 Test Loss: 1.232 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 6.224307537078857
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.677 Test Loss: 1.231 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 6.504725456237793
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.680 Test Loss: 1.231 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 6.537812948226929
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.680 Test Loss: 1.231 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6866666666666666
model parameter : 1519129
model size : 10.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.344062566757202
Epoch: 1, Steps: 18 | Train Loss: 3.294 Vali Loss: 3.205 Vali Acc: 0.080 Test Loss: 3.205 Test Acc: 0.080
Validation loss decreased (inf --> -0.079968).  Saving model ...
Epoch: 2 cost time: 6.3940064907073975
Epoch: 2, Steps: 18 | Train Loss: 2.836 Vali Loss: 3.076 Vali Acc: 0.113 Test Loss: 3.076 Test Acc: 0.113
Validation loss decreased (-0.079968 --> -0.113303).  Saving model ...
Epoch: 3 cost time: 6.737820863723755
Epoch: 3, Steps: 18 | Train Loss: 2.225 Vali Loss: 2.928 Vali Acc: 0.147 Test Loss: 2.928 Test Acc: 0.147
Validation loss decreased (-0.113303 --> -0.146637).  Saving model ...
Epoch: 4 cost time: 6.2653419971466064
Epoch: 4, Steps: 18 | Train Loss: 1.422 Vali Loss: 2.772 Vali Acc: 0.160 Test Loss: 2.772 Test Acc: 0.160
Validation loss decreased (-0.146637 --> -0.159972).  Saving model ...
Epoch: 5 cost time: 6.373602628707886
Epoch: 5, Steps: 18 | Train Loss: 0.768 Vali Loss: 2.604 Vali Acc: 0.220 Test Loss: 2.604 Test Acc: 0.220
Validation loss decreased (-0.159972 --> -0.219974).  Saving model ...
Epoch: 6 cost time: 6.526058197021484
Epoch: 6, Steps: 18 | Train Loss: 0.340 Vali Loss: 2.441 Vali Acc: 0.230 Test Loss: 2.441 Test Acc: 0.230
Validation loss decreased (-0.219974 --> -0.229976).  Saving model ...
Epoch: 7 cost time: 6.190399646759033
Epoch: 7, Steps: 18 | Train Loss: 0.124 Vali Loss: 2.194 Vali Acc: 0.320 Test Loss: 2.194 Test Acc: 0.320
Validation loss decreased (-0.229976 --> -0.319978).  Saving model ...
Epoch: 8 cost time: 5.868103742599487
Epoch: 8, Steps: 18 | Train Loss: 0.047 Vali Loss: 2.032 Vali Acc: 0.387 Test Loss: 2.032 Test Acc: 0.387
Validation loss decreased (-0.319978 --> -0.386646).  Saving model ...
Epoch: 9 cost time: 6.438777446746826
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.859 Vali Acc: 0.433 Test Loss: 1.859 Test Acc: 0.433
Validation loss decreased (-0.386646 --> -0.433315).  Saving model ...
Epoch: 10 cost time: 5.866737127304077
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.747 Vali Acc: 0.467 Test Loss: 1.747 Test Acc: 0.467
Validation loss decreased (-0.433315 --> -0.466649).  Saving model ...
Epoch: 11 cost time: 6.211090087890625
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.701 Vali Acc: 0.467 Test Loss: 1.701 Test Acc: 0.467
Validation loss decreased (-0.466649 --> -0.466650).  Saving model ...
Epoch: 12 cost time: 6.066927671432495
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.677 Vali Acc: 0.477 Test Loss: 1.677 Test Acc: 0.477
Validation loss decreased (-0.466650 --> -0.476650).  Saving model ...
Epoch: 13 cost time: 6.057025909423828
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.619 Vali Acc: 0.503 Test Loss: 1.619 Test Acc: 0.503
Validation loss decreased (-0.476650 --> -0.503317).  Saving model ...
Epoch: 14 cost time: 6.191141843795776
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.567 Vali Acc: 0.513 Test Loss: 1.567 Test Acc: 0.513
Validation loss decreased (-0.503317 --> -0.513318).  Saving model ...
Epoch: 15 cost time: 6.507377862930298
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.531 Vali Acc: 0.533 Test Loss: 1.531 Test Acc: 0.533
Validation loss decreased (-0.513318 --> -0.533318).  Saving model ...
Epoch: 16 cost time: 6.214115858078003
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.506 Vali Acc: 0.540 Test Loss: 1.506 Test Acc: 0.540
Validation loss decreased (-0.533318 --> -0.539985).  Saving model ...
Epoch: 17 cost time: 6.055618524551392
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.480 Vali Acc: 0.537 Test Loss: 1.480 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.975278854370117
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.460 Vali Acc: 0.550 Test Loss: 1.460 Test Acc: 0.550
Validation loss decreased (-0.539985 --> -0.549985).  Saving model ...
Epoch: 19 cost time: 6.791407585144043
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.452 Vali Acc: 0.553 Test Loss: 1.452 Test Acc: 0.553
Validation loss decreased (-0.549985 --> -0.553319).  Saving model ...
Epoch: 20 cost time: 6.709918260574341
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.425 Vali Acc: 0.557 Test Loss: 1.425 Test Acc: 0.557
Validation loss decreased (-0.553319 --> -0.556652).  Saving model ...
Epoch: 21 cost time: 6.667917251586914
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.398 Vali Acc: 0.567 Test Loss: 1.398 Test Acc: 0.567
Validation loss decreased (-0.556652 --> -0.566653).  Saving model ...
Epoch: 22 cost time: 6.61365270614624
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.383 Vali Acc: 0.570 Test Loss: 1.383 Test Acc: 0.570
Validation loss decreased (-0.566653 --> -0.569986).  Saving model ...
Epoch: 23 cost time: 6.0762388706207275
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.376 Vali Acc: 0.567 Test Loss: 1.376 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.521602153778076
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.368 Vali Acc: 0.577 Test Loss: 1.368 Test Acc: 0.577
Validation loss decreased (-0.569986 --> -0.576653).  Saving model ...
Epoch: 25 cost time: 6.5531792640686035
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.346 Vali Acc: 0.587 Test Loss: 1.346 Test Acc: 0.587
Validation loss decreased (-0.576653 --> -0.586653).  Saving model ...
Epoch: 26 cost time: 6.74406361579895
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.340 Vali Acc: 0.577 Test Loss: 1.340 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.686832427978516
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.590 Test Loss: 1.323 Test Acc: 0.590
Validation loss decreased (-0.586653 --> -0.589987).  Saving model ...
Epoch: 28 cost time: 6.542161226272583
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.318 Vali Acc: 0.587 Test Loss: 1.318 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.597971200942993
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.312 Vali Acc: 0.603 Test Loss: 1.312 Test Acc: 0.603
Validation loss decreased (-0.589987 --> -0.603320).  Saving model ...
Epoch: 30 cost time: 6.129191160202026
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.305 Vali Acc: 0.597 Test Loss: 1.305 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.6174774169921875
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.600 Test Loss: 1.296 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.730997800827026
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.603 Test Loss: 1.296 Test Acc: 0.603
Validation loss decreased (-0.603320 --> -0.603320).  Saving model ...
Epoch: 33 cost time: 6.211853742599487
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.281 Vali Acc: 0.613 Test Loss: 1.281 Test Acc: 0.613
Validation loss decreased (-0.603320 --> -0.613321).  Saving model ...
Epoch: 34 cost time: 6.751381158828735
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.272 Vali Acc: 0.630 Test Loss: 1.272 Test Acc: 0.630
Validation loss decreased (-0.613321 --> -0.629987).  Saving model ...
Epoch: 35 cost time: 6.7395734786987305
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.268 Vali Acc: 0.630 Test Loss: 1.268 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 36 cost time: 6.607070207595825
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.630 Test Loss: 1.259 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 37 cost time: 6.758527755737305
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.640 Test Loss: 1.255 Test Acc: 0.640
Validation loss decreased (-0.629987 --> -0.639987).  Saving model ...
Epoch: 38 cost time: 6.619035959243774
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.653 Test Loss: 1.248 Test Acc: 0.653
Validation loss decreased (-0.639987 --> -0.653321).  Saving model ...
Epoch: 39 cost time: 6.673189640045166
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.653 Test Loss: 1.246 Test Acc: 0.653
Validation loss decreased (-0.653321 --> -0.653321).  Saving model ...
Epoch: 40 cost time: 6.605488061904907
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.647 Test Loss: 1.241 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.681195020675659
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.640 Test Loss: 1.235 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.188676595687866
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.647 Test Loss: 1.234 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.614343166351318
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.650 Test Loss: 1.232 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.3276166915893555
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.657 Test Loss: 1.229 Test Acc: 0.657
Validation loss decreased (-0.653321 --> -0.656654).  Saving model ...
Epoch: 45 cost time: 6.256851434707642
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.657 Test Loss: 1.223 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656654).  Saving model ...
Epoch: 46 cost time: 6.1922831535339355
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.653 Test Loss: 1.213 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.030195236206055
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.650 Test Loss: 1.211 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 5.917889595031738
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.657 Test Loss: 1.206 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656655).  Saving model ...
Epoch: 49 cost time: 6.2522642612457275
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.653 Test Loss: 1.201 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.1476640701293945
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.196 Vali Acc: 0.663 Test Loss: 1.196 Test Acc: 0.663
Validation loss decreased (-0.656655 --> -0.663321).  Saving model ...
Epoch: 51 cost time: 6.438248872756958
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.667 Test Loss: 1.193 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666655).  Saving model ...
Epoch: 52 cost time: 6.47177791595459
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.670 Test Loss: 1.193 Test Acc: 0.670
Validation loss decreased (-0.666655 --> -0.669988).  Saving model ...
Epoch: 53 cost time: 6.746004581451416
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.670 Test Loss: 1.189 Test Acc: 0.670
Validation loss decreased (-0.669988 --> -0.669988).  Saving model ...
Epoch: 54 cost time: 6.474650144577026
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.667 Test Loss: 1.184 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 7.033775329589844
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.663 Test Loss: 1.183 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 6.2249720096588135
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.663 Test Loss: 1.182 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 6.415022850036621
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.663 Test Loss: 1.179 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 6.900430679321289
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.667 Test Loss: 1.175 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 6.740049362182617
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.171 Vali Acc: 0.673 Test Loss: 1.171 Test Acc: 0.673
Validation loss decreased (-0.669988 --> -0.673322).  Saving model ...
Epoch: 60 cost time: 6.511113882064819
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.677 Test Loss: 1.169 Test Acc: 0.677
Validation loss decreased (-0.673322 --> -0.676655).  Saving model ...
Epoch: 61 cost time: 6.281035661697388
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.168 Vali Acc: 0.677 Test Loss: 1.168 Test Acc: 0.677
Validation loss decreased (-0.676655 --> -0.676655).  Saving model ...
Epoch: 62 cost time: 6.604450464248657
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.168 Vali Acc: 0.670 Test Loss: 1.168 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 6.354201793670654
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.677 Test Loss: 1.167 Test Acc: 0.677
Validation loss decreased (-0.676655 --> -0.676655).  Saving model ...
Epoch: 64 cost time: 6.339443922042847
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.170 Vali Acc: 0.663 Test Loss: 1.170 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 6.352308034896851
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.673 Test Loss: 1.169 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 6.231541633605957
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.166 Vali Acc: 0.680 Test Loss: 1.166 Test Acc: 0.680
Validation loss decreased (-0.676655 --> -0.679988).  Saving model ...
Epoch: 67 cost time: 6.168802261352539
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.164 Vali Acc: 0.683 Test Loss: 1.164 Test Acc: 0.683
Validation loss decreased (-0.679988 --> -0.683322).  Saving model ...
Epoch: 68 cost time: 6.528878688812256
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.161 Vali Acc: 0.680 Test Loss: 1.161 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.654628038406372
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.163 Vali Acc: 0.683 Test Loss: 1.163 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 70 cost time: 7.203192710876465
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.161 Vali Acc: 0.687 Test Loss: 1.161 Test Acc: 0.687
Validation loss decreased (-0.683322 --> -0.686655).  Saving model ...
Epoch: 71 cost time: 6.911538362503052
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.158 Vali Acc: 0.687 Test Loss: 1.158 Test Acc: 0.687
Validation loss decreased (-0.686655 --> -0.686655).  Saving model ...
Epoch: 72 cost time: 6.152390956878662
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.156 Vali Acc: 0.687 Test Loss: 1.156 Test Acc: 0.687
Validation loss decreased (-0.686655 --> -0.686655).  Saving model ...
Epoch: 73 cost time: 6.465749740600586
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.155 Vali Acc: 0.697 Test Loss: 1.155 Test Acc: 0.697
Validation loss decreased (-0.686655 --> -0.696655).  Saving model ...
Epoch: 74 cost time: 6.464078187942505
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.153 Vali Acc: 0.700 Test Loss: 1.153 Test Acc: 0.700
Validation loss decreased (-0.696655 --> -0.699988).  Saving model ...
Epoch: 75 cost time: 6.608732461929321
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.152 Vali Acc: 0.697 Test Loss: 1.152 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 6.52707052230835
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.697 Test Loss: 1.150 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 6.647379159927368
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.693 Test Loss: 1.150 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 6.435950040817261
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.148 Vali Acc: 0.693 Test Loss: 1.148 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 6.415140867233276
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.697 Test Loss: 1.144 Test Acc: 0.697
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 6.342196464538574
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.703 Test Loss: 1.142 Test Acc: 0.703
Validation loss decreased (-0.699988 --> -0.703322).  Saving model ...
Epoch: 81 cost time: 6.32572340965271
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.703 Test Loss: 1.142 Test Acc: 0.703
Validation loss decreased (-0.703322 --> -0.703322).  Saving model ...
Epoch: 82 cost time: 6.949935436248779
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.703 Test Loss: 1.141 Test Acc: 0.703
Validation loss decreased (-0.703322 --> -0.703322).  Saving model ...
Epoch: 83 cost time: 6.5885303020477295
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.140 Vali Acc: 0.703 Test Loss: 1.140 Test Acc: 0.703
Validation loss decreased (-0.703322 --> -0.703322).  Saving model ...
Epoch: 84 cost time: 6.238251447677612
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.703 Test Loss: 1.139 Test Acc: 0.703
Validation loss decreased (-0.703322 --> -0.703322).  Saving model ...
Epoch: 85 cost time: 6.458163022994995
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.138 Vali Acc: 0.703 Test Loss: 1.138 Test Acc: 0.703
Validation loss decreased (-0.703322 --> -0.703322).  Saving model ...
Epoch: 86 cost time: 6.736293077468872
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.136 Vali Acc: 0.703 Test Loss: 1.136 Test Acc: 0.703
Validation loss decreased (-0.703322 --> -0.703322).  Saving model ...
Epoch: 87 cost time: 6.5693864822387695
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.707 Test Loss: 1.134 Test Acc: 0.707
Validation loss decreased (-0.703322 --> -0.706655).  Saving model ...
Epoch: 88 cost time: 6.922910451889038
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.133 Vali Acc: 0.703 Test Loss: 1.133 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 6.219541311264038
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.135 Vali Acc: 0.703 Test Loss: 1.135 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 6.758866786956787
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.135 Vali Acc: 0.707 Test Loss: 1.135 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 6.616965293884277
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.713 Test Loss: 1.132 Test Acc: 0.713
Validation loss decreased (-0.706655 --> -0.713322).  Saving model ...
Epoch: 92 cost time: 6.311154365539551
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.720 Test Loss: 1.132 Test Acc: 0.720
Validation loss decreased (-0.713322 --> -0.719989).  Saving model ...
Epoch: 93 cost time: 7.057844400405884
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.133 Vali Acc: 0.720 Test Loss: 1.133 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 6.740327596664429
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.130 Vali Acc: 0.713 Test Loss: 1.130 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 6.715163707733154
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.136 Vali Acc: 0.720 Test Loss: 1.136 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 6.324923992156982
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.135 Vali Acc: 0.720 Test Loss: 1.135 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 6.1458423137664795
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.717 Test Loss: 1.134 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 6.5025856494903564
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.717 Test Loss: 1.134 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 6.5407164096832275
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.717 Test Loss: 1.134 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 6.66272497177124
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.720 Test Loss: 1.134 Test Acc: 0.720
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.72
model parameter : 1519129
model size : 10.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.580664157867432
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 6.005610942840576
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 3 cost time: 5.935068368911743
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.898491144180298
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.926475286483765
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.06745171546936
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 7 cost time: 6.1608827114105225
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 8 cost time: 6.59965443611145
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.336243152618408
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.115623474121094
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 11 cost time: 6.542697906494141
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 12 cost time: 6.560476303100586
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.372390031814575
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.51628565788269
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 15 cost time: 6.125668525695801
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.146177530288696
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.736384153366089
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.183015584945679
Epoch: 18, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.080101013183594
Epoch: 19, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.178498983383179
Epoch: 20, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 21 cost time: 5.863307952880859
Epoch: 21, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 22 cost time: 6.287705898284912
Epoch: 22, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.195014953613281
Epoch: 23, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.135458469390869
Epoch: 24, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.003080606460571
Epoch: 25, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.023053407669067
Epoch: 26, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.242212533950806
Epoch: 27, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 6.519317626953125
Epoch: 28, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.587147951126099
Epoch: 29, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.476153135299683
Epoch: 30, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 31 cost time: 6.433281183242798
Epoch: 31, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 32 cost time: 6.860920429229736
Epoch: 32, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.2999491691589355
Epoch: 33, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.1718058586120605
Epoch: 34, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 6.3703038692474365
Epoch: 35, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 6.24462628364563
Epoch: 36, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 6.1533262729644775
Epoch: 37, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 6.290510177612305
Epoch: 38, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 5.896083831787109
Epoch: 39, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 6.020517587661743
Epoch: 40, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 6.212836742401123
Epoch: 41, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 1519129
model size : 10.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.443113565444946
Epoch: 1, Steps: 18 | Train Loss: 3.059 Vali Loss: 2.333 Vali Acc: 0.673 Test Loss: 2.333 Test Acc: 0.673
Validation loss decreased (inf --> -0.673310).  Saving model ...
Epoch: 2 cost time: 6.175042152404785
Epoch: 2, Steps: 18 | Train Loss: 1.628 Vali Loss: 1.090 Vali Acc: 0.823 Test Loss: 1.090 Test Acc: 0.823
Validation loss decreased (-0.673310 --> -0.823322).  Saving model ...
Epoch: 3 cost time: 6.222891330718994
Epoch: 3, Steps: 18 | Train Loss: 0.533 Vali Loss: 0.610 Vali Acc: 0.873 Test Loss: 0.610 Test Acc: 0.873
Validation loss decreased (-0.823322 --> -0.873327).  Saving model ...
Epoch: 4 cost time: 5.9443254470825195
Epoch: 4, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.473 Vali Acc: 0.887 Test Loss: 0.473 Test Acc: 0.887
Validation loss decreased (-0.873327 --> -0.886662).  Saving model ...
Epoch: 5 cost time: 6.15817666053772
Epoch: 5, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.442 Vali Acc: 0.883 Test Loss: 0.442 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.614519834518433
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
Validation loss decreased (-0.886662 --> -0.903329).  Saving model ...
Epoch: 7 cost time: 6.422324895858765
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.386 Vali Acc: 0.907 Test Loss: 0.386 Test Acc: 0.907
Validation loss decreased (-0.903329 --> -0.906663).  Saving model ...
Epoch: 8 cost time: 6.678528308868408
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.367999792098999
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.213698387145996
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.368 Vali Acc: 0.910 Test Loss: 0.368 Test Acc: 0.910
Validation loss decreased (-0.906663 --> -0.909996).  Saving model ...
Epoch: 11 cost time: 6.3447253704071045
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.369 Vali Acc: 0.907 Test Loss: 0.369 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.165108919143677
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.369 Vali Acc: 0.910 Test Loss: 0.369 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.9862143993377686
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.873219013214111
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.09836483001709
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.363 Vali Acc: 0.907 Test Loss: 0.363 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.668673515319824
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.359 Vali Acc: 0.910 Test Loss: 0.359 Test Acc: 0.910
Validation loss decreased (-0.909996 --> -0.909996).  Saving model ...
Epoch: 17 cost time: 5.740209102630615
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.359 Vali Acc: 0.910 Test Loss: 0.359 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.214962959289551
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.358 Vali Acc: 0.910 Test Loss: 0.358 Test Acc: 0.910
Validation loss decreased (-0.909996 --> -0.909996).  Saving model ...
Epoch: 19 cost time: 6.20562219619751
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.910 Test Loss: 0.357 Test Acc: 0.910
Validation loss decreased (-0.909996 --> -0.909996).  Saving model ...
Epoch: 20 cost time: 6.425850868225098
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.355 Vali Acc: 0.910 Test Loss: 0.355 Test Acc: 0.910
Validation loss decreased (-0.909996 --> -0.909996).  Saving model ...
Epoch: 21 cost time: 6.247124910354614
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.352 Vali Acc: 0.910 Test Loss: 0.352 Test Acc: 0.910
Validation loss decreased (-0.909996 --> -0.909996).  Saving model ...
Epoch: 22 cost time: 6.768108129501343
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.351 Vali Acc: 0.907 Test Loss: 0.351 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.51081657409668
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.913 Test Loss: 0.349 Test Acc: 0.913
Validation loss decreased (-0.909996 --> -0.913330).  Saving model ...
Epoch: 24 cost time: 6.26833176612854
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.348 Vali Acc: 0.913 Test Loss: 0.348 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 25 cost time: 6.152879238128662
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.348 Vali Acc: 0.913 Test Loss: 0.348 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 26 cost time: 5.9029786586761475
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.910 Test Loss: 0.349 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.624240875244141
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.350 Vali Acc: 0.913 Test Loss: 0.350 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.779344320297241
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.910 Test Loss: 0.349 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.325650453567505
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.910 Test Loss: 0.349 Test Acc: 0.910
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.037081241607666
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.910 Test Loss: 0.349 Test Acc: 0.910
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.887495994567871
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.348 Vali Acc: 0.910 Test Loss: 0.348 Test Acc: 0.910
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 5.874759912490845
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.348 Vali Acc: 0.910 Test Loss: 0.348 Test Acc: 0.910
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 5.98910665512085
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.910 Test Loss: 0.347 Test Acc: 0.910
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 5.934746026992798
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.913 Test Loss: 0.347 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 35 cost time: 5.999244928359985
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.913 Test Loss: 0.347 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 36 cost time: 6.13842248916626
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.910 Test Loss: 0.346 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.254851579666138
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.913 Test Loss: 0.346 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 38 cost time: 6.031362056732178
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.913 Test Loss: 0.346 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.741573095321655
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.910 Test Loss: 0.346 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 5.981791257858276
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.910 Test Loss: 0.346 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 6.271008014678955
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.345 Vali Acc: 0.913 Test Loss: 0.345 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 42 cost time: 6.101500988006592
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.345 Vali Acc: 0.913 Test Loss: 0.345 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 43 cost time: 5.940618276596069
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.344 Vali Acc: 0.913 Test Loss: 0.344 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 44 cost time: 6.03190016746521
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.344 Vali Acc: 0.910 Test Loss: 0.344 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.81325364112854
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.344 Vali Acc: 0.910 Test Loss: 0.344 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 5.703868389129639
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.910 Test Loss: 0.343 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 6.034014940261841
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.910 Test Loss: 0.343 Test Acc: 0.910
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 5.8332860469818115
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.913 Test Loss: 0.343 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 49 cost time: 5.945334196090698
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.910 Test Loss: 0.343 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.157926321029663
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
Validation loss decreased (-0.913330 --> -0.916663).  Saving model ...
Epoch: 51 cost time: 6.130798101425171
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 52 cost time: 6.10442852973938
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 53 cost time: 6.1059205532073975
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 54 cost time: 6.108002185821533
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.199076890945435
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 56 cost time: 6.196986675262451
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.278574228286743
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 58 cost time: 6.169255495071411
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.187584638595581
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 6.871328353881836
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 6.51116156578064
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 62 cost time: 5.851304531097412
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 5.871112108230591
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 64 cost time: 6.237248182296753
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 65 cost time: 5.904511451721191
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.738065481185913
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 67 cost time: 5.581232309341431
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 5.539487361907959
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 69 cost time: 5.61065411567688
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 5.969371795654297
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 71 cost time: 5.847898006439209
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 72 cost time: 6.037122011184692
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 5.733417272567749
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 5.957864999771118
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 5.8364951610565186
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 5.872146129608154
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 5.57692289352417
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 5.754791021347046
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 5.974249362945557
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 6.030357837677002
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 6.0325353145599365
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9166666666666666
model parameter : 1322521
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.163187503814697
Epoch: 1, Steps: 18 | Train Loss: 3.121 Vali Loss: 2.552 Vali Acc: 0.550 Test Loss: 2.552 Test Acc: 0.550
Validation loss decreased (inf --> -0.549974).  Saving model ...
Epoch: 2 cost time: 6.209408521652222
Epoch: 2, Steps: 18 | Train Loss: 1.918 Vali Loss: 1.448 Vali Acc: 0.763 Test Loss: 1.448 Test Acc: 0.763
Validation loss decreased (-0.549974 --> -0.763319).  Saving model ...
Epoch: 3 cost time: 6.3525896072387695
Epoch: 3, Steps: 18 | Train Loss: 0.756 Vali Loss: 0.866 Vali Acc: 0.810 Test Loss: 0.866 Test Acc: 0.810
Validation loss decreased (-0.763319 --> -0.809991).  Saving model ...
Epoch: 4 cost time: 6.439050197601318
Epoch: 4, Steps: 18 | Train Loss: 0.232 Vali Loss: 0.670 Vali Acc: 0.807 Test Loss: 0.670 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.327532768249512
Epoch: 5, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.622 Vali Acc: 0.847 Test Loss: 0.622 Test Acc: 0.847
Validation loss decreased (-0.809991 --> -0.846660).  Saving model ...
Epoch: 6 cost time: 6.188952445983887
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
Validation loss decreased (-0.846660 --> -0.849994).  Saving model ...
Epoch: 7 cost time: 6.150331020355225
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.558 Vali Acc: 0.860 Test Loss: 0.558 Test Acc: 0.860
Validation loss decreased (-0.849994 --> -0.859994).  Saving model ...
Epoch: 8 cost time: 6.025676488876343
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.559 Vali Acc: 0.863 Test Loss: 0.559 Test Acc: 0.863
Validation loss decreased (-0.859994 --> -0.863328).  Saving model ...
Epoch: 9 cost time: 6.392073631286621
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
Validation loss decreased (-0.863328 --> -0.869995).  Saving model ...
Epoch: 10 cost time: 6.485158205032349
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.5361433029174805
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.539 Vali Acc: 0.870 Test Loss: 0.539 Test Acc: 0.870
Validation loss decreased (-0.869995 --> -0.869995).  Saving model ...
Epoch: 12 cost time: 6.230169296264648
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.537 Vali Acc: 0.870 Test Loss: 0.537 Test Acc: 0.870
Validation loss decreased (-0.869995 --> -0.869995).  Saving model ...
Epoch: 13 cost time: 6.002485275268555
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.867 Test Loss: 0.539 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.145466089248657
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.782327175140381
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.534 Vali Acc: 0.870 Test Loss: 0.534 Test Acc: 0.870
Validation loss decreased (-0.869995 --> -0.869995).  Saving model ...
Epoch: 16 cost time: 6.542702674865723
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.530 Vali Acc: 0.870 Test Loss: 0.530 Test Acc: 0.870
Validation loss decreased (-0.869995 --> -0.869995).  Saving model ...
Epoch: 17 cost time: 6.507723331451416
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.870 Test Loss: 0.531 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.609270334243774
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.185283899307251
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.132048606872559
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.356969833374023
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.142736911773682
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.863 Test Loss: 0.527 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.055094480514526
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.870 Test Loss: 0.525 Test Acc: 0.870
Validation loss decreased (-0.869995 --> -0.869995).  Saving model ...
Epoch: 24 cost time: 5.57041597366333
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.870 Test Loss: 0.525 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.172026634216309
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.870 Test Loss: 0.526 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.2252197265625
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.97895359992981
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.870 Test Loss: 0.529 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.9034743309021
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.867 Test Loss: 0.528 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.095369338989258
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.770911693572998
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.870 Test Loss: 0.529 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.880994081497192
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.870 Test Loss: 0.529 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 6.252521753311157
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.873 Test Loss: 0.528 Test Acc: 0.873
Validation loss decreased (-0.869995 --> -0.873328).  Saving model ...
Epoch: 33 cost time: 5.839883089065552
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.873 Test Loss: 0.529 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.7218286991119385
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.873 Test Loss: 0.529 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.781629800796509
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.873 Test Loss: 0.529 Test Acc: 0.873
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.818191051483154
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.873 Test Loss: 0.529 Test Acc: 0.873
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 5.891146183013916
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.873 Test Loss: 0.530 Test Acc: 0.873
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 6.291405200958252
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.870 Test Loss: 0.531 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 6.34346604347229
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.873 Test Loss: 0.532 Test Acc: 0.873
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 6.119521379470825
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.873 Test Loss: 0.532 Test Acc: 0.873
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 6.28227972984314
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.873 Test Loss: 0.533 Test Acc: 0.873
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 6.03176212310791
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.873 Test Loss: 0.533 Test Acc: 0.873
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8733333333333333
model parameter : 1322521
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.380820989608765
Epoch: 1, Steps: 18 | Train Loss: 3.215 Vali Loss: 2.793 Vali Acc: 0.403 Test Loss: 2.793 Test Acc: 0.403
Validation loss decreased (inf --> -0.403305).  Saving model ...
Epoch: 2 cost time: 5.872420310974121
Epoch: 2, Steps: 18 | Train Loss: 2.283 Vali Loss: 1.963 Vali Acc: 0.647 Test Loss: 1.963 Test Acc: 0.647
Validation loss decreased (-0.403305 --> -0.646647).  Saving model ...
Epoch: 3 cost time: 6.200524806976318
Epoch: 3, Steps: 18 | Train Loss: 1.173 Vali Loss: 1.328 Vali Acc: 0.727 Test Loss: 1.328 Test Acc: 0.727
Validation loss decreased (-0.646647 --> -0.726653).  Saving model ...
Epoch: 4 cost time: 6.36169171333313
Epoch: 4, Steps: 18 | Train Loss: 0.409 Vali Loss: 1.012 Vali Acc: 0.753 Test Loss: 1.012 Test Acc: 0.753
Validation loss decreased (-0.726653 --> -0.753323).  Saving model ...
Epoch: 5 cost time: 6.483800649642944
Epoch: 5, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.952 Vali Acc: 0.777 Test Loss: 0.952 Test Acc: 0.777
Validation loss decreased (-0.753323 --> -0.776657).  Saving model ...
Epoch: 6 cost time: 6.487523078918457
Epoch: 6, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.855 Vali Acc: 0.777 Test Loss: 0.855 Test Acc: 0.777
Validation loss decreased (-0.776657 --> -0.776658).  Saving model ...
Epoch: 7 cost time: 6.466681003570557
Epoch: 7, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.854 Vali Acc: 0.773 Test Loss: 0.854 Test Acc: 0.773
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.562198877334595
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.824 Vali Acc: 0.780 Test Loss: 0.824 Test Acc: 0.780
Validation loss decreased (-0.776658 --> -0.779992).  Saving model ...
Epoch: 9 cost time: 6.780426263809204
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.812 Vali Acc: 0.780 Test Loss: 0.812 Test Acc: 0.780
Validation loss decreased (-0.779992 --> -0.779992).  Saving model ...
Epoch: 10 cost time: 6.512017488479614
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.806 Vali Acc: 0.780 Test Loss: 0.806 Test Acc: 0.780
Validation loss decreased (-0.779992 --> -0.779992).  Saving model ...
Epoch: 11 cost time: 7.029892683029175
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.812 Vali Acc: 0.777 Test Loss: 0.812 Test Acc: 0.777
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.159607648849487
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.812 Vali Acc: 0.783 Test Loss: 0.812 Test Acc: 0.783
Validation loss decreased (-0.779992 --> -0.783325).  Saving model ...
Epoch: 13 cost time: 6.446774959564209
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.814 Vali Acc: 0.787 Test Loss: 0.814 Test Acc: 0.787
Validation loss decreased (-0.783325 --> -0.786659).  Saving model ...
Epoch: 14 cost time: 6.50455641746521
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.814 Vali Acc: 0.787 Test Loss: 0.814 Test Acc: 0.787
Validation loss decreased (-0.786659 --> -0.786659).  Saving model ...
Epoch: 15 cost time: 7.082986354827881
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.806 Vali Acc: 0.787 Test Loss: 0.806 Test Acc: 0.787
Validation loss decreased (-0.786659 --> -0.786659).  Saving model ...
Epoch: 16 cost time: 6.699187517166138
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.804 Vali Acc: 0.783 Test Loss: 0.804 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.498342037200928
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.805 Vali Acc: 0.793 Test Loss: 0.805 Test Acc: 0.793
Validation loss decreased (-0.786659 --> -0.793325).  Saving model ...
Epoch: 18 cost time: 6.782573223114014
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.807 Vali Acc: 0.783 Test Loss: 0.807 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.023230791091919
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.808 Vali Acc: 0.787 Test Loss: 0.808 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.4690022468566895
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.783 Test Loss: 0.807 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.31169867515564
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.805 Vali Acc: 0.787 Test Loss: 0.805 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.444956541061401
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.805 Vali Acc: 0.790 Test Loss: 0.805 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.233597993850708
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.793 Test Loss: 0.803 Test Acc: 0.793
Validation loss decreased (-0.793325 --> -0.793325).  Saving model ...
Epoch: 24 cost time: 6.201119422912598
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.802 Vali Acc: 0.797 Test Loss: 0.802 Test Acc: 0.797
Validation loss decreased (-0.793325 --> -0.796659).  Saving model ...
Epoch: 25 cost time: 6.321874618530273
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.804 Vali Acc: 0.797 Test Loss: 0.804 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.337425947189331
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.805 Vali Acc: 0.793 Test Loss: 0.805 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.2657294273376465
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.806 Vali Acc: 0.790 Test Loss: 0.806 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.746604681015015
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.806 Vali Acc: 0.790 Test Loss: 0.806 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.774599075317383
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.793 Test Loss: 0.807 Test Acc: 0.793
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.654677391052246
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.793 Test Loss: 0.811 Test Acc: 0.793
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 7.081014156341553
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.793 Test Loss: 0.810 Test Acc: 0.793
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.960108518600464
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.793 Test Loss: 0.810 Test Acc: 0.793
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 6.968534231185913
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.793 Test Loss: 0.810 Test Acc: 0.793
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.642608880996704
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.812 Vali Acc: 0.793 Test Loss: 0.812 Test Acc: 0.793
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7966666666666666
model parameter : 1322521
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.893584966659546
Epoch: 1, Steps: 18 | Train Loss: 3.281 Vali Loss: 2.966 Vali Acc: 0.237 Test Loss: 2.966 Test Acc: 0.237
Validation loss decreased (inf --> -0.236637).  Saving model ...
Epoch: 2 cost time: 6.437889099121094
Epoch: 2, Steps: 18 | Train Loss: 2.605 Vali Loss: 2.431 Vali Acc: 0.453 Test Loss: 2.431 Test Acc: 0.453
Validation loss decreased (-0.236637 --> -0.453309).  Saving model ...
Epoch: 3 cost time: 5.898412227630615
Epoch: 3, Steps: 18 | Train Loss: 1.650 Vali Loss: 1.936 Vali Acc: 0.540 Test Loss: 1.936 Test Acc: 0.540
Validation loss decreased (-0.453309 --> -0.539981).  Saving model ...
Epoch: 4 cost time: 6.141396999359131
Epoch: 4, Steps: 18 | Train Loss: 0.772 Vali Loss: 1.575 Vali Acc: 0.600 Test Loss: 1.575 Test Acc: 0.600
Validation loss decreased (-0.539981 --> -0.599984).  Saving model ...
Epoch: 5 cost time: 6.168445825576782
Epoch: 5, Steps: 18 | Train Loss: 0.308 Vali Loss: 1.409 Vali Acc: 0.597 Test Loss: 1.409 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.978304386138916
Epoch: 6, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.273 Vali Acc: 0.603 Test Loss: 1.273 Test Acc: 0.603
Validation loss decreased (-0.599984 --> -0.603321).  Saving model ...
Epoch: 7 cost time: 6.176746606826782
Epoch: 7, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.178 Vali Acc: 0.633 Test Loss: 1.178 Test Acc: 0.633
Validation loss decreased (-0.603321 --> -0.633322).  Saving model ...
Epoch: 8 cost time: 6.918739080429077
Epoch: 8, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.147 Vali Acc: 0.653 Test Loss: 1.147 Test Acc: 0.653
Validation loss decreased (-0.633322 --> -0.653322).  Saving model ...
Epoch: 9 cost time: 6.5029284954071045
Epoch: 9, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.123 Vali Acc: 0.680 Test Loss: 1.123 Test Acc: 0.680
Validation loss decreased (-0.653322 --> -0.679989).  Saving model ...
Epoch: 10 cost time: 6.3252973556518555
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.117 Vali Acc: 0.693 Test Loss: 1.117 Test Acc: 0.693
Validation loss decreased (-0.679989 --> -0.693322).  Saving model ...
Epoch: 11 cost time: 6.49707818031311
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.098 Vali Acc: 0.687 Test Loss: 1.098 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.573157072067261
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.087 Vali Acc: 0.687 Test Loss: 1.087 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.515876054763794
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.084 Vali Acc: 0.683 Test Loss: 1.084 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.286622762680054
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.076 Vali Acc: 0.690 Test Loss: 1.076 Test Acc: 0.690
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.2843780517578125
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.070 Vali Acc: 0.687 Test Loss: 1.070 Test Acc: 0.687
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.206335067749023
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.059 Vali Acc: 0.693 Test Loss: 1.059 Test Acc: 0.693
Validation loss decreased (-0.693322 --> -0.693323).  Saving model ...
Epoch: 17 cost time: 6.137356281280518
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.051 Vali Acc: 0.700 Test Loss: 1.051 Test Acc: 0.700
Validation loss decreased (-0.693323 --> -0.699989).  Saving model ...
Epoch: 18 cost time: 6.460468292236328
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.046 Vali Acc: 0.707 Test Loss: 1.046 Test Acc: 0.707
Validation loss decreased (-0.699989 --> -0.706656).  Saving model ...
Epoch: 19 cost time: 5.92376708984375
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.039 Vali Acc: 0.697 Test Loss: 1.039 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.0292909145355225
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.034 Vali Acc: 0.707 Test Loss: 1.034 Test Acc: 0.707
Validation loss decreased (-0.706656 --> -0.706656).  Saving model ...
Epoch: 21 cost time: 6.284318685531616
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.029 Vali Acc: 0.703 Test Loss: 1.029 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.101253271102905
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.027 Vali Acc: 0.703 Test Loss: 1.027 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.216388940811157
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.703 Test Loss: 1.021 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.911376714706421
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.019 Vali Acc: 0.703 Test Loss: 1.019 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.164170026779175
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.019 Vali Acc: 0.707 Test Loss: 1.019 Test Acc: 0.707
Validation loss decreased (-0.706656 --> -0.706656).  Saving model ...
Epoch: 26 cost time: 6.401980876922607
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.020 Vali Acc: 0.707 Test Loss: 1.020 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.854293584823608
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.016 Vali Acc: 0.710 Test Loss: 1.016 Test Acc: 0.710
Validation loss decreased (-0.706656 --> -0.709990).  Saving model ...
Epoch: 28 cost time: 6.541256427764893
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.015 Vali Acc: 0.710 Test Loss: 1.015 Test Acc: 0.710
Validation loss decreased (-0.709990 --> -0.709990).  Saving model ...
Epoch: 29 cost time: 6.473520040512085
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.013 Vali Acc: 0.710 Test Loss: 1.013 Test Acc: 0.710
Validation loss decreased (-0.709990 --> -0.709990).  Saving model ...
Epoch: 30 cost time: 6.339901447296143
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.016 Vali Acc: 0.707 Test Loss: 1.016 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.11728835105896
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.013 Vali Acc: 0.710 Test Loss: 1.013 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.3759424686431885
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.012 Vali Acc: 0.707 Test Loss: 1.012 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.293762445449829
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.710 Test Loss: 1.010 Test Acc: 0.710
Validation loss decreased (-0.709990 --> -0.709990).  Saving model ...
Epoch: 34 cost time: 6.110068321228027
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.707 Test Loss: 1.010 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 7.0406653881073
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.713 Test Loss: 1.012 Test Acc: 0.713
Validation loss decreased (-0.709990 --> -0.713323).  Saving model ...
Epoch: 36 cost time: 6.865709066390991
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.713 Test Loss: 1.011 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 37 cost time: 7.298462629318237
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.713 Test Loss: 1.008 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 38 cost time: 7.379611492156982
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.713 Test Loss: 1.011 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 7.46721339225769
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.713 Test Loss: 1.013 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 8.837451934814453
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.713 Test Loss: 1.012 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 8.706021070480347
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.713 Test Loss: 1.010 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 8.71252965927124
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.713 Test Loss: 1.008 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 43 cost time: 8.680336236953735
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.720 Test Loss: 1.008 Test Acc: 0.720
Validation loss decreased (-0.713323 --> -0.719990).  Saving model ...
Epoch: 44 cost time: 8.958070993423462
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.717 Test Loss: 1.005 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 6.4538490772247314
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.717 Test Loss: 1.003 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 6.418046951293945
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.720 Test Loss: 1.002 Test Acc: 0.720
Validation loss decreased (-0.719990 --> -0.719990).  Saving model ...
Epoch: 47 cost time: 6.173741579055786
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.723 Test Loss: 1.002 Test Acc: 0.723
Validation loss decreased (-0.719990 --> -0.723323).  Saving model ...
Epoch: 48 cost time: 6.221401929855347
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.723 Test Loss: 1.003 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.40578293800354
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.717 Test Loss: 1.002 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 6.339883804321289
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.720 Test Loss: 1.004 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 7.353842735290527
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.720 Test Loss: 1.004 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 6.518304824829102
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.720 Test Loss: 1.002 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 6.480531930923462
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.720 Test Loss: 1.001 Test Acc: 0.720
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 6.7089009284973145
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.720 Test Loss: 0.999 Test Acc: 0.720
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 6.337078809738159
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.723 Test Loss: 0.999 Test Acc: 0.723
Validation loss decreased (-0.723323 --> -0.723323).  Saving model ...
Epoch: 56 cost time: 6.186481237411499
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.723 Test Loss: 1.000 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.229495048522949
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.720 Test Loss: 1.001 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 5.87321662902832
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.723 Test Loss: 1.002 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 5.838858604431152
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.723 Test Loss: 1.003 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 6.039341688156128
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.727 Test Loss: 1.002 Test Acc: 0.727
Validation loss decreased (-0.723323 --> -0.726657).  Saving model ...
Epoch: 61 cost time: 6.88589882850647
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.727 Test Loss: 1.001 Test Acc: 0.727
Validation loss decreased (-0.726657 --> -0.726657).  Saving model ...
Epoch: 62 cost time: 5.970030307769775
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.002 Vali Acc: 0.730 Test Loss: 1.002 Test Acc: 0.730
Validation loss decreased (-0.726657 --> -0.729990).  Saving model ...
Epoch: 63 cost time: 6.34978985786438
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.727 Test Loss: 1.001 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 6.918566465377808
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.730 Test Loss: 1.000 Test Acc: 0.730
Validation loss decreased (-0.729990 --> -0.729990).  Saving model ...
Epoch: 65 cost time: 6.881786823272705
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.730 Test Loss: 1.000 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 6.64842414855957
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.730 Test Loss: 1.000 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 6.443094730377197
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.727 Test Loss: 1.001 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 6.570213556289673
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.727 Test Loss: 0.998 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 6.542322874069214
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.727 Test Loss: 0.998 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 6.344444751739502
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.727 Test Loss: 0.998 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 7.4940056800842285
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.727 Test Loss: 0.997 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 7.623748540878296
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.730 Test Loss: 0.998 Test Acc: 0.730
Validation loss decreased (-0.729990 --> -0.729990).  Saving model ...
Epoch: 73 cost time: 7.693942070007324
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.727 Test Loss: 1.000 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 7.148296356201172
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.730 Test Loss: 1.000 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 7.64622950553894
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.723 Test Loss: 1.000 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 7.960263252258301
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.727 Test Loss: 0.999 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 7.711294412612915
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.730 Test Loss: 1.001 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 7.448946475982666
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.733 Test Loss: 1.003 Test Acc: 0.733
Validation loss decreased (-0.729990 --> -0.733323).  Saving model ...
Epoch: 79 cost time: 7.566349744796753
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.730 Test Loss: 1.003 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 7.920071601867676
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.733 Test Loss: 1.004 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 8.128231048583984
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.730 Test Loss: 1.003 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 7.43092155456543
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.730 Test Loss: 1.000 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 7.7041215896606445
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.730 Test Loss: 0.999 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 7.85720157623291
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.730 Test Loss: 0.999 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 7.427273273468018
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.730 Test Loss: 0.998 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 7.512054920196533
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.733 Test Loss: 0.994 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 87 cost time: 8.174667119979858
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.733 Test Loss: 0.992 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 88 cost time: 7.881426572799683
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.733 Test Loss: 0.993 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 7.496758460998535
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.733 Test Loss: 0.995 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 7.971459865570068
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.733 Test Loss: 0.995 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 7.469921827316284
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.730 Test Loss: 0.996 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 7.709527254104614
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.733 Test Loss: 0.997 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 7.819133996963501
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.737 Test Loss: 0.996 Test Acc: 0.737
Validation loss decreased (-0.733323 --> -0.736657).  Saving model ...
Epoch: 94 cost time: 7.573158264160156
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.740 Test Loss: 0.996 Test Acc: 0.740
Validation loss decreased (-0.736657 --> -0.739990).  Saving model ...
Epoch: 95 cost time: 7.5616302490234375
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.740 Test Loss: 0.997 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 7.67635178565979
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.740 Test Loss: 0.999 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 7.435754299163818
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.740 Test Loss: 1.000 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 8.188665390014648
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.743 Test Loss: 1.001 Test Acc: 0.743
Validation loss decreased (-0.739990 --> -0.743323).  Saving model ...
Epoch: 99 cost time: 8.038965940475464
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.740 Test Loss: 1.001 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 8.266355276107788
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.740 Test Loss: 1.001 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7433333333333333
model parameter : 1322521
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.945556163787842
Epoch: 1, Steps: 18 | Train Loss: 3.307 Vali Loss: 3.054 Vali Acc: 0.137 Test Loss: 3.054 Test Acc: 0.137
Validation loss decreased (inf --> -0.136636).  Saving model ...
Epoch: 2 cost time: 7.5510993003845215
Epoch: 2, Steps: 18 | Train Loss: 2.739 Vali Loss: 2.732 Vali Acc: 0.257 Test Loss: 2.732 Test Acc: 0.257
Validation loss decreased (-0.136636 --> -0.256639).  Saving model ...
Epoch: 3 cost time: 7.512775659561157
Epoch: 3, Steps: 18 | Train Loss: 1.891 Vali Loss: 2.391 Vali Acc: 0.347 Test Loss: 2.391 Test Acc: 0.347
Validation loss decreased (-0.256639 --> -0.346643).  Saving model ...
Epoch: 4 cost time: 7.400230169296265
Epoch: 4, Steps: 18 | Train Loss: 1.050 Vali Loss: 2.099 Vali Acc: 0.453 Test Loss: 2.099 Test Acc: 0.453
Validation loss decreased (-0.346643 --> -0.453312).  Saving model ...
Epoch: 5 cost time: 8.074801683425903
Epoch: 5, Steps: 18 | Train Loss: 0.486 Vali Loss: 1.959 Vali Acc: 0.443 Test Loss: 1.959 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.299869537353516
Epoch: 6, Steps: 18 | Train Loss: 0.163 Vali Loss: 1.788 Vali Acc: 0.463 Test Loss: 1.788 Test Acc: 0.463
Validation loss decreased (-0.453312 --> -0.463315).  Saving model ...
Epoch: 7 cost time: 7.086203098297119
Epoch: 7, Steps: 18 | Train Loss: 0.051 Vali Loss: 1.689 Vali Acc: 0.497 Test Loss: 1.689 Test Acc: 0.497
Validation loss decreased (-0.463315 --> -0.496650).  Saving model ...
Epoch: 8 cost time: 7.720360517501831
Epoch: 8, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.593 Vali Acc: 0.540 Test Loss: 1.593 Test Acc: 0.540
Validation loss decreased (-0.496650 --> -0.539984).  Saving model ...
Epoch: 9 cost time: 7.961130857467651
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.545 Vali Acc: 0.533 Test Loss: 1.545 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.7506842613220215
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.523 Vali Acc: 0.550 Test Loss: 1.523 Test Acc: 0.550
Validation loss decreased (-0.539984 --> -0.549985).  Saving model ...
Epoch: 11 cost time: 7.728864908218384
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.493 Vali Acc: 0.547 Test Loss: 1.493 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.611891031265259
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.465 Vali Acc: 0.553 Test Loss: 1.465 Test Acc: 0.553
Validation loss decreased (-0.549985 --> -0.553319).  Saving model ...
Epoch: 13 cost time: 7.922023773193359
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.450 Vali Acc: 0.557 Test Loss: 1.450 Test Acc: 0.557
Validation loss decreased (-0.553319 --> -0.556652).  Saving model ...
Epoch: 14 cost time: 7.714621543884277
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.433 Vali Acc: 0.567 Test Loss: 1.433 Test Acc: 0.567
Validation loss decreased (-0.556652 --> -0.566652).  Saving model ...
Epoch: 15 cost time: 7.157356023788452
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.414 Vali Acc: 0.573 Test Loss: 1.414 Test Acc: 0.573
Validation loss decreased (-0.566652 --> -0.573319).  Saving model ...
Epoch: 16 cost time: 7.136900424957275
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.394 Vali Acc: 0.583 Test Loss: 1.394 Test Acc: 0.583
Validation loss decreased (-0.573319 --> -0.583319).  Saving model ...
Epoch: 17 cost time: 7.45630955696106
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.380 Vali Acc: 0.593 Test Loss: 1.380 Test Acc: 0.593
Validation loss decreased (-0.583319 --> -0.593320).  Saving model ...
Epoch: 18 cost time: 7.505574703216553
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.376 Vali Acc: 0.583 Test Loss: 1.376 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.221884250640869
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.355 Vali Acc: 0.597 Test Loss: 1.355 Test Acc: 0.597
Validation loss decreased (-0.593320 --> -0.596653).  Saving model ...
Epoch: 20 cost time: 6.8185412883758545
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.345 Vali Acc: 0.600 Test Loss: 1.345 Test Acc: 0.600
Validation loss decreased (-0.596653 --> -0.599987).  Saving model ...
Epoch: 21 cost time: 6.99422287940979
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.335 Vali Acc: 0.603 Test Loss: 1.335 Test Acc: 0.603
Validation loss decreased (-0.599987 --> -0.603320).  Saving model ...
Epoch: 22 cost time: 7.010087490081787
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.325 Vali Acc: 0.603 Test Loss: 1.325 Test Acc: 0.603
Validation loss decreased (-0.603320 --> -0.603320).  Saving model ...
Epoch: 23 cost time: 6.980785131454468
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.315 Vali Acc: 0.613 Test Loss: 1.315 Test Acc: 0.613
Validation loss decreased (-0.603320 --> -0.613320).  Saving model ...
Epoch: 24 cost time: 7.188568115234375
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.313 Vali Acc: 0.617 Test Loss: 1.313 Test Acc: 0.617
Validation loss decreased (-0.613320 --> -0.616654).  Saving model ...
Epoch: 25 cost time: 7.0835840702056885
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.307 Vali Acc: 0.620 Test Loss: 1.307 Test Acc: 0.620
Validation loss decreased (-0.616654 --> -0.619987).  Saving model ...
Epoch: 26 cost time: 6.999197006225586
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.306 Vali Acc: 0.613 Test Loss: 1.306 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.519851446151733
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.300 Vali Acc: 0.617 Test Loss: 1.300 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.400838136672974
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.613 Test Loss: 1.296 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.8739118576049805
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.289 Vali Acc: 0.627 Test Loss: 1.289 Test Acc: 0.627
Validation loss decreased (-0.619987 --> -0.626654).  Saving model ...
Epoch: 30 cost time: 7.653455495834351
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.286 Vali Acc: 0.623 Test Loss: 1.286 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 7.769595623016357
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.281 Vali Acc: 0.627 Test Loss: 1.281 Test Acc: 0.627
Validation loss decreased (-0.626654 --> -0.626654).  Saving model ...
Epoch: 32 cost time: 7.243817090988159
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.274 Vali Acc: 0.627 Test Loss: 1.274 Test Acc: 0.627
Validation loss decreased (-0.626654 --> -0.626654).  Saving model ...
Epoch: 33 cost time: 7.305762052536011
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.268 Vali Acc: 0.627 Test Loss: 1.268 Test Acc: 0.627
Validation loss decreased (-0.626654 --> -0.626654).  Saving model ...
Epoch: 34 cost time: 7.113412857055664
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.630 Test Loss: 1.266 Test Acc: 0.630
Validation loss decreased (-0.626654 --> -0.629987).  Saving model ...
Epoch: 35 cost time: 7.435740232467651
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.643 Test Loss: 1.264 Test Acc: 0.643
Validation loss decreased (-0.629987 --> -0.643321).  Saving model ...
Epoch: 36 cost time: 6.8384246826171875
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.643 Test Loss: 1.262 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 37 cost time: 6.94153904914856
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.637 Test Loss: 1.259 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 7.5926384925842285
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.637 Test Loss: 1.258 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 7.430948257446289
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.647 Test Loss: 1.256 Test Acc: 0.647
Validation loss decreased (-0.643321 --> -0.646654).  Saving model ...
Epoch: 40 cost time: 7.399025201797485
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.640 Test Loss: 1.258 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 7.466125249862671
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.643 Test Loss: 1.255 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 7.36742639541626
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.647 Test Loss: 1.250 Test Acc: 0.647
Validation loss decreased (-0.646654 --> -0.646654).  Saving model ...
Epoch: 43 cost time: 7.467613935470581
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.643 Test Loss: 1.248 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 7.537311792373657
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.640 Test Loss: 1.242 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 7.531153440475464
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.643 Test Loss: 1.239 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 6.93227481842041
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.237 Vali Acc: 0.640 Test Loss: 1.237 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 7.078324556350708
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.237 Vali Acc: 0.653 Test Loss: 1.237 Test Acc: 0.653
Validation loss decreased (-0.646654 --> -0.653321).  Saving model ...
Epoch: 48 cost time: 7.389806747436523
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.653 Test Loss: 1.238 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 7.220952749252319
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.660 Test Loss: 1.235 Test Acc: 0.660
Validation loss decreased (-0.653321 --> -0.659988).  Saving model ...
Epoch: 50 cost time: 7.108486890792847
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.653 Test Loss: 1.236 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 7.506791830062866
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.653 Test Loss: 1.235 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 7.5194411277771
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.660 Test Loss: 1.232 Test Acc: 0.660
Validation loss decreased (-0.659988 --> -0.659988).  Saving model ...
Epoch: 53 cost time: 7.687260866165161
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.663 Test Loss: 1.230 Test Acc: 0.663
Validation loss decreased (-0.659988 --> -0.663321).  Saving model ...
Epoch: 54 cost time: 8.126517534255981
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.663 Test Loss: 1.227 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 55 cost time: 7.910104513168335
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.663 Test Loss: 1.227 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 7.358280658721924
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.663 Test Loss: 1.227 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 57 cost time: 7.391777992248535
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.663 Test Loss: 1.226 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 58 cost time: 7.019532918930054
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.660 Test Loss: 1.227 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 7.187763690948486
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.657 Test Loss: 1.229 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 7.564603805541992
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.653 Test Loss: 1.227 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 7.279053449630737
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.657 Test Loss: 1.224 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 7.289046764373779
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.657 Test Loss: 1.224 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 7.4598565101623535
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.653 Test Loss: 1.223 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 7.508348703384399
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.657 Test Loss: 1.223 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 7.830632209777832
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.657 Test Loss: 1.221 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 7.66264533996582
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.663 Test Loss: 1.216 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 67 cost time: 7.653933048248291
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.660 Test Loss: 1.213 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 7.513010740280151
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.660 Test Loss: 1.212 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 7.68818998336792
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.660 Test Loss: 1.209 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 7.306984186172485
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.660 Test Loss: 1.210 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 7.5537989139556885
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.660 Test Loss: 1.208 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 7.503880023956299
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.663 Test Loss: 1.209 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 73 cost time: 7.407554388046265
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.663 Test Loss: 1.210 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 7.439020872116089
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.660 Test Loss: 1.213 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 7.263779640197754
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.660 Test Loss: 1.212 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 7.923370838165283
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.663 Test Loss: 1.212 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 7.2983925342559814
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.663 Test Loss: 1.213 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 7.800770998001099
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.670 Test Loss: 1.212 Test Acc: 0.670
Validation loss decreased (-0.663321 --> -0.669988).  Saving model ...
Epoch: 79 cost time: 7.726083993911743
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.667 Test Loss: 1.210 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 8.01657772064209
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.667 Test Loss: 1.210 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 7.72221302986145
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.663 Test Loss: 1.211 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 7.341545581817627
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.660 Test Loss: 1.210 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 7.12541127204895
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.660 Test Loss: 1.207 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 7.2191948890686035
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.667 Test Loss: 1.208 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 6.961802959442139
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.673 Test Loss: 1.206 Test Acc: 0.673
Validation loss decreased (-0.669988 --> -0.673321).  Saving model ...
Epoch: 86 cost time: 7.153290748596191
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.673 Test Loss: 1.203 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 87 cost time: 6.943835735321045
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.673 Test Loss: 1.203 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 88 cost time: 7.252562522888184
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.670 Test Loss: 1.204 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 7.184448480606079
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.673 Test Loss: 1.203 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 90 cost time: 7.255695581436157
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.673 Test Loss: 1.203 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 7.265038728713989
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.667 Test Loss: 1.203 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 7.0240631103515625
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.667 Test Loss: 1.202 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 7.345311641693115
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.673 Test Loss: 1.202 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 94 cost time: 6.921074151992798
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.680 Test Loss: 1.202 Test Acc: 0.680
Validation loss decreased (-0.673321 --> -0.679988).  Saving model ...
Epoch: 95 cost time: 6.987576961517334
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.677 Test Loss: 1.202 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 7.355113983154297
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.677 Test Loss: 1.202 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 7.703522205352783
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.677 Test Loss: 1.202 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 8.112461805343628
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.677 Test Loss: 1.202 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 8.583659172058105
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.680 Test Loss: 1.201 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 100 cost time: 8.265000820159912
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.680 Test Loss: 1.202 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.68
model parameter : 1322521
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.584599256515503
Epoch: 1, Steps: 18 | Train Loss: 3.325 Vali Loss: 3.136 Vali Acc: 0.073 Test Loss: 3.136 Test Acc: 0.073
Validation loss decreased (inf --> -0.073302).  Saving model ...
Epoch: 2 cost time: 7.609384298324585
Epoch: 2, Steps: 18 | Train Loss: 2.790 Vali Loss: 2.896 Vali Acc: 0.223 Test Loss: 2.896 Test Acc: 0.223
Validation loss decreased (-0.073302 --> -0.223304).  Saving model ...
Epoch: 3 cost time: 6.9978063106536865
Epoch: 3, Steps: 18 | Train Loss: 1.986 Vali Loss: 2.632 Vali Acc: 0.297 Test Loss: 2.632 Test Acc: 0.297
Validation loss decreased (-0.223304 --> -0.296640).  Saving model ...
Epoch: 4 cost time: 7.05719518661499
Epoch: 4, Steps: 18 | Train Loss: 1.105 Vali Loss: 2.410 Vali Acc: 0.373 Test Loss: 2.410 Test Acc: 0.373
Validation loss decreased (-0.296640 --> -0.373309).  Saving model ...
Epoch: 5 cost time: 7.115093231201172
Epoch: 5, Steps: 18 | Train Loss: 0.538 Vali Loss: 2.277 Vali Acc: 0.370 Test Loss: 2.277 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.737789869308472
Epoch: 6, Steps: 18 | Train Loss: 0.179 Vali Loss: 2.182 Vali Acc: 0.343 Test Loss: 2.182 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.590257883071899
Epoch: 7, Steps: 18 | Train Loss: 0.056 Vali Loss: 2.017 Vali Acc: 0.393 Test Loss: 2.017 Test Acc: 0.393
Validation loss decreased (-0.373309 --> -0.393313).  Saving model ...
Epoch: 8 cost time: 7.34201717376709
Epoch: 8, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.909 Vali Acc: 0.430 Test Loss: 1.909 Test Acc: 0.430
Validation loss decreased (-0.393313 --> -0.429981).  Saving model ...
Epoch: 9 cost time: 7.105882167816162
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.854 Vali Acc: 0.417 Test Loss: 1.854 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.240276575088501
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.801 Vali Acc: 0.443 Test Loss: 1.801 Test Acc: 0.443
Validation loss decreased (-0.429981 --> -0.443315).  Saving model ...
Epoch: 11 cost time: 7.016438007354736
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.775 Vali Acc: 0.460 Test Loss: 1.775 Test Acc: 0.460
Validation loss decreased (-0.443315 --> -0.459982).  Saving model ...
Epoch: 12 cost time: 7.146996259689331
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.750 Vali Acc: 0.460 Test Loss: 1.750 Test Acc: 0.460
Validation loss decreased (-0.459982 --> -0.459982).  Saving model ...
Epoch: 13 cost time: 7.0280961990356445
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.721 Vali Acc: 0.490 Test Loss: 1.721 Test Acc: 0.490
Validation loss decreased (-0.459982 --> -0.489983).  Saving model ...
Epoch: 14 cost time: 7.015780925750732
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.688 Vali Acc: 0.487 Test Loss: 1.688 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.64845871925354
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.661 Vali Acc: 0.520 Test Loss: 1.661 Test Acc: 0.520
Validation loss decreased (-0.489983 --> -0.519983).  Saving model ...
Epoch: 16 cost time: 6.889224529266357
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.638 Vali Acc: 0.517 Test Loss: 1.638 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.78879189491272
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.628 Vali Acc: 0.513 Test Loss: 1.628 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.991986513137817
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.614 Vali Acc: 0.523 Test Loss: 1.614 Test Acc: 0.523
Validation loss decreased (-0.519983 --> -0.523317).  Saving model ...
Epoch: 19 cost time: 6.70182728767395
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.592 Vali Acc: 0.533 Test Loss: 1.592 Test Acc: 0.533
Validation loss decreased (-0.523317 --> -0.533317).  Saving model ...
Epoch: 20 cost time: 7.582245826721191
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.575 Vali Acc: 0.540 Test Loss: 1.575 Test Acc: 0.540
Validation loss decreased (-0.533317 --> -0.539984).  Saving model ...
Epoch: 21 cost time: 7.453181266784668
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.570 Vali Acc: 0.540 Test Loss: 1.570 Test Acc: 0.540
Validation loss decreased (-0.539984 --> -0.539984).  Saving model ...
Epoch: 22 cost time: 8.086845636367798
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.550 Vali Acc: 0.543 Test Loss: 1.550 Test Acc: 0.543
Validation loss decreased (-0.539984 --> -0.543318).  Saving model ...
Epoch: 23 cost time: 8.245115756988525
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.529 Vali Acc: 0.553 Test Loss: 1.529 Test Acc: 0.553
Validation loss decreased (-0.543318 --> -0.553318).  Saving model ...
Epoch: 24 cost time: 7.813934326171875
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.527 Vali Acc: 0.560 Test Loss: 1.527 Test Acc: 0.560
Validation loss decreased (-0.553318 --> -0.559985).  Saving model ...
Epoch: 25 cost time: 8.05587363243103
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.518 Vali Acc: 0.573 Test Loss: 1.518 Test Acc: 0.573
Validation loss decreased (-0.559985 --> -0.573318).  Saving model ...
Epoch: 26 cost time: 7.385598659515381
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.505 Vali Acc: 0.573 Test Loss: 1.505 Test Acc: 0.573
Validation loss decreased (-0.573318 --> -0.573318).  Saving model ...
Epoch: 27 cost time: 7.256432771682739
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.496 Vali Acc: 0.573 Test Loss: 1.496 Test Acc: 0.573
Validation loss decreased (-0.573318 --> -0.573318).  Saving model ...
Epoch: 28 cost time: 7.451639175415039
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.492 Vali Acc: 0.580 Test Loss: 1.492 Test Acc: 0.580
Validation loss decreased (-0.573318 --> -0.579985).  Saving model ...
Epoch: 29 cost time: 8.061281442642212
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.482 Vali Acc: 0.597 Test Loss: 1.482 Test Acc: 0.597
Validation loss decreased (-0.579985 --> -0.596652).  Saving model ...
Epoch: 30 cost time: 7.98855185508728
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.473 Vali Acc: 0.607 Test Loss: 1.473 Test Acc: 0.607
Validation loss decreased (-0.596652 --> -0.606652).  Saving model ...
Epoch: 31 cost time: 8.287474155426025
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.466 Vali Acc: 0.610 Test Loss: 1.466 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609985).  Saving model ...
Epoch: 32 cost time: 7.801672697067261
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.457 Vali Acc: 0.613 Test Loss: 1.457 Test Acc: 0.613
Validation loss decreased (-0.609985 --> -0.613319).  Saving model ...
Epoch: 33 cost time: 8.046585321426392
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.455 Vali Acc: 0.603 Test Loss: 1.455 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 7.451870679855347
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.451 Vali Acc: 0.610 Test Loss: 1.451 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 7.7131078243255615
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.447 Vali Acc: 0.607 Test Loss: 1.447 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 7.78533148765564
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.441 Vali Acc: 0.610 Test Loss: 1.441 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 7.191409587860107
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.617 Test Loss: 1.438 Test Acc: 0.617
Validation loss decreased (-0.613319 --> -0.616652).  Saving model ...
Epoch: 38 cost time: 7.436094760894775
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.617 Test Loss: 1.434 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 39 cost time: 7.790933609008789
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.620 Test Loss: 1.427 Test Acc: 0.620
Validation loss decreased (-0.616652 --> -0.619986).  Saving model ...
Epoch: 40 cost time: 7.7196526527404785
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.617 Test Loss: 1.428 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 8.029290914535522
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.617 Test Loss: 1.423 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 8.183403015136719
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.633 Test Loss: 1.419 Test Acc: 0.633
Validation loss decreased (-0.619986 --> -0.633319).  Saving model ...
Epoch: 43 cost time: 7.911916732788086
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.630 Test Loss: 1.415 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 7.048985481262207
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.637 Test Loss: 1.408 Test Acc: 0.637
Validation loss decreased (-0.633319 --> -0.636653).  Saving model ...
Epoch: 45 cost time: 7.557271242141724
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.402 Vali Acc: 0.633 Test Loss: 1.402 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 7.086526393890381
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.637 Test Loss: 1.401 Test Acc: 0.637
Validation loss decreased (-0.636653 --> -0.636653).  Saving model ...
Epoch: 47 cost time: 7.040517330169678
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.633 Test Loss: 1.405 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 7.497331619262695
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.633 Test Loss: 1.403 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 7.860742568969727
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.633 Test Loss: 1.398 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 7.675953149795532
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.643 Test Loss: 1.388 Test Acc: 0.643
Validation loss decreased (-0.636653 --> -0.643319).  Saving model ...
Epoch: 51 cost time: 7.499911308288574
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.637 Test Loss: 1.386 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 8.34051251411438
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.637 Test Loss: 1.386 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 7.6928582191467285
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.637 Test Loss: 1.385 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 7.433236837387085
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.643 Test Loss: 1.381 Test Acc: 0.643
Validation loss decreased (-0.643319 --> -0.643320).  Saving model ...
Epoch: 55 cost time: 7.147715091705322
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.640 Test Loss: 1.377 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 7.344691038131714
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.643 Test Loss: 1.374 Test Acc: 0.643
Validation loss decreased (-0.643320 --> -0.643320).  Saving model ...
Epoch: 57 cost time: 7.448010206222534
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.650 Test Loss: 1.372 Test Acc: 0.650
Validation loss decreased (-0.643320 --> -0.649986).  Saving model ...
Epoch: 58 cost time: 7.029115200042725
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.643 Test Loss: 1.377 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 7.608910799026489
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.640 Test Loss: 1.380 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 7.953312158584595
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.653 Test Loss: 1.376 Test Acc: 0.653
Validation loss decreased (-0.649986 --> -0.653320).  Saving model ...
Epoch: 61 cost time: 8.617346286773682
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.650 Test Loss: 1.369 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 8.00169849395752
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.660 Test Loss: 1.365 Test Acc: 0.660
Validation loss decreased (-0.653320 --> -0.659986).  Saving model ...
Epoch: 63 cost time: 8.021304607391357
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.362 Vali Acc: 0.667 Test Loss: 1.362 Test Acc: 0.667
Validation loss decreased (-0.659986 --> -0.666653).  Saving model ...
Epoch: 64 cost time: 7.5889246463775635
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.362 Vali Acc: 0.650 Test Loss: 1.362 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 7.285283088684082
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.650 Test Loss: 1.361 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 6.996663808822632
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.650 Test Loss: 1.358 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 7.63762640953064
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.653 Test Loss: 1.356 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 7.624229669570923
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.657 Test Loss: 1.352 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 8.255152702331543
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.663 Test Loss: 1.350 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 7.571281909942627
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.663 Test Loss: 1.350 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 7.593922138214111
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.663 Test Loss: 1.349 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 7.8232197761535645
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.660 Test Loss: 1.349 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 7.783378839492798
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.660 Test Loss: 1.346 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6666666666666666
model parameter : 1322521
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.371625900268555
Epoch: 1, Steps: 18 | Train Loss: 3.333 Vali Loss: 3.204 Vali Acc: 0.047 Test Loss: 3.204 Test Acc: 0.047
Validation loss decreased (inf --> -0.046635).  Saving model ...
Epoch: 2 cost time: 6.830036640167236
Epoch: 2, Steps: 18 | Train Loss: 2.799 Vali Loss: 3.045 Vali Acc: 0.133 Test Loss: 3.045 Test Acc: 0.133
Validation loss decreased (-0.046635 --> -0.133303).  Saving model ...
Epoch: 3 cost time: 6.715127229690552
Epoch: 3, Steps: 18 | Train Loss: 2.032 Vali Loss: 2.882 Vali Acc: 0.153 Test Loss: 2.882 Test Acc: 0.153
Validation loss decreased (-0.133303 --> -0.153305).  Saving model ...
Epoch: 4 cost time: 6.590011358261108
Epoch: 4, Steps: 18 | Train Loss: 1.209 Vali Loss: 2.773 Vali Acc: 0.160 Test Loss: 2.773 Test Acc: 0.160
Validation loss decreased (-0.153305 --> -0.159972).  Saving model ...
Epoch: 5 cost time: 7.287738800048828
Epoch: 5, Steps: 18 | Train Loss: 0.587 Vali Loss: 2.651 Vali Acc: 0.190 Test Loss: 2.651 Test Acc: 0.190
Validation loss decreased (-0.159972 --> -0.189973).  Saving model ...
Epoch: 6 cost time: 6.988273620605469
Epoch: 6, Steps: 18 | Train Loss: 0.229 Vali Loss: 2.579 Vali Acc: 0.220 Test Loss: 2.579 Test Acc: 0.220
Validation loss decreased (-0.189973 --> -0.219974).  Saving model ...
Epoch: 7 cost time: 7.037804841995239
Epoch: 7, Steps: 18 | Train Loss: 0.072 Vali Loss: 2.375 Vali Acc: 0.293 Test Loss: 2.375 Test Acc: 0.293
Validation loss decreased (-0.219974 --> -0.293310).  Saving model ...
Epoch: 8 cost time: 7.859488487243652
Epoch: 8, Steps: 18 | Train Loss: 0.036 Vali Loss: 2.279 Vali Acc: 0.307 Test Loss: 2.279 Test Acc: 0.307
Validation loss decreased (-0.293310 --> -0.306644).  Saving model ...
Epoch: 9 cost time: 7.4455084800720215
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 2.201 Vali Acc: 0.307 Test Loss: 2.201 Test Acc: 0.307
Validation loss decreased (-0.306644 --> -0.306645).  Saving model ...
Epoch: 10 cost time: 7.374556541442871
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.110 Vali Acc: 0.353 Test Loss: 2.110 Test Acc: 0.353
Validation loss decreased (-0.306645 --> -0.353312).  Saving model ...
Epoch: 11 cost time: 6.954864263534546
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.061 Vali Acc: 0.350 Test Loss: 2.061 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.013930559158325
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.055 Vali Acc: 0.357 Test Loss: 2.055 Test Acc: 0.357
Validation loss decreased (-0.353312 --> -0.356646).  Saving model ...
Epoch: 13 cost time: 7.061011075973511
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.983 Vali Acc: 0.383 Test Loss: 1.983 Test Acc: 0.383
Validation loss decreased (-0.356646 --> -0.383314).  Saving model ...
Epoch: 14 cost time: 7.416531324386597
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.920 Vali Acc: 0.413 Test Loss: 1.920 Test Acc: 0.413
Validation loss decreased (-0.383314 --> -0.413314).  Saving model ...
Epoch: 15 cost time: 7.42998480796814
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.874 Vali Acc: 0.437 Test Loss: 1.874 Test Acc: 0.437
Validation loss decreased (-0.413314 --> -0.436648).  Saving model ...
Epoch: 16 cost time: 7.47428297996521
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.853 Vali Acc: 0.437 Test Loss: 1.853 Test Acc: 0.437
Validation loss decreased (-0.436648 --> -0.436648).  Saving model ...
Epoch: 17 cost time: 7.412167310714722
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.825 Vali Acc: 0.450 Test Loss: 1.825 Test Acc: 0.450
Validation loss decreased (-0.436648 --> -0.449982).  Saving model ...
Epoch: 18 cost time: 7.569050312042236
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.790 Vali Acc: 0.447 Test Loss: 1.790 Test Acc: 0.447
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.7012505531311035
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.771 Vali Acc: 0.467 Test Loss: 1.771 Test Acc: 0.467
Validation loss decreased (-0.449982 --> -0.466649).  Saving model ...
Epoch: 20 cost time: 7.519796371459961
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.751 Vali Acc: 0.483 Test Loss: 1.751 Test Acc: 0.483
Validation loss decreased (-0.466649 --> -0.483316).  Saving model ...
Epoch: 21 cost time: 7.5295515060424805
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.731 Vali Acc: 0.483 Test Loss: 1.731 Test Acc: 0.483
Validation loss decreased (-0.483316 --> -0.483316).  Saving model ...
Epoch: 22 cost time: 7.3025290966033936
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.707 Vali Acc: 0.500 Test Loss: 1.707 Test Acc: 0.500
Validation loss decreased (-0.483316 --> -0.499983).  Saving model ...
Epoch: 23 cost time: 7.041668891906738
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.682 Vali Acc: 0.500 Test Loss: 1.682 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499983).  Saving model ...
Epoch: 24 cost time: 7.266632318496704
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.664 Vali Acc: 0.527 Test Loss: 1.664 Test Acc: 0.527
Validation loss decreased (-0.499983 --> -0.526650).  Saving model ...
Epoch: 25 cost time: 6.8558876514434814
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.655 Vali Acc: 0.530 Test Loss: 1.655 Test Acc: 0.530
Validation loss decreased (-0.526650 --> -0.529983).  Saving model ...
Epoch: 26 cost time: 7.296377182006836
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.635 Vali Acc: 0.540 Test Loss: 1.635 Test Acc: 0.540
Validation loss decreased (-0.529983 --> -0.539984).  Saving model ...
Epoch: 27 cost time: 7.535617828369141
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.537 Test Loss: 1.633 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.840892791748047
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.622 Vali Acc: 0.547 Test Loss: 1.622 Test Acc: 0.547
Validation loss decreased (-0.539984 --> -0.546650).  Saving model ...
Epoch: 29 cost time: 6.977128505706787
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.598 Vali Acc: 0.550 Test Loss: 1.598 Test Acc: 0.550
Validation loss decreased (-0.546650 --> -0.549984).  Saving model ...
Epoch: 30 cost time: 7.573476791381836
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.579 Vali Acc: 0.570 Test Loss: 1.579 Test Acc: 0.570
Validation loss decreased (-0.549984 --> -0.569984).  Saving model ...
Epoch: 31 cost time: 7.107715368270874
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.570 Vali Acc: 0.570 Test Loss: 1.570 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 32 cost time: 6.983164072036743
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.556 Vali Acc: 0.577 Test Loss: 1.556 Test Acc: 0.577
Validation loss decreased (-0.569984 --> -0.576651).  Saving model ...
Epoch: 33 cost time: 7.332599639892578
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.583 Test Loss: 1.551 Test Acc: 0.583
Validation loss decreased (-0.576651 --> -0.583318).  Saving model ...
Epoch: 34 cost time: 6.635181665420532
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.545 Vali Acc: 0.587 Test Loss: 1.545 Test Acc: 0.587
Validation loss decreased (-0.583318 --> -0.586651).  Saving model ...
Epoch: 35 cost time: 7.677070379257202
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.536 Vali Acc: 0.587 Test Loss: 1.536 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 36 cost time: 7.688574314117432
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.587 Test Loss: 1.527 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 37 cost time: 7.0768723487854
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.593 Test Loss: 1.521 Test Acc: 0.593
Validation loss decreased (-0.586651 --> -0.593318).  Saving model ...
Epoch: 38 cost time: 6.928714275360107
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.607 Test Loss: 1.513 Test Acc: 0.607
Validation loss decreased (-0.593318 --> -0.606652).  Saving model ...
Epoch: 39 cost time: 7.447767972946167
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.502 Vali Acc: 0.607 Test Loss: 1.502 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 40 cost time: 7.3763158321380615
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.617 Test Loss: 1.496 Test Acc: 0.617
Validation loss decreased (-0.606652 --> -0.616652).  Saving model ...
Epoch: 41 cost time: 7.173325300216675
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.620 Test Loss: 1.492 Test Acc: 0.620
Validation loss decreased (-0.616652 --> -0.619985).  Saving model ...
Epoch: 42 cost time: 6.831762790679932
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.613 Test Loss: 1.482 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 7.302294969558716
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.617 Test Loss: 1.472 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 6.979869604110718
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.620 Test Loss: 1.464 Test Acc: 0.620
Validation loss decreased (-0.619985 --> -0.619985).  Saving model ...
Epoch: 45 cost time: 6.684060096740723
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.623 Test Loss: 1.456 Test Acc: 0.623
Validation loss decreased (-0.619985 --> -0.623319).  Saving model ...
Epoch: 46 cost time: 7.1701860427856445
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.620 Test Loss: 1.451 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.743038177490234
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.627 Test Loss: 1.454 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626652).  Saving model ...
Epoch: 48 cost time: 6.988143682479858
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.627 Test Loss: 1.450 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 49 cost time: 7.5475733280181885
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.623 Test Loss: 1.445 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 7.269592761993408
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.627 Test Loss: 1.437 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 51 cost time: 6.934404134750366
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.623 Test Loss: 1.433 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 7.36702299118042
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.627 Test Loss: 1.431 Test Acc: 0.627
Validation loss decreased (-0.626652 --> -0.626652).  Saving model ...
Epoch: 53 cost time: 7.0106635093688965
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.630 Test Loss: 1.427 Test Acc: 0.630
Validation loss decreased (-0.626652 --> -0.629986).  Saving model ...
Epoch: 54 cost time: 6.619204998016357
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.637 Test Loss: 1.425 Test Acc: 0.637
Validation loss decreased (-0.629986 --> -0.636652).  Saving model ...
Epoch: 55 cost time: 7.061488389968872
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.640 Test Loss: 1.416 Test Acc: 0.640
Validation loss decreased (-0.636652 --> -0.639986).  Saving model ...
Epoch: 56 cost time: 6.980829477310181
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.633 Test Loss: 1.412 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.7675395011901855
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.633 Test Loss: 1.409 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 7.340738534927368
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.637 Test Loss: 1.408 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 7.194262504577637
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.633 Test Loss: 1.405 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 7.555525302886963
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.402 Vali Acc: 0.640 Test Loss: 1.402 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 61 cost time: 7.3986265659332275
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.640 Test Loss: 1.399 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 62 cost time: 7.0927019119262695
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.640 Test Loss: 1.395 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 63 cost time: 7.238801002502441
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.640 Test Loss: 1.390 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639986).  Saving model ...
Epoch: 64 cost time: 7.08640456199646
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.637 Test Loss: 1.391 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 6.84018611907959
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.637 Test Loss: 1.388 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 6.902966737747192
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.637 Test Loss: 1.385 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 7.287959575653076
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.650 Test Loss: 1.381 Test Acc: 0.650
Validation loss decreased (-0.639986 --> -0.649986).  Saving model ...
Epoch: 68 cost time: 7.740496873855591
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.379 Vali Acc: 0.647 Test Loss: 1.379 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 7.40266752243042
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.378 Vali Acc: 0.647 Test Loss: 1.378 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 6.9859654903411865
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.647 Test Loss: 1.377 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 7.644646883010864
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.375 Vali Acc: 0.643 Test Loss: 1.375 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 7.226767063140869
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.643 Test Loss: 1.372 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 7.380748271942139
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.643 Test Loss: 1.370 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 6.928555011749268
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.647 Test Loss: 1.372 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 6.807214021682739
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.647 Test Loss: 1.371 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 6.875457525253296
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.653 Test Loss: 1.369 Test Acc: 0.653
Validation loss decreased (-0.649986 --> -0.653320).  Saving model ...
Epoch: 77 cost time: 7.0577263832092285
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.653 Test Loss: 1.370 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 7.419105768203735
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.650 Test Loss: 1.367 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 7.37943959236145
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.653 Test Loss: 1.363 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 80 cost time: 6.89795446395874
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.657 Test Loss: 1.361 Test Acc: 0.657
Validation loss decreased (-0.653320 --> -0.656653).  Saving model ...
Epoch: 81 cost time: 7.125161409378052
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.657 Test Loss: 1.359 Test Acc: 0.657
Validation loss decreased (-0.656653 --> -0.656653).  Saving model ...
Epoch: 82 cost time: 7.465616941452026
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.657 Test Loss: 1.356 Test Acc: 0.657
Validation loss decreased (-0.656653 --> -0.656653).  Saving model ...
Epoch: 83 cost time: 6.883755683898926
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.663 Test Loss: 1.354 Test Acc: 0.663
Validation loss decreased (-0.656653 --> -0.663320).  Saving model ...
Epoch: 84 cost time: 6.6806511878967285
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.663 Test Loss: 1.354 Test Acc: 0.663
Validation loss decreased (-0.663320 --> -0.663320).  Saving model ...
Epoch: 85 cost time: 6.763838291168213
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.660 Test Loss: 1.353 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 6.615245819091797
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.650 Test Loss: 1.352 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 7.335801362991333
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.660 Test Loss: 1.348 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 7.386294364929199
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.663 Test Loss: 1.346 Test Acc: 0.663
Validation loss decreased (-0.663320 --> -0.663320).  Saving model ...
Epoch: 89 cost time: 7.388450860977173
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.667 Test Loss: 1.344 Test Acc: 0.667
Validation loss decreased (-0.663320 --> -0.666653).  Saving model ...
Epoch: 90 cost time: 7.6173622608184814
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.663 Test Loss: 1.344 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 7.457817316055298
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.663 Test Loss: 1.343 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 7.7371602058410645
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.663 Test Loss: 1.341 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 7.668460130691528
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.663 Test Loss: 1.340 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 6.927694797515869
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.663 Test Loss: 1.336 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 7.233764171600342
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.663 Test Loss: 1.335 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 7.460395812988281
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.667 Test Loss: 1.333 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
Epoch: 97 cost time: 7.280755043029785
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.667 Test Loss: 1.332 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
Epoch: 98 cost time: 7.514102458953857
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.667 Test Loss: 1.332 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 7.713064670562744
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.331 Vali Acc: 0.663 Test Loss: 1.331 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 7.537869691848755
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.330 Vali Acc: 0.667 Test Loss: 1.330 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6666666666666666
model parameter : 1322521
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.022579669952393
Epoch: 1, Steps: 18 | Train Loss: 3.292 Vali Loss: 3.216 Vali Acc: 0.070 Test Loss: 3.216 Test Acc: 0.070
Validation loss decreased (inf --> -0.069968).  Saving model ...
Epoch: 2 cost time: 7.604292631149292
Epoch: 2, Steps: 18 | Train Loss: 2.836 Vali Loss: 3.053 Vali Acc: 0.110 Test Loss: 3.053 Test Acc: 0.110
Validation loss decreased (-0.069968 --> -0.109969).  Saving model ...
Epoch: 3 cost time: 7.408019065856934
Epoch: 3, Steps: 18 | Train Loss: 2.183 Vali Loss: 2.884 Vali Acc: 0.137 Test Loss: 2.884 Test Acc: 0.137
Validation loss decreased (-0.109969 --> -0.136638).  Saving model ...
Epoch: 4 cost time: 7.1253907680511475
Epoch: 4, Steps: 18 | Train Loss: 1.391 Vali Loss: 2.763 Vali Acc: 0.157 Test Loss: 2.763 Test Acc: 0.157
Validation loss decreased (-0.136638 --> -0.156639).  Saving model ...
Epoch: 5 cost time: 7.15002703666687
Epoch: 5, Steps: 18 | Train Loss: 0.792 Vali Loss: 2.599 Vali Acc: 0.187 Test Loss: 2.599 Test Acc: 0.187
Validation loss decreased (-0.156639 --> -0.186641).  Saving model ...
Epoch: 6 cost time: 7.503412961959839
Epoch: 6, Steps: 18 | Train Loss: 0.340 Vali Loss: 2.508 Vali Acc: 0.243 Test Loss: 2.508 Test Acc: 0.243
Validation loss decreased (-0.186641 --> -0.243308).  Saving model ...
Epoch: 7 cost time: 7.409021377563477
Epoch: 7, Steps: 18 | Train Loss: 0.134 Vali Loss: 2.305 Vali Acc: 0.300 Test Loss: 2.305 Test Acc: 0.300
Validation loss decreased (-0.243308 --> -0.299977).  Saving model ...
Epoch: 8 cost time: 7.597499132156372
Epoch: 8, Steps: 18 | Train Loss: 0.057 Vali Loss: 2.085 Vali Acc: 0.357 Test Loss: 2.085 Test Acc: 0.357
Validation loss decreased (-0.299977 --> -0.356646).  Saving model ...
Epoch: 9 cost time: 7.374172210693359
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.994 Vali Acc: 0.403 Test Loss: 1.994 Test Acc: 0.403
Validation loss decreased (-0.356646 --> -0.403313).  Saving model ...
Epoch: 10 cost time: 7.903836727142334
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.890 Vali Acc: 0.420 Test Loss: 1.890 Test Acc: 0.420
Validation loss decreased (-0.403313 --> -0.419981).  Saving model ...
Epoch: 11 cost time: 7.491037368774414
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.821 Vali Acc: 0.453 Test Loss: 1.821 Test Acc: 0.453
Validation loss decreased (-0.419981 --> -0.453315).  Saving model ...
Epoch: 12 cost time: 7.478676080703735
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.793 Vali Acc: 0.460 Test Loss: 1.793 Test Acc: 0.460
Validation loss decreased (-0.453315 --> -0.459982).  Saving model ...
Epoch: 13 cost time: 7.319728374481201
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.767 Vali Acc: 0.457 Test Loss: 1.767 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.746737241744995
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.709 Vali Acc: 0.480 Test Loss: 1.709 Test Acc: 0.480
Validation loss decreased (-0.459982 --> -0.479983).  Saving model ...
Epoch: 15 cost time: 8.032410383224487
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.675 Vali Acc: 0.497 Test Loss: 1.675 Test Acc: 0.497
Validation loss decreased (-0.479983 --> -0.496650).  Saving model ...
Epoch: 16 cost time: 8.571317195892334
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.635 Vali Acc: 0.517 Test Loss: 1.635 Test Acc: 0.517
Validation loss decreased (-0.496650 --> -0.516650).  Saving model ...
Epoch: 17 cost time: 8.196081399917603
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.618 Vali Acc: 0.507 Test Loss: 1.618 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.011550426483154
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.600 Vali Acc: 0.530 Test Loss: 1.600 Test Acc: 0.530
Validation loss decreased (-0.516650 --> -0.529984).  Saving model ...
Epoch: 19 cost time: 7.431291580200195
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.568 Vali Acc: 0.553 Test Loss: 1.568 Test Acc: 0.553
Validation loss decreased (-0.529984 --> -0.553318).  Saving model ...
Epoch: 20 cost time: 7.712399244308472
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.548 Vali Acc: 0.547 Test Loss: 1.548 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.733570337295532
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.542 Vali Acc: 0.543 Test Loss: 1.542 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.7823145389556885
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.534 Vali Acc: 0.543 Test Loss: 1.534 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 8.050851106643677
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.514 Vali Acc: 0.547 Test Loss: 1.514 Test Acc: 0.547
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 8.080161571502686
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.490 Vali Acc: 0.567 Test Loss: 1.490 Test Acc: 0.567
Validation loss decreased (-0.553318 --> -0.566652).  Saving model ...
Epoch: 25 cost time: 8.012276649475098
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.488 Vali Acc: 0.587 Test Loss: 1.488 Test Acc: 0.587
Validation loss decreased (-0.566652 --> -0.586652).  Saving model ...
Epoch: 26 cost time: 8.456500053405762
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.468 Vali Acc: 0.577 Test Loss: 1.468 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 8.22702169418335
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.451 Vali Acc: 0.593 Test Loss: 1.451 Test Acc: 0.593
Validation loss decreased (-0.586652 --> -0.593319).  Saving model ...
Epoch: 28 cost time: 8.064564943313599
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.438 Vali Acc: 0.610 Test Loss: 1.438 Test Acc: 0.610
Validation loss decreased (-0.593319 --> -0.609986).  Saving model ...
Epoch: 29 cost time: 7.858964920043945
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.427 Vali Acc: 0.593 Test Loss: 1.427 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 7.599525690078735
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.411 Vali Acc: 0.603 Test Loss: 1.411 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 7.3564088344573975
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.401 Vali Acc: 0.610 Test Loss: 1.401 Test Acc: 0.610
Validation loss decreased (-0.609986 --> -0.609986).  Saving model ...
Epoch: 32 cost time: 7.751976490020752
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.393 Vali Acc: 0.623 Test Loss: 1.393 Test Acc: 0.623
Validation loss decreased (-0.609986 --> -0.623319).  Saving model ...
Epoch: 33 cost time: 8.122596025466919
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.393 Vali Acc: 0.627 Test Loss: 1.393 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626653).  Saving model ...
Epoch: 34 cost time: 7.891184568405151
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.393 Vali Acc: 0.630 Test Loss: 1.393 Test Acc: 0.630
Validation loss decreased (-0.626653 --> -0.629986).  Saving model ...
Epoch: 35 cost time: 7.461919546127319
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.640 Test Loss: 1.381 Test Acc: 0.640
Validation loss decreased (-0.629986 --> -0.639986).  Saving model ...
Epoch: 36 cost time: 8.097079038619995
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.369 Vali Acc: 0.633 Test Loss: 1.369 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 7.587092399597168
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.364 Vali Acc: 0.633 Test Loss: 1.364 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 7.176487684249878
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.637 Test Loss: 1.358 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 7.001779794692993
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.627 Test Loss: 1.346 Test Acc: 0.627
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 7.340110778808594
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.640 Test Loss: 1.343 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639987).  Saving model ...
Epoch: 41 cost time: 6.98127555847168
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.633 Test Loss: 1.336 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 7.300388813018799
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.334 Vali Acc: 0.643 Test Loss: 1.334 Test Acc: 0.643
Validation loss decreased (-0.639987 --> -0.643320).  Saving model ...
Epoch: 43 cost time: 7.339388370513916
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.653 Test Loss: 1.327 Test Acc: 0.653
Validation loss decreased (-0.643320 --> -0.653320).  Saving model ...
Epoch: 44 cost time: 7.034603834152222
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.647 Test Loss: 1.319 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 7.111600875854492
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.650 Test Loss: 1.316 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 8.075267553329468
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.653 Test Loss: 1.320 Test Acc: 0.653
Validation loss decreased (-0.653320 --> -0.653320).  Saving model ...
Epoch: 47 cost time: 7.23828387260437
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.667 Test Loss: 1.317 Test Acc: 0.667
Validation loss decreased (-0.653320 --> -0.666654).  Saving model ...
Epoch: 48 cost time: 7.74370265007019
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.667 Test Loss: 1.317 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 7.170006990432739
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.310 Vali Acc: 0.660 Test Loss: 1.310 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 7.250353813171387
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.300 Vali Acc: 0.667 Test Loss: 1.300 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 51 cost time: 6.787782669067383
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.667 Test Loss: 1.297 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 52 cost time: 7.5598509311676025
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.298 Vali Acc: 0.670 Test Loss: 1.298 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669987).  Saving model ...
Epoch: 53 cost time: 7.676620960235596
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.298 Vali Acc: 0.673 Test Loss: 1.298 Test Acc: 0.673
Validation loss decreased (-0.669987 --> -0.673320).  Saving model ...
Epoch: 54 cost time: 7.875669956207275
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.300 Vali Acc: 0.673 Test Loss: 1.300 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 7.379817485809326
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.294 Vali Acc: 0.677 Test Loss: 1.294 Test Acc: 0.677
Validation loss decreased (-0.673320 --> -0.676654).  Saving model ...
Epoch: 56 cost time: 7.601985454559326
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.670 Test Loss: 1.292 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 7.125197887420654
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.289 Vali Acc: 0.677 Test Loss: 1.289 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 58 cost time: 7.26745343208313
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.288 Vali Acc: 0.677 Test Loss: 1.288 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 59 cost time: 7.404794216156006
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.282 Vali Acc: 0.673 Test Loss: 1.282 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 7.388778448104858
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.670 Test Loss: 1.275 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 7.333560228347778
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.673 Test Loss: 1.268 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 7.570013761520386
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.677 Test Loss: 1.263 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 63 cost time: 7.670843839645386
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.261 Vali Acc: 0.677 Test Loss: 1.261 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 64 cost time: 7.780748128890991
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.261 Vali Acc: 0.677 Test Loss: 1.261 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 7.124345779418945
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.673 Test Loss: 1.258 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 7.428211450576782
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.680 Test Loss: 1.253 Test Acc: 0.680
Validation loss decreased (-0.676654 --> -0.679987).  Saving model ...
Epoch: 67 cost time: 7.323016166687012
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.677 Test Loss: 1.258 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 7.258811712265015
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.261 Vali Acc: 0.677 Test Loss: 1.261 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 8.261775255203247
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.680 Test Loss: 1.264 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 7.693124771118164
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.680 Test Loss: 1.264 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 7.609429836273193
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.680 Test Loss: 1.266 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 7.671596050262451
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.683 Test Loss: 1.260 Test Acc: 0.683
Validation loss decreased (-0.679987 --> -0.683321).  Saving model ...
Epoch: 73 cost time: 7.7695677280426025
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.693 Test Loss: 1.259 Test Acc: 0.693
Validation loss decreased (-0.683321 --> -0.693321).  Saving model ...
Epoch: 74 cost time: 7.681244373321533
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.690 Test Loss: 1.268 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 7.373086452484131
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.690 Test Loss: 1.265 Test Acc: 0.690
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 7.71172308921814
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.693 Test Loss: 1.263 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 7.364657640457153
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.693 Test Loss: 1.260 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 6.8442816734313965
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.690 Test Loss: 1.259 Test Acc: 0.690
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 7.693722724914551
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.693 Test Loss: 1.256 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 80 cost time: 7.919187307357788
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.693 Test Loss: 1.254 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 81 cost time: 7.71814489364624
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.693 Test Loss: 1.251 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 82 cost time: 7.193591117858887
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.249 Vali Acc: 0.693 Test Loss: 1.249 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 83 cost time: 7.451426267623901
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.693 Test Loss: 1.245 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 84 cost time: 7.205962181091309
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.693 Test Loss: 1.242 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 85 cost time: 7.371116876602173
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.690 Test Loss: 1.240 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 7.615461349487305
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.690 Test Loss: 1.240 Test Acc: 0.690
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 7.5643839836120605
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.693 Test Loss: 1.238 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 88 cost time: 8.014982223510742
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.690 Test Loss: 1.240 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 8.062337398529053
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.693 Test Loss: 1.240 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 7.432072162628174
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.693 Test Loss: 1.240 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 7.3107404708862305
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.700 Test Loss: 1.233 Test Acc: 0.700
Validation loss decreased (-0.693321 --> -0.699988).  Saving model ...
Epoch: 92 cost time: 7.639504432678223
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.697 Test Loss: 1.233 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 7.469179391860962
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.700 Test Loss: 1.234 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 7.2470784187316895
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.700 Test Loss: 1.236 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 7.3867716789245605
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.700 Test Loss: 1.238 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 6.9638237953186035
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.700 Test Loss: 1.240 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 7.969201326370239
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.693 Test Loss: 1.238 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 98 cost time: 7.394695520401001
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.690 Test Loss: 1.232 Test Acc: 0.690
EarlyStopping counter: 7 out of 10
Epoch: 99 cost time: 7.246061563491821
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.693 Test Loss: 1.232 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 100 cost time: 7.491752862930298
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.697 Test Loss: 1.234 Test Acc: 0.697
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7
model parameter : 1322521
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.234280824661255
Epoch: 1, Steps: 18 | Train Loss: 3.313 Vali Loss: 3.248 Vali Acc: 0.043 Test Loss: 3.248 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 7.077636957168579
Epoch: 2, Steps: 18 | Train Loss: 2.853 Vali Loss: 3.112 Vali Acc: 0.077 Test Loss: 3.112 Test Acc: 0.077
Validation loss decreased (-0.043301 --> -0.076636).  Saving model ...
Epoch: 3 cost time: 7.2160325050354
Epoch: 3, Steps: 18 | Train Loss: 2.235 Vali Loss: 2.953 Vali Acc: 0.127 Test Loss: 2.953 Test Acc: 0.127
Validation loss decreased (-0.076636 --> -0.126637).  Saving model ...
Epoch: 4 cost time: 7.292066812515259
Epoch: 4, Steps: 18 | Train Loss: 1.431 Vali Loss: 2.832 Vali Acc: 0.100 Test Loss: 2.832 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.004024028778076
Epoch: 5, Steps: 18 | Train Loss: 0.844 Vali Loss: 2.662 Vali Acc: 0.200 Test Loss: 2.662 Test Acc: 0.200
Validation loss decreased (-0.126637 --> -0.199973).  Saving model ...
Epoch: 6 cost time: 7.370850086212158
Epoch: 6, Steps: 18 | Train Loss: 0.358 Vali Loss: 2.478 Vali Acc: 0.223 Test Loss: 2.478 Test Acc: 0.223
Validation loss decreased (-0.199973 --> -0.223309).  Saving model ...
Epoch: 7 cost time: 7.618229866027832
Epoch: 7, Steps: 18 | Train Loss: 0.133 Vali Loss: 2.310 Vali Acc: 0.300 Test Loss: 2.310 Test Acc: 0.300
Validation loss decreased (-0.223309 --> -0.299977).  Saving model ...
Epoch: 8 cost time: 7.430140972137451
Epoch: 8, Steps: 18 | Train Loss: 0.052 Vali Loss: 2.057 Vali Acc: 0.337 Test Loss: 2.057 Test Acc: 0.337
Validation loss decreased (-0.299977 --> -0.336646).  Saving model ...
Epoch: 9 cost time: 7.751573801040649
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.915 Vali Acc: 0.397 Test Loss: 1.915 Test Acc: 0.397
Validation loss decreased (-0.336646 --> -0.396648).  Saving model ...
Epoch: 10 cost time: 7.461238861083984
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.834 Vali Acc: 0.420 Test Loss: 1.834 Test Acc: 0.420
Validation loss decreased (-0.396648 --> -0.419982).  Saving model ...
Epoch: 11 cost time: 7.419509410858154
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.796 Vali Acc: 0.437 Test Loss: 1.796 Test Acc: 0.437
Validation loss decreased (-0.419982 --> -0.436649).  Saving model ...
Epoch: 12 cost time: 7.6435253620147705
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.742 Vali Acc: 0.443 Test Loss: 1.742 Test Acc: 0.443
Validation loss decreased (-0.436649 --> -0.443316).  Saving model ...
Epoch: 13 cost time: 7.385793447494507
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.713 Vali Acc: 0.470 Test Loss: 1.713 Test Acc: 0.470
Validation loss decreased (-0.443316 --> -0.469983).  Saving model ...
Epoch: 14 cost time: 7.300304651260376
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.658 Vali Acc: 0.500 Test Loss: 1.658 Test Acc: 0.500
Validation loss decreased (-0.469983 --> -0.499983).  Saving model ...
Epoch: 15 cost time: 7.31637978553772
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.631 Vali Acc: 0.500 Test Loss: 1.631 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499984).  Saving model ...
Epoch: 16 cost time: 6.9852988719940186
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.596 Vali Acc: 0.520 Test Loss: 1.596 Test Acc: 0.520
Validation loss decreased (-0.499984 --> -0.519984).  Saving model ...
Epoch: 17 cost time: 7.22920560836792
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.582 Vali Acc: 0.547 Test Loss: 1.582 Test Acc: 0.547
Validation loss decreased (-0.519984 --> -0.546651).  Saving model ...
Epoch: 18 cost time: 7.288165092468262
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.555 Vali Acc: 0.560 Test Loss: 1.555 Test Acc: 0.560
Validation loss decreased (-0.546651 --> -0.559984).  Saving model ...
Epoch: 19 cost time: 7.601791858673096
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.516 Vali Acc: 0.580 Test Loss: 1.516 Test Acc: 0.580
Validation loss decreased (-0.559984 --> -0.579985).  Saving model ...
Epoch: 20 cost time: 7.317712068557739
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.499 Vali Acc: 0.597 Test Loss: 1.499 Test Acc: 0.597
Validation loss decreased (-0.579985 --> -0.596652).  Saving model ...
Epoch: 21 cost time: 7.831724166870117
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.484 Vali Acc: 0.590 Test Loss: 1.484 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.611009359359741
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.468 Vali Acc: 0.583 Test Loss: 1.468 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.385860204696655
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.451 Vali Acc: 0.583 Test Loss: 1.451 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.948563814163208
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.607 Test Loss: 1.430 Test Acc: 0.607
Validation loss decreased (-0.596652 --> -0.606652).  Saving model ...
Epoch: 25 cost time: 7.669286727905273
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.423 Vali Acc: 0.610 Test Loss: 1.423 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 26 cost time: 7.541836738586426
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.408 Vali Acc: 0.623 Test Loss: 1.408 Test Acc: 0.623
Validation loss decreased (-0.609986 --> -0.623319).  Saving model ...
Epoch: 27 cost time: 6.941352605819702
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.620 Test Loss: 1.400 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 7.2925660610198975
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.623 Test Loss: 1.390 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 29 cost time: 7.231686592102051
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.375 Vali Acc: 0.627 Test Loss: 1.375 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626653).  Saving model ...
Epoch: 30 cost time: 7.292801380157471
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.363 Vali Acc: 0.630 Test Loss: 1.363 Test Acc: 0.630
Validation loss decreased (-0.626653 --> -0.629986).  Saving model ...
Epoch: 31 cost time: 7.644728422164917
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.353 Vali Acc: 0.640 Test Loss: 1.353 Test Acc: 0.640
Validation loss decreased (-0.629986 --> -0.639986).  Saving model ...
Epoch: 32 cost time: 7.617489576339722
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.647 Test Loss: 1.345 Test Acc: 0.647
Validation loss decreased (-0.639986 --> -0.646653).  Saving model ...
Epoch: 33 cost time: 7.22819709777832
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.338 Vali Acc: 0.647 Test Loss: 1.338 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 34 cost time: 7.505681276321411
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.333 Vali Acc: 0.647 Test Loss: 1.333 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 35 cost time: 7.846124172210693
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.327 Vali Acc: 0.640 Test Loss: 1.327 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 7.212136507034302
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.316 Vali Acc: 0.643 Test Loss: 1.316 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 7.5085530281066895
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.309 Vali Acc: 0.647 Test Loss: 1.309 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646654).  Saving model ...
Epoch: 38 cost time: 7.170726776123047
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.303 Vali Acc: 0.653 Test Loss: 1.303 Test Acc: 0.653
Validation loss decreased (-0.646654 --> -0.653320).  Saving model ...
Epoch: 39 cost time: 7.2090904712677
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.296 Vali Acc: 0.660 Test Loss: 1.296 Test Acc: 0.660
Validation loss decreased (-0.653320 --> -0.659987).  Saving model ...
Epoch: 40 cost time: 6.917292594909668
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.657 Test Loss: 1.292 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 7.334962606430054
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.289 Vali Acc: 0.663 Test Loss: 1.289 Test Acc: 0.663
Validation loss decreased (-0.659987 --> -0.663320).  Saving model ...
Epoch: 42 cost time: 7.414582252502441
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.284 Vali Acc: 0.663 Test Loss: 1.284 Test Acc: 0.663
Validation loss decreased (-0.663320 --> -0.663320).  Saving model ...
Epoch: 43 cost time: 7.78219199180603
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.663 Test Loss: 1.275 Test Acc: 0.663
Validation loss decreased (-0.663320 --> -0.663321).  Saving model ...
Epoch: 44 cost time: 7.789214134216309
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.269 Vali Acc: 0.657 Test Loss: 1.269 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 7.811004161834717
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.650 Test Loss: 1.268 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 7.518616437911987
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.653 Test Loss: 1.265 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 7.4756245613098145
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.653 Test Loss: 1.258 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 7.269244194030762
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.667 Test Loss: 1.255 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666654).  Saving model ...
Epoch: 49 cost time: 7.359804391860962
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.667 Test Loss: 1.252 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 50 cost time: 7.691012859344482
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.673 Test Loss: 1.245 Test Acc: 0.673
Validation loss decreased (-0.666654 --> -0.673321).  Saving model ...
Epoch: 51 cost time: 8.280379295349121
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.673 Test Loss: 1.242 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 52 cost time: 7.899674892425537
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.670 Test Loss: 1.242 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 8.066462278366089
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.670 Test Loss: 1.240 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 7.72384786605835
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.670 Test Loss: 1.240 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 7.136916160583496
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.670 Test Loss: 1.234 Test Acc: 0.670
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 7.554385185241699
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.680 Test Loss: 1.231 Test Acc: 0.680
Validation loss decreased (-0.673321 --> -0.679988).  Saving model ...
Epoch: 57 cost time: 7.283726930618286
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.673 Test Loss: 1.230 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 7.7327117919921875
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.670 Test Loss: 1.228 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 7.921541213989258
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.677 Test Loss: 1.223 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 7.637603282928467
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.673 Test Loss: 1.219 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 7.534623384475708
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.680 Test Loss: 1.214 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 62 cost time: 7.786075115203857
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.677 Test Loss: 1.210 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 7.664044618606567
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.680 Test Loss: 1.211 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 64 cost time: 7.287659645080566
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.677 Test Loss: 1.212 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 7.2707085609436035
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.680 Test Loss: 1.212 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 7.2141053676605225
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.680 Test Loss: 1.208 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 67 cost time: 7.359924793243408
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.683 Test Loss: 1.208 Test Acc: 0.683
Validation loss decreased (-0.679988 --> -0.683321).  Saving model ...
Epoch: 68 cost time: 7.812212228775024
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.683 Test Loss: 1.205 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 69 cost time: 7.36637544631958
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.677 Test Loss: 1.204 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 7.652455806732178
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.673 Test Loss: 1.202 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 7.820737838745117
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.677 Test Loss: 1.201 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 7.47340202331543
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.677 Test Loss: 1.198 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 7.502318382263184
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.680 Test Loss: 1.199 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 6.966148376464844
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.680 Test Loss: 1.207 Test Acc: 0.680
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 7.713413238525391
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.680 Test Loss: 1.205 Test Acc: 0.680
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 7.6155455112457275
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.680 Test Loss: 1.204 Test Acc: 0.680
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 7.292441368103027
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.200 Vali Acc: 0.680 Test Loss: 1.200 Test Acc: 0.680
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 7.464114427566528
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.677 Test Loss: 1.198 Test Acc: 0.677
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6833333333333333
model parameter : 1322521
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.627354860305786
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 8.215997457504272
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.706947326660156
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 4 cost time: 7.206267356872559
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.463407039642334
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 6 cost time: 7.506423234939575
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 7 cost time: 7.452729225158691
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 8 cost time: 8.113948822021484
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.799086332321167
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.638827085494995
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.609483480453491
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.198880195617676
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.70951247215271
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.376958847045898
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.561067581176758
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.668842792510986
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.487374782562256
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 1322521
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.149611473083496
Epoch: 1, Steps: 18 | Train Loss: 3.076 Vali Loss: 2.362 Vali Acc: 0.610 Test Loss: 2.362 Test Acc: 0.610
Validation loss decreased (inf --> -0.609976).  Saving model ...
Epoch: 2 cost time: 8.101147651672363
Epoch: 2, Steps: 18 | Train Loss: 1.644 Vali Loss: 1.108 Vali Acc: 0.833 Test Loss: 1.108 Test Acc: 0.833
Validation loss decreased (-0.609976 --> -0.833322).  Saving model ...
Epoch: 3 cost time: 7.590297698974609
Epoch: 3, Steps: 18 | Train Loss: 0.579 Vali Loss: 0.601 Vali Acc: 0.880 Test Loss: 0.601 Test Acc: 0.880
Validation loss decreased (-0.833322 --> -0.879994).  Saving model ...
Epoch: 4 cost time: 7.526835680007935
Epoch: 4, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.467 Vali Acc: 0.897 Test Loss: 0.467 Test Acc: 0.897
Validation loss decreased (-0.879994 --> -0.896662).  Saving model ...
Epoch: 5 cost time: 7.381836891174316
Epoch: 5, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.424 Vali Acc: 0.887 Test Loss: 0.424 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.03681468963623
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.398 Vali Acc: 0.890 Test Loss: 0.398 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.192199230194092
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.385 Vali Acc: 0.897 Test Loss: 0.385 Test Acc: 0.897
Validation loss decreased (-0.896662 --> -0.896663).  Saving model ...
Epoch: 8 cost time: 7.53201961517334
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
Validation loss decreased (-0.896663 --> -0.903330).  Saving model ...
Epoch: 9 cost time: 7.778247356414795
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.376 Vali Acc: 0.897 Test Loss: 0.376 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.651725769042969
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.366 Vali Acc: 0.907 Test Loss: 0.366 Test Acc: 0.907
Validation loss decreased (-0.903330 --> -0.906663).  Saving model ...
Epoch: 11 cost time: 7.786985635757446
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.548743009567261
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.361 Vali Acc: 0.907 Test Loss: 0.361 Test Acc: 0.907
Validation loss decreased (-0.906663 --> -0.906663).  Saving model ...
Epoch: 13 cost time: 7.7539613246917725
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.358 Vali Acc: 0.907 Test Loss: 0.358 Test Acc: 0.907
Validation loss decreased (-0.906663 --> -0.906663).  Saving model ...
Epoch: 14 cost time: 6.9920477867126465
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.357 Vali Acc: 0.910 Test Loss: 0.357 Test Acc: 0.910
Validation loss decreased (-0.906663 --> -0.909996).  Saving model ...
Epoch: 15 cost time: 7.39763069152832
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.352 Vali Acc: 0.907 Test Loss: 0.352 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.225213050842285
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.607824087142944
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.006249189376831
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.352 Vali Acc: 0.907 Test Loss: 0.352 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.494762182235718
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.352 Vali Acc: 0.907 Test Loss: 0.352 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.100340843200684
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.907 Test Loss: 0.349 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.941032886505127
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.183776617050171
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.358762979507446
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.273214101791382
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.91
model parameter : 1224217
model size : 9.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.718645095825195
Epoch: 1, Steps: 18 | Train Loss: 3.161 Vali Loss: 2.580 Vali Acc: 0.537 Test Loss: 2.580 Test Acc: 0.537
Validation loss decreased (inf --> -0.536641).  Saving model ...
Epoch: 2 cost time: 7.276506423950195
Epoch: 2, Steps: 18 | Train Loss: 1.932 Vali Loss: 1.474 Vali Acc: 0.797 Test Loss: 1.474 Test Acc: 0.797
Validation loss decreased (-0.536641 --> -0.796652).  Saving model ...
Epoch: 3 cost time: 7.431616306304932
Epoch: 3, Steps: 18 | Train Loss: 0.804 Vali Loss: 0.850 Vali Acc: 0.823 Test Loss: 0.850 Test Acc: 0.823
Validation loss decreased (-0.796652 --> -0.823325).  Saving model ...
Epoch: 4 cost time: 7.685282230377197
Epoch: 4, Steps: 18 | Train Loss: 0.243 Vali Loss: 0.667 Vali Acc: 0.847 Test Loss: 0.667 Test Acc: 0.847
Validation loss decreased (-0.823325 --> -0.846660).  Saving model ...
Epoch: 5 cost time: 7.151208162307739
Epoch: 5, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
Validation loss decreased (-0.846660 --> -0.866661).  Saving model ...
Epoch: 6 cost time: 8.179067134857178
Epoch: 6, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.540 Vali Acc: 0.863 Test Loss: 0.540 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.950406789779663
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.541 Vali Acc: 0.863 Test Loss: 0.541 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.803623914718628
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.535 Vali Acc: 0.860 Test Loss: 0.535 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.58812689781189
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.529 Vali Acc: 0.873 Test Loss: 0.529 Test Acc: 0.873
Validation loss decreased (-0.866661 --> -0.873328).  Saving model ...
Epoch: 10 cost time: 7.729575157165527
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.515 Vali Acc: 0.867 Test Loss: 0.515 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.706949234008789
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.509 Vali Acc: 0.873 Test Loss: 0.509 Test Acc: 0.873
Validation loss decreased (-0.873328 --> -0.873328).  Saving model ...
Epoch: 12 cost time: 7.916640758514404
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.863 Test Loss: 0.513 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.37554931640625
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.509 Vali Acc: 0.870 Test Loss: 0.509 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.123972177505493
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.870 Test Loss: 0.507 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.589531660079956
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.873 Test Loss: 0.502 Test Acc: 0.873
Validation loss decreased (-0.873328 --> -0.873328).  Saving model ...
Epoch: 16 cost time: 7.265933275222778
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.877 Test Loss: 0.500 Test Acc: 0.877
Validation loss decreased (-0.873328 --> -0.876662).  Saving model ...
Epoch: 17 cost time: 7.639023542404175
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.880 Test Loss: 0.499 Test Acc: 0.880
Validation loss decreased (-0.876662 --> -0.879995).  Saving model ...
Epoch: 18 cost time: 8.230047702789307
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.883 Test Loss: 0.502 Test Acc: 0.883
Validation loss decreased (-0.879995 --> -0.883328).  Saving model ...
Epoch: 19 cost time: 8.777405738830566
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.877 Test Loss: 0.505 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.450270652770996
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.880 Test Loss: 0.502 Test Acc: 0.880
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.903500318527222
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.883 Test Loss: 0.500 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 22 cost time: 8.099759578704834
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.877 Test Loss: 0.501 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.070120811462402
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.880 Test Loss: 0.502 Test Acc: 0.880
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.734720468521118
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.883 Test Loss: 0.504 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 7.409367561340332
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.880 Test Loss: 0.504 Test Acc: 0.880
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 7.599920034408569
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.877 Test Loss: 0.505 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 7.8244407176971436
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.877 Test Loss: 0.504 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.769212484359741
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.880 Test Loss: 0.505 Test Acc: 0.880
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 7.877601623535156
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.877 Test Loss: 0.504 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 7.994699716567993
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.883 Test Loss: 0.506 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 7.980603456497192
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.883 Test Loss: 0.505 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8833333333333333
model parameter : 1224217
model size : 9.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.485294580459595
Epoch: 1, Steps: 18 | Train Loss: 3.240 Vali Loss: 2.814 Vali Acc: 0.330 Test Loss: 2.814 Test Acc: 0.330
Validation loss decreased (inf --> -0.329972).  Saving model ...
Epoch: 2 cost time: 7.197834253311157
Epoch: 2, Steps: 18 | Train Loss: 2.299 Vali Loss: 1.995 Vali Acc: 0.667 Test Loss: 1.995 Test Acc: 0.667
Validation loss decreased (-0.329972 --> -0.666647).  Saving model ...
Epoch: 3 cost time: 7.26924991607666
Epoch: 3, Steps: 18 | Train Loss: 1.199 Vali Loss: 1.345 Vali Acc: 0.740 Test Loss: 1.345 Test Acc: 0.740
Validation loss decreased (-0.666647 --> -0.739987).  Saving model ...
Epoch: 4 cost time: 7.483222007751465
Epoch: 4, Steps: 18 | Train Loss: 0.435 Vali Loss: 1.025 Vali Acc: 0.770 Test Loss: 1.025 Test Acc: 0.770
Validation loss decreased (-0.739987 --> -0.769990).  Saving model ...
Epoch: 5 cost time: 7.663074970245361
Epoch: 5, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.859 Vali Acc: 0.793 Test Loss: 0.859 Test Acc: 0.793
Validation loss decreased (-0.769990 --> -0.793325).  Saving model ...
Epoch: 6 cost time: 7.557491064071655
Epoch: 6, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.840 Vali Acc: 0.780 Test Loss: 0.840 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.411370754241943
Epoch: 7, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.827 Vali Acc: 0.773 Test Loss: 0.827 Test Acc: 0.773
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.808833837509155
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.811 Vali Acc: 0.790 Test Loss: 0.811 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.079866170883179
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.806 Vali Acc: 0.787 Test Loss: 0.806 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.199602127075195
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.785 Vali Acc: 0.800 Test Loss: 0.785 Test Acc: 0.800
Validation loss decreased (-0.793325 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 6.738370180130005
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.783 Vali Acc: 0.810 Test Loss: 0.783 Test Acc: 0.810
Validation loss decreased (-0.799992 --> -0.809992).  Saving model ...
Epoch: 12 cost time: 7.406770706176758
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.788 Vali Acc: 0.803 Test Loss: 0.788 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.73539137840271
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.785 Vali Acc: 0.807 Test Loss: 0.785 Test Acc: 0.807
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.489763021469116
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.784 Vali Acc: 0.803 Test Loss: 0.784 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.952761173248291
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.775 Vali Acc: 0.803 Test Loss: 0.775 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.96362829208374
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.772 Vali Acc: 0.807 Test Loss: 0.772 Test Acc: 0.807
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.05774450302124
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.768 Vali Acc: 0.810 Test Loss: 0.768 Test Acc: 0.810
Validation loss decreased (-0.809992 --> -0.809992).  Saving model ...
Epoch: 18 cost time: 8.183320999145508
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.771 Vali Acc: 0.803 Test Loss: 0.771 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.436635971069336
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.779 Vali Acc: 0.803 Test Loss: 0.779 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.380128860473633
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.803 Test Loss: 0.777 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.2525482177734375
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.803 Test Loss: 0.777 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.836697101593018
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.776 Vali Acc: 0.807 Test Loss: 0.776 Test Acc: 0.807
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.622650146484375
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.807 Test Loss: 0.775 Test Acc: 0.807
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.7749342918396
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.810 Test Loss: 0.778 Test Acc: 0.810
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 8.136192321777344
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.807 Test Loss: 0.780 Test Acc: 0.807
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.460439443588257
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.807 Test Loss: 0.782 Test Acc: 0.807
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 7.577591180801392
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.803 Test Loss: 0.782 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.81
model parameter : 1224217
model size : 9.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.950373649597168
Epoch: 1, Steps: 18 | Train Loss: 3.290 Vali Loss: 2.984 Vali Acc: 0.197 Test Loss: 2.984 Test Acc: 0.197
Validation loss decreased (inf --> -0.196637).  Saving model ...
Epoch: 2 cost time: 6.9962310791015625
Epoch: 2, Steps: 18 | Train Loss: 2.569 Vali Loss: 2.465 Vali Acc: 0.443 Test Loss: 2.465 Test Acc: 0.443
Validation loss decreased (-0.196637 --> -0.443309).  Saving model ...
Epoch: 3 cost time: 7.026461839675903
Epoch: 3, Steps: 18 | Train Loss: 1.646 Vali Loss: 1.972 Vali Acc: 0.517 Test Loss: 1.972 Test Acc: 0.517
Validation loss decreased (-0.443309 --> -0.516647).  Saving model ...
Epoch: 4 cost time: 7.225731372833252
Epoch: 4, Steps: 18 | Train Loss: 0.824 Vali Loss: 1.617 Vali Acc: 0.617 Test Loss: 1.617 Test Acc: 0.617
Validation loss decreased (-0.516647 --> -0.616650).  Saving model ...
Epoch: 5 cost time: 6.96840763092041
Epoch: 5, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.405 Vali Acc: 0.600 Test Loss: 1.405 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.794273853302002
Epoch: 6, Steps: 18 | Train Loss: 0.105 Vali Loss: 1.287 Vali Acc: 0.623 Test Loss: 1.287 Test Acc: 0.623
Validation loss decreased (-0.616650 --> -0.623320).  Saving model ...
Epoch: 7 cost time: 7.250935077667236
Epoch: 7, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.186 Vali Acc: 0.620 Test Loss: 1.186 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.886310577392578
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.188 Vali Acc: 0.640 Test Loss: 1.188 Test Acc: 0.640
Validation loss decreased (-0.623320 --> -0.639988).  Saving model ...
Epoch: 9 cost time: 7.293017864227295
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.143 Vali Acc: 0.680 Test Loss: 1.143 Test Acc: 0.680
Validation loss decreased (-0.639988 --> -0.679989).  Saving model ...
Epoch: 10 cost time: 7.18888258934021
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.103 Vali Acc: 0.683 Test Loss: 1.103 Test Acc: 0.683
Validation loss decreased (-0.679989 --> -0.683322).  Saving model ...
Epoch: 11 cost time: 6.9652111530303955
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.085 Vali Acc: 0.683 Test Loss: 1.085 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 12 cost time: 7.171270370483398
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.081 Vali Acc: 0.687 Test Loss: 1.081 Test Acc: 0.687
Validation loss decreased (-0.683322 --> -0.686656).  Saving model ...
Epoch: 13 cost time: 7.576045751571655
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.065 Vali Acc: 0.687 Test Loss: 1.065 Test Acc: 0.687
Validation loss decreased (-0.686656 --> -0.686656).  Saving model ...
Epoch: 14 cost time: 7.279050350189209
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.056 Vali Acc: 0.703 Test Loss: 1.056 Test Acc: 0.703
Validation loss decreased (-0.686656 --> -0.703323).  Saving model ...
Epoch: 15 cost time: 7.296047687530518
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.167894601821899
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.041 Vali Acc: 0.700 Test Loss: 1.041 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.282842636108398
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.033 Vali Acc: 0.703 Test Loss: 1.033 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 18 cost time: 8.174176454544067
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.031 Vali Acc: 0.710 Test Loss: 1.031 Test Acc: 0.710
Validation loss decreased (-0.703323 --> -0.709990).  Saving model ...
Epoch: 19 cost time: 8.289939403533936
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.027 Vali Acc: 0.720 Test Loss: 1.027 Test Acc: 0.720
Validation loss decreased (-0.709990 --> -0.719990).  Saving model ...
Epoch: 20 cost time: 7.9540019035339355
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.018 Vali Acc: 0.720 Test Loss: 1.018 Test Acc: 0.720
Validation loss decreased (-0.719990 --> -0.719990).  Saving model ...
Epoch: 21 cost time: 7.742338180541992
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.016 Vali Acc: 0.720 Test Loss: 1.016 Test Acc: 0.720
Validation loss decreased (-0.719990 --> -0.719990).  Saving model ...
Epoch: 22 cost time: 7.772120952606201
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.720 Test Loss: 1.014 Test Acc: 0.720
Validation loss decreased (-0.719990 --> -0.719990).  Saving model ...
Epoch: 23 cost time: 8.722371816635132
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.723 Test Loss: 1.011 Test Acc: 0.723
Validation loss decreased (-0.719990 --> -0.723323).  Saving model ...
Epoch: 24 cost time: 7.711367607116699
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.727 Test Loss: 1.007 Test Acc: 0.727
Validation loss decreased (-0.723323 --> -0.726657).  Saving model ...
Epoch: 25 cost time: 7.467880487442017
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.727 Test Loss: 1.001 Test Acc: 0.727
Validation loss decreased (-0.726657 --> -0.726657).  Saving model ...
Epoch: 26 cost time: 7.088479280471802
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.733 Test Loss: 0.997 Test Acc: 0.733
Validation loss decreased (-0.726657 --> -0.733323).  Saving model ...
Epoch: 27 cost time: 7.7777793407440186
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.996 Vali Acc: 0.733 Test Loss: 0.996 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 28 cost time: 8.08751392364502
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.993 Vali Acc: 0.730 Test Loss: 0.993 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 8.008384466171265
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.986 Vali Acc: 0.730 Test Loss: 0.986 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 7.953754901885986
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.733 Test Loss: 0.985 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 31 cost time: 8.106300830841064
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.981 Vali Acc: 0.733 Test Loss: 0.981 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733324).  Saving model ...
Epoch: 32 cost time: 7.436885356903076
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.980 Vali Acc: 0.737 Test Loss: 0.980 Test Acc: 0.737
Validation loss decreased (-0.733324 --> -0.736657).  Saving model ...
Epoch: 33 cost time: 7.908020734786987
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.733 Test Loss: 0.984 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 7.394197225570679
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.730 Test Loss: 0.984 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 7.520337343215942
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.978 Vali Acc: 0.737 Test Loss: 0.978 Test Acc: 0.737
Validation loss decreased (-0.736657 --> -0.736657).  Saving model ...
Epoch: 36 cost time: 7.680534839630127
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.977 Vali Acc: 0.727 Test Loss: 0.977 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 8.679906606674194
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.733 Test Loss: 0.973 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 7.690648555755615
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.968 Vali Acc: 0.737 Test Loss: 0.968 Test Acc: 0.737
Validation loss decreased (-0.736657 --> -0.736657).  Saving model ...
Epoch: 39 cost time: 7.6658196449279785
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.733 Test Loss: 0.965 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 7.985949516296387
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.730 Test Loss: 0.965 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 7.338528394699097
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.733 Test Loss: 0.962 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 7.694056272506714
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.966 Vali Acc: 0.730 Test Loss: 0.966 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 7.508970022201538
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.967 Vali Acc: 0.730 Test Loss: 0.967 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 7.438377857208252
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.740 Test Loss: 0.965 Test Acc: 0.740
Validation loss decreased (-0.736657 --> -0.739990).  Saving model ...
Epoch: 45 cost time: 7.903363466262817
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.737 Test Loss: 0.963 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 7.6117844581604
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.730 Test Loss: 0.963 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 7.950868606567383
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.961 Vali Acc: 0.737 Test Loss: 0.961 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 7.616588830947876
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.737 Test Loss: 0.957 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 7.213772773742676
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.737 Test Loss: 0.959 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 7.535085678100586
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.743 Test Loss: 0.958 Test Acc: 0.743
Validation loss decreased (-0.739990 --> -0.743324).  Saving model ...
Epoch: 51 cost time: 7.652749300003052
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.743 Test Loss: 0.955 Test Acc: 0.743
Validation loss decreased (-0.743324 --> -0.743324).  Saving model ...
Epoch: 52 cost time: 7.798412322998047
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.743 Test Loss: 0.955 Test Acc: 0.743
Validation loss decreased (-0.743324 --> -0.743324).  Saving model ...
Epoch: 53 cost time: 8.471383571624756
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.743 Test Loss: 0.955 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 8.38329529762268
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.743 Test Loss: 0.955 Test Acc: 0.743
Validation loss decreased (-0.743324 --> -0.743324).  Saving model ...
Epoch: 55 cost time: 8.229175806045532
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.747 Test Loss: 0.954 Test Acc: 0.747
Validation loss decreased (-0.743324 --> -0.746657).  Saving model ...
Epoch: 56 cost time: 8.428580284118652
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.743 Test Loss: 0.951 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 8.685694456100464
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.952 Vali Acc: 0.747 Test Loss: 0.952 Test Acc: 0.747
Validation loss decreased (-0.746657 --> -0.746657).  Saving model ...
Epoch: 58 cost time: 7.690608739852905
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.743 Test Loss: 0.953 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 7.822957992553711
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.743 Test Loss: 0.951 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 7.8630852699279785
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.747 Test Loss: 0.953 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 8.339231967926025
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
Validation loss decreased (-0.746657 --> -0.749990).  Saving model ...
Epoch: 62 cost time: 8.219513893127441
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 63 cost time: 8.532230138778687
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.952 Vali Acc: 0.747 Test Loss: 0.952 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 8.494710683822632
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.747 Test Loss: 0.953 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 8.30813980102539
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.952 Vali Acc: 0.747 Test Loss: 0.952 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 8.091113090515137
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.753 Test Loss: 0.951 Test Acc: 0.753
Validation loss decreased (-0.749990 --> -0.753324).  Saving model ...
Epoch: 67 cost time: 7.159112453460693
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.753 Test Loss: 0.949 Test Acc: 0.753
Validation loss decreased (-0.753324 --> -0.753324).  Saving model ...
Epoch: 68 cost time: 7.707057237625122
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.757 Test Loss: 0.948 Test Acc: 0.757
Validation loss decreased (-0.753324 --> -0.756657).  Saving model ...
Epoch: 69 cost time: 7.683588266372681
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.757 Test Loss: 0.948 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 7.821637153625488
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.757 Test Loss: 0.949 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 7.950505495071411
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.950 Vali Acc: 0.753 Test Loss: 0.950 Test Acc: 0.753
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 8.005091905593872
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.950 Vali Acc: 0.753 Test Loss: 0.950 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 8.227291584014893
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.753 Test Loss: 0.951 Test Acc: 0.753
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 7.505735397338867
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.950 Vali Acc: 0.753 Test Loss: 0.950 Test Acc: 0.753
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 7.283513784408569
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.753 Test Loss: 0.949 Test Acc: 0.753
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 7.308693885803223
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.760 Test Loss: 0.948 Test Acc: 0.760
Validation loss decreased (-0.756657 --> -0.759991).  Saving model ...
Epoch: 77 cost time: 7.043603897094727
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.760 Test Loss: 0.947 Test Acc: 0.760
Validation loss decreased (-0.759991 --> -0.759991).  Saving model ...
Epoch: 78 cost time: 7.628958463668823
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.757 Test Loss: 0.947 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 7.723527431488037
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.757 Test Loss: 0.947 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 7.97098708152771
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.760 Test Loss: 0.947 Test Acc: 0.760
Validation loss decreased (-0.759991 --> -0.759991).  Saving model ...
Epoch: 81 cost time: 7.7211854457855225
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.760 Test Loss: 0.945 Test Acc: 0.760
Validation loss decreased (-0.759991 --> -0.759991).  Saving model ...
Epoch: 82 cost time: 8.16483473777771
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.757 Test Loss: 0.943 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 7.496280670166016
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.760 Test Loss: 0.943 Test Acc: 0.760
Validation loss decreased (-0.759991 --> -0.759991).  Saving model ...
Epoch: 84 cost time: 7.4232423305511475
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.767 Test Loss: 0.942 Test Acc: 0.767
Validation loss decreased (-0.759991 --> -0.766657).  Saving model ...
Epoch: 85 cost time: 7.412309885025024
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.767 Test Loss: 0.942 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 8.141472101211548
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.767 Test Loss: 0.943 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 8.113915205001831
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.763 Test Loss: 0.943 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 7.85477352142334
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.944 Vali Acc: 0.763 Test Loss: 0.944 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 7.8275158405303955
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.760 Test Loss: 0.943 Test Acc: 0.760
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 8.705327272415161
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.941 Vali Acc: 0.763 Test Loss: 0.941 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 7.846938371658325
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.763 Test Loss: 0.943 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 8.129910469055176
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.767 Test Loss: 0.943 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 7.944828987121582
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.944 Vali Acc: 0.763 Test Loss: 0.944 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 8.222126483917236
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.760 Test Loss: 0.943 Test Acc: 0.760
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7666666666666667
model parameter : 1224217
model size : 9.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.519099235534668
Epoch: 1, Steps: 18 | Train Loss: 3.283 Vali Loss: 3.091 Vali Acc: 0.100 Test Loss: 3.091 Test Acc: 0.100
Validation loss decreased (inf --> -0.099969).  Saving model ...
Epoch: 2 cost time: 7.050943613052368
Epoch: 2, Steps: 18 | Train Loss: 2.696 Vali Loss: 2.758 Vali Acc: 0.327 Test Loss: 2.758 Test Acc: 0.327
Validation loss decreased (-0.099969 --> -0.326639).  Saving model ...
Epoch: 3 cost time: 6.555350303649902
Epoch: 3, Steps: 18 | Train Loss: 1.885 Vali Loss: 2.435 Vali Acc: 0.377 Test Loss: 2.435 Test Acc: 0.377
Validation loss decreased (-0.326639 --> -0.376642).  Saving model ...
Epoch: 4 cost time: 6.750241041183472
Epoch: 4, Steps: 18 | Train Loss: 1.091 Vali Loss: 2.162 Vali Acc: 0.437 Test Loss: 2.162 Test Acc: 0.437
Validation loss decreased (-0.376642 --> -0.436645).  Saving model ...
Epoch: 5 cost time: 6.612466812133789
Epoch: 5, Steps: 18 | Train Loss: 0.465 Vali Loss: 1.963 Vali Acc: 0.423 Test Loss: 1.963 Test Acc: 0.423
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.868947505950928
Epoch: 6, Steps: 18 | Train Loss: 0.180 Vali Loss: 1.866 Vali Acc: 0.443 Test Loss: 1.866 Test Acc: 0.443
Validation loss decreased (-0.436645 --> -0.443315).  Saving model ...
Epoch: 7 cost time: 6.6583006381988525
Epoch: 7, Steps: 18 | Train Loss: 0.066 Vali Loss: 1.702 Vali Acc: 0.490 Test Loss: 1.702 Test Acc: 0.490
Validation loss decreased (-0.443315 --> -0.489983).  Saving model ...
Epoch: 8 cost time: 6.607891321182251
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.600 Vali Acc: 0.540 Test Loss: 1.600 Test Acc: 0.540
Validation loss decreased (-0.489983 --> -0.539984).  Saving model ...
Epoch: 9 cost time: 6.792384386062622
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.538 Vali Acc: 0.587 Test Loss: 1.538 Test Acc: 0.587
Validation loss decreased (-0.539984 --> -0.586651).  Saving model ...
Epoch: 10 cost time: 7.084185361862183
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.499 Vali Acc: 0.587 Test Loss: 1.499 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586652).  Saving model ...
Epoch: 11 cost time: 7.194383144378662
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.462 Vali Acc: 0.583 Test Loss: 1.462 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.790974140167236
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.444 Vali Acc: 0.603 Test Loss: 1.444 Test Acc: 0.603
Validation loss decreased (-0.586652 --> -0.603319).  Saving model ...
Epoch: 13 cost time: 7.224167823791504
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.422 Vali Acc: 0.600 Test Loss: 1.422 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.776678085327148
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.404 Vali Acc: 0.607 Test Loss: 1.404 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606653).  Saving model ...
Epoch: 15 cost time: 7.073538541793823
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.388 Vali Acc: 0.617 Test Loss: 1.388 Test Acc: 0.617
Validation loss decreased (-0.606653 --> -0.616653).  Saving model ...
Epoch: 16 cost time: 6.768878221511841
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.369 Vali Acc: 0.613 Test Loss: 1.369 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.594796419143677
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.352 Vali Acc: 0.620 Test Loss: 1.352 Test Acc: 0.620
Validation loss decreased (-0.616653 --> -0.619986).  Saving model ...
Epoch: 18 cost time: 6.879812479019165
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.347 Vali Acc: 0.630 Test Loss: 1.347 Test Acc: 0.630
Validation loss decreased (-0.619986 --> -0.629987).  Saving model ...
Epoch: 19 cost time: 7.244825839996338
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.347 Vali Acc: 0.627 Test Loss: 1.347 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.757634878158569
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.338 Vali Acc: 0.630 Test Loss: 1.338 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 21 cost time: 7.362667083740234
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.332 Vali Acc: 0.630 Test Loss: 1.332 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 22 cost time: 7.064897060394287
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.325 Vali Acc: 0.627 Test Loss: 1.325 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.28382420539856
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.623 Test Loss: 1.323 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.125883102416992
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.315 Vali Acc: 0.623 Test Loss: 1.315 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.508548736572266
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.302 Vali Acc: 0.637 Test Loss: 1.302 Test Acc: 0.637
Validation loss decreased (-0.629987 --> -0.636654).  Saving model ...
Epoch: 26 cost time: 6.796494483947754
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.298 Vali Acc: 0.650 Test Loss: 1.298 Test Acc: 0.650
Validation loss decreased (-0.636654 --> -0.649987).  Saving model ...
Epoch: 27 cost time: 6.939698934555054
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.294 Vali Acc: 0.640 Test Loss: 1.294 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.768514156341553
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.286 Vali Acc: 0.637 Test Loss: 1.286 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 7.101363182067871
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.280 Vali Acc: 0.643 Test Loss: 1.280 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 7.197543144226074
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.276 Vali Acc: 0.650 Test Loss: 1.276 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 31 cost time: 7.226953029632568
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.270 Vali Acc: 0.653 Test Loss: 1.270 Test Acc: 0.653
Validation loss decreased (-0.649987 --> -0.653321).  Saving model ...
Epoch: 32 cost time: 7.225610017776489
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.268 Vali Acc: 0.650 Test Loss: 1.268 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.718739986419678
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.267 Vali Acc: 0.660 Test Loss: 1.267 Test Acc: 0.660
Validation loss decreased (-0.653321 --> -0.659987).  Saving model ...
Epoch: 34 cost time: 6.75603461265564
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.266 Vali Acc: 0.660 Test Loss: 1.266 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
Epoch: 35 cost time: 6.7887842655181885
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.259 Vali Acc: 0.667 Test Loss: 1.259 Test Acc: 0.667
Validation loss decreased (-0.659987 --> -0.666654).  Saving model ...
Epoch: 36 cost time: 6.604146957397461
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.657 Test Loss: 1.263 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 7.022567272186279
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.663 Test Loss: 1.253 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 7.1889808177948
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.667 Test Loss: 1.239 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 39 cost time: 7.360949754714966
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.670 Test Loss: 1.234 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669988).  Saving model ...
Epoch: 40 cost time: 7.411532402038574
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.670 Test Loss: 1.234 Test Acc: 0.670
Validation loss decreased (-0.669988 --> -0.669988).  Saving model ...
Epoch: 41 cost time: 7.0855772495269775
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.673 Test Loss: 1.235 Test Acc: 0.673
Validation loss decreased (-0.669988 --> -0.673321).  Saving model ...
Epoch: 42 cost time: 6.6274824142456055
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.670 Test Loss: 1.231 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.866535186767578
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.673 Test Loss: 1.231 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 44 cost time: 6.453355073928833
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.667 Test Loss: 1.227 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 6.619088649749756
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.673 Test Loss: 1.225 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 46 cost time: 6.972712755203247
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.680 Test Loss: 1.221 Test Acc: 0.680
Validation loss decreased (-0.673321 --> -0.679988).  Saving model ...
Epoch: 47 cost time: 7.3869030475616455
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.683 Test Loss: 1.220 Test Acc: 0.683
Validation loss decreased (-0.679988 --> -0.683321).  Saving model ...
Epoch: 48 cost time: 7.0737810134887695
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.670 Test Loss: 1.215 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 7.316994905471802
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.680 Test Loss: 1.215 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 7.244696140289307
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.680 Test Loss: 1.210 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.734344244003296
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.683 Test Loss: 1.208 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 52 cost time: 6.731595277786255
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.687 Test Loss: 1.209 Test Acc: 0.687
Validation loss decreased (-0.683321 --> -0.686655).  Saving model ...
Epoch: 53 cost time: 7.122354984283447
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.683 Test Loss: 1.214 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.5828728675842285
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.697 Test Loss: 1.214 Test Acc: 0.697
Validation loss decreased (-0.686655 --> -0.696655).  Saving model ...
Epoch: 55 cost time: 6.957258701324463
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.693 Test Loss: 1.213 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 7.229621887207031
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.703 Test Loss: 1.209 Test Acc: 0.703
Validation loss decreased (-0.696655 --> -0.703321).  Saving model ...
Epoch: 57 cost time: 7.168491840362549
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.700 Test Loss: 1.208 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 7.23270845413208
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.693 Test Loss: 1.208 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 7.361379623413086
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.693 Test Loss: 1.203 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 7.467499494552612
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.703 Test Loss: 1.198 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 61 cost time: 6.982623338699341
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.197 Vali Acc: 0.700 Test Loss: 1.197 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 7.177638053894043
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.196 Vali Acc: 0.700 Test Loss: 1.196 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 7.262189865112305
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.197 Vali Acc: 0.690 Test Loss: 1.197 Test Acc: 0.690
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 6.989942789077759
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.693 Test Loss: 1.199 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 7.337090730667114
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.693 Test Loss: 1.194 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 8.036701679229736
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.697 Test Loss: 1.192 Test Acc: 0.697
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 7.493356227874756
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.693 Test Loss: 1.194 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 6.994754791259766
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.191 Vali Acc: 0.700 Test Loss: 1.191 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 7.057358503341675
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.703 Test Loss: 1.192 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 70 cost time: 7.13211464881897
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.703 Test Loss: 1.190 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 71 cost time: 7.422013282775879
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.710 Test Loss: 1.190 Test Acc: 0.710
Validation loss decreased (-0.703321 --> -0.709988).  Saving model ...
Epoch: 72 cost time: 7.118766784667969
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.707 Test Loss: 1.189 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 7.234342813491821
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.710 Test Loss: 1.189 Test Acc: 0.710
Validation loss decreased (-0.709988 --> -0.709988).  Saving model ...
Epoch: 74 cost time: 7.740081310272217
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.710 Test Loss: 1.187 Test Acc: 0.710
Validation loss decreased (-0.709988 --> -0.709988).  Saving model ...
Epoch: 75 cost time: 7.876098394393921
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.707 Test Loss: 1.187 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 7.392896413803101
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.713 Test Loss: 1.189 Test Acc: 0.713
Validation loss decreased (-0.709988 --> -0.713321).  Saving model ...
Epoch: 77 cost time: 7.0314977169036865
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.186 Vali Acc: 0.710 Test Loss: 1.186 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 7.249963760375977
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.710 Test Loss: 1.185 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 7.013599395751953
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.707 Test Loss: 1.185 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 6.921684265136719
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.713 Test Loss: 1.187 Test Acc: 0.713
Validation loss decreased (-0.713321 --> -0.713321).  Saving model ...
Epoch: 81 cost time: 7.003224611282349
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.713 Test Loss: 1.185 Test Acc: 0.713
Validation loss decreased (-0.713321 --> -0.713321).  Saving model ...
Epoch: 82 cost time: 7.213430881500244
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.710 Test Loss: 1.183 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 6.7107253074646
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.713 Test Loss: 1.182 Test Acc: 0.713
Validation loss decreased (-0.713321 --> -0.713322).  Saving model ...
Epoch: 84 cost time: 6.904276609420776
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.717 Test Loss: 1.182 Test Acc: 0.717
Validation loss decreased (-0.713322 --> -0.716655).  Saving model ...
Epoch: 85 cost time: 6.805748462677002
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.713 Test Loss: 1.183 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 6.452051162719727
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.717 Test Loss: 1.182 Test Acc: 0.717
Validation loss decreased (-0.716655 --> -0.716655).  Saving model ...
Epoch: 87 cost time: 6.876232862472534
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.720 Test Loss: 1.179 Test Acc: 0.720
Validation loss decreased (-0.716655 --> -0.719988).  Saving model ...
Epoch: 88 cost time: 6.739546298980713
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.720 Test Loss: 1.179 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 7.298937797546387
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.720 Test Loss: 1.178 Test Acc: 0.720
Validation loss decreased (-0.719988 --> -0.719988).  Saving model ...
Epoch: 90 cost time: 7.165831565856934
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.717 Test Loss: 1.177 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 7.42549991607666
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.717 Test Loss: 1.178 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 7.227033376693726
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.713 Test Loss: 1.178 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 7.461794137954712
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.720 Test Loss: 1.179 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 7.466123104095459
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.717 Test Loss: 1.180 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 7.457557678222656
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.717 Test Loss: 1.178 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 7.054232835769653
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.717 Test Loss: 1.178 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 7.002888917922974
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.723 Test Loss: 1.177 Test Acc: 0.723
Validation loss decreased (-0.719988 --> -0.723322).  Saving model ...
Epoch: 98 cost time: 7.472384452819824
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.176 Vali Acc: 0.723 Test Loss: 1.176 Test Acc: 0.723
Validation loss decreased (-0.723322 --> -0.723322).  Saving model ...
Epoch: 99 cost time: 7.187744379043579
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.174 Vali Acc: 0.723 Test Loss: 1.174 Test Acc: 0.723
Validation loss decreased (-0.723322 --> -0.723322).  Saving model ...
Epoch: 100 cost time: 7.517616271972656
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.727 Test Loss: 1.175 Test Acc: 0.727
Validation loss decreased (-0.723322 --> -0.726655).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7266666666666667
model parameter : 1224217
model size : 9.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.080436706542969
Epoch: 1, Steps: 18 | Train Loss: 3.296 Vali Loss: 3.134 Vali Acc: 0.093 Test Loss: 3.134 Test Acc: 0.093
Validation loss decreased (inf --> -0.093302).  Saving model ...
Epoch: 2 cost time: 7.164581060409546
Epoch: 2, Steps: 18 | Train Loss: 2.758 Vali Loss: 2.892 Vali Acc: 0.217 Test Loss: 2.892 Test Acc: 0.217
Validation loss decreased (-0.093302 --> -0.216638).  Saving model ...
Epoch: 3 cost time: 7.207120418548584
Epoch: 3, Steps: 18 | Train Loss: 1.937 Vali Loss: 2.632 Vali Acc: 0.323 Test Loss: 2.632 Test Acc: 0.323
Validation loss decreased (-0.216638 --> -0.323307).  Saving model ...
Epoch: 4 cost time: 6.920149803161621
Epoch: 4, Steps: 18 | Train Loss: 1.147 Vali Loss: 2.423 Vali Acc: 0.343 Test Loss: 2.423 Test Acc: 0.343
Validation loss decreased (-0.323307 --> -0.343309).  Saving model ...
Epoch: 5 cost time: 6.760191917419434
Epoch: 5, Steps: 18 | Train Loss: 0.520 Vali Loss: 2.247 Vali Acc: 0.343 Test Loss: 2.247 Test Acc: 0.343
Validation loss decreased (-0.343309 --> -0.343311).  Saving model ...
Epoch: 6 cost time: 7.130190849304199
Epoch: 6, Steps: 18 | Train Loss: 0.207 Vali Loss: 2.151 Vali Acc: 0.397 Test Loss: 2.151 Test Acc: 0.397
Validation loss decreased (-0.343311 --> -0.396645).  Saving model ...
Epoch: 7 cost time: 7.060583829879761
Epoch: 7, Steps: 18 | Train Loss: 0.070 Vali Loss: 1.956 Vali Acc: 0.400 Test Loss: 1.956 Test Acc: 0.400
Validation loss decreased (-0.396645 --> -0.399980).  Saving model ...
Epoch: 8 cost time: 7.807587623596191
Epoch: 8, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.890 Vali Acc: 0.467 Test Loss: 1.890 Test Acc: 0.467
Validation loss decreased (-0.399980 --> -0.466648).  Saving model ...
Epoch: 9 cost time: 7.590915203094482
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.814 Vali Acc: 0.500 Test Loss: 1.814 Test Acc: 0.500
Validation loss decreased (-0.466648 --> -0.499982).  Saving model ...
Epoch: 10 cost time: 7.719666242599487
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.774 Vali Acc: 0.500 Test Loss: 1.774 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499982).  Saving model ...
Epoch: 11 cost time: 7.642104387283325
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.735 Vali Acc: 0.520 Test Loss: 1.735 Test Acc: 0.520
Validation loss decreased (-0.499982 --> -0.519983).  Saving model ...
Epoch: 12 cost time: 7.3322975635528564
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.702 Vali Acc: 0.520 Test Loss: 1.702 Test Acc: 0.520
Validation loss decreased (-0.519983 --> -0.519983).  Saving model ...
Epoch: 13 cost time: 7.297931671142578
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.674 Vali Acc: 0.517 Test Loss: 1.674 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.4130165576934814
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.645 Vali Acc: 0.537 Test Loss: 1.645 Test Acc: 0.537
Validation loss decreased (-0.519983 --> -0.536650).  Saving model ...
Epoch: 15 cost time: 8.116147994995117
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.627 Vali Acc: 0.537 Test Loss: 1.627 Test Acc: 0.537
Validation loss decreased (-0.536650 --> -0.536650).  Saving model ...
Epoch: 16 cost time: 7.686333417892456
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.615 Vali Acc: 0.547 Test Loss: 1.615 Test Acc: 0.547
Validation loss decreased (-0.536650 --> -0.546651).  Saving model ...
Epoch: 17 cost time: 7.353886842727661
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.592 Vali Acc: 0.553 Test Loss: 1.592 Test Acc: 0.553
Validation loss decreased (-0.546651 --> -0.553317).  Saving model ...
Epoch: 18 cost time: 7.399561882019043
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.570 Vali Acc: 0.557 Test Loss: 1.570 Test Acc: 0.557
Validation loss decreased (-0.553317 --> -0.556651).  Saving model ...
Epoch: 19 cost time: 7.777303218841553
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.557 Vali Acc: 0.563 Test Loss: 1.557 Test Acc: 0.563
Validation loss decreased (-0.556651 --> -0.563318).  Saving model ...
Epoch: 20 cost time: 7.084644556045532
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.541 Vali Acc: 0.567 Test Loss: 1.541 Test Acc: 0.567
Validation loss decreased (-0.563318 --> -0.566651).  Saving model ...
Epoch: 21 cost time: 7.206293821334839
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.530 Vali Acc: 0.567 Test Loss: 1.530 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 22 cost time: 7.551930904388428
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.515 Vali Acc: 0.573 Test Loss: 1.515 Test Acc: 0.573
Validation loss decreased (-0.566651 --> -0.573318).  Saving model ...
Epoch: 23 cost time: 7.490521669387817
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.515 Vali Acc: 0.580 Test Loss: 1.515 Test Acc: 0.580
Validation loss decreased (-0.573318 --> -0.579985).  Saving model ...
Epoch: 24 cost time: 8.116167068481445
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.503 Vali Acc: 0.583 Test Loss: 1.503 Test Acc: 0.583
Validation loss decreased (-0.579985 --> -0.583318).  Saving model ...
Epoch: 25 cost time: 7.656806230545044
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.487 Vali Acc: 0.593 Test Loss: 1.487 Test Acc: 0.593
Validation loss decreased (-0.583318 --> -0.593318).  Saving model ...
Epoch: 26 cost time: 8.004072904586792
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.484 Vali Acc: 0.583 Test Loss: 1.484 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.779057502746582
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.593 Test Loss: 1.475 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593319).  Saving model ...
Epoch: 28 cost time: 7.7517311573028564
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.466 Vali Acc: 0.600 Test Loss: 1.466 Test Acc: 0.600
Validation loss decreased (-0.593319 --> -0.599985).  Saving model ...
Epoch: 29 cost time: 7.697859525680542
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.460 Vali Acc: 0.607 Test Loss: 1.460 Test Acc: 0.607
Validation loss decreased (-0.599985 --> -0.606652).  Saving model ...
Epoch: 30 cost time: 7.007143020629883
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.452 Vali Acc: 0.607 Test Loss: 1.452 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 31 cost time: 6.72726583480835
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.439 Vali Acc: 0.610 Test Loss: 1.439 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 32 cost time: 6.964431524276733
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.433 Vali Acc: 0.617 Test Loss: 1.433 Test Acc: 0.617
Validation loss decreased (-0.609986 --> -0.616652).  Saving model ...
Epoch: 33 cost time: 6.755743741989136
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.428 Vali Acc: 0.613 Test Loss: 1.428 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 7.128347396850586
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.424 Vali Acc: 0.617 Test Loss: 1.424 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 35 cost time: 7.419329643249512
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.414 Vali Acc: 0.620 Test Loss: 1.414 Test Acc: 0.620
Validation loss decreased (-0.616652 --> -0.619986).  Saving model ...
Epoch: 36 cost time: 7.097965717315674
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.414 Vali Acc: 0.623 Test Loss: 1.414 Test Acc: 0.623
Validation loss decreased (-0.619986 --> -0.623319).  Saving model ...
Epoch: 37 cost time: 6.965473175048828
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.623 Test Loss: 1.404 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 38 cost time: 6.635228633880615
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.627 Test Loss: 1.397 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626653).  Saving model ...
Epoch: 39 cost time: 7.043533086776733
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.630 Test Loss: 1.393 Test Acc: 0.630
Validation loss decreased (-0.626653 --> -0.629986).  Saving model ...
Epoch: 40 cost time: 6.960878133773804
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.633 Test Loss: 1.390 Test Acc: 0.633
Validation loss decreased (-0.629986 --> -0.633319).  Saving model ...
Epoch: 41 cost time: 7.566478967666626
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.633 Test Loss: 1.389 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 42 cost time: 7.90591835975647
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.630 Test Loss: 1.387 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 8.340979099273682
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.637 Test Loss: 1.384 Test Acc: 0.637
Validation loss decreased (-0.633319 --> -0.636653).  Saving model ...
Epoch: 44 cost time: 7.928055047988892
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.375 Vali Acc: 0.643 Test Loss: 1.375 Test Acc: 0.643
Validation loss decreased (-0.636653 --> -0.643320).  Saving model ...
Epoch: 45 cost time: 7.789590835571289
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.647 Test Loss: 1.370 Test Acc: 0.647
Validation loss decreased (-0.643320 --> -0.646653).  Saving model ...
Epoch: 46 cost time: 8.245119333267212
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.643 Test Loss: 1.365 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 7.443500518798828
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.647 Test Loss: 1.363 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 48 cost time: 7.412630558013916
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.643 Test Loss: 1.359 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 7.775378465652466
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.643 Test Loss: 1.360 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 8.558152914047241
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.647 Test Loss: 1.355 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 51 cost time: 8.630407333374023
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.647 Test Loss: 1.352 Test Acc: 0.647
Validation loss decreased (-0.646653 --> -0.646653).  Saving model ...
Epoch: 52 cost time: 8.125828981399536
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.650 Test Loss: 1.348 Test Acc: 0.650
Validation loss decreased (-0.646653 --> -0.649987).  Saving model ...
Epoch: 53 cost time: 8.132181644439697
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.660 Test Loss: 1.350 Test Acc: 0.660
Validation loss decreased (-0.649987 --> -0.659987).  Saving model ...
Epoch: 54 cost time: 7.536575794219971
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.663 Test Loss: 1.346 Test Acc: 0.663
Validation loss decreased (-0.659987 --> -0.663320).  Saving model ...
Epoch: 55 cost time: 7.4803972244262695
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.667 Test Loss: 1.345 Test Acc: 0.667
Validation loss decreased (-0.663320 --> -0.666653).  Saving model ...
Epoch: 56 cost time: 7.2948784828186035
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.663 Test Loss: 1.340 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.66536808013916
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.667 Test Loss: 1.337 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
Epoch: 58 cost time: 7.256008148193359
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.663 Test Loss: 1.335 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 7.568268299102783
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.663 Test Loss: 1.333 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 7.78049111366272
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.670 Test Loss: 1.328 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.669987).  Saving model ...
Epoch: 61 cost time: 7.459940195083618
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.325 Vali Acc: 0.673 Test Loss: 1.325 Test Acc: 0.673
Validation loss decreased (-0.669987 --> -0.673320).  Saving model ...
Epoch: 62 cost time: 7.8082969188690186
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.677 Test Loss: 1.322 Test Acc: 0.677
Validation loss decreased (-0.673320 --> -0.676653).  Saving model ...
Epoch: 63 cost time: 7.881802558898926
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.677 Test Loss: 1.320 Test Acc: 0.677
Validation loss decreased (-0.676653 --> -0.676653).  Saving model ...
Epoch: 64 cost time: 7.388035774230957
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.677 Test Loss: 1.322 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 7.123969078063965
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.677 Test Loss: 1.317 Test Acc: 0.677
Validation loss decreased (-0.676653 --> -0.676653).  Saving model ...
Epoch: 66 cost time: 6.871791124343872
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.677 Test Loss: 1.316 Test Acc: 0.677
Validation loss decreased (-0.676653 --> -0.676654).  Saving model ...
Epoch: 67 cost time: 7.399014472961426
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.677 Test Loss: 1.315 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 68 cost time: 7.718418598175049
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.313 Vali Acc: 0.677 Test Loss: 1.313 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 69 cost time: 7.556996583938599
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.313 Vali Acc: 0.677 Test Loss: 1.313 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 7.60719895362854
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.677 Test Loss: 1.312 Test Acc: 0.677
Validation loss decreased (-0.676654 --> -0.676654).  Saving model ...
Epoch: 71 cost time: 7.391254425048828
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.309 Vali Acc: 0.683 Test Loss: 1.309 Test Acc: 0.683
Validation loss decreased (-0.676654 --> -0.683320).  Saving model ...
Epoch: 72 cost time: 6.843024253845215
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.308 Vali Acc: 0.683 Test Loss: 1.308 Test Acc: 0.683
Validation loss decreased (-0.683320 --> -0.683320).  Saving model ...
Epoch: 73 cost time: 7.067664861679077
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.305 Vali Acc: 0.683 Test Loss: 1.305 Test Acc: 0.683
Validation loss decreased (-0.683320 --> -0.683320).  Saving model ...
Epoch: 74 cost time: 7.113643407821655
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.304 Vali Acc: 0.683 Test Loss: 1.304 Test Acc: 0.683
Validation loss decreased (-0.683320 --> -0.683320).  Saving model ...
Epoch: 75 cost time: 7.004122734069824
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.302 Vali Acc: 0.683 Test Loss: 1.302 Test Acc: 0.683
Validation loss decreased (-0.683320 --> -0.683320).  Saving model ...
Epoch: 76 cost time: 7.36220383644104
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.302 Vali Acc: 0.683 Test Loss: 1.302 Test Acc: 0.683
Validation loss decreased (-0.683320 --> -0.683320).  Saving model ...
Epoch: 77 cost time: 7.826351165771484
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.300 Vali Acc: 0.683 Test Loss: 1.300 Test Acc: 0.683
Validation loss decreased (-0.683320 --> -0.683320).  Saving model ...
Epoch: 78 cost time: 7.312566518783569
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.298 Vali Acc: 0.687 Test Loss: 1.298 Test Acc: 0.687
Validation loss decreased (-0.683320 --> -0.686654).  Saving model ...
Epoch: 79 cost time: 7.431701183319092
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.687 Test Loss: 1.295 Test Acc: 0.687
Validation loss decreased (-0.686654 --> -0.686654).  Saving model ...
Epoch: 80 cost time: 7.418416738510132
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.294 Vali Acc: 0.687 Test Loss: 1.294 Test Acc: 0.687
Validation loss decreased (-0.686654 --> -0.686654).  Saving model ...
Epoch: 81 cost time: 6.945140838623047
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.294 Vali Acc: 0.690 Test Loss: 1.294 Test Acc: 0.690
Validation loss decreased (-0.686654 --> -0.689987).  Saving model ...
Epoch: 82 cost time: 6.827495813369751
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.697 Test Loss: 1.292 Test Acc: 0.697
Validation loss decreased (-0.689987 --> -0.696654).  Saving model ...
Epoch: 83 cost time: 7.02685809135437
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.290 Vali Acc: 0.690 Test Loss: 1.290 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 7.145578145980835
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.288 Vali Acc: 0.693 Test Loss: 1.288 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 7.455367565155029
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.690 Test Loss: 1.285 Test Acc: 0.690
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 6.9699249267578125
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.693 Test Loss: 1.285 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 7.120953559875488
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.283 Vali Acc: 0.693 Test Loss: 1.283 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 7.143031120300293
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.693 Test Loss: 1.285 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 7.397669792175293
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.284 Vali Acc: 0.697 Test Loss: 1.284 Test Acc: 0.697
Validation loss decreased (-0.696654 --> -0.696654).  Saving model ...
Epoch: 90 cost time: 6.538956165313721
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.282 Vali Acc: 0.693 Test Loss: 1.282 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 6.712315797805786
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.282 Vali Acc: 0.693 Test Loss: 1.282 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 6.901321649551392
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.282 Vali Acc: 0.693 Test Loss: 1.282 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 7.453511476516724
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.693 Test Loss: 1.281 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 7.393414735794067
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.697 Test Loss: 1.281 Test Acc: 0.697
Validation loss decreased (-0.696654 --> -0.696654).  Saving model ...
Epoch: 95 cost time: 7.517021179199219
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.279 Vali Acc: 0.700 Test Loss: 1.279 Test Acc: 0.700
Validation loss decreased (-0.696654 --> -0.699987).  Saving model ...
Epoch: 96 cost time: 7.298276662826538
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.700 Test Loss: 1.276 Test Acc: 0.700
Validation loss decreased (-0.699987 --> -0.699987).  Saving model ...
Epoch: 97 cost time: 7.274805784225464
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.703 Test Loss: 1.276 Test Acc: 0.703
Validation loss decreased (-0.699987 --> -0.703321).  Saving model ...
Epoch: 98 cost time: 6.910459280014038
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.703 Test Loss: 1.276 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 6.618168830871582
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.703 Test Loss: 1.276 Test Acc: 0.703
Validation loss decreased (-0.703321 --> -0.703321).  Saving model ...
Epoch: 100 cost time: 6.632490634918213
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.278 Vali Acc: 0.707 Test Loss: 1.278 Test Acc: 0.707
Validation loss decreased (-0.703321 --> -0.706654).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7066666666666667
model parameter : 1224217
model size : 9.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.147892236709595
Epoch: 1, Steps: 18 | Train Loss: 3.310 Vali Loss: 3.200 Vali Acc: 0.043 Test Loss: 3.200 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 7.843594312667847
Epoch: 2, Steps: 18 | Train Loss: 2.782 Vali Loss: 3.050 Vali Acc: 0.097 Test Loss: 3.050 Test Acc: 0.097
Validation loss decreased (-0.043301 --> -0.096636).  Saving model ...
Epoch: 3 cost time: 7.325791120529175
Epoch: 3, Steps: 18 | Train Loss: 2.034 Vali Loss: 2.886 Vali Acc: 0.123 Test Loss: 2.886 Test Acc: 0.123
Validation loss decreased (-0.096636 --> -0.123304).  Saving model ...
Epoch: 4 cost time: 7.4699180126190186
Epoch: 4, Steps: 18 | Train Loss: 1.218 Vali Loss: 2.752 Vali Acc: 0.160 Test Loss: 2.752 Test Acc: 0.160
Validation loss decreased (-0.123304 --> -0.159972).  Saving model ...
Epoch: 5 cost time: 8.02053427696228
Epoch: 5, Steps: 18 | Train Loss: 0.584 Vali Loss: 2.665 Vali Acc: 0.197 Test Loss: 2.665 Test Acc: 0.197
Validation loss decreased (-0.159972 --> -0.196640).  Saving model ...
Epoch: 6 cost time: 7.1434760093688965
Epoch: 6, Steps: 18 | Train Loss: 0.225 Vali Loss: 2.559 Vali Acc: 0.223 Test Loss: 2.559 Test Acc: 0.223
Validation loss decreased (-0.196640 --> -0.223308).  Saving model ...
Epoch: 7 cost time: 7.450757265090942
Epoch: 7, Steps: 18 | Train Loss: 0.084 Vali Loss: 2.381 Vali Acc: 0.313 Test Loss: 2.381 Test Acc: 0.313
Validation loss decreased (-0.223308 --> -0.313310).  Saving model ...
Epoch: 8 cost time: 7.152043342590332
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 2.326 Vali Acc: 0.307 Test Loss: 2.326 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.817225694656372
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 2.220 Vali Acc: 0.337 Test Loss: 2.220 Test Acc: 0.337
Validation loss decreased (-0.313310 --> -0.336644).  Saving model ...
Epoch: 10 cost time: 7.969021558761597
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.162 Vali Acc: 0.353 Test Loss: 2.162 Test Acc: 0.353
Validation loss decreased (-0.336644 --> -0.353312).  Saving model ...
Epoch: 11 cost time: 7.918978691101074
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.144 Vali Acc: 0.350 Test Loss: 2.144 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.832864761352539
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.099 Vali Acc: 0.370 Test Loss: 2.099 Test Acc: 0.370
Validation loss decreased (-0.353312 --> -0.369979).  Saving model ...
Epoch: 13 cost time: 7.579502820968628
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.066 Vali Acc: 0.390 Test Loss: 2.066 Test Acc: 0.390
Validation loss decreased (-0.369979 --> -0.389979).  Saving model ...
Epoch: 14 cost time: 7.431464910507202
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.024 Vali Acc: 0.393 Test Loss: 2.024 Test Acc: 0.393
Validation loss decreased (-0.389979 --> -0.393313).  Saving model ...
Epoch: 15 cost time: 7.757161617279053
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.984 Vali Acc: 0.410 Test Loss: 1.984 Test Acc: 0.410
Validation loss decreased (-0.393313 --> -0.409980).  Saving model ...
Epoch: 16 cost time: 7.688425779342651
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.953 Vali Acc: 0.423 Test Loss: 1.953 Test Acc: 0.423
Validation loss decreased (-0.409980 --> -0.423314).  Saving model ...
Epoch: 17 cost time: 7.247692823410034
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.924 Vali Acc: 0.430 Test Loss: 1.924 Test Acc: 0.430
Validation loss decreased (-0.423314 --> -0.429981).  Saving model ...
Epoch: 18 cost time: 7.131446361541748
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.892 Vali Acc: 0.433 Test Loss: 1.892 Test Acc: 0.433
Validation loss decreased (-0.429981 --> -0.433314).  Saving model ...
Epoch: 19 cost time: 7.273112773895264
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.870 Vali Acc: 0.443 Test Loss: 1.870 Test Acc: 0.443
Validation loss decreased (-0.433314 --> -0.443315).  Saving model ...
Epoch: 20 cost time: 7.308537483215332
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.835 Vali Acc: 0.453 Test Loss: 1.835 Test Acc: 0.453
Validation loss decreased (-0.443315 --> -0.453315).  Saving model ...
Epoch: 21 cost time: 7.340735912322998
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.821 Vali Acc: 0.460 Test Loss: 1.821 Test Acc: 0.460
Validation loss decreased (-0.453315 --> -0.459982).  Saving model ...
Epoch: 22 cost time: 7.404820919036865
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.800 Vali Acc: 0.477 Test Loss: 1.800 Test Acc: 0.477
Validation loss decreased (-0.459982 --> -0.476649).  Saving model ...
Epoch: 23 cost time: 7.430140018463135
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.779 Vali Acc: 0.497 Test Loss: 1.779 Test Acc: 0.497
Validation loss decreased (-0.476649 --> -0.496649).  Saving model ...
Epoch: 24 cost time: 7.563538551330566
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.756 Vali Acc: 0.497 Test Loss: 1.756 Test Acc: 0.497
Validation loss decreased (-0.496649 --> -0.496649).  Saving model ...
Epoch: 25 cost time: 7.143873929977417
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.745 Vali Acc: 0.507 Test Loss: 1.745 Test Acc: 0.507
Validation loss decreased (-0.496649 --> -0.506649).  Saving model ...
Epoch: 26 cost time: 7.088540554046631
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.732 Vali Acc: 0.523 Test Loss: 1.732 Test Acc: 0.523
Validation loss decreased (-0.506649 --> -0.523316).  Saving model ...
Epoch: 27 cost time: 7.282224893569946
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.728 Vali Acc: 0.533 Test Loss: 1.728 Test Acc: 0.533
Validation loss decreased (-0.523316 --> -0.533316).  Saving model ...
Epoch: 28 cost time: 7.687129259109497
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.720 Vali Acc: 0.527 Test Loss: 1.720 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.705085039138794
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.701 Vali Acc: 0.520 Test Loss: 1.701 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 7.302428483963013
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.687 Vali Acc: 0.537 Test Loss: 1.687 Test Acc: 0.537
Validation loss decreased (-0.533316 --> -0.536650).  Saving model ...
Epoch: 31 cost time: 7.670228958129883
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.681 Vali Acc: 0.543 Test Loss: 1.681 Test Acc: 0.543
Validation loss decreased (-0.536650 --> -0.543317).  Saving model ...
Epoch: 32 cost time: 8.166140079498291
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.666 Vali Acc: 0.543 Test Loss: 1.666 Test Acc: 0.543
Validation loss decreased (-0.543317 --> -0.543317).  Saving model ...
Epoch: 33 cost time: 7.09980320930481
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.662 Vali Acc: 0.553 Test Loss: 1.662 Test Acc: 0.553
Validation loss decreased (-0.543317 --> -0.553317).  Saving model ...
Epoch: 34 cost time: 6.910880088806152
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.648 Vali Acc: 0.557 Test Loss: 1.648 Test Acc: 0.557
Validation loss decreased (-0.553317 --> -0.556650).  Saving model ...
Epoch: 35 cost time: 6.817046165466309
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.638 Vali Acc: 0.563 Test Loss: 1.638 Test Acc: 0.563
Validation loss decreased (-0.556650 --> -0.563317).  Saving model ...
Epoch: 36 cost time: 6.954796314239502
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.637 Vali Acc: 0.570 Test Loss: 1.637 Test Acc: 0.570
Validation loss decreased (-0.563317 --> -0.569984).  Saving model ...
Epoch: 37 cost time: 6.923542261123657
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.628 Vali Acc: 0.567 Test Loss: 1.628 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 7.558268785476685
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.563 Test Loss: 1.619 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 7.387353420257568
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.567 Test Loss: 1.619 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 7.511129379272461
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.613 Vali Acc: 0.567 Test Loss: 1.613 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 7.3279900550842285
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.603 Vali Acc: 0.580 Test Loss: 1.603 Test Acc: 0.580
Validation loss decreased (-0.569984 --> -0.579984).  Saving model ...
Epoch: 42 cost time: 7.383187770843506
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.570 Test Loss: 1.604 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 7.3979175090789795
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.594 Vali Acc: 0.577 Test Loss: 1.594 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 7.182748079299927
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.577 Test Loss: 1.585 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 6.972328186035156
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.573 Test Loss: 1.575 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 7.756779909133911
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.580 Test Loss: 1.566 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579984).  Saving model ...
Epoch: 47 cost time: 8.413963317871094
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.593 Test Loss: 1.566 Test Acc: 0.593
Validation loss decreased (-0.579984 --> -0.593318).  Saving model ...
Epoch: 48 cost time: 8.251490116119385
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.590 Test Loss: 1.559 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 7.878649950027466
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.557 Vali Acc: 0.583 Test Loss: 1.557 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 8.490827798843384
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.587 Test Loss: 1.549 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 7.469587326049805
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.545 Vali Acc: 0.593 Test Loss: 1.545 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 52 cost time: 7.107851982116699
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.597 Test Loss: 1.539 Test Acc: 0.597
Validation loss decreased (-0.593318 --> -0.596651).  Saving model ...
Epoch: 53 cost time: 7.471776485443115
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.593 Test Loss: 1.536 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 7.509463310241699
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.600 Test Loss: 1.534 Test Acc: 0.600
Validation loss decreased (-0.596651 --> -0.599985).  Saving model ...
Epoch: 55 cost time: 7.70570969581604
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.600 Test Loss: 1.533 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599985).  Saving model ...
Epoch: 56 cost time: 7.684051513671875
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.600 Test Loss: 1.533 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 7.936108589172363
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.597 Test Loss: 1.532 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 8.12776231765747
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.607 Test Loss: 1.531 Test Acc: 0.607
Validation loss decreased (-0.599985 --> -0.606651).  Saving model ...
Epoch: 59 cost time: 7.749982118606567
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.603 Test Loss: 1.527 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 7.876763343811035
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.603 Test Loss: 1.527 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 7.112560510635376
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.603 Test Loss: 1.523 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 7.497162103652954
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.603 Test Loss: 1.515 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 7.39493727684021
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.607 Test Loss: 1.513 Test Acc: 0.607
Validation loss decreased (-0.606651 --> -0.606652).  Saving model ...
Epoch: 64 cost time: 8.123655080795288
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.607 Test Loss: 1.508 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 65 cost time: 7.805404901504517
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.607 Test Loss: 1.506 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 66 cost time: 7.683998346328735
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.610 Test Loss: 1.507 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609985).  Saving model ...
Epoch: 67 cost time: 7.712076425552368
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.610 Test Loss: 1.505 Test Acc: 0.610
Validation loss decreased (-0.609985 --> -0.609985).  Saving model ...
Epoch: 68 cost time: 7.291791200637817
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.610 Test Loss: 1.504 Test Acc: 0.610
Validation loss decreased (-0.609985 --> -0.609985).  Saving model ...
Epoch: 69 cost time: 7.228796005249023
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.502 Vali Acc: 0.607 Test Loss: 1.502 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 7.097498416900635
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.610 Test Loss: 1.501 Test Acc: 0.610
Validation loss decreased (-0.609985 --> -0.609985).  Saving model ...
Epoch: 71 cost time: 7.20655632019043
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.498 Vali Acc: 0.613 Test Loss: 1.498 Test Acc: 0.613
Validation loss decreased (-0.609985 --> -0.613318).  Saving model ...
Epoch: 72 cost time: 7.806188106536865
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.610 Test Loss: 1.496 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 7.860168218612671
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.607 Test Loss: 1.497 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 7.218510150909424
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.495 Vali Acc: 0.607 Test Loss: 1.495 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 7.474711894989014
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.610 Test Loss: 1.493 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 7.045394420623779
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.498 Vali Acc: 0.607 Test Loss: 1.498 Test Acc: 0.607
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 7.373112440109253
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.600 Test Loss: 1.494 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 7.12977409362793
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.600 Test Loss: 1.492 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 7.67579460144043
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.600 Test Loss: 1.489 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 7.3851964473724365
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.603 Test Loss: 1.488 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 7.937146425247192
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.603 Test Loss: 1.488 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6133333333333333
model parameter : 1224217
model size : 9.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.375339269638062
Epoch: 1, Steps: 18 | Train Loss: 3.286 Vali Loss: 3.235 Vali Acc: 0.050 Test Loss: 3.235 Test Acc: 0.050
Validation loss decreased (inf --> -0.049968).  Saving model ...
Epoch: 2 cost time: 7.972706317901611
Epoch: 2, Steps: 18 | Train Loss: 2.828 Vali Loss: 3.090 Vali Acc: 0.070 Test Loss: 3.090 Test Acc: 0.070
Validation loss decreased (-0.049968 --> -0.069969).  Saving model ...
Epoch: 3 cost time: 7.67559289932251
Epoch: 3, Steps: 18 | Train Loss: 2.195 Vali Loss: 2.904 Vali Acc: 0.140 Test Loss: 2.904 Test Acc: 0.140
Validation loss decreased (-0.069969 --> -0.139971).  Saving model ...
Epoch: 4 cost time: 7.6318840980529785
Epoch: 4, Steps: 18 | Train Loss: 1.444 Vali Loss: 2.778 Vali Acc: 0.153 Test Loss: 2.778 Test Acc: 0.153
Validation loss decreased (-0.139971 --> -0.153306).  Saving model ...
Epoch: 5 cost time: 7.9382007122039795
Epoch: 5, Steps: 18 | Train Loss: 0.790 Vali Loss: 2.640 Vali Acc: 0.180 Test Loss: 2.640 Test Acc: 0.180
Validation loss decreased (-0.153306 --> -0.179974).  Saving model ...
Epoch: 6 cost time: 8.327996730804443
Epoch: 6, Steps: 18 | Train Loss: 0.380 Vali Loss: 2.439 Vali Acc: 0.263 Test Loss: 2.439 Test Acc: 0.263
Validation loss decreased (-0.179974 --> -0.263309).  Saving model ...
Epoch: 7 cost time: 7.863177299499512
Epoch: 7, Steps: 18 | Train Loss: 0.144 Vali Loss: 2.298 Vali Acc: 0.293 Test Loss: 2.298 Test Acc: 0.293
Validation loss decreased (-0.263309 --> -0.293310).  Saving model ...
Epoch: 8 cost time: 8.270195484161377
Epoch: 8, Steps: 18 | Train Loss: 0.058 Vali Loss: 2.068 Vali Acc: 0.367 Test Loss: 2.068 Test Acc: 0.367
Validation loss decreased (-0.293310 --> -0.366646).  Saving model ...
Epoch: 9 cost time: 8.03640365600586
Epoch: 9, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.907 Vali Acc: 0.437 Test Loss: 1.907 Test Acc: 0.437
Validation loss decreased (-0.366646 --> -0.436648).  Saving model ...
Epoch: 10 cost time: 8.02048921585083
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.890 Vali Acc: 0.430 Test Loss: 1.890 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.53670859336853
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.836 Vali Acc: 0.450 Test Loss: 1.836 Test Acc: 0.450
Validation loss decreased (-0.436648 --> -0.449982).  Saving model ...
Epoch: 12 cost time: 7.444600820541382
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.785 Vali Acc: 0.463 Test Loss: 1.785 Test Acc: 0.463
Validation loss decreased (-0.449982 --> -0.463315).  Saving model ...
Epoch: 13 cost time: 7.205016851425171
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.749 Vali Acc: 0.480 Test Loss: 1.749 Test Acc: 0.480
Validation loss decreased (-0.463315 --> -0.479983).  Saving model ...
Epoch: 14 cost time: 7.4714038372039795
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.705 Vali Acc: 0.493 Test Loss: 1.705 Test Acc: 0.493
Validation loss decreased (-0.479983 --> -0.493316).  Saving model ...
Epoch: 15 cost time: 7.6861560344696045
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.676 Vali Acc: 0.503 Test Loss: 1.676 Test Acc: 0.503
Validation loss decreased (-0.493316 --> -0.503317).  Saving model ...
Epoch: 16 cost time: 7.69896125793457
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.634 Vali Acc: 0.513 Test Loss: 1.634 Test Acc: 0.513
Validation loss decreased (-0.503317 --> -0.513317).  Saving model ...
Epoch: 17 cost time: 7.784618377685547
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.596 Vali Acc: 0.533 Test Loss: 1.596 Test Acc: 0.533
Validation loss decreased (-0.513317 --> -0.533317).  Saving model ...
Epoch: 18 cost time: 7.402855634689331
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.583 Vali Acc: 0.527 Test Loss: 1.583 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.343982219696045
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.571 Vali Acc: 0.520 Test Loss: 1.571 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.372260332107544
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.547 Vali Acc: 0.553 Test Loss: 1.547 Test Acc: 0.553
Validation loss decreased (-0.533317 --> -0.553318).  Saving model ...
Epoch: 21 cost time: 7.450703144073486
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.514 Vali Acc: 0.557 Test Loss: 1.514 Test Acc: 0.557
Validation loss decreased (-0.553318 --> -0.556652).  Saving model ...
Epoch: 22 cost time: 7.524080753326416
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.501 Vali Acc: 0.570 Test Loss: 1.501 Test Acc: 0.570
Validation loss decreased (-0.556652 --> -0.569985).  Saving model ...
Epoch: 23 cost time: 7.913712024688721
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.475 Vali Acc: 0.567 Test Loss: 1.475 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.149674892425537
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.464 Vali Acc: 0.587 Test Loss: 1.464 Test Acc: 0.587
Validation loss decreased (-0.569985 --> -0.586652).  Saving model ...
Epoch: 25 cost time: 7.387308120727539
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.451 Vali Acc: 0.587 Test Loss: 1.451 Test Acc: 0.587
Validation loss decreased (-0.586652 --> -0.586652).  Saving model ...
Epoch: 26 cost time: 7.853413820266724
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.439 Vali Acc: 0.593 Test Loss: 1.439 Test Acc: 0.593
Validation loss decreased (-0.586652 --> -0.593319).  Saving model ...
Epoch: 27 cost time: 8.35378623008728
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.432 Vali Acc: 0.600 Test Loss: 1.432 Test Acc: 0.600
Validation loss decreased (-0.593319 --> -0.599986).  Saving model ...
Epoch: 28 cost time: 8.018023252487183
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.613 Test Loss: 1.419 Test Acc: 0.613
Validation loss decreased (-0.599986 --> -0.613319).  Saving model ...
Epoch: 29 cost time: 7.282404184341431
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.405 Vali Acc: 0.617 Test Loss: 1.405 Test Acc: 0.617
Validation loss decreased (-0.613319 --> -0.616653).  Saving model ...
Epoch: 30 cost time: 7.889167785644531
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.391 Vali Acc: 0.623 Test Loss: 1.391 Test Acc: 0.623
Validation loss decreased (-0.616653 --> -0.623319).  Saving model ...
Epoch: 31 cost time: 7.920506715774536
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.388 Vali Acc: 0.623 Test Loss: 1.388 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 32 cost time: 7.366769790649414
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.623 Test Loss: 1.379 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623320).  Saving model ...
Epoch: 33 cost time: 8.835338354110718
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.375 Vali Acc: 0.623 Test Loss: 1.375 Test Acc: 0.623
Validation loss decreased (-0.623320 --> -0.623320).  Saving model ...
Epoch: 34 cost time: 8.085715055465698
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.366 Vali Acc: 0.627 Test Loss: 1.366 Test Acc: 0.627
Validation loss decreased (-0.623320 --> -0.626653).  Saving model ...
Epoch: 35 cost time: 8.0334153175354
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.359 Vali Acc: 0.633 Test Loss: 1.359 Test Acc: 0.633
Validation loss decreased (-0.626653 --> -0.633320).  Saving model ...
Epoch: 36 cost time: 8.648047924041748
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.358 Vali Acc: 0.620 Test Loss: 1.358 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 7.906835556030273
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.348 Vali Acc: 0.623 Test Loss: 1.348 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 7.633818864822388
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.630 Test Loss: 1.332 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 7.492898941040039
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.331 Vali Acc: 0.637 Test Loss: 1.331 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.636653).  Saving model ...
Epoch: 40 cost time: 7.3929150104522705
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.633 Test Loss: 1.328 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 7.228779554367065
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.320 Vali Acc: 0.640 Test Loss: 1.320 Test Acc: 0.640
Validation loss decreased (-0.636653 --> -0.639987).  Saving model ...
Epoch: 42 cost time: 7.5167076587677
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.640 Test Loss: 1.328 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 8.262301921844482
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.643 Test Loss: 1.320 Test Acc: 0.643
Validation loss decreased (-0.639987 --> -0.643320).  Saving model ...
Epoch: 44 cost time: 7.785984992980957
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.311 Vali Acc: 0.647 Test Loss: 1.311 Test Acc: 0.647
Validation loss decreased (-0.643320 --> -0.646654).  Saving model ...
Epoch: 45 cost time: 7.931920528411865
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.301 Vali Acc: 0.650 Test Loss: 1.301 Test Acc: 0.650
Validation loss decreased (-0.646654 --> -0.649987).  Saving model ...
Epoch: 46 cost time: 7.223755121231079
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.653 Test Loss: 1.292 Test Acc: 0.653
Validation loss decreased (-0.649987 --> -0.653320).  Saving model ...
Epoch: 47 cost time: 8.153494119644165
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.657 Test Loss: 1.292 Test Acc: 0.657
Validation loss decreased (-0.653320 --> -0.656654).  Saving model ...
Epoch: 48 cost time: 7.248765230178833
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.286 Vali Acc: 0.660 Test Loss: 1.286 Test Acc: 0.660
Validation loss decreased (-0.656654 --> -0.659987).  Saving model ...
Epoch: 49 cost time: 7.57638144493103
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.287 Vali Acc: 0.657 Test Loss: 1.287 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 7.915302276611328
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.278 Vali Acc: 0.660 Test Loss: 1.278 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
Epoch: 51 cost time: 8.204457521438599
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.272 Vali Acc: 0.660 Test Loss: 1.272 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
Epoch: 52 cost time: 7.794533729553223
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.667 Test Loss: 1.263 Test Acc: 0.667
Validation loss decreased (-0.659987 --> -0.666654).  Saving model ...
Epoch: 53 cost time: 7.642634391784668
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.667 Test Loss: 1.259 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 54 cost time: 8.062069654464722
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.657 Test Loss: 1.256 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 7.196546792984009
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.657 Test Loss: 1.251 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 7.776714563369751
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.660 Test Loss: 1.246 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 7.3110551834106445
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.244 Vali Acc: 0.660 Test Loss: 1.244 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 7.541946887969971
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.663 Test Loss: 1.240 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 7.7511491775512695
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.667 Test Loss: 1.238 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 60 cost time: 8.074418067932129
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.663 Test Loss: 1.238 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 7.683774471282959
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.660 Test Loss: 1.235 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 8.32844877243042
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.660 Test Loss: 1.234 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 8.38277530670166
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.663 Test Loss: 1.234 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 8.033851146697998
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.670 Test Loss: 1.232 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669988).  Saving model ...
Epoch: 65 cost time: 7.369471073150635
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.667 Test Loss: 1.234 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 7.506957292556763
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.673 Test Loss: 1.236 Test Acc: 0.673
Validation loss decreased (-0.669988 --> -0.673321).  Saving model ...
Epoch: 67 cost time: 7.686418533325195
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.680 Test Loss: 1.235 Test Acc: 0.680
Validation loss decreased (-0.673321 --> -0.679988).  Saving model ...
Epoch: 68 cost time: 7.791606664657593
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.677 Test Loss: 1.231 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 8.23560357093811
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.680 Test Loss: 1.227 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 70 cost time: 7.9636070728302
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.683 Test Loss: 1.224 Test Acc: 0.683
Validation loss decreased (-0.679988 --> -0.683321).  Saving model ...
Epoch: 71 cost time: 8.045672416687012
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.680 Test Loss: 1.222 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 6.744428634643555
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.680 Test Loss: 1.222 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 7.222913980484009
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.680 Test Loss: 1.222 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 7.504203796386719
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.680 Test Loss: 1.217 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 7.001460790634155
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.680 Test Loss: 1.214 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 7.506119728088379
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.680 Test Loss: 1.217 Test Acc: 0.680
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 7.476782560348511
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.677 Test Loss: 1.215 Test Acc: 0.677
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 7.653484582901001
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.683 Test Loss: 1.210 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 79 cost time: 7.834003686904907
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.683 Test Loss: 1.208 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 80 cost time: 8.261101245880127
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.683 Test Loss: 1.207 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 81 cost time: 7.346270561218262
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.683 Test Loss: 1.207 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 82 cost time: 7.079206943511963
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.687 Test Loss: 1.206 Test Acc: 0.687
Validation loss decreased (-0.683321 --> -0.686655).  Saving model ...
Epoch: 83 cost time: 7.205375671386719
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.687 Test Loss: 1.203 Test Acc: 0.687
Validation loss decreased (-0.686655 --> -0.686655).  Saving model ...
Epoch: 84 cost time: 7.451162099838257
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.687 Test Loss: 1.201 Test Acc: 0.687
Validation loss decreased (-0.686655 --> -0.686655).  Saving model ...
Epoch: 85 cost time: 7.49407434463501
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.197 Vali Acc: 0.690 Test Loss: 1.197 Test Acc: 0.690
Validation loss decreased (-0.686655 --> -0.689988).  Saving model ...
Epoch: 86 cost time: 7.275259971618652
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.196 Vali Acc: 0.690 Test Loss: 1.196 Test Acc: 0.690
Validation loss decreased (-0.689988 --> -0.689988).  Saving model ...
Epoch: 87 cost time: 7.076724529266357
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.697 Test Loss: 1.193 Test Acc: 0.697
Validation loss decreased (-0.689988 --> -0.696655).  Saving model ...
Epoch: 88 cost time: 7.54204797744751
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.700 Test Loss: 1.193 Test Acc: 0.700
Validation loss decreased (-0.696655 --> -0.699988).  Saving model ...
Epoch: 89 cost time: 7.38176965713501
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.697 Test Loss: 1.193 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 6.901716470718384
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.700 Test Loss: 1.193 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 91 cost time: 7.49567174911499
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.693 Test Loss: 1.193 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 8.396890878677368
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.690 Test Loss: 1.195 Test Acc: 0.690
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 8.161542415618896
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.697 Test Loss: 1.194 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 8.453318357467651
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.700 Test Loss: 1.193 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 8.27955150604248
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.697 Test Loss: 1.192 Test Acc: 0.697
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 8.294044733047485
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.697 Test Loss: 1.188 Test Acc: 0.697
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 8.096166133880615
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.697 Test Loss: 1.187 Test Acc: 0.697
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 7.7706990242004395
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.693 Test Loss: 1.185 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 7.549639701843262
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.703 Test Loss: 1.183 Test Acc: 0.703
Validation loss decreased (-0.699988 --> -0.703322).  Saving model ...
Epoch: 100 cost time: 8.452229022979736
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.703 Test Loss: 1.182 Test Acc: 0.703
Validation loss decreased (-0.703322 --> -0.703322).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7033333333333334
model parameter : 1224217
model size : 9.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.40122127532959
Epoch: 1, Steps: 18 | Train Loss: 3.325 Vali Loss: 3.248 Vali Acc: 0.057 Test Loss: 3.248 Test Acc: 0.057
Validation loss decreased (inf --> -0.056634).  Saving model ...
Epoch: 2 cost time: 7.016108512878418
Epoch: 2, Steps: 18 | Train Loss: 2.862 Vali Loss: 3.126 Vali Acc: 0.060 Test Loss: 3.126 Test Acc: 0.060
Validation loss decreased (-0.056634 --> -0.059969).  Saving model ...
Epoch: 3 cost time: 7.386862277984619
Epoch: 3, Steps: 18 | Train Loss: 2.212 Vali Loss: 2.955 Vali Acc: 0.117 Test Loss: 2.955 Test Acc: 0.117
Validation loss decreased (-0.059969 --> -0.116637).  Saving model ...
Epoch: 4 cost time: 7.001553297042847
Epoch: 4, Steps: 18 | Train Loss: 1.464 Vali Loss: 2.820 Vali Acc: 0.157 Test Loss: 2.820 Test Acc: 0.157
Validation loss decreased (-0.116637 --> -0.156638).  Saving model ...
Epoch: 5 cost time: 7.602871656417847
Epoch: 5, Steps: 18 | Train Loss: 0.834 Vali Loss: 2.649 Vali Acc: 0.183 Test Loss: 2.649 Test Acc: 0.183
Validation loss decreased (-0.156638 --> -0.183307).  Saving model ...
Epoch: 6 cost time: 6.987157344818115
Epoch: 6, Steps: 18 | Train Loss: 0.393 Vali Loss: 2.418 Vali Acc: 0.277 Test Loss: 2.418 Test Acc: 0.277
Validation loss decreased (-0.183307 --> -0.276642).  Saving model ...
Epoch: 7 cost time: 7.721928596496582
Epoch: 7, Steps: 18 | Train Loss: 0.142 Vali Loss: 2.190 Vali Acc: 0.303 Test Loss: 2.190 Test Acc: 0.303
Validation loss decreased (-0.276642 --> -0.303311).  Saving model ...
Epoch: 8 cost time: 7.66800856590271
Epoch: 8, Steps: 18 | Train Loss: 0.055 Vali Loss: 1.921 Vali Acc: 0.387 Test Loss: 1.921 Test Acc: 0.387
Validation loss decreased (-0.303311 --> -0.386647).  Saving model ...
Epoch: 9 cost time: 7.387616395950317
Epoch: 9, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.776 Vali Acc: 0.453 Test Loss: 1.776 Test Acc: 0.453
Validation loss decreased (-0.386647 --> -0.453316).  Saving model ...
Epoch: 10 cost time: 7.4942240715026855
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.775 Vali Acc: 0.443 Test Loss: 1.775 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.1296470165252686
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.672 Vali Acc: 0.470 Test Loss: 1.672 Test Acc: 0.470
Validation loss decreased (-0.453316 --> -0.469983).  Saving model ...
Epoch: 12 cost time: 6.995527744293213
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.625 Vali Acc: 0.493 Test Loss: 1.625 Test Acc: 0.493
Validation loss decreased (-0.469983 --> -0.493317).  Saving model ...
Epoch: 13 cost time: 7.17926549911499
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.582 Vali Acc: 0.503 Test Loss: 1.582 Test Acc: 0.503
Validation loss decreased (-0.493317 --> -0.503318).  Saving model ...
Epoch: 14 cost time: 6.933180809020996
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.549 Vali Acc: 0.510 Test Loss: 1.549 Test Acc: 0.510
Validation loss decreased (-0.503318 --> -0.509985).  Saving model ...
Epoch: 15 cost time: 7.229138135910034
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.539 Vali Acc: 0.517 Test Loss: 1.539 Test Acc: 0.517
Validation loss decreased (-0.509985 --> -0.516651).  Saving model ...
Epoch: 16 cost time: 7.163411617279053
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.499 Vali Acc: 0.537 Test Loss: 1.499 Test Acc: 0.537
Validation loss decreased (-0.516651 --> -0.536652).  Saving model ...
Epoch: 17 cost time: 7.291939973831177
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.463 Vali Acc: 0.547 Test Loss: 1.463 Test Acc: 0.547
Validation loss decreased (-0.536652 --> -0.546652).  Saving model ...
Epoch: 18 cost time: 7.673491477966309
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.440 Vali Acc: 0.547 Test Loss: 1.440 Test Acc: 0.547
Validation loss decreased (-0.546652 --> -0.546652).  Saving model ...
Epoch: 19 cost time: 7.724897384643555
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.434 Vali Acc: 0.557 Test Loss: 1.434 Test Acc: 0.557
Validation loss decreased (-0.546652 --> -0.556652).  Saving model ...
Epoch: 20 cost time: 7.01083517074585
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.423 Vali Acc: 0.560 Test Loss: 1.423 Test Acc: 0.560
Validation loss decreased (-0.556652 --> -0.559986).  Saving model ...
Epoch: 21 cost time: 7.5123865604400635
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.399 Vali Acc: 0.567 Test Loss: 1.399 Test Acc: 0.567
Validation loss decreased (-0.559986 --> -0.566653).  Saving model ...
Epoch: 22 cost time: 7.008963108062744
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.388 Vali Acc: 0.570 Test Loss: 1.388 Test Acc: 0.570
Validation loss decreased (-0.566653 --> -0.569986).  Saving model ...
Epoch: 23 cost time: 7.576421499252319
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.370 Vali Acc: 0.583 Test Loss: 1.370 Test Acc: 0.583
Validation loss decreased (-0.569986 --> -0.583320).  Saving model ...
Epoch: 24 cost time: 7.925400495529175
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.346 Vali Acc: 0.607 Test Loss: 1.346 Test Acc: 0.607
Validation loss decreased (-0.583320 --> -0.606653).  Saving model ...
Epoch: 25 cost time: 7.821782827377319
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.337 Vali Acc: 0.597 Test Loss: 1.337 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.944377660751343
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.338 Vali Acc: 0.597 Test Loss: 1.338 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 8.686817407608032
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.597 Test Loss: 1.330 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 7.295750617980957
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.311 Vali Acc: 0.597 Test Loss: 1.311 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 7.6291539669036865
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.299 Vali Acc: 0.610 Test Loss: 1.299 Test Acc: 0.610
Validation loss decreased (-0.606653 --> -0.609987).  Saving model ...
Epoch: 30 cost time: 7.366580247879028
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.289 Vali Acc: 0.623 Test Loss: 1.289 Test Acc: 0.623
Validation loss decreased (-0.609987 --> -0.623320).  Saving model ...
Epoch: 31 cost time: 7.777177572250366
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.283 Vali Acc: 0.617 Test Loss: 1.283 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 7.555450439453125
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.273 Vali Acc: 0.627 Test Loss: 1.273 Test Acc: 0.627
Validation loss decreased (-0.623320 --> -0.626654).  Saving model ...
Epoch: 33 cost time: 7.720960378646851
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.268 Vali Acc: 0.630 Test Loss: 1.268 Test Acc: 0.630
Validation loss decreased (-0.626654 --> -0.629987).  Saving model ...
Epoch: 34 cost time: 7.7843732833862305
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.262 Vali Acc: 0.623 Test Loss: 1.262 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 7.572052717208862
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.252 Vali Acc: 0.630 Test Loss: 1.252 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 36 cost time: 7.058014869689941
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.250 Vali Acc: 0.627 Test Loss: 1.250 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.617916107177734
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.244 Vali Acc: 0.637 Test Loss: 1.244 Test Acc: 0.637
Validation loss decreased (-0.629987 --> -0.636654).  Saving model ...
Epoch: 38 cost time: 7.291013717651367
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.643 Test Loss: 1.239 Test Acc: 0.643
Validation loss decreased (-0.636654 --> -0.643321).  Saving model ...
Epoch: 39 cost time: 7.5505805015563965
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.237 Vali Acc: 0.640 Test Loss: 1.237 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 7.726475477218628
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.647 Test Loss: 1.235 Test Acc: 0.647
Validation loss decreased (-0.643321 --> -0.646654).  Saving model ...
Epoch: 41 cost time: 7.861034870147705
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.653 Test Loss: 1.227 Test Acc: 0.653
Validation loss decreased (-0.646654 --> -0.653321).  Saving model ...
Epoch: 42 cost time: 7.745367050170898
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.650 Test Loss: 1.227 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 7.299470901489258
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.657 Test Loss: 1.222 Test Acc: 0.657
Validation loss decreased (-0.653321 --> -0.656654).  Saving model ...
Epoch: 44 cost time: 7.422273874282837
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.653 Test Loss: 1.222 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 7.169307231903076
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.653 Test Loss: 1.215 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 6.937417030334473
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.660 Test Loss: 1.207 Test Acc: 0.660
Validation loss decreased (-0.656654 --> -0.659988).  Saving model ...
Epoch: 47 cost time: 6.946391582489014
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.663 Test Loss: 1.209 Test Acc: 0.663
Validation loss decreased (-0.659988 --> -0.663321).  Saving model ...
Epoch: 48 cost time: 7.905343294143677
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.663 Test Loss: 1.202 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 49 cost time: 8.16506028175354
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.663 Test Loss: 1.199 Test Acc: 0.663
Validation loss decreased (-0.663321 --> -0.663321).  Saving model ...
Epoch: 50 cost time: 7.9628119468688965
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.667 Test Loss: 1.195 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666655).  Saving model ...
Epoch: 51 cost time: 7.6952526569366455
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.667 Test Loss: 1.193 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 52 cost time: 7.109704494476318
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.673 Test Loss: 1.189 Test Acc: 0.673
Validation loss decreased (-0.666655 --> -0.673321).  Saving model ...
Epoch: 53 cost time: 7.533366441726685
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.667 Test Loss: 1.184 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 7.085784673690796
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.670 Test Loss: 1.181 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.851866960525513
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.670 Test Loss: 1.177 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 7.5331079959869385
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.176 Vali Acc: 0.673 Test Loss: 1.176 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673322).  Saving model ...
Epoch: 57 cost time: 7.7278969287872314
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.673 Test Loss: 1.175 Test Acc: 0.673
Validation loss decreased (-0.673322 --> -0.673322).  Saving model ...
Epoch: 58 cost time: 7.536116361618042
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.677 Test Loss: 1.173 Test Acc: 0.677
Validation loss decreased (-0.673322 --> -0.676655).  Saving model ...
Epoch: 59 cost time: 7.700567245483398
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.680 Test Loss: 1.173 Test Acc: 0.680
Validation loss decreased (-0.676655 --> -0.679988).  Saving model ...
Epoch: 60 cost time: 7.3144371509552
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.680 Test Loss: 1.173 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.7882232666015625
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.168 Vali Acc: 0.683 Test Loss: 1.168 Test Acc: 0.683
Validation loss decreased (-0.679988 --> -0.683322).  Saving model ...
Epoch: 62 cost time: 7.054346561431885
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.166 Vali Acc: 0.680 Test Loss: 1.166 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 7.387160301208496
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.166 Vali Acc: 0.683 Test Loss: 1.166 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 64 cost time: 7.145639181137085
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.164 Vali Acc: 0.690 Test Loss: 1.164 Test Acc: 0.690
Validation loss decreased (-0.683322 --> -0.689988).  Saving model ...
Epoch: 65 cost time: 7.901895999908447
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.165 Vali Acc: 0.683 Test Loss: 1.165 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 7.390329837799072
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.164 Vali Acc: 0.690 Test Loss: 1.164 Test Acc: 0.690
Validation loss decreased (-0.689988 --> -0.689988).  Saving model ...
Epoch: 67 cost time: 7.488374710083008
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.163 Vali Acc: 0.693 Test Loss: 1.163 Test Acc: 0.693
Validation loss decreased (-0.689988 --> -0.693322).  Saving model ...
Epoch: 68 cost time: 7.481177806854248
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.163 Vali Acc: 0.697 Test Loss: 1.163 Test Acc: 0.697
Validation loss decreased (-0.693322 --> -0.696655).  Saving model ...
Epoch: 69 cost time: 6.730772495269775
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.161 Vali Acc: 0.700 Test Loss: 1.161 Test Acc: 0.700
Validation loss decreased (-0.696655 --> -0.699988).  Saving model ...
Epoch: 70 cost time: 6.899967670440674
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.157 Vali Acc: 0.693 Test Loss: 1.157 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 6.813584327697754
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.157 Vali Acc: 0.697 Test Loss: 1.157 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 7.885352611541748
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.157 Vali Acc: 0.693 Test Loss: 1.157 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 7.330143690109253
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.156 Vali Acc: 0.697 Test Loss: 1.156 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 7.125124216079712
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.152 Vali Acc: 0.697 Test Loss: 1.152 Test Acc: 0.697
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 7.302984714508057
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.700 Test Loss: 1.150 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 76 cost time: 7.01417088508606
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.149 Vali Acc: 0.707 Test Loss: 1.149 Test Acc: 0.707
Validation loss decreased (-0.699989 --> -0.706655).  Saving model ...
Epoch: 77 cost time: 6.70716667175293
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.146 Vali Acc: 0.707 Test Loss: 1.146 Test Acc: 0.707
Validation loss decreased (-0.706655 --> -0.706655).  Saving model ...
Epoch: 78 cost time: 6.928552865982056
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.143 Vali Acc: 0.707 Test Loss: 1.143 Test Acc: 0.707
Validation loss decreased (-0.706655 --> -0.706655).  Saving model ...
Epoch: 79 cost time: 6.4536638259887695
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.710 Test Loss: 1.141 Test Acc: 0.710
Validation loss decreased (-0.706655 --> -0.709989).  Saving model ...
Epoch: 80 cost time: 6.67810583114624
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.707 Test Loss: 1.141 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 7.1590540409088135
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.140 Vali Acc: 0.707 Test Loss: 1.140 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 7.028388261795044
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.710 Test Loss: 1.139 Test Acc: 0.710
Validation loss decreased (-0.709989 --> -0.709989).  Saving model ...
Epoch: 83 cost time: 7.450144290924072
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.713 Test Loss: 1.137 Test Acc: 0.713
Validation loss decreased (-0.709989 --> -0.713322).  Saving model ...
Epoch: 84 cost time: 7.564328193664551
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.713 Test Loss: 1.137 Test Acc: 0.713
Validation loss decreased (-0.713322 --> -0.713322).  Saving model ...
Epoch: 85 cost time: 7.118801116943359
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.713 Test Loss: 1.137 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 7.5110249519348145
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.717 Test Loss: 1.139 Test Acc: 0.717
Validation loss decreased (-0.713322 --> -0.716655).  Saving model ...
Epoch: 87 cost time: 7.180977821350098
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.136 Vali Acc: 0.717 Test Loss: 1.136 Test Acc: 0.717
Validation loss decreased (-0.716655 --> -0.716655).  Saving model ...
Epoch: 88 cost time: 7.262815237045288
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.713 Test Loss: 1.137 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 7.761962175369263
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.138 Vali Acc: 0.707 Test Loss: 1.138 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 8.11421012878418
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.710 Test Loss: 1.134 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 7.844803810119629
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.707 Test Loss: 1.134 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 7.795559406280518
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.710 Test Loss: 1.137 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 7.598668098449707
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.136 Vali Acc: 0.710 Test Loss: 1.136 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 7.731776475906372
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.136 Vali Acc: 0.723 Test Loss: 1.136 Test Acc: 0.723
Validation loss decreased (-0.716655 --> -0.723322).  Saving model ...
Epoch: 95 cost time: 7.7370264530181885
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.717 Test Loss: 1.134 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 7.6248345375061035
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.129 Vali Acc: 0.720 Test Loss: 1.129 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 7.930159330368042
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.131 Vali Acc: 0.723 Test Loss: 1.131 Test Acc: 0.723
Validation loss decreased (-0.723322 --> -0.723322).  Saving model ...
Epoch: 98 cost time: 7.813850402832031
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.130 Vali Acc: 0.720 Test Loss: 1.130 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 8.01102876663208
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.720 Test Loss: 1.128 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 7.569953918457031
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.126 Vali Acc: 0.723 Test Loss: 1.126 Test Acc: 0.723
Validation loss decreased (-0.723322 --> -0.723322).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7233333333333334
model parameter : 1224217
model size : 9.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.163097381591797
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 7.27636456489563
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 3 cost time: 7.241587400436401
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.671292304992676
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.949388265609741
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.748057842254639
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.235732078552246
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 8 cost time: 6.970630407333374
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 9 cost time: 6.995049238204956
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.021311283111572
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.474706411361694
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 12 cost time: 7.304153680801392
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 13 cost time: 7.345219373703003
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 14 cost time: 7.66666841506958
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.799241542816162
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.5639073848724365
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.686879634857178
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.989573955535889
Epoch: 18, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 19 cost time: 7.796096563339233
Epoch: 19, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 20 cost time: 8.533900499343872
Epoch: 20, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.4162983894348145
Epoch: 21, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 22 cost time: 7.730601072311401
Epoch: 22, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 23 cost time: 7.708041667938232
Epoch: 23, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.795708179473877
Epoch: 24, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.264995098114014
Epoch: 25, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 26 cost time: 7.544917345046997
Epoch: 26, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.74884819984436
Epoch: 27, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.35493540763855
Epoch: 28, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 8.093596458435059
Epoch: 29, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 8.311760187149048
Epoch: 30, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 8.379690408706665
Epoch: 31, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 7.165916681289673
Epoch: 32, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 7.146195650100708
Epoch: 33, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.723711729049683
Epoch: 34, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 7.316395282745361
Epoch: 35, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 1224217
model size : 9.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.86897897720337
Epoch: 1, Steps: 18 | Train Loss: 3.151 Vali Loss: 2.723 Vali Acc: 0.407 Test Loss: 2.723 Test Acc: 0.407
Validation loss decreased (inf --> -0.406639).  Saving model ...
Epoch: 2 cost time: 7.403883457183838
Epoch: 2, Steps: 18 | Train Loss: 2.251 Vali Loss: 1.714 Vali Acc: 0.740 Test Loss: 1.714 Test Acc: 0.740
Validation loss decreased (-0.406639 --> -0.739983).  Saving model ...
Epoch: 3 cost time: 7.471011400222778
Epoch: 3, Steps: 18 | Train Loss: 1.121 Vali Loss: 0.972 Vali Acc: 0.837 Test Loss: 0.972 Test Acc: 0.837
Validation loss decreased (-0.739983 --> -0.836657).  Saving model ...
Epoch: 4 cost time: 6.7977354526519775
Epoch: 4, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.629 Vali Acc: 0.860 Test Loss: 0.629 Test Acc: 0.860
Validation loss decreased (-0.836657 --> -0.859994).  Saving model ...
Epoch: 5 cost time: 6.761906862258911
Epoch: 5, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.491 Vali Acc: 0.887 Test Loss: 0.491 Test Acc: 0.887
Validation loss decreased (-0.859994 --> -0.886662).  Saving model ...
Epoch: 6 cost time: 7.027190208435059
Epoch: 6, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.438 Vali Acc: 0.897 Test Loss: 0.438 Test Acc: 0.897
Validation loss decreased (-0.886662 --> -0.896662).  Saving model ...
Epoch: 7 cost time: 7.297975540161133
Epoch: 7, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.418 Vali Acc: 0.890 Test Loss: 0.418 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.5069520473480225
Epoch: 8, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.390 Vali Acc: 0.897 Test Loss: 0.390 Test Acc: 0.897
Validation loss decreased (-0.896662 --> -0.896663).  Saving model ...
Epoch: 9 cost time: 7.063439846038818
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
Validation loss decreased (-0.896663 --> -0.903330).  Saving model ...
Epoch: 10 cost time: 7.264204502105713
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 11 cost time: 7.245577573776245
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 12 cost time: 6.6965649127960205
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 13 cost time: 6.358360290527344
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.487276554107666
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.361 Vali Acc: 0.910 Test Loss: 0.361 Test Acc: 0.910
Validation loss decreased (-0.903330 --> -0.909996).  Saving model ...
Epoch: 15 cost time: 6.453084230422974
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.355 Vali Acc: 0.910 Test Loss: 0.355 Test Acc: 0.910
Validation loss decreased (-0.909996 --> -0.909996).  Saving model ...
Epoch: 16 cost time: 7.167178392410278
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.910373687744141
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.58867073059082
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.492840051651001
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.178358793258667
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.694823980331421
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.345 Vali Acc: 0.907 Test Loss: 0.345 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.1542649269104
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.342 Vali Acc: 0.907 Test Loss: 0.342 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.32310938835144
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.340 Vali Acc: 0.907 Test Loss: 0.340 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.609204053878784
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.858698606491089
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.91
model parameter : 1185561
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.085317373275757
Epoch: 1, Steps: 18 | Train Loss: 3.194 Vali Loss: 2.859 Vali Acc: 0.337 Test Loss: 2.859 Test Acc: 0.337
Validation loss decreased (inf --> -0.336638).  Saving model ...
Epoch: 2 cost time: 6.676109790802002
Epoch: 2, Steps: 18 | Train Loss: 2.467 Vali Loss: 2.046 Vali Acc: 0.680 Test Loss: 2.046 Test Acc: 0.680
Validation loss decreased (-0.336638 --> -0.679980).  Saving model ...
Epoch: 3 cost time: 6.95490574836731
Epoch: 3, Steps: 18 | Train Loss: 1.430 Vali Loss: 1.305 Vali Acc: 0.783 Test Loss: 1.305 Test Acc: 0.783
Validation loss decreased (-0.679980 --> -0.783320).  Saving model ...
Epoch: 4 cost time: 6.366323947906494
Epoch: 4, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.886 Vali Acc: 0.817 Test Loss: 0.886 Test Acc: 0.817
Validation loss decreased (-0.783320 --> -0.816658).  Saving model ...
Epoch: 5 cost time: 6.560384035110474
Epoch: 5, Steps: 18 | Train Loss: 0.275 Vali Loss: 0.702 Vali Acc: 0.840 Test Loss: 0.702 Test Acc: 0.840
Validation loss decreased (-0.816658 --> -0.839993).  Saving model ...
Epoch: 6 cost time: 6.541025400161743
Epoch: 6, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.616 Vali Acc: 0.847 Test Loss: 0.616 Test Acc: 0.847
Validation loss decreased (-0.839993 --> -0.846661).  Saving model ...
Epoch: 7 cost time: 6.66958475112915
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
Validation loss decreased (-0.846661 --> -0.849994).  Saving model ...
Epoch: 8 cost time: 6.870349168777466
Epoch: 8, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 9 cost time: 6.915857791900635
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.543 Vali Acc: 0.863 Test Loss: 0.543 Test Acc: 0.863
Validation loss decreased (-0.849994 --> -0.863328).  Saving model ...
Epoch: 10 cost time: 6.459705829620361
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.532 Vali Acc: 0.860 Test Loss: 0.532 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.5068793296813965
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.527 Vali Acc: 0.853 Test Loss: 0.527 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.37462306022644
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.519 Vali Acc: 0.860 Test Loss: 0.519 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.565442800521851
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.4667439460754395
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.521 Vali Acc: 0.860 Test Loss: 0.521 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.790823459625244
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.514 Vali Acc: 0.860 Test Loss: 0.514 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.502123832702637
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.510 Vali Acc: 0.860 Test Loss: 0.510 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.564784288406372
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
Validation loss decreased (-0.863328 --> -0.866662).  Saving model ...
Epoch: 18 cost time: 6.653162956237793
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.757234334945679
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.798974275588989
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.508 Vali Acc: 0.860 Test Loss: 0.508 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.969133377075195
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.506 Vali Acc: 0.863 Test Loss: 0.506 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.2649431228637695
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.9378931522369385
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.504 Vali Acc: 0.867 Test Loss: 0.504 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 24 cost time: 6.7056450843811035
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.501 Vali Acc: 0.870 Test Loss: 0.501 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.869995).  Saving model ...
Epoch: 25 cost time: 6.570448637008667
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.501 Vali Acc: 0.863 Test Loss: 0.501 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.5513916015625
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.504 Vali Acc: 0.863 Test Loss: 0.504 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.684542655944824
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.860 Test Loss: 0.504 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.819981575012207
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.867 Test Loss: 0.504 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.673470497131348
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.870 Test Loss: 0.506 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 7.136265516281128
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.867 Test Loss: 0.506 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.9382548332214355
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.870 Test Loss: 0.505 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.608879327774048
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 7.01863431930542
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.867 Test Loss: 0.504 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.715791940689087
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.87
model parameter : 1185561
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.970425128936768
Epoch: 1, Steps: 18 | Train Loss: 3.263 Vali Loss: 3.009 Vali Acc: 0.167 Test Loss: 3.009 Test Acc: 0.167
Validation loss decreased (inf --> -0.166637).  Saving model ...
Epoch: 2 cost time: 7.366888046264648
Epoch: 2, Steps: 18 | Train Loss: 2.707 Vali Loss: 2.452 Vali Acc: 0.553 Test Loss: 2.452 Test Acc: 0.553
Validation loss decreased (-0.166637 --> -0.553309).  Saving model ...
Epoch: 3 cost time: 7.178997278213501
Epoch: 3, Steps: 18 | Train Loss: 1.884 Vali Loss: 1.839 Vali Acc: 0.687 Test Loss: 1.839 Test Acc: 0.687
Validation loss decreased (-0.553309 --> -0.686648).  Saving model ...
Epoch: 4 cost time: 7.1835246086120605
Epoch: 4, Steps: 18 | Train Loss: 1.084 Vali Loss: 1.356 Vali Acc: 0.730 Test Loss: 1.356 Test Acc: 0.730
Validation loss decreased (-0.686648 --> -0.729986).  Saving model ...
Epoch: 5 cost time: 6.854956865310669
Epoch: 5, Steps: 18 | Train Loss: 0.490 Vali Loss: 1.070 Vali Acc: 0.763 Test Loss: 1.070 Test Acc: 0.763
Validation loss decreased (-0.729986 --> -0.763323).  Saving model ...
Epoch: 6 cost time: 6.6874353885650635
Epoch: 6, Steps: 18 | Train Loss: 0.207 Vali Loss: 0.914 Vali Acc: 0.787 Test Loss: 0.914 Test Acc: 0.787
Validation loss decreased (-0.763323 --> -0.786658).  Saving model ...
Epoch: 7 cost time: 6.975946664810181
Epoch: 7, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.866 Vali Acc: 0.777 Test Loss: 0.866 Test Acc: 0.777
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.883490085601807
Epoch: 8, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.830 Vali Acc: 0.793 Test Loss: 0.830 Test Acc: 0.793
Validation loss decreased (-0.786658 --> -0.793325).  Saving model ...
Epoch: 9 cost time: 7.609977722167969
Epoch: 9, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.821 Vali Acc: 0.787 Test Loss: 0.821 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.467518091201782
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.811 Vali Acc: 0.797 Test Loss: 0.811 Test Acc: 0.797
Validation loss decreased (-0.793325 --> -0.796659).  Saving model ...
Epoch: 11 cost time: 7.036448240280151
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.804 Vali Acc: 0.797 Test Loss: 0.804 Test Acc: 0.797
Validation loss decreased (-0.796659 --> -0.796659).  Saving model ...
Epoch: 12 cost time: 7.131758689880371
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.793 Vali Acc: 0.800 Test Loss: 0.793 Test Acc: 0.800
Validation loss decreased (-0.796659 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 7.0056586265563965
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.800 Vali Acc: 0.797 Test Loss: 0.800 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.5387489795684814
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.797 Vali Acc: 0.797 Test Loss: 0.797 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.753701210021973
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.807 Test Loss: 0.789 Test Acc: 0.807
Validation loss decreased (-0.799992 --> -0.806659).  Saving model ...
Epoch: 16 cost time: 6.341881036758423
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.784 Vali Acc: 0.793 Test Loss: 0.784 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.820002317428589
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.782 Vali Acc: 0.800 Test Loss: 0.782 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.815233469009399
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.782 Vali Acc: 0.803 Test Loss: 0.782 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.926393747329712
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.779 Vali Acc: 0.797 Test Loss: 0.779 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.331277132034302
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.782 Vali Acc: 0.807 Test Loss: 0.782 Test Acc: 0.807
Validation loss decreased (-0.806659 --> -0.806659).  Saving model ...
Epoch: 21 cost time: 7.037244081497192
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.779 Vali Acc: 0.807 Test Loss: 0.779 Test Acc: 0.807
Validation loss decreased (-0.806659 --> -0.806659).  Saving model ...
Epoch: 22 cost time: 6.609282970428467
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.780 Vali Acc: 0.813 Test Loss: 0.780 Test Acc: 0.813
Validation loss decreased (-0.806659 --> -0.813326).  Saving model ...
Epoch: 23 cost time: 6.859487771987915
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.810 Test Loss: 0.778 Test Acc: 0.810
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.93659234046936
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.777 Vali Acc: 0.803 Test Loss: 0.777 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.455629348754883
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.775 Vali Acc: 0.803 Test Loss: 0.775 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.934880495071411
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.779 Vali Acc: 0.800 Test Loss: 0.779 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.4056715965271
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.803 Test Loss: 0.778 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.377761125564575
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.776 Vali Acc: 0.810 Test Loss: 0.776 Test Acc: 0.810
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.460813522338867
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.810 Test Loss: 0.778 Test Acc: 0.810
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.959774017333984
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.803 Test Loss: 0.779 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.717803955078125
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.803 Test Loss: 0.780 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.781572341918945
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.810 Test Loss: 0.778 Test Acc: 0.810
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8133333333333334
model parameter : 1185561
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.742974758148193
Epoch: 1, Steps: 18 | Train Loss: 3.277 Vali Loss: 3.103 Vali Acc: 0.133 Test Loss: 3.103 Test Acc: 0.133
Validation loss decreased (inf --> -0.133302).  Saving model ...
Epoch: 2 cost time: 6.950717926025391
Epoch: 2, Steps: 18 | Train Loss: 2.893 Vali Loss: 2.762 Vali Acc: 0.373 Test Loss: 2.762 Test Acc: 0.373
Validation loss decreased (-0.133302 --> -0.373306).  Saving model ...
Epoch: 3 cost time: 6.956650018692017
Epoch: 3, Steps: 18 | Train Loss: 2.262 Vali Loss: 2.366 Vali Acc: 0.477 Test Loss: 2.366 Test Acc: 0.477
Validation loss decreased (-0.373306 --> -0.476643).  Saving model ...
Epoch: 4 cost time: 7.126967668533325
Epoch: 4, Steps: 18 | Train Loss: 1.579 Vali Loss: 1.976 Vali Acc: 0.537 Test Loss: 1.976 Test Acc: 0.537
Validation loss decreased (-0.476643 --> -0.536647).  Saving model ...
Epoch: 5 cost time: 6.562507390975952
Epoch: 5, Steps: 18 | Train Loss: 0.912 Vali Loss: 1.650 Vali Acc: 0.597 Test Loss: 1.650 Test Acc: 0.597
Validation loss decreased (-0.536647 --> -0.596650).  Saving model ...
Epoch: 6 cost time: 6.934721231460571
Epoch: 6, Steps: 18 | Train Loss: 0.451 Vali Loss: 1.452 Vali Acc: 0.603 Test Loss: 1.452 Test Acc: 0.603
Validation loss decreased (-0.596650 --> -0.603319).  Saving model ...
Epoch: 7 cost time: 6.862154006958008
Epoch: 7, Steps: 18 | Train Loss: 0.185 Vali Loss: 1.323 Vali Acc: 0.620 Test Loss: 1.323 Test Acc: 0.620
Validation loss decreased (-0.603319 --> -0.619987).  Saving model ...
Epoch: 8 cost time: 7.21681547164917
Epoch: 8, Steps: 18 | Train Loss: 0.083 Vali Loss: 1.263 Vali Acc: 0.623 Test Loss: 1.263 Test Acc: 0.623
Validation loss decreased (-0.619987 --> -0.623321).  Saving model ...
Epoch: 9 cost time: 7.172963380813599
Epoch: 9, Steps: 18 | Train Loss: 0.044 Vali Loss: 1.214 Vali Acc: 0.637 Test Loss: 1.214 Test Acc: 0.637
Validation loss decreased (-0.623321 --> -0.636655).  Saving model ...
Epoch: 10 cost time: 7.046691656112671
Epoch: 10, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.181 Vali Acc: 0.637 Test Loss: 1.181 Test Acc: 0.637
Validation loss decreased (-0.636655 --> -0.636655).  Saving model ...
Epoch: 11 cost time: 7.2612996101379395
Epoch: 11, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.178 Vali Acc: 0.650 Test Loss: 1.178 Test Acc: 0.650
Validation loss decreased (-0.636655 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 7.350604057312012
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.172 Vali Acc: 0.653 Test Loss: 1.172 Test Acc: 0.653
Validation loss decreased (-0.649988 --> -0.653322).  Saving model ...
Epoch: 13 cost time: 6.538309097290039
Epoch: 13, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.154 Vali Acc: 0.653 Test Loss: 1.154 Test Acc: 0.653
Validation loss decreased (-0.653322 --> -0.653322).  Saving model ...
Epoch: 14 cost time: 6.960534334182739
Epoch: 14, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.142 Vali Acc: 0.647 Test Loss: 1.142 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.6802191734313965
Epoch: 15, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.135 Vali Acc: 0.647 Test Loss: 1.135 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.750009775161743
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.130 Vali Acc: 0.650 Test Loss: 1.130 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.306093454360962
Epoch: 17, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.115 Vali Acc: 0.673 Test Loss: 1.115 Test Acc: 0.673
Validation loss decreased (-0.653322 --> -0.673322).  Saving model ...
Epoch: 18 cost time: 7.958931922912598
Epoch: 18, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.109 Vali Acc: 0.680 Test Loss: 1.109 Test Acc: 0.680
Validation loss decreased (-0.673322 --> -0.679989).  Saving model ...
Epoch: 19 cost time: 7.892166376113892
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.106 Vali Acc: 0.680 Test Loss: 1.106 Test Acc: 0.680
Validation loss decreased (-0.679989 --> -0.679989).  Saving model ...
Epoch: 20 cost time: 7.701319932937622
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.103 Vali Acc: 0.680 Test Loss: 1.103 Test Acc: 0.680
Validation loss decreased (-0.679989 --> -0.679989).  Saving model ...
Epoch: 21 cost time: 7.051281690597534
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.098 Vali Acc: 0.683 Test Loss: 1.098 Test Acc: 0.683
Validation loss decreased (-0.679989 --> -0.683322).  Saving model ...
Epoch: 22 cost time: 7.430961847305298
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.101 Vali Acc: 0.680 Test Loss: 1.101 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.573637962341309
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.099 Vali Acc: 0.687 Test Loss: 1.099 Test Acc: 0.687
Validation loss decreased (-0.683322 --> -0.686656).  Saving model ...
Epoch: 24 cost time: 8.061280727386475
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.088 Vali Acc: 0.677 Test Loss: 1.088 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.717378616333008
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.079 Vali Acc: 0.687 Test Loss: 1.079 Test Acc: 0.687
Validation loss decreased (-0.686656 --> -0.686656).  Saving model ...
Epoch: 26 cost time: 7.625581741333008
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.077 Vali Acc: 0.687 Test Loss: 1.077 Test Acc: 0.687
Validation loss decreased (-0.686656 --> -0.686656).  Saving model ...
Epoch: 27 cost time: 7.685776710510254
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.073 Vali Acc: 0.687 Test Loss: 1.073 Test Acc: 0.687
Validation loss decreased (-0.686656 --> -0.686656).  Saving model ...
Epoch: 28 cost time: 7.153157949447632
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.073 Vali Acc: 0.680 Test Loss: 1.073 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.105902433395386
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.069 Vali Acc: 0.683 Test Loss: 1.069 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 7.3788557052612305
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.062 Vali Acc: 0.693 Test Loss: 1.062 Test Acc: 0.693
Validation loss decreased (-0.686656 --> -0.693323).  Saving model ...
Epoch: 31 cost time: 6.818374872207642
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.061 Vali Acc: 0.687 Test Loss: 1.061 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 7.216421127319336
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.058 Vali Acc: 0.703 Test Loss: 1.058 Test Acc: 0.703
Validation loss decreased (-0.693323 --> -0.703323).  Saving model ...
Epoch: 33 cost time: 7.913098573684692
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.054 Vali Acc: 0.700 Test Loss: 1.054 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 7.798354387283325
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.050 Vali Acc: 0.710 Test Loss: 1.050 Test Acc: 0.710
Validation loss decreased (-0.703323 --> -0.709990).  Saving model ...
Epoch: 35 cost time: 7.40419340133667
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.703 Test Loss: 1.046 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 7.042203426361084
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.700 Test Loss: 1.046 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 7.586211442947388
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.703 Test Loss: 1.046 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 7.568720102310181
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.700 Test Loss: 1.045 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 7.318105459213257
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.707 Test Loss: 1.045 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 7.427725076675415
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.040 Vali Acc: 0.707 Test Loss: 1.040 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 7.533947944641113
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.707 Test Loss: 1.036 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 7.731454133987427
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.034 Vali Acc: 0.713 Test Loss: 1.034 Test Acc: 0.713
Validation loss decreased (-0.709990 --> -0.713323).  Saving model ...
Epoch: 43 cost time: 7.6456708908081055
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.031 Vali Acc: 0.710 Test Loss: 1.031 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 7.145900011062622
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.028 Vali Acc: 0.713 Test Loss: 1.028 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 45 cost time: 6.624747037887573
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.028 Vali Acc: 0.710 Test Loss: 1.028 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.778777360916138
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.028 Vali Acc: 0.713 Test Loss: 1.028 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 47 cost time: 7.576149225234985
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.025 Vali Acc: 0.707 Test Loss: 1.025 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 7.652925729751587
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.026 Vali Acc: 0.720 Test Loss: 1.026 Test Acc: 0.720
Validation loss decreased (-0.713323 --> -0.719990).  Saving model ...
Epoch: 49 cost time: 7.879181146621704
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.025 Vali Acc: 0.717 Test Loss: 1.025 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 7.618255853652954
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.026 Vali Acc: 0.720 Test Loss: 1.026 Test Acc: 0.720
Validation loss decreased (-0.719990 --> -0.719990).  Saving model ...
Epoch: 51 cost time: 7.5946996212005615
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.717 Test Loss: 1.026 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 7.295079946517944
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.720 Test Loss: 1.024 Test Acc: 0.720
Validation loss decreased (-0.719990 --> -0.719990).  Saving model ...
Epoch: 53 cost time: 7.000816106796265
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.723 Test Loss: 1.018 Test Acc: 0.723
Validation loss decreased (-0.719990 --> -0.723323).  Saving model ...
Epoch: 54 cost time: 7.285746335983276
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.723 Test Loss: 1.015 Test Acc: 0.723
Validation loss decreased (-0.723323 --> -0.723323).  Saving model ...
Epoch: 55 cost time: 7.527901887893677
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.723 Test Loss: 1.017 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 7.684774160385132
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.720 Test Loss: 1.018 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 7.162373304367065
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.713 Test Loss: 1.019 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 7.336266040802002
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.720 Test Loss: 1.019 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 7.105206727981567
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.723 Test Loss: 1.017 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 6.9736328125
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.723 Test Loss: 1.015 Test Acc: 0.723
Validation loss decreased (-0.723323 --> -0.723323).  Saving model ...
Epoch: 61 cost time: 7.398764371871948
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.720 Test Loss: 1.013 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.976801633834839
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.717 Test Loss: 1.012 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 7.649829149246216
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.713 Test Loss: 1.011 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 7.9274742603302
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.717 Test Loss: 1.011 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 7.678812742233276
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.717 Test Loss: 1.011 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 6.911291837692261
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.723 Test Loss: 1.009 Test Acc: 0.723
Validation loss decreased (-0.723323 --> -0.723323).  Saving model ...
Epoch: 67 cost time: 7.374870777130127
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.720 Test Loss: 1.010 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 7.016498804092407
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.720 Test Loss: 1.009 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 6.74604344367981
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.006 Vali Acc: 0.727 Test Loss: 1.006 Test Acc: 0.727
Validation loss decreased (-0.723323 --> -0.726657).  Saving model ...
Epoch: 70 cost time: 6.750923156738281
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.727 Test Loss: 1.007 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 6.872808456420898
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.006 Vali Acc: 0.723 Test Loss: 1.006 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 7.231481075286865
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.727 Test Loss: 1.007 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 6.865544080734253
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.006 Vali Acc: 0.727 Test Loss: 1.006 Test Acc: 0.727
Validation loss decreased (-0.726657 --> -0.726657).  Saving model ...
Epoch: 74 cost time: 6.850287437438965
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.717 Test Loss: 1.008 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 6.758357763290405
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.717 Test Loss: 1.009 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 6.744828701019287
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.717 Test Loss: 1.008 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 6.580280780792236
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.720 Test Loss: 1.008 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 6.552451848983765
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.720 Test Loss: 1.008 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 6.719812631607056
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.720 Test Loss: 1.007 Test Acc: 0.720
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 6.930907726287842
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.717 Test Loss: 1.010 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 7.17465877532959
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.717 Test Loss: 1.010 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 7.005112171173096
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.723 Test Loss: 1.007 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 7.041862964630127
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.006 Vali Acc: 0.727 Test Loss: 1.006 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7266666666666667
model parameter : 1185561
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.024783372879028
Epoch: 1, Steps: 18 | Train Loss: 3.289 Vali Loss: 3.176 Vali Acc: 0.077 Test Loss: 3.176 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 6.214157819747925
Epoch: 2, Steps: 18 | Train Loss: 2.969 Vali Loss: 2.960 Vali Acc: 0.197 Test Loss: 2.960 Test Acc: 0.197
Validation loss decreased (-0.076635 --> -0.196637).  Saving model ...
Epoch: 3 cost time: 6.772751092910767
Epoch: 3, Steps: 18 | Train Loss: 2.451 Vali Loss: 2.710 Vali Acc: 0.293 Test Loss: 2.710 Test Acc: 0.293
Validation loss decreased (-0.196637 --> -0.293306).  Saving model ...
Epoch: 4 cost time: 7.222675800323486
Epoch: 4, Steps: 18 | Train Loss: 1.862 Vali Loss: 2.449 Vali Acc: 0.360 Test Loss: 2.449 Test Acc: 0.360
Validation loss decreased (-0.293306 --> -0.359976).  Saving model ...
Epoch: 5 cost time: 7.081212520599365
Epoch: 5, Steps: 18 | Train Loss: 1.225 Vali Loss: 2.222 Vali Acc: 0.410 Test Loss: 2.222 Test Acc: 0.410
Validation loss decreased (-0.359976 --> -0.409978).  Saving model ...
Epoch: 6 cost time: 6.853984355926514
Epoch: 6, Steps: 18 | Train Loss: 0.728 Vali Loss: 2.041 Vali Acc: 0.390 Test Loss: 2.041 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.3676111698150635
Epoch: 7, Steps: 18 | Train Loss: 0.363 Vali Loss: 1.951 Vali Acc: 0.430 Test Loss: 1.951 Test Acc: 0.430
Validation loss decreased (-0.409978 --> -0.429980).  Saving model ...
Epoch: 8 cost time: 6.714829444885254
Epoch: 8, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.851 Vali Acc: 0.420 Test Loss: 1.851 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.075175046920776
Epoch: 9, Steps: 18 | Train Loss: 0.086 Vali Loss: 1.784 Vali Acc: 0.447 Test Loss: 1.784 Test Acc: 0.447
Validation loss decreased (-0.429980 --> -0.446649).  Saving model ...
Epoch: 10 cost time: 6.227307081222534
Epoch: 10, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.718 Vali Acc: 0.433 Test Loss: 1.718 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.728199005126953
Epoch: 11, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.692 Vali Acc: 0.513 Test Loss: 1.692 Test Acc: 0.513
Validation loss decreased (-0.446649 --> -0.513316).  Saving model ...
Epoch: 12 cost time: 7.002413034439087
Epoch: 12, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.673 Vali Acc: 0.473 Test Loss: 1.673 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.523303031921387
Epoch: 13, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.642 Vali Acc: 0.473 Test Loss: 1.642 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.776087045669556
Epoch: 14, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.602 Vali Acc: 0.507 Test Loss: 1.602 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.702368974685669
Epoch: 15, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.575 Vali Acc: 0.503 Test Loss: 1.575 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.982533931732178
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.559 Vali Acc: 0.507 Test Loss: 1.559 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.333951950073242
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.544 Vali Acc: 0.520 Test Loss: 1.544 Test Acc: 0.520
Validation loss decreased (-0.513316 --> -0.519985).  Saving model ...
Epoch: 18 cost time: 6.5215630531311035
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.533 Vali Acc: 0.510 Test Loss: 1.533 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.682548522949219
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.529 Vali Acc: 0.520 Test Loss: 1.529 Test Acc: 0.520
Validation loss decreased (-0.519985 --> -0.519985).  Saving model ...
Epoch: 20 cost time: 6.253850936889648
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.517 Vali Acc: 0.513 Test Loss: 1.517 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.206148147583008
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.505 Vali Acc: 0.533 Test Loss: 1.505 Test Acc: 0.533
Validation loss decreased (-0.519985 --> -0.533318).  Saving model ...
Epoch: 22 cost time: 6.083348989486694
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.497 Vali Acc: 0.557 Test Loss: 1.497 Test Acc: 0.557
Validation loss decreased (-0.533318 --> -0.556652).  Saving model ...
Epoch: 23 cost time: 6.3654937744140625
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.484 Vali Acc: 0.537 Test Loss: 1.484 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.777384519577026
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.474 Vali Acc: 0.543 Test Loss: 1.474 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.490887880325317
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.466 Vali Acc: 0.560 Test Loss: 1.466 Test Acc: 0.560
Validation loss decreased (-0.556652 --> -0.559985).  Saving model ...
Epoch: 26 cost time: 6.470742464065552
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.463 Vali Acc: 0.563 Test Loss: 1.463 Test Acc: 0.563
Validation loss decreased (-0.559985 --> -0.563319).  Saving model ...
Epoch: 27 cost time: 6.747450113296509
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.460 Vali Acc: 0.560 Test Loss: 1.460 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.272870063781738
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.448 Vali Acc: 0.563 Test Loss: 1.448 Test Acc: 0.563
Validation loss decreased (-0.563319 --> -0.563319).  Saving model ...
Epoch: 29 cost time: 6.459519863128662
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.439 Vali Acc: 0.557 Test Loss: 1.439 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.796725749969482
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.428 Vali Acc: 0.563 Test Loss: 1.428 Test Acc: 0.563
Validation loss decreased (-0.563319 --> -0.563319).  Saving model ...
Epoch: 31 cost time: 6.3518736362457275
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.421 Vali Acc: 0.570 Test Loss: 1.421 Test Acc: 0.570
Validation loss decreased (-0.563319 --> -0.569986).  Saving model ...
Epoch: 32 cost time: 6.755341529846191
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.419 Vali Acc: 0.573 Test Loss: 1.419 Test Acc: 0.573
Validation loss decreased (-0.569986 --> -0.573319).  Saving model ...
Epoch: 33 cost time: 6.72304368019104
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.407 Vali Acc: 0.567 Test Loss: 1.407 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.512173652648926
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.394 Vali Acc: 0.577 Test Loss: 1.394 Test Acc: 0.577
Validation loss decreased (-0.573319 --> -0.576653).  Saving model ...
Epoch: 35 cost time: 6.700274467468262
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.580 Test Loss: 1.390 Test Acc: 0.580
Validation loss decreased (-0.576653 --> -0.579986).  Saving model ...
Epoch: 36 cost time: 6.844268798828125
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.389 Vali Acc: 0.573 Test Loss: 1.389 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.593179225921631
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.388 Vali Acc: 0.573 Test Loss: 1.388 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 6.7089409828186035
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.385 Vali Acc: 0.577 Test Loss: 1.385 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 6.993584394454956
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.577 Test Loss: 1.381 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 7.255391597747803
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.376 Vali Acc: 0.580 Test Loss: 1.376 Test Acc: 0.580
Validation loss decreased (-0.579986 --> -0.579986).  Saving model ...
Epoch: 41 cost time: 6.99080228805542
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.368 Vali Acc: 0.590 Test Loss: 1.368 Test Acc: 0.590
Validation loss decreased (-0.579986 --> -0.589986).  Saving model ...
Epoch: 42 cost time: 7.0342981815338135
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.367 Vali Acc: 0.587 Test Loss: 1.367 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 7.199522256851196
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.361 Vali Acc: 0.583 Test Loss: 1.361 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 6.838412523269653
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.356 Vali Acc: 0.600 Test Loss: 1.356 Test Acc: 0.600
Validation loss decreased (-0.589986 --> -0.599986).  Saving model ...
Epoch: 45 cost time: 6.80034613609314
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.352 Vali Acc: 0.593 Test Loss: 1.352 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.747349262237549
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.347 Vali Acc: 0.600 Test Loss: 1.347 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 47 cost time: 7.013820171356201
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.343 Vali Acc: 0.600 Test Loss: 1.343 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 48 cost time: 7.332628011703491
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.341 Vali Acc: 0.603 Test Loss: 1.341 Test Acc: 0.603
Validation loss decreased (-0.599987 --> -0.603320).  Saving model ...
Epoch: 49 cost time: 7.377991676330566
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.340 Vali Acc: 0.597 Test Loss: 1.340 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 7.278693199157715
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.337 Vali Acc: 0.603 Test Loss: 1.337 Test Acc: 0.603
Validation loss decreased (-0.603320 --> -0.603320).  Saving model ...
Epoch: 51 cost time: 6.894649267196655
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.333 Vali Acc: 0.597 Test Loss: 1.333 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.596977233886719
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.607 Test Loss: 1.328 Test Acc: 0.607
Validation loss decreased (-0.603320 --> -0.606653).  Saving model ...
Epoch: 53 cost time: 6.405390501022339
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.607 Test Loss: 1.323 Test Acc: 0.607
Validation loss decreased (-0.606653 --> -0.606653).  Saving model ...
Epoch: 54 cost time: 6.935382843017578
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.319 Vali Acc: 0.613 Test Loss: 1.319 Test Acc: 0.613
Validation loss decreased (-0.606653 --> -0.613320).  Saving model ...
Epoch: 55 cost time: 7.125056505203247
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.613 Test Loss: 1.318 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 56 cost time: 7.020437717437744
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.620 Test Loss: 1.316 Test Acc: 0.620
Validation loss decreased (-0.613320 --> -0.619987).  Saving model ...
Epoch: 57 cost time: 7.29913592338562
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.620 Test Loss: 1.315 Test Acc: 0.620
Validation loss decreased (-0.619987 --> -0.619987).  Saving model ...
Epoch: 58 cost time: 6.8411173820495605
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.617 Test Loss: 1.312 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.4005515575408936
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.627 Test Loss: 1.312 Test Acc: 0.627
Validation loss decreased (-0.619987 --> -0.626654).  Saving model ...
Epoch: 60 cost time: 6.600667715072632
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.310 Vali Acc: 0.627 Test Loss: 1.310 Test Acc: 0.627
Validation loss decreased (-0.626654 --> -0.626654).  Saving model ...
Epoch: 61 cost time: 6.8524651527404785
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.308 Vali Acc: 0.627 Test Loss: 1.308 Test Acc: 0.627
Validation loss decreased (-0.626654 --> -0.626654).  Saving model ...
Epoch: 62 cost time: 6.4918928146362305
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.306 Vali Acc: 0.627 Test Loss: 1.306 Test Acc: 0.627
Validation loss decreased (-0.626654 --> -0.626654).  Saving model ...
Epoch: 63 cost time: 6.916154623031616
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.303 Vali Acc: 0.627 Test Loss: 1.303 Test Acc: 0.627
Validation loss decreased (-0.626654 --> -0.626654).  Saving model ...
Epoch: 64 cost time: 7.348500728607178
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.300 Vali Acc: 0.630 Test Loss: 1.300 Test Acc: 0.630
Validation loss decreased (-0.626654 --> -0.629987).  Saving model ...
Epoch: 65 cost time: 7.5460264682769775
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.630 Test Loss: 1.299 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 66 cost time: 6.871116399765015
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.630 Test Loss: 1.297 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 67 cost time: 7.308990955352783
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.627 Test Loss: 1.297 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 7.059189558029175
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.630 Test Loss: 1.297 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 6.548759460449219
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.296 Vali Acc: 0.630 Test Loss: 1.296 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 70 cost time: 7.232994556427002
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.291 Vali Acc: 0.627 Test Loss: 1.291 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 7.267863035202026
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.289 Vali Acc: 0.627 Test Loss: 1.289 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 7.70483922958374
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.287 Vali Acc: 0.633 Test Loss: 1.287 Test Acc: 0.633
Validation loss decreased (-0.629987 --> -0.633320).  Saving model ...
Epoch: 73 cost time: 7.5102620124816895
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.286 Vali Acc: 0.633 Test Loss: 1.286 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 74 cost time: 7.424500226974487
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.286 Vali Acc: 0.633 Test Loss: 1.286 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 7.187764406204224
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.284 Vali Acc: 0.637 Test Loss: 1.284 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.636654).  Saving model ...
Epoch: 76 cost time: 6.664428949356079
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.282 Vali Acc: 0.640 Test Loss: 1.282 Test Acc: 0.640
Validation loss decreased (-0.636654 --> -0.639987).  Saving model ...
Epoch: 77 cost time: 6.76155424118042
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.640 Test Loss: 1.281 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639987).  Saving model ...
Epoch: 78 cost time: 6.670619010925293
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.280 Vali Acc: 0.637 Test Loss: 1.280 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 7.320418119430542
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.277 Vali Acc: 0.640 Test Loss: 1.277 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639987).  Saving model ...
Epoch: 80 cost time: 7.286993741989136
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.278 Vali Acc: 0.643 Test Loss: 1.278 Test Acc: 0.643
Validation loss decreased (-0.639987 --> -0.643321).  Saving model ...
Epoch: 81 cost time: 7.6706414222717285
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.284 Vali Acc: 0.637 Test Loss: 1.284 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 6.656552076339722
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.283 Vali Acc: 0.637 Test Loss: 1.283 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 6.701481342315674
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.640 Test Loss: 1.281 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 6.5353546142578125
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.280 Vali Acc: 0.643 Test Loss: 1.280 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 7.353111267089844
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.278 Vali Acc: 0.647 Test Loss: 1.278 Test Acc: 0.647
Validation loss decreased (-0.643321 --> -0.646654).  Saving model ...
Epoch: 86 cost time: 7.052768707275391
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.643 Test Loss: 1.275 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 7.043237924575806
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.643 Test Loss: 1.273 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 6.952584743499756
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.271 Vali Acc: 0.647 Test Loss: 1.271 Test Acc: 0.647
Validation loss decreased (-0.646654 --> -0.646654).  Saving model ...
Epoch: 89 cost time: 6.645745038986206
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.650 Test Loss: 1.268 Test Acc: 0.650
Validation loss decreased (-0.646654 --> -0.649987).  Saving model ...
Epoch: 90 cost time: 7.026838064193726
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.650 Test Loss: 1.265 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 91 cost time: 6.568627119064331
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.650 Test Loss: 1.263 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 92 cost time: 7.205373048782349
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.657 Test Loss: 1.264 Test Acc: 0.657
Validation loss decreased (-0.649987 --> -0.656654).  Saving model ...
Epoch: 93 cost time: 6.928624629974365
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.261 Vali Acc: 0.653 Test Loss: 1.261 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 6.96072793006897
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.653 Test Loss: 1.263 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 7.180446624755859
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.657 Test Loss: 1.262 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656654).  Saving model ...
Epoch: 96 cost time: 7.152164459228516
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.261 Vali Acc: 0.653 Test Loss: 1.261 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 6.90916895866394
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.650 Test Loss: 1.260 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 7.1136860847473145
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.653 Test Loss: 1.262 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 6.587620496749878
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.660 Test Loss: 1.260 Test Acc: 0.660
Validation loss decreased (-0.656654 --> -0.659987).  Saving model ...
Epoch: 100 cost time: 6.9295995235443115
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.660 Test Loss: 1.259 Test Acc: 0.660
Validation loss decreased (-0.659987 --> -0.659987).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.66
model parameter : 1185561
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.97346305847168
Epoch: 1, Steps: 18 | Train Loss: 3.283 Vali Loss: 3.188 Vali Acc: 0.060 Test Loss: 3.188 Test Acc: 0.060
Validation loss decreased (inf --> -0.059968).  Saving model ...
Epoch: 2 cost time: 7.190896987915039
Epoch: 2, Steps: 18 | Train Loss: 3.004 Vali Loss: 3.043 Vali Acc: 0.127 Test Loss: 3.043 Test Acc: 0.127
Validation loss decreased (-0.059968 --> -0.126636).  Saving model ...
Epoch: 3 cost time: 6.7136070728302
Epoch: 3, Steps: 18 | Train Loss: 2.510 Vali Loss: 2.872 Vali Acc: 0.227 Test Loss: 2.872 Test Acc: 0.227
Validation loss decreased (-0.126636 --> -0.226638).  Saving model ...
Epoch: 4 cost time: 6.589165925979614
Epoch: 4, Steps: 18 | Train Loss: 1.979 Vali Loss: 2.707 Vali Acc: 0.250 Test Loss: 2.707 Test Acc: 0.250
Validation loss decreased (-0.226638 --> -0.249973).  Saving model ...
Epoch: 5 cost time: 6.2171008586883545
Epoch: 5, Steps: 18 | Train Loss: 1.390 Vali Loss: 2.548 Vali Acc: 0.317 Test Loss: 2.548 Test Acc: 0.317
Validation loss decreased (-0.249973 --> -0.316641).  Saving model ...
Epoch: 6 cost time: 6.0391881465911865
Epoch: 6, Steps: 18 | Train Loss: 0.863 Vali Loss: 2.433 Vali Acc: 0.323 Test Loss: 2.433 Test Acc: 0.323
Validation loss decreased (-0.316641 --> -0.323309).  Saving model ...
Epoch: 7 cost time: 6.146601438522339
Epoch: 7, Steps: 18 | Train Loss: 0.461 Vali Loss: 2.343 Vali Acc: 0.340 Test Loss: 2.343 Test Acc: 0.340
Validation loss decreased (-0.323309 --> -0.339977).  Saving model ...
Epoch: 8 cost time: 6.308147668838501
Epoch: 8, Steps: 18 | Train Loss: 0.251 Vali Loss: 2.259 Vali Acc: 0.320 Test Loss: 2.259 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.503334283828735
Epoch: 9, Steps: 18 | Train Loss: 0.111 Vali Loss: 2.188 Vali Acc: 0.370 Test Loss: 2.188 Test Acc: 0.370
Validation loss decreased (-0.339977 --> -0.369978).  Saving model ...
Epoch: 10 cost time: 6.473428964614868
Epoch: 10, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.165 Vali Acc: 0.357 Test Loss: 2.165 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.76898717880249
Epoch: 11, Steps: 18 | Train Loss: 0.040 Vali Loss: 2.098 Vali Acc: 0.383 Test Loss: 2.098 Test Acc: 0.383
Validation loss decreased (-0.369978 --> -0.383312).  Saving model ...
Epoch: 12 cost time: 6.531681060791016
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 2.073 Vali Acc: 0.397 Test Loss: 2.073 Test Acc: 0.397
Validation loss decreased (-0.383312 --> -0.396646).  Saving model ...
Epoch: 13 cost time: 6.321087598800659
Epoch: 13, Steps: 18 | Train Loss: 0.020 Vali Loss: 2.045 Vali Acc: 0.413 Test Loss: 2.045 Test Acc: 0.413
Validation loss decreased (-0.396646 --> -0.413313).  Saving model ...
Epoch: 14 cost time: 7.079899787902832
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.995 Vali Acc: 0.423 Test Loss: 1.995 Test Acc: 0.423
Validation loss decreased (-0.413313 --> -0.423313).  Saving model ...
Epoch: 15 cost time: 6.9185168743133545
Epoch: 15, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.973 Vali Acc: 0.417 Test Loss: 1.973 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.915787935256958
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.944 Vali Acc: 0.447 Test Loss: 1.944 Test Acc: 0.447
Validation loss decreased (-0.423313 --> -0.446647).  Saving model ...
Epoch: 17 cost time: 7.7349467277526855
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.925 Vali Acc: 0.450 Test Loss: 1.925 Test Acc: 0.450
Validation loss decreased (-0.446647 --> -0.449981).  Saving model ...
Epoch: 18 cost time: 7.238696098327637
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.908 Vali Acc: 0.447 Test Loss: 1.908 Test Acc: 0.447
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.981586217880249
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.886 Vali Acc: 0.470 Test Loss: 1.886 Test Acc: 0.470
Validation loss decreased (-0.449981 --> -0.469981).  Saving model ...
Epoch: 20 cost time: 7.456753492355347
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.869 Vali Acc: 0.480 Test Loss: 1.869 Test Acc: 0.480
Validation loss decreased (-0.469981 --> -0.479981).  Saving model ...
Epoch: 21 cost time: 6.7435691356658936
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.846 Vali Acc: 0.487 Test Loss: 1.846 Test Acc: 0.487
Validation loss decreased (-0.479981 --> -0.486648).  Saving model ...
Epoch: 22 cost time: 6.715474367141724
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.842 Vali Acc: 0.480 Test Loss: 1.842 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.701122760772705
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.836 Vali Acc: 0.487 Test Loss: 1.836 Test Acc: 0.487
Validation loss decreased (-0.486648 --> -0.486648).  Saving model ...
Epoch: 24 cost time: 6.798972845077515
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.819 Vali Acc: 0.500 Test Loss: 1.819 Test Acc: 0.500
Validation loss decreased (-0.486648 --> -0.499982).  Saving model ...
Epoch: 25 cost time: 6.798153877258301
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.810 Vali Acc: 0.500 Test Loss: 1.810 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499982).  Saving model ...
Epoch: 26 cost time: 6.981987953186035
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.797 Vali Acc: 0.507 Test Loss: 1.797 Test Acc: 0.507
Validation loss decreased (-0.499982 --> -0.506649).  Saving model ...
Epoch: 27 cost time: 6.692401170730591
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.809 Vali Acc: 0.503 Test Loss: 1.809 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.5638511180877686
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.797 Vali Acc: 0.510 Test Loss: 1.797 Test Acc: 0.510
Validation loss decreased (-0.506649 --> -0.509982).  Saving model ...
Epoch: 29 cost time: 6.44205904006958
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.776 Vali Acc: 0.503 Test Loss: 1.776 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.86796236038208
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.763 Vali Acc: 0.507 Test Loss: 1.763 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.577558517456055
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.759 Vali Acc: 0.517 Test Loss: 1.759 Test Acc: 0.517
Validation loss decreased (-0.509982 --> -0.516649).  Saving model ...
Epoch: 32 cost time: 6.778313398361206
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.744 Vali Acc: 0.523 Test Loss: 1.744 Test Acc: 0.523
Validation loss decreased (-0.516649 --> -0.523316).  Saving model ...
Epoch: 33 cost time: 6.742247104644775
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.739 Vali Acc: 0.513 Test Loss: 1.739 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 7.089539527893066
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.729 Vali Acc: 0.530 Test Loss: 1.729 Test Acc: 0.530
Validation loss decreased (-0.523316 --> -0.529983).  Saving model ...
Epoch: 35 cost time: 6.884385347366333
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.720 Vali Acc: 0.527 Test Loss: 1.720 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.53864312171936
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.718 Vali Acc: 0.537 Test Loss: 1.718 Test Acc: 0.537
Validation loss decreased (-0.529983 --> -0.536649).  Saving model ...
Epoch: 37 cost time: 6.267509698867798
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.715 Vali Acc: 0.540 Test Loss: 1.715 Test Acc: 0.540
Validation loss decreased (-0.536649 --> -0.539983).  Saving model ...
Epoch: 38 cost time: 6.51461124420166
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.711 Vali Acc: 0.540 Test Loss: 1.711 Test Acc: 0.540
Validation loss decreased (-0.539983 --> -0.539983).  Saving model ...
Epoch: 39 cost time: 6.9667441844940186
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.708 Vali Acc: 0.540 Test Loss: 1.708 Test Acc: 0.540
Validation loss decreased (-0.539983 --> -0.539983).  Saving model ...
Epoch: 40 cost time: 7.22748327255249
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.705 Vali Acc: 0.540 Test Loss: 1.705 Test Acc: 0.540
Validation loss decreased (-0.539983 --> -0.539983).  Saving model ...
Epoch: 41 cost time: 7.664196729660034
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.699 Vali Acc: 0.537 Test Loss: 1.699 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 7.047901391983032
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.695 Vali Acc: 0.540 Test Loss: 1.695 Test Acc: 0.540
Validation loss decreased (-0.539983 --> -0.539983).  Saving model ...
Epoch: 43 cost time: 7.269942998886108
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.543 Test Loss: 1.688 Test Acc: 0.543
Validation loss decreased (-0.539983 --> -0.543316).  Saving model ...
Epoch: 44 cost time: 7.222649574279785
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.681 Vali Acc: 0.550 Test Loss: 1.681 Test Acc: 0.550
Validation loss decreased (-0.543316 --> -0.549983).  Saving model ...
Epoch: 45 cost time: 6.750919818878174
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.677 Vali Acc: 0.543 Test Loss: 1.677 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.73411750793457
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.674 Vali Acc: 0.557 Test Loss: 1.674 Test Acc: 0.557
Validation loss decreased (-0.549983 --> -0.556650).  Saving model ...
Epoch: 47 cost time: 6.579897403717041
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.671 Vali Acc: 0.560 Test Loss: 1.671 Test Acc: 0.560
Validation loss decreased (-0.556650 --> -0.559983).  Saving model ...
Epoch: 48 cost time: 6.987959861755371
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.666 Vali Acc: 0.557 Test Loss: 1.666 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 7.114009618759155
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.667 Vali Acc: 0.553 Test Loss: 1.667 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 6.908679008483887
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.664 Vali Acc: 0.557 Test Loss: 1.664 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.843393325805664
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.658 Vali Acc: 0.553 Test Loss: 1.658 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 7.159469842910767
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.654 Vali Acc: 0.557 Test Loss: 1.654 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 6.779266357421875
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.651 Vali Acc: 0.557 Test Loss: 1.651 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 7.245390892028809
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.648 Vali Acc: 0.567 Test Loss: 1.648 Test Acc: 0.567
Validation loss decreased (-0.559983 --> -0.566650).  Saving model ...
Epoch: 55 cost time: 7.4075093269348145
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.560 Test Loss: 1.643 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 7.560577869415283
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.642 Vali Acc: 0.560 Test Loss: 1.642 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 7.767881393432617
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.640 Vali Acc: 0.557 Test Loss: 1.640 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 7.112247705459595
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.641 Vali Acc: 0.553 Test Loss: 1.641 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 7.340049743652344
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.641 Vali Acc: 0.550 Test Loss: 1.641 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 7.428204536437988
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.560 Test Loss: 1.637 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 7.531699895858765
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.635 Vali Acc: 0.560 Test Loss: 1.635 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 7.371277809143066
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.557 Test Loss: 1.631 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 7.8960254192352295
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.557 Test Loss: 1.630 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 7.477862596511841
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.567 Test Loss: 1.626 Test Acc: 0.567
Validation loss decreased (-0.566650 --> -0.566650).  Saving model ...
Epoch: 65 cost time: 7.54375433921814
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.563 Test Loss: 1.620 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 6.974164009094238
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.567 Test Loss: 1.617 Test Acc: 0.567
Validation loss decreased (-0.566650 --> -0.566650).  Saving model ...
Epoch: 67 cost time: 6.904621362686157
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.560 Test Loss: 1.617 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 7.243779420852661
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.615 Vali Acc: 0.560 Test Loss: 1.615 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 7.285304307937622
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.563 Test Loss: 1.614 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 6.95500373840332
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.563 Test Loss: 1.612 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 6.962809085845947
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.567 Test Loss: 1.609 Test Acc: 0.567
Validation loss decreased (-0.566650 --> -0.566651).  Saving model ...
Epoch: 72 cost time: 6.958885431289673
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.567 Test Loss: 1.608 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 73 cost time: 7.585561990737915
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.557 Test Loss: 1.609 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 6.734017848968506
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.560 Test Loss: 1.608 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 7.619621515274048
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.570 Test Loss: 1.606 Test Acc: 0.570
Validation loss decreased (-0.566651 --> -0.569984).  Saving model ...
Epoch: 76 cost time: 7.4320948123931885
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.573 Test Loss: 1.604 Test Acc: 0.573
Validation loss decreased (-0.569984 --> -0.573317).  Saving model ...
Epoch: 77 cost time: 7.771431922912598
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.603 Vali Acc: 0.573 Test Loss: 1.603 Test Acc: 0.573
Validation loss decreased (-0.573317 --> -0.573317).  Saving model ...
Epoch: 78 cost time: 7.123210668563843
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.570 Test Loss: 1.601 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 7.077877998352051
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.567 Test Loss: 1.596 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 7.538450002670288
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.595 Vali Acc: 0.567 Test Loss: 1.595 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 6.924561262130737
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.567 Test Loss: 1.596 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 6.753899097442627
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.595 Vali Acc: 0.567 Test Loss: 1.595 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 6.74070930480957
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.593 Vali Acc: 0.570 Test Loss: 1.593 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 7.341173887252808
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.570 Test Loss: 1.596 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 6.917160511016846
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.595 Vali Acc: 0.570 Test Loss: 1.595 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 7.342405796051025
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.593 Vali Acc: 0.573 Test Loss: 1.593 Test Acc: 0.573
Validation loss decreased (-0.573317 --> -0.573317).  Saving model ...
Epoch: 87 cost time: 7.099380016326904
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.580 Test Loss: 1.591 Test Acc: 0.580
Validation loss decreased (-0.573317 --> -0.579984).  Saving model ...
Epoch: 88 cost time: 6.806991100311279
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.583 Test Loss: 1.587 Test Acc: 0.583
Validation loss decreased (-0.579984 --> -0.583317).  Saving model ...
Epoch: 89 cost time: 6.715035676956177
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.583 Test Loss: 1.586 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 90 cost time: 6.982292413711548
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.583 Test Loss: 1.586 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 91 cost time: 7.388372421264648
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.583 Test Loss: 1.585 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 92 cost time: 7.562458515167236
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.584 Vali Acc: 0.587 Test Loss: 1.584 Test Acc: 0.587
Validation loss decreased (-0.583317 --> -0.586651).  Saving model ...
Epoch: 93 cost time: 6.931049346923828
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.587 Test Loss: 1.582 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 94 cost time: 7.63066554069519
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.583 Test Loss: 1.580 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 7.501588344573975
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.583 Test Loss: 1.578 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 7.114439964294434
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.587 Test Loss: 1.576 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 97 cost time: 6.518592596054077
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.587 Test Loss: 1.575 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 98 cost time: 6.823999881744385
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.587 Test Loss: 1.576 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 7.250329256057739
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.590 Test Loss: 1.574 Test Acc: 0.590
Validation loss decreased (-0.586651 --> -0.589984).  Saving model ...
Epoch: 100 cost time: 7.065682649612427
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.590 Test Loss: 1.573 Test Acc: 0.590
Validation loss decreased (-0.589984 --> -0.589984).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.59
model parameter : 1185561
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.282674074172974
Epoch: 1, Steps: 18 | Train Loss: 3.311 Vali Loss: 3.251 Vali Acc: 0.060 Test Loss: 3.251 Test Acc: 0.060
Validation loss decreased (inf --> -0.059967).  Saving model ...
Epoch: 2 cost time: 6.824305772781372
Epoch: 2, Steps: 18 | Train Loss: 3.039 Vali Loss: 3.164 Vali Acc: 0.060 Test Loss: 3.164 Test Acc: 0.060
Validation loss decreased (-0.059967 --> -0.059968).  Saving model ...
Epoch: 3 cost time: 6.7541093826293945
Epoch: 3, Steps: 18 | Train Loss: 2.570 Vali Loss: 3.068 Vali Acc: 0.083 Test Loss: 3.068 Test Acc: 0.083
Validation loss decreased (-0.059968 --> -0.083303).  Saving model ...
Epoch: 4 cost time: 6.765661716461182
Epoch: 4, Steps: 18 | Train Loss: 2.073 Vali Loss: 2.965 Vali Acc: 0.133 Test Loss: 2.965 Test Acc: 0.133
Validation loss decreased (-0.083303 --> -0.133304).  Saving model ...
Epoch: 5 cost time: 7.002185344696045
Epoch: 5, Steps: 18 | Train Loss: 1.545 Vali Loss: 2.880 Vali Acc: 0.133 Test Loss: 2.880 Test Acc: 0.133
Validation loss decreased (-0.133304 --> -0.133305).  Saving model ...
Epoch: 6 cost time: 7.455468654632568
Epoch: 6, Steps: 18 | Train Loss: 1.011 Vali Loss: 2.796 Vali Acc: 0.133 Test Loss: 2.796 Test Acc: 0.133
Validation loss decreased (-0.133305 --> -0.133305).  Saving model ...
Epoch: 7 cost time: 7.008810758590698
Epoch: 7, Steps: 18 | Train Loss: 0.607 Vali Loss: 2.723 Vali Acc: 0.147 Test Loss: 2.723 Test Acc: 0.147
Validation loss decreased (-0.133305 --> -0.146639).  Saving model ...
Epoch: 8 cost time: 7.2011878490448
Epoch: 8, Steps: 18 | Train Loss: 0.367 Vali Loss: 2.622 Vali Acc: 0.177 Test Loss: 2.622 Test Acc: 0.177
Validation loss decreased (-0.146639 --> -0.176640).  Saving model ...
Epoch: 9 cost time: 6.852515697479248
Epoch: 9, Steps: 18 | Train Loss: 0.172 Vali Loss: 2.584 Vali Acc: 0.220 Test Loss: 2.584 Test Acc: 0.220
Validation loss decreased (-0.176640 --> -0.219974).  Saving model ...
Epoch: 10 cost time: 6.612333297729492
Epoch: 10, Steps: 18 | Train Loss: 0.085 Vali Loss: 2.507 Vali Acc: 0.240 Test Loss: 2.507 Test Acc: 0.240
Validation loss decreased (-0.219974 --> -0.239975).  Saving model ...
Epoch: 11 cost time: 6.272861003875732
Epoch: 11, Steps: 18 | Train Loss: 0.056 Vali Loss: 2.428 Vali Acc: 0.240 Test Loss: 2.428 Test Acc: 0.240
Validation loss decreased (-0.239975 --> -0.239976).  Saving model ...
Epoch: 12 cost time: 6.558517694473267
Epoch: 12, Steps: 18 | Train Loss: 0.039 Vali Loss: 2.384 Vali Acc: 0.273 Test Loss: 2.384 Test Acc: 0.273
Validation loss decreased (-0.239976 --> -0.273309).  Saving model ...
Epoch: 13 cost time: 6.848475933074951
Epoch: 13, Steps: 18 | Train Loss: 0.026 Vali Loss: 2.379 Vali Acc: 0.277 Test Loss: 2.379 Test Acc: 0.277
Validation loss decreased (-0.273309 --> -0.276643).  Saving model ...
Epoch: 14 cost time: 6.957891225814819
Epoch: 14, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.304 Vali Acc: 0.297 Test Loss: 2.304 Test Acc: 0.297
Validation loss decreased (-0.276643 --> -0.296644).  Saving model ...
Epoch: 15 cost time: 7.462651014328003
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.257 Vali Acc: 0.327 Test Loss: 2.257 Test Acc: 0.327
Validation loss decreased (-0.296644 --> -0.326644).  Saving model ...
Epoch: 16 cost time: 7.193772315979004
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 2.209 Vali Acc: 0.350 Test Loss: 2.209 Test Acc: 0.350
Validation loss decreased (-0.326644 --> -0.349978).  Saving model ...
Epoch: 17 cost time: 6.786420822143555
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.196 Vali Acc: 0.343 Test Loss: 2.196 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.722090721130371
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.175 Vali Acc: 0.370 Test Loss: 2.175 Test Acc: 0.370
Validation loss decreased (-0.349978 --> -0.369978).  Saving model ...
Epoch: 19 cost time: 6.7180328369140625
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.138 Vali Acc: 0.377 Test Loss: 2.138 Test Acc: 0.377
Validation loss decreased (-0.369978 --> -0.376645).  Saving model ...
Epoch: 20 cost time: 7.171014308929443
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.100 Vali Acc: 0.393 Test Loss: 2.100 Test Acc: 0.393
Validation loss decreased (-0.376645 --> -0.393312).  Saving model ...
Epoch: 21 cost time: 7.414443492889404
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.068 Vali Acc: 0.373 Test Loss: 2.068 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.281482219696045
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.046 Vali Acc: 0.393 Test Loss: 2.046 Test Acc: 0.393
Validation loss decreased (-0.393312 --> -0.393313).  Saving model ...
Epoch: 23 cost time: 7.42922568321228
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.046 Vali Acc: 0.397 Test Loss: 2.046 Test Acc: 0.397
Validation loss decreased (-0.393313 --> -0.396646).  Saving model ...
Epoch: 24 cost time: 7.207960605621338
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.021 Vali Acc: 0.407 Test Loss: 2.021 Test Acc: 0.407
Validation loss decreased (-0.396646 --> -0.406646).  Saving model ...
Epoch: 25 cost time: 6.3817527294158936
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.998 Vali Acc: 0.400 Test Loss: 1.998 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.670431137084961
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.964 Vali Acc: 0.410 Test Loss: 1.964 Test Acc: 0.410
Validation loss decreased (-0.406646 --> -0.409980).  Saving model ...
Epoch: 27 cost time: 6.693334102630615
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.964 Vali Acc: 0.413 Test Loss: 1.964 Test Acc: 0.413
Validation loss decreased (-0.409980 --> -0.413314).  Saving model ...
Epoch: 28 cost time: 6.691096782684326
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.946 Vali Acc: 0.413 Test Loss: 1.946 Test Acc: 0.413
Validation loss decreased (-0.413314 --> -0.413314).  Saving model ...
Epoch: 29 cost time: 6.89124059677124
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.933 Vali Acc: 0.420 Test Loss: 1.933 Test Acc: 0.420
Validation loss decreased (-0.413314 --> -0.419981).  Saving model ...
Epoch: 30 cost time: 6.489757299423218
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.924 Vali Acc: 0.420 Test Loss: 1.924 Test Acc: 0.420
Validation loss decreased (-0.419981 --> -0.419981).  Saving model ...
Epoch: 31 cost time: 7.304566144943237
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.910 Vali Acc: 0.437 Test Loss: 1.910 Test Acc: 0.437
Validation loss decreased (-0.419981 --> -0.436648).  Saving model ...
Epoch: 32 cost time: 7.372951984405518
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.900 Vali Acc: 0.433 Test Loss: 1.900 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.924917936325073
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.879 Vali Acc: 0.433 Test Loss: 1.879 Test Acc: 0.433
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.668612718582153
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.860 Vali Acc: 0.440 Test Loss: 1.860 Test Acc: 0.440
Validation loss decreased (-0.436648 --> -0.439981).  Saving model ...
Epoch: 35 cost time: 6.950367212295532
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.849 Vali Acc: 0.457 Test Loss: 1.849 Test Acc: 0.457
Validation loss decreased (-0.439981 --> -0.456648).  Saving model ...
Epoch: 36 cost time: 6.709407806396484
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.841 Vali Acc: 0.460 Test Loss: 1.841 Test Acc: 0.460
Validation loss decreased (-0.456648 --> -0.459982).  Saving model ...
Epoch: 37 cost time: 7.518173456192017
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.829 Vali Acc: 0.453 Test Loss: 1.829 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 7.664190053939819
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.825 Vali Acc: 0.463 Test Loss: 1.825 Test Acc: 0.463
Validation loss decreased (-0.459982 --> -0.463315).  Saving model ...
Epoch: 39 cost time: 7.816593647003174
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.824 Vali Acc: 0.450 Test Loss: 1.824 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 7.562358856201172
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.819 Vali Acc: 0.460 Test Loss: 1.819 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 7.38013482093811
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.815 Vali Acc: 0.460 Test Loss: 1.815 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 6.641043186187744
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.801 Vali Acc: 0.463 Test Loss: 1.801 Test Acc: 0.463
Validation loss decreased (-0.463315 --> -0.463315).  Saving model ...
Epoch: 43 cost time: 7.13574481010437
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.789 Vali Acc: 0.467 Test Loss: 1.789 Test Acc: 0.467
Validation loss decreased (-0.463315 --> -0.466649).  Saving model ...
Epoch: 44 cost time: 7.165131092071533
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.473 Test Loss: 1.776 Test Acc: 0.473
Validation loss decreased (-0.466649 --> -0.473316).  Saving model ...
Epoch: 45 cost time: 7.148894548416138
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.770 Vali Acc: 0.480 Test Loss: 1.770 Test Acc: 0.480
Validation loss decreased (-0.473316 --> -0.479982).  Saving model ...
Epoch: 46 cost time: 7.327862024307251
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.764 Vali Acc: 0.473 Test Loss: 1.764 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 7.149286985397339
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.760 Vali Acc: 0.483 Test Loss: 1.760 Test Acc: 0.483
Validation loss decreased (-0.479982 --> -0.483316).  Saving model ...
Epoch: 48 cost time: 7.279374122619629
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.752 Vali Acc: 0.490 Test Loss: 1.752 Test Acc: 0.490
Validation loss decreased (-0.483316 --> -0.489982).  Saving model ...
Epoch: 49 cost time: 7.039867639541626
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.755 Vali Acc: 0.483 Test Loss: 1.755 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.694712162017822
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.740 Vali Acc: 0.500 Test Loss: 1.740 Test Acc: 0.500
Validation loss decreased (-0.489982 --> -0.499983).  Saving model ...
Epoch: 51 cost time: 6.984401702880859
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.735 Vali Acc: 0.503 Test Loss: 1.735 Test Acc: 0.503
Validation loss decreased (-0.499983 --> -0.503316).  Saving model ...
Epoch: 52 cost time: 7.217037677764893
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.497 Test Loss: 1.734 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 7.295999526977539
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.726 Vali Acc: 0.507 Test Loss: 1.726 Test Acc: 0.507
Validation loss decreased (-0.503316 --> -0.506649).  Saving model ...
Epoch: 54 cost time: 7.2595374584198
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.715 Vali Acc: 0.513 Test Loss: 1.715 Test Acc: 0.513
Validation loss decreased (-0.506649 --> -0.513316).  Saving model ...
Epoch: 55 cost time: 7.772660255432129
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.712 Vali Acc: 0.513 Test Loss: 1.712 Test Acc: 0.513
Validation loss decreased (-0.513316 --> -0.513316).  Saving model ...
Epoch: 56 cost time: 7.025163173675537
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.708 Vali Acc: 0.510 Test Loss: 1.708 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.931293964385986
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.703 Vali Acc: 0.513 Test Loss: 1.703 Test Acc: 0.513
Validation loss decreased (-0.513316 --> -0.513316).  Saving model ...
Epoch: 58 cost time: 6.6181089878082275
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.520 Test Loss: 1.698 Test Acc: 0.520
Validation loss decreased (-0.513316 --> -0.519983).  Saving model ...
Epoch: 59 cost time: 6.554051637649536
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.520 Test Loss: 1.696 Test Acc: 0.520
Validation loss decreased (-0.519983 --> -0.519983).  Saving model ...
Epoch: 60 cost time: 6.550613641738892
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.523 Test Loss: 1.689 Test Acc: 0.523
Validation loss decreased (-0.519983 --> -0.523316).  Saving model ...
Epoch: 61 cost time: 7.037049770355225
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.527 Test Loss: 1.691 Test Acc: 0.527
Validation loss decreased (-0.523316 --> -0.526650).  Saving model ...
Epoch: 62 cost time: 6.78113865852356
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.684 Vali Acc: 0.523 Test Loss: 1.684 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 6.918158769607544
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.678 Vali Acc: 0.523 Test Loss: 1.678 Test Acc: 0.523
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 6.57216739654541
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.674 Vali Acc: 0.520 Test Loss: 1.674 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 6.660780668258667
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.527 Test Loss: 1.669 Test Acc: 0.527
Validation loss decreased (-0.526650 --> -0.526650).  Saving model ...
Epoch: 66 cost time: 6.742464065551758
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.666 Vali Acc: 0.530 Test Loss: 1.666 Test Acc: 0.530
Validation loss decreased (-0.526650 --> -0.529983).  Saving model ...
Epoch: 67 cost time: 6.69048810005188
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.660 Vali Acc: 0.540 Test Loss: 1.660 Test Acc: 0.540
Validation loss decreased (-0.529983 --> -0.539983).  Saving model ...
Epoch: 68 cost time: 7.159396409988403
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.656 Vali Acc: 0.540 Test Loss: 1.656 Test Acc: 0.540
Validation loss decreased (-0.539983 --> -0.539983).  Saving model ...
Epoch: 69 cost time: 7.161271095275879
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.654 Vali Acc: 0.550 Test Loss: 1.654 Test Acc: 0.550
Validation loss decreased (-0.539983 --> -0.549983).  Saving model ...
Epoch: 70 cost time: 7.046902418136597
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.649 Vali Acc: 0.547 Test Loss: 1.649 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 7.2134690284729
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.649 Vali Acc: 0.543 Test Loss: 1.649 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 6.720420598983765
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.547 Test Loss: 1.645 Test Acc: 0.547
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 6.359199047088623
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.550 Test Loss: 1.639 Test Acc: 0.550
Validation loss decreased (-0.549983 --> -0.549984).  Saving model ...
Epoch: 74 cost time: 6.5338499546051025
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.632 Vali Acc: 0.550 Test Loss: 1.632 Test Acc: 0.550
Validation loss decreased (-0.549984 --> -0.549984).  Saving model ...
Epoch: 75 cost time: 7.0387654304504395
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.557 Test Loss: 1.625 Test Acc: 0.557
Validation loss decreased (-0.549984 --> -0.556650).  Saving model ...
Epoch: 76 cost time: 7.342656373977661
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.621 Vali Acc: 0.557 Test Loss: 1.621 Test Acc: 0.557
Validation loss decreased (-0.556650 --> -0.556650).  Saving model ...
Epoch: 77 cost time: 7.2586236000061035
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.560 Test Loss: 1.618 Test Acc: 0.560
Validation loss decreased (-0.556650 --> -0.559984).  Saving model ...
Epoch: 78 cost time: 7.371278762817383
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.563 Test Loss: 1.614 Test Acc: 0.563
Validation loss decreased (-0.559984 --> -0.563317).  Saving model ...
Epoch: 79 cost time: 7.792347192764282
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.613 Vali Acc: 0.567 Test Loss: 1.613 Test Acc: 0.567
Validation loss decreased (-0.563317 --> -0.566651).  Saving model ...
Epoch: 80 cost time: 7.1695237159729
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.567 Test Loss: 1.609 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 81 cost time: 6.793219327926636
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.567 Test Loss: 1.609 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 82 cost time: 6.775718927383423
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.567 Test Loss: 1.608 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 83 cost time: 6.968734502792358
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.567 Test Loss: 1.605 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 84 cost time: 6.906378984451294
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.570 Test Loss: 1.606 Test Acc: 0.570
Validation loss decreased (-0.566651 --> -0.569984).  Saving model ...
Epoch: 85 cost time: 6.743017196655273
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.563 Test Loss: 1.605 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 6.763453245162964
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.570 Test Loss: 1.601 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 87 cost time: 6.715955018997192
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.599 Vali Acc: 0.567 Test Loss: 1.599 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 6.172293424606323
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.595 Vali Acc: 0.563 Test Loss: 1.595 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 6.426576137542725
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.567 Test Loss: 1.592 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 6.247689962387085
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.567 Test Loss: 1.591 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 6.648493051528931
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.589 Vali Acc: 0.567 Test Loss: 1.589 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 6.58966064453125
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.570 Test Loss: 1.585 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 93 cost time: 7.002914667129517
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.570 Test Loss: 1.581 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 94 cost time: 6.7280113697052
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.573 Test Loss: 1.580 Test Acc: 0.573
Validation loss decreased (-0.569984 --> -0.573318).  Saving model ...
Epoch: 95 cost time: 6.882091045379639
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.577 Test Loss: 1.578 Test Acc: 0.577
Validation loss decreased (-0.573318 --> -0.576651).  Saving model ...
Epoch: 96 cost time: 6.388955593109131
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.580 Test Loss: 1.581 Test Acc: 0.580
Validation loss decreased (-0.576651 --> -0.579984).  Saving model ...
Epoch: 97 cost time: 6.3766725063323975
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.580 Test Loss: 1.578 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579984).  Saving model ...
Epoch: 98 cost time: 7.021595239639282
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.577 Vali Acc: 0.580 Test Loss: 1.577 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579984).  Saving model ...
Epoch: 99 cost time: 7.703853130340576
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.587 Test Loss: 1.573 Test Acc: 0.587
Validation loss decreased (-0.579984 --> -0.586651).  Saving model ...
Epoch: 100 cost time: 7.286482810974121
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.571 Vali Acc: 0.590 Test Loss: 1.571 Test Acc: 0.590
Validation loss decreased (-0.586651 --> -0.589984).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.59
model parameter : 1185561
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.209470987319946
Epoch: 1, Steps: 18 | Train Loss: 3.270 Vali Loss: 3.248 Vali Acc: 0.053 Test Loss: 3.248 Test Acc: 0.053
Validation loss decreased (inf --> -0.053301).  Saving model ...
Epoch: 2 cost time: 6.721242666244507
Epoch: 2, Steps: 18 | Train Loss: 3.083 Vali Loss: 3.160 Vali Acc: 0.060 Test Loss: 3.160 Test Acc: 0.060
Validation loss decreased (-0.053301 --> -0.059968).  Saving model ...
Epoch: 3 cost time: 6.998751163482666
Epoch: 3, Steps: 18 | Train Loss: 2.719 Vali Loss: 3.071 Vali Acc: 0.080 Test Loss: 3.071 Test Acc: 0.080
Validation loss decreased (-0.059968 --> -0.079969).  Saving model ...
Epoch: 4 cost time: 7.0978498458862305
Epoch: 4, Steps: 18 | Train Loss: 2.282 Vali Loss: 2.961 Vali Acc: 0.117 Test Loss: 2.961 Test Acc: 0.117
Validation loss decreased (-0.079969 --> -0.116637).  Saving model ...
Epoch: 5 cost time: 7.019145727157593
Epoch: 5, Steps: 18 | Train Loss: 1.777 Vali Loss: 2.891 Vali Acc: 0.123 Test Loss: 2.891 Test Acc: 0.123
Validation loss decreased (-0.116637 --> -0.123304).  Saving model ...
Epoch: 6 cost time: 7.883616924285889
Epoch: 6, Steps: 18 | Train Loss: 1.281 Vali Loss: 2.784 Vali Acc: 0.167 Test Loss: 2.784 Test Acc: 0.167
Validation loss decreased (-0.123304 --> -0.166639).  Saving model ...
Epoch: 7 cost time: 7.253420114517212
Epoch: 7, Steps: 18 | Train Loss: 0.876 Vali Loss: 2.712 Vali Acc: 0.167 Test Loss: 2.712 Test Acc: 0.167
Validation loss decreased (-0.166639 --> -0.166640).  Saving model ...
Epoch: 8 cost time: 7.65678334236145
Epoch: 8, Steps: 18 | Train Loss: 0.552 Vali Loss: 2.579 Vali Acc: 0.197 Test Loss: 2.579 Test Acc: 0.197
Validation loss decreased (-0.166640 --> -0.196641).  Saving model ...
Epoch: 9 cost time: 6.87384033203125
Epoch: 9, Steps: 18 | Train Loss: 0.328 Vali Loss: 2.402 Vali Acc: 0.273 Test Loss: 2.402 Test Acc: 0.273
Validation loss decreased (-0.196641 --> -0.273309).  Saving model ...
Epoch: 10 cost time: 6.4731292724609375
Epoch: 10, Steps: 18 | Train Loss: 0.164 Vali Loss: 2.311 Vali Acc: 0.290 Test Loss: 2.311 Test Acc: 0.290
Validation loss decreased (-0.273309 --> -0.289977).  Saving model ...
Epoch: 11 cost time: 6.894416809082031
Epoch: 11, Steps: 18 | Train Loss: 0.099 Vali Loss: 2.170 Vali Acc: 0.327 Test Loss: 2.170 Test Acc: 0.327
Validation loss decreased (-0.289977 --> -0.326645).  Saving model ...
Epoch: 12 cost time: 6.578417778015137
Epoch: 12, Steps: 18 | Train Loss: 0.064 Vali Loss: 2.107 Vali Acc: 0.353 Test Loss: 2.107 Test Acc: 0.353
Validation loss decreased (-0.326645 --> -0.353312).  Saving model ...
Epoch: 13 cost time: 6.896361589431763
Epoch: 13, Steps: 18 | Train Loss: 0.042 Vali Loss: 2.046 Vali Acc: 0.370 Test Loss: 2.046 Test Acc: 0.370
Validation loss decreased (-0.353312 --> -0.369980).  Saving model ...
Epoch: 14 cost time: 6.853460788726807
Epoch: 14, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.938 Vali Acc: 0.403 Test Loss: 1.938 Test Acc: 0.403
Validation loss decreased (-0.369980 --> -0.403314).  Saving model ...
Epoch: 15 cost time: 6.99968695640564
Epoch: 15, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.927 Vali Acc: 0.407 Test Loss: 1.927 Test Acc: 0.407
Validation loss decreased (-0.403314 --> -0.406647).  Saving model ...
Epoch: 16 cost time: 6.8812174797058105
Epoch: 16, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.887 Vali Acc: 0.410 Test Loss: 1.887 Test Acc: 0.410
Validation loss decreased (-0.406647 --> -0.409981).  Saving model ...
Epoch: 17 cost time: 6.406777381896973
Epoch: 17, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.889 Vali Acc: 0.413 Test Loss: 1.889 Test Acc: 0.413
Validation loss decreased (-0.409981 --> -0.413314).  Saving model ...
Epoch: 18 cost time: 6.505545377731323
Epoch: 18, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.840 Vali Acc: 0.420 Test Loss: 1.840 Test Acc: 0.420
Validation loss decreased (-0.413314 --> -0.419982).  Saving model ...
Epoch: 19 cost time: 6.428532838821411
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.812 Vali Acc: 0.433 Test Loss: 1.812 Test Acc: 0.433
Validation loss decreased (-0.419982 --> -0.433315).  Saving model ...
Epoch: 20 cost time: 6.6041669845581055
Epoch: 20, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.797 Vali Acc: 0.450 Test Loss: 1.797 Test Acc: 0.450
Validation loss decreased (-0.433315 --> -0.449982).  Saving model ...
Epoch: 21 cost time: 6.234287738800049
Epoch: 21, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.809 Vali Acc: 0.457 Test Loss: 1.809 Test Acc: 0.457
Validation loss decreased (-0.449982 --> -0.456649).  Saving model ...
Epoch: 22 cost time: 6.3656370639801025
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.798 Vali Acc: 0.443 Test Loss: 1.798 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.530553340911865
Epoch: 23, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.789 Vali Acc: 0.440 Test Loss: 1.789 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.346944808959961
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.788 Vali Acc: 0.437 Test Loss: 1.788 Test Acc: 0.437
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.753985643386841
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.777 Vali Acc: 0.447 Test Loss: 1.777 Test Acc: 0.447
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.679400682449341
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.749 Vali Acc: 0.460 Test Loss: 1.749 Test Acc: 0.460
Validation loss decreased (-0.456649 --> -0.459983).  Saving model ...
Epoch: 27 cost time: 6.624042749404907
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.745 Vali Acc: 0.470 Test Loss: 1.745 Test Acc: 0.470
Validation loss decreased (-0.459983 --> -0.469983).  Saving model ...
Epoch: 28 cost time: 6.638168573379517
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.728 Vali Acc: 0.473 Test Loss: 1.728 Test Acc: 0.473
Validation loss decreased (-0.469983 --> -0.473316).  Saving model ...
Epoch: 29 cost time: 6.748762369155884
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.725 Vali Acc: 0.463 Test Loss: 1.725 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.46880841255188
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.723 Vali Acc: 0.457 Test Loss: 1.723 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.151233673095703
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.707 Vali Acc: 0.467 Test Loss: 1.707 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 6.585025787353516
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.701 Vali Acc: 0.473 Test Loss: 1.701 Test Acc: 0.473
Validation loss decreased (-0.473316 --> -0.473316).  Saving model ...
Epoch: 33 cost time: 6.813683748245239
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.692 Vali Acc: 0.480 Test Loss: 1.692 Test Acc: 0.480
Validation loss decreased (-0.473316 --> -0.479983).  Saving model ...
Epoch: 34 cost time: 6.679231405258179
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.688 Vali Acc: 0.483 Test Loss: 1.688 Test Acc: 0.483
Validation loss decreased (-0.479983 --> -0.483316).  Saving model ...
Epoch: 35 cost time: 6.426649570465088
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.683 Vali Acc: 0.483 Test Loss: 1.683 Test Acc: 0.483
Validation loss decreased (-0.483316 --> -0.483316).  Saving model ...
Epoch: 36 cost time: 6.888317346572876
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.674 Vali Acc: 0.497 Test Loss: 1.674 Test Acc: 0.497
Validation loss decreased (-0.483316 --> -0.496650).  Saving model ...
Epoch: 37 cost time: 6.862179279327393
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.672 Vali Acc: 0.493 Test Loss: 1.672 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.884824991226196
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.684 Vali Acc: 0.480 Test Loss: 1.684 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 6.476503372192383
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.693 Vali Acc: 0.507 Test Loss: 1.693 Test Acc: 0.507
Validation loss decreased (-0.496650 --> -0.506650).  Saving model ...
Epoch: 40 cost time: 6.526813745498657
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.679 Vali Acc: 0.510 Test Loss: 1.679 Test Acc: 0.510
Validation loss decreased (-0.506650 --> -0.509983).  Saving model ...
Epoch: 41 cost time: 6.906477451324463
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.668 Vali Acc: 0.513 Test Loss: 1.668 Test Acc: 0.513
Validation loss decreased (-0.509983 --> -0.513317).  Saving model ...
Epoch: 42 cost time: 7.0553154945373535
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.647 Vali Acc: 0.527 Test Loss: 1.647 Test Acc: 0.527
Validation loss decreased (-0.513317 --> -0.526650).  Saving model ...
Epoch: 43 cost time: 6.5921056270599365
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.645 Vali Acc: 0.523 Test Loss: 1.645 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.483918905258179
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.647 Vali Acc: 0.520 Test Loss: 1.647 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 6.536148309707642
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.655 Vali Acc: 0.520 Test Loss: 1.655 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 6.6258463859558105
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.658 Vali Acc: 0.517 Test Loss: 1.658 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 6.580823659896851
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.646 Vali Acc: 0.517 Test Loss: 1.646 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 6.517857789993286
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.640 Vali Acc: 0.517 Test Loss: 1.640 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 6.624032974243164
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.677 Vali Acc: 0.513 Test Loss: 1.677 Test Acc: 0.513
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 6.455592393875122
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.663 Vali Acc: 0.513 Test Loss: 1.663 Test Acc: 0.513
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 6.574490547180176
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.662 Vali Acc: 0.510 Test Loss: 1.662 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 6.49614143371582
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.657 Vali Acc: 0.517 Test Loss: 1.657 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5266666666666666
model parameter : 1185561
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.557844161987305
Epoch: 1, Steps: 18 | Train Loss: 3.277 Vali Loss: 3.260 Vali Acc: 0.047 Test Loss: 3.260 Test Acc: 0.047
Validation loss decreased (inf --> -0.046634).  Saving model ...
Epoch: 2 cost time: 6.822502136230469
Epoch: 2, Steps: 18 | Train Loss: 3.059 Vali Loss: 3.184 Vali Acc: 0.063 Test Loss: 3.184 Test Acc: 0.063
Validation loss decreased (-0.046634 --> -0.063301).  Saving model ...
Epoch: 3 cost time: 6.484391689300537
Epoch: 3, Steps: 18 | Train Loss: 2.732 Vali Loss: 3.100 Vali Acc: 0.083 Test Loss: 3.100 Test Acc: 0.083
Validation loss decreased (-0.063301 --> -0.083302).  Saving model ...
Epoch: 4 cost time: 7.059150695800781
Epoch: 4, Steps: 18 | Train Loss: 2.285 Vali Loss: 3.000 Vali Acc: 0.120 Test Loss: 3.000 Test Acc: 0.120
Validation loss decreased (-0.083302 --> -0.119970).  Saving model ...
Epoch: 5 cost time: 6.850606679916382
Epoch: 5, Steps: 18 | Train Loss: 1.839 Vali Loss: 2.927 Vali Acc: 0.137 Test Loss: 2.927 Test Acc: 0.137
Validation loss decreased (-0.119970 --> -0.136637).  Saving model ...
Epoch: 6 cost time: 7.151425361633301
Epoch: 6, Steps: 18 | Train Loss: 1.335 Vali Loss: 2.820 Vali Acc: 0.180 Test Loss: 2.820 Test Acc: 0.180
Validation loss decreased (-0.136637 --> -0.179972).  Saving model ...
Epoch: 7 cost time: 6.7019734382629395
Epoch: 7, Steps: 18 | Train Loss: 0.881 Vali Loss: 2.711 Vali Acc: 0.180 Test Loss: 2.711 Test Acc: 0.180
Validation loss decreased (-0.179972 --> -0.179973).  Saving model ...
Epoch: 8 cost time: 6.883204936981201
Epoch: 8, Steps: 18 | Train Loss: 0.557 Vali Loss: 2.586 Vali Acc: 0.223 Test Loss: 2.586 Test Acc: 0.223
Validation loss decreased (-0.179973 --> -0.223307).  Saving model ...
Epoch: 9 cost time: 6.409987211227417
Epoch: 9, Steps: 18 | Train Loss: 0.326 Vali Loss: 2.393 Vali Acc: 0.280 Test Loss: 2.393 Test Acc: 0.280
Validation loss decreased (-0.223307 --> -0.279976).  Saving model ...
Epoch: 10 cost time: 6.9056665897369385
Epoch: 10, Steps: 18 | Train Loss: 0.160 Vali Loss: 2.272 Vali Acc: 0.303 Test Loss: 2.272 Test Acc: 0.303
Validation loss decreased (-0.279976 --> -0.303311).  Saving model ...
Epoch: 11 cost time: 6.875159978866577
Epoch: 11, Steps: 18 | Train Loss: 0.095 Vali Loss: 2.104 Vali Acc: 0.360 Test Loss: 2.104 Test Acc: 0.360
Validation loss decreased (-0.303311 --> -0.359979).  Saving model ...
Epoch: 12 cost time: 6.5112855434417725
Epoch: 12, Steps: 18 | Train Loss: 0.055 Vali Loss: 2.012 Vali Acc: 0.360 Test Loss: 2.012 Test Acc: 0.360
Validation loss decreased (-0.359979 --> -0.359980).  Saving model ...
Epoch: 13 cost time: 7.143699407577515
Epoch: 13, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.979 Vali Acc: 0.353 Test Loss: 1.979 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.131941556930542
Epoch: 14, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.871 Vali Acc: 0.407 Test Loss: 1.871 Test Acc: 0.407
Validation loss decreased (-0.359980 --> -0.406648).  Saving model ...
Epoch: 15 cost time: 6.826355695724487
Epoch: 15, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.839 Vali Acc: 0.423 Test Loss: 1.839 Test Acc: 0.423
Validation loss decreased (-0.406648 --> -0.423315).  Saving model ...
Epoch: 16 cost time: 6.583111763000488
Epoch: 16, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.808 Vali Acc: 0.427 Test Loss: 1.808 Test Acc: 0.427
Validation loss decreased (-0.423315 --> -0.426649).  Saving model ...
Epoch: 17 cost time: 6.351706266403198
Epoch: 17, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.790 Vali Acc: 0.433 Test Loss: 1.790 Test Acc: 0.433
Validation loss decreased (-0.426649 --> -0.433315).  Saving model ...
Epoch: 18 cost time: 6.796000719070435
Epoch: 18, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.741 Vali Acc: 0.433 Test Loss: 1.741 Test Acc: 0.433
Validation loss decreased (-0.433315 --> -0.433316).  Saving model ...
Epoch: 19 cost time: 6.891878843307495
Epoch: 19, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.718 Vali Acc: 0.440 Test Loss: 1.718 Test Acc: 0.440
Validation loss decreased (-0.433316 --> -0.439983).  Saving model ...
Epoch: 20 cost time: 6.727493762969971
Epoch: 20, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.695 Vali Acc: 0.450 Test Loss: 1.695 Test Acc: 0.450
Validation loss decreased (-0.439983 --> -0.449983).  Saving model ...
Epoch: 21 cost time: 6.42655086517334
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.677 Vali Acc: 0.470 Test Loss: 1.677 Test Acc: 0.470
Validation loss decreased (-0.449983 --> -0.469983).  Saving model ...
Epoch: 22 cost time: 6.365633964538574
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.665 Vali Acc: 0.467 Test Loss: 1.665 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.185238361358643
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.648 Vali Acc: 0.473 Test Loss: 1.648 Test Acc: 0.473
Validation loss decreased (-0.469983 --> -0.473317).  Saving model ...
Epoch: 24 cost time: 6.377436876296997
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.641 Vali Acc: 0.473 Test Loss: 1.641 Test Acc: 0.473
Validation loss decreased (-0.473317 --> -0.473317).  Saving model ...
Epoch: 25 cost time: 6.540739059448242
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.626 Vali Acc: 0.473 Test Loss: 1.626 Test Acc: 0.473
Validation loss decreased (-0.473317 --> -0.473317).  Saving model ...
Epoch: 26 cost time: 6.511032342910767
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.601 Vali Acc: 0.497 Test Loss: 1.601 Test Acc: 0.497
Validation loss decreased (-0.473317 --> -0.496651).  Saving model ...
Epoch: 27 cost time: 6.839645147323608
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.592 Vali Acc: 0.493 Test Loss: 1.592 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.891343116760254
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.587 Vali Acc: 0.497 Test Loss: 1.587 Test Acc: 0.497
Validation loss decreased (-0.496651 --> -0.496651).  Saving model ...
Epoch: 29 cost time: 6.832130193710327
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.575 Vali Acc: 0.513 Test Loss: 1.575 Test Acc: 0.513
Validation loss decreased (-0.496651 --> -0.513318).  Saving model ...
Epoch: 30 cost time: 6.438650846481323
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.570 Vali Acc: 0.517 Test Loss: 1.570 Test Acc: 0.517
Validation loss decreased (-0.513318 --> -0.516651).  Saving model ...
Epoch: 31 cost time: 6.59660005569458
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.557 Vali Acc: 0.537 Test Loss: 1.557 Test Acc: 0.537
Validation loss decreased (-0.516651 --> -0.536651).  Saving model ...
Epoch: 32 cost time: 6.2344255447387695
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.546 Vali Acc: 0.530 Test Loss: 1.546 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.392195701599121
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.534 Vali Acc: 0.540 Test Loss: 1.534 Test Acc: 0.540
Validation loss decreased (-0.536651 --> -0.539985).  Saving model ...
Epoch: 34 cost time: 6.706202030181885
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.526 Vali Acc: 0.537 Test Loss: 1.526 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.489897727966309
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.513 Vali Acc: 0.540 Test Loss: 1.513 Test Acc: 0.540
Validation loss decreased (-0.539985 --> -0.539985).  Saving model ...
Epoch: 36 cost time: 7.0258729457855225
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.506 Vali Acc: 0.550 Test Loss: 1.506 Test Acc: 0.550
Validation loss decreased (-0.539985 --> -0.549985).  Saving model ...
Epoch: 37 cost time: 6.836923360824585
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.500 Vali Acc: 0.543 Test Loss: 1.500 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.8264219760894775
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.504 Vali Acc: 0.540 Test Loss: 1.504 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 6.558716058731079
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.504 Vali Acc: 0.533 Test Loss: 1.504 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 6.447484254837036
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.494 Vali Acc: 0.550 Test Loss: 1.494 Test Acc: 0.550
Validation loss decreased (-0.549985 --> -0.549985).  Saving model ...
Epoch: 41 cost time: 6.872921705245972
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.487 Vali Acc: 0.560 Test Loss: 1.487 Test Acc: 0.560
Validation loss decreased (-0.549985 --> -0.559985).  Saving model ...
Epoch: 42 cost time: 7.442594766616821
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.479 Vali Acc: 0.557 Test Loss: 1.479 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 7.542994022369385
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.550 Test Loss: 1.475 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 7.371269702911377
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.471 Vali Acc: 0.540 Test Loss: 1.471 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 7.0921618938446045
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.468 Vali Acc: 0.547 Test Loss: 1.468 Test Acc: 0.547
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 6.7315967082977295
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.469 Vali Acc: 0.547 Test Loss: 1.469 Test Acc: 0.547
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 6.894632816314697
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.460 Vali Acc: 0.557 Test Loss: 1.460 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 7.009046316146851
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.454 Vali Acc: 0.557 Test Loss: 1.454 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 7.764562606811523
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.495 Vali Acc: 0.547 Test Loss: 1.495 Test Acc: 0.547
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 7.325872182846069
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.473 Vali Acc: 0.557 Test Loss: 1.473 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 7.210513353347778
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.462 Vali Acc: 0.567 Test Loss: 1.462 Test Acc: 0.567
Validation loss decreased (-0.559985 --> -0.566652).  Saving model ...
Epoch: 52 cost time: 6.871931552886963
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.454 Vali Acc: 0.570 Test Loss: 1.454 Test Acc: 0.570
Validation loss decreased (-0.566652 --> -0.569985).  Saving model ...
Epoch: 53 cost time: 6.520861625671387
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.443 Vali Acc: 0.580 Test Loss: 1.443 Test Acc: 0.580
Validation loss decreased (-0.569985 --> -0.579986).  Saving model ...
Epoch: 54 cost time: 6.262718677520752
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.431 Vali Acc: 0.590 Test Loss: 1.431 Test Acc: 0.590
Validation loss decreased (-0.579986 --> -0.589986).  Saving model ...
Epoch: 55 cost time: 6.706230640411377
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.428 Vali Acc: 0.587 Test Loss: 1.428 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 7.456888914108276
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.420 Vali Acc: 0.590 Test Loss: 1.420 Test Acc: 0.590
Validation loss decreased (-0.589986 --> -0.589986).  Saving model ...
Epoch: 57 cost time: 6.941707134246826
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.413 Vali Acc: 0.583 Test Loss: 1.413 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.7052998542785645
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.603 Test Loss: 1.406 Test Acc: 0.603
Validation loss decreased (-0.589986 --> -0.603319).  Saving model ...
Epoch: 59 cost time: 6.8429412841796875
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.403 Vali Acc: 0.603 Test Loss: 1.403 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 60 cost time: 6.256149053573608
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.404 Vali Acc: 0.597 Test Loss: 1.404 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.755144834518433
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.593 Test Loss: 1.406 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 6.282298564910889
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.593 Test Loss: 1.406 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 6.769148111343384
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.404 Vali Acc: 0.593 Test Loss: 1.404 Test Acc: 0.593
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 6.658107757568359
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.603 Test Loss: 1.399 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 65 cost time: 7.136266469955444
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.600 Test Loss: 1.398 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 6.839690208435059
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.603 Test Loss: 1.399 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 67 cost time: 6.529632091522217
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.600 Test Loss: 1.399 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 6.438898324966431
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.597 Test Loss: 1.397 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 6.889760732650757
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.587 Test Loss: 1.395 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 6.781477451324463
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.590 Test Loss: 1.396 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 6.706044435501099
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.590 Test Loss: 1.391 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 7.303040504455566
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.590 Test Loss: 1.387 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 7.240707159042358
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.590 Test Loss: 1.384 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 6.733204126358032
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.593 Test Loss: 1.381 Test Acc: 0.593
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 6.4252402782440186
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.379 Vali Acc: 0.600 Test Loss: 1.379 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 6.533732652664185
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.600 Test Loss: 1.380 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6033333333333334
model parameter : 1185561
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.987141847610474
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 6.31089186668396
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.434118747711182
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.267333030700684
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.148944854736328
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.169025897979736
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.4410130977630615
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.711846351623535
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.660120248794556
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.72066068649292
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.6223108768463135
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 1185561
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.743439674377441
Epoch: 1, Steps: 18 | Train Loss: 3.136 Vali Loss: 2.740 Vali Acc: 0.420 Test Loss: 2.740 Test Acc: 0.420
Validation loss decreased (inf --> -0.419973).  Saving model ...
Epoch: 2 cost time: 6.766983985900879
Epoch: 2, Steps: 18 | Train Loss: 2.228 Vali Loss: 1.746 Vali Acc: 0.753 Test Loss: 1.746 Test Acc: 0.753
Validation loss decreased (-0.419973 --> -0.753316).  Saving model ...
Epoch: 3 cost time: 6.785397052764893
Epoch: 3, Steps: 18 | Train Loss: 1.192 Vali Loss: 0.987 Vali Acc: 0.847 Test Loss: 0.987 Test Acc: 0.847
Validation loss decreased (-0.753316 --> -0.846657).  Saving model ...
Epoch: 4 cost time: 7.052537679672241
Epoch: 4, Steps: 18 | Train Loss: 0.493 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
Validation loss decreased (-0.846657 --> -0.849994).  Saving model ...
Epoch: 5 cost time: 7.024090766906738
Epoch: 5, Steps: 18 | Train Loss: 0.195 Vali Loss: 0.491 Vali Acc: 0.887 Test Loss: 0.491 Test Acc: 0.887
Validation loss decreased (-0.849994 --> -0.886662).  Saving model ...
Epoch: 6 cost time: 6.698387861251831
Epoch: 6, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.441 Vali Acc: 0.883 Test Loss: 0.441 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.710434198379517
Epoch: 7, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.402 Vali Acc: 0.893 Test Loss: 0.402 Test Acc: 0.893
Validation loss decreased (-0.886662 --> -0.893329).  Saving model ...
Epoch: 8 cost time: 6.966017961502075
Epoch: 8, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.388 Vali Acc: 0.887 Test Loss: 0.388 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.549440383911133
Epoch: 9, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.377 Vali Acc: 0.890 Test Loss: 0.377 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.698655605316162
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.371 Vali Acc: 0.893 Test Loss: 0.371 Test Acc: 0.893
Validation loss decreased (-0.893329 --> -0.893330).  Saving model ...
Epoch: 11 cost time: 6.566325902938843
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.367 Vali Acc: 0.897 Test Loss: 0.367 Test Acc: 0.897
Validation loss decreased (-0.893330 --> -0.896663).  Saving model ...
Epoch: 12 cost time: 6.7893078327178955
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.363 Vali Acc: 0.893 Test Loss: 0.363 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.453463077545166
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.360 Vali Acc: 0.893 Test Loss: 0.360 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.814232110977173
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.355 Vali Acc: 0.893 Test Loss: 0.355 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.144260883331299
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.352 Vali Acc: 0.893 Test Loss: 0.352 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.005609512329102
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.351 Vali Acc: 0.897 Test Loss: 0.351 Test Acc: 0.897
Validation loss decreased (-0.896663 --> -0.896663).  Saving model ...
Epoch: 17 cost time: 6.898700952529907
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
Validation loss decreased (-0.896663 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 6.527146816253662
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.348 Vali Acc: 0.907 Test Loss: 0.348 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.906663).  Saving model ...
Epoch: 19 cost time: 6.600494384765625
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.859879016876221
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.781464338302612
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.192014694213867
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.0251171588897705
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.248080015182495
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.339 Vali Acc: 0.897 Test Loss: 0.339 Test Acc: 0.897
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.78721809387207
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.338 Vali Acc: 0.907 Test Loss: 0.338 Test Acc: 0.907
Validation loss decreased (-0.906663 --> -0.906663).  Saving model ...
Epoch: 26 cost time: 6.557301759719849
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.910 Test Loss: 0.336 Test Acc: 0.910
Validation loss decreased (-0.906663 --> -0.909997).  Saving model ...
Epoch: 27 cost time: 6.706805467605591
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.907 Test Loss: 0.336 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.4535605907440186
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.910 Test Loss: 0.335 Test Acc: 0.910
Validation loss decreased (-0.909997 --> -0.909997).  Saving model ...
Epoch: 29 cost time: 6.971704959869385
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.910 Test Loss: 0.335 Test Acc: 0.910
Validation loss decreased (-0.909997 --> -0.909997).  Saving model ...
Epoch: 30 cost time: 6.9886155128479
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.907 Test Loss: 0.335 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 7.153099536895752
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.907 Test Loss: 0.335 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.537057399749756
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.907 Test Loss: 0.334 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 7.113179445266724
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.907 Test Loss: 0.333 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 6.769365072250366
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.907 Test Loss: 0.334 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 6.6393115520477295
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.907 Test Loss: 0.334 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 7.167770147323608
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.913 Test Loss: 0.334 Test Acc: 0.913
Validation loss decreased (-0.909997 --> -0.913330).  Saving model ...
Epoch: 37 cost time: 6.962134599685669
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.910 Test Loss: 0.334 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 7.14166784286499
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.910 Test Loss: 0.333 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 6.7012856006622314
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.910 Test Loss: 0.333 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 6.5631396770477295
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.910 Test Loss: 0.332 Test Acc: 0.910
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 6.681945562362671
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.907 Test Loss: 0.333 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 6.974374294281006
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.910 Test Loss: 0.332 Test Acc: 0.910
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 6.905552625656128
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.331 Vali Acc: 0.910 Test Loss: 0.331 Test Acc: 0.910
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 6.883538484573364
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.907 Test Loss: 0.330 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 7.017277956008911
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 6.622890949249268
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.329 Vali Acc: 0.907 Test Loss: 0.329 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9133333333333333
model parameter : 792345
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.380287647247314
Epoch: 1, Steps: 18 | Train Loss: 3.179 Vali Loss: 2.876 Vali Acc: 0.307 Test Loss: 2.876 Test Acc: 0.307
Validation loss decreased (inf --> -0.306638).  Saving model ...
Epoch: 2 cost time: 6.618387699127197
Epoch: 2, Steps: 18 | Train Loss: 2.452 Vali Loss: 2.095 Vali Acc: 0.673 Test Loss: 2.095 Test Acc: 0.673
Validation loss decreased (-0.306638 --> -0.673312).  Saving model ...
Epoch: 3 cost time: 7.604200601577759
Epoch: 3, Steps: 18 | Train Loss: 1.501 Vali Loss: 1.359 Vali Acc: 0.760 Test Loss: 1.359 Test Acc: 0.760
Validation loss decreased (-0.673312 --> -0.759986).  Saving model ...
Epoch: 4 cost time: 7.253892421722412
Epoch: 4, Steps: 18 | Train Loss: 0.699 Vali Loss: 0.928 Vali Acc: 0.803 Test Loss: 0.928 Test Acc: 0.803
Validation loss decreased (-0.759986 --> -0.803324).  Saving model ...
Epoch: 5 cost time: 6.835601329803467
Epoch: 5, Steps: 18 | Train Loss: 0.292 Vali Loss: 0.722 Vali Acc: 0.820 Test Loss: 0.722 Test Acc: 0.820
Validation loss decreased (-0.803324 --> -0.819993).  Saving model ...
Epoch: 6 cost time: 6.940753221511841
Epoch: 6, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.641 Vali Acc: 0.847 Test Loss: 0.641 Test Acc: 0.847
Validation loss decreased (-0.819993 --> -0.846660).  Saving model ...
Epoch: 7 cost time: 6.502701282501221
Epoch: 7, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.596 Vali Acc: 0.837 Test Loss: 0.596 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.489301919937134
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
Validation loss decreased (-0.846660 --> -0.849994).  Saving model ...
Epoch: 9 cost time: 6.484044313430786
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.554 Vali Acc: 0.863 Test Loss: 0.554 Test Acc: 0.863
Validation loss decreased (-0.849994 --> -0.863328).  Saving model ...
Epoch: 10 cost time: 6.720067024230957
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.544 Vali Acc: 0.857 Test Loss: 0.544 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.818623304367065
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.536 Vali Acc: 0.863 Test Loss: 0.536 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 12 cost time: 6.461004972457886
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.534 Vali Acc: 0.863 Test Loss: 0.534 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 13 cost time: 6.576457738876343
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
Validation loss decreased (-0.863328 --> -0.866661).  Saving model ...
Epoch: 14 cost time: 6.804213523864746
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.528 Vali Acc: 0.860 Test Loss: 0.528 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.256988525390625
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.526 Vali Acc: 0.867 Test Loss: 0.526 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 16 cost time: 6.176336765289307
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 6.358505964279175
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 18 cost time: 6.767824172973633
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 6.752041578292847
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 6.69895076751709
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.517 Vali Acc: 0.860 Test Loss: 0.517 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.591169595718384
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.517 Vali Acc: 0.860 Test Loss: 0.517 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.972278118133545
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 23 cost time: 6.651487588882446
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.870 Test Loss: 0.514 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.869995).  Saving model ...
Epoch: 24 cost time: 6.807834148406982
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.863 Test Loss: 0.512 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.9685163497924805
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.186283588409424
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.863 Test Loss: 0.512 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.27347469329834
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.047481298446655
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
Validation loss decreased (-0.869995 --> -0.869995).  Saving model ...
Epoch: 29 cost time: 6.717335939407349
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.873 Test Loss: 0.511 Test Acc: 0.873
Validation loss decreased (-0.869995 --> -0.873328).  Saving model ...
Epoch: 30 cost time: 7.072563648223877
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.873 Test Loss: 0.510 Test Acc: 0.873
Validation loss decreased (-0.873328 --> -0.873328).  Saving model ...
Epoch: 31 cost time: 6.739453554153442
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.566728115081787
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.980605840682983
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.731082916259766
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.863 Test Loss: 0.512 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 6.653289556503296
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 6.240066289901733
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 6.751408576965332
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 6.393538475036621
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 6.407878398895264
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 6.508984088897705
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8733333333333333
model parameter : 792345
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.306358098983765
Epoch: 1, Steps: 18 | Train Loss: 3.204 Vali Loss: 2.995 Vali Acc: 0.180 Test Loss: 2.995 Test Acc: 0.180
Validation loss decreased (inf --> -0.179970).  Saving model ...
Epoch: 2 cost time: 6.318109512329102
Epoch: 2, Steps: 18 | Train Loss: 2.687 Vali Loss: 2.465 Vali Acc: 0.517 Test Loss: 2.465 Test Acc: 0.517
Validation loss decreased (-0.179970 --> -0.516642).  Saving model ...
Epoch: 3 cost time: 6.781532526016235
Epoch: 3, Steps: 18 | Train Loss: 1.914 Vali Loss: 1.881 Vali Acc: 0.640 Test Loss: 1.881 Test Acc: 0.640
Validation loss decreased (-0.516642 --> -0.639981).  Saving model ...
Epoch: 4 cost time: 6.8354597091674805
Epoch: 4, Steps: 18 | Train Loss: 1.106 Vali Loss: 1.396 Vali Acc: 0.703 Test Loss: 1.396 Test Acc: 0.703
Validation loss decreased (-0.639981 --> -0.703319).  Saving model ...
Epoch: 5 cost time: 6.184909820556641
Epoch: 5, Steps: 18 | Train Loss: 0.526 Vali Loss: 1.104 Vali Acc: 0.730 Test Loss: 1.104 Test Acc: 0.730
Validation loss decreased (-0.703319 --> -0.729989).  Saving model ...
Epoch: 6 cost time: 6.814666748046875
Epoch: 6, Steps: 18 | Train Loss: 0.220 Vali Loss: 0.949 Vali Acc: 0.777 Test Loss: 0.949 Test Acc: 0.777
Validation loss decreased (-0.729989 --> -0.776657).  Saving model ...
Epoch: 7 cost time: 6.310602188110352
Epoch: 7, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.883 Vali Acc: 0.760 Test Loss: 0.883 Test Acc: 0.760
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.72292685508728
Epoch: 8, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.858 Vali Acc: 0.773 Test Loss: 0.858 Test Acc: 0.773
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.416756868362427
Epoch: 9, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.831 Vali Acc: 0.767 Test Loss: 0.831 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.204299449920654
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.823 Vali Acc: 0.770 Test Loss: 0.823 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.9752209186553955
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.808 Vali Acc: 0.773 Test Loss: 0.808 Test Acc: 0.773
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.218003988265991
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.811 Vali Acc: 0.770 Test Loss: 0.811 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.578578472137451
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.806 Vali Acc: 0.777 Test Loss: 0.806 Test Acc: 0.777
Validation loss decreased (-0.776657 --> -0.776659).  Saving model ...
Epoch: 14 cost time: 6.483703374862671
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.795 Vali Acc: 0.783 Test Loss: 0.795 Test Acc: 0.783
Validation loss decreased (-0.776659 --> -0.783325).  Saving model ...
Epoch: 15 cost time: 6.938766717910767
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.791 Vali Acc: 0.790 Test Loss: 0.791 Test Acc: 0.790
Validation loss decreased (-0.783325 --> -0.789992).  Saving model ...
Epoch: 16 cost time: 6.422276258468628
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.790 Vali Acc: 0.787 Test Loss: 0.790 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.105802536010742
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.794 Vali Acc: 0.773 Test Loss: 0.794 Test Acc: 0.773
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.263330698013306
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.791 Vali Acc: 0.783 Test Loss: 0.791 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.865187168121338
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.789 Vali Acc: 0.783 Test Loss: 0.789 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.326723575592041
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.791 Vali Acc: 0.793 Test Loss: 0.791 Test Acc: 0.793
Validation loss decreased (-0.789992 --> -0.793325).  Saving model ...
Epoch: 21 cost time: 6.412545442581177
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.793 Vali Acc: 0.790 Test Loss: 0.793 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.53377628326416
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.791 Vali Acc: 0.790 Test Loss: 0.791 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.619204521179199
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.789 Vali Acc: 0.793 Test Loss: 0.789 Test Acc: 0.793
Validation loss decreased (-0.793325 --> -0.793325).  Saving model ...
Epoch: 24 cost time: 6.18150520324707
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.787 Vali Acc: 0.790 Test Loss: 0.787 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.782379150390625
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.785 Vali Acc: 0.800 Test Loss: 0.785 Test Acc: 0.800
Validation loss decreased (-0.793325 --> -0.799992).  Saving model ...
Epoch: 26 cost time: 6.499606132507324
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.785 Vali Acc: 0.793 Test Loss: 0.785 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.771669387817383
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.785 Vali Acc: 0.797 Test Loss: 0.785 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.96742057800293
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.784 Vali Acc: 0.797 Test Loss: 0.784 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.797054767608643
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.782 Vali Acc: 0.797 Test Loss: 0.782 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.958906650543213
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.790 Test Loss: 0.782 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.275343894958496
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.797 Test Loss: 0.783 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.5348052978515625
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.803 Test Loss: 0.784 Test Acc: 0.803
Validation loss decreased (-0.799992 --> -0.803325).  Saving model ...
Epoch: 33 cost time: 6.501965522766113
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.797 Test Loss: 0.786 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.550994396209717
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.793 Test Loss: 0.785 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.858591079711914
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.803 Test Loss: 0.787 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 7.223989725112915
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.807 Test Loss: 0.787 Test Acc: 0.807
Validation loss decreased (-0.803325 --> -0.806659).  Saving model ...
Epoch: 37 cost time: 6.525424480438232
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.803 Test Loss: 0.786 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.5666093826293945
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.800 Test Loss: 0.784 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 6.029051303863525
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.793 Test Loss: 0.786 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 6.154444217681885
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.803 Test Loss: 0.786 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 6.283222913742065
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.810 Test Loss: 0.787 Test Acc: 0.810
Validation loss decreased (-0.806659 --> -0.809992).  Saving model ...
Epoch: 42 cost time: 6.419351816177368
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.803 Test Loss: 0.787 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.735961198806763
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.807 Test Loss: 0.786 Test Acc: 0.807
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 6.750337362289429
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 6.777387857437134
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.797 Test Loss: 0.789 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 6.587801694869995
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.800 Test Loss: 0.787 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 6.288228511810303
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.800 Test Loss: 0.787 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 6.1862571239471436
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.803 Test Loss: 0.786 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 6.24483585357666
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.803 Test Loss: 0.788 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 6.649688243865967
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.800 Test Loss: 0.788 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 6.442435264587402
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.803 Test Loss: 0.789 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.81
model parameter : 792345
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.305885553359985
Epoch: 1, Steps: 18 | Train Loss: 3.234 Vali Loss: 3.090 Vali Acc: 0.123 Test Loss: 3.090 Test Acc: 0.123
Validation loss decreased (inf --> -0.123302).  Saving model ...
Epoch: 2 cost time: 6.176961898803711
Epoch: 2, Steps: 18 | Train Loss: 2.853 Vali Loss: 2.757 Vali Acc: 0.370 Test Loss: 2.757 Test Acc: 0.370
Validation loss decreased (-0.123302 --> -0.369972).  Saving model ...
Epoch: 3 cost time: 5.789096355438232
Epoch: 3, Steps: 18 | Train Loss: 2.264 Vali Loss: 2.368 Vali Acc: 0.467 Test Loss: 2.368 Test Acc: 0.467
Validation loss decreased (-0.369972 --> -0.466643).  Saving model ...
Epoch: 4 cost time: 6.002636909484863
Epoch: 4, Steps: 18 | Train Loss: 1.580 Vali Loss: 1.985 Vali Acc: 0.547 Test Loss: 1.985 Test Acc: 0.547
Validation loss decreased (-0.466643 --> -0.546647).  Saving model ...
Epoch: 5 cost time: 5.922529458999634
Epoch: 5, Steps: 18 | Train Loss: 0.953 Vali Loss: 1.674 Vali Acc: 0.580 Test Loss: 1.674 Test Acc: 0.580
Validation loss decreased (-0.546647 --> -0.579983).  Saving model ...
Epoch: 6 cost time: 5.838638782501221
Epoch: 6, Steps: 18 | Train Loss: 0.497 Vali Loss: 1.449 Vali Acc: 0.597 Test Loss: 1.449 Test Acc: 0.597
Validation loss decreased (-0.579983 --> -0.596652).  Saving model ...
Epoch: 7 cost time: 5.875566244125366
Epoch: 7, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.342 Vali Acc: 0.620 Test Loss: 1.342 Test Acc: 0.620
Validation loss decreased (-0.596652 --> -0.619987).  Saving model ...
Epoch: 8 cost time: 6.079651355743408
Epoch: 8, Steps: 18 | Train Loss: 0.093 Vali Loss: 1.256 Vali Acc: 0.627 Test Loss: 1.256 Test Acc: 0.627
Validation loss decreased (-0.619987 --> -0.626654).  Saving model ...
Epoch: 9 cost time: 6.0949506759643555
Epoch: 9, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.214 Vali Acc: 0.633 Test Loss: 1.214 Test Acc: 0.633
Validation loss decreased (-0.626654 --> -0.633321).  Saving model ...
Epoch: 10 cost time: 6.345379829406738
Epoch: 10, Steps: 18 | Train Loss: 0.031 Vali Loss: 1.185 Vali Acc: 0.640 Test Loss: 1.185 Test Acc: 0.640
Validation loss decreased (-0.633321 --> -0.639988).  Saving model ...
Epoch: 11 cost time: 6.724271535873413
Epoch: 11, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.165 Vali Acc: 0.653 Test Loss: 1.165 Test Acc: 0.653
Validation loss decreased (-0.639988 --> -0.653322).  Saving model ...
Epoch: 12 cost time: 6.1124842166900635
Epoch: 12, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.163 Vali Acc: 0.640 Test Loss: 1.163 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.015838623046875
Epoch: 13, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.151 Vali Acc: 0.650 Test Loss: 1.151 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.795888423919678
Epoch: 14, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.133 Vali Acc: 0.657 Test Loss: 1.133 Test Acc: 0.657
Validation loss decreased (-0.653322 --> -0.656655).  Saving model ...
Epoch: 15 cost time: 6.059632062911987
Epoch: 15, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.125 Vali Acc: 0.657 Test Loss: 1.125 Test Acc: 0.657
Validation loss decreased (-0.656655 --> -0.656655).  Saving model ...
Epoch: 16 cost time: 6.767796754837036
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.119 Vali Acc: 0.663 Test Loss: 1.119 Test Acc: 0.663
Validation loss decreased (-0.656655 --> -0.663322).  Saving model ...
Epoch: 17 cost time: 6.358178377151489
Epoch: 17, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.117 Vali Acc: 0.673 Test Loss: 1.117 Test Acc: 0.673
Validation loss decreased (-0.663322 --> -0.673322).  Saving model ...
Epoch: 18 cost time: 6.253993511199951
Epoch: 18, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.111 Vali Acc: 0.673 Test Loss: 1.111 Test Acc: 0.673
Validation loss decreased (-0.673322 --> -0.673322).  Saving model ...
Epoch: 19 cost time: 6.417404651641846
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.104 Vali Acc: 0.670 Test Loss: 1.104 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.845904588699341
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.101 Vali Acc: 0.670 Test Loss: 1.101 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.093884706497192
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.098 Vali Acc: 0.677 Test Loss: 1.098 Test Acc: 0.677
Validation loss decreased (-0.673322 --> -0.676656).  Saving model ...
Epoch: 22 cost time: 5.76155686378479
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.095 Vali Acc: 0.677 Test Loss: 1.095 Test Acc: 0.677
Validation loss decreased (-0.676656 --> -0.676656).  Saving model ...
Epoch: 23 cost time: 5.988583326339722
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.092 Vali Acc: 0.677 Test Loss: 1.092 Test Acc: 0.677
Validation loss decreased (-0.676656 --> -0.676656).  Saving model ...
Epoch: 24 cost time: 6.243008136749268
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.085 Vali Acc: 0.677 Test Loss: 1.085 Test Acc: 0.677
Validation loss decreased (-0.676656 --> -0.676656).  Saving model ...
Epoch: 25 cost time: 6.213146209716797
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.076 Vali Acc: 0.683 Test Loss: 1.076 Test Acc: 0.683
Validation loss decreased (-0.676656 --> -0.683323).  Saving model ...
Epoch: 26 cost time: 6.126159191131592
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.072 Vali Acc: 0.680 Test Loss: 1.072 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.9948999881744385
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.072 Vali Acc: 0.683 Test Loss: 1.072 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683323).  Saving model ...
Epoch: 28 cost time: 5.652737379074097
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.072 Vali Acc: 0.680 Test Loss: 1.072 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.336862802505493
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.070 Vali Acc: 0.690 Test Loss: 1.070 Test Acc: 0.690
Validation loss decreased (-0.683323 --> -0.689989).  Saving model ...
Epoch: 30 cost time: 5.46135687828064
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.070 Vali Acc: 0.690 Test Loss: 1.070 Test Acc: 0.690
Validation loss decreased (-0.689989 --> -0.689989).  Saving model ...
Epoch: 31 cost time: 5.407646417617798
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.070 Vali Acc: 0.690 Test Loss: 1.070 Test Acc: 0.690
Validation loss decreased (-0.689989 --> -0.689989).  Saving model ...
Epoch: 32 cost time: 6.041381359100342
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.070 Vali Acc: 0.697 Test Loss: 1.070 Test Acc: 0.697
Validation loss decreased (-0.689989 --> -0.696656).  Saving model ...
Epoch: 33 cost time: 6.09291934967041
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.070 Vali Acc: 0.697 Test Loss: 1.070 Test Acc: 0.697
Validation loss decreased (-0.696656 --> -0.696656).  Saving model ...
Epoch: 34 cost time: 6.232595682144165
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.068 Vali Acc: 0.693 Test Loss: 1.068 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.392720460891724
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.064 Vali Acc: 0.693 Test Loss: 1.064 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.903021335601807
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.063 Vali Acc: 0.693 Test Loss: 1.063 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 5.800207853317261
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.058 Vali Acc: 0.697 Test Loss: 1.058 Test Acc: 0.697
Validation loss decreased (-0.696656 --> -0.696656).  Saving model ...
Epoch: 38 cost time: 5.7722554206848145
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.055 Vali Acc: 0.703 Test Loss: 1.055 Test Acc: 0.703
Validation loss decreased (-0.696656 --> -0.703323).  Saving model ...
Epoch: 39 cost time: 5.505404472351074
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.055 Vali Acc: 0.697 Test Loss: 1.055 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.068295240402222
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.056 Vali Acc: 0.700 Test Loss: 1.056 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.395854234695435
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.062 Vali Acc: 0.700 Test Loss: 1.062 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 6.151650428771973
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.055 Vali Acc: 0.700 Test Loss: 1.055 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 5.983412265777588
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.051 Vali Acc: 0.703 Test Loss: 1.051 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 44 cost time: 5.641788959503174
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.048 Vali Acc: 0.703 Test Loss: 1.048 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 45 cost time: 5.942137002944946
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.050 Vali Acc: 0.703 Test Loss: 1.050 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.859418153762817
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.048 Vali Acc: 0.703 Test Loss: 1.048 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.891611337661743
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.707 Test Loss: 1.045 Test Acc: 0.707
Validation loss decreased (-0.703323 --> -0.706656).  Saving model ...
Epoch: 48 cost time: 5.961780071258545
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.043 Vali Acc: 0.703 Test Loss: 1.043 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.128411293029785
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.048 Vali Acc: 0.703 Test Loss: 1.048 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 6.155560255050659
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.703 Test Loss: 1.045 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.126387357711792
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.043 Vali Acc: 0.703 Test Loss: 1.043 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 6.106380462646484
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.042 Vali Acc: 0.703 Test Loss: 1.042 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 6.153987169265747
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.713 Test Loss: 1.045 Test Acc: 0.713
Validation loss decreased (-0.706656 --> -0.713323).  Saving model ...
Epoch: 54 cost time: 5.801430940628052
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.710 Test Loss: 1.042 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.2668070793151855
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.707 Test Loss: 1.041 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 6.036194086074829
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.707 Test Loss: 1.039 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 6.276817321777344
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.710 Test Loss: 1.039 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 6.451128005981445
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.710 Test Loss: 1.040 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 6.273986339569092
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.713 Test Loss: 1.038 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 60 cost time: 5.959294557571411
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.710 Test Loss: 1.037 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.017357349395752
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.710 Test Loss: 1.035 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 5.666109323501587
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.707 Test Loss: 1.034 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 5.735533237457275
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.710 Test Loss: 1.034 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 6.112578868865967
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.717 Test Loss: 1.034 Test Acc: 0.717
Validation loss decreased (-0.713323 --> -0.716656).  Saving model ...
Epoch: 65 cost time: 5.942276477813721
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.720 Test Loss: 1.035 Test Acc: 0.720
Validation loss decreased (-0.716656 --> -0.719990).  Saving model ...
Epoch: 66 cost time: 5.790964841842651
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.717 Test Loss: 1.035 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 5.989112854003906
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.717 Test Loss: 1.034 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 5.853818893432617
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.720 Test Loss: 1.033 Test Acc: 0.720
Validation loss decreased (-0.719990 --> -0.719990).  Saving model ...
Epoch: 69 cost time: 5.581026554107666
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.720 Test Loss: 1.032 Test Acc: 0.720
Validation loss decreased (-0.719990 --> -0.719990).  Saving model ...
Epoch: 70 cost time: 5.962881326675415
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.720 Test Loss: 1.032 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 6.6690144538879395
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.720 Test Loss: 1.033 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 7.210791110992432
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.720 Test Loss: 1.034 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 7.226192474365234
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.717 Test Loss: 1.036 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 7.580999135971069
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.717 Test Loss: 1.037 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 6.430776119232178
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.720 Test Loss: 1.037 Test Acc: 0.720
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 6.812010049819946
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.720 Test Loss: 1.038 Test Acc: 0.720
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 6.275374174118042
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.723 Test Loss: 1.038 Test Acc: 0.723
Validation loss decreased (-0.719990 --> -0.723323).  Saving model ...
Epoch: 78 cost time: 6.740015268325806
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.720 Test Loss: 1.038 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 7.34991979598999
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.720 Test Loss: 1.038 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 6.854524612426758
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.717 Test Loss: 1.036 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 6.789371490478516
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.717 Test Loss: 1.038 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 6.292971134185791
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.717 Test Loss: 1.039 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 6.125992774963379
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.717 Test Loss: 1.039 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 6.178761720657349
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.717 Test Loss: 1.037 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 6.09450364112854
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.720 Test Loss: 1.037 Test Acc: 0.720
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 6.430745601654053
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.717 Test Loss: 1.035 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 6.485018491744995
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.727 Test Loss: 1.035 Test Acc: 0.727
Validation loss decreased (-0.723323 --> -0.726656).  Saving model ...
Epoch: 88 cost time: 6.673314332962036
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.727 Test Loss: 1.034 Test Acc: 0.727
Validation loss decreased (-0.726656 --> -0.726656).  Saving model ...
Epoch: 89 cost time: 6.397700786590576
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.727 Test Loss: 1.033 Test Acc: 0.727
Validation loss decreased (-0.726656 --> -0.726656).  Saving model ...
Epoch: 90 cost time: 6.09228515625
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.723 Test Loss: 1.032 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 6.406083106994629
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.723 Test Loss: 1.032 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 6.923636198043823
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.727 Test Loss: 1.031 Test Acc: 0.727
Validation loss decreased (-0.726656 --> -0.726656).  Saving model ...
Epoch: 93 cost time: 6.5256853103637695
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.730 Test Loss: 1.031 Test Acc: 0.730
Validation loss decreased (-0.726656 --> -0.729990).  Saving model ...
Epoch: 94 cost time: 6.456868648529053
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.730 Test Loss: 1.033 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 6.397108554840088
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.730 Test Loss: 1.032 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 6.8381757736206055
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.733 Test Loss: 1.031 Test Acc: 0.733
Validation loss decreased (-0.729990 --> -0.733323).  Saving model ...
Epoch: 97 cost time: 6.394427061080933
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.733 Test Loss: 1.031 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 98 cost time: 6.7109620571136475
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.733 Test Loss: 1.031 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 6.582990884780884
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.737 Test Loss: 1.032 Test Acc: 0.737
Validation loss decreased (-0.733323 --> -0.736656).  Saving model ...
Epoch: 100 cost time: 6.8323938846588135
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.737 Test Loss: 1.031 Test Acc: 0.737
Validation loss decreased (-0.736656 --> -0.736656).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7366666666666667
model parameter : 792345
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.5930280685424805
Epoch: 1, Steps: 18 | Train Loss: 3.249 Vali Loss: 3.153 Vali Acc: 0.077 Test Loss: 3.153 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 6.261632442474365
Epoch: 2, Steps: 18 | Train Loss: 2.946 Vali Loss: 2.946 Vali Acc: 0.250 Test Loss: 2.946 Test Acc: 0.250
Validation loss decreased (-0.076635 --> -0.249971).  Saving model ...
Epoch: 3 cost time: 5.682253122329712
Epoch: 3, Steps: 18 | Train Loss: 2.448 Vali Loss: 2.702 Vali Acc: 0.277 Test Loss: 2.702 Test Acc: 0.277
Validation loss decreased (-0.249971 --> -0.276640).  Saving model ...
Epoch: 4 cost time: 5.688742399215698
Epoch: 4, Steps: 18 | Train Loss: 1.870 Vali Loss: 2.451 Vali Acc: 0.400 Test Loss: 2.451 Test Acc: 0.400
Validation loss decreased (-0.276640 --> -0.399975).  Saving model ...
Epoch: 5 cost time: 5.700050592422485
Epoch: 5, Steps: 18 | Train Loss: 1.285 Vali Loss: 2.232 Vali Acc: 0.403 Test Loss: 2.232 Test Acc: 0.403
Validation loss decreased (-0.399975 --> -0.403311).  Saving model ...
Epoch: 6 cost time: 6.226535797119141
Epoch: 6, Steps: 18 | Train Loss: 0.782 Vali Loss: 2.041 Vali Acc: 0.443 Test Loss: 2.041 Test Acc: 0.443
Validation loss decreased (-0.403311 --> -0.443313).  Saving model ...
Epoch: 7 cost time: 6.327143907546997
Epoch: 7, Steps: 18 | Train Loss: 0.405 Vali Loss: 1.908 Vali Acc: 0.423 Test Loss: 1.908 Test Acc: 0.423
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.010586738586426
Epoch: 8, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.799 Vali Acc: 0.413 Test Loss: 1.799 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.133967161178589
Epoch: 9, Steps: 18 | Train Loss: 0.085 Vali Loss: 1.706 Vali Acc: 0.443 Test Loss: 1.706 Test Acc: 0.443
Validation loss decreased (-0.443313 --> -0.443316).  Saving model ...
Epoch: 10 cost time: 5.641128301620483
Epoch: 10, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.659 Vali Acc: 0.463 Test Loss: 1.659 Test Acc: 0.463
Validation loss decreased (-0.443316 --> -0.463317).  Saving model ...
Epoch: 11 cost time: 5.545984745025635
Epoch: 11, Steps: 18 | Train Loss: 0.031 Vali Loss: 1.623 Vali Acc: 0.500 Test Loss: 1.623 Test Acc: 0.500
Validation loss decreased (-0.463317 --> -0.499984).  Saving model ...
Epoch: 12 cost time: 5.771882057189941
Epoch: 12, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.596 Vali Acc: 0.487 Test Loss: 1.596 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.012126684188843
Epoch: 13, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.574 Vali Acc: 0.493 Test Loss: 1.574 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.286515235900879
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.543 Vali Acc: 0.503 Test Loss: 1.543 Test Acc: 0.503
Validation loss decreased (-0.499984 --> -0.503318).  Saving model ...
Epoch: 15 cost time: 6.173935890197754
Epoch: 15, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.516 Vali Acc: 0.523 Test Loss: 1.516 Test Acc: 0.523
Validation loss decreased (-0.503318 --> -0.523318).  Saving model ...
Epoch: 16 cost time: 6.152883052825928
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.503 Vali Acc: 0.530 Test Loss: 1.503 Test Acc: 0.530
Validation loss decreased (-0.523318 --> -0.529985).  Saving model ...
Epoch: 17 cost time: 6.195070505142212
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.491 Vali Acc: 0.533 Test Loss: 1.491 Test Acc: 0.533
Validation loss decreased (-0.529985 --> -0.533318).  Saving model ...
Epoch: 18 cost time: 5.720602750778198
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.478 Vali Acc: 0.553 Test Loss: 1.478 Test Acc: 0.553
Validation loss decreased (-0.533318 --> -0.553319).  Saving model ...
Epoch: 19 cost time: 5.596022367477417
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.462 Vali Acc: 0.560 Test Loss: 1.462 Test Acc: 0.560
Validation loss decreased (-0.553319 --> -0.559985).  Saving model ...
Epoch: 20 cost time: 5.719976425170898
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.449 Vali Acc: 0.550 Test Loss: 1.449 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.370638132095337
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.432 Vali Acc: 0.560 Test Loss: 1.432 Test Acc: 0.560
Validation loss decreased (-0.559985 --> -0.559986).  Saving model ...
Epoch: 22 cost time: 6.2369420528411865
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.422 Vali Acc: 0.553 Test Loss: 1.422 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.0471436977386475
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.413 Vali Acc: 0.573 Test Loss: 1.413 Test Acc: 0.573
Validation loss decreased (-0.559986 --> -0.573319).  Saving model ...
Epoch: 24 cost time: 6.211868047714233
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.409 Vali Acc: 0.570 Test Loss: 1.409 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.664545297622681
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.398 Vali Acc: 0.563 Test Loss: 1.398 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.144474983215332
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.391 Vali Acc: 0.563 Test Loss: 1.391 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.901272535324097
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.383 Vali Acc: 0.573 Test Loss: 1.383 Test Acc: 0.573
Validation loss decreased (-0.573319 --> -0.573320).  Saving model ...
Epoch: 28 cost time: 6.227293252944946
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.378 Vali Acc: 0.573 Test Loss: 1.378 Test Acc: 0.573
Validation loss decreased (-0.573320 --> -0.573320).  Saving model ...
Epoch: 29 cost time: 6.531461238861084
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.367 Vali Acc: 0.573 Test Loss: 1.367 Test Acc: 0.573
Validation loss decreased (-0.573320 --> -0.573320).  Saving model ...
Epoch: 30 cost time: 6.330163240432739
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.361 Vali Acc: 0.573 Test Loss: 1.361 Test Acc: 0.573
Validation loss decreased (-0.573320 --> -0.573320).  Saving model ...
Epoch: 31 cost time: 6.131708860397339
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.358 Vali Acc: 0.577 Test Loss: 1.358 Test Acc: 0.577
Validation loss decreased (-0.573320 --> -0.576653).  Saving model ...
Epoch: 32 cost time: 6.117624282836914
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.355 Vali Acc: 0.577 Test Loss: 1.355 Test Acc: 0.577
Validation loss decreased (-0.576653 --> -0.576653).  Saving model ...
Epoch: 33 cost time: 6.190836668014526
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.353 Vali Acc: 0.587 Test Loss: 1.353 Test Acc: 0.587
Validation loss decreased (-0.576653 --> -0.586653).  Saving model ...
Epoch: 34 cost time: 6.374385118484497
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.347 Vali Acc: 0.590 Test Loss: 1.347 Test Acc: 0.590
Validation loss decreased (-0.586653 --> -0.589987).  Saving model ...
Epoch: 35 cost time: 6.177704334259033
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.342 Vali Acc: 0.593 Test Loss: 1.342 Test Acc: 0.593
Validation loss decreased (-0.589987 --> -0.593320).  Saving model ...
Epoch: 36 cost time: 5.6605610847473145
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.335 Vali Acc: 0.587 Test Loss: 1.335 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.778905630111694
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.329 Vali Acc: 0.583 Test Loss: 1.329 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.5210347175598145
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.587 Test Loss: 1.323 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 5.741485118865967
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.322 Vali Acc: 0.587 Test Loss: 1.322 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 5.864521741867065
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.316 Vali Acc: 0.597 Test Loss: 1.316 Test Acc: 0.597
Validation loss decreased (-0.593320 --> -0.596654).  Saving model ...
Epoch: 41 cost time: 5.926743984222412
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.315 Vali Acc: 0.600 Test Loss: 1.315 Test Acc: 0.600
Validation loss decreased (-0.596654 --> -0.599987).  Saving model ...
Epoch: 42 cost time: 6.2692060470581055
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.310 Vali Acc: 0.597 Test Loss: 1.310 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.978116273880005
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.306 Vali Acc: 0.600 Test Loss: 1.306 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 44 cost time: 5.575377702713013
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.305 Vali Acc: 0.600 Test Loss: 1.305 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 45 cost time: 5.953480005264282
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.305 Vali Acc: 0.600 Test Loss: 1.305 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.707556247711182
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.302 Vali Acc: 0.600 Test Loss: 1.302 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 47 cost time: 6.265323877334595
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.298 Vali Acc: 0.600 Test Loss: 1.298 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 48 cost time: 6.406270503997803
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.295 Vali Acc: 0.610 Test Loss: 1.295 Test Acc: 0.610
Validation loss decreased (-0.599987 --> -0.609987).  Saving model ...
Epoch: 49 cost time: 6.101878881454468
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.293 Vali Acc: 0.613 Test Loss: 1.293 Test Acc: 0.613
Validation loss decreased (-0.609987 --> -0.613320).  Saving model ...
Epoch: 50 cost time: 6.018490791320801
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.289 Vali Acc: 0.607 Test Loss: 1.289 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.788983583450317
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.289 Vali Acc: 0.610 Test Loss: 1.289 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 5.672070503234863
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.613 Test Loss: 1.288 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 53 cost time: 5.627140998840332
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.289 Vali Acc: 0.600 Test Loss: 1.289 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.023082733154297
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.603 Test Loss: 1.288 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.50661563873291
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.287 Vali Acc: 0.607 Test Loss: 1.287 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 6.175218820571899
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.284 Vali Acc: 0.610 Test Loss: 1.284 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 6.259078025817871
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.283 Vali Acc: 0.613 Test Loss: 1.283 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613321).  Saving model ...
Epoch: 58 cost time: 5.826270580291748
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.282 Vali Acc: 0.610 Test Loss: 1.282 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 5.724636793136597
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.607 Test Loss: 1.281 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 5.961852788925171
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.279 Vali Acc: 0.610 Test Loss: 1.279 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 5.955018997192383
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.623 Test Loss: 1.276 Test Acc: 0.623
Validation loss decreased (-0.613321 --> -0.623321).  Saving model ...
Epoch: 62 cost time: 6.161584854125977
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.627 Test Loss: 1.274 Test Acc: 0.627
Validation loss decreased (-0.623321 --> -0.626654).  Saving model ...
Epoch: 63 cost time: 6.185401678085327
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.627 Test Loss: 1.274 Test Acc: 0.627
Validation loss decreased (-0.626654 --> -0.626654).  Saving model ...
Epoch: 64 cost time: 6.249435663223267
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.630 Test Loss: 1.275 Test Acc: 0.630
Validation loss decreased (-0.626654 --> -0.629987).  Saving model ...
Epoch: 65 cost time: 5.941936254501343
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.627 Test Loss: 1.275 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 6.040449380874634
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.272 Vali Acc: 0.633 Test Loss: 1.272 Test Acc: 0.633
Validation loss decreased (-0.629987 --> -0.633321).  Saving model ...
Epoch: 67 cost time: 6.444856405258179
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.272 Vali Acc: 0.633 Test Loss: 1.272 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633321).  Saving model ...
Epoch: 68 cost time: 6.395649433135986
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.270 Vali Acc: 0.630 Test Loss: 1.270 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.6140053272247314
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.637 Test Loss: 1.267 Test Acc: 0.637
Validation loss decreased (-0.633321 --> -0.636654).  Saving model ...
Epoch: 70 cost time: 6.420773506164551
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.640 Test Loss: 1.264 Test Acc: 0.640
Validation loss decreased (-0.636654 --> -0.639987).  Saving model ...
Epoch: 71 cost time: 6.486833572387695
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.643 Test Loss: 1.266 Test Acc: 0.643
Validation loss decreased (-0.639987 --> -0.643321).  Saving model ...
Epoch: 72 cost time: 6.5056281089782715
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.643 Test Loss: 1.265 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 73 cost time: 6.0169456005096436
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.640 Test Loss: 1.265 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 6.039604902267456
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.643 Test Loss: 1.264 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 75 cost time: 5.551903009414673
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.640 Test Loss: 1.262 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 6.356362342834473
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.640 Test Loss: 1.260 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 6.021672964096069
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.633 Test Loss: 1.260 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 6.050647974014282
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.633 Test Loss: 1.260 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 5.88272500038147
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.637 Test Loss: 1.258 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 6.112521409988403
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.633 Test Loss: 1.257 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 5.8849101066589355
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.630 Test Loss: 1.257 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 5.544277906417847
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.630 Test Loss: 1.256 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 6.410898447036743
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.643 Test Loss: 1.254 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 84 cost time: 6.196699380874634
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.637 Test Loss: 1.253 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 6.334529638290405
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.643 Test Loss: 1.252 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 86 cost time: 5.741304636001587
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.640 Test Loss: 1.252 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 5.469160079956055
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.643 Test Loss: 1.251 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 88 cost time: 5.699715852737427
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.643 Test Loss: 1.250 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 89 cost time: 5.690445184707642
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.637 Test Loss: 1.251 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 6.063756227493286
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.643 Test Loss: 1.247 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 91 cost time: 6.009697914123535
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.647 Test Loss: 1.246 Test Acc: 0.647
Validation loss decreased (-0.643321 --> -0.646654).  Saving model ...
Epoch: 92 cost time: 6.292100667953491
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.650 Test Loss: 1.246 Test Acc: 0.650
Validation loss decreased (-0.646654 --> -0.649988).  Saving model ...
Epoch: 93 cost time: 6.01214861869812
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.650 Test Loss: 1.246 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 5.752394676208496
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.650 Test Loss: 1.246 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 5.6776018142700195
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.647 Test Loss: 1.245 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 6.123438119888306
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.244 Vali Acc: 0.640 Test Loss: 1.244 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 6.1305811405181885
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.640 Test Loss: 1.242 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 6.060284614562988
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.647 Test Loss: 1.241 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 6.425014495849609
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.650 Test Loss: 1.241 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 100 cost time: 6.022385597229004
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.647 Test Loss: 1.239 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.65
model parameter : 792345
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.122615098953247
Epoch: 1, Steps: 18 | Train Loss: 3.249 Vali Loss: 3.172 Vali Acc: 0.087 Test Loss: 3.172 Test Acc: 0.087
Validation loss decreased (inf --> -0.086635).  Saving model ...
Epoch: 2 cost time: 5.711579084396362
Epoch: 2, Steps: 18 | Train Loss: 2.985 Vali Loss: 3.025 Vali Acc: 0.150 Test Loss: 3.025 Test Acc: 0.150
Validation loss decreased (-0.086635 --> -0.149970).  Saving model ...
Epoch: 3 cost time: 6.091123580932617
Epoch: 3, Steps: 18 | Train Loss: 2.567 Vali Loss: 2.855 Vali Acc: 0.227 Test Loss: 2.855 Test Acc: 0.227
Validation loss decreased (-0.149970 --> -0.226638).  Saving model ...
Epoch: 4 cost time: 6.098572492599487
Epoch: 4, Steps: 18 | Train Loss: 1.989 Vali Loss: 2.680 Vali Acc: 0.280 Test Loss: 2.680 Test Acc: 0.280
Validation loss decreased (-0.226638 --> -0.279973).  Saving model ...
Epoch: 5 cost time: 6.2329792976379395
Epoch: 5, Steps: 18 | Train Loss: 1.418 Vali Loss: 2.529 Vali Acc: 0.297 Test Loss: 2.529 Test Acc: 0.297
Validation loss decreased (-0.279973 --> -0.296641).  Saving model ...
Epoch: 6 cost time: 6.215583801269531
Epoch: 6, Steps: 18 | Train Loss: 0.920 Vali Loss: 2.396 Vali Acc: 0.327 Test Loss: 2.396 Test Acc: 0.327
Validation loss decreased (-0.296641 --> -0.326643).  Saving model ...
Epoch: 7 cost time: 5.729187250137329
Epoch: 7, Steps: 18 | Train Loss: 0.510 Vali Loss: 2.284 Vali Acc: 0.373 Test Loss: 2.284 Test Acc: 0.373
Validation loss decreased (-0.326643 --> -0.373310).  Saving model ...
Epoch: 8 cost time: 5.838511228561401
Epoch: 8, Steps: 18 | Train Loss: 0.250 Vali Loss: 2.184 Vali Acc: 0.357 Test Loss: 2.184 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.616105794906616
Epoch: 9, Steps: 18 | Train Loss: 0.109 Vali Loss: 2.104 Vali Acc: 0.363 Test Loss: 2.104 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.651071548461914
Epoch: 10, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.029 Vali Acc: 0.377 Test Loss: 2.029 Test Acc: 0.377
Validation loss decreased (-0.373310 --> -0.376646).  Saving model ...
Epoch: 11 cost time: 5.7930989265441895
Epoch: 11, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.987 Vali Acc: 0.393 Test Loss: 1.987 Test Acc: 0.393
Validation loss decreased (-0.376646 --> -0.393313).  Saving model ...
Epoch: 12 cost time: 5.797030210494995
Epoch: 12, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.936 Vali Acc: 0.390 Test Loss: 1.936 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.6586902141571045
Epoch: 13, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.911 Vali Acc: 0.413 Test Loss: 1.911 Test Acc: 0.413
Validation loss decreased (-0.393313 --> -0.413314).  Saving model ...
Epoch: 14 cost time: 5.460232973098755
Epoch: 14, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.875 Vali Acc: 0.413 Test Loss: 1.875 Test Acc: 0.413
Validation loss decreased (-0.413314 --> -0.413315).  Saving model ...
Epoch: 15 cost time: 5.511181831359863
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.840 Vali Acc: 0.423 Test Loss: 1.840 Test Acc: 0.423
Validation loss decreased (-0.413315 --> -0.423315).  Saving model ...
Epoch: 16 cost time: 5.621847629547119
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.810 Vali Acc: 0.447 Test Loss: 1.810 Test Acc: 0.447
Validation loss decreased (-0.423315 --> -0.446649).  Saving model ...
Epoch: 17 cost time: 5.881704330444336
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.779 Vali Acc: 0.463 Test Loss: 1.779 Test Acc: 0.463
Validation loss decreased (-0.446649 --> -0.463316).  Saving model ...
Epoch: 18 cost time: 6.036823987960815
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.770 Vali Acc: 0.460 Test Loss: 1.770 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.414630889892578
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.751 Vali Acc: 0.473 Test Loss: 1.751 Test Acc: 0.473
Validation loss decreased (-0.463316 --> -0.473316).  Saving model ...
Epoch: 20 cost time: 6.626910924911499
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.734 Vali Acc: 0.490 Test Loss: 1.734 Test Acc: 0.490
Validation loss decreased (-0.473316 --> -0.489983).  Saving model ...
Epoch: 21 cost time: 6.577564001083374
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.714 Vali Acc: 0.500 Test Loss: 1.714 Test Acc: 0.500
Validation loss decreased (-0.489983 --> -0.499983).  Saving model ...
Epoch: 22 cost time: 6.156532287597656
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.707 Vali Acc: 0.507 Test Loss: 1.707 Test Acc: 0.507
Validation loss decreased (-0.499983 --> -0.506650).  Saving model ...
Epoch: 23 cost time: 6.574579954147339
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.702 Vali Acc: 0.503 Test Loss: 1.702 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.393547773361206
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.687 Vali Acc: 0.510 Test Loss: 1.687 Test Acc: 0.510
Validation loss decreased (-0.506650 --> -0.509983).  Saving model ...
Epoch: 25 cost time: 6.886519432067871
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.676 Vali Acc: 0.507 Test Loss: 1.676 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.669910192489624
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.662 Vali Acc: 0.513 Test Loss: 1.662 Test Acc: 0.513
Validation loss decreased (-0.509983 --> -0.513317).  Saving model ...
Epoch: 27 cost time: 6.631942510604858
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.653 Vali Acc: 0.520 Test Loss: 1.653 Test Acc: 0.520
Validation loss decreased (-0.513317 --> -0.519983).  Saving model ...
Epoch: 28 cost time: 6.474218368530273
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.641 Vali Acc: 0.517 Test Loss: 1.641 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.412083148956299
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.631 Vali Acc: 0.523 Test Loss: 1.631 Test Acc: 0.523
Validation loss decreased (-0.519983 --> -0.523317).  Saving model ...
Epoch: 30 cost time: 6.003195524215698
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.625 Vali Acc: 0.523 Test Loss: 1.625 Test Acc: 0.523
Validation loss decreased (-0.523317 --> -0.523317).  Saving model ...
Epoch: 31 cost time: 6.1189751625061035
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.619 Vali Acc: 0.523 Test Loss: 1.619 Test Acc: 0.523
Validation loss decreased (-0.523317 --> -0.523317).  Saving model ...
Epoch: 32 cost time: 6.49024772644043
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.615 Vali Acc: 0.527 Test Loss: 1.615 Test Acc: 0.527
Validation loss decreased (-0.523317 --> -0.526651).  Saving model ...
Epoch: 33 cost time: 6.030738353729248
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.612 Vali Acc: 0.523 Test Loss: 1.612 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.5967698097229
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.598 Vali Acc: 0.527 Test Loss: 1.598 Test Acc: 0.527
Validation loss decreased (-0.526651 --> -0.526651).  Saving model ...
Epoch: 35 cost time: 6.651458024978638
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.595 Vali Acc: 0.537 Test Loss: 1.595 Test Acc: 0.537
Validation loss decreased (-0.526651 --> -0.536651).  Saving model ...
Epoch: 36 cost time: 6.1605775356292725
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.586 Vali Acc: 0.537 Test Loss: 1.586 Test Acc: 0.537
Validation loss decreased (-0.536651 --> -0.536651).  Saving model ...
Epoch: 37 cost time: 6.273340463638306
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.547 Test Loss: 1.576 Test Acc: 0.547
Validation loss decreased (-0.536651 --> -0.546651).  Saving model ...
Epoch: 38 cost time: 6.314012765884399
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.564 Vali Acc: 0.553 Test Loss: 1.564 Test Acc: 0.553
Validation loss decreased (-0.546651 --> -0.553318).  Saving model ...
Epoch: 39 cost time: 7.037143707275391
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.564 Vali Acc: 0.553 Test Loss: 1.564 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.597442626953125
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.561 Vali Acc: 0.547 Test Loss: 1.561 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.419988393783569
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.557 Vali Acc: 0.540 Test Loss: 1.557 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 6.170395135879517
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.547 Vali Acc: 0.557 Test Loss: 1.547 Test Acc: 0.557
Validation loss decreased (-0.553318 --> -0.556651).  Saving model ...
Epoch: 43 cost time: 5.964625120162964
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.542 Vali Acc: 0.557 Test Loss: 1.542 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 44 cost time: 6.45832633972168
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.537 Vali Acc: 0.557 Test Loss: 1.537 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 45 cost time: 6.166579961776733
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.536 Vali Acc: 0.563 Test Loss: 1.536 Test Acc: 0.563
Validation loss decreased (-0.556651 --> -0.563318).  Saving model ...
Epoch: 46 cost time: 6.373328924179077
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.570 Test Loss: 1.530 Test Acc: 0.570
Validation loss decreased (-0.563318 --> -0.569985).  Saving model ...
Epoch: 47 cost time: 6.4168701171875
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.525 Vali Acc: 0.573 Test Loss: 1.525 Test Acc: 0.573
Validation loss decreased (-0.569985 --> -0.573318).  Saving model ...
Epoch: 48 cost time: 6.821678638458252
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.520 Vali Acc: 0.570 Test Loss: 1.520 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.118789196014404
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.521 Vali Acc: 0.573 Test Loss: 1.521 Test Acc: 0.573
Validation loss decreased (-0.573318 --> -0.573318).  Saving model ...
Epoch: 50 cost time: 6.256369113922119
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.521 Vali Acc: 0.577 Test Loss: 1.521 Test Acc: 0.577
Validation loss decreased (-0.573318 --> -0.576651).  Saving model ...
Epoch: 51 cost time: 6.091341257095337
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.519 Vali Acc: 0.573 Test Loss: 1.519 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.9671313762664795
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.515 Vali Acc: 0.577 Test Loss: 1.515 Test Acc: 0.577
Validation loss decreased (-0.576651 --> -0.576652).  Saving model ...
Epoch: 53 cost time: 6.2696826457977295
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.512 Vali Acc: 0.577 Test Loss: 1.512 Test Acc: 0.577
Validation loss decreased (-0.576652 --> -0.576652).  Saving model ...
Epoch: 54 cost time: 6.728657007217407
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.512 Vali Acc: 0.580 Test Loss: 1.512 Test Acc: 0.580
Validation loss decreased (-0.576652 --> -0.579985).  Saving model ...
Epoch: 55 cost time: 6.623996734619141
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.508 Vali Acc: 0.580 Test Loss: 1.508 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 56 cost time: 6.476966142654419
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.503 Vali Acc: 0.580 Test Loss: 1.503 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 57 cost time: 6.1030144691467285
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.500 Vali Acc: 0.580 Test Loss: 1.500 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 58 cost time: 6.420166730880737
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.498 Vali Acc: 0.587 Test Loss: 1.498 Test Acc: 0.587
Validation loss decreased (-0.579985 --> -0.586652).  Saving model ...
Epoch: 59 cost time: 6.532100439071655
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.593 Test Loss: 1.499 Test Acc: 0.593
Validation loss decreased (-0.586652 --> -0.593318).  Saving model ...
Epoch: 60 cost time: 6.534370183944702
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.597 Test Loss: 1.492 Test Acc: 0.597
Validation loss decreased (-0.593318 --> -0.596652).  Saving model ...
Epoch: 61 cost time: 6.447838068008423
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.487 Vali Acc: 0.593 Test Loss: 1.487 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.66782021522522
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.593 Test Loss: 1.484 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 6.533339023590088
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.483 Vali Acc: 0.593 Test Loss: 1.483 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 6.433822393417358
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.590 Test Loss: 1.484 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 6.094512224197388
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.593 Test Loss: 1.482 Test Acc: 0.593
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 6.4907166957855225
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.590 Test Loss: 1.478 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 6.538197755813599
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.600 Test Loss: 1.476 Test Acc: 0.600
Validation loss decreased (-0.596652 --> -0.599985).  Saving model ...
Epoch: 68 cost time: 6.774014711380005
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.475 Vali Acc: 0.603 Test Loss: 1.475 Test Acc: 0.603
Validation loss decreased (-0.599985 --> -0.603319).  Saving model ...
Epoch: 69 cost time: 6.144673109054565
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.610 Test Loss: 1.473 Test Acc: 0.610
Validation loss decreased (-0.603319 --> -0.609985).  Saving model ...
Epoch: 70 cost time: 6.214202165603638
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.607 Test Loss: 1.471 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 6.364624977111816
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.613 Test Loss: 1.468 Test Acc: 0.613
Validation loss decreased (-0.609985 --> -0.613319).  Saving model ...
Epoch: 72 cost time: 6.1136085987091064
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.610 Test Loss: 1.470 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 6.721501588821411
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.610 Test Loss: 1.471 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 7.194760084152222
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.613 Test Loss: 1.466 Test Acc: 0.613
Validation loss decreased (-0.613319 --> -0.613319).  Saving model ...
Epoch: 75 cost time: 6.610216379165649
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.620 Test Loss: 1.463 Test Acc: 0.620
Validation loss decreased (-0.613319 --> -0.619985).  Saving model ...
Epoch: 76 cost time: 6.658235549926758
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.459 Vali Acc: 0.623 Test Loss: 1.459 Test Acc: 0.623
Validation loss decreased (-0.619985 --> -0.623319).  Saving model ...
Epoch: 77 cost time: 5.945526838302612
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.620 Test Loss: 1.456 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 6.3717896938323975
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.620 Test Loss: 1.453 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 6.2650158405303955
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.623 Test Loss: 1.453 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 80 cost time: 6.852999210357666
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.623 Test Loss: 1.452 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 81 cost time: 7.249565362930298
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.620 Test Loss: 1.451 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 6.67824125289917
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.623 Test Loss: 1.448 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 83 cost time: 6.484544515609741
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.630 Test Loss: 1.449 Test Acc: 0.630
Validation loss decreased (-0.623319 --> -0.629986).  Saving model ...
Epoch: 84 cost time: 6.65975022315979
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.630 Test Loss: 1.450 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 5.8138251304626465
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.630 Test Loss: 1.449 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 6.169584035873413
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.446 Vali Acc: 0.633 Test Loss: 1.446 Test Acc: 0.633
Validation loss decreased (-0.629986 --> -0.633319).  Saving model ...
Epoch: 87 cost time: 6.728470087051392
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.637 Test Loss: 1.442 Test Acc: 0.637
Validation loss decreased (-0.633319 --> -0.636652).  Saving model ...
Epoch: 88 cost time: 6.8249616622924805
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.633 Test Loss: 1.439 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 6.688272953033447
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.637 Test Loss: 1.436 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 90 cost time: 6.245083808898926
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.637 Test Loss: 1.436 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 91 cost time: 6.27324652671814
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.630 Test Loss: 1.433 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 5.82782244682312
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.630 Test Loss: 1.430 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 6.805133581161499
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.630 Test Loss: 1.431 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 6.984085559844971
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.630 Test Loss: 1.429 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 7.2814531326293945
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.633 Test Loss: 1.429 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 7.06170916557312
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.633 Test Loss: 1.425 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 6.198112726211548
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.637 Test Loss: 1.423 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 98 cost time: 6.402151346206665
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.637 Test Loss: 1.420 Test Acc: 0.637
Validation loss decreased (-0.636652 --> -0.636652).  Saving model ...
Epoch: 99 cost time: 6.408052206039429
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.643 Test Loss: 1.422 Test Acc: 0.643
Validation loss decreased (-0.636652 --> -0.643319).  Saving model ...
Epoch: 100 cost time: 6.8527984619140625
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.637 Test Loss: 1.423 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6433333333333333
model parameter : 792345
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.641250371932983
Epoch: 1, Steps: 18 | Train Loss: 3.282 Vali Loss: 3.220 Vali Acc: 0.043 Test Loss: 3.220 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 5.754437446594238
Epoch: 2, Steps: 18 | Train Loss: 3.013 Vali Loss: 3.133 Vali Acc: 0.080 Test Loss: 3.133 Test Acc: 0.080
Validation loss decreased (-0.043301 --> -0.079969).  Saving model ...
Epoch: 3 cost time: 5.4571146965026855
Epoch: 3, Steps: 18 | Train Loss: 2.613 Vali Loss: 3.030 Vali Acc: 0.107 Test Loss: 3.030 Test Acc: 0.107
Validation loss decreased (-0.079969 --> -0.106636).  Saving model ...
Epoch: 4 cost time: 5.61903190612793
Epoch: 4, Steps: 18 | Train Loss: 2.114 Vali Loss: 2.916 Vali Acc: 0.113 Test Loss: 2.916 Test Acc: 0.113
Validation loss decreased (-0.106636 --> -0.113304).  Saving model ...
Epoch: 5 cost time: 5.729578733444214
Epoch: 5, Steps: 18 | Train Loss: 1.545 Vali Loss: 2.855 Vali Acc: 0.117 Test Loss: 2.855 Test Acc: 0.117
Validation loss decreased (-0.113304 --> -0.116638).  Saving model ...
Epoch: 6 cost time: 5.60477352142334
Epoch: 6, Steps: 18 | Train Loss: 1.064 Vali Loss: 2.756 Vali Acc: 0.130 Test Loss: 2.756 Test Acc: 0.130
Validation loss decreased (-0.116638 --> -0.129972).  Saving model ...
Epoch: 7 cost time: 5.5543084144592285
Epoch: 7, Steps: 18 | Train Loss: 0.649 Vali Loss: 2.693 Vali Acc: 0.170 Test Loss: 2.693 Test Acc: 0.170
Validation loss decreased (-0.129972 --> -0.169973).  Saving model ...
Epoch: 8 cost time: 5.890671968460083
Epoch: 8, Steps: 18 | Train Loss: 0.324 Vali Loss: 2.604 Vali Acc: 0.197 Test Loss: 2.604 Test Acc: 0.197
Validation loss decreased (-0.169973 --> -0.196641).  Saving model ...
Epoch: 9 cost time: 5.6357481479644775
Epoch: 9, Steps: 18 | Train Loss: 0.163 Vali Loss: 2.570 Vali Acc: 0.203 Test Loss: 2.570 Test Acc: 0.203
Validation loss decreased (-0.196641 --> -0.203308).  Saving model ...
Epoch: 10 cost time: 6.134018182754517
Epoch: 10, Steps: 18 | Train Loss: 0.086 Vali Loss: 2.466 Vali Acc: 0.237 Test Loss: 2.466 Test Acc: 0.237
Validation loss decreased (-0.203308 --> -0.236642).  Saving model ...
Epoch: 11 cost time: 5.8740973472595215
Epoch: 11, Steps: 18 | Train Loss: 0.055 Vali Loss: 2.427 Vali Acc: 0.260 Test Loss: 2.427 Test Acc: 0.260
Validation loss decreased (-0.236642 --> -0.259976).  Saving model ...
Epoch: 12 cost time: 6.079675197601318
Epoch: 12, Steps: 18 | Train Loss: 0.037 Vali Loss: 2.339 Vali Acc: 0.270 Test Loss: 2.339 Test Acc: 0.270
Validation loss decreased (-0.259976 --> -0.269977).  Saving model ...
Epoch: 13 cost time: 6.191215991973877
Epoch: 13, Steps: 18 | Train Loss: 0.027 Vali Loss: 2.306 Vali Acc: 0.300 Test Loss: 2.306 Test Acc: 0.300
Validation loss decreased (-0.269977 --> -0.299977).  Saving model ...
Epoch: 14 cost time: 5.874888896942139
Epoch: 14, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.276 Vali Acc: 0.313 Test Loss: 2.276 Test Acc: 0.313
Validation loss decreased (-0.299977 --> -0.313311).  Saving model ...
Epoch: 15 cost time: 6.03341007232666
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.233 Vali Acc: 0.320 Test Loss: 2.233 Test Acc: 0.320
Validation loss decreased (-0.313311 --> -0.319978).  Saving model ...
Epoch: 16 cost time: 6.004154920578003
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 2.185 Vali Acc: 0.333 Test Loss: 2.185 Test Acc: 0.333
Validation loss decreased (-0.319978 --> -0.333311).  Saving model ...
Epoch: 17 cost time: 6.030242919921875
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.148 Vali Acc: 0.367 Test Loss: 2.148 Test Acc: 0.367
Validation loss decreased (-0.333311 --> -0.366645).  Saving model ...
Epoch: 18 cost time: 6.426146030426025
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.132 Vali Acc: 0.360 Test Loss: 2.132 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.299903154373169
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.101 Vali Acc: 0.373 Test Loss: 2.101 Test Acc: 0.373
Validation loss decreased (-0.366645 --> -0.373312).  Saving model ...
Epoch: 20 cost time: 6.352095365524292
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.081 Vali Acc: 0.383 Test Loss: 2.081 Test Acc: 0.383
Validation loss decreased (-0.373312 --> -0.383313).  Saving model ...
Epoch: 21 cost time: 5.699342250823975
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.050 Vali Acc: 0.387 Test Loss: 2.050 Test Acc: 0.387
Validation loss decreased (-0.383313 --> -0.386646).  Saving model ...
Epoch: 22 cost time: 5.441932678222656
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.025 Vali Acc: 0.403 Test Loss: 2.025 Test Acc: 0.403
Validation loss decreased (-0.386646 --> -0.403313).  Saving model ...
Epoch: 23 cost time: 5.742956876754761
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.007 Vali Acc: 0.413 Test Loss: 2.007 Test Acc: 0.413
Validation loss decreased (-0.403313 --> -0.413313).  Saving model ...
Epoch: 24 cost time: 5.670897006988525
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.990 Vali Acc: 0.417 Test Loss: 1.990 Test Acc: 0.417
Validation loss decreased (-0.413313 --> -0.416647).  Saving model ...
Epoch: 25 cost time: 6.188503742218018
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.999 Vali Acc: 0.413 Test Loss: 1.999 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.84504771232605
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.967 Vali Acc: 0.420 Test Loss: 1.967 Test Acc: 0.420
Validation loss decreased (-0.416647 --> -0.419980).  Saving model ...
Epoch: 27 cost time: 6.158125400543213
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.947 Vali Acc: 0.430 Test Loss: 1.947 Test Acc: 0.430
Validation loss decreased (-0.419980 --> -0.429981).  Saving model ...
Epoch: 28 cost time: 5.981279373168945
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.914 Vali Acc: 0.457 Test Loss: 1.914 Test Acc: 0.457
Validation loss decreased (-0.429981 --> -0.456648).  Saving model ...
Epoch: 29 cost time: 5.791597366333008
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.894 Vali Acc: 0.457 Test Loss: 1.894 Test Acc: 0.457
Validation loss decreased (-0.456648 --> -0.456648).  Saving model ...
Epoch: 30 cost time: 6.02315616607666
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.884 Vali Acc: 0.473 Test Loss: 1.884 Test Acc: 0.473
Validation loss decreased (-0.456648 --> -0.473314).  Saving model ...
Epoch: 31 cost time: 6.2120983600616455
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.882 Vali Acc: 0.460 Test Loss: 1.882 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.336122512817383
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.871 Vali Acc: 0.463 Test Loss: 1.871 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.63986611366272
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.862 Vali Acc: 0.473 Test Loss: 1.862 Test Acc: 0.473
Validation loss decreased (-0.473314 --> -0.473315).  Saving model ...
Epoch: 34 cost time: 6.345597743988037
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.853 Vali Acc: 0.477 Test Loss: 1.853 Test Acc: 0.477
Validation loss decreased (-0.473315 --> -0.476648).  Saving model ...
Epoch: 35 cost time: 6.356791734695435
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.853 Vali Acc: 0.477 Test Loss: 1.853 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.90986180305481
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.835 Vali Acc: 0.477 Test Loss: 1.835 Test Acc: 0.477
Validation loss decreased (-0.476648 --> -0.476648).  Saving model ...
Epoch: 37 cost time: 5.650530099868774
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.823 Vali Acc: 0.487 Test Loss: 1.823 Test Acc: 0.487
Validation loss decreased (-0.476648 --> -0.486648).  Saving model ...
Epoch: 38 cost time: 6.056621313095093
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.809 Vali Acc: 0.487 Test Loss: 1.809 Test Acc: 0.487
Validation loss decreased (-0.486648 --> -0.486649).  Saving model ...
Epoch: 39 cost time: 6.007766485214233
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.799 Vali Acc: 0.500 Test Loss: 1.799 Test Acc: 0.500
Validation loss decreased (-0.486649 --> -0.499982).  Saving model ...
Epoch: 40 cost time: 6.201973915100098
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.783 Vali Acc: 0.503 Test Loss: 1.783 Test Acc: 0.503
Validation loss decreased (-0.499982 --> -0.503316).  Saving model ...
Epoch: 41 cost time: 6.258587837219238
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.772 Vali Acc: 0.503 Test Loss: 1.772 Test Acc: 0.503
Validation loss decreased (-0.503316 --> -0.503316).  Saving model ...
Epoch: 42 cost time: 6.482234477996826
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.765 Vali Acc: 0.503 Test Loss: 1.765 Test Acc: 0.503
Validation loss decreased (-0.503316 --> -0.503316).  Saving model ...
Epoch: 43 cost time: 6.241992712020874
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.757 Vali Acc: 0.503 Test Loss: 1.757 Test Acc: 0.503
Validation loss decreased (-0.503316 --> -0.503316).  Saving model ...
Epoch: 44 cost time: 6.219867467880249
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.750 Vali Acc: 0.510 Test Loss: 1.750 Test Acc: 0.510
Validation loss decreased (-0.503316 --> -0.509982).  Saving model ...
Epoch: 45 cost time: 6.377384424209595
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.731 Vali Acc: 0.513 Test Loss: 1.731 Test Acc: 0.513
Validation loss decreased (-0.509982 --> -0.513316).  Saving model ...
Epoch: 46 cost time: 6.411423444747925
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.517 Test Loss: 1.723 Test Acc: 0.517
Validation loss decreased (-0.513316 --> -0.516649).  Saving model ...
Epoch: 47 cost time: 6.511209011077881
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.718 Vali Acc: 0.517 Test Loss: 1.718 Test Acc: 0.517
Validation loss decreased (-0.516649 --> -0.516649).  Saving model ...
Epoch: 48 cost time: 7.113581657409668
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.714 Vali Acc: 0.527 Test Loss: 1.714 Test Acc: 0.527
Validation loss decreased (-0.516649 --> -0.526650).  Saving model ...
Epoch: 49 cost time: 6.7284767627716064
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.708 Vali Acc: 0.533 Test Loss: 1.708 Test Acc: 0.533
Validation loss decreased (-0.526650 --> -0.533316).  Saving model ...
Epoch: 50 cost time: 6.610381364822388
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.537 Test Loss: 1.698 Test Acc: 0.537
Validation loss decreased (-0.533316 --> -0.536650).  Saving model ...
Epoch: 51 cost time: 6.12024998664856
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.691 Vali Acc: 0.530 Test Loss: 1.691 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.043171405792236
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.527 Test Loss: 1.689 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.033278465270996
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.687 Vali Acc: 0.533 Test Loss: 1.687 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 6.486618995666504
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.693 Vali Acc: 0.523 Test Loss: 1.693 Test Acc: 0.523
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 6.622094631195068
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.527 Test Loss: 1.698 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 6.795343637466431
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.692 Vali Acc: 0.533 Test Loss: 1.692 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 6.712517738342285
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.686 Vali Acc: 0.537 Test Loss: 1.686 Test Acc: 0.537
Validation loss decreased (-0.536650 --> -0.536650).  Saving model ...
Epoch: 58 cost time: 6.240431785583496
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.673 Vali Acc: 0.540 Test Loss: 1.673 Test Acc: 0.540
Validation loss decreased (-0.536650 --> -0.539983).  Saving model ...
Epoch: 59 cost time: 6.230236530303955
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.673 Vali Acc: 0.547 Test Loss: 1.673 Test Acc: 0.547
Validation loss decreased (-0.539983 --> -0.546650).  Saving model ...
Epoch: 60 cost time: 6.121515512466431
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.666 Vali Acc: 0.547 Test Loss: 1.666 Test Acc: 0.547
Validation loss decreased (-0.546650 --> -0.546650).  Saving model ...
Epoch: 61 cost time: 7.248066663742065
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.659 Vali Acc: 0.557 Test Loss: 1.659 Test Acc: 0.557
Validation loss decreased (-0.546650 --> -0.556650).  Saving model ...
Epoch: 62 cost time: 6.45109486579895
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.656 Vali Acc: 0.557 Test Loss: 1.656 Test Acc: 0.557
Validation loss decreased (-0.556650 --> -0.556650).  Saving model ...
Epoch: 63 cost time: 6.375159502029419
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.652 Vali Acc: 0.557 Test Loss: 1.652 Test Acc: 0.557
Validation loss decreased (-0.556650 --> -0.556650).  Saving model ...
Epoch: 64 cost time: 6.027066707611084
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.557 Test Loss: 1.645 Test Acc: 0.557
Validation loss decreased (-0.556650 --> -0.556650).  Saving model ...
Epoch: 65 cost time: 5.820720195770264
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.642 Vali Acc: 0.560 Test Loss: 1.642 Test Acc: 0.560
Validation loss decreased (-0.556650 --> -0.559984).  Saving model ...
Epoch: 66 cost time: 5.807946681976318
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.557 Test Loss: 1.643 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 6.054769992828369
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.642 Vali Acc: 0.560 Test Loss: 1.642 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 6.541481256484985
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.638 Vali Acc: 0.557 Test Loss: 1.638 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 6.627788305282593
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.557 Test Loss: 1.639 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 6.796537160873413
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.560 Test Loss: 1.639 Test Acc: 0.560
Validation loss decreased (-0.559984 --> -0.559984).  Saving model ...
Epoch: 71 cost time: 6.62346887588501
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.632 Vali Acc: 0.560 Test Loss: 1.632 Test Acc: 0.560
Validation loss decreased (-0.559984 --> -0.559984).  Saving model ...
Epoch: 72 cost time: 6.2005720138549805
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.632 Vali Acc: 0.560 Test Loss: 1.632 Test Acc: 0.560
Validation loss decreased (-0.559984 --> -0.559984).  Saving model ...
Epoch: 73 cost time: 6.286198616027832
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.560 Test Loss: 1.630 Test Acc: 0.560
Validation loss decreased (-0.559984 --> -0.559984).  Saving model ...
Epoch: 74 cost time: 6.489879846572876
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.563 Test Loss: 1.630 Test Acc: 0.563
Validation loss decreased (-0.559984 --> -0.563317).  Saving model ...
Epoch: 75 cost time: 6.752392053604126
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.570 Test Loss: 1.627 Test Acc: 0.570
Validation loss decreased (-0.563317 --> -0.569984).  Saving model ...
Epoch: 76 cost time: 6.58837628364563
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.622 Vali Acc: 0.573 Test Loss: 1.622 Test Acc: 0.573
Validation loss decreased (-0.569984 --> -0.573317).  Saving model ...
Epoch: 77 cost time: 6.414166688919067
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.573 Test Loss: 1.618 Test Acc: 0.573
Validation loss decreased (-0.573317 --> -0.573317).  Saving model ...
Epoch: 78 cost time: 6.09344744682312
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.573 Test Loss: 1.611 Test Acc: 0.573
Validation loss decreased (-0.573317 --> -0.573317).  Saving model ...
Epoch: 79 cost time: 6.080557107925415
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.573 Test Loss: 1.604 Test Acc: 0.573
Validation loss decreased (-0.573317 --> -0.573317).  Saving model ...
Epoch: 80 cost time: 6.240455865859985
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.599 Vali Acc: 0.577 Test Loss: 1.599 Test Acc: 0.577
Validation loss decreased (-0.573317 --> -0.576651).  Saving model ...
Epoch: 81 cost time: 6.037230014801025
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.598 Vali Acc: 0.573 Test Loss: 1.598 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 6.50775671005249
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.577 Test Loss: 1.596 Test Acc: 0.577
Validation loss decreased (-0.576651 --> -0.576651).  Saving model ...
Epoch: 83 cost time: 6.6276538372039795
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.595 Vali Acc: 0.577 Test Loss: 1.595 Test Acc: 0.577
Validation loss decreased (-0.576651 --> -0.576651).  Saving model ...
Epoch: 84 cost time: 6.525196313858032
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.593 Vali Acc: 0.580 Test Loss: 1.593 Test Acc: 0.580
Validation loss decreased (-0.576651 --> -0.579984).  Saving model ...
Epoch: 85 cost time: 6.412037372589111
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.587 Test Loss: 1.591 Test Acc: 0.587
Validation loss decreased (-0.579984 --> -0.586651).  Saving model ...
Epoch: 86 cost time: 6.35300350189209
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.590 Test Loss: 1.587 Test Acc: 0.590
Validation loss decreased (-0.586651 --> -0.589984).  Saving model ...
Epoch: 87 cost time: 6.1365320682525635
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.593 Test Loss: 1.582 Test Acc: 0.593
Validation loss decreased (-0.589984 --> -0.593318).  Saving model ...
Epoch: 88 cost time: 5.964003086090088
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.600 Test Loss: 1.580 Test Acc: 0.600
Validation loss decreased (-0.593318 --> -0.599984).  Saving model ...
Epoch: 89 cost time: 6.567335367202759
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.597 Test Loss: 1.580 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 6.42997145652771
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.597 Test Loss: 1.579 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 6.389128684997559
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.593 Test Loss: 1.580 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 6.078407526016235
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.577 Vali Acc: 0.597 Test Loss: 1.577 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 5.552964448928833
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.593 Test Loss: 1.574 Test Acc: 0.593
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 5.523749589920044
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.593 Test Loss: 1.572 Test Acc: 0.593
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 5.512361526489258
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.568 Vali Acc: 0.597 Test Loss: 1.568 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 5.880258321762085
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.568 Vali Acc: 0.597 Test Loss: 1.568 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 6.16060733795166
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.603 Test Loss: 1.567 Test Acc: 0.603
Validation loss decreased (-0.599984 --> -0.603318).  Saving model ...
Epoch: 98 cost time: 6.015744209289551
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.600 Test Loss: 1.566 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 6.272073984146118
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.563 Vali Acc: 0.600 Test Loss: 1.563 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 5.736701488494873
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.565 Vali Acc: 0.600 Test Loss: 1.565 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6033333333333334
model parameter : 792345
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.434324741363525
Epoch: 1, Steps: 18 | Train Loss: 3.308 Vali Loss: 3.257 Vali Acc: 0.043 Test Loss: 3.257 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 6.054122447967529
Epoch: 2, Steps: 18 | Train Loss: 3.062 Vali Loss: 3.175 Vali Acc: 0.067 Test Loss: 3.175 Test Acc: 0.067
Validation loss decreased (-0.043301 --> -0.066635).  Saving model ...
Epoch: 3 cost time: 6.223348140716553
Epoch: 3, Steps: 18 | Train Loss: 2.727 Vali Loss: 3.076 Vali Acc: 0.110 Test Loss: 3.076 Test Acc: 0.110
Validation loss decreased (-0.066635 --> -0.109969).  Saving model ...
Epoch: 4 cost time: 6.093433618545532
Epoch: 4, Steps: 18 | Train Loss: 2.284 Vali Loss: 2.976 Vali Acc: 0.147 Test Loss: 2.976 Test Acc: 0.147
Validation loss decreased (-0.109969 --> -0.146637).  Saving model ...
Epoch: 5 cost time: 6.106518983840942
Epoch: 5, Steps: 18 | Train Loss: 1.763 Vali Loss: 2.908 Vali Acc: 0.157 Test Loss: 2.908 Test Acc: 0.157
Validation loss decreased (-0.146637 --> -0.156638).  Saving model ...
Epoch: 6 cost time: 5.645213842391968
Epoch: 6, Steps: 18 | Train Loss: 1.347 Vali Loss: 2.790 Vali Acc: 0.193 Test Loss: 2.790 Test Acc: 0.193
Validation loss decreased (-0.156638 --> -0.193305).  Saving model ...
Epoch: 7 cost time: 5.6434338092803955
Epoch: 7, Steps: 18 | Train Loss: 0.861 Vali Loss: 2.697 Vali Acc: 0.187 Test Loss: 2.697 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.084052324295044
Epoch: 8, Steps: 18 | Train Loss: 0.536 Vali Loss: 2.582 Vali Acc: 0.217 Test Loss: 2.582 Test Acc: 0.217
Validation loss decreased (-0.193305 --> -0.216641).  Saving model ...
Epoch: 9 cost time: 5.791914463043213
Epoch: 9, Steps: 18 | Train Loss: 0.319 Vali Loss: 2.513 Vali Acc: 0.253 Test Loss: 2.513 Test Acc: 0.253
Validation loss decreased (-0.216641 --> -0.253308).  Saving model ...
Epoch: 10 cost time: 6.218533277511597
Epoch: 10, Steps: 18 | Train Loss: 0.159 Vali Loss: 2.319 Vali Acc: 0.297 Test Loss: 2.319 Test Acc: 0.297
Validation loss decreased (-0.253308 --> -0.296643).  Saving model ...
Epoch: 11 cost time: 6.195797681808472
Epoch: 11, Steps: 18 | Train Loss: 0.088 Vali Loss: 2.237 Vali Acc: 0.313 Test Loss: 2.237 Test Acc: 0.313
Validation loss decreased (-0.296643 --> -0.313311).  Saving model ...
Epoch: 12 cost time: 6.107332468032837
Epoch: 12, Steps: 18 | Train Loss: 0.061 Vali Loss: 2.095 Vali Acc: 0.363 Test Loss: 2.095 Test Acc: 0.363
Validation loss decreased (-0.313311 --> -0.363312).  Saving model ...
Epoch: 13 cost time: 6.010828256607056
Epoch: 13, Steps: 18 | Train Loss: 0.039 Vali Loss: 2.145 Vali Acc: 0.357 Test Loss: 2.145 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.35134482383728
Epoch: 14, Steps: 18 | Train Loss: 0.031 Vali Loss: 2.079 Vali Acc: 0.367 Test Loss: 2.079 Test Acc: 0.367
Validation loss decreased (-0.363312 --> -0.366646).  Saving model ...
Epoch: 15 cost time: 6.4384379386901855
Epoch: 15, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.982 Vali Acc: 0.390 Test Loss: 1.982 Test Acc: 0.390
Validation loss decreased (-0.366646 --> -0.389980).  Saving model ...
Epoch: 16 cost time: 6.612753868103027
Epoch: 16, Steps: 18 | Train Loss: 0.018 Vali Loss: 2.011 Vali Acc: 0.380 Test Loss: 2.011 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.629049777984619
Epoch: 17, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.951 Vali Acc: 0.407 Test Loss: 1.951 Test Acc: 0.407
Validation loss decreased (-0.389980 --> -0.406647).  Saving model ...
Epoch: 18 cost time: 6.398293733596802
Epoch: 18, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.896 Vali Acc: 0.430 Test Loss: 1.896 Test Acc: 0.430
Validation loss decreased (-0.406647 --> -0.429981).  Saving model ...
Epoch: 19 cost time: 6.6646623611450195
Epoch: 19, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.908 Vali Acc: 0.427 Test Loss: 1.908 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.321329116821289
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.874 Vali Acc: 0.443 Test Loss: 1.874 Test Acc: 0.443
Validation loss decreased (-0.429981 --> -0.443315).  Saving model ...
Epoch: 21 cost time: 5.94662070274353
Epoch: 21, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.827 Vali Acc: 0.440 Test Loss: 1.827 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.721583843231201
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.806 Vali Acc: 0.433 Test Loss: 1.806 Test Acc: 0.433
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.852876663208008
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.841 Vali Acc: 0.443 Test Loss: 1.841 Test Acc: 0.443
Validation loss decreased (-0.443315 --> -0.443315).  Saving model ...
Epoch: 24 cost time: 6.444722414016724
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.820 Vali Acc: 0.447 Test Loss: 1.820 Test Acc: 0.447
Validation loss decreased (-0.443315 --> -0.446648).  Saving model ...
Epoch: 25 cost time: 6.353952407836914
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.816 Vali Acc: 0.460 Test Loss: 1.816 Test Acc: 0.460
Validation loss decreased (-0.446648 --> -0.459982).  Saving model ...
Epoch: 26 cost time: 6.42987060546875
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.795 Vali Acc: 0.463 Test Loss: 1.795 Test Acc: 0.463
Validation loss decreased (-0.459982 --> -0.463315).  Saving model ...
Epoch: 27 cost time: 6.975950241088867
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.779 Vali Acc: 0.463 Test Loss: 1.779 Test Acc: 0.463
Validation loss decreased (-0.463315 --> -0.463316).  Saving model ...
Epoch: 28 cost time: 6.379585266113281
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.742 Vali Acc: 0.480 Test Loss: 1.742 Test Acc: 0.480
Validation loss decreased (-0.463316 --> -0.479983).  Saving model ...
Epoch: 29 cost time: 6.521929979324341
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.754 Vali Acc: 0.477 Test Loss: 1.754 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.338506460189819
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.749 Vali Acc: 0.490 Test Loss: 1.749 Test Acc: 0.490
Validation loss decreased (-0.479983 --> -0.489983).  Saving model ...
Epoch: 31 cost time: 6.628514289855957
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.751 Vali Acc: 0.477 Test Loss: 1.751 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.4710469245910645
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.732 Vali Acc: 0.497 Test Loss: 1.732 Test Acc: 0.497
Validation loss decreased (-0.489983 --> -0.496649).  Saving model ...
Epoch: 33 cost time: 6.591460466384888
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.738 Vali Acc: 0.490 Test Loss: 1.738 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.25185489654541
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.753 Vali Acc: 0.487 Test Loss: 1.753 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 7.147472143173218
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.740 Vali Acc: 0.500 Test Loss: 1.740 Test Acc: 0.500
Validation loss decreased (-0.496649 --> -0.499983).  Saving model ...
Epoch: 36 cost time: 6.588283061981201
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.719 Vali Acc: 0.500 Test Loss: 1.719 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499983).  Saving model ...
Epoch: 37 cost time: 6.846497535705566
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.698 Vali Acc: 0.500 Test Loss: 1.698 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499983).  Saving model ...
Epoch: 38 cost time: 6.0145721435546875
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.688 Vali Acc: 0.510 Test Loss: 1.688 Test Acc: 0.510
Validation loss decreased (-0.499983 --> -0.509983).  Saving model ...
Epoch: 39 cost time: 6.408166408538818
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.682 Vali Acc: 0.517 Test Loss: 1.682 Test Acc: 0.517
Validation loss decreased (-0.509983 --> -0.516650).  Saving model ...
Epoch: 40 cost time: 5.9920313358306885
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.686 Vali Acc: 0.503 Test Loss: 1.686 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.017265796661377
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.690 Vali Acc: 0.503 Test Loss: 1.690 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.554688930511475
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.680 Vali Acc: 0.510 Test Loss: 1.680 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.487107753753662
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.674 Vali Acc: 0.503 Test Loss: 1.674 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.264185667037964
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.672 Vali Acc: 0.513 Test Loss: 1.672 Test Acc: 0.513
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 6.511419773101807
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.666 Vali Acc: 0.527 Test Loss: 1.666 Test Acc: 0.527
Validation loss decreased (-0.516650 --> -0.526650).  Saving model ...
Epoch: 46 cost time: 5.782840251922607
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.660 Vali Acc: 0.517 Test Loss: 1.660 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.002882957458496
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.656 Vali Acc: 0.530 Test Loss: 1.656 Test Acc: 0.530
Validation loss decreased (-0.526650 --> -0.529983).  Saving model ...
Epoch: 48 cost time: 5.825412750244141
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.647 Vali Acc: 0.523 Test Loss: 1.647 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.400026321411133
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.642 Vali Acc: 0.520 Test Loss: 1.642 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 6.149509429931641
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.637 Vali Acc: 0.520 Test Loss: 1.637 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.346250534057617
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.537 Test Loss: 1.630 Test Acc: 0.537
Validation loss decreased (-0.529983 --> -0.536650).  Saving model ...
Epoch: 52 cost time: 6.203123569488525
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.537 Test Loss: 1.630 Test Acc: 0.537
Validation loss decreased (-0.536650 --> -0.536650).  Saving model ...
Epoch: 53 cost time: 6.31334114074707
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.636 Vali Acc: 0.537 Test Loss: 1.636 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.5587382316589355
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.628 Vali Acc: 0.533 Test Loss: 1.628 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.465738773345947
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.626 Vali Acc: 0.533 Test Loss: 1.626 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 6.76372218132019
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.627 Vali Acc: 0.537 Test Loss: 1.627 Test Acc: 0.537
Validation loss decreased (-0.536650 --> -0.536650).  Saving model ...
Epoch: 57 cost time: 6.404371976852417
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.616 Vali Acc: 0.537 Test Loss: 1.616 Test Acc: 0.537
Validation loss decreased (-0.536650 --> -0.536651).  Saving model ...
Epoch: 58 cost time: 6.490393877029419
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.618 Vali Acc: 0.547 Test Loss: 1.618 Test Acc: 0.547
Validation loss decreased (-0.536651 --> -0.546650).  Saving model ...
Epoch: 59 cost time: 6.1577699184417725
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.623 Vali Acc: 0.543 Test Loss: 1.623 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 6.214688539505005
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.627 Vali Acc: 0.540 Test Loss: 1.627 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 6.231504917144775
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.631 Vali Acc: 0.537 Test Loss: 1.631 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 6.580826044082642
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.623 Vali Acc: 0.543 Test Loss: 1.623 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 6.533881902694702
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.615 Vali Acc: 0.543 Test Loss: 1.615 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 6.983842849731445
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.608 Vali Acc: 0.540 Test Loss: 1.608 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 7.14674711227417
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.550 Test Loss: 1.606 Test Acc: 0.550
Validation loss decreased (-0.546650 --> -0.549984).  Saving model ...
Epoch: 66 cost time: 6.290569305419922
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.547 Test Loss: 1.606 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 6.522752523422241
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.624 Vali Acc: 0.537 Test Loss: 1.624 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 6.25102686882019
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.537 Test Loss: 1.626 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 6.721222639083862
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.540 Test Loss: 1.618 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 6.616581678390503
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.617 Vali Acc: 0.540 Test Loss: 1.617 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 6.775885105133057
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.543 Test Loss: 1.617 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 6.731932163238525
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.543 Test Loss: 1.612 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 6.734454870223999
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.547 Test Loss: 1.609 Test Acc: 0.547
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 6.119269371032715
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.557 Test Loss: 1.602 Test Acc: 0.557
Validation loss decreased (-0.549984 --> -0.556651).  Saving model ...
Epoch: 75 cost time: 6.607170581817627
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.557 Test Loss: 1.587 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 76 cost time: 6.542747735977173
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.553 Test Loss: 1.581 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 6.933410882949829
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.553 Test Loss: 1.576 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 6.47028374671936
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.577 Vali Acc: 0.550 Test Loss: 1.577 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 6.208035945892334
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.553 Test Loss: 1.574 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 6.88357949256897
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.553 Test Loss: 1.575 Test Acc: 0.553
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 6.528022527694702
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.553 Test Loss: 1.576 Test Acc: 0.553
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 6.496867418289185
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.557 Test Loss: 1.579 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 83 cost time: 6.860166788101196
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.557 Test Loss: 1.578 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 84 cost time: 6.72747540473938
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.577 Vali Acc: 0.560 Test Loss: 1.577 Test Acc: 0.560
Validation loss decreased (-0.556651 --> -0.559984).  Saving model ...
Epoch: 85 cost time: 7.217097759246826
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.560 Test Loss: 1.576 Test Acc: 0.560
Validation loss decreased (-0.559984 --> -0.559984).  Saving model ...
Epoch: 86 cost time: 7.446653366088867
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.567 Test Loss: 1.572 Test Acc: 0.567
Validation loss decreased (-0.559984 --> -0.566651).  Saving model ...
Epoch: 87 cost time: 6.902874231338501
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.565 Vali Acc: 0.567 Test Loss: 1.565 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 88 cost time: 6.986451864242554
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.565 Vali Acc: 0.573 Test Loss: 1.565 Test Acc: 0.573
Validation loss decreased (-0.566651 --> -0.573318).  Saving model ...
Epoch: 89 cost time: 6.6976258754730225
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.577 Test Loss: 1.567 Test Acc: 0.577
Validation loss decreased (-0.573318 --> -0.576651).  Saving model ...
Epoch: 90 cost time: 6.759302616119385
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.577 Test Loss: 1.567 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 6.710940361022949
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.570 Test Loss: 1.566 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 6.9883599281311035
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.570 Test Loss: 1.573 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 6.081948280334473
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.577 Vali Acc: 0.570 Test Loss: 1.577 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 6.3692591190338135
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.577 Test Loss: 1.575 Test Acc: 0.577
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 6.134867906570435
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.570 Test Loss: 1.579 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 6.679138422012329
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.567 Test Loss: 1.575 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 6.674482822418213
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.570 Vali Acc: 0.580 Test Loss: 1.570 Test Acc: 0.580
Validation loss decreased (-0.576651 --> -0.579984).  Saving model ...
Epoch: 98 cost time: 7.006078720092773
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.573 Test Loss: 1.569 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 6.320152759552002
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.564 Vali Acc: 0.577 Test Loss: 1.564 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 6.537785768508911
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.580 Test Loss: 1.562 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579984).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.58
model parameter : 792345
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.263691425323486
Epoch: 1, Steps: 18 | Train Loss: 3.275 Vali Loss: 3.275 Vali Acc: 0.050 Test Loss: 3.275 Test Acc: 0.050
Validation loss decreased (inf --> -0.049967).  Saving model ...
Epoch: 2 cost time: 6.239709138870239
Epoch: 2, Steps: 18 | Train Loss: 3.066 Vali Loss: 3.202 Vali Acc: 0.057 Test Loss: 3.202 Test Acc: 0.057
Validation loss decreased (-0.049967 --> -0.056635).  Saving model ...
Epoch: 3 cost time: 6.757564544677734
Epoch: 3, Steps: 18 | Train Loss: 2.738 Vali Loss: 3.118 Vali Acc: 0.090 Test Loss: 3.118 Test Acc: 0.090
Validation loss decreased (-0.056635 --> -0.089969).  Saving model ...
Epoch: 4 cost time: 6.523474216461182
Epoch: 4, Steps: 18 | Train Loss: 2.304 Vali Loss: 3.020 Vali Acc: 0.123 Test Loss: 3.020 Test Acc: 0.123
Validation loss decreased (-0.089969 --> -0.123303).  Saving model ...
Epoch: 5 cost time: 5.708512783050537
Epoch: 5, Steps: 18 | Train Loss: 1.825 Vali Loss: 2.958 Vali Acc: 0.120 Test Loss: 2.958 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.170973300933838
Epoch: 6, Steps: 18 | Train Loss: 1.370 Vali Loss: 2.851 Vali Acc: 0.133 Test Loss: 2.851 Test Acc: 0.133
Validation loss decreased (-0.123303 --> -0.133305).  Saving model ...
Epoch: 7 cost time: 6.003780364990234
Epoch: 7, Steps: 18 | Train Loss: 0.879 Vali Loss: 2.753 Vali Acc: 0.170 Test Loss: 2.753 Test Acc: 0.170
Validation loss decreased (-0.133305 --> -0.169972).  Saving model ...
Epoch: 8 cost time: 5.910282611846924
Epoch: 8, Steps: 18 | Train Loss: 0.549 Vali Loss: 2.624 Vali Acc: 0.193 Test Loss: 2.624 Test Acc: 0.193
Validation loss decreased (-0.169972 --> -0.193307).  Saving model ...
Epoch: 9 cost time: 6.126718521118164
Epoch: 9, Steps: 18 | Train Loss: 0.312 Vali Loss: 2.480 Vali Acc: 0.253 Test Loss: 2.480 Test Acc: 0.253
Validation loss decreased (-0.193307 --> -0.253309).  Saving model ...
Epoch: 10 cost time: 6.225682497024536
Epoch: 10, Steps: 18 | Train Loss: 0.157 Vali Loss: 2.313 Vali Acc: 0.263 Test Loss: 2.313 Test Acc: 0.263
Validation loss decreased (-0.253309 --> -0.263310).  Saving model ...
Epoch: 11 cost time: 6.486572265625
Epoch: 11, Steps: 18 | Train Loss: 0.081 Vali Loss: 2.192 Vali Acc: 0.310 Test Loss: 2.192 Test Acc: 0.310
Validation loss decreased (-0.263310 --> -0.309978).  Saving model ...
Epoch: 12 cost time: 6.084272623062134
Epoch: 12, Steps: 18 | Train Loss: 0.054 Vali Loss: 2.059 Vali Acc: 0.367 Test Loss: 2.059 Test Acc: 0.367
Validation loss decreased (-0.309978 --> -0.366646).  Saving model ...
Epoch: 13 cost time: 6.149378061294556
Epoch: 13, Steps: 18 | Train Loss: 0.036 Vali Loss: 2.037 Vali Acc: 0.360 Test Loss: 2.037 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.217709541320801
Epoch: 14, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.977 Vali Acc: 0.377 Test Loss: 1.977 Test Acc: 0.377
Validation loss decreased (-0.366646 --> -0.376647).  Saving model ...
Epoch: 15 cost time: 6.52220892906189
Epoch: 15, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.899 Vali Acc: 0.407 Test Loss: 1.899 Test Acc: 0.407
Validation loss decreased (-0.376647 --> -0.406648).  Saving model ...
Epoch: 16 cost time: 6.377188444137573
Epoch: 16, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.889 Vali Acc: 0.383 Test Loss: 1.889 Test Acc: 0.383
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.256292819976807
Epoch: 17, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.841 Vali Acc: 0.437 Test Loss: 1.841 Test Acc: 0.437
Validation loss decreased (-0.406648 --> -0.436648).  Saving model ...
Epoch: 18 cost time: 6.184207201004028
Epoch: 18, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.793 Vali Acc: 0.453 Test Loss: 1.793 Test Acc: 0.453
Validation loss decreased (-0.436648 --> -0.453315).  Saving model ...
Epoch: 19 cost time: 6.340967178344727
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.765 Vali Acc: 0.457 Test Loss: 1.765 Test Acc: 0.457
Validation loss decreased (-0.453315 --> -0.456649).  Saving model ...
Epoch: 20 cost time: 6.126382112503052
Epoch: 20, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.747 Vali Acc: 0.477 Test Loss: 1.747 Test Acc: 0.477
Validation loss decreased (-0.456649 --> -0.476649).  Saving model ...
Epoch: 21 cost time: 5.895588397979736
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.714 Vali Acc: 0.487 Test Loss: 1.714 Test Acc: 0.487
Validation loss decreased (-0.476649 --> -0.486650).  Saving model ...
Epoch: 22 cost time: 5.992095232009888
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.691 Vali Acc: 0.500 Test Loss: 1.691 Test Acc: 0.500
Validation loss decreased (-0.486650 --> -0.499983).  Saving model ...
Epoch: 23 cost time: 6.181987524032593
Epoch: 23, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.695 Vali Acc: 0.483 Test Loss: 1.695 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.211891174316406
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.678 Vali Acc: 0.500 Test Loss: 1.678 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499983).  Saving model ...
Epoch: 25 cost time: 6.204703330993652
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.660 Vali Acc: 0.517 Test Loss: 1.660 Test Acc: 0.517
Validation loss decreased (-0.499983 --> -0.516650).  Saving model ...
Epoch: 26 cost time: 6.255202293395996
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.637 Vali Acc: 0.527 Test Loss: 1.637 Test Acc: 0.527
Validation loss decreased (-0.516650 --> -0.526650).  Saving model ...
Epoch: 27 cost time: 5.733198642730713
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.628 Vali Acc: 0.523 Test Loss: 1.628 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.837690353393555
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.605 Vali Acc: 0.543 Test Loss: 1.605 Test Acc: 0.543
Validation loss decreased (-0.526650 --> -0.543317).  Saving model ...
Epoch: 29 cost time: 6.061631917953491
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.596 Vali Acc: 0.547 Test Loss: 1.596 Test Acc: 0.547
Validation loss decreased (-0.543317 --> -0.546651).  Saving model ...
Epoch: 30 cost time: 6.185129404067993
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.596 Vali Acc: 0.540 Test Loss: 1.596 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.310122966766357
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.586 Vali Acc: 0.543 Test Loss: 1.586 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.731334209442139
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.578 Vali Acc: 0.550 Test Loss: 1.578 Test Acc: 0.550
Validation loss decreased (-0.546651 --> -0.549984).  Saving model ...
Epoch: 33 cost time: 6.252857685089111
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.571 Vali Acc: 0.547 Test Loss: 1.571 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.2852888107299805
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.566 Vali Acc: 0.540 Test Loss: 1.566 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.232989072799683
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.559 Vali Acc: 0.553 Test Loss: 1.559 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553318).  Saving model ...
Epoch: 36 cost time: 6.247391223907471
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.542 Vali Acc: 0.563 Test Loss: 1.542 Test Acc: 0.563
Validation loss decreased (-0.553318 --> -0.563318).  Saving model ...
Epoch: 37 cost time: 5.869637489318848
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.524 Vali Acc: 0.570 Test Loss: 1.524 Test Acc: 0.570
Validation loss decreased (-0.563318 --> -0.569985).  Saving model ...
Epoch: 38 cost time: 6.229242324829102
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.512 Vali Acc: 0.577 Test Loss: 1.512 Test Acc: 0.577
Validation loss decreased (-0.569985 --> -0.576652).  Saving model ...
Epoch: 39 cost time: 6.554999113082886
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.504 Vali Acc: 0.570 Test Loss: 1.504 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.980551481246948
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.495 Vali Acc: 0.573 Test Loss: 1.495 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.026028394699097
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.490 Vali Acc: 0.567 Test Loss: 1.490 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 6.484225273132324
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.484 Vali Acc: 0.570 Test Loss: 1.484 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 6.336451768875122
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.476 Vali Acc: 0.563 Test Loss: 1.476 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 6.171199321746826
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.567 Test Loss: 1.474 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 6.148845672607422
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.458 Vali Acc: 0.577 Test Loss: 1.458 Test Acc: 0.577
Validation loss decreased (-0.576652 --> -0.576652).  Saving model ...
Epoch: 46 cost time: 6.17544412612915
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.453 Vali Acc: 0.580 Test Loss: 1.453 Test Acc: 0.580
Validation loss decreased (-0.576652 --> -0.579985).  Saving model ...
Epoch: 47 cost time: 6.240673780441284
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.448 Vali Acc: 0.583 Test Loss: 1.448 Test Acc: 0.583
Validation loss decreased (-0.579985 --> -0.583319).  Saving model ...
Epoch: 48 cost time: 6.36919641494751
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.440 Vali Acc: 0.580 Test Loss: 1.440 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.35801362991333
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.442 Vali Acc: 0.577 Test Loss: 1.442 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 6.222148895263672
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.438 Vali Acc: 0.577 Test Loss: 1.438 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.250896692276001
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.435 Vali Acc: 0.570 Test Loss: 1.435 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 6.155133485794067
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.429 Vali Acc: 0.583 Test Loss: 1.429 Test Acc: 0.583
Validation loss decreased (-0.583319 --> -0.583319).  Saving model ...
Epoch: 53 cost time: 6.071073770523071
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.427 Vali Acc: 0.583 Test Loss: 1.427 Test Acc: 0.583
Validation loss decreased (-0.583319 --> -0.583319).  Saving model ...
Epoch: 54 cost time: 6.261232852935791
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.424 Vali Acc: 0.577 Test Loss: 1.424 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.457089424133301
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.425 Vali Acc: 0.580 Test Loss: 1.425 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 6.277308940887451
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.422 Vali Acc: 0.580 Test Loss: 1.422 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 6.075554847717285
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.413 Vali Acc: 0.580 Test Loss: 1.413 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 5.9334728717803955
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.408 Vali Acc: 0.587 Test Loss: 1.408 Test Acc: 0.587
Validation loss decreased (-0.583319 --> -0.586653).  Saving model ...
Epoch: 59 cost time: 5.694558620452881
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.412 Vali Acc: 0.583 Test Loss: 1.412 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.788487195968628
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.411 Vali Acc: 0.587 Test Loss: 1.411 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 6.21457576751709
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.411 Vali Acc: 0.593 Test Loss: 1.411 Test Acc: 0.593
Validation loss decreased (-0.586653 --> -0.593319).  Saving model ...
Epoch: 62 cost time: 6.04981255531311
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.405 Vali Acc: 0.600 Test Loss: 1.405 Test Acc: 0.600
Validation loss decreased (-0.593319 --> -0.599986).  Saving model ...
Epoch: 63 cost time: 5.843035936355591
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.401 Vali Acc: 0.600 Test Loss: 1.401 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 64 cost time: 6.008458375930786
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.396 Vali Acc: 0.600 Test Loss: 1.396 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 65 cost time: 5.848268508911133
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.597 Test Loss: 1.390 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.78180718421936
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.590 Test Loss: 1.388 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 5.656140327453613
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.613 Test Loss: 1.387 Test Acc: 0.613
Validation loss decreased (-0.599986 --> -0.613319).  Saving model ...
Epoch: 68 cost time: 5.97982120513916
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.610 Test Loss: 1.387 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.0579833984375
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.613 Test Loss: 1.388 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 6.184823751449585
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.613 Test Loss: 1.385 Test Acc: 0.613
Validation loss decreased (-0.613319 --> -0.613319).  Saving model ...
Epoch: 71 cost time: 6.369986534118652
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.613 Test Loss: 1.381 Test Acc: 0.613
Validation loss decreased (-0.613319 --> -0.613320).  Saving model ...
Epoch: 72 cost time: 6.034346580505371
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.378 Vali Acc: 0.613 Test Loss: 1.378 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 73 cost time: 6.1248180866241455
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.607 Test Loss: 1.373 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 6.215070009231567
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.613 Test Loss: 1.373 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 75 cost time: 6.041372060775757
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.623 Test Loss: 1.368 Test Acc: 0.623
Validation loss decreased (-0.613320 --> -0.623320).  Saving model ...
Epoch: 76 cost time: 6.589224100112915
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.620 Test Loss: 1.364 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 6.654948949813843
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.617 Test Loss: 1.361 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 6.344200372695923
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.633 Test Loss: 1.359 Test Acc: 0.633
Validation loss decreased (-0.623320 --> -0.633320).  Saving model ...
Epoch: 79 cost time: 6.125871658325195
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.627 Test Loss: 1.358 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 5.997507810592651
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.627 Test Loss: 1.357 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 5.674084901809692
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.620 Test Loss: 1.358 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 6.050436019897461
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.620 Test Loss: 1.361 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 5.914367914199829
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.623 Test Loss: 1.359 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 6.0846357345581055
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.623 Test Loss: 1.355 Test Acc: 0.623
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 6.210718870162964
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.627 Test Loss: 1.350 Test Acc: 0.627
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 5.765187501907349
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.623 Test Loss: 1.346 Test Acc: 0.623
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 5.763700246810913
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.627 Test Loss: 1.343 Test Acc: 0.627
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 5.241632461547852
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.627 Test Loss: 1.342 Test Acc: 0.627
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6333333333333333
model parameter : 792345
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.483187437057495
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 6.031495571136475
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.088117837905884
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.777797698974609
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 5 cost time: 5.787059545516968
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.718545436859131
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 7 cost time: 6.071918725967407
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.324154376983643
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 9 cost time: 6.0387303829193115
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.120129346847534
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.952855110168457
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.992701292037964
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 13 cost time: 5.8352696895599365
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 14 cost time: 5.907814979553223
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.299772262573242
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.470118284225464
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.6312620639801025
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.370015621185303
Epoch: 18, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.031239032745361
Epoch: 19, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.966520071029663
Epoch: 20, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.991883277893066
Epoch: 21, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.589041709899902
Epoch: 22, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.48834490776062
Epoch: 23, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 792345
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.93165135383606
Epoch: 1, Steps: 18 | Train Loss: 3.124 Vali Loss: 2.764 Vali Acc: 0.367 Test Loss: 2.764 Test Acc: 0.367
Validation loss decreased (inf --> -0.366639).  Saving model ...
Epoch: 2 cost time: 5.977819442749023
Epoch: 2, Steps: 18 | Train Loss: 2.285 Vali Loss: 1.817 Vali Acc: 0.753 Test Loss: 1.817 Test Acc: 0.753
Validation loss decreased (-0.366639 --> -0.753315).  Saving model ...
Epoch: 3 cost time: 5.8359856605529785
Epoch: 3, Steps: 18 | Train Loss: 1.240 Vali Loss: 1.073 Vali Acc: 0.830 Test Loss: 1.073 Test Acc: 0.830
Validation loss decreased (-0.753315 --> -0.829989).  Saving model ...
Epoch: 4 cost time: 5.782871723175049
Epoch: 4, Steps: 18 | Train Loss: 0.556 Vali Loss: 0.705 Vali Acc: 0.847 Test Loss: 0.705 Test Acc: 0.847
Validation loss decreased (-0.829989 --> -0.846660).  Saving model ...
Epoch: 5 cost time: 6.259189605712891
Epoch: 5, Steps: 18 | Train Loss: 0.228 Vali Loss: 0.541 Vali Acc: 0.873 Test Loss: 0.541 Test Acc: 0.873
Validation loss decreased (-0.846660 --> -0.873328).  Saving model ...
Epoch: 6 cost time: 5.9626781940460205
Epoch: 6, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.476 Vali Acc: 0.880 Test Loss: 0.476 Test Acc: 0.880
Validation loss decreased (-0.873328 --> -0.879995).  Saving model ...
Epoch: 7 cost time: 6.201453685760498
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.437 Vali Acc: 0.880 Test Loss: 0.437 Test Acc: 0.880
Validation loss decreased (-0.879995 --> -0.879996).  Saving model ...
Epoch: 8 cost time: 5.872680425643921
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.422 Vali Acc: 0.880 Test Loss: 0.422 Test Acc: 0.880
Validation loss decreased (-0.879996 --> -0.879996).  Saving model ...
Epoch: 9 cost time: 5.715059518814087
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.413 Vali Acc: 0.883 Test Loss: 0.413 Test Acc: 0.883
Validation loss decreased (-0.879996 --> -0.883329).  Saving model ...
Epoch: 10 cost time: 5.336815357208252
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.406 Vali Acc: 0.883 Test Loss: 0.406 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 11 cost time: 5.625990867614746
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.399 Vali Acc: 0.890 Test Loss: 0.399 Test Acc: 0.890
Validation loss decreased (-0.883329 --> -0.889996).  Saving model ...
Epoch: 12 cost time: 5.539484262466431
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.392 Vali Acc: 0.890 Test Loss: 0.392 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 13 cost time: 5.914184808731079
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.388 Vali Acc: 0.887 Test Loss: 0.388 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.073545455932617
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.383 Vali Acc: 0.887 Test Loss: 0.383 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.382632255554199
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.379 Vali Acc: 0.887 Test Loss: 0.379 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.832208871841431
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.378 Vali Acc: 0.887 Test Loss: 0.378 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.863689184188843
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.376 Vali Acc: 0.890 Test Loss: 0.376 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 18 cost time: 5.895170211791992
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.374 Vali Acc: 0.890 Test Loss: 0.374 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 19 cost time: 5.758930206298828
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.373 Vali Acc: 0.887 Test Loss: 0.373 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.199643135070801
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.369 Vali Acc: 0.890 Test Loss: 0.369 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 21 cost time: 6.253659963607788
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.366 Vali Acc: 0.887 Test Loss: 0.366 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.27130389213562
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.364 Vali Acc: 0.887 Test Loss: 0.364 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.96818470954895
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.364 Vali Acc: 0.887 Test Loss: 0.364 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.808978080749512
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.363 Vali Acc: 0.887 Test Loss: 0.363 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.643547534942627
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.362 Vali Acc: 0.887 Test Loss: 0.362 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.6052117347717285
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.362 Vali Acc: 0.887 Test Loss: 0.362 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.211794137954712
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.361 Vali Acc: 0.887 Test Loss: 0.361 Test Acc: 0.887
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.224541187286377
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.361 Vali Acc: 0.887 Test Loss: 0.361 Test Acc: 0.887
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.2317376136779785
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.359 Vali Acc: 0.887 Test Loss: 0.359 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.050105094909668
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.358 Vali Acc: 0.890 Test Loss: 0.358 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 31 cost time: 5.899008750915527
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.890 Test Loss: 0.357 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 32 cost time: 5.8371875286102295
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.356 Vali Acc: 0.890 Test Loss: 0.356 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 33 cost time: 6.073294401168823
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.356 Vali Acc: 0.893 Test Loss: 0.356 Test Acc: 0.893
Validation loss decreased (-0.889996 --> -0.893330).  Saving model ...
Epoch: 34 cost time: 6.319054841995239
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.890 Test Loss: 0.357 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.078400611877441
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.356 Vali Acc: 0.893 Test Loss: 0.356 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 6.091513395309448
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.893 Test Loss: 0.354 Test Acc: 0.893
Validation loss decreased (-0.893330 --> -0.893330).  Saving model ...
Epoch: 37 cost time: 6.156453371047974
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.893 Test Loss: 0.354 Test Acc: 0.893
Validation loss decreased (-0.893330 --> -0.893330).  Saving model ...
Epoch: 38 cost time: 5.750424861907959
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.353 Vali Acc: 0.893 Test Loss: 0.353 Test Acc: 0.893
Validation loss decreased (-0.893330 --> -0.893330).  Saving model ...
Epoch: 39 cost time: 5.906001806259155
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.353 Vali Acc: 0.893 Test Loss: 0.353 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.857511520385742
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.893 Test Loss: 0.354 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.192715883255005
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.353 Vali Acc: 0.893 Test Loss: 0.353 Test Acc: 0.893
Validation loss decreased (-0.893330 --> -0.893330).  Saving model ...
Epoch: 42 cost time: 6.171356678009033
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.351 Vali Acc: 0.897 Test Loss: 0.351 Test Acc: 0.897
Validation loss decreased (-0.893330 --> -0.896663).  Saving model ...
Epoch: 43 cost time: 5.95283842086792
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.350 Vali Acc: 0.893 Test Loss: 0.350 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.119822263717651
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.350 Vali Acc: 0.893 Test Loss: 0.350 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 5.653571844100952
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.350 Vali Acc: 0.897 Test Loss: 0.350 Test Acc: 0.897
Validation loss decreased (-0.896663 --> -0.896663).  Saving model ...
Epoch: 46 cost time: 5.7622230052948
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.348 Vali Acc: 0.893 Test Loss: 0.348 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.668028354644775
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.348 Vali Acc: 0.897 Test Loss: 0.348 Test Acc: 0.897
Validation loss decreased (-0.896663 --> -0.896663).  Saving model ...
Epoch: 48 cost time: 5.8059327602386475
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.896663 --> -0.903330).  Saving model ...
Epoch: 49 cost time: 6.068665504455566
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 50 cost time: 5.942211151123047
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 51 cost time: 5.93137001991272
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.345 Vali Acc: 0.903 Test Loss: 0.345 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 52 cost time: 5.510344982147217
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.345 Vali Acc: 0.903 Test Loss: 0.345 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 5.533031940460205
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.345 Vali Acc: 0.903 Test Loss: 0.345 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 5.681368827819824
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 55 cost time: 6.402033090591431
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 56 cost time: 6.450627088546753
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 57 cost time: 6.337353229522705
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.387145042419434
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 5.774261713027954
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 5.949536085128784
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 6.494413137435913
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 6.647169351577759
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 63 cost time: 6.3532140254974365
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 64 cost time: 6.1235716342926025
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 6.175565004348755
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 66 cost time: 5.674133062362671
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 67 cost time: 5.649266481399536
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 5.6209423542022705
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 69 cost time: 5.577451467514038
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 70 cost time: 5.787203550338745
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 71 cost time: 5.932167053222656
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 72 cost time: 5.719520092010498
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 5.851853370666504
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 5.902003049850464
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 5.7457194328308105
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 6.374221086502075
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 77 cost time: 6.394347667694092
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 78 cost time: 6.363278150558472
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 79 cost time: 5.891476631164551
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 80 cost time: 5.581044912338257
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 81 cost time: 5.912825345993042
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 5.6475324630737305
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 6.010168552398682
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 84 cost time: 6.209475755691528
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 6.047958135604858
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 6.280896425247192
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
Validation loss decreased (-0.903330 --> -0.903330).  Saving model ...
Epoch: 87 cost time: 5.778887987136841
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.907 Test Loss: 0.337 Test Acc: 0.907
Validation loss decreased (-0.903330 --> -0.906663).  Saving model ...
Epoch: 88 cost time: 5.440124273300171
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 5.781375885009766
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 6.211220741271973
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 6.464229345321655
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 6.415690183639526
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.907 Test Loss: 0.337 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 6.603386878967285
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 6.232102870941162
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 5.920543193817139
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 6.085063934326172
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.907 Test Loss: 0.336 Test Acc: 0.907
Validation loss decreased (-0.906663 --> -0.906663).  Saving model ...
Epoch: 97 cost time: 5.829702615737915
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.907 Test Loss: 0.336 Test Acc: 0.907
Validation loss decreased (-0.906663 --> -0.906663).  Saving model ...
Epoch: 98 cost time: 6.128175973892212
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.910 Test Loss: 0.337 Test Acc: 0.910
Validation loss decreased (-0.906663 --> -0.909997).  Saving model ...
Epoch: 99 cost time: 6.135439157485962
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.910 Test Loss: 0.337 Test Acc: 0.910
Validation loss decreased (-0.909997 --> -0.909997).  Saving model ...
Epoch: 100 cost time: 5.930862188339233
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.910 Test Loss: 0.337 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.91
model parameter : 595737
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.216570138931274
Epoch: 1, Steps: 18 | Train Loss: 3.158 Vali Loss: 2.896 Vali Acc: 0.230 Test Loss: 2.896 Test Acc: 0.230
Validation loss decreased (inf --> -0.229971).  Saving model ...
Epoch: 2 cost time: 5.577951192855835
Epoch: 2, Steps: 18 | Train Loss: 2.504 Vali Loss: 2.152 Vali Acc: 0.643 Test Loss: 2.152 Test Acc: 0.643
Validation loss decreased (-0.229971 --> -0.643312).  Saving model ...
Epoch: 3 cost time: 5.769191265106201
Epoch: 3, Steps: 18 | Train Loss: 1.569 Vali Loss: 1.446 Vali Acc: 0.743 Test Loss: 1.446 Test Acc: 0.743
Validation loss decreased (-0.643312 --> -0.743319).  Saving model ...
Epoch: 4 cost time: 6.065694808959961
Epoch: 4, Steps: 18 | Train Loss: 0.799 Vali Loss: 0.998 Vali Acc: 0.787 Test Loss: 0.998 Test Acc: 0.787
Validation loss decreased (-0.743319 --> -0.786657).  Saving model ...
Epoch: 5 cost time: 6.315694808959961
Epoch: 5, Steps: 18 | Train Loss: 0.349 Vali Loss: 0.772 Vali Acc: 0.820 Test Loss: 0.772 Test Acc: 0.820
Validation loss decreased (-0.786657 --> -0.819992).  Saving model ...
Epoch: 6 cost time: 6.171538591384888
Epoch: 6, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.663 Vali Acc: 0.830 Test Loss: 0.663 Test Acc: 0.830
Validation loss decreased (-0.819992 --> -0.829993).  Saving model ...
Epoch: 7 cost time: 6.041457414627075
Epoch: 7, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
Validation loss decreased (-0.829993 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 5.766233444213867
Epoch: 8, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 9 cost time: 6.043900966644287
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.577 Vali Acc: 0.847 Test Loss: 0.577 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.9682297706604
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.567 Vali Acc: 0.843 Test Loss: 0.567 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.316903829574585
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.559 Vali Acc: 0.847 Test Loss: 0.559 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.36526894569397
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.550 Vali Acc: 0.843 Test Loss: 0.550 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.259435415267944
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.546 Vali Acc: 0.853 Test Loss: 0.546 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853328).  Saving model ...
Epoch: 14 cost time: 6.51756477355957
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.951905250549316
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.538 Vali Acc: 0.857 Test Loss: 0.538 Test Acc: 0.857
Validation loss decreased (-0.853328 --> -0.856661).  Saving model ...
Epoch: 16 cost time: 6.142838001251221
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.536 Vali Acc: 0.857 Test Loss: 0.536 Test Acc: 0.857
Validation loss decreased (-0.856661 --> -0.856661).  Saving model ...
Epoch: 17 cost time: 6.35237717628479
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.536 Vali Acc: 0.847 Test Loss: 0.536 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.43095326423645
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.373246669769287
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.531 Vali Acc: 0.853 Test Loss: 0.531 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.118684530258179
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.860 Test Loss: 0.530 Test Acc: 0.860
Validation loss decreased (-0.856661 --> -0.859995).  Saving model ...
Epoch: 21 cost time: 6.310415029525757
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.527 Vali Acc: 0.857 Test Loss: 0.527 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.218425989151001
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.527 Vali Acc: 0.857 Test Loss: 0.527 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.9612956047058105
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.528 Vali Acc: 0.857 Test Loss: 0.528 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.7646098136901855
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.527 Vali Acc: 0.857 Test Loss: 0.527 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.924081087112427
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.526 Vali Acc: 0.853 Test Loss: 0.526 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.02473783493042
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.853 Test Loss: 0.525 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.907796859741211
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.523 Vali Acc: 0.857 Test Loss: 0.523 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.296711444854736
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.857 Test Loss: 0.522 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.019400358200073
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.857 Test Loss: 0.522 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.91985559463501
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.860 Test Loss: 0.523 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 31 cost time: 6.0584352016448975
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.860 Test Loss: 0.522 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 32 cost time: 6.367903470993042
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.860 Test Loss: 0.522 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 33 cost time: 6.226388454437256
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.860 Test Loss: 0.522 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 34 cost time: 6.348838567733765
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.860 Test Loss: 0.522 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.365774154663086
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.860 Test Loss: 0.521 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 36 cost time: 5.945000171661377
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.857 Test Loss: 0.520 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.180644273757935
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.857 Test Loss: 0.520 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.981817007064819
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.857 Test Loss: 0.521 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 5.79410982131958
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.857 Test Loss: 0.521 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 5.898048400878906
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.857 Test Loss: 0.521 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 5.9204261302948
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.857 Test Loss: 0.522 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 6.212813377380371
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.857 Test Loss: 0.519 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 5.422132730484009
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.857 Test Loss: 0.519 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 5.810056447982788
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.860 Test Loss: 0.520 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 45 cost time: 5.643836259841919
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.860 Test Loss: 0.522 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.71548867225647
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.860 Test Loss: 0.521 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 6.194302797317505
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.857 Test Loss: 0.519 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 6.54229736328125
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.857 Test Loss: 0.519 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 6.752207517623901
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.857 Test Loss: 0.518 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 6.370826721191406
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.860 Test Loss: 0.517 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 51 cost time: 6.112025260925293
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
Validation loss decreased (-0.859995 --> -0.866661).  Saving model ...
Epoch: 52 cost time: 6.24229621887207
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.863 Test Loss: 0.517 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 6.110802888870239
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.860 Test Loss: 0.517 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 6.318282127380371
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.860 Test Loss: 0.515 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 6.512916088104248
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.863 Test Loss: 0.516 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 6.343841791152954
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.863 Test Loss: 0.516 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 6.1742284297943115
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.860 Test Loss: 0.518 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 5.810158729553223
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.860 Test Loss: 0.518 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 5.845625877380371
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.860 Test Loss: 0.518 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 5.798253774642944
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.857 Test Loss: 0.520 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 6.127542972564697
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.860 Test Loss: 0.520 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8666666666666667
model parameter : 595737
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.626313209533691
Epoch: 1, Steps: 18 | Train Loss: 3.192 Vali Loss: 3.023 Vali Acc: 0.160 Test Loss: 3.023 Test Acc: 0.160
Validation loss decreased (inf --> -0.159970).  Saving model ...
Epoch: 2 cost time: 5.635655879974365
Epoch: 2, Steps: 18 | Train Loss: 2.728 Vali Loss: 2.518 Vali Acc: 0.500 Test Loss: 2.518 Test Acc: 0.500
Validation loss decreased (-0.159970 --> -0.499975).  Saving model ...
Epoch: 3 cost time: 6.110390901565552
Epoch: 3, Steps: 18 | Train Loss: 1.990 Vali Loss: 1.952 Vali Acc: 0.660 Test Loss: 1.952 Test Acc: 0.660
Validation loss decreased (-0.499975 --> -0.659980).  Saving model ...
Epoch: 4 cost time: 5.643340110778809
Epoch: 4, Steps: 18 | Train Loss: 1.215 Vali Loss: 1.479 Vali Acc: 0.720 Test Loss: 1.479 Test Acc: 0.720
Validation loss decreased (-0.659980 --> -0.719985).  Saving model ...
Epoch: 5 cost time: 5.968338489532471
Epoch: 5, Steps: 18 | Train Loss: 0.613 Vali Loss: 1.160 Vali Acc: 0.740 Test Loss: 1.160 Test Acc: 0.740
Validation loss decreased (-0.719985 --> -0.739988).  Saving model ...
Epoch: 6 cost time: 6.421348333358765
Epoch: 6, Steps: 18 | Train Loss: 0.262 Vali Loss: 0.955 Vali Acc: 0.773 Test Loss: 0.955 Test Acc: 0.773
Validation loss decreased (-0.739988 --> -0.773324).  Saving model ...
Epoch: 7 cost time: 6.347649812698364
Epoch: 7, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.889 Vali Acc: 0.777 Test Loss: 0.889 Test Acc: 0.777
Validation loss decreased (-0.773324 --> -0.776658).  Saving model ...
Epoch: 8 cost time: 6.5962090492248535
Epoch: 8, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.854 Vali Acc: 0.780 Test Loss: 0.854 Test Acc: 0.780
Validation loss decreased (-0.776658 --> -0.779991).  Saving model ...
Epoch: 9 cost time: 6.384375095367432
Epoch: 9, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.824 Vali Acc: 0.793 Test Loss: 0.824 Test Acc: 0.793
Validation loss decreased (-0.779991 --> -0.793325).  Saving model ...
Epoch: 10 cost time: 6.01555061340332
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.819 Vali Acc: 0.790 Test Loss: 0.819 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.976377010345459
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.808 Vali Acc: 0.790 Test Loss: 0.808 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.555365800857544
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.798 Vali Acc: 0.793 Test Loss: 0.798 Test Acc: 0.793
Validation loss decreased (-0.793325 --> -0.793325).  Saving model ...
Epoch: 13 cost time: 6.094563245773315
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.795 Vali Acc: 0.797 Test Loss: 0.795 Test Acc: 0.797
Validation loss decreased (-0.793325 --> -0.796659).  Saving model ...
Epoch: 14 cost time: 6.629080533981323
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.793 Vali Acc: 0.793 Test Loss: 0.793 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.492190599441528
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.788 Vali Acc: 0.793 Test Loss: 0.788 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.012543201446533
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.786 Vali Acc: 0.793 Test Loss: 0.786 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.115582227706909
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.784 Vali Acc: 0.797 Test Loss: 0.784 Test Acc: 0.797
Validation loss decreased (-0.796659 --> -0.796659).  Saving model ...
Epoch: 18 cost time: 5.911560773849487
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.782 Vali Acc: 0.793 Test Loss: 0.782 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.286149740219116
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.781 Vali Acc: 0.793 Test Loss: 0.781 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.441426992416382
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.783 Vali Acc: 0.793 Test Loss: 0.783 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.371971130371094
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.784 Vali Acc: 0.787 Test Loss: 0.784 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.682083368301392
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.782 Vali Acc: 0.793 Test Loss: 0.782 Test Acc: 0.793
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.040406703948975
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.783 Vali Acc: 0.803 Test Loss: 0.783 Test Acc: 0.803
Validation loss decreased (-0.796659 --> -0.803326).  Saving model ...
Epoch: 24 cost time: 6.046357870101929
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.781 Vali Acc: 0.803 Test Loss: 0.781 Test Acc: 0.803
Validation loss decreased (-0.803326 --> -0.803326).  Saving model ...
Epoch: 25 cost time: 5.796270132064819
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.781 Vali Acc: 0.797 Test Loss: 0.781 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.454996824264526
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.781 Vali Acc: 0.803 Test Loss: 0.781 Test Acc: 0.803
Validation loss decreased (-0.803326 --> -0.803326).  Saving model ...
Epoch: 27 cost time: 6.498712062835693
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.782 Vali Acc: 0.803 Test Loss: 0.782 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.710749864578247
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.780 Vali Acc: 0.803 Test Loss: 0.780 Test Acc: 0.803
Validation loss decreased (-0.803326 --> -0.803326).  Saving model ...
Epoch: 29 cost time: 6.6682188510894775
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.782 Vali Acc: 0.803 Test Loss: 0.782 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.223940372467041
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.781 Vali Acc: 0.807 Test Loss: 0.781 Test Acc: 0.807
Validation loss decreased (-0.803326 --> -0.806659).  Saving model ...
Epoch: 31 cost time: 6.191641092300415
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.785 Vali Acc: 0.797 Test Loss: 0.785 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.247605323791504
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.797 Test Loss: 0.785 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.609313249588013
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.794403076171875
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.810 Test Loss: 0.785 Test Acc: 0.810
Validation loss decreased (-0.806659 --> -0.809992).  Saving model ...
Epoch: 35 cost time: 6.991302490234375
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.810 Test Loss: 0.783 Test Acc: 0.810
Validation loss decreased (-0.809992 --> -0.809992).  Saving model ...
Epoch: 36 cost time: 5.885496616363525
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.810 Test Loss: 0.783 Test Acc: 0.810
Validation loss decreased (-0.809992 --> -0.809992).  Saving model ...
Epoch: 37 cost time: 6.666741847991943
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.810 Test Loss: 0.783 Test Acc: 0.810
Validation loss decreased (-0.809992 --> -0.809992).  Saving model ...
Epoch: 38 cost time: 6.187892198562622
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.807 Test Loss: 0.784 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.5048205852508545
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.807 Test Loss: 0.784 Test Acc: 0.807
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.721230506896973
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.813 Test Loss: 0.784 Test Acc: 0.813
Validation loss decreased (-0.809992 --> -0.813325).  Saving model ...
Epoch: 41 cost time: 6.614407300949097
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.813 Test Loss: 0.782 Test Acc: 0.813
Validation loss decreased (-0.813325 --> -0.813326).  Saving model ...
Epoch: 42 cost time: 5.944488763809204
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.813 Test Loss: 0.781 Test Acc: 0.813
Validation loss decreased (-0.813326 --> -0.813326).  Saving model ...
Epoch: 43 cost time: 6.254894971847534
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.813 Test Loss: 0.782 Test Acc: 0.813
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.089458465576172
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.813 Test Loss: 0.784 Test Acc: 0.813
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 6.520448923110962
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.810 Test Loss: 0.786 Test Acc: 0.810
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 6.671803951263428
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.813 Test Loss: 0.787 Test Acc: 0.813
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 6.323565483093262
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.813 Test Loss: 0.788 Test Acc: 0.813
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 6.6950483322143555
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.813 Test Loss: 0.787 Test Acc: 0.813
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 6.027181625366211
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.813 Test Loss: 0.787 Test Acc: 0.813
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 6.213272333145142
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.813 Test Loss: 0.786 Test Acc: 0.813
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 6.295128345489502
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.813 Test Loss: 0.785 Test Acc: 0.813
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 6.463211536407471
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.810 Test Loss: 0.784 Test Acc: 0.810
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8133333333333334
model parameter : 595737
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.590260028839111
Epoch: 1, Steps: 18 | Train Loss: 3.225 Vali Loss: 3.103 Vali Acc: 0.093 Test Loss: 3.103 Test Acc: 0.093
Validation loss decreased (inf --> -0.093302).  Saving model ...
Epoch: 2 cost time: 6.515685796737671
Epoch: 2, Steps: 18 | Train Loss: 2.909 Vali Loss: 2.799 Vali Acc: 0.297 Test Loss: 2.799 Test Acc: 0.297
Validation loss decreased (-0.093302 --> -0.296639).  Saving model ...
Epoch: 3 cost time: 6.4468793869018555
Epoch: 3, Steps: 18 | Train Loss: 2.343 Vali Loss: 2.429 Vali Acc: 0.470 Test Loss: 2.429 Test Acc: 0.470
Validation loss decreased (-0.296639 --> -0.469976).  Saving model ...
Epoch: 4 cost time: 6.3436455726623535
Epoch: 4, Steps: 18 | Train Loss: 1.691 Vali Loss: 2.070 Vali Acc: 0.520 Test Loss: 2.070 Test Acc: 0.520
Validation loss decreased (-0.469976 --> -0.519979).  Saving model ...
Epoch: 5 cost time: 6.709494113922119
Epoch: 5, Steps: 18 | Train Loss: 1.064 Vali Loss: 1.767 Vali Acc: 0.590 Test Loss: 1.767 Test Acc: 0.590
Validation loss decreased (-0.519979 --> -0.589982).  Saving model ...
Epoch: 6 cost time: 5.964452028274536
Epoch: 6, Steps: 18 | Train Loss: 0.561 Vali Loss: 1.500 Vali Acc: 0.620 Test Loss: 1.500 Test Acc: 0.620
Validation loss decreased (-0.589982 --> -0.619985).  Saving model ...
Epoch: 7 cost time: 6.324731349945068
Epoch: 7, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.369 Vali Acc: 0.620 Test Loss: 1.369 Test Acc: 0.620
Validation loss decreased (-0.619985 --> -0.619986).  Saving model ...
Epoch: 8 cost time: 6.411406755447388
Epoch: 8, Steps: 18 | Train Loss: 0.111 Vali Loss: 1.263 Vali Acc: 0.623 Test Loss: 1.263 Test Acc: 0.623
Validation loss decreased (-0.619986 --> -0.623321).  Saving model ...
Epoch: 9 cost time: 7.027863264083862
Epoch: 9, Steps: 18 | Train Loss: 0.056 Vali Loss: 1.228 Vali Acc: 0.653 Test Loss: 1.228 Test Acc: 0.653
Validation loss decreased (-0.623321 --> -0.653321).  Saving model ...
Epoch: 10 cost time: 6.828767538070679
Epoch: 10, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.197 Vali Acc: 0.633 Test Loss: 1.197 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.391934394836426
Epoch: 11, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.173 Vali Acc: 0.643 Test Loss: 1.173 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.79812479019165
Epoch: 12, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.157 Vali Acc: 0.640 Test Loss: 1.157 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.133212566375732
Epoch: 13, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.147 Vali Acc: 0.637 Test Loss: 1.147 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.321355104446411
Epoch: 14, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.130 Vali Acc: 0.670 Test Loss: 1.130 Test Acc: 0.670
Validation loss decreased (-0.653321 --> -0.669989).  Saving model ...
Epoch: 15 cost time: 6.142544746398926
Epoch: 15, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.118 Vali Acc: 0.663 Test Loss: 1.118 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.470966339111328
Epoch: 16, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.111 Vali Acc: 0.667 Test Loss: 1.111 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.981288194656372
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.107 Vali Acc: 0.670 Test Loss: 1.107 Test Acc: 0.670
Validation loss decreased (-0.669989 --> -0.669989).  Saving model ...
Epoch: 18 cost time: 6.079955816268921
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.101 Vali Acc: 0.677 Test Loss: 1.101 Test Acc: 0.677
Validation loss decreased (-0.669989 --> -0.676656).  Saving model ...
Epoch: 19 cost time: 5.915761947631836
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.092 Vali Acc: 0.677 Test Loss: 1.092 Test Acc: 0.677
Validation loss decreased (-0.676656 --> -0.676656).  Saving model ...
Epoch: 20 cost time: 5.773497581481934
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.085 Vali Acc: 0.680 Test Loss: 1.085 Test Acc: 0.680
Validation loss decreased (-0.676656 --> -0.679989).  Saving model ...
Epoch: 21 cost time: 6.381446123123169
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.079 Vali Acc: 0.683 Test Loss: 1.079 Test Acc: 0.683
Validation loss decreased (-0.679989 --> -0.683323).  Saving model ...
Epoch: 22 cost time: 6.296431064605713
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.076 Vali Acc: 0.683 Test Loss: 1.076 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683323).  Saving model ...
Epoch: 23 cost time: 6.415823936462402
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.075 Vali Acc: 0.673 Test Loss: 1.075 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.395245552062988
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.070 Vali Acc: 0.670 Test Loss: 1.070 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.052351236343384
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.072 Vali Acc: 0.687 Test Loss: 1.072 Test Acc: 0.687
Validation loss decreased (-0.683323 --> -0.686656).  Saving model ...
Epoch: 26 cost time: 6.298954010009766
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.066 Vali Acc: 0.690 Test Loss: 1.066 Test Acc: 0.690
Validation loss decreased (-0.686656 --> -0.689989).  Saving model ...
Epoch: 27 cost time: 6.168273210525513
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.060 Vali Acc: 0.693 Test Loss: 1.060 Test Acc: 0.693
Validation loss decreased (-0.689989 --> -0.693323).  Saving model ...
Epoch: 28 cost time: 6.466413497924805
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.056 Vali Acc: 0.683 Test Loss: 1.056 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.476845979690552
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.057 Vali Acc: 0.693 Test Loss: 1.057 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 30 cost time: 6.48848032951355
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.055 Vali Acc: 0.697 Test Loss: 1.055 Test Acc: 0.697
Validation loss decreased (-0.693323 --> -0.696656).  Saving model ...
Epoch: 31 cost time: 6.061395645141602
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.052 Vali Acc: 0.703 Test Loss: 1.052 Test Acc: 0.703
Validation loss decreased (-0.696656 --> -0.703323).  Saving model ...
Epoch: 32 cost time: 6.676105976104736
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.050 Vali Acc: 0.697 Test Loss: 1.050 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.394544363021851
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.047 Vali Acc: 0.693 Test Loss: 1.047 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.675703763961792
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.049 Vali Acc: 0.687 Test Loss: 1.049 Test Acc: 0.687
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 6.595006942749023
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.697 Test Loss: 1.046 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 6.367556095123291
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.044 Vali Acc: 0.700 Test Loss: 1.044 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 6.144152879714966
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.041 Vali Acc: 0.697 Test Loss: 1.041 Test Acc: 0.697
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 5.843116998672485
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.038 Vali Acc: 0.703 Test Loss: 1.038 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 39 cost time: 5.9431374073028564
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.037 Vali Acc: 0.703 Test Loss: 1.037 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 40 cost time: 6.081713438034058
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.037 Vali Acc: 0.707 Test Loss: 1.037 Test Acc: 0.707
Validation loss decreased (-0.703323 --> -0.706656).  Saving model ...
Epoch: 41 cost time: 6.094604015350342
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.710 Test Loss: 1.036 Test Acc: 0.710
Validation loss decreased (-0.706656 --> -0.709990).  Saving model ...
Epoch: 42 cost time: 6.203777551651001
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.033 Vali Acc: 0.707 Test Loss: 1.033 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.98814058303833
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.707 Test Loss: 1.030 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.687926530838013
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.028 Vali Acc: 0.713 Test Loss: 1.028 Test Acc: 0.713
Validation loss decreased (-0.709990 --> -0.713323).  Saving model ...
Epoch: 45 cost time: 5.6540586948394775
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.028 Vali Acc: 0.710 Test Loss: 1.028 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.220085620880127
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.028 Vali Acc: 0.710 Test Loss: 1.028 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 6.250697374343872
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.028 Vali Acc: 0.710 Test Loss: 1.028 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 6.303670883178711
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.026 Vali Acc: 0.710 Test Loss: 1.026 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 6.324450969696045
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.713 Test Loss: 1.024 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 50 cost time: 5.921708106994629
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.020 Vali Acc: 0.713 Test Loss: 1.020 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 51 cost time: 6.283021926879883
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.019 Vali Acc: 0.720 Test Loss: 1.019 Test Acc: 0.720
Validation loss decreased (-0.713323 --> -0.719990).  Saving model ...
Epoch: 52 cost time: 6.4489593505859375
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.723 Test Loss: 1.021 Test Acc: 0.723
Validation loss decreased (-0.719990 --> -0.723323).  Saving model ...
Epoch: 53 cost time: 6.663555145263672
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.019 Vali Acc: 0.720 Test Loss: 1.019 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.494730472564697
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.723 Test Loss: 1.014 Test Acc: 0.723
Validation loss decreased (-0.723323 --> -0.723323).  Saving model ...
Epoch: 55 cost time: 6.625406265258789
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.723 Test Loss: 1.015 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 6.951751708984375
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.727 Test Loss: 1.016 Test Acc: 0.727
Validation loss decreased (-0.723323 --> -0.726657).  Saving model ...
Epoch: 57 cost time: 6.330569505691528
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.713 Test Loss: 1.018 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.044148683547974
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.713 Test Loss: 1.014 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 5.939518451690674
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.727 Test Loss: 1.013 Test Acc: 0.727
Validation loss decreased (-0.726657 --> -0.726657).  Saving model ...
Epoch: 60 cost time: 6.557062387466431
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.727 Test Loss: 1.014 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.74355936050415
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.727 Test Loss: 1.013 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 6.299546957015991
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.727 Test Loss: 1.013 Test Acc: 0.727
Validation loss decreased (-0.726657 --> -0.726657).  Saving model ...
Epoch: 63 cost time: 5.723728895187378
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.723 Test Loss: 1.012 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.864630699157715
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.720 Test Loss: 1.012 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 5.867550611495972
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.723 Test Loss: 1.013 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 6.193801403045654
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.720 Test Loss: 1.013 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 6.506546974182129
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.720 Test Loss: 1.013 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 6.373311281204224
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.723 Test Loss: 1.013 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 6.059989929199219
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.727 Test Loss: 1.011 Test Acc: 0.727
Validation loss decreased (-0.726657 --> -0.726657).  Saving model ...
Epoch: 70 cost time: 6.033576726913452
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.723 Test Loss: 1.011 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 5.784524202346802
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.727 Test Loss: 1.011 Test Acc: 0.727
Validation loss decreased (-0.726657 --> -0.726657).  Saving model ...
Epoch: 72 cost time: 5.710810422897339
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.720 Test Loss: 1.011 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 6.339609622955322
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.717 Test Loss: 1.013 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 6.208435535430908
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.720 Test Loss: 1.013 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 6.721906423568726
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.723 Test Loss: 1.013 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 5.915802478790283
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.727 Test Loss: 1.013 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 6.115741968154907
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.723 Test Loss: 1.013 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 6.133104562759399
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.723 Test Loss: 1.011 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 6.743818283081055
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.723 Test Loss: 1.011 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 6.779932975769043
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.727 Test Loss: 1.011 Test Acc: 0.727
Validation loss decreased (-0.726657 --> -0.726657).  Saving model ...
Epoch: 81 cost time: 6.807462215423584
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.733 Test Loss: 1.009 Test Acc: 0.733
Validation loss decreased (-0.726657 --> -0.733323).  Saving model ...
Epoch: 82 cost time: 6.421463489532471
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.733 Test Loss: 1.009 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 83 cost time: 6.132879734039307
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.740 Test Loss: 1.008 Test Acc: 0.740
Validation loss decreased (-0.733323 --> -0.739990).  Saving model ...
Epoch: 84 cost time: 6.405835390090942
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.733 Test Loss: 1.008 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 6.740453243255615
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.733 Test Loss: 1.008 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 6.6064605712890625
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.733 Test Loss: 1.008 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 6.435261964797974
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.733 Test Loss: 1.008 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 6.594091415405273
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.727 Test Loss: 1.009 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 6.274236440658569
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.727 Test Loss: 1.009 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 6.252185106277466
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.727 Test Loss: 1.009 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 6.342231512069702
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.727 Test Loss: 1.009 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 6.809343576431274
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.730 Test Loss: 1.007 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 6.346303224563599
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.730 Test Loss: 1.008 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.74
model parameter : 595737
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.963310241699219
Epoch: 1, Steps: 18 | Train Loss: 3.226 Vali Loss: 3.164 Vali Acc: 0.080 Test Loss: 3.164 Test Acc: 0.080
Validation loss decreased (inf --> -0.079968).  Saving model ...
Epoch: 2 cost time: 5.625814914703369
Epoch: 2, Steps: 18 | Train Loss: 2.971 Vali Loss: 2.972 Vali Acc: 0.183 Test Loss: 2.972 Test Acc: 0.183
Validation loss decreased (-0.079968 --> -0.183304).  Saving model ...
Epoch: 3 cost time: 5.933459520339966
Epoch: 3, Steps: 18 | Train Loss: 2.507 Vali Loss: 2.744 Vali Acc: 0.273 Test Loss: 2.744 Test Acc: 0.273
Validation loss decreased (-0.183304 --> -0.273306).  Saving model ...
Epoch: 4 cost time: 6.571210145950317
Epoch: 4, Steps: 18 | Train Loss: 1.923 Vali Loss: 2.507 Vali Acc: 0.333 Test Loss: 2.507 Test Acc: 0.333
Validation loss decreased (-0.273306 --> -0.333308).  Saving model ...
Epoch: 5 cost time: 6.5148866176605225
Epoch: 5, Steps: 18 | Train Loss: 1.355 Vali Loss: 2.297 Vali Acc: 0.393 Test Loss: 2.297 Test Acc: 0.393
Validation loss decreased (-0.333308 --> -0.393310).  Saving model ...
Epoch: 6 cost time: 6.596280097961426
Epoch: 6, Steps: 18 | Train Loss: 0.802 Vali Loss: 2.087 Vali Acc: 0.420 Test Loss: 2.087 Test Acc: 0.420
Validation loss decreased (-0.393310 --> -0.419979).  Saving model ...
Epoch: 7 cost time: 6.148082494735718
Epoch: 7, Steps: 18 | Train Loss: 0.440 Vali Loss: 1.953 Vali Acc: 0.420 Test Loss: 1.953 Test Acc: 0.420
Validation loss decreased (-0.419979 --> -0.419980).  Saving model ...
Epoch: 8 cost time: 6.195620775222778
Epoch: 8, Steps: 18 | Train Loss: 0.208 Vali Loss: 1.831 Vali Acc: 0.437 Test Loss: 1.831 Test Acc: 0.437
Validation loss decreased (-0.419980 --> -0.436648).  Saving model ...
Epoch: 9 cost time: 5.846702814102173
Epoch: 9, Steps: 18 | Train Loss: 0.098 Vali Loss: 1.774 Vali Acc: 0.460 Test Loss: 1.774 Test Acc: 0.460
Validation loss decreased (-0.436648 --> -0.459982).  Saving model ...
Epoch: 10 cost time: 6.123858690261841
Epoch: 10, Steps: 18 | Train Loss: 0.052 Vali Loss: 1.715 Vali Acc: 0.497 Test Loss: 1.715 Test Acc: 0.497
Validation loss decreased (-0.459982 --> -0.496650).  Saving model ...
Epoch: 11 cost time: 6.815463542938232
Epoch: 11, Steps: 18 | Train Loss: 0.033 Vali Loss: 1.664 Vali Acc: 0.513 Test Loss: 1.664 Test Acc: 0.513
Validation loss decreased (-0.496650 --> -0.513317).  Saving model ...
Epoch: 12 cost time: 7.071457624435425
Epoch: 12, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.625 Vali Acc: 0.517 Test Loss: 1.625 Test Acc: 0.517
Validation loss decreased (-0.513317 --> -0.516650).  Saving model ...
Epoch: 13 cost time: 6.222083568572998
Epoch: 13, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.589 Vali Acc: 0.500 Test Loss: 1.589 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.022852182388306
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.568 Vali Acc: 0.533 Test Loss: 1.568 Test Acc: 0.533
Validation loss decreased (-0.516650 --> -0.533318).  Saving model ...
Epoch: 15 cost time: 5.621145009994507
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.542 Vali Acc: 0.530 Test Loss: 1.542 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.115946054458618
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.530 Vali Acc: 0.553 Test Loss: 1.530 Test Acc: 0.553
Validation loss decreased (-0.533318 --> -0.553318).  Saving model ...
Epoch: 17 cost time: 6.397722482681274
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.508 Vali Acc: 0.540 Test Loss: 1.508 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.8665618896484375
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.492 Vali Acc: 0.557 Test Loss: 1.492 Test Acc: 0.557
Validation loss decreased (-0.553318 --> -0.556652).  Saving model ...
Epoch: 19 cost time: 6.778263568878174
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.478 Vali Acc: 0.547 Test Loss: 1.478 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.249785423278809
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.459 Vali Acc: 0.563 Test Loss: 1.459 Test Acc: 0.563
Validation loss decreased (-0.556652 --> -0.563319).  Saving model ...
Epoch: 21 cost time: 6.244797706604004
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.447 Vali Acc: 0.557 Test Loss: 1.447 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.5351362228393555
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.434 Vali Acc: 0.567 Test Loss: 1.434 Test Acc: 0.567
Validation loss decreased (-0.563319 --> -0.566652).  Saving model ...
Epoch: 23 cost time: 6.598776340484619
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.425 Vali Acc: 0.573 Test Loss: 1.425 Test Acc: 0.573
Validation loss decreased (-0.566652 --> -0.573319).  Saving model ...
Epoch: 24 cost time: 6.304682493209839
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.415 Vali Acc: 0.573 Test Loss: 1.415 Test Acc: 0.573
Validation loss decreased (-0.573319 --> -0.573319).  Saving model ...
Epoch: 25 cost time: 6.272725343704224
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.406 Vali Acc: 0.577 Test Loss: 1.406 Test Acc: 0.577
Validation loss decreased (-0.573319 --> -0.576653).  Saving model ...
Epoch: 26 cost time: 5.962872743606567
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.396 Vali Acc: 0.590 Test Loss: 1.396 Test Acc: 0.590
Validation loss decreased (-0.576653 --> -0.589986).  Saving model ...
Epoch: 27 cost time: 6.428657531738281
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.389 Vali Acc: 0.593 Test Loss: 1.389 Test Acc: 0.593
Validation loss decreased (-0.589986 --> -0.593319).  Saving model ...
Epoch: 28 cost time: 6.78551721572876
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.382 Vali Acc: 0.600 Test Loss: 1.382 Test Acc: 0.600
Validation loss decreased (-0.593319 --> -0.599986).  Saving model ...
Epoch: 29 cost time: 6.138447284698486
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.376 Vali Acc: 0.590 Test Loss: 1.376 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.088136911392212
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.372 Vali Acc: 0.587 Test Loss: 1.372 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.995652914047241
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.364 Vali Acc: 0.587 Test Loss: 1.364 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 6.327903985977173
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.358 Vali Acc: 0.593 Test Loss: 1.358 Test Acc: 0.593
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 6.257954835891724
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.348 Vali Acc: 0.603 Test Loss: 1.348 Test Acc: 0.603
Validation loss decreased (-0.599986 --> -0.603320).  Saving model ...
Epoch: 34 cost time: 6.60155725479126
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.347 Vali Acc: 0.600 Test Loss: 1.347 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.397499322891235
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.339 Vali Acc: 0.603 Test Loss: 1.339 Test Acc: 0.603
Validation loss decreased (-0.603320 --> -0.603320).  Saving model ...
Epoch: 36 cost time: 6.3970465660095215
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.335 Vali Acc: 0.600 Test Loss: 1.335 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.091225624084473
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.324 Vali Acc: 0.607 Test Loss: 1.324 Test Acc: 0.607
Validation loss decreased (-0.603320 --> -0.606653).  Saving model ...
Epoch: 38 cost time: 5.838453054428101
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.315 Vali Acc: 0.613 Test Loss: 1.315 Test Acc: 0.613
Validation loss decreased (-0.606653 --> -0.613320).  Saving model ...
Epoch: 39 cost time: 6.031398773193359
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.313 Vali Acc: 0.610 Test Loss: 1.313 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.17926287651062
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.312 Vali Acc: 0.613 Test Loss: 1.312 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 41 cost time: 6.217058181762695
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.307 Vali Acc: 0.617 Test Loss: 1.307 Test Acc: 0.617
Validation loss decreased (-0.613320 --> -0.616654).  Saving model ...
Epoch: 42 cost time: 6.265146970748901
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.301 Vali Acc: 0.613 Test Loss: 1.301 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.213320016860962
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.300 Vali Acc: 0.613 Test Loss: 1.300 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 6.1944286823272705
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.295 Vali Acc: 0.617 Test Loss: 1.295 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616654).  Saving model ...
Epoch: 45 cost time: 6.228018283843994
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.293 Vali Acc: 0.617 Test Loss: 1.293 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616654).  Saving model ...
Epoch: 46 cost time: 6.258972644805908
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.290 Vali Acc: 0.617 Test Loss: 1.290 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616654).  Saving model ...
Epoch: 47 cost time: 6.779832124710083
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.613 Test Loss: 1.288 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 7.101184844970703
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.286 Vali Acc: 0.617 Test Loss: 1.286 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616654).  Saving model ...
Epoch: 49 cost time: 6.624539852142334
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.283 Vali Acc: 0.617 Test Loss: 1.283 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616654).  Saving model ...
Epoch: 50 cost time: 6.545615911483765
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.279 Vali Acc: 0.620 Test Loss: 1.279 Test Acc: 0.620
Validation loss decreased (-0.616654 --> -0.619987).  Saving model ...
Epoch: 51 cost time: 6.172810792922974
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.276 Vali Acc: 0.627 Test Loss: 1.276 Test Acc: 0.627
Validation loss decreased (-0.619987 --> -0.626654).  Saving model ...
Epoch: 52 cost time: 6.420311212539673
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.277 Vali Acc: 0.627 Test Loss: 1.277 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 6.1771838665008545
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.273 Vali Acc: 0.627 Test Loss: 1.273 Test Acc: 0.627
Validation loss decreased (-0.626654 --> -0.626654).  Saving model ...
Epoch: 54 cost time: 6.594996213912964
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.270 Vali Acc: 0.630 Test Loss: 1.270 Test Acc: 0.630
Validation loss decreased (-0.626654 --> -0.629987).  Saving model ...
Epoch: 55 cost time: 6.202252626419067
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.268 Vali Acc: 0.630 Test Loss: 1.268 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 56 cost time: 7.160096883773804
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.630 Test Loss: 1.263 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 57 cost time: 6.0369486808776855
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.261 Vali Acc: 0.630 Test Loss: 1.261 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 58 cost time: 5.772550106048584
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.633 Test Loss: 1.257 Test Acc: 0.633
Validation loss decreased (-0.629987 --> -0.633321).  Saving model ...
Epoch: 59 cost time: 5.796304941177368
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.633 Test Loss: 1.255 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633321).  Saving model ...
Epoch: 60 cost time: 5.747604846954346
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.637 Test Loss: 1.253 Test Acc: 0.637
Validation loss decreased (-0.633321 --> -0.636654).  Saving model ...
Epoch: 61 cost time: 6.613608360290527
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.640 Test Loss: 1.252 Test Acc: 0.640
Validation loss decreased (-0.636654 --> -0.639987).  Saving model ...
Epoch: 62 cost time: 6.372265815734863
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.640 Test Loss: 1.251 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639987).  Saving model ...
Epoch: 63 cost time: 6.401594877243042
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.637 Test Loss: 1.250 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.9980573654174805
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.633 Test Loss: 1.252 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 5.8583056926727295
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.637 Test Loss: 1.251 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 6.081684589385986
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.640 Test Loss: 1.250 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639988).  Saving model ...
Epoch: 67 cost time: 6.637883424758911
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.249 Vali Acc: 0.640 Test Loss: 1.249 Test Acc: 0.640
Validation loss decreased (-0.639988 --> -0.639988).  Saving model ...
Epoch: 68 cost time: 6.382474899291992
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.249 Vali Acc: 0.640 Test Loss: 1.249 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.727076530456543
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.643 Test Loss: 1.245 Test Acc: 0.643
Validation loss decreased (-0.639988 --> -0.643321).  Saving model ...
Epoch: 70 cost time: 6.3062944412231445
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.643 Test Loss: 1.242 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 71 cost time: 5.994527816772461
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.643 Test Loss: 1.240 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 72 cost time: 5.751172304153442
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.643 Test Loss: 1.236 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 73 cost time: 6.1545281410217285
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.643 Test Loss: 1.238 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 6.367234468460083
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.650 Test Loss: 1.238 Test Acc: 0.650
Validation loss decreased (-0.643321 --> -0.649988).  Saving model ...
Epoch: 75 cost time: 6.25513219833374
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.647 Test Loss: 1.236 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 6.121072292327881
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.235 Vali Acc: 0.653 Test Loss: 1.235 Test Acc: 0.653
Validation loss decreased (-0.649988 --> -0.653321).  Saving model ...
Epoch: 77 cost time: 6.057182550430298
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.650 Test Loss: 1.233 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 6.521410226821899
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.650 Test Loss: 1.233 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 5.874961853027344
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.650 Test Loss: 1.230 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 6.8504087924957275
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.647 Test Loss: 1.230 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 6.39633584022522
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.647 Test Loss: 1.230 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 6.44536566734314
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.653 Test Loss: 1.230 Test Acc: 0.653
Validation loss decreased (-0.653321 --> -0.653321).  Saving model ...
Epoch: 83 cost time: 6.206125736236572
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.657 Test Loss: 1.229 Test Acc: 0.657
Validation loss decreased (-0.653321 --> -0.656654).  Saving model ...
Epoch: 84 cost time: 6.161549806594849
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.650 Test Loss: 1.229 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 6.338510751724243
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.653 Test Loss: 1.228 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 5.733653783798218
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.653 Test Loss: 1.226 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 6.326967000961304
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.657 Test Loss: 1.225 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656654).  Saving model ...
Epoch: 88 cost time: 6.07663369178772
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.653 Test Loss: 1.227 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 6.087301731109619
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.653 Test Loss: 1.227 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 5.8731911182403564
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.653 Test Loss: 1.226 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 5.619847536087036
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.653 Test Loss: 1.226 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 6.319584608078003
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.650 Test Loss: 1.226 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 5.950376033782959
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.650 Test Loss: 1.226 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 6.130814552307129
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.650 Test Loss: 1.225 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 6.654472827911377
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.650 Test Loss: 1.226 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 6.212827444076538
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.650 Test Loss: 1.224 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 5.837472438812256
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.653 Test Loss: 1.228 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6566666666666666
model parameter : 595737
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.343114614486694
Epoch: 1, Steps: 18 | Train Loss: 3.263 Vali Loss: 3.217 Vali Acc: 0.050 Test Loss: 3.217 Test Acc: 0.050
Validation loss decreased (inf --> -0.049968).  Saving model ...
Epoch: 2 cost time: 6.041912078857422
Epoch: 2, Steps: 18 | Train Loss: 3.013 Vali Loss: 3.072 Vali Acc: 0.117 Test Loss: 3.072 Test Acc: 0.117
Validation loss decreased (-0.049968 --> -0.116636).  Saving model ...
Epoch: 3 cost time: 5.7933509349823
Epoch: 3, Steps: 18 | Train Loss: 2.571 Vali Loss: 2.908 Vali Acc: 0.200 Test Loss: 2.908 Test Acc: 0.200
Validation loss decreased (-0.116636 --> -0.199971).  Saving model ...
Epoch: 4 cost time: 6.425175905227661
Epoch: 4, Steps: 18 | Train Loss: 2.056 Vali Loss: 2.732 Vali Acc: 0.217 Test Loss: 2.732 Test Acc: 0.217
Validation loss decreased (-0.199971 --> -0.216639).  Saving model ...
Epoch: 5 cost time: 5.975872755050659
Epoch: 5, Steps: 18 | Train Loss: 1.497 Vali Loss: 2.583 Vali Acc: 0.283 Test Loss: 2.583 Test Acc: 0.283
Validation loss decreased (-0.216639 --> -0.283308).  Saving model ...
Epoch: 6 cost time: 6.007882118225098
Epoch: 6, Steps: 18 | Train Loss: 0.955 Vali Loss: 2.430 Vali Acc: 0.313 Test Loss: 2.430 Test Acc: 0.313
Validation loss decreased (-0.283308 --> -0.313309).  Saving model ...
Epoch: 7 cost time: 5.966736793518066
Epoch: 7, Steps: 18 | Train Loss: 0.556 Vali Loss: 2.336 Vali Acc: 0.317 Test Loss: 2.336 Test Acc: 0.317
Validation loss decreased (-0.313309 --> -0.316643).  Saving model ...
Epoch: 8 cost time: 6.220376968383789
Epoch: 8, Steps: 18 | Train Loss: 0.281 Vali Loss: 2.230 Vali Acc: 0.337 Test Loss: 2.230 Test Acc: 0.337
Validation loss decreased (-0.316643 --> -0.336644).  Saving model ...
Epoch: 9 cost time: 6.246246337890625
Epoch: 9, Steps: 18 | Train Loss: 0.134 Vali Loss: 2.179 Vali Acc: 0.363 Test Loss: 2.179 Test Acc: 0.363
Validation loss decreased (-0.336644 --> -0.363312).  Saving model ...
Epoch: 10 cost time: 6.157518148422241
Epoch: 10, Steps: 18 | Train Loss: 0.068 Vali Loss: 2.092 Vali Acc: 0.380 Test Loss: 2.092 Test Acc: 0.380
Validation loss decreased (-0.363312 --> -0.379979).  Saving model ...
Epoch: 11 cost time: 6.6015424728393555
Epoch: 11, Steps: 18 | Train Loss: 0.039 Vali Loss: 2.047 Vali Acc: 0.393 Test Loss: 2.047 Test Acc: 0.393
Validation loss decreased (-0.379979 --> -0.393313).  Saving model ...
Epoch: 12 cost time: 6.796231746673584
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.986 Vali Acc: 0.397 Test Loss: 1.986 Test Acc: 0.397
Validation loss decreased (-0.393313 --> -0.396647).  Saving model ...
Epoch: 13 cost time: 6.057774305343628
Epoch: 13, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.959 Vali Acc: 0.427 Test Loss: 1.959 Test Acc: 0.427
Validation loss decreased (-0.396647 --> -0.426647).  Saving model ...
Epoch: 14 cost time: 6.297295093536377
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.932 Vali Acc: 0.437 Test Loss: 1.932 Test Acc: 0.437
Validation loss decreased (-0.426647 --> -0.436647).  Saving model ...
Epoch: 15 cost time: 6.053222179412842
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.897 Vali Acc: 0.427 Test Loss: 1.897 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.4765825271606445
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.870 Vali Acc: 0.433 Test Loss: 1.870 Test Acc: 0.433
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.257937908172607
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.840 Vali Acc: 0.453 Test Loss: 1.840 Test Acc: 0.453
Validation loss decreased (-0.436647 --> -0.453315).  Saving model ...
Epoch: 18 cost time: 5.9928717613220215
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.815 Vali Acc: 0.463 Test Loss: 1.815 Test Acc: 0.463
Validation loss decreased (-0.453315 --> -0.463315).  Saving model ...
Epoch: 19 cost time: 5.816206216812134
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.792 Vali Acc: 0.467 Test Loss: 1.792 Test Acc: 0.467
Validation loss decreased (-0.463315 --> -0.466649).  Saving model ...
Epoch: 20 cost time: 5.863388538360596
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.772 Vali Acc: 0.467 Test Loss: 1.772 Test Acc: 0.467
Validation loss decreased (-0.466649 --> -0.466649).  Saving model ...
Epoch: 21 cost time: 5.617553234100342
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.749 Vali Acc: 0.473 Test Loss: 1.749 Test Acc: 0.473
Validation loss decreased (-0.466649 --> -0.473316).  Saving model ...
Epoch: 22 cost time: 5.893979787826538
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.729 Vali Acc: 0.480 Test Loss: 1.729 Test Acc: 0.480
Validation loss decreased (-0.473316 --> -0.479983).  Saving model ...
Epoch: 23 cost time: 6.126816272735596
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.708 Vali Acc: 0.487 Test Loss: 1.708 Test Acc: 0.487
Validation loss decreased (-0.479983 --> -0.486650).  Saving model ...
Epoch: 24 cost time: 6.715654611587524
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.688 Vali Acc: 0.497 Test Loss: 1.688 Test Acc: 0.497
Validation loss decreased (-0.486650 --> -0.496650).  Saving model ...
Epoch: 25 cost time: 5.931677341461182
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.670 Vali Acc: 0.497 Test Loss: 1.670 Test Acc: 0.497
Validation loss decreased (-0.496650 --> -0.496650).  Saving model ...
Epoch: 26 cost time: 5.822676658630371
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.658 Vali Acc: 0.503 Test Loss: 1.658 Test Acc: 0.503
Validation loss decreased (-0.496650 --> -0.503317).  Saving model ...
Epoch: 27 cost time: 5.843589782714844
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.657 Vali Acc: 0.517 Test Loss: 1.657 Test Acc: 0.517
Validation loss decreased (-0.503317 --> -0.516650).  Saving model ...
Epoch: 28 cost time: 6.17809534072876
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.645 Vali Acc: 0.510 Test Loss: 1.645 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.7495973110198975
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.630 Vali Acc: 0.517 Test Loss: 1.630 Test Acc: 0.517
Validation loss decreased (-0.516650 --> -0.516650).  Saving model ...
Epoch: 30 cost time: 6.080321550369263
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.621 Vali Acc: 0.523 Test Loss: 1.621 Test Acc: 0.523
Validation loss decreased (-0.516650 --> -0.523317).  Saving model ...
Epoch: 31 cost time: 6.45626163482666
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.609 Vali Acc: 0.530 Test Loss: 1.609 Test Acc: 0.530
Validation loss decreased (-0.523317 --> -0.529984).  Saving model ...
Epoch: 32 cost time: 5.9309470653533936
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.605 Vali Acc: 0.530 Test Loss: 1.605 Test Acc: 0.530
Validation loss decreased (-0.529984 --> -0.529984).  Saving model ...
Epoch: 33 cost time: 5.920425176620483
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.597 Vali Acc: 0.530 Test Loss: 1.597 Test Acc: 0.530
Validation loss decreased (-0.529984 --> -0.529984).  Saving model ...
Epoch: 34 cost time: 6.117856502532959
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.588 Vali Acc: 0.540 Test Loss: 1.588 Test Acc: 0.540
Validation loss decreased (-0.529984 --> -0.539984).  Saving model ...
Epoch: 35 cost time: 6.565510511398315
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.572 Vali Acc: 0.547 Test Loss: 1.572 Test Acc: 0.547
Validation loss decreased (-0.539984 --> -0.546651).  Saving model ...
Epoch: 36 cost time: 6.450144529342651
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.564 Vali Acc: 0.537 Test Loss: 1.564 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.623710870742798
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.559 Vali Acc: 0.543 Test Loss: 1.559 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 6.625198602676392
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.551 Vali Acc: 0.543 Test Loss: 1.551 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 6.109771013259888
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.549 Vali Acc: 0.540 Test Loss: 1.549 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 5.731051921844482
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.543 Vali Acc: 0.547 Test Loss: 1.543 Test Acc: 0.547
Validation loss decreased (-0.546651 --> -0.546651).  Saving model ...
Epoch: 41 cost time: 6.173594951629639
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.538 Vali Acc: 0.557 Test Loss: 1.538 Test Acc: 0.557
Validation loss decreased (-0.546651 --> -0.556651).  Saving model ...
Epoch: 42 cost time: 6.365894079208374
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.525 Vali Acc: 0.553 Test Loss: 1.525 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.324292898178101
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.519 Vali Acc: 0.570 Test Loss: 1.519 Test Acc: 0.570
Validation loss decreased (-0.556651 --> -0.569985).  Saving model ...
Epoch: 44 cost time: 6.295796632766724
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.518 Vali Acc: 0.573 Test Loss: 1.518 Test Acc: 0.573
Validation loss decreased (-0.569985 --> -0.573318).  Saving model ...
Epoch: 45 cost time: 5.847137451171875
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.513 Vali Acc: 0.563 Test Loss: 1.513 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.979390621185303
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.508 Vali Acc: 0.577 Test Loss: 1.508 Test Acc: 0.577
Validation loss decreased (-0.573318 --> -0.576652).  Saving model ...
Epoch: 47 cost time: 6.073583364486694
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.506 Vali Acc: 0.567 Test Loss: 1.506 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 6.419185400009155
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.500 Vali Acc: 0.573 Test Loss: 1.500 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 6.233394384384155
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.496 Vali Acc: 0.577 Test Loss: 1.496 Test Acc: 0.577
Validation loss decreased (-0.576652 --> -0.576652).  Saving model ...
Epoch: 50 cost time: 6.6838579177856445
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.489 Vali Acc: 0.577 Test Loss: 1.489 Test Acc: 0.577
Validation loss decreased (-0.576652 --> -0.576652).  Saving model ...
Epoch: 51 cost time: 5.93147611618042
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.485 Vali Acc: 0.573 Test Loss: 1.485 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.5344038009643555
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.481 Vali Acc: 0.573 Test Loss: 1.481 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 5.673432111740112
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.478 Vali Acc: 0.577 Test Loss: 1.478 Test Acc: 0.577
Validation loss decreased (-0.576652 --> -0.576652).  Saving model ...
Epoch: 54 cost time: 5.913089036941528
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.577 Test Loss: 1.475 Test Acc: 0.577
Validation loss decreased (-0.576652 --> -0.576652).  Saving model ...
Epoch: 55 cost time: 6.452247619628906
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.567 Test Loss: 1.477 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 6.657453298568726
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.580 Test Loss: 1.474 Test Acc: 0.580
Validation loss decreased (-0.576652 --> -0.579985).  Saving model ...
Epoch: 57 cost time: 6.609426975250244
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.472 Vali Acc: 0.593 Test Loss: 1.472 Test Acc: 0.593
Validation loss decreased (-0.579985 --> -0.593319).  Saving model ...
Epoch: 58 cost time: 5.699536561965942
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.593 Test Loss: 1.468 Test Acc: 0.593
Validation loss decreased (-0.593319 --> -0.593319).  Saving model ...
Epoch: 59 cost time: 6.177480459213257
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.590 Test Loss: 1.460 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.816333532333374
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.587 Test Loss: 1.454 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 6.120019435882568
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.590 Test Loss: 1.445 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 6.383341312408447
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.593 Test Loss: 1.443 Test Acc: 0.593
Validation loss decreased (-0.593319 --> -0.593319).  Saving model ...
Epoch: 63 cost time: 6.583531618118286
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.593 Test Loss: 1.440 Test Acc: 0.593
Validation loss decreased (-0.593319 --> -0.593319).  Saving model ...
Epoch: 64 cost time: 6.185073614120483
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.446 Vali Acc: 0.587 Test Loss: 1.446 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 6.132157802581787
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.593 Test Loss: 1.442 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 6.133256196975708
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.600 Test Loss: 1.437 Test Acc: 0.600
Validation loss decreased (-0.593319 --> -0.599986).  Saving model ...
Epoch: 67 cost time: 6.219595909118652
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.597 Test Loss: 1.434 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 6.360231399536133
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.587 Test Loss: 1.436 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 6.484160900115967
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.587 Test Loss: 1.434 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 6.391809701919556
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.587 Test Loss: 1.429 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 6.255720376968384
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.590 Test Loss: 1.424 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 6.284036874771118
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.600 Test Loss: 1.423 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 73 cost time: 6.14289665222168
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.603 Test Loss: 1.424 Test Acc: 0.603
Validation loss decreased (-0.599986 --> -0.603319).  Saving model ...
Epoch: 74 cost time: 6.635343790054321
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.610 Test Loss: 1.422 Test Acc: 0.610
Validation loss decreased (-0.603319 --> -0.609986).  Saving model ...
Epoch: 75 cost time: 6.487714767456055
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.600 Test Loss: 1.419 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 6.282147645950317
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.607 Test Loss: 1.416 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 5.73501181602478
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.610 Test Loss: 1.414 Test Acc: 0.610
Validation loss decreased (-0.609986 --> -0.609986).  Saving model ...
Epoch: 78 cost time: 5.62511134147644
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.613 Test Loss: 1.411 Test Acc: 0.613
Validation loss decreased (-0.609986 --> -0.613319).  Saving model ...
Epoch: 79 cost time: 5.756530046463013
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.613 Test Loss: 1.407 Test Acc: 0.613
Validation loss decreased (-0.613319 --> -0.613319).  Saving model ...
Epoch: 80 cost time: 5.739121675491333
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.613 Test Loss: 1.405 Test Acc: 0.613
Validation loss decreased (-0.613319 --> -0.613319).  Saving model ...
Epoch: 81 cost time: 6.108192205429077
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.617 Test Loss: 1.404 Test Acc: 0.617
Validation loss decreased (-0.613319 --> -0.616653).  Saving model ...
Epoch: 82 cost time: 6.54555082321167
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.617 Test Loss: 1.399 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616653).  Saving model ...
Epoch: 83 cost time: 6.59916353225708
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.620 Test Loss: 1.398 Test Acc: 0.620
Validation loss decreased (-0.616653 --> -0.619986).  Saving model ...
Epoch: 84 cost time: 6.189767599105835
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.620 Test Loss: 1.397 Test Acc: 0.620
Validation loss decreased (-0.619986 --> -0.619986).  Saving model ...
Epoch: 85 cost time: 6.243055582046509
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.623 Test Loss: 1.395 Test Acc: 0.623
Validation loss decreased (-0.619986 --> -0.623319).  Saving model ...
Epoch: 86 cost time: 6.193394422531128
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.623 Test Loss: 1.392 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 87 cost time: 6.302788734436035
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.623 Test Loss: 1.390 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 88 cost time: 6.48689866065979
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.623 Test Loss: 1.386 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 89 cost time: 6.692062854766846
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.623 Test Loss: 1.385 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 90 cost time: 6.3259806632995605
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.623 Test Loss: 1.384 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623319).  Saving model ...
Epoch: 91 cost time: 5.784565687179565
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.620 Test Loss: 1.382 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 5.786030530929565
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.623 Test Loss: 1.382 Test Acc: 0.623
Validation loss decreased (-0.623319 --> -0.623320).  Saving model ...
Epoch: 93 cost time: 5.495328664779663
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.623 Test Loss: 1.383 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 5.973283767700195
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.623 Test Loss: 1.382 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 6.451279640197754
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.627 Test Loss: 1.382 Test Acc: 0.627
Validation loss decreased (-0.623320 --> -0.626653).  Saving model ...
Epoch: 96 cost time: 6.223858118057251
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.623 Test Loss: 1.382 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 6.381985902786255
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.627 Test Loss: 1.382 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 98 cost time: 6.304532289505005
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.623 Test Loss: 1.380 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 5.901343822479248
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.623 Test Loss: 1.380 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 6.018026113510132
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.627 Test Loss: 1.377 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6266666666666667
model parameter : 595737
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.975893974304199
Epoch: 1, Steps: 18 | Train Loss: 3.244 Vali Loss: 3.252 Vali Acc: 0.060 Test Loss: 3.252 Test Acc: 0.060
Validation loss decreased (inf --> -0.059967).  Saving model ...
Epoch: 2 cost time: 6.959705114364624
Epoch: 2, Steps: 18 | Train Loss: 3.004 Vali Loss: 3.166 Vali Acc: 0.090 Test Loss: 3.166 Test Acc: 0.090
Validation loss decreased (-0.059967 --> -0.089968).  Saving model ...
Epoch: 3 cost time: 6.018584489822388
Epoch: 3, Steps: 18 | Train Loss: 2.636 Vali Loss: 3.079 Vali Acc: 0.113 Test Loss: 3.079 Test Acc: 0.113
Validation loss decreased (-0.089968 --> -0.113303).  Saving model ...
Epoch: 4 cost time: 5.7133893966674805
Epoch: 4, Steps: 18 | Train Loss: 2.130 Vali Loss: 2.978 Vali Acc: 0.130 Test Loss: 2.978 Test Acc: 0.130
Validation loss decreased (-0.113303 --> -0.129970).  Saving model ...
Epoch: 5 cost time: 6.051722764968872
Epoch: 5, Steps: 18 | Train Loss: 1.600 Vali Loss: 2.876 Vali Acc: 0.140 Test Loss: 2.876 Test Acc: 0.140
Validation loss decreased (-0.129970 --> -0.139971).  Saving model ...
Epoch: 6 cost time: 6.3215343952178955
Epoch: 6, Steps: 18 | Train Loss: 1.067 Vali Loss: 2.805 Vali Acc: 0.150 Test Loss: 2.805 Test Acc: 0.150
Validation loss decreased (-0.139971 --> -0.149972).  Saving model ...
Epoch: 7 cost time: 6.217933416366577
Epoch: 7, Steps: 18 | Train Loss: 0.666 Vali Loss: 2.726 Vali Acc: 0.167 Test Loss: 2.726 Test Acc: 0.167
Validation loss decreased (-0.149972 --> -0.166639).  Saving model ...
Epoch: 8 cost time: 6.160158634185791
Epoch: 8, Steps: 18 | Train Loss: 0.389 Vali Loss: 2.660 Vali Acc: 0.180 Test Loss: 2.660 Test Acc: 0.180
Validation loss decreased (-0.166639 --> -0.179973).  Saving model ...
Epoch: 9 cost time: 6.087501764297485
Epoch: 9, Steps: 18 | Train Loss: 0.196 Vali Loss: 2.622 Vali Acc: 0.190 Test Loss: 2.622 Test Acc: 0.190
Validation loss decreased (-0.179973 --> -0.189974).  Saving model ...
Epoch: 10 cost time: 6.097790479660034
Epoch: 10, Steps: 18 | Train Loss: 0.098 Vali Loss: 2.494 Vali Acc: 0.210 Test Loss: 2.494 Test Acc: 0.210
Validation loss decreased (-0.189974 --> -0.209975).  Saving model ...
Epoch: 11 cost time: 5.766342401504517
Epoch: 11, Steps: 18 | Train Loss: 0.054 Vali Loss: 2.428 Vali Acc: 0.240 Test Loss: 2.428 Test Acc: 0.240
Validation loss decreased (-0.209975 --> -0.239976).  Saving model ...
Epoch: 12 cost time: 5.983032941818237
Epoch: 12, Steps: 18 | Train Loss: 0.039 Vali Loss: 2.347 Vali Acc: 0.263 Test Loss: 2.347 Test Acc: 0.263
Validation loss decreased (-0.239976 --> -0.263310).  Saving model ...
Epoch: 13 cost time: 5.977842330932617
Epoch: 13, Steps: 18 | Train Loss: 0.029 Vali Loss: 2.301 Vali Acc: 0.277 Test Loss: 2.301 Test Acc: 0.277
Validation loss decreased (-0.263310 --> -0.276644).  Saving model ...
Epoch: 14 cost time: 5.971962213516235
Epoch: 14, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.266 Vali Acc: 0.280 Test Loss: 2.266 Test Acc: 0.280
Validation loss decreased (-0.276644 --> -0.279977).  Saving model ...
Epoch: 15 cost time: 6.133393049240112
Epoch: 15, Steps: 18 | Train Loss: 0.019 Vali Loss: 2.221 Vali Acc: 0.307 Test Loss: 2.221 Test Acc: 0.307
Validation loss decreased (-0.279977 --> -0.306644).  Saving model ...
Epoch: 16 cost time: 6.340460777282715
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 2.175 Vali Acc: 0.330 Test Loss: 2.175 Test Acc: 0.330
Validation loss decreased (-0.306644 --> -0.329978).  Saving model ...
Epoch: 17 cost time: 6.503160238265991
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.145 Vali Acc: 0.327 Test Loss: 2.145 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.43243932723999
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.116 Vali Acc: 0.343 Test Loss: 2.116 Test Acc: 0.343
Validation loss decreased (-0.329978 --> -0.343312).  Saving model ...
Epoch: 19 cost time: 6.008626461029053
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.079 Vali Acc: 0.363 Test Loss: 2.079 Test Acc: 0.363
Validation loss decreased (-0.343312 --> -0.363313).  Saving model ...
Epoch: 20 cost time: 5.778551816940308
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.034 Vali Acc: 0.390 Test Loss: 2.034 Test Acc: 0.390
Validation loss decreased (-0.363313 --> -0.389980).  Saving model ...
Epoch: 21 cost time: 5.8157501220703125
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.006 Vali Acc: 0.407 Test Loss: 2.006 Test Acc: 0.407
Validation loss decreased (-0.389980 --> -0.406647).  Saving model ...
Epoch: 22 cost time: 6.074496507644653
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.986 Vali Acc: 0.410 Test Loss: 1.986 Test Acc: 0.410
Validation loss decreased (-0.406647 --> -0.409980).  Saving model ...
Epoch: 23 cost time: 6.301489591598511
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.951 Vali Acc: 0.423 Test Loss: 1.951 Test Acc: 0.423
Validation loss decreased (-0.409980 --> -0.423314).  Saving model ...
Epoch: 24 cost time: 6.1559741497039795
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.925 Vali Acc: 0.437 Test Loss: 1.925 Test Acc: 0.437
Validation loss decreased (-0.423314 --> -0.436647).  Saving model ...
Epoch: 25 cost time: 6.230073690414429
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.900 Vali Acc: 0.453 Test Loss: 1.900 Test Acc: 0.453
Validation loss decreased (-0.436647 --> -0.453314).  Saving model ...
Epoch: 26 cost time: 6.383161544799805
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.888 Vali Acc: 0.457 Test Loss: 1.888 Test Acc: 0.457
Validation loss decreased (-0.453314 --> -0.456648).  Saving model ...
Epoch: 27 cost time: 6.140784740447998
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.877 Vali Acc: 0.460 Test Loss: 1.877 Test Acc: 0.460
Validation loss decreased (-0.456648 --> -0.459981).  Saving model ...
Epoch: 28 cost time: 6.204799652099609
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.849 Vali Acc: 0.473 Test Loss: 1.849 Test Acc: 0.473
Validation loss decreased (-0.459981 --> -0.473315).  Saving model ...
Epoch: 29 cost time: 6.08147931098938
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.838 Vali Acc: 0.477 Test Loss: 1.838 Test Acc: 0.477
Validation loss decreased (-0.473315 --> -0.476648).  Saving model ...
Epoch: 30 cost time: 6.714802265167236
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.813 Vali Acc: 0.480 Test Loss: 1.813 Test Acc: 0.480
Validation loss decreased (-0.476648 --> -0.479982).  Saving model ...
Epoch: 31 cost time: 6.849042654037476
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.799 Vali Acc: 0.493 Test Loss: 1.799 Test Acc: 0.493
Validation loss decreased (-0.479982 --> -0.493315).  Saving model ...
Epoch: 32 cost time: 6.752407550811768
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.795 Vali Acc: 0.500 Test Loss: 1.795 Test Acc: 0.500
Validation loss decreased (-0.493315 --> -0.499982).  Saving model ...
Epoch: 33 cost time: 6.35957932472229
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.784 Vali Acc: 0.507 Test Loss: 1.784 Test Acc: 0.507
Validation loss decreased (-0.499982 --> -0.506649).  Saving model ...
Epoch: 34 cost time: 6.295732021331787
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.770 Vali Acc: 0.507 Test Loss: 1.770 Test Acc: 0.507
Validation loss decreased (-0.506649 --> -0.506649).  Saving model ...
Epoch: 35 cost time: 6.151093482971191
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.752 Vali Acc: 0.520 Test Loss: 1.752 Test Acc: 0.520
Validation loss decreased (-0.506649 --> -0.519982).  Saving model ...
Epoch: 36 cost time: 5.857252359390259
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.739 Vali Acc: 0.510 Test Loss: 1.739 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.608582973480225
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.722 Vali Acc: 0.520 Test Loss: 1.722 Test Acc: 0.520
Validation loss decreased (-0.519982 --> -0.519983).  Saving model ...
Epoch: 38 cost time: 6.261303424835205
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.705 Vali Acc: 0.523 Test Loss: 1.705 Test Acc: 0.523
Validation loss decreased (-0.519983 --> -0.523316).  Saving model ...
Epoch: 39 cost time: 6.26857328414917
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.696 Vali Acc: 0.527 Test Loss: 1.696 Test Acc: 0.527
Validation loss decreased (-0.523316 --> -0.526650).  Saving model ...
Epoch: 40 cost time: 5.805618762969971
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.696 Vali Acc: 0.550 Test Loss: 1.696 Test Acc: 0.550
Validation loss decreased (-0.526650 --> -0.549983).  Saving model ...
Epoch: 41 cost time: 6.2807183265686035
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.694 Vali Acc: 0.547 Test Loss: 1.694 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.182980537414551
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.547 Test Loss: 1.688 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 5.945396661758423
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.682 Vali Acc: 0.547 Test Loss: 1.682 Test Acc: 0.547
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 6.56645393371582
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.675 Vali Acc: 0.543 Test Loss: 1.675 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 6.342612028121948
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.671 Vali Acc: 0.543 Test Loss: 1.671 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 6.151487112045288
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.661 Vali Acc: 0.547 Test Loss: 1.661 Test Acc: 0.547
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 5.5391645431518555
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.656 Vali Acc: 0.557 Test Loss: 1.656 Test Acc: 0.557
Validation loss decreased (-0.549983 --> -0.556650).  Saving model ...
Epoch: 48 cost time: 5.593835830688477
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.649 Vali Acc: 0.550 Test Loss: 1.649 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.885915756225586
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.644 Vali Acc: 0.547 Test Loss: 1.644 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 5.782555103302002
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.636 Vali Acc: 0.547 Test Loss: 1.636 Test Acc: 0.547
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.24606990814209
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.553 Test Loss: 1.630 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 6.120086193084717
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.624 Vali Acc: 0.560 Test Loss: 1.624 Test Acc: 0.560
Validation loss decreased (-0.556650 --> -0.559984).  Saving model ...
Epoch: 53 cost time: 6.37352180480957
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.623 Vali Acc: 0.553 Test Loss: 1.623 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.2937421798706055
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.621 Vali Acc: 0.557 Test Loss: 1.621 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.257607460021973
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.613 Vali Acc: 0.557 Test Loss: 1.613 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 6.384869813919067
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.557 Test Loss: 1.606 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 6.564090251922607
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.567 Test Loss: 1.601 Test Acc: 0.567
Validation loss decreased (-0.559984 --> -0.566651).  Saving model ...
Epoch: 58 cost time: 6.433992147445679
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.567 Test Loss: 1.601 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 59 cost time: 6.464319229125977
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.595 Vali Acc: 0.570 Test Loss: 1.595 Test Acc: 0.570
Validation loss decreased (-0.566651 --> -0.569984).  Saving model ...
Epoch: 60 cost time: 6.2883172035217285
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.588 Vali Acc: 0.567 Test Loss: 1.588 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 5.71939754486084
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.584 Vali Acc: 0.570 Test Loss: 1.584 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 62 cost time: 5.96107029914856
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.582 Vali Acc: 0.573 Test Loss: 1.582 Test Acc: 0.573
Validation loss decreased (-0.569984 --> -0.573318).  Saving model ...
Epoch: 63 cost time: 5.897764682769775
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.580 Test Loss: 1.576 Test Acc: 0.580
Validation loss decreased (-0.573318 --> -0.579984).  Saving model ...
Epoch: 64 cost time: 6.148134708404541
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.583 Test Loss: 1.578 Test Acc: 0.583
Validation loss decreased (-0.579984 --> -0.583318).  Saving model ...
Epoch: 65 cost time: 6.132314443588257
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.590 Test Loss: 1.574 Test Acc: 0.590
Validation loss decreased (-0.583318 --> -0.589984).  Saving model ...
Epoch: 66 cost time: 6.278567552566528
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.568 Vali Acc: 0.597 Test Loss: 1.568 Test Acc: 0.597
Validation loss decreased (-0.589984 --> -0.596651).  Saving model ...
Epoch: 67 cost time: 6.087162733078003
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.593 Test Loss: 1.566 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 5.901424407958984
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.564 Vali Acc: 0.593 Test Loss: 1.564 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 5.821627616882324
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.560 Vali Acc: 0.587 Test Loss: 1.560 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 5.856267213821411
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.555 Vali Acc: 0.590 Test Loss: 1.555 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 6.454874515533447
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.590 Test Loss: 1.551 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 6.438087463378906
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.590 Test Loss: 1.550 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 6.502401828765869
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.593 Test Loss: 1.549 Test Acc: 0.593
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 6.136033773422241
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.546 Vali Acc: 0.593 Test Loss: 1.546 Test Acc: 0.593
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 5.85727071762085
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.542 Vali Acc: 0.597 Test Loss: 1.542 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 76 cost time: 6.055696964263916
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.600 Test Loss: 1.535 Test Acc: 0.600
Validation loss decreased (-0.596651 --> -0.599985).  Saving model ...
Epoch: 77 cost time: 5.8790602684021
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.597 Test Loss: 1.531 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 6.370455980300903
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.600 Test Loss: 1.530 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599985).  Saving model ...
Epoch: 79 cost time: 6.138174772262573
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.600 Test Loss: 1.530 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599985).  Saving model ...
Epoch: 80 cost time: 6.23683500289917
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.597 Test Loss: 1.529 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 6.236024856567383
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.597 Test Loss: 1.529 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 5.9192869663238525
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.597 Test Loss: 1.526 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 5.688629627227783
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.597 Test Loss: 1.523 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 6.280587673187256
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.603 Test Loss: 1.520 Test Acc: 0.603
Validation loss decreased (-0.599985 --> -0.603318).  Saving model ...
Epoch: 85 cost time: 6.49931788444519
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.603 Test Loss: 1.522 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 6.413665294647217
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.603 Test Loss: 1.517 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 87 cost time: 6.632437705993652
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.600 Test Loss: 1.515 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 6.281774520874023
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.597 Test Loss: 1.512 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 6.100224494934082
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.597 Test Loss: 1.508 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 6.131190061569214
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.603 Test Loss: 1.505 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 91 cost time: 6.682199716567993
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.603 Test Loss: 1.504 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 92 cost time: 6.14066743850708
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.603 Test Loss: 1.503 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 93 cost time: 6.5771331787109375
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.603 Test Loss: 1.501 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 94 cost time: 6.438615798950195
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.603 Test Loss: 1.496 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 95 cost time: 6.055649757385254
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.607 Test Loss: 1.494 Test Acc: 0.607
Validation loss decreased (-0.603318 --> -0.606652).  Saving model ...
Epoch: 96 cost time: 6.287799835205078
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.603 Test Loss: 1.492 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 6.178011655807495
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.607 Test Loss: 1.493 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606652).  Saving model ...
Epoch: 98 cost time: 6.072786331176758
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.491 Vali Acc: 0.613 Test Loss: 1.491 Test Acc: 0.613
Validation loss decreased (-0.606652 --> -0.613318).  Saving model ...
Epoch: 99 cost time: 6.107269525527954
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.613 Test Loss: 1.489 Test Acc: 0.613
Validation loss decreased (-0.613318 --> -0.613318).  Saving model ...
Epoch: 100 cost time: 6.129076242446899
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.487 Vali Acc: 0.617 Test Loss: 1.487 Test Acc: 0.617
Validation loss decreased (-0.613318 --> -0.616652).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6166666666666667
model parameter : 595737
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.886430740356445
Epoch: 1, Steps: 18 | Train Loss: 3.226 Vali Loss: 3.251 Vali Acc: 0.043 Test Loss: 3.251 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 5.700562238693237
Epoch: 2, Steps: 18 | Train Loss: 3.077 Vali Loss: 3.173 Vali Acc: 0.070 Test Loss: 3.173 Test Acc: 0.070
Validation loss decreased (-0.043301 --> -0.069968).  Saving model ...
Epoch: 3 cost time: 5.881568193435669
Epoch: 3, Steps: 18 | Train Loss: 2.725 Vali Loss: 3.094 Vali Acc: 0.107 Test Loss: 3.094 Test Acc: 0.107
Validation loss decreased (-0.069968 --> -0.106636).  Saving model ...
Epoch: 4 cost time: 6.434784412384033
Epoch: 4, Steps: 18 | Train Loss: 2.269 Vali Loss: 2.989 Vali Acc: 0.120 Test Loss: 2.989 Test Acc: 0.120
Validation loss decreased (-0.106636 --> -0.119970).  Saving model ...
Epoch: 5 cost time: 6.342371702194214
Epoch: 5, Steps: 18 | Train Loss: 1.845 Vali Loss: 2.885 Vali Acc: 0.140 Test Loss: 2.885 Test Acc: 0.140
Validation loss decreased (-0.119970 --> -0.139971).  Saving model ...
Epoch: 6 cost time: 6.504039764404297
Epoch: 6, Steps: 18 | Train Loss: 1.335 Vali Loss: 2.810 Vali Acc: 0.183 Test Loss: 2.810 Test Acc: 0.183
Validation loss decreased (-0.139971 --> -0.183305).  Saving model ...
Epoch: 7 cost time: 6.534856796264648
Epoch: 7, Steps: 18 | Train Loss: 0.895 Vali Loss: 2.707 Vali Acc: 0.180 Test Loss: 2.707 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.257328987121582
Epoch: 8, Steps: 18 | Train Loss: 0.566 Vali Loss: 2.592 Vali Acc: 0.233 Test Loss: 2.592 Test Acc: 0.233
Validation loss decreased (-0.183305 --> -0.233307).  Saving model ...
Epoch: 9 cost time: 6.634762287139893
Epoch: 9, Steps: 18 | Train Loss: 0.326 Vali Loss: 2.488 Vali Acc: 0.247 Test Loss: 2.488 Test Acc: 0.247
Validation loss decreased (-0.233307 --> -0.246642).  Saving model ...
Epoch: 10 cost time: 6.544722557067871
Epoch: 10, Steps: 18 | Train Loss: 0.177 Vali Loss: 2.332 Vali Acc: 0.267 Test Loss: 2.332 Test Acc: 0.267
Validation loss decreased (-0.246642 --> -0.266643).  Saving model ...
Epoch: 11 cost time: 6.40896463394165
Epoch: 11, Steps: 18 | Train Loss: 0.099 Vali Loss: 2.262 Vali Acc: 0.310 Test Loss: 2.262 Test Acc: 0.310
Validation loss decreased (-0.266643 --> -0.309977).  Saving model ...
Epoch: 12 cost time: 6.569512128829956
Epoch: 12, Steps: 18 | Train Loss: 0.060 Vali Loss: 2.193 Vali Acc: 0.327 Test Loss: 2.193 Test Acc: 0.327
Validation loss decreased (-0.309977 --> -0.326645).  Saving model ...
Epoch: 13 cost time: 6.3379967212677
Epoch: 13, Steps: 18 | Train Loss: 0.044 Vali Loss: 2.106 Vali Acc: 0.337 Test Loss: 2.106 Test Acc: 0.337
Validation loss decreased (-0.326645 --> -0.336646).  Saving model ...
Epoch: 14 cost time: 5.963221549987793
Epoch: 14, Steps: 18 | Train Loss: 0.031 Vali Loss: 2.103 Vali Acc: 0.347 Test Loss: 2.103 Test Acc: 0.347
Validation loss decreased (-0.336646 --> -0.346646).  Saving model ...
Epoch: 15 cost time: 5.884922981262207
Epoch: 15, Steps: 18 | Train Loss: 0.023 Vali Loss: 2.049 Vali Acc: 0.360 Test Loss: 2.049 Test Acc: 0.360
Validation loss decreased (-0.346646 --> -0.359980).  Saving model ...
Epoch: 16 cost time: 6.112713098526001
Epoch: 16, Steps: 18 | Train Loss: 0.018 Vali Loss: 2.002 Vali Acc: 0.367 Test Loss: 2.002 Test Acc: 0.367
Validation loss decreased (-0.359980 --> -0.366647).  Saving model ...
Epoch: 17 cost time: 6.6934404373168945
Epoch: 17, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.992 Vali Acc: 0.380 Test Loss: 1.992 Test Acc: 0.380
Validation loss decreased (-0.366647 --> -0.379980).  Saving model ...
Epoch: 18 cost time: 6.388438701629639
Epoch: 18, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.990 Vali Acc: 0.400 Test Loss: 1.990 Test Acc: 0.400
Validation loss decreased (-0.379980 --> -0.399980).  Saving model ...
Epoch: 19 cost time: 6.328434944152832
Epoch: 19, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.974 Vali Acc: 0.400 Test Loss: 1.974 Test Acc: 0.400
Validation loss decreased (-0.399980 --> -0.399980).  Saving model ...
Epoch: 20 cost time: 6.465129852294922
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.950 Vali Acc: 0.397 Test Loss: 1.950 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.314888000488281
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.937 Vali Acc: 0.410 Test Loss: 1.937 Test Acc: 0.410
Validation loss decreased (-0.399980 --> -0.409981).  Saving model ...
Epoch: 22 cost time: 6.473640441894531
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.943 Vali Acc: 0.410 Test Loss: 1.943 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.2563159465789795
Epoch: 23, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.910 Vali Acc: 0.423 Test Loss: 1.910 Test Acc: 0.423
Validation loss decreased (-0.409981 --> -0.423314).  Saving model ...
Epoch: 24 cost time: 6.548631429672241
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.882 Vali Acc: 0.430 Test Loss: 1.882 Test Acc: 0.430
Validation loss decreased (-0.423314 --> -0.429981).  Saving model ...
Epoch: 25 cost time: 6.072770118713379
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.869 Vali Acc: 0.423 Test Loss: 1.869 Test Acc: 0.423
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.274652481079102
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.880 Vali Acc: 0.440 Test Loss: 1.880 Test Acc: 0.440
Validation loss decreased (-0.429981 --> -0.439981).  Saving model ...
Epoch: 27 cost time: 6.165450811386108
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.890 Vali Acc: 0.430 Test Loss: 1.890 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.655354261398315
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.862 Vali Acc: 0.427 Test Loss: 1.862 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.693121910095215
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.845 Vali Acc: 0.437 Test Loss: 1.845 Test Acc: 0.437
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.393603086471558
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.820 Vali Acc: 0.453 Test Loss: 1.820 Test Acc: 0.453
Validation loss decreased (-0.439981 --> -0.453315).  Saving model ...
Epoch: 31 cost time: 6.432364225387573
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.806 Vali Acc: 0.467 Test Loss: 1.806 Test Acc: 0.467
Validation loss decreased (-0.453315 --> -0.466649).  Saving model ...
Epoch: 32 cost time: 6.37750768661499
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.811 Vali Acc: 0.453 Test Loss: 1.811 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.262841701507568
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.806 Vali Acc: 0.447 Test Loss: 1.806 Test Acc: 0.447
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.975570201873779
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.795 Vali Acc: 0.457 Test Loss: 1.795 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.650919675827026
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.799 Vali Acc: 0.457 Test Loss: 1.799 Test Acc: 0.457
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 6.6898791790008545
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.789 Vali Acc: 0.457 Test Loss: 1.789 Test Acc: 0.457
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 6.0216240882873535
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.799 Vali Acc: 0.460 Test Loss: 1.799 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 6.74660325050354
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.789 Vali Acc: 0.467 Test Loss: 1.789 Test Acc: 0.467
Validation loss decreased (-0.466649 --> -0.466649).  Saving model ...
Epoch: 39 cost time: 6.377280950546265
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.784 Vali Acc: 0.470 Test Loss: 1.784 Test Acc: 0.470
Validation loss decreased (-0.466649 --> -0.469982).  Saving model ...
Epoch: 40 cost time: 6.256762742996216
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.780 Vali Acc: 0.470 Test Loss: 1.780 Test Acc: 0.470
Validation loss decreased (-0.469982 --> -0.469982).  Saving model ...
Epoch: 41 cost time: 6.354544162750244
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.762 Vali Acc: 0.467 Test Loss: 1.762 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.430659532546997
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.740 Vali Acc: 0.470 Test Loss: 1.740 Test Acc: 0.470
Validation loss decreased (-0.469982 --> -0.469983).  Saving model ...
Epoch: 43 cost time: 6.541102647781372
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.733 Vali Acc: 0.483 Test Loss: 1.733 Test Acc: 0.483
Validation loss decreased (-0.469983 --> -0.483316).  Saving model ...
Epoch: 44 cost time: 6.286935329437256
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.477 Test Loss: 1.734 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.987254858016968
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.728 Vali Acc: 0.487 Test Loss: 1.728 Test Acc: 0.487
Validation loss decreased (-0.483316 --> -0.486649).  Saving model ...
Epoch: 46 cost time: 6.100161790847778
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.728 Vali Acc: 0.487 Test Loss: 1.728 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.173224210739136
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.722 Vali Acc: 0.490 Test Loss: 1.722 Test Acc: 0.490
Validation loss decreased (-0.486649 --> -0.489983).  Saving model ...
Epoch: 48 cost time: 6.479002475738525
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.718 Vali Acc: 0.500 Test Loss: 1.718 Test Acc: 0.500
Validation loss decreased (-0.489983 --> -0.499983).  Saving model ...
Epoch: 49 cost time: 6.1336517333984375
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.715 Vali Acc: 0.500 Test Loss: 1.715 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499983).  Saving model ...
Epoch: 50 cost time: 6.158400774002075
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.707 Vali Acc: 0.500 Test Loss: 1.707 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499983).  Saving model ...
Epoch: 51 cost time: 6.324187994003296
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.701 Vali Acc: 0.490 Test Loss: 1.701 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.444374322891235
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.695 Vali Acc: 0.493 Test Loss: 1.695 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.036935329437256
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.497 Test Loss: 1.688 Test Acc: 0.497
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 6.688493013381958
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.691 Vali Acc: 0.497 Test Loss: 1.691 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 6.4814276695251465
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.503 Test Loss: 1.689 Test Acc: 0.503
Validation loss decreased (-0.499983 --> -0.503316).  Saving model ...
Epoch: 56 cost time: 6.857119560241699
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.503 Test Loss: 1.688 Test Acc: 0.503
Validation loss decreased (-0.503316 --> -0.503316).  Saving model ...
Epoch: 57 cost time: 6.696290969848633
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.510 Test Loss: 1.688 Test Acc: 0.510
Validation loss decreased (-0.503316 --> -0.509983).  Saving model ...
Epoch: 58 cost time: 6.368048429489136
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.693 Vali Acc: 0.507 Test Loss: 1.693 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.087414026260376
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.685 Vali Acc: 0.507 Test Loss: 1.685 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 6.859814167022705
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.671 Vali Acc: 0.523 Test Loss: 1.671 Test Acc: 0.523
Validation loss decreased (-0.509983 --> -0.523317).  Saving model ...
Epoch: 61 cost time: 6.68885064125061
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.669 Vali Acc: 0.520 Test Loss: 1.669 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.342301845550537
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.671 Vali Acc: 0.517 Test Loss: 1.671 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 6.378397226333618
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.666 Vali Acc: 0.510 Test Loss: 1.666 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 5.7408812046051025
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.678 Vali Acc: 0.507 Test Loss: 1.678 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 5.916184425354004
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.674 Vali Acc: 0.510 Test Loss: 1.674 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 5.955756187438965
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.666 Vali Acc: 0.517 Test Loss: 1.666 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 6.079224348068237
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.672 Vali Acc: 0.517 Test Loss: 1.672 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 7.0947957038879395
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.679 Vali Acc: 0.510 Test Loss: 1.679 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 6.769313812255859
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.679 Vali Acc: 0.523 Test Loss: 1.679 Test Acc: 0.523
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 6.400561094284058
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.533 Test Loss: 1.669 Test Acc: 0.533
Validation loss decreased (-0.523317 --> -0.533317).  Saving model ...
Epoch: 71 cost time: 6.246692180633545
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.670 Vali Acc: 0.527 Test Loss: 1.670 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 6.280789613723755
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.523 Test Loss: 1.669 Test Acc: 0.523
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.520932912826538
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.661 Vali Acc: 0.533 Test Loss: 1.661 Test Acc: 0.533
Validation loss decreased (-0.533317 --> -0.533317).  Saving model ...
Epoch: 74 cost time: 6.609306573867798
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.656 Vali Acc: 0.547 Test Loss: 1.656 Test Acc: 0.547
Validation loss decreased (-0.533317 --> -0.546650).  Saving model ...
Epoch: 75 cost time: 6.637063264846802
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.652 Vali Acc: 0.537 Test Loss: 1.652 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 6.736877918243408
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.543 Test Loss: 1.647 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 6.195432901382446
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.642 Vali Acc: 0.543 Test Loss: 1.642 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 6.194433689117432
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.550 Test Loss: 1.640 Test Acc: 0.550
Validation loss decreased (-0.546650 --> -0.549984).  Saving model ...
Epoch: 79 cost time: 6.00424861907959
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.641 Vali Acc: 0.553 Test Loss: 1.641 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553317).  Saving model ...
Epoch: 80 cost time: 6.643738508224487
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.638 Vali Acc: 0.563 Test Loss: 1.638 Test Acc: 0.563
Validation loss decreased (-0.553317 --> -0.563317).  Saving model ...
Epoch: 81 cost time: 6.153519630432129
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.641 Vali Acc: 0.567 Test Loss: 1.641 Test Acc: 0.567
Validation loss decreased (-0.563317 --> -0.566650).  Saving model ...
Epoch: 82 cost time: 6.512243270874023
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.567 Test Loss: 1.643 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 6.160977125167847
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.570 Test Loss: 1.643 Test Acc: 0.570
Validation loss decreased (-0.566650 --> -0.569984).  Saving model ...
Epoch: 84 cost time: 6.48605751991272
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.563 Test Loss: 1.647 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 6.245458602905273
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.563 Test Loss: 1.644 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 6.570237874984741
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.570 Test Loss: 1.630 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 87 cost time: 7.434310436248779
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.638 Vali Acc: 0.570 Test Loss: 1.638 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 6.8740527629852295
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.636 Vali Acc: 0.567 Test Loss: 1.636 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 6.527363061904907
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.570 Test Loss: 1.633 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 6.446002960205078
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.635 Vali Acc: 0.573 Test Loss: 1.635 Test Acc: 0.573
Validation loss decreased (-0.569984 --> -0.573317).  Saving model ...
Epoch: 91 cost time: 6.5047900676727295
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.573 Test Loss: 1.640 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 6.586202621459961
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.577 Test Loss: 1.639 Test Acc: 0.577
Validation loss decreased (-0.573317 --> -0.576650).  Saving model ...
Epoch: 93 cost time: 6.270770072937012
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.573 Test Loss: 1.639 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 6.468320846557617
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.580 Test Loss: 1.639 Test Acc: 0.580
Validation loss decreased (-0.576650 --> -0.579984).  Saving model ...
Epoch: 95 cost time: 6.011538743972778
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.635 Vali Acc: 0.580 Test Loss: 1.635 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579984).  Saving model ...
Epoch: 96 cost time: 6.234807729721069
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.634 Vali Acc: 0.587 Test Loss: 1.634 Test Acc: 0.587
Validation loss decreased (-0.579984 --> -0.586650).  Saving model ...
Epoch: 97 cost time: 6.259427785873413
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.641 Vali Acc: 0.590 Test Loss: 1.641 Test Acc: 0.590
Validation loss decreased (-0.586650 --> -0.589984).  Saving model ...
Epoch: 98 cost time: 5.986365795135498
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.641 Vali Acc: 0.590 Test Loss: 1.641 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 6.7643654346466064
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.642 Vali Acc: 0.590 Test Loss: 1.642 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 6.42352032661438
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.590 Test Loss: 1.643 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.59
model parameter : 595737
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.868484258651733
Epoch: 1, Steps: 18 | Train Loss: 3.273 Vali Loss: 3.255 Vali Acc: 0.057 Test Loss: 3.255 Test Acc: 0.057
Validation loss decreased (inf --> -0.056634).  Saving model ...
Epoch: 2 cost time: 6.153225898742676
Epoch: 2, Steps: 18 | Train Loss: 3.104 Vali Loss: 3.189 Vali Acc: 0.077 Test Loss: 3.189 Test Acc: 0.077
Validation loss decreased (-0.056634 --> -0.076635).  Saving model ...
Epoch: 3 cost time: 6.673587322235107
Epoch: 3, Steps: 18 | Train Loss: 2.758 Vali Loss: 3.122 Vali Acc: 0.080 Test Loss: 3.122 Test Acc: 0.080
Validation loss decreased (-0.076635 --> -0.079969).  Saving model ...
Epoch: 4 cost time: 7.336702108383179
Epoch: 4, Steps: 18 | Train Loss: 2.335 Vali Loss: 3.024 Vali Acc: 0.133 Test Loss: 3.024 Test Acc: 0.133
Validation loss decreased (-0.079969 --> -0.133303).  Saving model ...
Epoch: 5 cost time: 6.774808406829834
Epoch: 5, Steps: 18 | Train Loss: 1.907 Vali Loss: 2.929 Vali Acc: 0.147 Test Loss: 2.929 Test Acc: 0.147
Validation loss decreased (-0.133303 --> -0.146637).  Saving model ...
Epoch: 6 cost time: 6.640302658081055
Epoch: 6, Steps: 18 | Train Loss: 1.392 Vali Loss: 2.848 Vali Acc: 0.187 Test Loss: 2.848 Test Acc: 0.187
Validation loss decreased (-0.146637 --> -0.186638).  Saving model ...
Epoch: 7 cost time: 6.163244247436523
Epoch: 7, Steps: 18 | Train Loss: 0.969 Vali Loss: 2.741 Vali Acc: 0.163 Test Loss: 2.741 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.666158437728882
Epoch: 8, Steps: 18 | Train Loss: 0.614 Vali Loss: 2.621 Vali Acc: 0.210 Test Loss: 2.621 Test Acc: 0.210
Validation loss decreased (-0.186638 --> -0.209974).  Saving model ...
Epoch: 9 cost time: 5.879356145858765
Epoch: 9, Steps: 18 | Train Loss: 0.344 Vali Loss: 2.507 Vali Acc: 0.233 Test Loss: 2.507 Test Acc: 0.233
Validation loss decreased (-0.209974 --> -0.233308).  Saving model ...
Epoch: 10 cost time: 6.3301472663879395
Epoch: 10, Steps: 18 | Train Loss: 0.185 Vali Loss: 2.306 Vali Acc: 0.303 Test Loss: 2.306 Test Acc: 0.303
Validation loss decreased (-0.233308 --> -0.303310).  Saving model ...
Epoch: 11 cost time: 6.636481761932373
Epoch: 11, Steps: 18 | Train Loss: 0.096 Vali Loss: 2.208 Vali Acc: 0.323 Test Loss: 2.208 Test Acc: 0.323
Validation loss decreased (-0.303310 --> -0.323311).  Saving model ...
Epoch: 12 cost time: 6.514418363571167
Epoch: 12, Steps: 18 | Train Loss: 0.058 Vali Loss: 2.113 Vali Acc: 0.370 Test Loss: 2.113 Test Acc: 0.370
Validation loss decreased (-0.323311 --> -0.369979).  Saving model ...
Epoch: 13 cost time: 6.055028915405273
Epoch: 13, Steps: 18 | Train Loss: 0.042 Vali Loss: 2.037 Vali Acc: 0.373 Test Loss: 2.037 Test Acc: 0.373
Validation loss decreased (-0.369979 --> -0.373313).  Saving model ...
Epoch: 14 cost time: 5.922757387161255
Epoch: 14, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.990 Vali Acc: 0.393 Test Loss: 1.990 Test Acc: 0.393
Validation loss decreased (-0.373313 --> -0.393313).  Saving model ...
Epoch: 15 cost time: 5.848279237747192
Epoch: 15, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.949 Vali Acc: 0.407 Test Loss: 1.949 Test Acc: 0.407
Validation loss decreased (-0.393313 --> -0.406647).  Saving model ...
Epoch: 16 cost time: 6.214439153671265
Epoch: 16, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.917 Vali Acc: 0.393 Test Loss: 1.917 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.48028564453125
Epoch: 17, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.923 Vali Acc: 0.420 Test Loss: 1.923 Test Acc: 0.420
Validation loss decreased (-0.406647 --> -0.419981).  Saving model ...
Epoch: 18 cost time: 6.8134989738464355
Epoch: 18, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.874 Vali Acc: 0.437 Test Loss: 1.874 Test Acc: 0.437
Validation loss decreased (-0.419981 --> -0.436648).  Saving model ...
Epoch: 19 cost time: 6.7837958335876465
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.847 Vali Acc: 0.453 Test Loss: 1.847 Test Acc: 0.453
Validation loss decreased (-0.436648 --> -0.453315).  Saving model ...
Epoch: 20 cost time: 5.9794511795043945
Epoch: 20, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.821 Vali Acc: 0.460 Test Loss: 1.821 Test Acc: 0.460
Validation loss decreased (-0.453315 --> -0.459982).  Saving model ...
Epoch: 21 cost time: 5.866816997528076
Epoch: 21, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.797 Vali Acc: 0.463 Test Loss: 1.797 Test Acc: 0.463
Validation loss decreased (-0.459982 --> -0.463315).  Saving model ...
Epoch: 22 cost time: 5.828232526779175
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.804 Vali Acc: 0.467 Test Loss: 1.804 Test Acc: 0.467
Validation loss decreased (-0.463315 --> -0.466649).  Saving model ...
Epoch: 23 cost time: 6.6480302810668945
Epoch: 23, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.773 Vali Acc: 0.477 Test Loss: 1.773 Test Acc: 0.477
Validation loss decreased (-0.466649 --> -0.476649).  Saving model ...
Epoch: 24 cost time: 6.15799617767334
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.755 Vali Acc: 0.477 Test Loss: 1.755 Test Acc: 0.477
Validation loss decreased (-0.476649 --> -0.476649).  Saving model ...
Epoch: 25 cost time: 5.989312171936035
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.745 Vali Acc: 0.463 Test Loss: 1.745 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.781452894210815
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.740 Vali Acc: 0.477 Test Loss: 1.740 Test Acc: 0.477
Validation loss decreased (-0.476649 --> -0.476649).  Saving model ...
Epoch: 27 cost time: 6.049021005630493
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.729 Vali Acc: 0.487 Test Loss: 1.729 Test Acc: 0.487
Validation loss decreased (-0.476649 --> -0.486649).  Saving model ...
Epoch: 28 cost time: 5.915282249450684
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.692 Vali Acc: 0.487 Test Loss: 1.692 Test Acc: 0.487
Validation loss decreased (-0.486649 --> -0.486650).  Saving model ...
Epoch: 29 cost time: 6.641844034194946
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.682 Vali Acc: 0.493 Test Loss: 1.682 Test Acc: 0.493
Validation loss decreased (-0.486650 --> -0.493317).  Saving model ...
Epoch: 30 cost time: 6.313262939453125
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.672 Vali Acc: 0.497 Test Loss: 1.672 Test Acc: 0.497
Validation loss decreased (-0.493317 --> -0.496650).  Saving model ...
Epoch: 31 cost time: 6.413293361663818
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.658 Vali Acc: 0.500 Test Loss: 1.658 Test Acc: 0.500
Validation loss decreased (-0.496650 --> -0.499983).  Saving model ...
Epoch: 32 cost time: 6.415629863739014
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.659 Vali Acc: 0.493 Test Loss: 1.659 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.155747652053833
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.654 Vali Acc: 0.510 Test Loss: 1.654 Test Acc: 0.510
Validation loss decreased (-0.499983 --> -0.509983).  Saving model ...
Epoch: 34 cost time: 5.917133808135986
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.647 Vali Acc: 0.510 Test Loss: 1.647 Test Acc: 0.510
Validation loss decreased (-0.509983 --> -0.509984).  Saving model ...
Epoch: 35 cost time: 5.967757940292358
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.646 Vali Acc: 0.513 Test Loss: 1.646 Test Acc: 0.513
Validation loss decreased (-0.509984 --> -0.513317).  Saving model ...
Epoch: 36 cost time: 6.517252445220947
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.639 Vali Acc: 0.503 Test Loss: 1.639 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.600785732269287
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.641 Vali Acc: 0.513 Test Loss: 1.641 Test Acc: 0.513
Validation loss decreased (-0.513317 --> -0.513317).  Saving model ...
Epoch: 38 cost time: 6.886144399642944
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.625 Vali Acc: 0.513 Test Loss: 1.625 Test Acc: 0.513
Validation loss decreased (-0.513317 --> -0.513317).  Saving model ...
Epoch: 39 cost time: 6.171072483062744
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.613 Vali Acc: 0.520 Test Loss: 1.613 Test Acc: 0.520
Validation loss decreased (-0.513317 --> -0.519984).  Saving model ...
Epoch: 40 cost time: 6.341369390487671
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.610 Vali Acc: 0.537 Test Loss: 1.610 Test Acc: 0.537
Validation loss decreased (-0.519984 --> -0.536651).  Saving model ...
Epoch: 41 cost time: 6.817906618118286
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.598 Vali Acc: 0.547 Test Loss: 1.598 Test Acc: 0.547
Validation loss decreased (-0.536651 --> -0.546651).  Saving model ...
Epoch: 42 cost time: 6.826046705245972
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.588 Vali Acc: 0.547 Test Loss: 1.588 Test Acc: 0.547
Validation loss decreased (-0.546651 --> -0.546651).  Saving model ...
Epoch: 43 cost time: 6.4489288330078125
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.584 Vali Acc: 0.550 Test Loss: 1.584 Test Acc: 0.550
Validation loss decreased (-0.546651 --> -0.549984).  Saving model ...
Epoch: 44 cost time: 6.869341850280762
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.584 Vali Acc: 0.550 Test Loss: 1.584 Test Acc: 0.550
Validation loss decreased (-0.549984 --> -0.549984).  Saving model ...
Epoch: 45 cost time: 6.260375738143921
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.578 Vali Acc: 0.550 Test Loss: 1.578 Test Acc: 0.550
Validation loss decreased (-0.549984 --> -0.549984).  Saving model ...
Epoch: 46 cost time: 5.857651233673096
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.572 Vali Acc: 0.547 Test Loss: 1.572 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.028612375259399
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.570 Vali Acc: 0.547 Test Loss: 1.570 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 6.295888662338257
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.569 Vali Acc: 0.553 Test Loss: 1.569 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553318).  Saving model ...
Epoch: 49 cost time: 6.062682151794434
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.568 Vali Acc: 0.550 Test Loss: 1.568 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.348639965057373
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.562 Vali Acc: 0.557 Test Loss: 1.562 Test Acc: 0.557
Validation loss decreased (-0.553318 --> -0.556651).  Saving model ...
Epoch: 51 cost time: 6.399543046951294
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.556 Vali Acc: 0.557 Test Loss: 1.556 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 52 cost time: 6.589175224304199
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.560 Test Loss: 1.551 Test Acc: 0.560
Validation loss decreased (-0.556651 --> -0.559984).  Saving model ...
Epoch: 53 cost time: 6.356481313705444
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.557 Test Loss: 1.544 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.100183725357056
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.541 Vali Acc: 0.557 Test Loss: 1.541 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.65065336227417
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.538 Vali Acc: 0.560 Test Loss: 1.538 Test Acc: 0.560
Validation loss decreased (-0.559984 --> -0.559985).  Saving model ...
Epoch: 56 cost time: 6.319218158721924
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.535 Vali Acc: 0.560 Test Loss: 1.535 Test Acc: 0.560
Validation loss decreased (-0.559985 --> -0.559985).  Saving model ...
Epoch: 57 cost time: 6.995526075363159
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.528 Vali Acc: 0.567 Test Loss: 1.528 Test Acc: 0.567
Validation loss decreased (-0.559985 --> -0.566651).  Saving model ...
Epoch: 58 cost time: 6.204301357269287
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.570 Test Loss: 1.526 Test Acc: 0.570
Validation loss decreased (-0.566651 --> -0.569985).  Saving model ...
Epoch: 59 cost time: 6.041976690292358
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.520 Vali Acc: 0.580 Test Loss: 1.520 Test Acc: 0.580
Validation loss decreased (-0.569985 --> -0.579985).  Saving model ...
Epoch: 60 cost time: 6.138315200805664
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.514 Vali Acc: 0.570 Test Loss: 1.514 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.117092132568359
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.511 Vali Acc: 0.573 Test Loss: 1.511 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 6.31044340133667
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.514 Vali Acc: 0.573 Test Loss: 1.514 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 6.580836296081543
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.510 Vali Acc: 0.570 Test Loss: 1.510 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 5.785628080368042
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.514 Vali Acc: 0.563 Test Loss: 1.514 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 5.8331122398376465
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.567 Test Loss: 1.515 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 6.0693039894104
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.511 Vali Acc: 0.567 Test Loss: 1.511 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 7.680166006088257
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.563 Test Loss: 1.511 Test Acc: 0.563
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 6.943788051605225
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.570 Test Loss: 1.512 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 6.748128652572632
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.570 Test Loss: 1.511 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.58
model parameter : 595737
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.969765663146973
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 5.975884914398193
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 3 cost time: 5.770740509033203
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.1045825481414795
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.946964263916016
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.173676252365112
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.239150524139404
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 8 cost time: 5.509477376937866
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 9 cost time: 5.510293245315552
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.60925030708313
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.019760370254517
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.2390666007995605
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 13 cost time: 6.165932655334473
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 14 cost time: 5.84986686706543
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.306839466094971
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.13965916633606
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.551872968673706
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.670772552490234
Epoch: 18, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.517953395843506
Epoch: 19, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.952642917633057
Epoch: 20, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 21 cost time: 6.605735778808594
Epoch: 21, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.217507839202881
Epoch: 22, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.869328022003174
Epoch: 23, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 24 cost time: 6.611425161361694
Epoch: 24, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 25 cost time: 5.904078483581543
Epoch: 25, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 26 cost time: 6.048269748687744
Epoch: 26, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 27 cost time: 6.0232789516448975
Epoch: 27, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.711902379989624
Epoch: 28, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 29 cost time: 6.65721583366394
Epoch: 29, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.599191188812256
Epoch: 30, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.131640672683716
Epoch: 31, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.904746770858765
Epoch: 32, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 6.030275344848633
Epoch: 33, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 6.0180299282073975
Epoch: 34, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 35 cost time: 6.4465954303741455
Epoch: 35, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.368361711502075
Epoch: 36, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 6.470330715179443
Epoch: 37, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 5.970174312591553
Epoch: 38, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 5.30574893951416
Epoch: 39, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 5.338645935058594
Epoch: 40, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 5.189910411834717
Epoch: 41, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 5.972243070602417
Epoch: 42, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 43 cost time: 5.743404150009155
Epoch: 43, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 44 cost time: 5.968830108642578
Epoch: 44, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.242450952529907
Epoch: 45, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 5.145797252655029
Epoch: 46, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 5.464670658111572
Epoch: 47, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 48 cost time: 5.091202735900879
Epoch: 48, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.803501129150391
Epoch: 49, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 5.683384656906128
Epoch: 50, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 51 cost time: 5.9524524211883545
Epoch: 51, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.9785943031311035
Epoch: 52, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 5.594513654708862
Epoch: 53, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 5.910574197769165
Epoch: 54, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 5.767622709274292
Epoch: 55, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 56 cost time: 6.12562108039856
Epoch: 56, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 57 cost time: 5.9000279903411865
Epoch: 57, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.187155485153198
Epoch: 58, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 6.276424169540405
Epoch: 59, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 60 cost time: 5.839811563491821
Epoch: 60, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 5.431355237960815
Epoch: 61, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 5.773252725601196
Epoch: 62, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 6.082995891571045
Epoch: 63, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 5.742058515548706
Epoch: 64, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 6.210955619812012
Epoch: 65, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 5.905173301696777
Epoch: 66, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 5.60797905921936
Epoch: 67, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 5.685145616531372
Epoch: 68, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 5.505940914154053
Epoch: 69, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 595737
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.662498235702515
Epoch: 1, Steps: 18 | Train Loss: 3.124 Vali Loss: 2.710 Vali Acc: 0.383 Test Loss: 2.710 Test Acc: 0.383
Validation loss decreased (inf --> -0.383306).  Saving model ...
Epoch: 2 cost time: 6.442728281021118
Epoch: 2, Steps: 18 | Train Loss: 2.209 Vali Loss: 1.776 Vali Acc: 0.760 Test Loss: 1.776 Test Acc: 0.760
Validation loss decreased (-0.383306 --> -0.759982).  Saving model ...
Epoch: 3 cost time: 5.59238600730896
Epoch: 3, Steps: 18 | Train Loss: 1.225 Vali Loss: 1.075 Vali Acc: 0.827 Test Loss: 1.075 Test Acc: 0.827
Validation loss decreased (-0.759982 --> -0.826656).  Saving model ...
Epoch: 4 cost time: 5.592607736587524
Epoch: 4, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.703 Vali Acc: 0.880 Test Loss: 0.703 Test Acc: 0.880
Validation loss decreased (-0.826656 --> -0.879993).  Saving model ...
Epoch: 5 cost time: 5.971946954727173
Epoch: 5, Steps: 18 | Train Loss: 0.233 Vali Loss: 0.537 Vali Acc: 0.897 Test Loss: 0.537 Test Acc: 0.897
Validation loss decreased (-0.879993 --> -0.896661).  Saving model ...
Epoch: 6 cost time: 6.164704084396362
Epoch: 6, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.471 Vali Acc: 0.887 Test Loss: 0.471 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.341145753860474
Epoch: 7, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.440 Vali Acc: 0.890 Test Loss: 0.440 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.52508544921875
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.417 Vali Acc: 0.890 Test Loss: 0.417 Test Acc: 0.890
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.3861918449401855
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.400 Vali Acc: 0.897 Test Loss: 0.400 Test Acc: 0.897
Validation loss decreased (-0.896661 --> -0.896663).  Saving model ...
Epoch: 10 cost time: 5.972612380981445
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
Validation loss decreased (-0.896663 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 5.95522665977478
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.385 Vali Acc: 0.897 Test Loss: 0.385 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.47095251083374
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.387 Vali Acc: 0.897 Test Loss: 0.387 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.457046031951904
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.379 Vali Acc: 0.897 Test Loss: 0.379 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.03462290763855
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 15 cost time: 6.696979284286499
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.370 Vali Acc: 0.907 Test Loss: 0.370 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.906663).  Saving model ...
Epoch: 16 cost time: 6.336427688598633
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.368 Vali Acc: 0.910 Test Loss: 0.368 Test Acc: 0.910
Validation loss decreased (-0.906663 --> -0.909996).  Saving model ...
Epoch: 17 cost time: 6.141230821609497
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.058095216751099
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.362 Vali Acc: 0.907 Test Loss: 0.362 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.016225576400757
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.360 Vali Acc: 0.907 Test Loss: 0.360 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.753355026245117
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.361 Vali Acc: 0.907 Test Loss: 0.361 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.796971082687378
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.394540548324585
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.205038785934448
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.1975202560424805
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.355 Vali Acc: 0.910 Test Loss: 0.355 Test Acc: 0.910
Validation loss decreased (-0.909996 --> -0.909996).  Saving model ...
Epoch: 25 cost time: 5.69190239906311
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.352 Vali Acc: 0.913 Test Loss: 0.352 Test Acc: 0.913
Validation loss decreased (-0.909996 --> -0.913330).  Saving model ...
Epoch: 26 cost time: 6.449771165847778
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.350 Vali Acc: 0.910 Test Loss: 0.350 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.281545639038086
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.350 Vali Acc: 0.910 Test Loss: 0.350 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.425677061080933
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.910 Test Loss: 0.349 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.383621454238892
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.347 Vali Acc: 0.913 Test Loss: 0.347 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 30 cost time: 6.1514058113098145
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.346 Vali Acc: 0.913 Test Loss: 0.346 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 31 cost time: 5.979372978210449
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.344 Vali Acc: 0.913 Test Loss: 0.344 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 32 cost time: 6.739247798919678
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.344 Vali Acc: 0.910 Test Loss: 0.344 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.24825644493103
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.343 Vali Acc: 0.910 Test Loss: 0.343 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.628618478775024
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.343 Vali Acc: 0.907 Test Loss: 0.343 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 6.510378837585449
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.342 Vali Acc: 0.910 Test Loss: 0.342 Test Acc: 0.910
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 6.136248588562012
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.342 Vali Acc: 0.910 Test Loss: 0.342 Test Acc: 0.910
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 6.086176633834839
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.341 Vali Acc: 0.910 Test Loss: 0.341 Test Acc: 0.910
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 6.168089389801025
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.341 Vali Acc: 0.910 Test Loss: 0.341 Test Acc: 0.910
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 6.543720483779907
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.340 Vali Acc: 0.910 Test Loss: 0.340 Test Acc: 0.910
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 6.5997536182403564
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.910 Test Loss: 0.339 Test Acc: 0.910
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 6.470613956451416
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.913 Test Loss: 0.339 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 42 cost time: 5.754571199417114
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 43 cost time: 6.391852378845215
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.913 Test Loss: 0.337 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 44 cost time: 6.471876859664917
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 45 cost time: 6.824439764022827
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 46 cost time: 6.75397515296936
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.913 Test Loss: 0.335 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 47 cost time: 6.612706422805786
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.913 Test Loss: 0.334 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 48 cost time: 6.163414239883423
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.913 Test Loss: 0.334 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 49 cost time: 6.250760078430176
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.913 Test Loss: 0.332 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 50 cost time: 6.289774179458618
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.913 Test Loss: 0.332 Test Acc: 0.913
Validation loss decreased (-0.913330 --> -0.913330).  Saving model ...
Epoch: 51 cost time: 6.498716831207275
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
Validation loss decreased (-0.913330 --> -0.916663).  Saving model ...
Epoch: 52 cost time: 7.041604518890381
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 53 cost time: 6.267744541168213
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 54 cost time: 5.713979721069336
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.740824460983276
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 5.945003032684326
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 57 cost time: 6.042018413543701
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 58 cost time: 6.259171962738037
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 59 cost time: 6.135237455368042
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 60 cost time: 6.920766353607178
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 61 cost time: 6.43739652633667
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 62 cost time: 6.145597696304321
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 6.092510461807251
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 6.498707294464111
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 6.370777130126953
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 6.416653156280518
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 5.794037103652954
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 68 cost time: 6.799036026000977
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.382301092147827
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 7.061765432357788
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 71 cost time: 7.053222894668579
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 72 cost time: 7.593096733093262
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.920 Test Loss: 0.323 Test Acc: 0.920
Validation loss decreased (-0.916663 --> -0.919997).  Saving model ...
Epoch: 73 cost time: 9.213550567626953
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.920 Test Loss: 0.323 Test Acc: 0.920
Validation loss decreased (-0.919997 --> -0.919997).  Saving model ...
Epoch: 74 cost time: 8.502407312393188
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.920 Test Loss: 0.323 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 9.068867921829224
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.920 Test Loss: 0.323 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 9.299605369567871
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.920 Test Loss: 0.324 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 8.559086799621582
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.920 Test Loss: 0.323 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 9.0453782081604
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.920 Test Loss: 0.322 Test Acc: 0.920
Validation loss decreased (-0.919997 --> -0.919997).  Saving model ...
Epoch: 79 cost time: 8.682199954986572
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.923 Test Loss: 0.322 Test Acc: 0.923
Validation loss decreased (-0.919997 --> -0.923330).  Saving model ...
Epoch: 80 cost time: 9.191313743591309
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.923 Test Loss: 0.322 Test Acc: 0.923
Validation loss decreased (-0.923330 --> -0.923330).  Saving model ...
Epoch: 81 cost time: 8.925175666809082
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.920 Test Loss: 0.321 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 8.34244179725647
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.920 Test Loss: 0.321 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 8.790437698364258
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.920 Test Loss: 0.321 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 9.57949185371399
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.920 Test Loss: 0.321 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 9.546470642089844
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 9.816442966461182
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 9.394186019897461
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 9.54842472076416
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 8.800544261932373
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 8.35291314125061
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9233333333333333
model parameter : 497433
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 12.088338136672974
Epoch: 1, Steps: 18 | Train Loss: 3.158 Vali Loss: 2.849 Vali Acc: 0.307 Test Loss: 2.849 Test Acc: 0.307
Validation loss decreased (inf --> -0.306638).  Saving model ...
Epoch: 2 cost time: 9.098644256591797
Epoch: 2, Steps: 18 | Train Loss: 2.425 Vali Loss: 2.107 Vali Acc: 0.677 Test Loss: 2.107 Test Acc: 0.677
Validation loss decreased (-0.306638 --> -0.676646).  Saving model ...
Epoch: 3 cost time: 9.2370445728302
Epoch: 3, Steps: 18 | Train Loss: 1.535 Vali Loss: 1.431 Vali Acc: 0.763 Test Loss: 1.431 Test Acc: 0.763
Validation loss decreased (-0.676646 --> -0.763319).  Saving model ...
Epoch: 4 cost time: 10.224537134170532
Epoch: 4, Steps: 18 | Train Loss: 0.784 Vali Loss: 0.986 Vali Acc: 0.820 Test Loss: 0.986 Test Acc: 0.820
Validation loss decreased (-0.763319 --> -0.819990).  Saving model ...
Epoch: 5 cost time: 9.871726751327515
Epoch: 5, Steps: 18 | Train Loss: 0.343 Vali Loss: 0.771 Vali Acc: 0.817 Test Loss: 0.771 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.276678800582886
Epoch: 6, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.671 Vali Acc: 0.837 Test Loss: 0.671 Test Acc: 0.837
Validation loss decreased (-0.819990 --> -0.836660).  Saving model ...
Epoch: 7 cost time: 9.273852348327637
Epoch: 7, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.615 Vali Acc: 0.837 Test Loss: 0.615 Test Acc: 0.837
Validation loss decreased (-0.836660 --> -0.836661).  Saving model ...
Epoch: 8 cost time: 8.567399978637695
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
Validation loss decreased (-0.836661 --> -0.849994).  Saving model ...
Epoch: 9 cost time: 8.86866545677185
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 9.903750658035278
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 11 cost time: 8.911956787109375
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.555 Vali Acc: 0.843 Test Loss: 0.555 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.583588361740112
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.551 Vali Acc: 0.863 Test Loss: 0.551 Test Acc: 0.863
Validation loss decreased (-0.849994 --> -0.863328).  Saving model ...
Epoch: 13 cost time: 9.186193943023682
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.839847326278687
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.541 Vali Acc: 0.857 Test Loss: 0.541 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.323140621185303
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.540 Vali Acc: 0.853 Test Loss: 0.540 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.274273872375488
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.096179246902466
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.532 Vali Acc: 0.857 Test Loss: 0.532 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.779370307922363
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.529 Vali Acc: 0.860 Test Loss: 0.529 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.573615550994873
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.530 Vali Acc: 0.863 Test Loss: 0.530 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 20 cost time: 9.516403436660767
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.530 Vali Acc: 0.857 Test Loss: 0.530 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.310682773590088
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.533 Vali Acc: 0.860 Test Loss: 0.533 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 10.852132797241211
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
Validation loss decreased (-0.863328 --> -0.866661).  Saving model ...
Epoch: 23 cost time: 10.552965879440308
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.860 Test Loss: 0.529 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.061294555664062
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.527 Vali Acc: 0.863 Test Loss: 0.527 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.196625232696533
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.523 Vali Acc: 0.860 Test Loss: 0.523 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 10.236999034881592
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.860 Test Loss: 0.522 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 10.146370887756348
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.523 Vali Acc: 0.857 Test Loss: 0.523 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 10.30857801437378
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.863 Test Loss: 0.522 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 9.779995441436768
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 11.461971759796143
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.863 Test Loss: 0.520 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 11.338410377502441
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.863 Test Loss: 0.520 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 10.029370069503784
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.870 Test Loss: 0.518 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.869995).  Saving model ...
Epoch: 33 cost time: 10.067363977432251
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 9.817284345626831
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 9.194578647613525
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.870 Test Loss: 0.517 Test Acc: 0.870
Validation loss decreased (-0.869995 --> -0.869995).  Saving model ...
Epoch: 36 cost time: 8.502948522567749
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.863 Test Loss: 0.517 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 8.855002403259277
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.857 Test Loss: 0.517 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 9.667931079864502
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.857 Test Loss: 0.520 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 10.846575260162354
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.857 Test Loss: 0.520 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 9.938447952270508
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.860 Test Loss: 0.518 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 9.824128866195679
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.860 Test Loss: 0.518 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 10.7889564037323
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 10.257230758666992
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.863 Test Loss: 0.518 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 11.128699541091919
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.863 Test Loss: 0.517 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 11.732062578201294
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.87
model parameter : 497433
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 12.249923944473267
Epoch: 1, Steps: 18 | Train Loss: 3.227 Vali Loss: 2.986 Vali Acc: 0.197 Test Loss: 2.986 Test Acc: 0.197
Validation loss decreased (inf --> -0.196637).  Saving model ...
Epoch: 2 cost time: 10.62119722366333
Epoch: 2, Steps: 18 | Train Loss: 2.679 Vali Loss: 2.477 Vali Acc: 0.570 Test Loss: 2.477 Test Acc: 0.570
Validation loss decreased (-0.196637 --> -0.569975).  Saving model ...
Epoch: 3 cost time: 10.639752864837646
Epoch: 3, Steps: 18 | Train Loss: 1.973 Vali Loss: 1.938 Vali Acc: 0.663 Test Loss: 1.938 Test Acc: 0.663
Validation loss decreased (-0.569975 --> -0.663314).  Saving model ...
Epoch: 4 cost time: 10.474560022354126
Epoch: 4, Steps: 18 | Train Loss: 1.209 Vali Loss: 1.469 Vali Acc: 0.750 Test Loss: 1.469 Test Acc: 0.750
Validation loss decreased (-0.663314 --> -0.749985).  Saving model ...
Epoch: 5 cost time: 11.360764265060425
Epoch: 5, Steps: 18 | Train Loss: 0.632 Vali Loss: 1.154 Vali Acc: 0.767 Test Loss: 1.154 Test Acc: 0.767
Validation loss decreased (-0.749985 --> -0.766655).  Saving model ...
Epoch: 6 cost time: 10.074854612350464
Epoch: 6, Steps: 18 | Train Loss: 0.292 Vali Loss: 0.989 Vali Acc: 0.760 Test Loss: 0.989 Test Acc: 0.760
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.7429678440094
Epoch: 7, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.883 Vali Acc: 0.773 Test Loss: 0.883 Test Acc: 0.773
Validation loss decreased (-0.766655 --> -0.773325).  Saving model ...
Epoch: 8 cost time: 8.952497482299805
Epoch: 8, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.849 Vali Acc: 0.773 Test Loss: 0.849 Test Acc: 0.773
Validation loss decreased (-0.773325 --> -0.773325).  Saving model ...
Epoch: 9 cost time: 9.644315481185913
Epoch: 9, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.815 Vali Acc: 0.793 Test Loss: 0.815 Test Acc: 0.793
Validation loss decreased (-0.773325 --> -0.793325).  Saving model ...
Epoch: 10 cost time: 10.868359565734863
Epoch: 10, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.809 Vali Acc: 0.783 Test Loss: 0.809 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.38513731956482
Epoch: 11, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.790 Vali Acc: 0.780 Test Loss: 0.790 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.77184009552002
Epoch: 12, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.788 Vali Acc: 0.783 Test Loss: 0.788 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.913631677627563
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.785 Vali Acc: 0.780 Test Loss: 0.785 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.716375589370728
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.776 Vali Acc: 0.793 Test Loss: 0.776 Test Acc: 0.793
Validation loss decreased (-0.793325 --> -0.793326).  Saving model ...
Epoch: 15 cost time: 10.300398349761963
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.774 Vali Acc: 0.787 Test Loss: 0.774 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.704763650894165
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.772 Vali Acc: 0.790 Test Loss: 0.772 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.55833625793457
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.765 Vali Acc: 0.797 Test Loss: 0.765 Test Acc: 0.797
Validation loss decreased (-0.793326 --> -0.796659).  Saving model ...
Epoch: 18 cost time: 10.684383153915405
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.764 Vali Acc: 0.793 Test Loss: 0.764 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.388345956802368
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.765 Vali Acc: 0.793 Test Loss: 0.765 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.800373077392578
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.766 Vali Acc: 0.790 Test Loss: 0.766 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.894840478897095
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.770 Vali Acc: 0.793 Test Loss: 0.770 Test Acc: 0.793
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 10.688071966171265
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.768 Vali Acc: 0.793 Test Loss: 0.768 Test Acc: 0.793
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 11.693638563156128
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.768 Vali Acc: 0.790 Test Loss: 0.768 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 10.186865329742432
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.766 Vali Acc: 0.790 Test Loss: 0.766 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 9.876567840576172
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.762 Vali Acc: 0.790 Test Loss: 0.762 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 9.652775526046753
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.762 Vali Acc: 0.790 Test Loss: 0.762 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 10.703420639038086
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.765 Vali Acc: 0.790 Test Loss: 0.765 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7966666666666666
model parameter : 497433
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 12.712502002716064
Epoch: 1, Steps: 18 | Train Loss: 3.253 Vali Loss: 3.079 Vali Acc: 0.157 Test Loss: 3.079 Test Acc: 0.157
Validation loss decreased (inf --> -0.156636).  Saving model ...
Epoch: 2 cost time: 9.680224657058716
Epoch: 2, Steps: 18 | Train Loss: 2.864 Vali Loss: 2.767 Vali Acc: 0.357 Test Loss: 2.767 Test Acc: 0.357
Validation loss decreased (-0.156636 --> -0.356639).  Saving model ...
Epoch: 3 cost time: 10.151402950286865
Epoch: 3, Steps: 18 | Train Loss: 2.320 Vali Loss: 2.420 Vali Acc: 0.470 Test Loss: 2.420 Test Acc: 0.470
Validation loss decreased (-0.356639 --> -0.469976).  Saving model ...
Epoch: 4 cost time: 10.159021854400635
Epoch: 4, Steps: 18 | Train Loss: 1.678 Vali Loss: 2.074 Vali Acc: 0.560 Test Loss: 2.074 Test Acc: 0.560
Validation loss decreased (-0.469976 --> -0.559979).  Saving model ...
Epoch: 5 cost time: 9.644559144973755
Epoch: 5, Steps: 18 | Train Loss: 1.072 Vali Loss: 1.771 Vali Acc: 0.603 Test Loss: 1.771 Test Acc: 0.603
Validation loss decreased (-0.559979 --> -0.603316).  Saving model ...
Epoch: 6 cost time: 10.10768175125122
Epoch: 6, Steps: 18 | Train Loss: 0.610 Vali Loss: 1.535 Vali Acc: 0.593 Test Loss: 1.535 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.008882284164429
Epoch: 7, Steps: 18 | Train Loss: 0.299 Vali Loss: 1.384 Vali Acc: 0.627 Test Loss: 1.384 Test Acc: 0.627
Validation loss decreased (-0.603316 --> -0.626653).  Saving model ...
Epoch: 8 cost time: 11.64098596572876
Epoch: 8, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.302 Vali Acc: 0.627 Test Loss: 1.302 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626654).  Saving model ...
Epoch: 9 cost time: 11.714686155319214
Epoch: 9, Steps: 18 | Train Loss: 0.063 Vali Loss: 1.221 Vali Acc: 0.643 Test Loss: 1.221 Test Acc: 0.643
Validation loss decreased (-0.626654 --> -0.643321).  Saving model ...
Epoch: 10 cost time: 10.181119441986084
Epoch: 10, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.195 Vali Acc: 0.637 Test Loss: 1.195 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.150964260101318
Epoch: 11, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.170 Vali Acc: 0.657 Test Loss: 1.170 Test Acc: 0.657
Validation loss decreased (-0.643321 --> -0.656655).  Saving model ...
Epoch: 12 cost time: 10.59134578704834
Epoch: 12, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.162 Vali Acc: 0.663 Test Loss: 1.162 Test Acc: 0.663
Validation loss decreased (-0.656655 --> -0.663322).  Saving model ...
Epoch: 13 cost time: 10.540502309799194
Epoch: 13, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.142 Vali Acc: 0.657 Test Loss: 1.142 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.12486481666565
Epoch: 14, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.131 Vali Acc: 0.660 Test Loss: 1.131 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.960144996643066
Epoch: 15, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.114 Vali Acc: 0.657 Test Loss: 1.114 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.487123489379883
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.102 Vali Acc: 0.670 Test Loss: 1.102 Test Acc: 0.670
Validation loss decreased (-0.663322 --> -0.669989).  Saving model ...
Epoch: 17 cost time: 10.206672668457031
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.090 Vali Acc: 0.677 Test Loss: 1.090 Test Acc: 0.677
Validation loss decreased (-0.669989 --> -0.676656).  Saving model ...
Epoch: 18 cost time: 11.785792350769043
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.082 Vali Acc: 0.683 Test Loss: 1.082 Test Acc: 0.683
Validation loss decreased (-0.676656 --> -0.683323).  Saving model ...
Epoch: 19 cost time: 10.561378717422485
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.074 Vali Acc: 0.680 Test Loss: 1.074 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.466410875320435
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.068 Vali Acc: 0.677 Test Loss: 1.068 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.518588781356812
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.063 Vali Acc: 0.670 Test Loss: 1.063 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 11.05323576927185
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.057 Vali Acc: 0.693 Test Loss: 1.057 Test Acc: 0.693
Validation loss decreased (-0.683323 --> -0.693323).  Saving model ...
Epoch: 23 cost time: 11.253939390182495
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.049 Vali Acc: 0.687 Test Loss: 1.049 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 12.13306188583374
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.049 Vali Acc: 0.687 Test Loss: 1.049 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 12.314475774765015
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.043 Vali Acc: 0.683 Test Loss: 1.043 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 10.686162948608398
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.037 Vali Acc: 0.687 Test Loss: 1.037 Test Acc: 0.687
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 11.344390869140625
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.035 Vali Acc: 0.687 Test Loss: 1.035 Test Acc: 0.687
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 12.68801236152649
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.032 Vali Acc: 0.690 Test Loss: 1.032 Test Acc: 0.690
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 10.703872442245483
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.025 Vali Acc: 0.693 Test Loss: 1.025 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 30 cost time: 9.982206583023071
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.023 Vali Acc: 0.693 Test Loss: 1.023 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 31 cost time: 9.793692827224731
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.020 Vali Acc: 0.693 Test Loss: 1.020 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 32 cost time: 11.041982650756836
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.014 Vali Acc: 0.697 Test Loss: 1.014 Test Acc: 0.697
Validation loss decreased (-0.693323 --> -0.696657).  Saving model ...
Epoch: 33 cost time: 11.286101579666138
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.012 Vali Acc: 0.703 Test Loss: 1.012 Test Acc: 0.703
Validation loss decreased (-0.696657 --> -0.703323).  Saving model ...
Epoch: 34 cost time: 11.043473958969116
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.012 Vali Acc: 0.707 Test Loss: 1.012 Test Acc: 0.707
Validation loss decreased (-0.703323 --> -0.706657).  Saving model ...
Epoch: 35 cost time: 11.666482210159302
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.700 Test Loss: 1.011 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 10.842904567718506
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.009 Vali Acc: 0.707 Test Loss: 1.009 Test Acc: 0.707
Validation loss decreased (-0.706657 --> -0.706657).  Saving model ...
Epoch: 37 cost time: 11.305553674697876
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.006 Vali Acc: 0.700 Test Loss: 1.006 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 11.526272296905518
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.006 Vali Acc: 0.707 Test Loss: 1.006 Test Acc: 0.707
Validation loss decreased (-0.706657 --> -0.706657).  Saving model ...
Epoch: 39 cost time: 12.55133318901062
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.004 Vali Acc: 0.707 Test Loss: 1.004 Test Acc: 0.707
Validation loss decreased (-0.706657 --> -0.706657).  Saving model ...
Epoch: 40 cost time: 11.025217771530151
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.703 Test Loss: 1.001 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 11.9910409450531
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.707 Test Loss: 1.000 Test Acc: 0.707
Validation loss decreased (-0.706657 --> -0.706657).  Saving model ...
Epoch: 42 cost time: 11.06359314918518
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.999 Vali Acc: 0.703 Test Loss: 0.999 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 10.512550592422485
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.693 Test Loss: 1.001 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 10.971304655075073
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.703 Test Loss: 1.001 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 11.195180416107178
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.999 Vali Acc: 0.710 Test Loss: 0.999 Test Acc: 0.710
Validation loss decreased (-0.706657 --> -0.709990).  Saving model ...
Epoch: 46 cost time: 11.016964435577393
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.998 Vali Acc: 0.710 Test Loss: 0.998 Test Acc: 0.710
Validation loss decreased (-0.709990 --> -0.709990).  Saving model ...
Epoch: 47 cost time: 10.514577865600586
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.710 Test Loss: 0.997 Test Acc: 0.710
Validation loss decreased (-0.709990 --> -0.709990).  Saving model ...
Epoch: 48 cost time: 11.542125463485718
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.713 Test Loss: 0.995 Test Acc: 0.713
Validation loss decreased (-0.709990 --> -0.713323).  Saving model ...
Epoch: 49 cost time: 10.525423288345337
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.994 Vali Acc: 0.713 Test Loss: 0.994 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 50 cost time: 11.330343008041382
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.713 Test Loss: 0.995 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 10.67702341079712
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.994 Vali Acc: 0.717 Test Loss: 0.994 Test Acc: 0.717
Validation loss decreased (-0.713323 --> -0.716657).  Saving model ...
Epoch: 52 cost time: 12.684321403503418
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.720 Test Loss: 0.991 Test Acc: 0.720
Validation loss decreased (-0.716657 --> -0.719990).  Saving model ...
Epoch: 53 cost time: 11.068938970565796
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.717 Test Loss: 0.990 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 10.338964700698853
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.989 Vali Acc: 0.720 Test Loss: 0.989 Test Acc: 0.720
Validation loss decreased (-0.719990 --> -0.719990).  Saving model ...
Epoch: 55 cost time: 9.379415035247803
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.989 Vali Acc: 0.710 Test Loss: 0.989 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 9.539809703826904
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.989 Vali Acc: 0.717 Test Loss: 0.989 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 11.02134919166565
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.723 Test Loss: 0.988 Test Acc: 0.723
Validation loss decreased (-0.719990 --> -0.723323).  Saving model ...
Epoch: 58 cost time: 9.861631155014038
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.717 Test Loss: 0.987 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 10.911864280700684
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.717 Test Loss: 0.988 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 11.772798538208008
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.717 Test Loss: 0.988 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 12.376656770706177
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.713 Test Loss: 0.987 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 10.479896783828735
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.713 Test Loss: 0.987 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 10.82307744026184
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.720 Test Loss: 0.991 Test Acc: 0.720
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 10.801612615585327
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.720 Test Loss: 0.991 Test Acc: 0.720
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 10.081520557403564
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.723 Test Loss: 0.990 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 10.29922866821289
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.989 Vali Acc: 0.727 Test Loss: 0.989 Test Acc: 0.727
Validation loss decreased (-0.723323 --> -0.726657).  Saving model ...
Epoch: 67 cost time: 10.45965838432312
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.723 Test Loss: 0.987 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 10.643555402755737
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.723 Test Loss: 0.986 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 10.304627180099487
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.723 Test Loss: 0.986 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 10.07733964920044
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.982 Vali Acc: 0.727 Test Loss: 0.982 Test Acc: 0.727
Validation loss decreased (-0.726657 --> -0.726657).  Saving model ...
Epoch: 71 cost time: 10.80727767944336
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.981 Vali Acc: 0.727 Test Loss: 0.981 Test Acc: 0.727
Validation loss decreased (-0.726657 --> -0.726657).  Saving model ...
Epoch: 72 cost time: 11.42123794555664
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.982 Vali Acc: 0.730 Test Loss: 0.982 Test Acc: 0.730
Validation loss decreased (-0.726657 --> -0.729990).  Saving model ...
Epoch: 73 cost time: 10.590569496154785
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.980 Vali Acc: 0.730 Test Loss: 0.980 Test Acc: 0.730
Validation loss decreased (-0.729990 --> -0.729990).  Saving model ...
Epoch: 74 cost time: 9.842377185821533
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.981 Vali Acc: 0.730 Test Loss: 0.981 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 12.052809715270996
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.980 Vali Acc: 0.730 Test Loss: 0.980 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 11.090539932250977
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.982 Vali Acc: 0.727 Test Loss: 0.982 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 11.972877502441406
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.984 Vali Acc: 0.723 Test Loss: 0.984 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 10.823115348815918
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.984 Vali Acc: 0.730 Test Loss: 0.984 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 10.517265796661377
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.983 Vali Acc: 0.727 Test Loss: 0.983 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 10.840537786483765
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.982 Vali Acc: 0.727 Test Loss: 0.982 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 9.837196350097656
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.980 Vali Acc: 0.727 Test Loss: 0.980 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 10.265446901321411
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.980 Vali Acc: 0.727 Test Loss: 0.980 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 11.7857346534729
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.979 Vali Acc: 0.727 Test Loss: 0.979 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.73
model parameter : 497433
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 13.553214073181152
Epoch: 1, Steps: 18 | Train Loss: 3.235 Vali Loss: 3.169 Vali Acc: 0.080 Test Loss: 3.169 Test Acc: 0.080
Validation loss decreased (inf --> -0.079968).  Saving model ...
Epoch: 2 cost time: 10.146247863769531
Epoch: 2, Steps: 18 | Train Loss: 2.939 Vali Loss: 2.972 Vali Acc: 0.187 Test Loss: 2.972 Test Acc: 0.187
Validation loss decreased (-0.079968 --> -0.186637).  Saving model ...
Epoch: 3 cost time: 10.631282091140747
Epoch: 3, Steps: 18 | Train Loss: 2.455 Vali Loss: 2.744 Vali Acc: 0.270 Test Loss: 2.744 Test Acc: 0.270
Validation loss decreased (-0.186637 --> -0.269973).  Saving model ...
Epoch: 4 cost time: 10.720776081085205
Epoch: 4, Steps: 18 | Train Loss: 1.909 Vali Loss: 2.516 Vali Acc: 0.343 Test Loss: 2.516 Test Acc: 0.343
Validation loss decreased (-0.269973 --> -0.343308).  Saving model ...
Epoch: 5 cost time: 10.35563063621521
Epoch: 5, Steps: 18 | Train Loss: 1.339 Vali Loss: 2.299 Vali Acc: 0.377 Test Loss: 2.299 Test Acc: 0.377
Validation loss decreased (-0.343308 --> -0.376644).  Saving model ...
Epoch: 6 cost time: 11.327828407287598
Epoch: 6, Steps: 18 | Train Loss: 0.846 Vali Loss: 2.106 Vali Acc: 0.423 Test Loss: 2.106 Test Acc: 0.423
Validation loss decreased (-0.376644 --> -0.423312).  Saving model ...
Epoch: 7 cost time: 12.45145058631897
Epoch: 7, Steps: 18 | Train Loss: 0.469 Vali Loss: 1.963 Vali Acc: 0.443 Test Loss: 1.963 Test Acc: 0.443
Validation loss decreased (-0.423312 --> -0.443314).  Saving model ...
Epoch: 8 cost time: 13.192304849624634
Epoch: 8, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.874 Vali Acc: 0.433 Test Loss: 1.874 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.136756896972656
Epoch: 9, Steps: 18 | Train Loss: 0.109 Vali Loss: 1.721 Vali Acc: 0.483 Test Loss: 1.721 Test Acc: 0.483
Validation loss decreased (-0.443314 --> -0.483316).  Saving model ...
Epoch: 10 cost time: 13.906307935714722
Epoch: 10, Steps: 18 | Train Loss: 0.057 Vali Loss: 1.668 Vali Acc: 0.507 Test Loss: 1.668 Test Acc: 0.507
Validation loss decreased (-0.483316 --> -0.506650).  Saving model ...
Epoch: 11 cost time: 12.632469415664673
Epoch: 11, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.634 Vali Acc: 0.500 Test Loss: 1.634 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.687270641326904
Epoch: 12, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.588 Vali Acc: 0.520 Test Loss: 1.588 Test Acc: 0.520
Validation loss decreased (-0.506650 --> -0.519984).  Saving model ...
Epoch: 13 cost time: 11.175720453262329
Epoch: 13, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.561 Vali Acc: 0.533 Test Loss: 1.561 Test Acc: 0.533
Validation loss decreased (-0.519984 --> -0.533318).  Saving model ...
Epoch: 14 cost time: 11.391871213912964
Epoch: 14, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.535 Vali Acc: 0.533 Test Loss: 1.535 Test Acc: 0.533
Validation loss decreased (-0.533318 --> -0.533318).  Saving model ...
Epoch: 15 cost time: 11.798820734024048
Epoch: 15, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.508 Vali Acc: 0.553 Test Loss: 1.508 Test Acc: 0.553
Validation loss decreased (-0.533318 --> -0.553318).  Saving model ...
Epoch: 16 cost time: 12.709190368652344
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.486 Vali Acc: 0.560 Test Loss: 1.486 Test Acc: 0.560
Validation loss decreased (-0.553318 --> -0.559985).  Saving model ...
Epoch: 17 cost time: 11.695765256881714
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.464 Vali Acc: 0.563 Test Loss: 1.464 Test Acc: 0.563
Validation loss decreased (-0.559985 --> -0.563319).  Saving model ...
Epoch: 18 cost time: 12.983643770217896
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.446 Vali Acc: 0.577 Test Loss: 1.446 Test Acc: 0.577
Validation loss decreased (-0.563319 --> -0.576652).  Saving model ...
Epoch: 19 cost time: 10.916551113128662
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.435 Vali Acc: 0.580 Test Loss: 1.435 Test Acc: 0.580
Validation loss decreased (-0.576652 --> -0.579986).  Saving model ...
Epoch: 20 cost time: 10.601257801055908
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.423 Vali Acc: 0.583 Test Loss: 1.423 Test Acc: 0.583
Validation loss decreased (-0.579986 --> -0.583319).  Saving model ...
Epoch: 21 cost time: 11.72567367553711
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.410 Vali Acc: 0.597 Test Loss: 1.410 Test Acc: 0.597
Validation loss decreased (-0.583319 --> -0.596653).  Saving model ...
Epoch: 22 cost time: 11.190611600875854
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.398 Vali Acc: 0.593 Test Loss: 1.398 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 11.440165996551514
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.386 Vali Acc: 0.597 Test Loss: 1.386 Test Acc: 0.597
Validation loss decreased (-0.596653 --> -0.596653).  Saving model ...
Epoch: 24 cost time: 11.211779594421387
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.383 Vali Acc: 0.590 Test Loss: 1.383 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 11.138896942138672
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.371 Vali Acc: 0.600 Test Loss: 1.371 Test Acc: 0.600
Validation loss decreased (-0.596653 --> -0.599986).  Saving model ...
Epoch: 26 cost time: 10.510416984558105
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.362 Vali Acc: 0.607 Test Loss: 1.362 Test Acc: 0.607
Validation loss decreased (-0.599986 --> -0.606653).  Saving model ...
Epoch: 27 cost time: 9.778122901916504
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.354 Vali Acc: 0.613 Test Loss: 1.354 Test Acc: 0.613
Validation loss decreased (-0.606653 --> -0.613320).  Saving model ...
Epoch: 28 cost time: 10.15988802909851
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.343 Vali Acc: 0.607 Test Loss: 1.343 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 9.990235567092896
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.336 Vali Acc: 0.623 Test Loss: 1.336 Test Acc: 0.623
Validation loss decreased (-0.613320 --> -0.623320).  Saving model ...
Epoch: 30 cost time: 11.307852983474731
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.334 Vali Acc: 0.620 Test Loss: 1.334 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 12.515584230422974
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.323 Vali Acc: 0.627 Test Loss: 1.323 Test Acc: 0.627
Validation loss decreased (-0.623320 --> -0.626653).  Saving model ...
Epoch: 32 cost time: 11.886791944503784
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.312 Vali Acc: 0.637 Test Loss: 1.312 Test Acc: 0.637
Validation loss decreased (-0.626653 --> -0.636654).  Saving model ...
Epoch: 33 cost time: 11.315575361251831
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.306 Vali Acc: 0.627 Test Loss: 1.306 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 11.56980848312378
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.302 Vali Acc: 0.627 Test Loss: 1.302 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 11.305704832077026
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.296 Vali Acc: 0.633 Test Loss: 1.296 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 10.6893789768219
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.292 Vali Acc: 0.637 Test Loss: 1.292 Test Acc: 0.637
Validation loss decreased (-0.636654 --> -0.636654).  Saving model ...
Epoch: 37 cost time: 11.245925188064575
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.284 Vali Acc: 0.640 Test Loss: 1.284 Test Acc: 0.640
Validation loss decreased (-0.636654 --> -0.639987).  Saving model ...
Epoch: 38 cost time: 11.031750679016113
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.282 Vali Acc: 0.637 Test Loss: 1.282 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 11.062905311584473
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.276 Vali Acc: 0.647 Test Loss: 1.276 Test Acc: 0.647
Validation loss decreased (-0.639987 --> -0.646654).  Saving model ...
Epoch: 40 cost time: 11.438946723937988
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.272 Vali Acc: 0.643 Test Loss: 1.272 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 12.963183879852295
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.265 Vali Acc: 0.650 Test Loss: 1.265 Test Acc: 0.650
Validation loss decreased (-0.646654 --> -0.649987).  Saving model ...
Epoch: 42 cost time: 12.349401235580444
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.263 Vali Acc: 0.640 Test Loss: 1.263 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 13.407246351242065
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.266 Vali Acc: 0.637 Test Loss: 1.266 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 10.209620952606201
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.262 Vali Acc: 0.647 Test Loss: 1.262 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 10.057808876037598
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.256 Vali Acc: 0.643 Test Loss: 1.256 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 9.516354322433472
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.252 Vali Acc: 0.643 Test Loss: 1.252 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 11.30954647064209
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.249 Vali Acc: 0.653 Test Loss: 1.249 Test Acc: 0.653
Validation loss decreased (-0.649987 --> -0.653321).  Saving model ...
Epoch: 48 cost time: 10.403709888458252
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.245 Vali Acc: 0.643 Test Loss: 1.245 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 12.052274703979492
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.240 Vali Acc: 0.650 Test Loss: 1.240 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 11.991641759872437
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.237 Vali Acc: 0.653 Test Loss: 1.237 Test Acc: 0.653
Validation loss decreased (-0.653321 --> -0.653321).  Saving model ...
Epoch: 51 cost time: 11.153905153274536
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.235 Vali Acc: 0.647 Test Loss: 1.235 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 11.684323072433472
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.233 Vali Acc: 0.643 Test Loss: 1.233 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 11.144751787185669
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.231 Vali Acc: 0.653 Test Loss: 1.231 Test Acc: 0.653
Validation loss decreased (-0.653321 --> -0.653321).  Saving model ...
Epoch: 54 cost time: 11.075923681259155
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.228 Vali Acc: 0.663 Test Loss: 1.228 Test Acc: 0.663
Validation loss decreased (-0.653321 --> -0.663321).  Saving model ...
Epoch: 55 cost time: 10.846391916275024
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.228 Vali Acc: 0.670 Test Loss: 1.228 Test Acc: 0.670
Validation loss decreased (-0.663321 --> -0.669988).  Saving model ...
Epoch: 56 cost time: 10.976545572280884
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.226 Vali Acc: 0.667 Test Loss: 1.226 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 10.079598665237427
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.222 Vali Acc: 0.670 Test Loss: 1.222 Test Acc: 0.670
Validation loss decreased (-0.669988 --> -0.669988).  Saving model ...
Epoch: 58 cost time: 11.832258701324463
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.218 Vali Acc: 0.670 Test Loss: 1.218 Test Acc: 0.670
Validation loss decreased (-0.669988 --> -0.669988).  Saving model ...
Epoch: 59 cost time: 11.686643123626709
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.663 Test Loss: 1.218 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 11.598019123077393
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.660 Test Loss: 1.218 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 12.108291387557983
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.663 Test Loss: 1.218 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 11.899686813354492
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.663 Test Loss: 1.216 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 11.74466872215271
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.667 Test Loss: 1.212 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 11.595515489578247
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.670 Test Loss: 1.210 Test Acc: 0.670
Validation loss decreased (-0.669988 --> -0.669988).  Saving model ...
Epoch: 65 cost time: 11.611823797225952
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.673 Test Loss: 1.209 Test Acc: 0.673
Validation loss decreased (-0.669988 --> -0.673321).  Saving model ...
Epoch: 66 cost time: 12.151089429855347
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.673 Test Loss: 1.208 Test Acc: 0.673
Validation loss decreased (-0.673321 --> -0.673321).  Saving model ...
Epoch: 67 cost time: 11.29277515411377
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.677 Test Loss: 1.206 Test Acc: 0.677
Validation loss decreased (-0.673321 --> -0.676655).  Saving model ...
Epoch: 68 cost time: 11.935965061187744
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.670 Test Loss: 1.204 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 10.807785511016846
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.677 Test Loss: 1.202 Test Acc: 0.677
Validation loss decreased (-0.676655 --> -0.676655).  Saving model ...
Epoch: 70 cost time: 11.298851251602173
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.201 Vali Acc: 0.673 Test Loss: 1.201 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 11.876191854476929
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.673 Test Loss: 1.199 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 11.221642971038818
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.196 Vali Acc: 0.677 Test Loss: 1.196 Test Acc: 0.677
Validation loss decreased (-0.676655 --> -0.676655).  Saving model ...
Epoch: 73 cost time: 11.862963199615479
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.680 Test Loss: 1.195 Test Acc: 0.680
Validation loss decreased (-0.676655 --> -0.679988).  Saving model ...
Epoch: 74 cost time: 12.359635591506958
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.680 Test Loss: 1.195 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 11.82040786743164
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.680 Test Loss: 1.194 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 76 cost time: 12.282947540283203
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.680 Test Loss: 1.194 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 77 cost time: 11.82038402557373
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.680 Test Loss: 1.192 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 78 cost time: 11.720924377441406
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.680 Test Loss: 1.189 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 79 cost time: 11.148011207580566
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.680 Test Loss: 1.189 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 80 cost time: 12.394749879837036
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.680 Test Loss: 1.187 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 81 cost time: 11.940929174423218
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.186 Vali Acc: 0.677 Test Loss: 1.186 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 12.955793142318726
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.677 Test Loss: 1.184 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 12.585868120193481
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.677 Test Loss: 1.183 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 11.66667366027832
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.677 Test Loss: 1.184 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 11.38497543334961
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.677 Test Loss: 1.184 Test Acc: 0.677
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 11.609142541885376
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.677 Test Loss: 1.182 Test Acc: 0.677
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 12.336979627609253
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.677 Test Loss: 1.179 Test Acc: 0.677
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 11.872801780700684
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.680 Test Loss: 1.178 Test Acc: 0.680
Validation loss decreased (-0.679988 --> -0.679988).  Saving model ...
Epoch: 89 cost time: 10.712635517120361
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.683 Test Loss: 1.178 Test Acc: 0.683
Validation loss decreased (-0.679988 --> -0.683322).  Saving model ...
Epoch: 90 cost time: 10.889578819274902
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.683 Test Loss: 1.177 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 91 cost time: 10.52129602432251
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.683 Test Loss: 1.178 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 11.842229843139648
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.176 Vali Acc: 0.677 Test Loss: 1.176 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 9.718415975570679
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.677 Test Loss: 1.175 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 11.202755451202393
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.680 Test Loss: 1.173 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 9.65816593170166
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.680 Test Loss: 1.173 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 10.572835922241211
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.171 Vali Acc: 0.683 Test Loss: 1.171 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 97 cost time: 9.889847993850708
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.170 Vali Acc: 0.683 Test Loss: 1.170 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 98 cost time: 10.73390531539917
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.683 Test Loss: 1.169 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 99 cost time: 11.554396390914917
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.168 Vali Acc: 0.683 Test Loss: 1.168 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 100 cost time: 10.548279047012329
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.680 Test Loss: 1.167 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6833333333333333
model parameter : 497433
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 13.289122343063354
Epoch: 1, Steps: 18 | Train Loss: 3.280 Vali Loss: 3.199 Vali Acc: 0.067 Test Loss: 3.199 Test Acc: 0.067
Validation loss decreased (inf --> -0.066635).  Saving model ...
Epoch: 2 cost time: 10.972631931304932
Epoch: 2, Steps: 18 | Train Loss: 2.980 Vali Loss: 3.052 Vali Acc: 0.137 Test Loss: 3.052 Test Acc: 0.137
Validation loss decreased (-0.066635 --> -0.136636).  Saving model ...
Epoch: 3 cost time: 10.924723863601685
Epoch: 3, Steps: 18 | Train Loss: 2.553 Vali Loss: 2.880 Vali Acc: 0.223 Test Loss: 2.880 Test Acc: 0.223
Validation loss decreased (-0.136636 --> -0.223305).  Saving model ...
Epoch: 4 cost time: 10.676773071289062
Epoch: 4, Steps: 18 | Train Loss: 2.000 Vali Loss: 2.706 Vali Acc: 0.273 Test Loss: 2.706 Test Acc: 0.273
Validation loss decreased (-0.223305 --> -0.273306).  Saving model ...
Epoch: 5 cost time: 12.527636289596558
Epoch: 5, Steps: 18 | Train Loss: 1.462 Vali Loss: 2.540 Vali Acc: 0.333 Test Loss: 2.540 Test Acc: 0.333
Validation loss decreased (-0.273306 --> -0.333308).  Saving model ...
Epoch: 6 cost time: 11.608755826950073
Epoch: 6, Steps: 18 | Train Loss: 0.948 Vali Loss: 2.384 Vali Acc: 0.340 Test Loss: 2.384 Test Acc: 0.340
Validation loss decreased (-0.333308 --> -0.339976).  Saving model ...
Epoch: 7 cost time: 10.8377103805542
Epoch: 7, Steps: 18 | Train Loss: 0.549 Vali Loss: 2.278 Vali Acc: 0.383 Test Loss: 2.278 Test Acc: 0.383
Validation loss decreased (-0.339976 --> -0.383311).  Saving model ...
Epoch: 8 cost time: 10.85744309425354
Epoch: 8, Steps: 18 | Train Loss: 0.280 Vali Loss: 2.190 Vali Acc: 0.370 Test Loss: 2.190 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.077991247177124
Epoch: 9, Steps: 18 | Train Loss: 0.134 Vali Loss: 2.043 Vali Acc: 0.363 Test Loss: 2.043 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.121270418167114
Epoch: 10, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.993 Vali Acc: 0.373 Test Loss: 1.993 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.645933628082275
Epoch: 11, Steps: 18 | Train Loss: 0.046 Vali Loss: 1.936 Vali Acc: 0.410 Test Loss: 1.936 Test Acc: 0.410
Validation loss decreased (-0.383311 --> -0.409981).  Saving model ...
Epoch: 12 cost time: 11.144134998321533
Epoch: 12, Steps: 18 | Train Loss: 0.031 Vali Loss: 1.890 Vali Acc: 0.427 Test Loss: 1.890 Test Acc: 0.427
Validation loss decreased (-0.409981 --> -0.426648).  Saving model ...
Epoch: 13 cost time: 11.524593114852905
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.851 Vali Acc: 0.450 Test Loss: 1.851 Test Acc: 0.450
Validation loss decreased (-0.426648 --> -0.449981).  Saving model ...
Epoch: 14 cost time: 10.599290609359741
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.814 Vali Acc: 0.460 Test Loss: 1.814 Test Acc: 0.460
Validation loss decreased (-0.449981 --> -0.459982).  Saving model ...
Epoch: 15 cost time: 10.681362628936768
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.794 Vali Acc: 0.467 Test Loss: 1.794 Test Acc: 0.467
Validation loss decreased (-0.459982 --> -0.466649).  Saving model ...
Epoch: 16 cost time: 10.968173265457153
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.753 Vali Acc: 0.470 Test Loss: 1.753 Test Acc: 0.470
Validation loss decreased (-0.466649 --> -0.469982).  Saving model ...
Epoch: 17 cost time: 11.151323556900024
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.735 Vali Acc: 0.473 Test Loss: 1.735 Test Acc: 0.473
Validation loss decreased (-0.469982 --> -0.473316).  Saving model ...
Epoch: 18 cost time: 9.933581590652466
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.713 Vali Acc: 0.483 Test Loss: 1.713 Test Acc: 0.483
Validation loss decreased (-0.473316 --> -0.483316).  Saving model ...
Epoch: 19 cost time: 10.952056646347046
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.686 Vali Acc: 0.483 Test Loss: 1.686 Test Acc: 0.483
Validation loss decreased (-0.483316 --> -0.483316).  Saving model ...
Epoch: 20 cost time: 10.282361030578613
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.672 Vali Acc: 0.487 Test Loss: 1.672 Test Acc: 0.487
Validation loss decreased (-0.483316 --> -0.486650).  Saving model ...
Epoch: 21 cost time: 11.05626392364502
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.663 Vali Acc: 0.483 Test Loss: 1.663 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 10.646912336349487
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.644 Vali Acc: 0.493 Test Loss: 1.644 Test Acc: 0.493
Validation loss decreased (-0.486650 --> -0.493317).  Saving model ...
Epoch: 23 cost time: 9.746206998825073
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.627 Vali Acc: 0.503 Test Loss: 1.627 Test Acc: 0.503
Validation loss decreased (-0.493317 --> -0.503317).  Saving model ...
Epoch: 24 cost time: 11.841195344924927
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.615 Vali Acc: 0.517 Test Loss: 1.615 Test Acc: 0.517
Validation loss decreased (-0.503317 --> -0.516651).  Saving model ...
Epoch: 25 cost time: 10.565608024597168
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.605 Vali Acc: 0.517 Test Loss: 1.605 Test Acc: 0.517
Validation loss decreased (-0.516651 --> -0.516651).  Saving model ...
Epoch: 26 cost time: 11.252389907836914
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.593 Vali Acc: 0.517 Test Loss: 1.593 Test Acc: 0.517
Validation loss decreased (-0.516651 --> -0.516651).  Saving model ...
Epoch: 27 cost time: 10.709811687469482
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.593 Vali Acc: 0.510 Test Loss: 1.593 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 10.348556756973267
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.574 Vali Acc: 0.517 Test Loss: 1.574 Test Acc: 0.517
Validation loss decreased (-0.516651 --> -0.516651).  Saving model ...
Epoch: 29 cost time: 10.332456827163696
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.562 Vali Acc: 0.517 Test Loss: 1.562 Test Acc: 0.517
Validation loss decreased (-0.516651 --> -0.516651).  Saving model ...
Epoch: 30 cost time: 9.81118369102478
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.552 Vali Acc: 0.513 Test Loss: 1.552 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 11.498204469680786
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.539 Vali Acc: 0.520 Test Loss: 1.539 Test Acc: 0.520
Validation loss decreased (-0.516651 --> -0.519985).  Saving model ...
Epoch: 32 cost time: 11.743425607681274
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.539 Vali Acc: 0.513 Test Loss: 1.539 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 11.356323480606079
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.533 Vali Acc: 0.523 Test Loss: 1.533 Test Acc: 0.523
Validation loss decreased (-0.519985 --> -0.523318).  Saving model ...
Epoch: 34 cost time: 11.360620021820068
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.527 Vali Acc: 0.527 Test Loss: 1.527 Test Acc: 0.527
Validation loss decreased (-0.523318 --> -0.526651).  Saving model ...
Epoch: 35 cost time: 12.121302604675293
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.523 Vali Acc: 0.537 Test Loss: 1.523 Test Acc: 0.537
Validation loss decreased (-0.526651 --> -0.536651).  Saving model ...
Epoch: 36 cost time: 10.782354354858398
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.518 Vali Acc: 0.533 Test Loss: 1.518 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 10.428897142410278
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.513 Vali Acc: 0.537 Test Loss: 1.513 Test Acc: 0.537
Validation loss decreased (-0.536651 --> -0.536652).  Saving model ...
Epoch: 38 cost time: 10.018497705459595
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.509 Vali Acc: 0.550 Test Loss: 1.509 Test Acc: 0.550
Validation loss decreased (-0.536652 --> -0.549985).  Saving model ...
Epoch: 39 cost time: 11.04004693031311
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.499 Vali Acc: 0.543 Test Loss: 1.499 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 11.749422550201416
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.492 Vali Acc: 0.543 Test Loss: 1.492 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 10.962203025817871
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.491 Vali Acc: 0.540 Test Loss: 1.491 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 11.535189151763916
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.484 Vali Acc: 0.557 Test Loss: 1.484 Test Acc: 0.557
Validation loss decreased (-0.549985 --> -0.556652).  Saving model ...
Epoch: 43 cost time: 11.506780624389648
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.482 Vali Acc: 0.547 Test Loss: 1.482 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 10.852322101593018
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.543 Test Loss: 1.477 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 10.656630992889404
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.476 Vali Acc: 0.563 Test Loss: 1.476 Test Acc: 0.563
Validation loss decreased (-0.556652 --> -0.563319).  Saving model ...
Epoch: 46 cost time: 10.969520092010498
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.472 Vali Acc: 0.560 Test Loss: 1.472 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 11.051934242248535
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.468 Vali Acc: 0.563 Test Loss: 1.468 Test Acc: 0.563
Validation loss decreased (-0.563319 --> -0.563319).  Saving model ...
Epoch: 48 cost time: 9.4748215675354
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.462 Vali Acc: 0.557 Test Loss: 1.462 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 11.166137933731079
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.455 Vali Acc: 0.567 Test Loss: 1.455 Test Acc: 0.567
Validation loss decreased (-0.563319 --> -0.566652).  Saving model ...
Epoch: 50 cost time: 10.476988792419434
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.454 Vali Acc: 0.557 Test Loss: 1.454 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 10.406259536743164
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.450 Vali Acc: 0.560 Test Loss: 1.450 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 11.268658876419067
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.447 Vali Acc: 0.560 Test Loss: 1.447 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 9.659510374069214
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.445 Vali Acc: 0.563 Test Loss: 1.445 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 10.522628784179688
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.444 Vali Acc: 0.567 Test Loss: 1.444 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566652).  Saving model ...
Epoch: 55 cost time: 10.995549201965332
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.440 Vali Acc: 0.570 Test Loss: 1.440 Test Acc: 0.570
Validation loss decreased (-0.566652 --> -0.569986).  Saving model ...
Epoch: 56 cost time: 12.039109230041504
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.441 Vali Acc: 0.577 Test Loss: 1.441 Test Acc: 0.577
Validation loss decreased (-0.569986 --> -0.576652).  Saving model ...
Epoch: 57 cost time: 9.697516202926636
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.438 Vali Acc: 0.573 Test Loss: 1.438 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 10.28244423866272
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.434 Vali Acc: 0.563 Test Loss: 1.434 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 9.243384838104248
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.573 Test Loss: 1.429 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 9.885456323623657
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.580 Test Loss: 1.430 Test Acc: 0.580
Validation loss decreased (-0.576652 --> -0.579986).  Saving model ...
Epoch: 61 cost time: 9.478547096252441
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.577 Test Loss: 1.428 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 10.095789194107056
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.583 Test Loss: 1.424 Test Acc: 0.583
Validation loss decreased (-0.579986 --> -0.583319).  Saving model ...
Epoch: 63 cost time: 10.801093339920044
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.587 Test Loss: 1.422 Test Acc: 0.587
Validation loss decreased (-0.583319 --> -0.586652).  Saving model ...
Epoch: 64 cost time: 11.439481973648071
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.583 Test Loss: 1.422 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 11.218802452087402
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.587 Test Loss: 1.422 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 10.578290224075317
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.583 Test Loss: 1.422 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 11.350016355514526
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.583 Test Loss: 1.418 Test Acc: 0.583
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 9.986671924591064
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.583 Test Loss: 1.418 Test Acc: 0.583
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 11.8058602809906
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.580 Test Loss: 1.416 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 11.34606647491455
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.587 Test Loss: 1.411 Test Acc: 0.587
Validation loss decreased (-0.586652 --> -0.586653).  Saving model ...
Epoch: 71 cost time: 10.483461856842041
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.590 Test Loss: 1.408 Test Acc: 0.590
Validation loss decreased (-0.586653 --> -0.589986).  Saving model ...
Epoch: 72 cost time: 11.629881620407104
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.590 Test Loss: 1.405 Test Acc: 0.590
Validation loss decreased (-0.589986 --> -0.589986).  Saving model ...
Epoch: 73 cost time: 11.545177459716797
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.597 Test Loss: 1.408 Test Acc: 0.597
Validation loss decreased (-0.589986 --> -0.596653).  Saving model ...
Epoch: 74 cost time: 10.992403507232666
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.590 Test Loss: 1.409 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 10.985438108444214
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.597 Test Loss: 1.406 Test Acc: 0.597
Validation loss decreased (-0.596653 --> -0.596653).  Saving model ...
Epoch: 76 cost time: 11.007674217224121
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.600 Test Loss: 1.403 Test Acc: 0.600
Validation loss decreased (-0.596653 --> -0.599986).  Saving model ...
Epoch: 77 cost time: 10.567601442337036
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.603 Test Loss: 1.399 Test Acc: 0.603
Validation loss decreased (-0.599986 --> -0.603319).  Saving model ...
Epoch: 78 cost time: 10.2044837474823
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.603 Test Loss: 1.398 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 79 cost time: 11.42401909828186
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.600 Test Loss: 1.397 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 10.561198711395264
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.603 Test Loss: 1.393 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 81 cost time: 9.75252890586853
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.603 Test Loss: 1.391 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 82 cost time: 9.866105079650879
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.607 Test Loss: 1.389 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606653).  Saving model ...
Epoch: 83 cost time: 10.31495475769043
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.607 Test Loss: 1.388 Test Acc: 0.607
Validation loss decreased (-0.606653 --> -0.606653).  Saving model ...
Epoch: 84 cost time: 11.80490231513977
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.607 Test Loss: 1.388 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 11.009342908859253
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.610 Test Loss: 1.390 Test Acc: 0.610
Validation loss decreased (-0.606653 --> -0.609986).  Saving model ...
Epoch: 86 cost time: 10.271632194519043
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.607 Test Loss: 1.388 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 10.521776914596558
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.613 Test Loss: 1.383 Test Acc: 0.613
Validation loss decreased (-0.609986 --> -0.613320).  Saving model ...
Epoch: 88 cost time: 11.071899175643921
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.607 Test Loss: 1.381 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 10.220780849456787
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.610 Test Loss: 1.380 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 10.856216669082642
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.610 Test Loss: 1.381 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 10.151540517807007
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.610 Test Loss: 1.381 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 11.99394965171814
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.613 Test Loss: 1.380 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 93 cost time: 10.799450159072876
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.378 Vali Acc: 0.617 Test Loss: 1.378 Test Acc: 0.617
Validation loss decreased (-0.613320 --> -0.616653).  Saving model ...
Epoch: 94 cost time: 12.199673175811768
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.613 Test Loss: 1.376 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 11.211467027664185
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.613 Test Loss: 1.374 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 10.76474404335022
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.613 Test Loss: 1.374 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 10.614169597625732
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.613 Test Loss: 1.374 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 11.930858135223389
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.617 Test Loss: 1.372 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616653).  Saving model ...
Epoch: 99 cost time: 10.959179878234863
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.617 Test Loss: 1.370 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616653).  Saving model ...
Epoch: 100 cost time: 11.38481092453003
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.613 Test Loss: 1.368 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6166666666666667
model parameter : 497433
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 11.65852403640747
Epoch: 1, Steps: 18 | Train Loss: 3.278 Vali Loss: 3.226 Vali Acc: 0.057 Test Loss: 3.226 Test Acc: 0.057
Validation loss decreased (inf --> -0.056634).  Saving model ...
Epoch: 2 cost time: 8.31806468963623
Epoch: 2, Steps: 18 | Train Loss: 2.995 Vali Loss: 3.148 Vali Acc: 0.083 Test Loss: 3.148 Test Acc: 0.083
Validation loss decreased (-0.056634 --> -0.083302).  Saving model ...
Epoch: 3 cost time: 9.194182872772217
Epoch: 3, Steps: 18 | Train Loss: 2.609 Vali Loss: 3.043 Vali Acc: 0.090 Test Loss: 3.043 Test Acc: 0.090
Validation loss decreased (-0.083302 --> -0.089970).  Saving model ...
Epoch: 4 cost time: 9.265720129013062
Epoch: 4, Steps: 18 | Train Loss: 2.109 Vali Loss: 2.940 Vali Acc: 0.117 Test Loss: 2.940 Test Acc: 0.117
Validation loss decreased (-0.089970 --> -0.116637).  Saving model ...
Epoch: 5 cost time: 10.478670120239258
Epoch: 5, Steps: 18 | Train Loss: 1.571 Vali Loss: 2.846 Vali Acc: 0.130 Test Loss: 2.846 Test Acc: 0.130
Validation loss decreased (-0.116637 --> -0.129972).  Saving model ...
Epoch: 6 cost time: 10.97274398803711
Epoch: 6, Steps: 18 | Train Loss: 1.060 Vali Loss: 2.747 Vali Acc: 0.173 Test Loss: 2.747 Test Acc: 0.173
Validation loss decreased (-0.129972 --> -0.173306).  Saving model ...
Epoch: 7 cost time: 9.063010931015015
Epoch: 7, Steps: 18 | Train Loss: 0.646 Vali Loss: 2.731 Vali Acc: 0.147 Test Loss: 2.731 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.13548994064331
Epoch: 8, Steps: 18 | Train Loss: 0.359 Vali Loss: 2.639 Vali Acc: 0.183 Test Loss: 2.639 Test Acc: 0.183
Validation loss decreased (-0.173306 --> -0.183307).  Saving model ...
Epoch: 9 cost time: 10.276866436004639
Epoch: 9, Steps: 18 | Train Loss: 0.183 Vali Loss: 2.590 Vali Acc: 0.213 Test Loss: 2.590 Test Acc: 0.213
Validation loss decreased (-0.183307 --> -0.213307).  Saving model ...
Epoch: 10 cost time: 9.17514419555664
Epoch: 10, Steps: 18 | Train Loss: 0.097 Vali Loss: 2.521 Vali Acc: 0.223 Test Loss: 2.521 Test Acc: 0.223
Validation loss decreased (-0.213307 --> -0.223308).  Saving model ...
Epoch: 11 cost time: 9.066880702972412
Epoch: 11, Steps: 18 | Train Loss: 0.060 Vali Loss: 2.444 Vali Acc: 0.240 Test Loss: 2.444 Test Acc: 0.240
Validation loss decreased (-0.223308 --> -0.239976).  Saving model ...
Epoch: 12 cost time: 8.67004919052124
Epoch: 12, Steps: 18 | Train Loss: 0.040 Vali Loss: 2.423 Vali Acc: 0.250 Test Loss: 2.423 Test Acc: 0.250
Validation loss decreased (-0.239976 --> -0.249976).  Saving model ...
Epoch: 13 cost time: 10.241580724716187
Epoch: 13, Steps: 18 | Train Loss: 0.030 Vali Loss: 2.357 Vali Acc: 0.247 Test Loss: 2.357 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.923508167266846
Epoch: 14, Steps: 18 | Train Loss: 0.024 Vali Loss: 2.319 Vali Acc: 0.270 Test Loss: 2.319 Test Acc: 0.270
Validation loss decreased (-0.249976 --> -0.269977).  Saving model ...
Epoch: 15 cost time: 11.910463094711304
Epoch: 15, Steps: 18 | Train Loss: 0.019 Vali Loss: 2.302 Vali Acc: 0.267 Test Loss: 2.302 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.013590097427368
Epoch: 16, Steps: 18 | Train Loss: 0.016 Vali Loss: 2.252 Vali Acc: 0.293 Test Loss: 2.252 Test Acc: 0.293
Validation loss decreased (-0.269977 --> -0.293311).  Saving model ...
Epoch: 17 cost time: 10.629235982894897
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 2.229 Vali Acc: 0.320 Test Loss: 2.229 Test Acc: 0.320
Validation loss decreased (-0.293311 --> -0.319978).  Saving model ...
Epoch: 18 cost time: 9.403014421463013
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.193 Vali Acc: 0.317 Test Loss: 2.193 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.190807580947876
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.150 Vali Acc: 0.320 Test Loss: 2.150 Test Acc: 0.320
Validation loss decreased (-0.319978 --> -0.319979).  Saving model ...
Epoch: 20 cost time: 8.935968399047852
Epoch: 20, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.113 Vali Acc: 0.333 Test Loss: 2.113 Test Acc: 0.333
Validation loss decreased (-0.319979 --> -0.333312).  Saving model ...
Epoch: 21 cost time: 10.383726835250854
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.094 Vali Acc: 0.337 Test Loss: 2.094 Test Acc: 0.337
Validation loss decreased (-0.333312 --> -0.336646).  Saving model ...
Epoch: 22 cost time: 11.364193201065063
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.079 Vali Acc: 0.343 Test Loss: 2.079 Test Acc: 0.343
Validation loss decreased (-0.336646 --> -0.343313).  Saving model ...
Epoch: 23 cost time: 10.022390604019165
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.051 Vali Acc: 0.363 Test Loss: 2.051 Test Acc: 0.363
Validation loss decreased (-0.343313 --> -0.363313).  Saving model ...
Epoch: 24 cost time: 10.31169605255127
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.018 Vali Acc: 0.353 Test Loss: 2.018 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 11.809451341629028
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.001 Vali Acc: 0.370 Test Loss: 2.001 Test Acc: 0.370
Validation loss decreased (-0.363313 --> -0.369980).  Saving model ...
Epoch: 26 cost time: 11.361274003982544
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.976 Vali Acc: 0.403 Test Loss: 1.976 Test Acc: 0.403
Validation loss decreased (-0.369980 --> -0.403314).  Saving model ...
Epoch: 27 cost time: 10.60878849029541
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.959 Vali Acc: 0.417 Test Loss: 1.959 Test Acc: 0.417
Validation loss decreased (-0.403314 --> -0.416647).  Saving model ...
Epoch: 28 cost time: 10.22584056854248
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.930 Vali Acc: 0.420 Test Loss: 1.930 Test Acc: 0.420
Validation loss decreased (-0.416647 --> -0.419981).  Saving model ...
Epoch: 29 cost time: 9.779048204421997
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.915 Vali Acc: 0.413 Test Loss: 1.915 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 10.25600528717041
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.896 Vali Acc: 0.417 Test Loss: 1.896 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 10.41472601890564
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.884 Vali Acc: 0.420 Test Loss: 1.884 Test Acc: 0.420
Validation loss decreased (-0.419981 --> -0.419981).  Saving model ...
Epoch: 32 cost time: 11.270961999893188
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.878 Vali Acc: 0.433 Test Loss: 1.878 Test Acc: 0.433
Validation loss decreased (-0.419981 --> -0.433315).  Saving model ...
Epoch: 33 cost time: 11.113332748413086
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.856 Vali Acc: 0.460 Test Loss: 1.856 Test Acc: 0.460
Validation loss decreased (-0.433315 --> -0.459981).  Saving model ...
Epoch: 34 cost time: 9.399138927459717
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.834 Vali Acc: 0.460 Test Loss: 1.834 Test Acc: 0.460
Validation loss decreased (-0.459981 --> -0.459982).  Saving model ...
Epoch: 35 cost time: 9.644855737686157
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.821 Vali Acc: 0.480 Test Loss: 1.821 Test Acc: 0.480
Validation loss decreased (-0.459982 --> -0.479982).  Saving model ...
Epoch: 36 cost time: 9.848632574081421
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.807 Vali Acc: 0.477 Test Loss: 1.807 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 10.494747400283813
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.797 Vali Acc: 0.473 Test Loss: 1.797 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 8.62569522857666
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.788 Vali Acc: 0.490 Test Loss: 1.788 Test Acc: 0.490
Validation loss decreased (-0.479982 --> -0.489982).  Saving model ...
Epoch: 39 cost time: 8.73786187171936
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.781 Vali Acc: 0.490 Test Loss: 1.781 Test Acc: 0.490
Validation loss decreased (-0.489982 --> -0.489982).  Saving model ...
Epoch: 40 cost time: 8.81223464012146
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.770 Vali Acc: 0.483 Test Loss: 1.770 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 10.653588771820068
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.761 Vali Acc: 0.493 Test Loss: 1.761 Test Acc: 0.493
Validation loss decreased (-0.489982 --> -0.493316).  Saving model ...
Epoch: 42 cost time: 10.832862854003906
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.500 Test Loss: 1.749 Test Acc: 0.500
Validation loss decreased (-0.493316 --> -0.499983).  Saving model ...
Epoch: 43 cost time: 11.170683860778809
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.742 Vali Acc: 0.497 Test Loss: 1.742 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 9.955815076828003
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.731 Vali Acc: 0.500 Test Loss: 1.731 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499983).  Saving model ...
Epoch: 45 cost time: 10.388398170471191
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.717 Vali Acc: 0.500 Test Loss: 1.717 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499983).  Saving model ...
Epoch: 46 cost time: 10.628175497055054
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.708 Vali Acc: 0.503 Test Loss: 1.708 Test Acc: 0.503
Validation loss decreased (-0.499983 --> -0.503316).  Saving model ...
Epoch: 47 cost time: 9.72711443901062
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.701 Vali Acc: 0.507 Test Loss: 1.701 Test Acc: 0.507
Validation loss decreased (-0.503316 --> -0.506650).  Saving model ...
Epoch: 48 cost time: 9.948156833648682
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.694 Vali Acc: 0.510 Test Loss: 1.694 Test Acc: 0.510
Validation loss decreased (-0.506650 --> -0.509983).  Saving model ...
Epoch: 49 cost time: 9.578299522399902
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.520 Test Loss: 1.688 Test Acc: 0.520
Validation loss decreased (-0.509983 --> -0.519983).  Saving model ...
Epoch: 50 cost time: 10.47473931312561
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.683 Vali Acc: 0.513 Test Loss: 1.683 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 11.2040855884552
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.676 Vali Acc: 0.527 Test Loss: 1.676 Test Acc: 0.527
Validation loss decreased (-0.519983 --> -0.526650).  Saving model ...
Epoch: 52 cost time: 11.349331140518188
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.667 Vali Acc: 0.533 Test Loss: 1.667 Test Acc: 0.533
Validation loss decreased (-0.526650 --> -0.533317).  Saving model ...
Epoch: 53 cost time: 11.855218648910522
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.656 Vali Acc: 0.533 Test Loss: 1.656 Test Acc: 0.533
Validation loss decreased (-0.533317 --> -0.533317).  Saving model ...
Epoch: 54 cost time: 10.988259553909302
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.648 Vali Acc: 0.527 Test Loss: 1.648 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 11.465851306915283
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.643 Vali Acc: 0.530 Test Loss: 1.643 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 11.823211431503296
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.634 Vali Acc: 0.527 Test Loss: 1.634 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 11.17703628540039
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.629 Vali Acc: 0.537 Test Loss: 1.629 Test Acc: 0.537
Validation loss decreased (-0.533317 --> -0.536650).  Saving model ...
Epoch: 58 cost time: 10.434041023254395
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.631 Vali Acc: 0.537 Test Loss: 1.631 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 10.449848890304565
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.623 Vali Acc: 0.537 Test Loss: 1.623 Test Acc: 0.537
Validation loss decreased (-0.536650 --> -0.536650).  Saving model ...
Epoch: 60 cost time: 10.765321016311646
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.616 Vali Acc: 0.553 Test Loss: 1.616 Test Acc: 0.553
Validation loss decreased (-0.536650 --> -0.553317).  Saving model ...
Epoch: 61 cost time: 11.895057916641235
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.612 Vali Acc: 0.550 Test Loss: 1.612 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 11.424141883850098
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.605 Vali Acc: 0.557 Test Loss: 1.605 Test Acc: 0.557
Validation loss decreased (-0.553317 --> -0.556651).  Saving model ...
Epoch: 63 cost time: 11.531705856323242
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.557 Test Loss: 1.601 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 64 cost time: 10.931612014770508
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.550 Test Loss: 1.596 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 11.128610610961914
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.599 Vali Acc: 0.553 Test Loss: 1.599 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 9.947176456451416
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.599 Vali Acc: 0.557 Test Loss: 1.599 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 67 cost time: 10.485992908477783
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.557 Test Loss: 1.590 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 68 cost time: 10.831201314926147
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.557 Test Loss: 1.582 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 69 cost time: 10.36740756034851
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.577 Vali Acc: 0.567 Test Loss: 1.577 Test Acc: 0.567
Validation loss decreased (-0.556651 --> -0.566651).  Saving model ...
Epoch: 70 cost time: 12.658501386642456
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.560 Test Loss: 1.578 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 11.056128740310669
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.567 Test Loss: 1.574 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 72 cost time: 10.736580610275269
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.577 Test Loss: 1.569 Test Acc: 0.577
Validation loss decreased (-0.566651 --> -0.576651).  Saving model ...
Epoch: 73 cost time: 10.347378969192505
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.580 Test Loss: 1.569 Test Acc: 0.580
Validation loss decreased (-0.576651 --> -0.579984).  Saving model ...
Epoch: 74 cost time: 10.948535919189453
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.580 Test Loss: 1.562 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579984).  Saving model ...
Epoch: 75 cost time: 9.566028356552124
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.577 Test Loss: 1.559 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 11.341105222702026
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.573 Test Loss: 1.556 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 11.774005889892578
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.580 Test Loss: 1.553 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579984).  Saving model ...
Epoch: 78 cost time: 10.898149490356445
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.552 Vali Acc: 0.577 Test Loss: 1.552 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 9.270969152450562
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.577 Test Loss: 1.547 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 11.186785697937012
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.544 Vali Acc: 0.580 Test Loss: 1.544 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579985).  Saving model ...
Epoch: 81 cost time: 11.105170011520386
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.543 Vali Acc: 0.577 Test Loss: 1.543 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 11.293277263641357
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.580 Test Loss: 1.538 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 83 cost time: 11.781114339828491
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.583 Test Loss: 1.535 Test Acc: 0.583
Validation loss decreased (-0.579985 --> -0.583318).  Saving model ...
Epoch: 84 cost time: 10.924329042434692
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.583 Test Loss: 1.531 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583318).  Saving model ...
Epoch: 85 cost time: 10.955710411071777
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.587 Test Loss: 1.527 Test Acc: 0.587
Validation loss decreased (-0.583318 --> -0.586651).  Saving model ...
Epoch: 86 cost time: 10.852793455123901
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.577 Test Loss: 1.525 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 10.292376041412354
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.580 Test Loss: 1.521 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 10.318258047103882
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.583 Test Loss: 1.520 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 10.555910110473633
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.583 Test Loss: 1.520 Test Acc: 0.583
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 11.091331958770752
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.587 Test Loss: 1.521 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 91 cost time: 11.149343729019165
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.587 Test Loss: 1.520 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 92 cost time: 11.176710605621338
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.593 Test Loss: 1.519 Test Acc: 0.593
Validation loss decreased (-0.586651 --> -0.593318).  Saving model ...
Epoch: 93 cost time: 10.200299263000488
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.593 Test Loss: 1.515 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 94 cost time: 9.853594064712524
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.600 Test Loss: 1.510 Test Acc: 0.600
Validation loss decreased (-0.593318 --> -0.599985).  Saving model ...
Epoch: 95 cost time: 10.721113681793213
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.593 Test Loss: 1.506 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 9.873024463653564
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.593 Test Loss: 1.501 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 10.16493844985962
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.593 Test Loss: 1.500 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 11.000468254089355
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.593 Test Loss: 1.497 Test Acc: 0.593
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 11.080838680267334
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.597 Test Loss: 1.497 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 9.99782419204712
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.597 Test Loss: 1.496 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6
model parameter : 497433
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 11.724894046783447
Epoch: 1, Steps: 18 | Train Loss: 3.321 Vali Loss: 3.255 Vali Acc: 0.057 Test Loss: 3.255 Test Acc: 0.057
Validation loss decreased (inf --> -0.056634).  Saving model ...
Epoch: 2 cost time: 8.59768557548523
Epoch: 2, Steps: 18 | Train Loss: 3.060 Vali Loss: 3.178 Vali Acc: 0.053 Test Loss: 3.178 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.153934001922607
Epoch: 3, Steps: 18 | Train Loss: 2.741 Vali Loss: 3.076 Vali Acc: 0.123 Test Loss: 3.076 Test Acc: 0.123
Validation loss decreased (-0.056634 --> -0.123303).  Saving model ...
Epoch: 4 cost time: 9.328902959823608
Epoch: 4, Steps: 18 | Train Loss: 2.319 Vali Loss: 2.973 Vali Acc: 0.140 Test Loss: 2.973 Test Acc: 0.140
Validation loss decreased (-0.123303 --> -0.139970).  Saving model ...
Epoch: 5 cost time: 8.877684116363525
Epoch: 5, Steps: 18 | Train Loss: 1.815 Vali Loss: 2.876 Vali Acc: 0.167 Test Loss: 2.876 Test Acc: 0.167
Validation loss decreased (-0.139970 --> -0.166638).  Saving model ...
Epoch: 6 cost time: 8.15673303604126
Epoch: 6, Steps: 18 | Train Loss: 1.349 Vali Loss: 2.766 Vali Acc: 0.180 Test Loss: 2.766 Test Acc: 0.180
Validation loss decreased (-0.166638 --> -0.179972).  Saving model ...
Epoch: 7 cost time: 9.39639401435852
Epoch: 7, Steps: 18 | Train Loss: 0.927 Vali Loss: 2.671 Vali Acc: 0.213 Test Loss: 2.671 Test Acc: 0.213
Validation loss decreased (-0.179972 --> -0.213307).  Saving model ...
Epoch: 8 cost time: 9.15510082244873
Epoch: 8, Steps: 18 | Train Loss: 0.578 Vali Loss: 2.546 Vali Acc: 0.227 Test Loss: 2.546 Test Acc: 0.227
Validation loss decreased (-0.213307 --> -0.226641).  Saving model ...
Epoch: 9 cost time: 10.122374057769775
Epoch: 9, Steps: 18 | Train Loss: 0.337 Vali Loss: 2.379 Vali Acc: 0.303 Test Loss: 2.379 Test Acc: 0.303
Validation loss decreased (-0.226641 --> -0.303310).  Saving model ...
Epoch: 10 cost time: 10.154128551483154
Epoch: 10, Steps: 18 | Train Loss: 0.179 Vali Loss: 2.306 Vali Acc: 0.293 Test Loss: 2.306 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.261983156204224
Epoch: 11, Steps: 18 | Train Loss: 0.096 Vali Loss: 2.118 Vali Acc: 0.357 Test Loss: 2.118 Test Acc: 0.357
Validation loss decreased (-0.303310 --> -0.356645).  Saving model ...
Epoch: 12 cost time: 9.641197443008423
Epoch: 12, Steps: 18 | Train Loss: 0.062 Vali Loss: 2.137 Vali Acc: 0.347 Test Loss: 2.137 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.972723245620728
Epoch: 13, Steps: 18 | Train Loss: 0.046 Vali Loss: 2.019 Vali Acc: 0.370 Test Loss: 2.019 Test Acc: 0.370
Validation loss decreased (-0.356645 --> -0.369980).  Saving model ...
Epoch: 14 cost time: 9.577021598815918
Epoch: 14, Steps: 18 | Train Loss: 0.033 Vali Loss: 1.983 Vali Acc: 0.390 Test Loss: 1.983 Test Acc: 0.390
Validation loss decreased (-0.369980 --> -0.389980).  Saving model ...
Epoch: 15 cost time: 8.509254693984985
Epoch: 15, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.971 Vali Acc: 0.377 Test Loss: 1.971 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.507180213928223
Epoch: 16, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.915 Vali Acc: 0.423 Test Loss: 1.915 Test Acc: 0.423
Validation loss decreased (-0.389980 --> -0.423314).  Saving model ...
Epoch: 17 cost time: 9.663394689559937
Epoch: 17, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.865 Vali Acc: 0.437 Test Loss: 1.865 Test Acc: 0.437
Validation loss decreased (-0.423314 --> -0.436648).  Saving model ...
Epoch: 18 cost time: 10.328845262527466
Epoch: 18, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.861 Vali Acc: 0.430 Test Loss: 1.861 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.41916275024414
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.852 Vali Acc: 0.427 Test Loss: 1.852 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.005897045135498
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.832 Vali Acc: 0.433 Test Loss: 1.832 Test Acc: 0.433
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 9.699236869812012
Epoch: 21, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.830 Vali Acc: 0.443 Test Loss: 1.830 Test Acc: 0.443
Validation loss decreased (-0.436648 --> -0.443315).  Saving model ...
Epoch: 22 cost time: 8.635473489761353
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.791 Vali Acc: 0.463 Test Loss: 1.791 Test Acc: 0.463
Validation loss decreased (-0.443315 --> -0.463315).  Saving model ...
Epoch: 23 cost time: 8.794396162033081
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.747 Vali Acc: 0.463 Test Loss: 1.747 Test Acc: 0.463
Validation loss decreased (-0.463315 --> -0.463316).  Saving model ...
Epoch: 24 cost time: 10.693252563476562
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.723 Vali Acc: 0.473 Test Loss: 1.723 Test Acc: 0.473
Validation loss decreased (-0.463316 --> -0.473316).  Saving model ...
Epoch: 25 cost time: 10.375516176223755
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.751 Vali Acc: 0.463 Test Loss: 1.751 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 10.32320499420166
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.743 Vali Acc: 0.480 Test Loss: 1.743 Test Acc: 0.480
Validation loss decreased (-0.473316 --> -0.479983).  Saving model ...
Epoch: 27 cost time: 10.159775257110596
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.747 Vali Acc: 0.473 Test Loss: 1.747 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 9.99368405342102
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.720 Vali Acc: 0.463 Test Loss: 1.720 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 9.072661638259888
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.705 Vali Acc: 0.473 Test Loss: 1.705 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 9.176597356796265
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.689 Vali Acc: 0.480 Test Loss: 1.689 Test Acc: 0.480
Validation loss decreased (-0.479983 --> -0.479983).  Saving model ...
Epoch: 31 cost time: 10.519279479980469
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.675 Vali Acc: 0.480 Test Loss: 1.675 Test Acc: 0.480
Validation loss decreased (-0.479983 --> -0.479983).  Saving model ...
Epoch: 32 cost time: 9.598839521408081
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.662 Vali Acc: 0.487 Test Loss: 1.662 Test Acc: 0.487
Validation loss decreased (-0.479983 --> -0.486650).  Saving model ...
Epoch: 33 cost time: 9.616114377975464
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.651 Vali Acc: 0.493 Test Loss: 1.651 Test Acc: 0.493
Validation loss decreased (-0.486650 --> -0.493317).  Saving model ...
Epoch: 34 cost time: 11.294512748718262
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.629 Vali Acc: 0.507 Test Loss: 1.629 Test Acc: 0.507
Validation loss decreased (-0.493317 --> -0.506650).  Saving model ...
Epoch: 35 cost time: 10.86820363998413
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.648 Vali Acc: 0.493 Test Loss: 1.648 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 10.283164501190186
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.653 Vali Acc: 0.487 Test Loss: 1.653 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 9.273533821105957
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.654 Vali Acc: 0.490 Test Loss: 1.654 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 9.15353536605835
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.637 Vali Acc: 0.500 Test Loss: 1.637 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 9.827538967132568
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.629 Vali Acc: 0.503 Test Loss: 1.629 Test Acc: 0.503
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 8.933274507522583
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.633 Vali Acc: 0.500 Test Loss: 1.633 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 10.473443746566772
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.631 Vali Acc: 0.497 Test Loss: 1.631 Test Acc: 0.497
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 10.778796911239624
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.624 Vali Acc: 0.497 Test Loss: 1.624 Test Acc: 0.497
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 9.595685720443726
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.623 Vali Acc: 0.513 Test Loss: 1.623 Test Acc: 0.513
Validation loss decreased (-0.506650 --> -0.513317).  Saving model ...
Epoch: 44 cost time: 9.330504179000854
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.616 Vali Acc: 0.517 Test Loss: 1.616 Test Acc: 0.517
Validation loss decreased (-0.513317 --> -0.516651).  Saving model ...
Epoch: 45 cost time: 8.671168565750122
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.593 Vali Acc: 0.530 Test Loss: 1.593 Test Acc: 0.530
Validation loss decreased (-0.516651 --> -0.529984).  Saving model ...
Epoch: 46 cost time: 9.341337442398071
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.594 Vali Acc: 0.530 Test Loss: 1.594 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 8.10850977897644
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.596 Vali Acc: 0.530 Test Loss: 1.596 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 9.159721374511719
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.590 Vali Acc: 0.527 Test Loss: 1.590 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 9.482323169708252
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.585 Vali Acc: 0.530 Test Loss: 1.585 Test Acc: 0.530
Validation loss decreased (-0.529984 --> -0.529984).  Saving model ...
Epoch: 50 cost time: 9.741140127182007
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.595 Vali Acc: 0.537 Test Loss: 1.595 Test Acc: 0.537
Validation loss decreased (-0.529984 --> -0.536651).  Saving model ...
Epoch: 51 cost time: 10.178792953491211
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.590 Vali Acc: 0.530 Test Loss: 1.590 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 9.691696643829346
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.587 Vali Acc: 0.530 Test Loss: 1.587 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 9.482724905014038
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.579 Vali Acc: 0.530 Test Loss: 1.579 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 9.184635400772095
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.582 Vali Acc: 0.513 Test Loss: 1.582 Test Acc: 0.513
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 9.140195369720459
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.580 Vali Acc: 0.517 Test Loss: 1.580 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 9.032565116882324
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.572 Vali Acc: 0.537 Test Loss: 1.572 Test Acc: 0.537
Validation loss decreased (-0.536651 --> -0.536651).  Saving model ...
Epoch: 57 cost time: 8.813510417938232
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.565 Vali Acc: 0.540 Test Loss: 1.565 Test Acc: 0.540
Validation loss decreased (-0.536651 --> -0.539984).  Saving model ...
Epoch: 58 cost time: 9.975656986236572
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.565 Vali Acc: 0.540 Test Loss: 1.565 Test Acc: 0.540
Validation loss decreased (-0.539984 --> -0.539984).  Saving model ...
Epoch: 59 cost time: 10.044694662094116
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.554 Vali Acc: 0.543 Test Loss: 1.554 Test Acc: 0.543
Validation loss decreased (-0.539984 --> -0.543318).  Saving model ...
Epoch: 60 cost time: 9.109035015106201
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.543 Test Loss: 1.566 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 9.325322389602661
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.558 Vali Acc: 0.547 Test Loss: 1.558 Test Acc: 0.547
Validation loss decreased (-0.543318 --> -0.546651).  Saving model ...
Epoch: 62 cost time: 9.664751052856445
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.547 Vali Acc: 0.543 Test Loss: 1.547 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 8.998609781265259
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.547 Test Loss: 1.544 Test Acc: 0.547
Validation loss decreased (-0.546651 --> -0.546651).  Saving model ...
Epoch: 64 cost time: 9.323651790618896
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.541 Vali Acc: 0.550 Test Loss: 1.541 Test Acc: 0.550
Validation loss decreased (-0.546651 --> -0.549985).  Saving model ...
Epoch: 65 cost time: 8.947032690048218
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.553 Test Loss: 1.544 Test Acc: 0.553
Validation loss decreased (-0.549985 --> -0.553318).  Saving model ...
Epoch: 66 cost time: 9.249078273773193
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.543 Vali Acc: 0.553 Test Loss: 1.543 Test Acc: 0.553
Validation loss decreased (-0.553318 --> -0.553318).  Saving model ...
Epoch: 67 cost time: 10.5112943649292
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.542 Vali Acc: 0.557 Test Loss: 1.542 Test Acc: 0.557
Validation loss decreased (-0.553318 --> -0.556651).  Saving model ...
Epoch: 68 cost time: 9.278482913970947
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.543 Test Loss: 1.536 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 10.135543584823608
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.547 Test Loss: 1.533 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 9.376498699188232
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.550 Test Loss: 1.541 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 9.291711568832397
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.543 Test Loss: 1.553 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 9.841795921325684
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.544 Vali Acc: 0.547 Test Loss: 1.544 Test Acc: 0.547
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 8.900437593460083
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.550 Test Loss: 1.536 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 9.997193336486816
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.553 Test Loss: 1.536 Test Acc: 0.553
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 9.850149154663086
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.553 Test Loss: 1.534 Test Acc: 0.553
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 9.633910417556763
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.560 Test Loss: 1.536 Test Acc: 0.560
Validation loss decreased (-0.556651 --> -0.559985).  Saving model ...
Epoch: 77 cost time: 9.531980514526367
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.553 Test Loss: 1.529 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 10.034612894058228
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.557 Test Loss: 1.523 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 10.118059396743774
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.560 Test Loss: 1.524 Test Acc: 0.560
Validation loss decreased (-0.559985 --> -0.559985).  Saving model ...
Epoch: 80 cost time: 9.304203748703003
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.557 Test Loss: 1.522 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 10.017563819885254
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.563 Test Loss: 1.520 Test Acc: 0.563
Validation loss decreased (-0.559985 --> -0.563318).  Saving model ...
Epoch: 82 cost time: 10.074748992919922
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.560 Test Loss: 1.520 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 10.089580059051514
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.514 Vali Acc: 0.563 Test Loss: 1.514 Test Acc: 0.563
Validation loss decreased (-0.563318 --> -0.563318).  Saving model ...
Epoch: 84 cost time: 9.611456155776978
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.567 Test Loss: 1.510 Test Acc: 0.567
Validation loss decreased (-0.563318 --> -0.566652).  Saving model ...
Epoch: 85 cost time: 9.692886590957642
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.573 Test Loss: 1.512 Test Acc: 0.573
Validation loss decreased (-0.566652 --> -0.573318).  Saving model ...
Epoch: 86 cost time: 9.172668695449829
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.570 Test Loss: 1.510 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 9.60571813583374
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.570 Test Loss: 1.507 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 9.098066091537476
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.567 Test Loss: 1.508 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 9.273177862167358
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.567 Test Loss: 1.511 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 8.547465324401855
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.567 Test Loss: 1.515 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 9.247496843338013
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.573 Test Loss: 1.513 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 10.81086254119873
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.580 Test Loss: 1.512 Test Acc: 0.580
Validation loss decreased (-0.573318 --> -0.579985).  Saving model ...
Epoch: 93 cost time: 11.271982192993164
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.580 Test Loss: 1.510 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 94 cost time: 9.38102388381958
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.580 Test Loss: 1.505 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 95 cost time: 8.964483499526978
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.583 Test Loss: 1.504 Test Acc: 0.583
Validation loss decreased (-0.579985 --> -0.583318).  Saving model ...
Epoch: 96 cost time: 8.503987550735474
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.587 Test Loss: 1.500 Test Acc: 0.587
Validation loss decreased (-0.583318 --> -0.586652).  Saving model ...
Epoch: 97 cost time: 8.813405752182007
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.590 Test Loss: 1.494 Test Acc: 0.590
Validation loss decreased (-0.586652 --> -0.589985).  Saving model ...
Epoch: 98 cost time: 8.852440595626831
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.587 Test Loss: 1.499 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 9.60194182395935
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.583 Test Loss: 1.506 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 9.182710409164429
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.580 Test Loss: 1.513 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.59
model parameter : 497433
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 13.593560218811035
Epoch: 1, Steps: 18 | Train Loss: 3.345 Vali Loss: 3.249 Vali Acc: 0.070 Test Loss: 3.249 Test Acc: 0.070
Validation loss decreased (inf --> -0.069968).  Saving model ...
Epoch: 2 cost time: 9.518174409866333
Epoch: 2, Steps: 18 | Train Loss: 3.086 Vali Loss: 3.189 Vali Acc: 0.083 Test Loss: 3.189 Test Acc: 0.083
Validation loss decreased (-0.069968 --> -0.083301).  Saving model ...
Epoch: 3 cost time: 9.611563205718994
Epoch: 3, Steps: 18 | Train Loss: 2.764 Vali Loss: 3.104 Vali Acc: 0.097 Test Loss: 3.104 Test Acc: 0.097
Validation loss decreased (-0.083301 --> -0.096636).  Saving model ...
Epoch: 4 cost time: 8.747812747955322
Epoch: 4, Steps: 18 | Train Loss: 2.365 Vali Loss: 3.015 Vali Acc: 0.120 Test Loss: 3.015 Test Acc: 0.120
Validation loss decreased (-0.096636 --> -0.119970).  Saving model ...
Epoch: 5 cost time: 9.758088111877441
Epoch: 5, Steps: 18 | Train Loss: 1.859 Vali Loss: 2.932 Vali Acc: 0.143 Test Loss: 2.932 Test Acc: 0.143
Validation loss decreased (-0.119970 --> -0.143304).  Saving model ...
Epoch: 6 cost time: 9.798732995986938
Epoch: 6, Steps: 18 | Train Loss: 1.397 Vali Loss: 2.818 Vali Acc: 0.177 Test Loss: 2.818 Test Acc: 0.177
Validation loss decreased (-0.143304 --> -0.176638).  Saving model ...
Epoch: 7 cost time: 10.174186706542969
Epoch: 7, Steps: 18 | Train Loss: 0.997 Vali Loss: 2.724 Vali Acc: 0.187 Test Loss: 2.724 Test Acc: 0.187
Validation loss decreased (-0.176638 --> -0.186639).  Saving model ...
Epoch: 8 cost time: 10.856931447982788
Epoch: 8, Steps: 18 | Train Loss: 0.615 Vali Loss: 2.574 Vali Acc: 0.217 Test Loss: 2.574 Test Acc: 0.217
Validation loss decreased (-0.186639 --> -0.216641).  Saving model ...
Epoch: 9 cost time: 10.163370132446289
Epoch: 9, Steps: 18 | Train Loss: 0.371 Vali Loss: 2.400 Vali Acc: 0.273 Test Loss: 2.400 Test Acc: 0.273
Validation loss decreased (-0.216641 --> -0.273309).  Saving model ...
Epoch: 10 cost time: 10.628941774368286
Epoch: 10, Steps: 18 | Train Loss: 0.189 Vali Loss: 2.316 Vali Acc: 0.297 Test Loss: 2.316 Test Acc: 0.297
Validation loss decreased (-0.273309 --> -0.296644).  Saving model ...
Epoch: 11 cost time: 10.321078062057495
Epoch: 11, Steps: 18 | Train Loss: 0.093 Vali Loss: 2.117 Vali Acc: 0.340 Test Loss: 2.117 Test Acc: 0.340
Validation loss decreased (-0.296644 --> -0.339979).  Saving model ...
Epoch: 12 cost time: 10.543956756591797
Epoch: 12, Steps: 18 | Train Loss: 0.061 Vali Loss: 2.040 Vali Acc: 0.380 Test Loss: 2.040 Test Acc: 0.380
Validation loss decreased (-0.339979 --> -0.379980).  Saving model ...
Epoch: 13 cost time: 9.932438611984253
Epoch: 13, Steps: 18 | Train Loss: 0.044 Vali Loss: 1.937 Vali Acc: 0.413 Test Loss: 1.937 Test Acc: 0.413
Validation loss decreased (-0.379980 --> -0.413314).  Saving model ...
Epoch: 14 cost time: 9.310773134231567
Epoch: 14, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.929 Vali Acc: 0.400 Test Loss: 1.929 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.920236110687256
Epoch: 15, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.884 Vali Acc: 0.400 Test Loss: 1.884 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.952999830245972
Epoch: 16, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.823 Vali Acc: 0.430 Test Loss: 1.823 Test Acc: 0.430
Validation loss decreased (-0.413314 --> -0.429982).  Saving model ...
Epoch: 17 cost time: 9.93831753730774
Epoch: 17, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.791 Vali Acc: 0.433 Test Loss: 1.791 Test Acc: 0.433
Validation loss decreased (-0.429982 --> -0.433315).  Saving model ...
Epoch: 18 cost time: 9.438427448272705
Epoch: 18, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.786 Vali Acc: 0.423 Test Loss: 1.786 Test Acc: 0.423
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.670497179031372
Epoch: 19, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.767 Vali Acc: 0.430 Test Loss: 1.767 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.368988990783691
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.733 Vali Acc: 0.440 Test Loss: 1.733 Test Acc: 0.440
Validation loss decreased (-0.433315 --> -0.439983).  Saving model ...
Epoch: 21 cost time: 10.430856227874756
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.722 Vali Acc: 0.443 Test Loss: 1.722 Test Acc: 0.443
Validation loss decreased (-0.439983 --> -0.443316).  Saving model ...
Epoch: 22 cost time: 10.454331874847412
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.680 Vali Acc: 0.450 Test Loss: 1.680 Test Acc: 0.450
Validation loss decreased (-0.443316 --> -0.449983).  Saving model ...
Epoch: 23 cost time: 10.664847612380981
Epoch: 23, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.648 Vali Acc: 0.473 Test Loss: 1.648 Test Acc: 0.473
Validation loss decreased (-0.449983 --> -0.473317).  Saving model ...
Epoch: 24 cost time: 10.467732906341553
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.628 Vali Acc: 0.477 Test Loss: 1.628 Test Acc: 0.477
Validation loss decreased (-0.473317 --> -0.476650).  Saving model ...
Epoch: 25 cost time: 9.037426471710205
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.636 Vali Acc: 0.480 Test Loss: 1.636 Test Acc: 0.480
Validation loss decreased (-0.476650 --> -0.479984).  Saving model ...
Epoch: 26 cost time: 9.860488414764404
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.628 Vali Acc: 0.490 Test Loss: 1.628 Test Acc: 0.490
Validation loss decreased (-0.479984 --> -0.489984).  Saving model ...
Epoch: 27 cost time: 8.803792238235474
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.621 Vali Acc: 0.483 Test Loss: 1.621 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 10.311969757080078
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.605 Vali Acc: 0.480 Test Loss: 1.605 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 9.488084077835083
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.590 Vali Acc: 0.480 Test Loss: 1.590 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 10.482973337173462
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.572 Vali Acc: 0.493 Test Loss: 1.572 Test Acc: 0.493
Validation loss decreased (-0.489984 --> -0.493318).  Saving model ...
Epoch: 31 cost time: 9.803091049194336
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.562 Vali Acc: 0.497 Test Loss: 1.562 Test Acc: 0.497
Validation loss decreased (-0.493318 --> -0.496651).  Saving model ...
Epoch: 32 cost time: 10.237348079681396
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.562 Vali Acc: 0.497 Test Loss: 1.562 Test Acc: 0.497
Validation loss decreased (-0.496651 --> -0.496651).  Saving model ...
Epoch: 33 cost time: 9.31631326675415
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.547 Vali Acc: 0.503 Test Loss: 1.547 Test Acc: 0.503
Validation loss decreased (-0.496651 --> -0.503318).  Saving model ...
Epoch: 34 cost time: 9.487576246261597
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.522 Vali Acc: 0.513 Test Loss: 1.522 Test Acc: 0.513
Validation loss decreased (-0.503318 --> -0.513318).  Saving model ...
Epoch: 35 cost time: 9.504905462265015
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.518 Vali Acc: 0.523 Test Loss: 1.518 Test Acc: 0.523
Validation loss decreased (-0.513318 --> -0.523318).  Saving model ...
Epoch: 36 cost time: 9.760467290878296
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.515 Vali Acc: 0.537 Test Loss: 1.515 Test Acc: 0.537
Validation loss decreased (-0.523318 --> -0.536652).  Saving model ...
Epoch: 37 cost time: 11.552414178848267
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.520 Vali Acc: 0.520 Test Loss: 1.520 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 11.720085859298706
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.509 Vali Acc: 0.530 Test Loss: 1.509 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 10.13978099822998
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.500 Vali Acc: 0.537 Test Loss: 1.500 Test Acc: 0.537
Validation loss decreased (-0.536652 --> -0.536652).  Saving model ...
Epoch: 40 cost time: 11.25912618637085
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.492 Vali Acc: 0.530 Test Loss: 1.492 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 10.015735864639282
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.491 Vali Acc: 0.533 Test Loss: 1.491 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 9.222323656082153
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.485 Vali Acc: 0.540 Test Loss: 1.485 Test Acc: 0.540
Validation loss decreased (-0.536652 --> -0.539985).  Saving model ...
Epoch: 43 cost time: 8.964367151260376
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.478 Vali Acc: 0.547 Test Loss: 1.478 Test Acc: 0.547
Validation loss decreased (-0.539985 --> -0.546652).  Saving model ...
Epoch: 44 cost time: 10.404362916946411
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.553 Test Loss: 1.475 Test Acc: 0.553
Validation loss decreased (-0.546652 --> -0.553319).  Saving model ...
Epoch: 45 cost time: 11.311649084091187
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.461 Vali Acc: 0.550 Test Loss: 1.461 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 10.361573219299316
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.463 Vali Acc: 0.557 Test Loss: 1.463 Test Acc: 0.557
Validation loss decreased (-0.553319 --> -0.556652).  Saving model ...
Epoch: 47 cost time: 11.085304260253906
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.464 Vali Acc: 0.560 Test Loss: 1.464 Test Acc: 0.560
Validation loss decreased (-0.556652 --> -0.559985).  Saving model ...
Epoch: 48 cost time: 10.09882664680481
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.462 Vali Acc: 0.550 Test Loss: 1.462 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 9.955731391906738
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.455 Vali Acc: 0.547 Test Loss: 1.455 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 9.176010847091675
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.459 Vali Acc: 0.557 Test Loss: 1.459 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 11.029714107513428
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.450 Vali Acc: 0.567 Test Loss: 1.450 Test Acc: 0.567
Validation loss decreased (-0.559985 --> -0.566652).  Saving model ...
Epoch: 52 cost time: 9.308762550354004
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.440 Vali Acc: 0.570 Test Loss: 1.440 Test Acc: 0.570
Validation loss decreased (-0.566652 --> -0.569986).  Saving model ...
Epoch: 53 cost time: 10.467348337173462
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.435 Vali Acc: 0.563 Test Loss: 1.435 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 11.643516778945923
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.439 Vali Acc: 0.563 Test Loss: 1.439 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 10.009450674057007
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.431 Vali Acc: 0.563 Test Loss: 1.431 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 10.284415245056152
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.424 Vali Acc: 0.573 Test Loss: 1.424 Test Acc: 0.573
Validation loss decreased (-0.569986 --> -0.573319).  Saving model ...
Epoch: 57 cost time: 9.399382591247559
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.420 Vali Acc: 0.577 Test Loss: 1.420 Test Acc: 0.577
Validation loss decreased (-0.573319 --> -0.576652).  Saving model ...
Epoch: 58 cost time: 9.620807409286499
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.417 Vali Acc: 0.573 Test Loss: 1.417 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 9.193405866622925
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.411 Vali Acc: 0.570 Test Loss: 1.411 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 10.01885461807251
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.417 Vali Acc: 0.577 Test Loss: 1.417 Test Acc: 0.577
Validation loss decreased (-0.576652 --> -0.576652).  Saving model ...
Epoch: 61 cost time: 10.235177040100098
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.411 Vali Acc: 0.577 Test Loss: 1.411 Test Acc: 0.577
Validation loss decreased (-0.576652 --> -0.576653).  Saving model ...
Epoch: 62 cost time: 11.15190315246582
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.402 Vali Acc: 0.587 Test Loss: 1.402 Test Acc: 0.587
Validation loss decreased (-0.576653 --> -0.586653).  Saving model ...
Epoch: 63 cost time: 11.103345155715942
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.593 Test Loss: 1.398 Test Acc: 0.593
Validation loss decreased (-0.586653 --> -0.593319).  Saving model ...
Epoch: 64 cost time: 9.74513864517212
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.597 Test Loss: 1.398 Test Acc: 0.597
Validation loss decreased (-0.593319 --> -0.596653).  Saving model ...
Epoch: 65 cost time: 11.660105466842651
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.402 Vali Acc: 0.593 Test Loss: 1.402 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 10.347857236862183
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.597 Test Loss: 1.398 Test Acc: 0.597
Validation loss decreased (-0.596653 --> -0.596653).  Saving model ...
Epoch: 67 cost time: 11.61594843864441
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.394 Vali Acc: 0.590 Test Loss: 1.394 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 9.666382789611816
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.590 Test Loss: 1.389 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 10.899655818939209
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.590 Test Loss: 1.386 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 11.166552066802979
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.603 Test Loss: 1.387 Test Acc: 0.603
Validation loss decreased (-0.596653 --> -0.603319).  Saving model ...
Epoch: 71 cost time: 10.518694400787354
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.590 Test Loss: 1.391 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 10.227179288864136
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.587 Test Loss: 1.387 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 10.697278261184692
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.590 Test Loss: 1.381 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 11.369920253753662
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.600 Test Loss: 1.377 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 9.775824785232544
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.590 Test Loss: 1.373 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 10.341192960739136
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.590 Test Loss: 1.369 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 11.00853967666626
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.590 Test Loss: 1.368 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 10.379588603973389
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.600 Test Loss: 1.364 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 11.10214900970459
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.607 Test Loss: 1.360 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606653).  Saving model ...
Epoch: 80 cost time: 12.107484102249146
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.593 Test Loss: 1.358 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 9.712500810623169
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.593 Test Loss: 1.358 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 10.017082929611206
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.597 Test Loss: 1.356 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 10.293924331665039
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.597 Test Loss: 1.353 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 8.012823343276978
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.617 Test Loss: 1.347 Test Acc: 0.617
Validation loss decreased (-0.606653 --> -0.616653).  Saving model ...
Epoch: 85 cost time: 9.328972339630127
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.610 Test Loss: 1.346 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 10.0888991355896
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.607 Test Loss: 1.343 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 9.741756677627563
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.607 Test Loss: 1.343 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 9.594733953475952
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.613 Test Loss: 1.342 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 10.019340991973877
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.607 Test Loss: 1.344 Test Acc: 0.607
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 10.178601503372192
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.610 Test Loss: 1.343 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 9.387521028518677
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.607 Test Loss: 1.339 Test Acc: 0.607
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 9.915019989013672
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.617 Test Loss: 1.336 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616653).  Saving model ...
Epoch: 93 cost time: 9.652711391448975
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.334 Vali Acc: 0.613 Test Loss: 1.334 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 9.9583899974823
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.617 Test Loss: 1.332 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616653).  Saving model ...
Epoch: 95 cost time: 10.769223928451538
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.620 Test Loss: 1.329 Test Acc: 0.620
Validation loss decreased (-0.616653 --> -0.619987).  Saving model ...
Epoch: 96 cost time: 10.652361631393433
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.620 Test Loss: 1.326 Test Acc: 0.620
Validation loss decreased (-0.619987 --> -0.619987).  Saving model ...
Epoch: 97 cost time: 10.070727825164795
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.627 Test Loss: 1.323 Test Acc: 0.627
Validation loss decreased (-0.619987 --> -0.626653).  Saving model ...
Epoch: 98 cost time: 11.711633205413818
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.623 Test Loss: 1.324 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 10.975876808166504
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.620 Test Loss: 1.324 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 9.367643594741821
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.617 Test Loss: 1.326 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6266666666666667
model parameter : 497433
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 13.548986911773682
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 12.022602319717407
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.331150770187378
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 4 cost time: 9.881562232971191
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.409017562866211
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.46970248222351
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 7 cost time: 8.706503868103027
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.08297324180603
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 9 cost time: 10.155724287033081
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 10 cost time: 11.232756614685059
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 11 cost time: 10.538788557052612
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 12 cost time: 9.986703872680664
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.506150484085083
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.799886465072632
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.456335544586182
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.317266464233398
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.401493549346924
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 11.858950138092041
Epoch: 18, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.041625022888184
Epoch: 19, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.340160369873047
Epoch: 20, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.365123987197876
Epoch: 21, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 497433
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 14.353585720062256
Epoch: 1, Steps: 18 | Train Loss: 3.185 Vali Loss: 2.794 Vali Acc: 0.353 Test Loss: 2.794 Test Acc: 0.353
Validation loss decreased (inf --> -0.353305).  Saving model ...
Epoch: 2 cost time: 10.647149324417114
Epoch: 2, Steps: 18 | Train Loss: 2.311 Vali Loss: 1.851 Vali Acc: 0.773 Test Loss: 1.851 Test Acc: 0.773
Validation loss decreased (-0.353305 --> -0.773315).  Saving model ...
Epoch: 3 cost time: 10.380950927734375
Epoch: 3, Steps: 18 | Train Loss: 1.300 Vali Loss: 1.112 Vali Acc: 0.820 Test Loss: 1.112 Test Acc: 0.820
Validation loss decreased (-0.773315 --> -0.819989).  Saving model ...
Epoch: 4 cost time: 10.054254293441772
Epoch: 4, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.726 Vali Acc: 0.870 Test Loss: 0.726 Test Acc: 0.870
Validation loss decreased (-0.819989 --> -0.869993).  Saving model ...
Epoch: 5 cost time: 10.442514419555664
Epoch: 5, Steps: 18 | Train Loss: 0.262 Vali Loss: 0.558 Vali Acc: 0.873 Test Loss: 0.558 Test Acc: 0.873
Validation loss decreased (-0.869993 --> -0.873328).  Saving model ...
Epoch: 6 cost time: 10.928279638290405
Epoch: 6, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.471 Vali Acc: 0.890 Test Loss: 0.471 Test Acc: 0.890
Validation loss decreased (-0.873328 --> -0.889995).  Saving model ...
Epoch: 7 cost time: 10.87499189376831
Epoch: 7, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.439 Vali Acc: 0.883 Test Loss: 0.439 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.979053020477295
Epoch: 8, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.424 Vali Acc: 0.897 Test Loss: 0.424 Test Acc: 0.897
Validation loss decreased (-0.889995 --> -0.896662).  Saving model ...
Epoch: 9 cost time: 11.02472186088562
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.409 Vali Acc: 0.887 Test Loss: 0.409 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.943586826324463
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.402 Vali Acc: 0.887 Test Loss: 0.402 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.920485973358154
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
Validation loss decreased (-0.896662 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 9.671675443649292
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.390 Vali Acc: 0.897 Test Loss: 0.390 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.327583312988281
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.387 Vali Acc: 0.890 Test Loss: 0.387 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.301033973693848
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.382 Vali Acc: 0.887 Test Loss: 0.382 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.32959270477295
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.377 Vali Acc: 0.887 Test Loss: 0.377 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.237143754959106
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.374 Vali Acc: 0.890 Test Loss: 0.374 Test Acc: 0.890
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.037442922592163
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.376 Vali Acc: 0.890 Test Loss: 0.376 Test Acc: 0.890
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 9.012771129608154
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.372 Vali Acc: 0.893 Test Loss: 0.372 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 10.270318269729614
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.369 Vali Acc: 0.887 Test Loss: 0.369 Test Acc: 0.887
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 10.068503141403198
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.368 Vali Acc: 0.887 Test Loss: 0.368 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 10.991466999053955
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.366 Vali Acc: 0.887 Test Loss: 0.366 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9
model parameter : 448281
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 13.81240463256836
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 2.931 Vali Acc: 0.277 Test Loss: 2.931 Test Acc: 0.277
Validation loss decreased (inf --> -0.276637).  Saving model ...
Epoch: 2 cost time: 11.007752180099487
Epoch: 2, Steps: 18 | Train Loss: 2.527 Vali Loss: 2.195 Vali Acc: 0.657 Test Loss: 2.195 Test Acc: 0.657
Validation loss decreased (-0.276637 --> -0.656645).  Saving model ...
Epoch: 3 cost time: 10.942642211914062
Epoch: 3, Steps: 18 | Train Loss: 1.634 Vali Loss: 1.502 Vali Acc: 0.770 Test Loss: 1.502 Test Acc: 0.770
Validation loss decreased (-0.656645 --> -0.769985).  Saving model ...
Epoch: 4 cost time: 9.772258281707764
Epoch: 4, Steps: 18 | Train Loss: 0.853 Vali Loss: 1.051 Vali Acc: 0.817 Test Loss: 1.051 Test Acc: 0.817
Validation loss decreased (-0.769985 --> -0.816656).  Saving model ...
Epoch: 5 cost time: 9.192895889282227
Epoch: 5, Steps: 18 | Train Loss: 0.399 Vali Loss: 0.823 Vali Acc: 0.820 Test Loss: 0.823 Test Acc: 0.820
Validation loss decreased (-0.816656 --> -0.819992).  Saving model ...
Epoch: 6 cost time: 10.348781824111938
Epoch: 6, Steps: 18 | Train Loss: 0.173 Vali Loss: 0.689 Vali Acc: 0.840 Test Loss: 0.689 Test Acc: 0.840
Validation loss decreased (-0.819992 --> -0.839993).  Saving model ...
Epoch: 7 cost time: 10.467146396636963
Epoch: 7, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.639 Vali Acc: 0.833 Test Loss: 0.639 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.919998407363892
Epoch: 8, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.624 Vali Acc: 0.853 Test Loss: 0.624 Test Acc: 0.853
Validation loss decreased (-0.839993 --> -0.853327).  Saving model ...
Epoch: 9 cost time: 10.52042269706726
Epoch: 9, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.600 Vali Acc: 0.847 Test Loss: 0.600 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.5507972240448
Epoch: 10, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.275269508361816
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.583 Vali Acc: 0.857 Test Loss: 0.583 Test Acc: 0.857
Validation loss decreased (-0.853327 --> -0.856661).  Saving model ...
Epoch: 12 cost time: 10.827333927154541
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.580 Vali Acc: 0.843 Test Loss: 0.580 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.629676103591919
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.572 Vali Acc: 0.857 Test Loss: 0.572 Test Acc: 0.857
Validation loss decreased (-0.856661 --> -0.856661).  Saving model ...
Epoch: 14 cost time: 11.285701274871826
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.569 Vali Acc: 0.860 Test Loss: 0.569 Test Acc: 0.860
Validation loss decreased (-0.856661 --> -0.859994).  Saving model ...
Epoch: 15 cost time: 11.498682737350464
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.857 Test Loss: 0.563 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.79548954963684
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.561 Vali Acc: 0.860 Test Loss: 0.561 Test Acc: 0.860
Validation loss decreased (-0.859994 --> -0.859994).  Saving model ...
Epoch: 17 cost time: 12.727564096450806
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.561 Vali Acc: 0.860 Test Loss: 0.561 Test Acc: 0.860
Validation loss decreased (-0.859994 --> -0.859994).  Saving model ...
Epoch: 18 cost time: 12.810558557510376
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.556 Vali Acc: 0.863 Test Loss: 0.556 Test Acc: 0.863
Validation loss decreased (-0.859994 --> -0.863328).  Saving model ...
Epoch: 19 cost time: 12.20478081703186
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.554 Vali Acc: 0.853 Test Loss: 0.554 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.342687368392944
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 11.146130561828613
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.857 Test Loss: 0.550 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 11.152551889419556
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.551 Vali Acc: 0.863 Test Loss: 0.551 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 23 cost time: 10.345075845718384
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.549 Vali Acc: 0.863 Test Loss: 0.549 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 24 cost time: 11.104703664779663
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.860 Test Loss: 0.549 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 10.132094621658325
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.548 Vali Acc: 0.863 Test Loss: 0.548 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 26 cost time: 10.909836769104004
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.547 Vali Acc: 0.860 Test Loss: 0.547 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 10.779855728149414
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.545 Vali Acc: 0.857 Test Loss: 0.545 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 10.801188468933105
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.543 Vali Acc: 0.860 Test Loss: 0.543 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 11.402754545211792
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.544 Vali Acc: 0.863 Test Loss: 0.544 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 30 cost time: 11.061148643493652
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.543 Vali Acc: 0.863 Test Loss: 0.543 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 31 cost time: 11.503278017044067
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.863 Test Loss: 0.544 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 12.443868637084961
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
Validation loss decreased (-0.863328 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 10.810544967651367
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.860 Test Loss: 0.543 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 11.317444562911987
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.863 Test Loss: 0.542 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 11.435173273086548
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 36 cost time: 12.291424989700317
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.863 Test Loss: 0.541 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 11.411164045333862
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.863 Test Loss: 0.542 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 11.25192403793335
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 10.082945108413696
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 40 cost time: 11.578135967254639
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.863 Test Loss: 0.540 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 11.822728633880615
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 42 cost time: 11.103872060775757
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 43 cost time: 12.002947807312012
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.870 Test Loss: 0.540 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.869995).  Saving model ...
Epoch: 44 cost time: 10.639235973358154
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 9.985005617141724
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 9.822175025939941
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 11.650781869888306
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 11.018681526184082
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.867 Test Loss: 0.543 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 11.020548820495605
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.867 Test Loss: 0.543 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 11.413305044174194
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 10.35443377494812
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 11.856681823730469
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 10.56703782081604
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.87
model parameter : 448281
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 12.802086114883423
Epoch: 1, Steps: 18 | Train Loss: 3.265 Vali Loss: 3.050 Vali Acc: 0.160 Test Loss: 3.050 Test Acc: 0.160
Validation loss decreased (inf --> -0.159970).  Saving model ...
Epoch: 2 cost time: 11.185587167739868
Epoch: 2, Steps: 18 | Train Loss: 2.749 Vali Loss: 2.552 Vali Acc: 0.517 Test Loss: 2.552 Test Acc: 0.517
Validation loss decreased (-0.159970 --> -0.516641).  Saving model ...
Epoch: 3 cost time: 11.489097356796265
Epoch: 3, Steps: 18 | Train Loss: 2.030 Vali Loss: 2.011 Vali Acc: 0.667 Test Loss: 2.011 Test Acc: 0.667
Validation loss decreased (-0.516641 --> -0.666647).  Saving model ...
Epoch: 4 cost time: 11.398836851119995
Epoch: 4, Steps: 18 | Train Loss: 1.279 Vali Loss: 1.553 Vali Acc: 0.700 Test Loss: 1.553 Test Acc: 0.700
Validation loss decreased (-0.666647 --> -0.699984).  Saving model ...
Epoch: 5 cost time: 12.404781341552734
Epoch: 5, Steps: 18 | Train Loss: 0.689 Vali Loss: 1.243 Vali Acc: 0.737 Test Loss: 1.243 Test Acc: 0.737
Validation loss decreased (-0.699984 --> -0.736654).  Saving model ...
Epoch: 6 cost time: 11.510396003723145
Epoch: 6, Steps: 18 | Train Loss: 0.336 Vali Loss: 1.029 Vali Acc: 0.770 Test Loss: 1.029 Test Acc: 0.770
Validation loss decreased (-0.736654 --> -0.769990).  Saving model ...
Epoch: 7 cost time: 12.66291093826294
Epoch: 7, Steps: 18 | Train Loss: 0.149 Vali Loss: 0.933 Vali Acc: 0.760 Test Loss: 0.933 Test Acc: 0.760
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.540693521499634
Epoch: 8, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.893 Vali Acc: 0.763 Test Loss: 0.893 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.163246870040894
Epoch: 9, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.860 Vali Acc: 0.770 Test Loss: 0.860 Test Acc: 0.770
Validation loss decreased (-0.769990 --> -0.769991).  Saving model ...
Epoch: 10 cost time: 10.509328842163086
Epoch: 10, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.847 Vali Acc: 0.783 Test Loss: 0.847 Test Acc: 0.783
Validation loss decreased (-0.769991 --> -0.783325).  Saving model ...
Epoch: 11 cost time: 11.098851919174194
Epoch: 11, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.839 Vali Acc: 0.787 Test Loss: 0.839 Test Acc: 0.787
Validation loss decreased (-0.783325 --> -0.786658).  Saving model ...
Epoch: 12 cost time: 10.215467929840088
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.841 Vali Acc: 0.773 Test Loss: 0.841 Test Acc: 0.773
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.156003713607788
Epoch: 13, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.817 Vali Acc: 0.793 Test Loss: 0.817 Test Acc: 0.793
Validation loss decreased (-0.786658 --> -0.793325).  Saving model ...
Epoch: 14 cost time: 10.391417503356934
Epoch: 14, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.813 Vali Acc: 0.793 Test Loss: 0.813 Test Acc: 0.793
Validation loss decreased (-0.793325 --> -0.793325).  Saving model ...
Epoch: 15 cost time: 10.329843997955322
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.811 Vali Acc: 0.790 Test Loss: 0.811 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.59089970588684
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.807 Vali Acc: 0.797 Test Loss: 0.807 Test Acc: 0.797
Validation loss decreased (-0.793325 --> -0.796659).  Saving model ...
Epoch: 17 cost time: 10.746240615844727
Epoch: 17, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.806 Vali Acc: 0.797 Test Loss: 0.806 Test Acc: 0.797
Validation loss decreased (-0.796659 --> -0.796659).  Saving model ...
Epoch: 18 cost time: 11.36208200454712
Epoch: 18, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.802 Vali Acc: 0.793 Test Loss: 0.802 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.599302053451538
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.799 Vali Acc: 0.793 Test Loss: 0.799 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.588526964187622
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.795 Vali Acc: 0.790 Test Loss: 0.795 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 9.932520151138306
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.793 Test Loss: 0.793 Test Acc: 0.793
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 10.401912927627563
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.794 Vali Acc: 0.797 Test Loss: 0.794 Test Acc: 0.797
Validation loss decreased (-0.796659 --> -0.796659).  Saving model ...
Epoch: 23 cost time: 10.976072549819946
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.797 Test Loss: 0.793 Test Acc: 0.797
Validation loss decreased (-0.796659 --> -0.796659).  Saving model ...
Epoch: 24 cost time: 10.627985954284668
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.792 Vali Acc: 0.793 Test Loss: 0.792 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 10.021636724472046
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.791 Vali Acc: 0.790 Test Loss: 0.791 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 10.491831064224243
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.792 Vali Acc: 0.793 Test Loss: 0.792 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 11.18238377571106
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.792 Vali Acc: 0.797 Test Loss: 0.792 Test Acc: 0.797
Validation loss decreased (-0.796659 --> -0.796659).  Saving model ...
Epoch: 28 cost time: 10.65106725692749
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.789 Vali Acc: 0.797 Test Loss: 0.789 Test Acc: 0.797
Validation loss decreased (-0.796659 --> -0.796659).  Saving model ...
Epoch: 29 cost time: 9.98269271850586
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.790 Vali Acc: 0.793 Test Loss: 0.790 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 12.065024375915527
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.790 Vali Acc: 0.797 Test Loss: 0.790 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 11.954744577407837
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
Validation loss decreased (-0.796659 --> -0.799992).  Saving model ...
Epoch: 32 cost time: 12.155745029449463
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.790 Vali Acc: 0.797 Test Loss: 0.790 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 11.87850046157837
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.787 Test Loss: 0.790 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 9.44514536857605
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.790 Test Loss: 0.793 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 9.56041955947876
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.794 Vali Acc: 0.790 Test Loss: 0.794 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 9.50577688217163
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.793 Test Loss: 0.793 Test Acc: 0.793
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 11.000909566879272
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.794 Vali Acc: 0.797 Test Loss: 0.794 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 13.058000087738037
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.794 Vali Acc: 0.790 Test Loss: 0.794 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 12.407716751098633
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.792 Vali Acc: 0.793 Test Loss: 0.792 Test Acc: 0.793
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 11.343790531158447
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.792 Vali Acc: 0.793 Test Loss: 0.792 Test Acc: 0.793
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 11.916153192520142
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.793 Test Loss: 0.793 Test Acc: 0.793
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8
model parameter : 448281
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 11.401061296463013
Epoch: 1, Steps: 18 | Train Loss: 3.288 Vali Loss: 3.122 Vali Acc: 0.100 Test Loss: 3.122 Test Acc: 0.100
Validation loss decreased (inf --> -0.099969).  Saving model ...
Epoch: 2 cost time: 9.160665512084961
Epoch: 2, Steps: 18 | Train Loss: 2.895 Vali Loss: 2.817 Vali Acc: 0.317 Test Loss: 2.817 Test Acc: 0.317
Validation loss decreased (-0.099969 --> -0.316638).  Saving model ...
Epoch: 3 cost time: 8.3658766746521
Epoch: 3, Steps: 18 | Train Loss: 2.345 Vali Loss: 2.471 Vali Acc: 0.497 Test Loss: 2.471 Test Acc: 0.497
Validation loss decreased (-0.316638 --> -0.496642).  Saving model ...
Epoch: 4 cost time: 9.512256622314453
Epoch: 4, Steps: 18 | Train Loss: 1.719 Vali Loss: 2.129 Vali Acc: 0.527 Test Loss: 2.129 Test Acc: 0.527
Validation loss decreased (-0.496642 --> -0.526645).  Saving model ...
Epoch: 5 cost time: 9.379315614700317
Epoch: 5, Steps: 18 | Train Loss: 1.119 Vali Loss: 1.844 Vali Acc: 0.573 Test Loss: 1.844 Test Acc: 0.573
Validation loss decreased (-0.526645 --> -0.573315).  Saving model ...
Epoch: 6 cost time: 9.41322946548462
Epoch: 6, Steps: 18 | Train Loss: 0.660 Vali Loss: 1.599 Vali Acc: 0.590 Test Loss: 1.599 Test Acc: 0.590
Validation loss decreased (-0.573315 --> -0.589984).  Saving model ...
Epoch: 7 cost time: 8.842549800872803
Epoch: 7, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.448 Vali Acc: 0.587 Test Loss: 1.448 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.957563400268555
Epoch: 8, Steps: 18 | Train Loss: 0.161 Vali Loss: 1.349 Vali Acc: 0.627 Test Loss: 1.349 Test Acc: 0.627
Validation loss decreased (-0.589984 --> -0.626653).  Saving model ...
Epoch: 9 cost time: 8.720374584197998
Epoch: 9, Steps: 18 | Train Loss: 0.078 Vali Loss: 1.284 Vali Acc: 0.623 Test Loss: 1.284 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.463573694229126
Epoch: 10, Steps: 18 | Train Loss: 0.046 Vali Loss: 1.235 Vali Acc: 0.637 Test Loss: 1.235 Test Acc: 0.637
Validation loss decreased (-0.626653 --> -0.636654).  Saving model ...
Epoch: 11 cost time: 9.320533037185669
Epoch: 11, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.214 Vali Acc: 0.623 Test Loss: 1.214 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.90013837814331
Epoch: 12, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.189 Vali Acc: 0.643 Test Loss: 1.189 Test Acc: 0.643
Validation loss decreased (-0.636654 --> -0.643321).  Saving model ...
Epoch: 13 cost time: 9.572888374328613
Epoch: 13, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.173 Vali Acc: 0.657 Test Loss: 1.173 Test Acc: 0.657
Validation loss decreased (-0.643321 --> -0.656655).  Saving model ...
Epoch: 14 cost time: 9.604795455932617
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.159 Vali Acc: 0.660 Test Loss: 1.159 Test Acc: 0.660
Validation loss decreased (-0.656655 --> -0.659988).  Saving model ...
Epoch: 15 cost time: 9.817744731903076
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.147 Vali Acc: 0.667 Test Loss: 1.147 Test Acc: 0.667
Validation loss decreased (-0.659988 --> -0.666655).  Saving model ...
Epoch: 16 cost time: 9.441458940505981
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.135 Vali Acc: 0.663 Test Loss: 1.135 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.703017234802246
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.131 Vali Acc: 0.667 Test Loss: 1.131 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 18 cost time: 9.945075273513794
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.119 Vali Acc: 0.677 Test Loss: 1.119 Test Acc: 0.677
Validation loss decreased (-0.666655 --> -0.676655).  Saving model ...
Epoch: 19 cost time: 9.321187019348145
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.107 Vali Acc: 0.687 Test Loss: 1.107 Test Acc: 0.687
Validation loss decreased (-0.676655 --> -0.686656).  Saving model ...
Epoch: 20 cost time: 9.260286092758179
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.096 Vali Acc: 0.697 Test Loss: 1.096 Test Acc: 0.697
Validation loss decreased (-0.686656 --> -0.696656).  Saving model ...
Epoch: 21 cost time: 9.674046277999878
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.085 Vali Acc: 0.703 Test Loss: 1.085 Test Acc: 0.703
Validation loss decreased (-0.696656 --> -0.703322).  Saving model ...
Epoch: 22 cost time: 9.157361268997192
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.084 Vali Acc: 0.697 Test Loss: 1.084 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.859224796295166
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.079 Vali Acc: 0.700 Test Loss: 1.079 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 9.719012022018433
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.075 Vali Acc: 0.710 Test Loss: 1.075 Test Acc: 0.710
Validation loss decreased (-0.703322 --> -0.709989).  Saving model ...
Epoch: 25 cost time: 8.93513011932373
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.071 Vali Acc: 0.707 Test Loss: 1.071 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.800275087356567
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.066 Vali Acc: 0.707 Test Loss: 1.066 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.913771152496338
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.060 Vali Acc: 0.713 Test Loss: 1.060 Test Acc: 0.713
Validation loss decreased (-0.709989 --> -0.713323).  Saving model ...
Epoch: 28 cost time: 9.744255065917969
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.052 Vali Acc: 0.703 Test Loss: 1.052 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 9.631486892700195
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.052 Vali Acc: 0.710 Test Loss: 1.052 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 9.150522708892822
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.056 Vali Acc: 0.713 Test Loss: 1.056 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 31 cost time: 9.790341138839722
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.054 Vali Acc: 0.713 Test Loss: 1.054 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 32 cost time: 8.651997089385986
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 9.879090309143066
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.049 Vali Acc: 0.703 Test Loss: 1.049 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 9.60614538192749
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.047 Vali Acc: 0.713 Test Loss: 1.047 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 35 cost time: 8.663243293762207
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.046 Vali Acc: 0.717 Test Loss: 1.046 Test Acc: 0.717
Validation loss decreased (-0.713323 --> -0.716656).  Saving model ...
Epoch: 36 cost time: 9.872138261795044
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.044 Vali Acc: 0.710 Test Loss: 1.044 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 9.016875267028809
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.043 Vali Acc: 0.707 Test Loss: 1.043 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 9.013876676559448
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.043 Vali Acc: 0.710 Test Loss: 1.043 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 8.642691850662231
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.041 Vali Acc: 0.710 Test Loss: 1.041 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 9.27335262298584
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.707 Test Loss: 1.036 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 9.218494415283203
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.710 Test Loss: 1.036 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 10.0463125705719
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.034 Vali Acc: 0.717 Test Loss: 1.034 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716656).  Saving model ...
Epoch: 43 cost time: 8.561476230621338
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.037 Vali Acc: 0.713 Test Loss: 1.037 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 10.206155061721802
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.035 Vali Acc: 0.717 Test Loss: 1.035 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 10.49771237373352
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.032 Vali Acc: 0.713 Test Loss: 1.032 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 10.024412393569946
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.033 Vali Acc: 0.723 Test Loss: 1.033 Test Acc: 0.723
Validation loss decreased (-0.716656 --> -0.723323).  Saving model ...
Epoch: 47 cost time: 9.416865110397339
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.720 Test Loss: 1.036 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 9.7823965549469
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.035 Vali Acc: 0.723 Test Loss: 1.035 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 10.262943744659424
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.032 Vali Acc: 0.713 Test Loss: 1.032 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 9.526901721954346
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.031 Vali Acc: 0.713 Test Loss: 1.031 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 9.173768520355225
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.028 Vali Acc: 0.720 Test Loss: 1.028 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 10.008976936340332
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.717 Test Loss: 1.030 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 11.007980585098267
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.032 Vali Acc: 0.720 Test Loss: 1.032 Test Acc: 0.720
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 9.971914529800415
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.031 Vali Acc: 0.717 Test Loss: 1.031 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 9.725785732269287
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.027 Vali Acc: 0.713 Test Loss: 1.027 Test Acc: 0.713
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 9.877692937850952
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.025 Vali Acc: 0.717 Test Loss: 1.025 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7233333333333334
model parameter : 448281
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 11.699751853942871
Epoch: 1, Steps: 18 | Train Loss: 3.256 Vali Loss: 3.154 Vali Acc: 0.080 Test Loss: 3.154 Test Acc: 0.080
Validation loss decreased (inf --> -0.079968).  Saving model ...
Epoch: 2 cost time: 9.77233099937439
Epoch: 2, Steps: 18 | Train Loss: 2.970 Vali Loss: 2.968 Vali Acc: 0.190 Test Loss: 2.968 Test Acc: 0.190
Validation loss decreased (-0.079968 --> -0.189970).  Saving model ...
Epoch: 3 cost time: 9.795261144638062
Epoch: 3, Steps: 18 | Train Loss: 2.485 Vali Loss: 2.756 Vali Acc: 0.290 Test Loss: 2.756 Test Acc: 0.290
Validation loss decreased (-0.189970 --> -0.289972).  Saving model ...
Epoch: 4 cost time: 9.455955266952515
Epoch: 4, Steps: 18 | Train Loss: 1.942 Vali Loss: 2.528 Vali Acc: 0.370 Test Loss: 2.528 Test Acc: 0.370
Validation loss decreased (-0.289972 --> -0.369975).  Saving model ...
Epoch: 5 cost time: 9.282920122146606
Epoch: 5, Steps: 18 | Train Loss: 1.400 Vali Loss: 2.333 Vali Acc: 0.403 Test Loss: 2.333 Test Acc: 0.403
Validation loss decreased (-0.369975 --> -0.403310).  Saving model ...
Epoch: 6 cost time: 10.418873071670532
Epoch: 6, Steps: 18 | Train Loss: 0.902 Vali Loss: 2.144 Vali Acc: 0.457 Test Loss: 2.144 Test Acc: 0.457
Validation loss decreased (-0.403310 --> -0.456645).  Saving model ...
Epoch: 7 cost time: 9.136263608932495
Epoch: 7, Steps: 18 | Train Loss: 0.513 Vali Loss: 1.997 Vali Acc: 0.430 Test Loss: 1.997 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.892476797103882
Epoch: 8, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.886 Vali Acc: 0.460 Test Loss: 1.886 Test Acc: 0.460
Validation loss decreased (-0.456645 --> -0.459981).  Saving model ...
Epoch: 9 cost time: 9.535662412643433
Epoch: 9, Steps: 18 | Train Loss: 0.133 Vali Loss: 1.794 Vali Acc: 0.463 Test Loss: 1.794 Test Acc: 0.463
Validation loss decreased (-0.459981 --> -0.463315).  Saving model ...
Epoch: 10 cost time: 8.90564227104187
Epoch: 10, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.717 Vali Acc: 0.480 Test Loss: 1.717 Test Acc: 0.480
Validation loss decreased (-0.463315 --> -0.479983).  Saving model ...
Epoch: 11 cost time: 9.511658668518066
Epoch: 11, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.654 Vali Acc: 0.520 Test Loss: 1.654 Test Acc: 0.520
Validation loss decreased (-0.479983 --> -0.519983).  Saving model ...
Epoch: 12 cost time: 8.866893768310547
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.611 Vali Acc: 0.523 Test Loss: 1.611 Test Acc: 0.523
Validation loss decreased (-0.519983 --> -0.523317).  Saving model ...
Epoch: 13 cost time: 9.342184782028198
Epoch: 13, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.583 Vali Acc: 0.530 Test Loss: 1.583 Test Acc: 0.530
Validation loss decreased (-0.523317 --> -0.529984).  Saving model ...
Epoch: 14 cost time: 8.749789953231812
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.551 Vali Acc: 0.543 Test Loss: 1.551 Test Acc: 0.543
Validation loss decreased (-0.529984 --> -0.543318).  Saving model ...
Epoch: 15 cost time: 8.57655644416809
Epoch: 15, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.520 Vali Acc: 0.547 Test Loss: 1.520 Test Acc: 0.547
Validation loss decreased (-0.543318 --> -0.546651).  Saving model ...
Epoch: 16 cost time: 8.49666142463684
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.487 Vali Acc: 0.563 Test Loss: 1.487 Test Acc: 0.563
Validation loss decreased (-0.546651 --> -0.563318).  Saving model ...
Epoch: 17 cost time: 9.196491003036499
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.480 Vali Acc: 0.583 Test Loss: 1.480 Test Acc: 0.583
Validation loss decreased (-0.563318 --> -0.583319).  Saving model ...
Epoch: 18 cost time: 9.494947910308838
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.448 Vali Acc: 0.577 Test Loss: 1.448 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.34773874282837
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.431 Vali Acc: 0.583 Test Loss: 1.431 Test Acc: 0.583
Validation loss decreased (-0.583319 --> -0.583319).  Saving model ...
Epoch: 20 cost time: 9.352778196334839
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.410 Vali Acc: 0.587 Test Loss: 1.410 Test Acc: 0.587
Validation loss decreased (-0.583319 --> -0.586653).  Saving model ...
Epoch: 21 cost time: 8.91446328163147
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.394 Vali Acc: 0.587 Test Loss: 1.394 Test Acc: 0.587
Validation loss decreased (-0.586653 --> -0.586653).  Saving model ...
Epoch: 22 cost time: 9.250236988067627
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.388 Vali Acc: 0.597 Test Loss: 1.388 Test Acc: 0.597
Validation loss decreased (-0.586653 --> -0.596653).  Saving model ...
Epoch: 23 cost time: 9.211629867553711
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.374 Vali Acc: 0.607 Test Loss: 1.374 Test Acc: 0.607
Validation loss decreased (-0.596653 --> -0.606653).  Saving model ...
Epoch: 24 cost time: 9.875875473022461
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.371 Vali Acc: 0.600 Test Loss: 1.371 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 10.205568790435791
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.357 Vali Acc: 0.613 Test Loss: 1.357 Test Acc: 0.613
Validation loss decreased (-0.606653 --> -0.613320).  Saving model ...
Epoch: 26 cost time: 10.883957862854004
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.355 Vali Acc: 0.613 Test Loss: 1.355 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 27 cost time: 9.32515811920166
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.350 Vali Acc: 0.613 Test Loss: 1.350 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 28 cost time: 10.099509477615356
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.341 Vali Acc: 0.630 Test Loss: 1.341 Test Acc: 0.630
Validation loss decreased (-0.613320 --> -0.629987).  Saving model ...
Epoch: 29 cost time: 9.608311176300049
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.336 Vali Acc: 0.623 Test Loss: 1.336 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 9.408527135848999
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.333 Vali Acc: 0.613 Test Loss: 1.333 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 9.128231763839722
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.325 Vali Acc: 0.630 Test Loss: 1.325 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 32 cost time: 9.78143858909607
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.319 Vali Acc: 0.627 Test Loss: 1.319 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 8.603874921798706
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.309 Vali Acc: 0.620 Test Loss: 1.309 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 9.086146593093872
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.308 Vali Acc: 0.617 Test Loss: 1.308 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 10.068803071975708
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.307 Vali Acc: 0.623 Test Loss: 1.307 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 9.693962097167969
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.303 Vali Acc: 0.630 Test Loss: 1.303 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 37 cost time: 9.056286334991455
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.302 Vali Acc: 0.633 Test Loss: 1.302 Test Acc: 0.633
Validation loss decreased (-0.629987 --> -0.633320).  Saving model ...
Epoch: 38 cost time: 9.977203369140625
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.627 Test Loss: 1.296 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 9.737396478652954
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.290 Vali Acc: 0.633 Test Loss: 1.290 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 40 cost time: 9.106935501098633
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.284 Vali Acc: 0.637 Test Loss: 1.284 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.636654).  Saving model ...
Epoch: 41 cost time: 9.931652069091797
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.282 Vali Acc: 0.633 Test Loss: 1.282 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 9.651100397109985
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.274 Vali Acc: 0.637 Test Loss: 1.274 Test Acc: 0.637
Validation loss decreased (-0.636654 --> -0.636654).  Saving model ...
Epoch: 43 cost time: 8.979305505752563
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.273 Vali Acc: 0.640 Test Loss: 1.273 Test Acc: 0.640
Validation loss decreased (-0.636654 --> -0.639987).  Saving model ...
Epoch: 44 cost time: 8.987651824951172
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.275 Vali Acc: 0.643 Test Loss: 1.275 Test Acc: 0.643
Validation loss decreased (-0.639987 --> -0.643321).  Saving model ...
Epoch: 45 cost time: 9.074220418930054
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.274 Vali Acc: 0.633 Test Loss: 1.274 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 9.516462326049805
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.274 Vali Acc: 0.637 Test Loss: 1.274 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 9.608762741088867
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.268 Vali Acc: 0.637 Test Loss: 1.268 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 8.91842246055603
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.264 Vali Acc: 0.647 Test Loss: 1.264 Test Acc: 0.647
Validation loss decreased (-0.643321 --> -0.646654).  Saving model ...
Epoch: 49 cost time: 8.837669134140015
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.263 Vali Acc: 0.647 Test Loss: 1.263 Test Acc: 0.647
Validation loss decreased (-0.646654 --> -0.646654).  Saving model ...
Epoch: 50 cost time: 9.869832515716553
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.263 Vali Acc: 0.653 Test Loss: 1.263 Test Acc: 0.653
Validation loss decreased (-0.646654 --> -0.653321).  Saving model ...
Epoch: 51 cost time: 9.851009130477905
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.259 Vali Acc: 0.657 Test Loss: 1.259 Test Acc: 0.657
Validation loss decreased (-0.653321 --> -0.656654).  Saving model ...
Epoch: 52 cost time: 9.644563913345337
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.259 Vali Acc: 0.657 Test Loss: 1.259 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 10.927117109298706
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.257 Vali Acc: 0.657 Test Loss: 1.257 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656654).  Saving model ...
Epoch: 54 cost time: 10.51370358467102
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.255 Vali Acc: 0.653 Test Loss: 1.255 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 9.33620548248291
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.252 Vali Acc: 0.657 Test Loss: 1.252 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656654).  Saving model ...
Epoch: 56 cost time: 9.742622137069702
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.246 Vali Acc: 0.657 Test Loss: 1.246 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656654).  Saving model ...
Epoch: 57 cost time: 9.631478548049927
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.244 Vali Acc: 0.660 Test Loss: 1.244 Test Acc: 0.660
Validation loss decreased (-0.656654 --> -0.659988).  Saving model ...
Epoch: 58 cost time: 9.855581760406494
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.660 Test Loss: 1.241 Test Acc: 0.660
Validation loss decreased (-0.659988 --> -0.659988).  Saving model ...
Epoch: 59 cost time: 9.43297529220581
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.238 Vali Acc: 0.657 Test Loss: 1.238 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 9.538085699081421
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.237 Vali Acc: 0.660 Test Loss: 1.237 Test Acc: 0.660
Validation loss decreased (-0.659988 --> -0.659988).  Saving model ...
Epoch: 61 cost time: 9.39293622970581
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.663 Test Loss: 1.234 Test Acc: 0.663
Validation loss decreased (-0.659988 --> -0.663321).  Saving model ...
Epoch: 62 cost time: 9.59291696548462
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.660 Test Loss: 1.230 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 10.172821998596191
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.667 Test Loss: 1.227 Test Acc: 0.667
Validation loss decreased (-0.663321 --> -0.666654).  Saving model ...
Epoch: 64 cost time: 8.39606237411499
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.667 Test Loss: 1.228 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 10.402491807937622
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.667 Test Loss: 1.225 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 66 cost time: 9.807675123214722
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.670 Test Loss: 1.223 Test Acc: 0.670
Validation loss decreased (-0.666654 --> -0.669988).  Saving model ...
Epoch: 67 cost time: 10.156952142715454
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.670 Test Loss: 1.221 Test Acc: 0.670
Validation loss decreased (-0.669988 --> -0.669988).  Saving model ...
Epoch: 68 cost time: 9.412890195846558
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.670 Test Loss: 1.221 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 10.539048910140991
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.667 Test Loss: 1.222 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 10.84510350227356
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.670 Test Loss: 1.221 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 11.14419937133789
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.670 Test Loss: 1.219 Test Acc: 0.670
Validation loss decreased (-0.669988 --> -0.669988).  Saving model ...
Epoch: 72 cost time: 12.033961057662964
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.673 Test Loss: 1.221 Test Acc: 0.673
Validation loss decreased (-0.669988 --> -0.673321).  Saving model ...
Epoch: 73 cost time: 11.422297477722168
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.670 Test Loss: 1.221 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 11.27288556098938
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.670 Test Loss: 1.218 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 11.446631908416748
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.670 Test Loss: 1.218 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 12.588008165359497
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.670 Test Loss: 1.214 Test Acc: 0.670
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 10.972740411758423
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.670 Test Loss: 1.210 Test Acc: 0.670
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 11.904884099960327
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.677 Test Loss: 1.209 Test Acc: 0.677
Validation loss decreased (-0.673321 --> -0.676655).  Saving model ...
Epoch: 79 cost time: 12.913464307785034
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.677 Test Loss: 1.209 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 13.319177389144897
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.677 Test Loss: 1.209 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 10.205657243728638
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.677 Test Loss: 1.207 Test Acc: 0.677
Validation loss decreased (-0.676655 --> -0.676655).  Saving model ...
Epoch: 82 cost time: 10.987548351287842
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.677 Test Loss: 1.207 Test Acc: 0.677
Validation loss decreased (-0.676655 --> -0.676655).  Saving model ...
Epoch: 83 cost time: 13.303468227386475
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.687 Test Loss: 1.206 Test Acc: 0.687
Validation loss decreased (-0.676655 --> -0.686655).  Saving model ...
Epoch: 84 cost time: 12.383402347564697
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.683 Test Loss: 1.207 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 10.946234703063965
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.683 Test Loss: 1.205 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 11.50236439704895
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.683 Test Loss: 1.204 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 11.832964181900024
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.680 Test Loss: 1.202 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 10.927199363708496
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.680 Test Loss: 1.199 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 12.296558380126953
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.683 Test Loss: 1.198 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 12.977844953536987
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.680 Test Loss: 1.198 Test Acc: 0.680
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 11.247746229171753
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.687 Test Loss: 1.198 Test Acc: 0.687
Validation loss decreased (-0.686655 --> -0.686655).  Saving model ...
Epoch: 92 cost time: 11.334887027740479
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.683 Test Loss: 1.198 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 12.310624122619629
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.197 Vali Acc: 0.680 Test Loss: 1.197 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 11.259156703948975
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.196 Vali Acc: 0.687 Test Loss: 1.196 Test Acc: 0.687
Validation loss decreased (-0.686655 --> -0.686655).  Saving model ...
Epoch: 95 cost time: 10.004380702972412
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.687 Test Loss: 1.198 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 11.405035495758057
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.200 Vali Acc: 0.690 Test Loss: 1.200 Test Acc: 0.690
Validation loss decreased (-0.686655 --> -0.689988).  Saving model ...
Epoch: 97 cost time: 12.683568000793457
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.687 Test Loss: 1.199 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 11.60985803604126
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.200 Vali Acc: 0.693 Test Loss: 1.200 Test Acc: 0.693
Validation loss decreased (-0.689988 --> -0.693321).  Saving model ...
Epoch: 99 cost time: 10.283761739730835
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.693 Test Loss: 1.199 Test Acc: 0.693
Validation loss decreased (-0.693321 --> -0.693321).  Saving model ...
Epoch: 100 cost time: 11.736101150512695
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.690 Test Loss: 1.198 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6933333333333334
model parameter : 448281
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 14.144256353378296
Epoch: 1, Steps: 18 | Train Loss: 3.302 Vali Loss: 3.211 Vali Acc: 0.043 Test Loss: 3.211 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 12.113542079925537
Epoch: 2, Steps: 18 | Train Loss: 2.995 Vali Loss: 3.065 Vali Acc: 0.113 Test Loss: 3.065 Test Acc: 0.113
Validation loss decreased (-0.043301 --> -0.113303).  Saving model ...
Epoch: 3 cost time: 10.19548225402832
Epoch: 3, Steps: 18 | Train Loss: 2.534 Vali Loss: 2.914 Vali Acc: 0.167 Test Loss: 2.914 Test Acc: 0.167
Validation loss decreased (-0.113303 --> -0.166638).  Saving model ...
Epoch: 4 cost time: 10.81394100189209
Epoch: 4, Steps: 18 | Train Loss: 2.028 Vali Loss: 2.734 Vali Acc: 0.297 Test Loss: 2.734 Test Acc: 0.297
Validation loss decreased (-0.166638 --> -0.296639).  Saving model ...
Epoch: 5 cost time: 10.654240131378174
Epoch: 5, Steps: 18 | Train Loss: 1.476 Vali Loss: 2.582 Vali Acc: 0.317 Test Loss: 2.582 Test Acc: 0.317
Validation loss decreased (-0.296639 --> -0.316641).  Saving model ...
Epoch: 6 cost time: 11.617419004440308
Epoch: 6, Steps: 18 | Train Loss: 0.999 Vali Loss: 2.438 Vali Acc: 0.330 Test Loss: 2.438 Test Acc: 0.330
Validation loss decreased (-0.316641 --> -0.329976).  Saving model ...
Epoch: 7 cost time: 9.070948123931885
Epoch: 7, Steps: 18 | Train Loss: 0.606 Vali Loss: 2.303 Vali Acc: 0.363 Test Loss: 2.303 Test Acc: 0.363
Validation loss decreased (-0.329976 --> -0.363310).  Saving model ...
Epoch: 8 cost time: 9.963202476501465
Epoch: 8, Steps: 18 | Train Loss: 0.340 Vali Loss: 2.191 Vali Acc: 0.370 Test Loss: 2.191 Test Acc: 0.370
Validation loss decreased (-0.363310 --> -0.369978).  Saving model ...
Epoch: 9 cost time: 8.58379316329956
Epoch: 9, Steps: 18 | Train Loss: 0.153 Vali Loss: 2.066 Vali Acc: 0.433 Test Loss: 2.066 Test Acc: 0.433
Validation loss decreased (-0.369978 --> -0.433313).  Saving model ...
Epoch: 10 cost time: 8.734819650650024
Epoch: 10, Steps: 18 | Train Loss: 0.081 Vali Loss: 2.024 Vali Acc: 0.413 Test Loss: 2.024 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.51203989982605
Epoch: 11, Steps: 18 | Train Loss: 0.054 Vali Loss: 1.932 Vali Acc: 0.437 Test Loss: 1.932 Test Acc: 0.437
Validation loss decreased (-0.433313 --> -0.436647).  Saving model ...
Epoch: 12 cost time: 8.480677366256714
Epoch: 12, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.879 Vali Acc: 0.467 Test Loss: 1.879 Test Acc: 0.467
Validation loss decreased (-0.436647 --> -0.466648).  Saving model ...
Epoch: 13 cost time: 8.4472177028656
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.843 Vali Acc: 0.473 Test Loss: 1.843 Test Acc: 0.473
Validation loss decreased (-0.466648 --> -0.473315).  Saving model ...
Epoch: 14 cost time: 8.498167514801025
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.803 Vali Acc: 0.480 Test Loss: 1.803 Test Acc: 0.480
Validation loss decreased (-0.473315 --> -0.479982).  Saving model ...
Epoch: 15 cost time: 9.91986608505249
Epoch: 15, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.773 Vali Acc: 0.507 Test Loss: 1.773 Test Acc: 0.507
Validation loss decreased (-0.479982 --> -0.506649).  Saving model ...
Epoch: 16 cost time: 9.49589204788208
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.758 Vali Acc: 0.487 Test Loss: 1.758 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.952699184417725
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.722 Vali Acc: 0.503 Test Loss: 1.722 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.407882928848267
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.693 Vali Acc: 0.517 Test Loss: 1.693 Test Acc: 0.517
Validation loss decreased (-0.506649 --> -0.516650).  Saving model ...
Epoch: 19 cost time: 8.721112728118896
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.676 Vali Acc: 0.527 Test Loss: 1.676 Test Acc: 0.527
Validation loss decreased (-0.516650 --> -0.526650).  Saving model ...
Epoch: 20 cost time: 9.431189775466919
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.648 Vali Acc: 0.517 Test Loss: 1.648 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.8807213306427
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.630 Vali Acc: 0.517 Test Loss: 1.630 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 10.072196960449219
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.622 Vali Acc: 0.533 Test Loss: 1.622 Test Acc: 0.533
Validation loss decreased (-0.526650 --> -0.533317).  Saving model ...
Epoch: 23 cost time: 9.679044723510742
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.602 Vali Acc: 0.540 Test Loss: 1.602 Test Acc: 0.540
Validation loss decreased (-0.533317 --> -0.539984).  Saving model ...
Epoch: 24 cost time: 9.60280442237854
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.591 Vali Acc: 0.550 Test Loss: 1.591 Test Acc: 0.550
Validation loss decreased (-0.539984 --> -0.549984).  Saving model ...
Epoch: 25 cost time: 8.876054048538208
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.580 Vali Acc: 0.553 Test Loss: 1.580 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553318).  Saving model ...
Epoch: 26 cost time: 7.543867826461792
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.572 Vali Acc: 0.557 Test Loss: 1.572 Test Acc: 0.557
Validation loss decreased (-0.553318 --> -0.556651).  Saving model ...
Epoch: 27 cost time: 9.172627210617065
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.563 Vali Acc: 0.567 Test Loss: 1.563 Test Acc: 0.567
Validation loss decreased (-0.556651 --> -0.566651).  Saving model ...
Epoch: 28 cost time: 9.571070671081543
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.554 Vali Acc: 0.570 Test Loss: 1.554 Test Acc: 0.570
Validation loss decreased (-0.566651 --> -0.569984).  Saving model ...
Epoch: 29 cost time: 8.132617712020874
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.545 Vali Acc: 0.557 Test Loss: 1.545 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 8.694130182266235
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.538 Vali Acc: 0.557 Test Loss: 1.538 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 8.463668584823608
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.534 Vali Acc: 0.563 Test Loss: 1.534 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 8.532238245010376
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.531 Vali Acc: 0.563 Test Loss: 1.531 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 8.062753915786743
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.513 Vali Acc: 0.573 Test Loss: 1.513 Test Acc: 0.573
Validation loss decreased (-0.569984 --> -0.573318).  Saving model ...
Epoch: 34 cost time: 9.712129592895508
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.508 Vali Acc: 0.577 Test Loss: 1.508 Test Acc: 0.577
Validation loss decreased (-0.573318 --> -0.576652).  Saving model ...
Epoch: 35 cost time: 8.903094291687012
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.504 Vali Acc: 0.577 Test Loss: 1.504 Test Acc: 0.577
Validation loss decreased (-0.576652 --> -0.576652).  Saving model ...
Epoch: 36 cost time: 9.498393774032593
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.498 Vali Acc: 0.580 Test Loss: 1.498 Test Acc: 0.580
Validation loss decreased (-0.576652 --> -0.579985).  Saving model ...
Epoch: 37 cost time: 9.30825924873352
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.497 Vali Acc: 0.580 Test Loss: 1.497 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 38 cost time: 9.812680006027222
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.489 Vali Acc: 0.573 Test Loss: 1.489 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 8.844291925430298
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.481 Vali Acc: 0.583 Test Loss: 1.481 Test Acc: 0.583
Validation loss decreased (-0.579985 --> -0.583319).  Saving model ...
Epoch: 40 cost time: 8.962687253952026
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.580 Test Loss: 1.474 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 9.461503505706787
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.467 Vali Acc: 0.587 Test Loss: 1.467 Test Acc: 0.587
Validation loss decreased (-0.583319 --> -0.586652).  Saving model ...
Epoch: 42 cost time: 9.042929649353027
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.462 Vali Acc: 0.590 Test Loss: 1.462 Test Acc: 0.590
Validation loss decreased (-0.586652 --> -0.589985).  Saving model ...
Epoch: 43 cost time: 9.191702365875244
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.457 Vali Acc: 0.593 Test Loss: 1.457 Test Acc: 0.593
Validation loss decreased (-0.589985 --> -0.593319).  Saving model ...
Epoch: 44 cost time: 8.25425410270691
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.583 Test Loss: 1.475 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 8.247894763946533
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.460 Vali Acc: 0.600 Test Loss: 1.460 Test Acc: 0.600
Validation loss decreased (-0.593319 --> -0.599985).  Saving model ...
Epoch: 46 cost time: 7.865431308746338
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.447 Vali Acc: 0.603 Test Loss: 1.447 Test Acc: 0.603
Validation loss decreased (-0.599985 --> -0.603319).  Saving model ...
Epoch: 47 cost time: 7.968127489089966
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.441 Vali Acc: 0.600 Test Loss: 1.441 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 8.68004560470581
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.439 Vali Acc: 0.597 Test Loss: 1.439 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 7.812901496887207
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.438 Vali Acc: 0.607 Test Loss: 1.438 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606652).  Saving model ...
Epoch: 50 cost time: 8.787102699279785
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.440 Vali Acc: 0.603 Test Loss: 1.440 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 9.083682775497437
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.437 Vali Acc: 0.600 Test Loss: 1.437 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 8.057254552841187
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.600 Test Loss: 1.430 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 7.444465160369873
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.425 Vali Acc: 0.603 Test Loss: 1.425 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 7.461863279342651
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.422 Vali Acc: 0.600 Test Loss: 1.422 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 8.11640739440918
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.416 Vali Acc: 0.610 Test Loss: 1.416 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 56 cost time: 8.774759292602539
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.613 Test Loss: 1.410 Test Acc: 0.613
Validation loss decreased (-0.609986 --> -0.613319).  Saving model ...
Epoch: 57 cost time: 8.096527576446533
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.409 Vali Acc: 0.610 Test Loss: 1.409 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 9.33770227432251
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.407 Vali Acc: 0.603 Test Loss: 1.407 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 8.40022349357605
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.405 Vali Acc: 0.607 Test Loss: 1.405 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 8.031335353851318
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.407 Vali Acc: 0.607 Test Loss: 1.407 Test Acc: 0.607
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 8.36182689666748
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.603 Test Loss: 1.406 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 7.742383241653442
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.603 Test Loss: 1.405 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 9.275410175323486
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.607 Test Loss: 1.401 Test Acc: 0.607
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 9.311316967010498
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.610 Test Loss: 1.398 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 9.554425239562988
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.394 Vali Acc: 0.607 Test Loss: 1.394 Test Acc: 0.607
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 8.192274808883667
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.610 Test Loss: 1.393 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6133333333333333
model parameter : 448281
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.823689460754395
Epoch: 1, Steps: 18 | Train Loss: 3.263 Vali Loss: 3.252 Vali Acc: 0.050 Test Loss: 3.252 Test Acc: 0.050
Validation loss decreased (inf --> -0.049967).  Saving model ...
Epoch: 2 cost time: 9.217006206512451
Epoch: 2, Steps: 18 | Train Loss: 3.020 Vali Loss: 3.171 Vali Acc: 0.060 Test Loss: 3.171 Test Acc: 0.060
Validation loss decreased (-0.049967 --> -0.059968).  Saving model ...
Epoch: 3 cost time: 8.866627931594849
Epoch: 3, Steps: 18 | Train Loss: 2.594 Vali Loss: 3.073 Vali Acc: 0.097 Test Loss: 3.073 Test Acc: 0.097
Validation loss decreased (-0.059968 --> -0.096636).  Saving model ...
Epoch: 4 cost time: 8.504176616668701
Epoch: 4, Steps: 18 | Train Loss: 2.081 Vali Loss: 2.966 Vali Acc: 0.140 Test Loss: 2.966 Test Acc: 0.140
Validation loss decreased (-0.096636 --> -0.139970).  Saving model ...
Epoch: 5 cost time: 9.147153615951538
Epoch: 5, Steps: 18 | Train Loss: 1.578 Vali Loss: 2.870 Vali Acc: 0.137 Test Loss: 2.870 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.555863380432129
Epoch: 6, Steps: 18 | Train Loss: 1.075 Vali Loss: 2.799 Vali Acc: 0.147 Test Loss: 2.799 Test Acc: 0.147
Validation loss decreased (-0.139970 --> -0.146639).  Saving model ...
Epoch: 7 cost time: 8.504210710525513
Epoch: 7, Steps: 18 | Train Loss: 0.672 Vali Loss: 2.697 Vali Acc: 0.173 Test Loss: 2.697 Test Acc: 0.173
Validation loss decreased (-0.146639 --> -0.173306).  Saving model ...
Epoch: 8 cost time: 8.276795387268066
Epoch: 8, Steps: 18 | Train Loss: 0.396 Vali Loss: 2.647 Vali Acc: 0.177 Test Loss: 2.647 Test Acc: 0.177
Validation loss decreased (-0.173306 --> -0.176640).  Saving model ...
Epoch: 9 cost time: 10.05104684829712
Epoch: 9, Steps: 18 | Train Loss: 0.188 Vali Loss: 2.511 Vali Acc: 0.217 Test Loss: 2.511 Test Acc: 0.217
Validation loss decreased (-0.176640 --> -0.216642).  Saving model ...
Epoch: 10 cost time: 8.315848112106323
Epoch: 10, Steps: 18 | Train Loss: 0.113 Vali Loss: 2.401 Vali Acc: 0.247 Test Loss: 2.401 Test Acc: 0.247
Validation loss decreased (-0.216642 --> -0.246643).  Saving model ...
Epoch: 11 cost time: 9.063583374023438
Epoch: 11, Steps: 18 | Train Loss: 0.065 Vali Loss: 2.336 Vali Acc: 0.273 Test Loss: 2.336 Test Acc: 0.273
Validation loss decreased (-0.246643 --> -0.273310).  Saving model ...
Epoch: 12 cost time: 8.500743389129639
Epoch: 12, Steps: 18 | Train Loss: 0.041 Vali Loss: 2.265 Vali Acc: 0.320 Test Loss: 2.265 Test Acc: 0.320
Validation loss decreased (-0.273310 --> -0.319977).  Saving model ...
Epoch: 13 cost time: 8.97456431388855
Epoch: 13, Steps: 18 | Train Loss: 0.029 Vali Loss: 2.192 Vali Acc: 0.317 Test Loss: 2.192 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.641120433807373
Epoch: 14, Steps: 18 | Train Loss: 0.024 Vali Loss: 2.147 Vali Acc: 0.337 Test Loss: 2.147 Test Acc: 0.337
Validation loss decreased (-0.319977 --> -0.336645).  Saving model ...
Epoch: 15 cost time: 8.647966146469116
Epoch: 15, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.128 Vali Acc: 0.343 Test Loss: 2.128 Test Acc: 0.343
Validation loss decreased (-0.336645 --> -0.343312).  Saving model ...
Epoch: 16 cost time: 8.521867752075195
Epoch: 16, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.084 Vali Acc: 0.357 Test Loss: 2.084 Test Acc: 0.357
Validation loss decreased (-0.343312 --> -0.356646).  Saving model ...
Epoch: 17 cost time: 9.165707111358643
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 2.035 Vali Acc: 0.363 Test Loss: 2.035 Test Acc: 0.363
Validation loss decreased (-0.356646 --> -0.363313).  Saving model ...
Epoch: 18 cost time: 9.044431447982788
Epoch: 18, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.015 Vali Acc: 0.363 Test Loss: 2.015 Test Acc: 0.363
Validation loss decreased (-0.363313 --> -0.363313).  Saving model ...
Epoch: 19 cost time: 10.794025421142578
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.000 Vali Acc: 0.383 Test Loss: 2.000 Test Acc: 0.383
Validation loss decreased (-0.363313 --> -0.383313).  Saving model ...
Epoch: 20 cost time: 9.024872541427612
Epoch: 20, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.953 Vali Acc: 0.400 Test Loss: 1.953 Test Acc: 0.400
Validation loss decreased (-0.383313 --> -0.399980).  Saving model ...
Epoch: 21 cost time: 9.025887250900269
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.930 Vali Acc: 0.423 Test Loss: 1.930 Test Acc: 0.423
Validation loss decreased (-0.399980 --> -0.423314).  Saving model ...
Epoch: 22 cost time: 9.99097990989685
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.903 Vali Acc: 0.430 Test Loss: 1.903 Test Acc: 0.430
Validation loss decreased (-0.423314 --> -0.429981).  Saving model ...
Epoch: 23 cost time: 10.057482481002808
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.884 Vali Acc: 0.443 Test Loss: 1.884 Test Acc: 0.443
Validation loss decreased (-0.429981 --> -0.443314).  Saving model ...
Epoch: 24 cost time: 8.532732486724854
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.877 Vali Acc: 0.433 Test Loss: 1.877 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.956542253494263
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.878 Vali Acc: 0.427 Test Loss: 1.878 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 8.30321478843689
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.851 Vali Acc: 0.447 Test Loss: 1.851 Test Acc: 0.447
Validation loss decreased (-0.443314 --> -0.446648).  Saving model ...
Epoch: 27 cost time: 8.52793002128601
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.830 Vali Acc: 0.450 Test Loss: 1.830 Test Acc: 0.450
Validation loss decreased (-0.446648 --> -0.449982).  Saving model ...
Epoch: 28 cost time: 8.049454927444458
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.830 Vali Acc: 0.450 Test Loss: 1.830 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 8.268810987472534
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.817 Vali Acc: 0.447 Test Loss: 1.817 Test Acc: 0.447
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 7.7270190715789795
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.810 Vali Acc: 0.460 Test Loss: 1.810 Test Acc: 0.460
Validation loss decreased (-0.449982 --> -0.459982).  Saving model ...
Epoch: 31 cost time: 8.409013271331787
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.799 Vali Acc: 0.463 Test Loss: 1.799 Test Acc: 0.463
Validation loss decreased (-0.459982 --> -0.463315).  Saving model ...
Epoch: 32 cost time: 8.580623626708984
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.787 Vali Acc: 0.470 Test Loss: 1.787 Test Acc: 0.470
Validation loss decreased (-0.463315 --> -0.469982).  Saving model ...
Epoch: 33 cost time: 8.79421329498291
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.775 Vali Acc: 0.480 Test Loss: 1.775 Test Acc: 0.480
Validation loss decreased (-0.469982 --> -0.479982).  Saving model ...
Epoch: 34 cost time: 9.322782516479492
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.767 Vali Acc: 0.483 Test Loss: 1.767 Test Acc: 0.483
Validation loss decreased (-0.479982 --> -0.483316).  Saving model ...
Epoch: 35 cost time: 7.850700855255127
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.754 Vali Acc: 0.487 Test Loss: 1.754 Test Acc: 0.487
Validation loss decreased (-0.483316 --> -0.486649).  Saving model ...
Epoch: 36 cost time: 8.339880228042603
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.742 Vali Acc: 0.490 Test Loss: 1.742 Test Acc: 0.490
Validation loss decreased (-0.486649 --> -0.489983).  Saving model ...
Epoch: 37 cost time: 9.4454185962677
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.731 Vali Acc: 0.490 Test Loss: 1.731 Test Acc: 0.490
Validation loss decreased (-0.489983 --> -0.489983).  Saving model ...
Epoch: 38 cost time: 8.680742025375366
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.723 Vali Acc: 0.497 Test Loss: 1.723 Test Acc: 0.497
Validation loss decreased (-0.489983 --> -0.496649).  Saving model ...
Epoch: 39 cost time: 8.025318145751953
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.719 Vali Acc: 0.500 Test Loss: 1.719 Test Acc: 0.500
Validation loss decreased (-0.496649 --> -0.499983).  Saving model ...
Epoch: 40 cost time: 8.898295402526855
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.710 Vali Acc: 0.500 Test Loss: 1.710 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499983).  Saving model ...
Epoch: 41 cost time: 8.787596940994263
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.699 Vali Acc: 0.503 Test Loss: 1.699 Test Acc: 0.503
Validation loss decreased (-0.499983 --> -0.503316).  Saving model ...
Epoch: 42 cost time: 8.702718019485474
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.693 Vali Acc: 0.500 Test Loss: 1.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 8.988138198852539
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.503 Test Loss: 1.688 Test Acc: 0.503
Validation loss decreased (-0.503316 --> -0.503316).  Saving model ...
Epoch: 44 cost time: 8.573386907577515
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.681 Vali Acc: 0.510 Test Loss: 1.681 Test Acc: 0.510
Validation loss decreased (-0.503316 --> -0.509983).  Saving model ...
Epoch: 45 cost time: 10.004456281661987
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.678 Vali Acc: 0.510 Test Loss: 1.678 Test Acc: 0.510
Validation loss decreased (-0.509983 --> -0.509983).  Saving model ...
Epoch: 46 cost time: 9.253893375396729
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.664 Vali Acc: 0.510 Test Loss: 1.664 Test Acc: 0.510
Validation loss decreased (-0.509983 --> -0.509983).  Saving model ...
Epoch: 47 cost time: 10.217430114746094
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.658 Vali Acc: 0.520 Test Loss: 1.658 Test Acc: 0.520
Validation loss decreased (-0.509983 --> -0.519983).  Saving model ...
Epoch: 48 cost time: 9.611017942428589
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.652 Vali Acc: 0.513 Test Loss: 1.652 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 8.961334943771362
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.645 Vali Acc: 0.520 Test Loss: 1.645 Test Acc: 0.520
Validation loss decreased (-0.519983 --> -0.519984).  Saving model ...
Epoch: 50 cost time: 8.385830640792847
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.637 Vali Acc: 0.523 Test Loss: 1.637 Test Acc: 0.523
Validation loss decreased (-0.519984 --> -0.523317).  Saving model ...
Epoch: 51 cost time: 8.621512174606323
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.523 Test Loss: 1.633 Test Acc: 0.523
Validation loss decreased (-0.523317 --> -0.523317).  Saving model ...
Epoch: 52 cost time: 8.332913398742676
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.628 Vali Acc: 0.523 Test Loss: 1.628 Test Acc: 0.523
Validation loss decreased (-0.523317 --> -0.523317).  Saving model ...
Epoch: 53 cost time: 9.306929588317871
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.625 Vali Acc: 0.520 Test Loss: 1.625 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 9.886558771133423
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.627 Vali Acc: 0.517 Test Loss: 1.627 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 9.83710503578186
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.623 Vali Acc: 0.523 Test Loss: 1.623 Test Acc: 0.523
Validation loss decreased (-0.523317 --> -0.523317).  Saving model ...
Epoch: 56 cost time: 9.843239307403564
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.530 Test Loss: 1.619 Test Acc: 0.530
Validation loss decreased (-0.523317 --> -0.529984).  Saving model ...
Epoch: 57 cost time: 8.837720394134521
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.617 Vali Acc: 0.530 Test Loss: 1.617 Test Acc: 0.530
Validation loss decreased (-0.529984 --> -0.529984).  Saving model ...
Epoch: 58 cost time: 9.46487021446228
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.613 Vali Acc: 0.533 Test Loss: 1.613 Test Acc: 0.533
Validation loss decreased (-0.529984 --> -0.533317).  Saving model ...
Epoch: 59 cost time: 8.771583318710327
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.610 Vali Acc: 0.533 Test Loss: 1.610 Test Acc: 0.533
Validation loss decreased (-0.533317 --> -0.533317).  Saving model ...
Epoch: 60 cost time: 8.75275993347168
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.608 Vali Acc: 0.540 Test Loss: 1.608 Test Acc: 0.540
Validation loss decreased (-0.533317 --> -0.539984).  Saving model ...
Epoch: 61 cost time: 9.283519268035889
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.608 Vali Acc: 0.540 Test Loss: 1.608 Test Acc: 0.540
Validation loss decreased (-0.539984 --> -0.539984).  Saving model ...
Epoch: 62 cost time: 8.948070287704468
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.603 Vali Acc: 0.540 Test Loss: 1.603 Test Acc: 0.540
Validation loss decreased (-0.539984 --> -0.539984).  Saving model ...
Epoch: 63 cost time: 8.821067571640015
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.598 Vali Acc: 0.547 Test Loss: 1.598 Test Acc: 0.547
Validation loss decreased (-0.539984 --> -0.546651).  Saving model ...
Epoch: 64 cost time: 8.56619668006897
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.594 Vali Acc: 0.537 Test Loss: 1.594 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 8.725852489471436
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.593 Vali Acc: 0.537 Test Loss: 1.593 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 8.663509845733643
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.537 Test Loss: 1.587 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 8.454141616821289
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.543 Test Loss: 1.582 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 7.990808725357056
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.577 Vali Acc: 0.550 Test Loss: 1.577 Test Acc: 0.550
Validation loss decreased (-0.546651 --> -0.549984).  Saving model ...
Epoch: 69 cost time: 10.124645709991455
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.550 Test Loss: 1.575 Test Acc: 0.550
Validation loss decreased (-0.549984 --> -0.549984).  Saving model ...
Epoch: 70 cost time: 10.114420175552368
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.553 Test Loss: 1.572 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553318).  Saving model ...
Epoch: 71 cost time: 9.901517391204834
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.553 Test Loss: 1.569 Test Acc: 0.553
Validation loss decreased (-0.553318 --> -0.553318).  Saving model ...
Epoch: 72 cost time: 9.176502466201782
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.553 Test Loss: 1.567 Test Acc: 0.553
Validation loss decreased (-0.553318 --> -0.553318).  Saving model ...
Epoch: 73 cost time: 8.591707944869995
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.565 Vali Acc: 0.553 Test Loss: 1.565 Test Acc: 0.553
Validation loss decreased (-0.553318 --> -0.553318).  Saving model ...
Epoch: 74 cost time: 9.955002784729004
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.564 Vali Acc: 0.557 Test Loss: 1.564 Test Acc: 0.557
Validation loss decreased (-0.553318 --> -0.556651).  Saving model ...
Epoch: 75 cost time: 9.158381700515747
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.557 Test Loss: 1.562 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 76 cost time: 10.157958507537842
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.553 Test Loss: 1.561 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 10.094948530197144
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.557 Test Loss: 1.558 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 78 cost time: 9.61887001991272
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.560 Vali Acc: 0.557 Test Loss: 1.560 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 8.373670101165771
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.553 Test Loss: 1.558 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 8.33644413948059
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.557 Test Loss: 1.554 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 81 cost time: 8.956471681594849
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.553 Test Loss: 1.551 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 8.457107543945312
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.553 Test Loss: 1.550 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 8.840600490570068
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.548 Vali Acc: 0.553 Test Loss: 1.548 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 9.58187985420227
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.550 Test Loss: 1.550 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 8.884804725646973
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.553 Test Loss: 1.550 Test Acc: 0.553
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 8.447666883468628
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.545 Vali Acc: 0.560 Test Loss: 1.545 Test Acc: 0.560
Validation loss decreased (-0.556651 --> -0.559985).  Saving model ...
Epoch: 87 cost time: 7.023337364196777
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.570 Test Loss: 1.540 Test Acc: 0.570
Validation loss decreased (-0.559985 --> -0.569985).  Saving model ...
Epoch: 88 cost time: 7.940687656402588
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.570 Test Loss: 1.536 Test Acc: 0.570
Validation loss decreased (-0.569985 --> -0.569985).  Saving model ...
Epoch: 89 cost time: 7.687274932861328
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.570 Test Loss: 1.534 Test Acc: 0.570
Validation loss decreased (-0.569985 --> -0.569985).  Saving model ...
Epoch: 90 cost time: 8.353054761886597
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.577 Test Loss: 1.530 Test Acc: 0.577
Validation loss decreased (-0.569985 --> -0.576651).  Saving model ...
Epoch: 91 cost time: 8.27644944190979
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.573 Test Loss: 1.530 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 9.425256967544556
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.570 Test Loss: 1.534 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 9.164960861206055
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.577 Test Loss: 1.531 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 7.345721006393433
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.570 Test Loss: 1.536 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 8.267173767089844
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.537 Vali Acc: 0.570 Test Loss: 1.537 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 7.413892507553101
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.570 Test Loss: 1.535 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 7.8259217739105225
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.573 Test Loss: 1.533 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 7.808718919754028
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.580 Test Loss: 1.533 Test Acc: 0.580
Validation loss decreased (-0.576651 --> -0.579985).  Saving model ...
Epoch: 99 cost time: 8.352894067764282
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.580 Test Loss: 1.532 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 100 cost time: 8.158277750015259
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.580 Test Loss: 1.528 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.58
model parameter : 448281
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.126376152038574
Epoch: 1, Steps: 18 | Train Loss: 3.290 Vali Loss: 3.245 Vali Acc: 0.047 Test Loss: 3.245 Test Acc: 0.047
Validation loss decreased (inf --> -0.046634).  Saving model ...
Epoch: 2 cost time: 6.839208126068115
Epoch: 2, Steps: 18 | Train Loss: 3.031 Vali Loss: 3.165 Vali Acc: 0.063 Test Loss: 3.165 Test Acc: 0.063
Validation loss decreased (-0.046634 --> -0.063302).  Saving model ...
Epoch: 3 cost time: 7.85988974571228
Epoch: 3, Steps: 18 | Train Loss: 2.713 Vali Loss: 3.076 Vali Acc: 0.090 Test Loss: 3.076 Test Acc: 0.090
Validation loss decreased (-0.063302 --> -0.089969).  Saving model ...
Epoch: 4 cost time: 8.160475969314575
Epoch: 4, Steps: 18 | Train Loss: 2.252 Vali Loss: 2.979 Vali Acc: 0.123 Test Loss: 2.979 Test Acc: 0.123
Validation loss decreased (-0.089969 --> -0.123304).  Saving model ...
Epoch: 5 cost time: 7.562852144241333
Epoch: 5, Steps: 18 | Train Loss: 1.801 Vali Loss: 2.880 Vali Acc: 0.170 Test Loss: 2.880 Test Acc: 0.170
Validation loss decreased (-0.123304 --> -0.169971).  Saving model ...
Epoch: 6 cost time: 7.1234588623046875
Epoch: 6, Steps: 18 | Train Loss: 1.371 Vali Loss: 2.814 Vali Acc: 0.150 Test Loss: 2.814 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.652859687805176
Epoch: 7, Steps: 18 | Train Loss: 0.941 Vali Loss: 2.711 Vali Acc: 0.187 Test Loss: 2.711 Test Acc: 0.187
Validation loss decreased (-0.169971 --> -0.186640).  Saving model ...
Epoch: 8 cost time: 6.8797385692596436
Epoch: 8, Steps: 18 | Train Loss: 0.636 Vali Loss: 2.619 Vali Acc: 0.220 Test Loss: 2.619 Test Acc: 0.220
Validation loss decreased (-0.186640 --> -0.219974).  Saving model ...
Epoch: 9 cost time: 6.883072853088379
Epoch: 9, Steps: 18 | Train Loss: 0.364 Vali Loss: 2.439 Vali Acc: 0.250 Test Loss: 2.439 Test Acc: 0.250
Validation loss decreased (-0.219974 --> -0.249976).  Saving model ...
Epoch: 10 cost time: 7.250636100769043
Epoch: 10, Steps: 18 | Train Loss: 0.210 Vali Loss: 2.318 Vali Acc: 0.297 Test Loss: 2.318 Test Acc: 0.297
Validation loss decreased (-0.249976 --> -0.296643).  Saving model ...
Epoch: 11 cost time: 6.970595121383667
Epoch: 11, Steps: 18 | Train Loss: 0.108 Vali Loss: 2.206 Vali Acc: 0.320 Test Loss: 2.206 Test Acc: 0.320
Validation loss decreased (-0.296643 --> -0.319978).  Saving model ...
Epoch: 12 cost time: 6.910151481628418
Epoch: 12, Steps: 18 | Train Loss: 0.069 Vali Loss: 2.150 Vali Acc: 0.320 Test Loss: 2.150 Test Acc: 0.320
Validation loss decreased (-0.319978 --> -0.319978).  Saving model ...
Epoch: 13 cost time: 7.185535669326782
Epoch: 13, Steps: 18 | Train Loss: 0.044 Vali Loss: 2.035 Vali Acc: 0.373 Test Loss: 2.035 Test Acc: 0.373
Validation loss decreased (-0.319978 --> -0.373313).  Saving model ...
Epoch: 14 cost time: 6.645558834075928
Epoch: 14, Steps: 18 | Train Loss: 0.033 Vali Loss: 1.994 Vali Acc: 0.387 Test Loss: 1.994 Test Acc: 0.387
Validation loss decreased (-0.373313 --> -0.386647).  Saving model ...
Epoch: 15 cost time: 7.0479371547698975
Epoch: 15, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.987 Vali Acc: 0.387 Test Loss: 1.987 Test Acc: 0.387
Validation loss decreased (-0.386647 --> -0.386647).  Saving model ...
Epoch: 16 cost time: 6.988892078399658
Epoch: 16, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.941 Vali Acc: 0.393 Test Loss: 1.941 Test Acc: 0.393
Validation loss decreased (-0.386647 --> -0.393314).  Saving model ...
Epoch: 17 cost time: 6.7259650230407715
Epoch: 17, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.889 Vali Acc: 0.407 Test Loss: 1.889 Test Acc: 0.407
Validation loss decreased (-0.393314 --> -0.406648).  Saving model ...
Epoch: 18 cost time: 7.139066934585571
Epoch: 18, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.867 Vali Acc: 0.433 Test Loss: 1.867 Test Acc: 0.433
Validation loss decreased (-0.406648 --> -0.433315).  Saving model ...
Epoch: 19 cost time: 6.910753011703491
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.898 Vali Acc: 0.427 Test Loss: 1.898 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.7747087478637695
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.857 Vali Acc: 0.427 Test Loss: 1.857 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.815727949142456
Epoch: 21, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.828 Vali Acc: 0.443 Test Loss: 1.828 Test Acc: 0.443
Validation loss decreased (-0.433315 --> -0.443315).  Saving model ...
Epoch: 22 cost time: 6.727713108062744
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.844 Vali Acc: 0.447 Test Loss: 1.844 Test Acc: 0.447
Validation loss decreased (-0.443315 --> -0.446648).  Saving model ...
Epoch: 23 cost time: 6.2689995765686035
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.829 Vali Acc: 0.443 Test Loss: 1.829 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.27859902381897
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.809 Vali Acc: 0.450 Test Loss: 1.809 Test Acc: 0.450
Validation loss decreased (-0.446648 --> -0.449982).  Saving model ...
Epoch: 25 cost time: 8.208945989608765
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.797 Vali Acc: 0.450 Test Loss: 1.797 Test Acc: 0.450
Validation loss decreased (-0.449982 --> -0.449982).  Saving model ...
Epoch: 26 cost time: 6.945075035095215
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.780 Vali Acc: 0.467 Test Loss: 1.780 Test Acc: 0.467
Validation loss decreased (-0.449982 --> -0.466649).  Saving model ...
Epoch: 27 cost time: 7.5029284954071045
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.770 Vali Acc: 0.473 Test Loss: 1.770 Test Acc: 0.473
Validation loss decreased (-0.466649 --> -0.473316).  Saving model ...
Epoch: 28 cost time: 7.05518913269043
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.769 Vali Acc: 0.477 Test Loss: 1.769 Test Acc: 0.477
Validation loss decreased (-0.473316 --> -0.476649).  Saving model ...
Epoch: 29 cost time: 6.912050485610962
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.761 Vali Acc: 0.480 Test Loss: 1.761 Test Acc: 0.480
Validation loss decreased (-0.476649 --> -0.479982).  Saving model ...
Epoch: 30 cost time: 6.567980766296387
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.740 Vali Acc: 0.480 Test Loss: 1.740 Test Acc: 0.480
Validation loss decreased (-0.479982 --> -0.479983).  Saving model ...
Epoch: 31 cost time: 6.960942983627319
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.722 Vali Acc: 0.483 Test Loss: 1.722 Test Acc: 0.483
Validation loss decreased (-0.479983 --> -0.483316).  Saving model ...
Epoch: 32 cost time: 6.453595876693726
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.723 Vali Acc: 0.493 Test Loss: 1.723 Test Acc: 0.493
Validation loss decreased (-0.483316 --> -0.493316).  Saving model ...
Epoch: 33 cost time: 7.801978588104248
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.730 Vali Acc: 0.477 Test Loss: 1.730 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.6774742603302
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.727 Vali Acc: 0.480 Test Loss: 1.727 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.737360239028931
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.744 Vali Acc: 0.473 Test Loss: 1.744 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 6.272814750671387
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.736 Vali Acc: 0.490 Test Loss: 1.736 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 6.411343097686768
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.715 Vali Acc: 0.500 Test Loss: 1.715 Test Acc: 0.500
Validation loss decreased (-0.493316 --> -0.499983).  Saving model ...
Epoch: 38 cost time: 7.3823816776275635
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.714 Vali Acc: 0.503 Test Loss: 1.714 Test Acc: 0.503
Validation loss decreased (-0.499983 --> -0.503316).  Saving model ...
Epoch: 39 cost time: 6.912180185317993
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.713 Vali Acc: 0.510 Test Loss: 1.713 Test Acc: 0.510
Validation loss decreased (-0.503316 --> -0.509983).  Saving model ...
Epoch: 40 cost time: 7.1319591999053955
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.708 Vali Acc: 0.497 Test Loss: 1.708 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.774204254150391
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.702 Vali Acc: 0.500 Test Loss: 1.702 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.577908277511597
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.706 Vali Acc: 0.507 Test Loss: 1.706 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.577653169631958
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.695 Vali Acc: 0.507 Test Loss: 1.695 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.65720534324646
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.673 Vali Acc: 0.510 Test Loss: 1.673 Test Acc: 0.510
Validation loss decreased (-0.509983 --> -0.509983).  Saving model ...
Epoch: 45 cost time: 6.7999467849731445
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.672 Vali Acc: 0.510 Test Loss: 1.672 Test Acc: 0.510
Validation loss decreased (-0.509983 --> -0.509983).  Saving model ...
Epoch: 46 cost time: 7.50398588180542
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.662 Vali Acc: 0.513 Test Loss: 1.662 Test Acc: 0.513
Validation loss decreased (-0.509983 --> -0.513317).  Saving model ...
Epoch: 47 cost time: 7.160973787307739
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.653 Vali Acc: 0.517 Test Loss: 1.653 Test Acc: 0.517
Validation loss decreased (-0.513317 --> -0.516650).  Saving model ...
Epoch: 48 cost time: 6.986687183380127
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.645 Vali Acc: 0.530 Test Loss: 1.645 Test Acc: 0.530
Validation loss decreased (-0.516650 --> -0.529984).  Saving model ...
Epoch: 49 cost time: 6.344132900238037
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.659 Vali Acc: 0.527 Test Loss: 1.659 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 7.388033866882324
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.660 Vali Acc: 0.540 Test Loss: 1.660 Test Acc: 0.540
Validation loss decreased (-0.529984 --> -0.539983).  Saving model ...
Epoch: 51 cost time: 7.694502592086792
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.652 Vali Acc: 0.547 Test Loss: 1.652 Test Acc: 0.547
Validation loss decreased (-0.539983 --> -0.546650).  Saving model ...
Epoch: 52 cost time: 7.660845994949341
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.649 Vali Acc: 0.547 Test Loss: 1.649 Test Acc: 0.547
Validation loss decreased (-0.546650 --> -0.546650).  Saving model ...
Epoch: 53 cost time: 7.448276996612549
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.635 Vali Acc: 0.553 Test Loss: 1.635 Test Acc: 0.553
Validation loss decreased (-0.546650 --> -0.553317).  Saving model ...
Epoch: 54 cost time: 7.542441129684448
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.543 Test Loss: 1.630 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 7.2944042682647705
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.623 Vali Acc: 0.547 Test Loss: 1.623 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 7.0139479637146
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.613 Vali Acc: 0.547 Test Loss: 1.613 Test Acc: 0.547
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 7.081809997558594
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.609 Vali Acc: 0.553 Test Loss: 1.609 Test Acc: 0.553
Validation loss decreased (-0.553317 --> -0.553317).  Saving model ...
Epoch: 58 cost time: 6.526374340057373
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.604 Vali Acc: 0.560 Test Loss: 1.604 Test Acc: 0.560
Validation loss decreased (-0.553317 --> -0.559984).  Saving model ...
Epoch: 59 cost time: 6.9887776374816895
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.560 Test Loss: 1.606 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 7.4199090003967285
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.607 Vali Acc: 0.563 Test Loss: 1.607 Test Acc: 0.563
Validation loss decreased (-0.559984 --> -0.563317).  Saving model ...
Epoch: 61 cost time: 7.570312738418579
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.611 Vali Acc: 0.560 Test Loss: 1.611 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.625422954559326
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.607 Vali Acc: 0.567 Test Loss: 1.607 Test Acc: 0.567
Validation loss decreased (-0.563317 --> -0.566651).  Saving model ...
Epoch: 63 cost time: 6.268960475921631
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.605 Vali Acc: 0.570 Test Loss: 1.605 Test Acc: 0.570
Validation loss decreased (-0.566651 --> -0.569984).  Saving model ...
Epoch: 64 cost time: 7.640658140182495
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.604 Vali Acc: 0.570 Test Loss: 1.604 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 65 cost time: 7.48449969291687
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.609 Vali Acc: 0.587 Test Loss: 1.609 Test Acc: 0.587
Validation loss decreased (-0.569984 --> -0.586651).  Saving model ...
Epoch: 66 cost time: 7.339960813522339
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.607 Vali Acc: 0.577 Test Loss: 1.607 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 7.388652563095093
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.604 Vali Acc: 0.573 Test Loss: 1.604 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 6.4485156536102295
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.567 Test Loss: 1.601 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 7.33206033706665
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.595 Vali Acc: 0.573 Test Loss: 1.595 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 6.9502787590026855
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.577 Test Loss: 1.591 Test Acc: 0.577
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 6.881141662597656
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.589 Vali Acc: 0.577 Test Loss: 1.589 Test Acc: 0.577
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 7.2641541957855225
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.573 Test Loss: 1.585 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 6.66606593132019
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.577 Test Loss: 1.583 Test Acc: 0.577
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 7.286443471908569
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.587 Test Loss: 1.583 Test Acc: 0.587
Validation loss decreased (-0.586651 --> -0.586651).  Saving model ...
Epoch: 75 cost time: 7.414493799209595
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.580 Test Loss: 1.583 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 7.312992095947266
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.577 Test Loss: 1.582 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 7.425621747970581
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.593 Test Loss: 1.582 Test Acc: 0.593
Validation loss decreased (-0.586651 --> -0.593318).  Saving model ...
Epoch: 78 cost time: 7.179296255111694
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.590 Test Loss: 1.583 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 7.191713809967041
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.593 Test Loss: 1.581 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 80 cost time: 7.020592451095581
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.597 Test Loss: 1.579 Test Acc: 0.597
Validation loss decreased (-0.593318 --> -0.596651).  Saving model ...
Epoch: 81 cost time: 7.197243928909302
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.593 Test Loss: 1.585 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 7.5428948402404785
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.593 Test Loss: 1.586 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 7.774576663970947
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.589 Vali Acc: 0.593 Test Loss: 1.589 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 7.772670745849609
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.597 Test Loss: 1.588 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 7.095452308654785
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.597 Test Loss: 1.581 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 7.316965818405151
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.597 Test Loss: 1.569 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 87 cost time: 7.101510524749756
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.568 Vali Acc: 0.593 Test Loss: 1.568 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 7.8618268966674805
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.565 Vali Acc: 0.597 Test Loss: 1.565 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 89 cost time: 7.1449174880981445
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.565 Vali Acc: 0.597 Test Loss: 1.565 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 7.737013339996338
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.593 Test Loss: 1.566 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 7.603718519210815
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.563 Vali Acc: 0.597 Test Loss: 1.563 Test Acc: 0.597
Validation loss decreased (-0.596651 --> -0.596651).  Saving model ...
Epoch: 92 cost time: 7.332262754440308
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.603 Test Loss: 1.559 Test Acc: 0.603
Validation loss decreased (-0.596651 --> -0.603318).  Saving model ...
Epoch: 93 cost time: 6.7477757930755615
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.600 Test Loss: 1.559 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 7.311371803283691
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.565 Vali Acc: 0.597 Test Loss: 1.565 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 7.076473951339722
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.600 Test Loss: 1.556 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 7.1711039543151855
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.552 Vali Acc: 0.603 Test Loss: 1.552 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 97 cost time: 7.072405099868774
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.603 Test Loss: 1.551 Test Acc: 0.603
Validation loss decreased (-0.603318 --> -0.603318).  Saving model ...
Epoch: 98 cost time: 6.966127157211304
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.603 Test Loss: 1.553 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 6.832095623016357
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.597 Test Loss: 1.554 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 6.511520862579346
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.597 Test Loss: 1.551 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6033333333333334
model parameter : 448281
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.60343885421753
Epoch: 1, Steps: 18 | Train Loss: 3.293 Vali Loss: 3.242 Vali Acc: 0.053 Test Loss: 3.242 Test Acc: 0.053
Validation loss decreased (inf --> -0.053301).  Saving model ...
Epoch: 2 cost time: 6.654789686203003
Epoch: 2, Steps: 18 | Train Loss: 3.061 Vali Loss: 3.177 Vali Acc: 0.077 Test Loss: 3.177 Test Acc: 0.077
Validation loss decreased (-0.053301 --> -0.076635).  Saving model ...
Epoch: 3 cost time: 6.702309608459473
Epoch: 3, Steps: 18 | Train Loss: 2.792 Vali Loss: 3.096 Vali Acc: 0.103 Test Loss: 3.096 Test Acc: 0.103
Validation loss decreased (-0.076635 --> -0.103302).  Saving model ...
Epoch: 4 cost time: 6.4886133670806885
Epoch: 4, Steps: 18 | Train Loss: 2.324 Vali Loss: 3.010 Vali Acc: 0.127 Test Loss: 3.010 Test Acc: 0.127
Validation loss decreased (-0.103302 --> -0.126637).  Saving model ...
Epoch: 5 cost time: 6.323796510696411
Epoch: 5, Steps: 18 | Train Loss: 1.874 Vali Loss: 2.916 Vali Acc: 0.167 Test Loss: 2.916 Test Acc: 0.167
Validation loss decreased (-0.126637 --> -0.166638).  Saving model ...
Epoch: 6 cost time: 6.7368385791778564
Epoch: 6, Steps: 18 | Train Loss: 1.445 Vali Loss: 2.849 Vali Acc: 0.140 Test Loss: 2.849 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.290987253189087
Epoch: 7, Steps: 18 | Train Loss: 0.984 Vali Loss: 2.732 Vali Acc: 0.190 Test Loss: 2.732 Test Acc: 0.190
Validation loss decreased (-0.166638 --> -0.189973).  Saving model ...
Epoch: 8 cost time: 7.628168344497681
Epoch: 8, Steps: 18 | Train Loss: 0.671 Vali Loss: 2.631 Vali Acc: 0.217 Test Loss: 2.631 Test Acc: 0.217
Validation loss decreased (-0.189973 --> -0.216640).  Saving model ...
Epoch: 9 cost time: 7.717110872268677
Epoch: 9, Steps: 18 | Train Loss: 0.405 Vali Loss: 2.434 Vali Acc: 0.243 Test Loss: 2.434 Test Acc: 0.243
Validation loss decreased (-0.216640 --> -0.243309).  Saving model ...
Epoch: 10 cost time: 7.5377583503723145
Epoch: 10, Steps: 18 | Train Loss: 0.216 Vali Loss: 2.313 Vali Acc: 0.320 Test Loss: 2.313 Test Acc: 0.320
Validation loss decreased (-0.243309 --> -0.319977).  Saving model ...
Epoch: 11 cost time: 7.366605520248413
Epoch: 11, Steps: 18 | Train Loss: 0.115 Vali Loss: 2.144 Vali Acc: 0.370 Test Loss: 2.144 Test Acc: 0.370
Validation loss decreased (-0.319977 --> -0.369979).  Saving model ...
Epoch: 12 cost time: 6.941106081008911
Epoch: 12, Steps: 18 | Train Loss: 0.066 Vali Loss: 2.064 Vali Acc: 0.357 Test Loss: 2.064 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.883457660675049
Epoch: 13, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.939 Vali Acc: 0.410 Test Loss: 1.939 Test Acc: 0.410
Validation loss decreased (-0.369979 --> -0.409981).  Saving model ...
Epoch: 14 cost time: 7.037921190261841
Epoch: 14, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.902 Vali Acc: 0.403 Test Loss: 1.902 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.677645683288574
Epoch: 15, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.880 Vali Acc: 0.410 Test Loss: 1.880 Test Acc: 0.410
Validation loss decreased (-0.409981 --> -0.409981).  Saving model ...
Epoch: 16 cost time: 7.219705820083618
Epoch: 16, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.842 Vali Acc: 0.433 Test Loss: 1.842 Test Acc: 0.433
Validation loss decreased (-0.409981 --> -0.433315).  Saving model ...
Epoch: 17 cost time: 6.957486391067505
Epoch: 17, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.790 Vali Acc: 0.443 Test Loss: 1.790 Test Acc: 0.443
Validation loss decreased (-0.433315 --> -0.443315).  Saving model ...
Epoch: 18 cost time: 7.474971055984497
Epoch: 18, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.778 Vali Acc: 0.440 Test Loss: 1.778 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.736979007720947
Epoch: 19, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.775 Vali Acc: 0.447 Test Loss: 1.775 Test Acc: 0.447
Validation loss decreased (-0.443315 --> -0.446649).  Saving model ...
Epoch: 20 cost time: 7.76304817199707
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.723 Vali Acc: 0.457 Test Loss: 1.723 Test Acc: 0.457
Validation loss decreased (-0.446649 --> -0.456649).  Saving model ...
Epoch: 21 cost time: 7.740313529968262
Epoch: 21, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.704 Vali Acc: 0.470 Test Loss: 1.704 Test Acc: 0.470
Validation loss decreased (-0.456649 --> -0.469983).  Saving model ...
Epoch: 22 cost time: 7.874334096908569
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.705 Vali Acc: 0.483 Test Loss: 1.705 Test Acc: 0.483
Validation loss decreased (-0.469983 --> -0.483316).  Saving model ...
Epoch: 23 cost time: 7.59577202796936
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.698 Vali Acc: 0.467 Test Loss: 1.698 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.719407796859741
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.679 Vali Acc: 0.487 Test Loss: 1.679 Test Acc: 0.487
Validation loss decreased (-0.483316 --> -0.486650).  Saving model ...
Epoch: 25 cost time: 6.867479085922241
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.662 Vali Acc: 0.487 Test Loss: 1.662 Test Acc: 0.487
Validation loss decreased (-0.486650 --> -0.486650).  Saving model ...
Epoch: 26 cost time: 7.585413694381714
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.640 Vali Acc: 0.497 Test Loss: 1.640 Test Acc: 0.497
Validation loss decreased (-0.486650 --> -0.496650).  Saving model ...
Epoch: 27 cost time: 7.442972421646118
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.636 Vali Acc: 0.500 Test Loss: 1.636 Test Acc: 0.500
Validation loss decreased (-0.496650 --> -0.499984).  Saving model ...
Epoch: 28 cost time: 7.7802886962890625
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.623 Vali Acc: 0.507 Test Loss: 1.623 Test Acc: 0.507
Validation loss decreased (-0.499984 --> -0.506650).  Saving model ...
Epoch: 29 cost time: 8.350508689880371
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.617 Vali Acc: 0.513 Test Loss: 1.617 Test Acc: 0.513
Validation loss decreased (-0.506650 --> -0.513317).  Saving model ...
Epoch: 30 cost time: 7.408906698226929
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.608 Vali Acc: 0.510 Test Loss: 1.608 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.94125509262085
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.599 Vali Acc: 0.513 Test Loss: 1.599 Test Acc: 0.513
Validation loss decreased (-0.513317 --> -0.513317).  Saving model ...
Epoch: 32 cost time: 7.667684078216553
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.586 Vali Acc: 0.523 Test Loss: 1.586 Test Acc: 0.523
Validation loss decreased (-0.513317 --> -0.523317).  Saving model ...
Epoch: 33 cost time: 7.703231334686279
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.576 Vali Acc: 0.533 Test Loss: 1.576 Test Acc: 0.533
Validation loss decreased (-0.523317 --> -0.533318).  Saving model ...
Epoch: 34 cost time: 8.264207601547241
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.569 Vali Acc: 0.533 Test Loss: 1.569 Test Acc: 0.533
Validation loss decreased (-0.533318 --> -0.533318).  Saving model ...
Epoch: 35 cost time: 7.66536021232605
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.567 Vali Acc: 0.530 Test Loss: 1.567 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 7.469799757003784
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.568 Vali Acc: 0.523 Test Loss: 1.568 Test Acc: 0.523
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 7.528121709823608
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.554 Vali Acc: 0.537 Test Loss: 1.554 Test Acc: 0.537
Validation loss decreased (-0.533318 --> -0.536651).  Saving model ...
Epoch: 38 cost time: 7.243696689605713
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.553 Vali Acc: 0.537 Test Loss: 1.553 Test Acc: 0.537
Validation loss decreased (-0.536651 --> -0.536651).  Saving model ...
Epoch: 39 cost time: 7.65090012550354
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.548 Vali Acc: 0.543 Test Loss: 1.548 Test Acc: 0.543
Validation loss decreased (-0.536651 --> -0.543318).  Saving model ...
Epoch: 40 cost time: 8.63480806350708
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.543 Vali Acc: 0.550 Test Loss: 1.543 Test Acc: 0.550
Validation loss decreased (-0.543318 --> -0.549985).  Saving model ...
Epoch: 41 cost time: 8.235702514648438
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.540 Vali Acc: 0.550 Test Loss: 1.540 Test Acc: 0.550
Validation loss decreased (-0.549985 --> -0.549985).  Saving model ...
Epoch: 42 cost time: 8.435920715332031
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.534 Vali Acc: 0.553 Test Loss: 1.534 Test Acc: 0.553
Validation loss decreased (-0.549985 --> -0.553318).  Saving model ...
Epoch: 43 cost time: 6.901062726974487
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.527 Vali Acc: 0.553 Test Loss: 1.527 Test Acc: 0.553
Validation loss decreased (-0.553318 --> -0.553318).  Saving model ...
Epoch: 44 cost time: 7.300148963928223
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.507 Vali Acc: 0.560 Test Loss: 1.507 Test Acc: 0.560
Validation loss decreased (-0.553318 --> -0.559985).  Saving model ...
Epoch: 45 cost time: 7.222518444061279
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.508 Vali Acc: 0.567 Test Loss: 1.508 Test Acc: 0.567
Validation loss decreased (-0.559985 --> -0.566652).  Saving model ...
Epoch: 46 cost time: 8.063238620758057
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.501 Vali Acc: 0.577 Test Loss: 1.501 Test Acc: 0.577
Validation loss decreased (-0.566652 --> -0.576652).  Saving model ...
Epoch: 47 cost time: 7.87589955329895
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.495 Vali Acc: 0.570 Test Loss: 1.495 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 8.523425340652466
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.488 Vali Acc: 0.570 Test Loss: 1.488 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 7.7078611850738525
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.488 Vali Acc: 0.570 Test Loss: 1.488 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 7.857535362243652
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.490 Vali Acc: 0.583 Test Loss: 1.490 Test Acc: 0.583
Validation loss decreased (-0.576652 --> -0.583318).  Saving model ...
Epoch: 51 cost time: 7.283795118331909
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.492 Vali Acc: 0.583 Test Loss: 1.492 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 7.754908323287964
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.489 Vali Acc: 0.587 Test Loss: 1.489 Test Acc: 0.587
Validation loss decreased (-0.583318 --> -0.586652).  Saving model ...
Epoch: 53 cost time: 7.363651752471924
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.481 Vali Acc: 0.587 Test Loss: 1.481 Test Acc: 0.587
Validation loss decreased (-0.586652 --> -0.586652).  Saving model ...
Epoch: 54 cost time: 7.838595390319824
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.593 Test Loss: 1.477 Test Acc: 0.593
Validation loss decreased (-0.586652 --> -0.593319).  Saving model ...
Epoch: 55 cost time: 8.053359270095825
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.473 Vali Acc: 0.593 Test Loss: 1.473 Test Acc: 0.593
Validation loss decreased (-0.593319 --> -0.593319).  Saving model ...
Epoch: 56 cost time: 7.146875381469727
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.469 Vali Acc: 0.593 Test Loss: 1.469 Test Acc: 0.593
Validation loss decreased (-0.593319 --> -0.593319).  Saving model ...
Epoch: 57 cost time: 6.588251352310181
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.459 Vali Acc: 0.597 Test Loss: 1.459 Test Acc: 0.597
Validation loss decreased (-0.593319 --> -0.596652).  Saving model ...
Epoch: 58 cost time: 6.6285200119018555
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.455 Vali Acc: 0.600 Test Loss: 1.455 Test Acc: 0.600
Validation loss decreased (-0.596652 --> -0.599985).  Saving model ...
Epoch: 59 cost time: 7.035700082778931
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.455 Vali Acc: 0.603 Test Loss: 1.455 Test Acc: 0.603
Validation loss decreased (-0.599985 --> -0.603319).  Saving model ...
Epoch: 60 cost time: 7.51969575881958
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.454 Vali Acc: 0.603 Test Loss: 1.454 Test Acc: 0.603
Validation loss decreased (-0.603319 --> -0.603319).  Saving model ...
Epoch: 61 cost time: 7.546158790588379
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.453 Vali Acc: 0.607 Test Loss: 1.453 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606652).  Saving model ...
Epoch: 62 cost time: 6.8960185050964355
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.447 Vali Acc: 0.610 Test Loss: 1.447 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 63 cost time: 7.3106701374053955
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.444 Vali Acc: 0.617 Test Loss: 1.444 Test Acc: 0.617
Validation loss decreased (-0.609986 --> -0.616652).  Saving model ...
Epoch: 64 cost time: 7.515169858932495
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.441 Vali Acc: 0.610 Test Loss: 1.441 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 7.5800392627716064
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.445 Vali Acc: 0.613 Test Loss: 1.445 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 7.527846574783325
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.441 Vali Acc: 0.617 Test Loss: 1.441 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 67 cost time: 6.962204456329346
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.439 Vali Acc: 0.617 Test Loss: 1.439 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 68 cost time: 6.566473484039307
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.610 Test Loss: 1.437 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.9523985385894775
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.429 Vali Acc: 0.617 Test Loss: 1.429 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 70 cost time: 7.079796075820923
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.617 Test Loss: 1.425 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 71 cost time: 7.087002992630005
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.617 Test Loss: 1.422 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 72 cost time: 6.825922012329102
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.617 Test Loss: 1.418 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616652).  Saving model ...
Epoch: 73 cost time: 7.334246635437012
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.417 Vali Acc: 0.617 Test Loss: 1.417 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616653).  Saving model ...
Epoch: 74 cost time: 7.388658046722412
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.620 Test Loss: 1.416 Test Acc: 0.620
Validation loss decreased (-0.616653 --> -0.619986).  Saving model ...
Epoch: 75 cost time: 7.162704229354858
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.623 Test Loss: 1.415 Test Acc: 0.623
Validation loss decreased (-0.619986 --> -0.623319).  Saving model ...
Epoch: 76 cost time: 7.852147817611694
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.623 Test Loss: 1.420 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 7.59800386428833
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.421 Vali Acc: 0.637 Test Loss: 1.421 Test Acc: 0.637
Validation loss decreased (-0.623319 --> -0.636652).  Saving model ...
Epoch: 78 cost time: 7.997487783432007
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.627 Test Loss: 1.415 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 6.760963678359985
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.630 Test Loss: 1.412 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 6.561781167984009
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.630 Test Loss: 1.409 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 6.596481561660767
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.630 Test Loss: 1.410 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 7.1666059494018555
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.627 Test Loss: 1.410 Test Acc: 0.627
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 6.662166118621826
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.623 Test Loss: 1.411 Test Acc: 0.623
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 7.705154180526733
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.627 Test Loss: 1.415 Test Acc: 0.627
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 6.917158365249634
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.627 Test Loss: 1.412 Test Acc: 0.627
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 7.080222129821777
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.633 Test Loss: 1.405 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 6.978064060211182
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.633 Test Loss: 1.401 Test Acc: 0.633
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6366666666666667
model parameter : 448281
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.891221046447754
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 6.950598478317261
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.944226980209351
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.724820613861084
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 5 cost time: 6.933026075363159
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 6 cost time: 6.338782072067261
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.176124334335327
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.130692005157471
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.72212815284729
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.128962278366089
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.3197784423828125
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.787715435028076
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.12276029586792
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.315709829330444
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 15 cost time: 6.681938648223877
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 16 cost time: 6.654369592666626
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.624845743179321
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.741832733154297
Epoch: 18, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.9390950202941895
Epoch: 19, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.23966383934021
Epoch: 20, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.135000705718994
Epoch: 21, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.419667482376099
Epoch: 22, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.249337196350098
Epoch: 23, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.235576152801514
Epoch: 24, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.956191778182983
Epoch: 25, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 448281
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.830253601074219
Epoch: 1, Steps: 18 | Train Loss: 3.250 Vali Loss: 2.995 Vali Acc: 0.173 Test Loss: 2.995 Test Acc: 0.173
Validation loss decreased (inf --> -0.173303).  Saving model ...
Epoch: 2 cost time: 6.415139675140381
Epoch: 2, Steps: 18 | Train Loss: 2.754 Vali Loss: 2.372 Vali Acc: 0.633 Test Loss: 2.372 Test Acc: 0.633
Validation loss decreased (-0.173303 --> -0.633310).  Saving model ...
Epoch: 3 cost time: 6.173760175704956
Epoch: 3, Steps: 18 | Train Loss: 1.974 Vali Loss: 1.709 Vali Acc: 0.760 Test Loss: 1.709 Test Acc: 0.760
Validation loss decreased (-0.633310 --> -0.759983).  Saving model ...
Epoch: 4 cost time: 6.31551194190979
Epoch: 4, Steps: 18 | Train Loss: 1.263 Vali Loss: 1.152 Vali Acc: 0.810 Test Loss: 1.152 Test Acc: 0.810
Validation loss decreased (-0.759983 --> -0.809988).  Saving model ...
Epoch: 5 cost time: 6.660437345504761
Epoch: 5, Steps: 18 | Train Loss: 0.796 Vali Loss: 0.820 Vali Acc: 0.853 Test Loss: 0.820 Test Acc: 0.853
Validation loss decreased (-0.809988 --> -0.853325).  Saving model ...
Epoch: 6 cost time: 6.602979421615601
Epoch: 6, Steps: 18 | Train Loss: 0.398 Vali Loss: 0.629 Vali Acc: 0.857 Test Loss: 0.629 Test Acc: 0.857
Validation loss decreased (-0.853325 --> -0.856660).  Saving model ...
Epoch: 7 cost time: 6.866108655929565
Epoch: 7, Steps: 18 | Train Loss: 0.238 Vali Loss: 0.535 Vali Acc: 0.873 Test Loss: 0.535 Test Acc: 0.873
Validation loss decreased (-0.856660 --> -0.873328).  Saving model ...
Epoch: 8 cost time: 7.27970552444458
Epoch: 8, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.500 Vali Acc: 0.880 Test Loss: 0.500 Test Acc: 0.880
Validation loss decreased (-0.873328 --> -0.879995).  Saving model ...
Epoch: 9 cost time: 6.597842693328857
Epoch: 9, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.468 Vali Acc: 0.877 Test Loss: 0.468 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.673418760299683
Epoch: 10, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.455 Vali Acc: 0.883 Test Loss: 0.455 Test Acc: 0.883
Validation loss decreased (-0.879995 --> -0.883329).  Saving model ...
Epoch: 11 cost time: 6.740111589431763
Epoch: 11, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.433 Vali Acc: 0.893 Test Loss: 0.433 Test Acc: 0.893
Validation loss decreased (-0.883329 --> -0.893329).  Saving model ...
Epoch: 12 cost time: 6.982423782348633
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.421 Vali Acc: 0.890 Test Loss: 0.421 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.05490255355835
Epoch: 13, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.418 Vali Acc: 0.890 Test Loss: 0.418 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.518887519836426
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.410 Vali Acc: 0.893 Test Loss: 0.410 Test Acc: 0.893
Validation loss decreased (-0.893329 --> -0.893329).  Saving model ...
Epoch: 15 cost time: 6.498203754425049
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.401 Vali Acc: 0.887 Test Loss: 0.401 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.469738483428955
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.395 Vali Acc: 0.893 Test Loss: 0.395 Test Acc: 0.893
Validation loss decreased (-0.893329 --> -0.893329).  Saving model ...
Epoch: 17 cost time: 6.381393671035767
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.397 Vali Acc: 0.893 Test Loss: 0.397 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.271014928817749
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.396 Vali Acc: 0.897 Test Loss: 0.396 Test Acc: 0.897
Validation loss decreased (-0.893329 --> -0.896663).  Saving model ...
Epoch: 19 cost time: 7.108820915222168
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.393 Vali Acc: 0.893 Test Loss: 0.393 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.598083734512329
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.394 Vali Acc: 0.890 Test Loss: 0.394 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.642955303192139
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.389 Vali Acc: 0.890 Test Loss: 0.389 Test Acc: 0.890
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.01340389251709
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.386 Vali Acc: 0.890 Test Loss: 0.386 Test Acc: 0.890
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.304359197616577
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.384 Vali Acc: 0.890 Test Loss: 0.384 Test Acc: 0.890
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.169458389282227
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.378 Vali Acc: 0.897 Test Loss: 0.378 Test Acc: 0.897
Validation loss decreased (-0.896663 --> -0.896663).  Saving model ...
Epoch: 25 cost time: 6.909518718719482
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.379 Vali Acc: 0.893 Test Loss: 0.379 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.894339084625244
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
Validation loss decreased (-0.896663 --> -0.903330).  Saving model ...
Epoch: 27 cost time: 7.012377500534058
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.377 Vali Acc: 0.897 Test Loss: 0.377 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.649723768234253
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.381 Vali Acc: 0.897 Test Loss: 0.381 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.535066366195679
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.379 Vali Acc: 0.890 Test Loss: 0.379 Test Acc: 0.890
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.0670576095581055
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.376 Vali Acc: 0.893 Test Loss: 0.376 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.755720376968384
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.376 Vali Acc: 0.897 Test Loss: 0.376 Test Acc: 0.897
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.158743619918823
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.06731653213501
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.465467929840088
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 6.527095556259155
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 6.14860987663269
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9033333333333333
model parameter : 551833
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.30952787399292
Epoch: 1, Steps: 18 | Train Loss: 3.247 Vali Loss: 3.055 Vali Acc: 0.153 Test Loss: 3.055 Test Acc: 0.153
Validation loss decreased (inf --> -0.153303).  Saving model ...
Epoch: 2 cost time: 7.485660076141357
Epoch: 2, Steps: 18 | Train Loss: 2.855 Vali Loss: 2.587 Vali Acc: 0.523 Test Loss: 2.587 Test Acc: 0.523
Validation loss decreased (-0.153303 --> -0.523307).  Saving model ...
Epoch: 3 cost time: 7.755814075469971
Epoch: 3, Steps: 18 | Train Loss: 2.217 Vali Loss: 2.026 Vali Acc: 0.687 Test Loss: 2.026 Test Acc: 0.687
Validation loss decreased (-0.523307 --> -0.686646).  Saving model ...
Epoch: 4 cost time: 6.942440509796143
Epoch: 4, Steps: 18 | Train Loss: 1.552 Vali Loss: 1.470 Vali Acc: 0.787 Test Loss: 1.470 Test Acc: 0.787
Validation loss decreased (-0.686646 --> -0.786652).  Saving model ...
Epoch: 5 cost time: 6.76194167137146
Epoch: 5, Steps: 18 | Train Loss: 1.044 Vali Loss: 1.087 Vali Acc: 0.817 Test Loss: 1.087 Test Acc: 0.817
Validation loss decreased (-0.786652 --> -0.816656).  Saving model ...
Epoch: 6 cost time: 6.699920654296875
Epoch: 6, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.854 Vali Acc: 0.827 Test Loss: 0.854 Test Acc: 0.827
Validation loss decreased (-0.816656 --> -0.826658).  Saving model ...
Epoch: 7 cost time: 6.165714502334595
Epoch: 7, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.717 Vali Acc: 0.830 Test Loss: 0.717 Test Acc: 0.830
Validation loss decreased (-0.826658 --> -0.829993).  Saving model ...
Epoch: 8 cost time: 7.277101039886475
Epoch: 8, Steps: 18 | Train Loss: 0.208 Vali Loss: 0.657 Vali Acc: 0.833 Test Loss: 0.657 Test Acc: 0.833
Validation loss decreased (-0.829993 --> -0.833327).  Saving model ...
Epoch: 9 cost time: 6.629432201385498
Epoch: 9, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.618 Vali Acc: 0.840 Test Loss: 0.618 Test Acc: 0.840
Validation loss decreased (-0.833327 --> -0.839994).  Saving model ...
Epoch: 10 cost time: 6.986056089401245
Epoch: 10, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.8920722007751465
Epoch: 11, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.565 Vali Acc: 0.853 Test Loss: 0.565 Test Acc: 0.853
Validation loss decreased (-0.839994 --> -0.853328).  Saving model ...
Epoch: 12 cost time: 6.834833145141602
Epoch: 12, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.555 Vali Acc: 0.843 Test Loss: 0.555 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.086152076721191
Epoch: 13, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.168088674545288
Epoch: 14, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.542 Vali Acc: 0.847 Test Loss: 0.542 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.994030714035034
Epoch: 15, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.631179094314575
Epoch: 16, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.266282796859741
Epoch: 17, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.525 Vali Acc: 0.853 Test Loss: 0.525 Test Acc: 0.853
Validation loss decreased (-0.853328 --> -0.853328).  Saving model ...
Epoch: 18 cost time: 6.388655662536621
Epoch: 18, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.009332180023193
Epoch: 19, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.515 Vali Acc: 0.853 Test Loss: 0.515 Test Acc: 0.853
Validation loss decreased (-0.853328 --> -0.853328).  Saving model ...
Epoch: 20 cost time: 6.7649548053741455
Epoch: 20, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.517 Vali Acc: 0.847 Test Loss: 0.517 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.52810263633728
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.926561117172241
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.516 Vali Acc: 0.843 Test Loss: 0.516 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.329091787338257
Epoch: 23, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.488575220108032
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
Validation loss decreased (-0.853328 --> -0.853328).  Saving model ...
Epoch: 25 cost time: 7.1974592208862305
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 8.142470598220825
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.504 Vali Acc: 0.857 Test Loss: 0.504 Test Acc: 0.857
Validation loss decreased (-0.853328 --> -0.856662).  Saving model ...
Epoch: 27 cost time: 7.474932909011841
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.506 Vali Acc: 0.857 Test Loss: 0.506 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 7.18374490737915
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.510 Vali Acc: 0.853 Test Loss: 0.510 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 7.321547031402588
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.510 Vali Acc: 0.847 Test Loss: 0.510 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.353100538253784
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.491077423095703
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.508 Vali Acc: 0.840 Test Loss: 0.508 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.732662916183472
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.92393159866333
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.843 Test Loss: 0.507 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 7.413294315338135
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 7.730339527130127
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 6.824979305267334
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8566666666666667
model parameter : 551833
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.753614664077759
Epoch: 1, Steps: 18 | Train Loss: 3.240 Vali Loss: 3.127 Vali Acc: 0.110 Test Loss: 3.127 Test Acc: 0.110
Validation loss decreased (inf --> -0.109969).  Saving model ...
Epoch: 2 cost time: 7.41144061088562
Epoch: 2, Steps: 18 | Train Loss: 2.964 Vali Loss: 2.812 Vali Acc: 0.353 Test Loss: 2.812 Test Acc: 0.353
Validation loss decreased (-0.109969 --> -0.353305).  Saving model ...
Epoch: 3 cost time: 7.066232204437256
Epoch: 3, Steps: 18 | Train Loss: 2.483 Vali Loss: 2.424 Vali Acc: 0.533 Test Loss: 2.424 Test Acc: 0.533
Validation loss decreased (-0.353305 --> -0.533309).  Saving model ...
Epoch: 4 cost time: 6.974790334701538
Epoch: 4, Steps: 18 | Train Loss: 1.944 Vali Loss: 1.985 Vali Acc: 0.640 Test Loss: 1.985 Test Acc: 0.640
Validation loss decreased (-0.533309 --> -0.639980).  Saving model ...
Epoch: 5 cost time: 6.412114143371582
Epoch: 5, Steps: 18 | Train Loss: 1.431 Vali Loss: 1.596 Vali Acc: 0.717 Test Loss: 1.596 Test Acc: 0.717
Validation loss decreased (-0.639980 --> -0.716651).  Saving model ...
Epoch: 6 cost time: 6.51668906211853
Epoch: 6, Steps: 18 | Train Loss: 0.915 Vali Loss: 1.311 Vali Acc: 0.733 Test Loss: 1.311 Test Acc: 0.733
Validation loss decreased (-0.716651 --> -0.733320).  Saving model ...
Epoch: 7 cost time: 6.8948283195495605
Epoch: 7, Steps: 18 | Train Loss: 0.568 Vali Loss: 1.100 Vali Acc: 0.793 Test Loss: 1.100 Test Acc: 0.793
Validation loss decreased (-0.733320 --> -0.793322).  Saving model ...
Epoch: 8 cost time: 7.676011085510254
Epoch: 8, Steps: 18 | Train Loss: 0.345 Vali Loss: 0.994 Vali Acc: 0.797 Test Loss: 0.994 Test Acc: 0.797
Validation loss decreased (-0.793322 --> -0.796657).  Saving model ...
Epoch: 9 cost time: 7.434077739715576
Epoch: 9, Steps: 18 | Train Loss: 0.185 Vali Loss: 0.918 Vali Acc: 0.787 Test Loss: 0.918 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.178322792053223
Epoch: 10, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.890 Vali Acc: 0.793 Test Loss: 0.890 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.997832775115967
Epoch: 11, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.845 Vali Acc: 0.823 Test Loss: 0.845 Test Acc: 0.823
Validation loss decreased (-0.796657 --> -0.823325).  Saving model ...
Epoch: 12 cost time: 7.37155556678772
Epoch: 12, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.831 Vali Acc: 0.813 Test Loss: 0.831 Test Acc: 0.813
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.921718120574951
Epoch: 13, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.815 Vali Acc: 0.803 Test Loss: 0.815 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.65733003616333
Epoch: 14, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.797 Vali Acc: 0.813 Test Loss: 0.797 Test Acc: 0.813
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.592698335647583
Epoch: 15, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.790 Vali Acc: 0.813 Test Loss: 0.790 Test Acc: 0.813
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.242989778518677
Epoch: 16, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.786 Vali Acc: 0.817 Test Loss: 0.786 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.275874614715576
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.784 Vali Acc: 0.803 Test Loss: 0.784 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.152272462844849
Epoch: 18, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.787 Vali Acc: 0.803 Test Loss: 0.787 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.242281913757324
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.779 Vali Acc: 0.810 Test Loss: 0.779 Test Acc: 0.810
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.043962478637695
Epoch: 20, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.781 Vali Acc: 0.820 Test Loss: 0.781 Test Acc: 0.820
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.133982419967651
Epoch: 21, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.777 Vali Acc: 0.813 Test Loss: 0.777 Test Acc: 0.813
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8233333333333334
model parameter : 551833
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.655274629592896
Epoch: 1, Steps: 18 | Train Loss: 3.259 Vali Loss: 3.193 Vali Acc: 0.087 Test Loss: 3.193 Test Acc: 0.087
Validation loss decreased (inf --> -0.086635).  Saving model ...
Epoch: 2 cost time: 6.690147638320923
Epoch: 2, Steps: 18 | Train Loss: 3.062 Vali Loss: 2.994 Vali Acc: 0.203 Test Loss: 2.994 Test Acc: 0.203
Validation loss decreased (-0.086635 --> -0.203303).  Saving model ...
Epoch: 3 cost time: 6.695235967636108
Epoch: 3, Steps: 18 | Train Loss: 2.707 Vali Loss: 2.761 Vali Acc: 0.287 Test Loss: 2.761 Test Acc: 0.287
Validation loss decreased (-0.203303 --> -0.286639).  Saving model ...
Epoch: 4 cost time: 7.043012857437134
Epoch: 4, Steps: 18 | Train Loss: 2.303 Vali Loss: 2.495 Vali Acc: 0.403 Test Loss: 2.495 Test Acc: 0.403
Validation loss decreased (-0.286639 --> -0.403308).  Saving model ...
Epoch: 5 cost time: 6.9211931228637695
Epoch: 5, Steps: 18 | Train Loss: 1.869 Vali Loss: 2.231 Vali Acc: 0.477 Test Loss: 2.231 Test Acc: 0.477
Validation loss decreased (-0.403308 --> -0.476644).  Saving model ...
Epoch: 6 cost time: 6.855034112930298
Epoch: 6, Steps: 18 | Train Loss: 1.423 Vali Loss: 2.008 Vali Acc: 0.527 Test Loss: 2.008 Test Acc: 0.527
Validation loss decreased (-0.476644 --> -0.526647).  Saving model ...
Epoch: 7 cost time: 6.764476299285889
Epoch: 7, Steps: 18 | Train Loss: 1.006 Vali Loss: 1.805 Vali Acc: 0.563 Test Loss: 1.805 Test Acc: 0.563
Validation loss decreased (-0.526647 --> -0.563315).  Saving model ...
Epoch: 8 cost time: 6.227943181991577
Epoch: 8, Steps: 18 | Train Loss: 0.638 Vali Loss: 1.639 Vali Acc: 0.590 Test Loss: 1.639 Test Acc: 0.590
Validation loss decreased (-0.563315 --> -0.589984).  Saving model ...
Epoch: 9 cost time: 6.6113340854644775
Epoch: 9, Steps: 18 | Train Loss: 0.418 Vali Loss: 1.514 Vali Acc: 0.590 Test Loss: 1.514 Test Acc: 0.590
Validation loss decreased (-0.589984 --> -0.589985).  Saving model ...
Epoch: 10 cost time: 6.806119918823242
Epoch: 10, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.428 Vali Acc: 0.607 Test Loss: 1.428 Test Acc: 0.607
Validation loss decreased (-0.589985 --> -0.606652).  Saving model ...
Epoch: 11 cost time: 7.02949857711792
Epoch: 11, Steps: 18 | Train Loss: 0.158 Vali Loss: 1.381 Vali Acc: 0.607 Test Loss: 1.381 Test Acc: 0.607
Validation loss decreased (-0.606652 --> -0.606653).  Saving model ...
Epoch: 12 cost time: 6.970077991485596
Epoch: 12, Steps: 18 | Train Loss: 0.090 Vali Loss: 1.333 Vali Acc: 0.610 Test Loss: 1.333 Test Acc: 0.610
Validation loss decreased (-0.606653 --> -0.609987).  Saving model ...
Epoch: 13 cost time: 6.921018362045288
Epoch: 13, Steps: 18 | Train Loss: 0.070 Vali Loss: 1.286 Vali Acc: 0.613 Test Loss: 1.286 Test Acc: 0.613
Validation loss decreased (-0.609987 --> -0.613320).  Saving model ...
Epoch: 14 cost time: 6.675494909286499
Epoch: 14, Steps: 18 | Train Loss: 0.055 Vali Loss: 1.259 Vali Acc: 0.633 Test Loss: 1.259 Test Acc: 0.633
Validation loss decreased (-0.613320 --> -0.633321).  Saving model ...
Epoch: 15 cost time: 6.972471714019775
Epoch: 15, Steps: 18 | Train Loss: 0.044 Vali Loss: 1.253 Vali Acc: 0.610 Test Loss: 1.253 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.2224884033203125
Epoch: 16, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.248 Vali Acc: 0.610 Test Loss: 1.248 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.6396543979644775
Epoch: 17, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.225 Vali Acc: 0.637 Test Loss: 1.225 Test Acc: 0.637
Validation loss decreased (-0.633321 --> -0.636654).  Saving model ...
Epoch: 18 cost time: 6.6469762325286865
Epoch: 18, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.213 Vali Acc: 0.643 Test Loss: 1.213 Test Acc: 0.643
Validation loss decreased (-0.636654 --> -0.643321).  Saving model ...
Epoch: 19 cost time: 6.574088096618652
Epoch: 19, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.198 Vali Acc: 0.637 Test Loss: 1.198 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.563507556915283
Epoch: 20, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.196 Vali Acc: 0.630 Test Loss: 1.196 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.430601596832275
Epoch: 21, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.191 Vali Acc: 0.647 Test Loss: 1.191 Test Acc: 0.647
Validation loss decreased (-0.643321 --> -0.646655).  Saving model ...
Epoch: 22 cost time: 6.208883285522461
Epoch: 22, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.176 Vali Acc: 0.640 Test Loss: 1.176 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.4702534675598145
Epoch: 23, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.176 Vali Acc: 0.647 Test Loss: 1.176 Test Acc: 0.647
Validation loss decreased (-0.646655 --> -0.646655).  Saving model ...
Epoch: 24 cost time: 6.410290718078613
Epoch: 24, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.161 Vali Acc: 0.643 Test Loss: 1.161 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.560111045837402
Epoch: 25, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.152 Vali Acc: 0.657 Test Loss: 1.152 Test Acc: 0.657
Validation loss decreased (-0.646655 --> -0.656655).  Saving model ...
Epoch: 26 cost time: 6.508666038513184
Epoch: 26, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.145 Vali Acc: 0.657 Test Loss: 1.145 Test Acc: 0.657
Validation loss decreased (-0.656655 --> -0.656655).  Saving model ...
Epoch: 27 cost time: 6.770920991897583
Epoch: 27, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.137 Vali Acc: 0.660 Test Loss: 1.137 Test Acc: 0.660
Validation loss decreased (-0.656655 --> -0.659989).  Saving model ...
Epoch: 28 cost time: 6.410309314727783
Epoch: 28, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.157 Vali Acc: 0.657 Test Loss: 1.157 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.540562152862549
Epoch: 29, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.149 Vali Acc: 0.660 Test Loss: 1.149 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.5100555419921875
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.138 Vali Acc: 0.670 Test Loss: 1.138 Test Acc: 0.670
Validation loss decreased (-0.659989 --> -0.669989).  Saving model ...
Epoch: 31 cost time: 6.686154127120972
Epoch: 31, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.127 Vali Acc: 0.667 Test Loss: 1.127 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.33597469329834
Epoch: 32, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.120 Vali Acc: 0.660 Test Loss: 1.120 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.404519557952881
Epoch: 33, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.121 Vali Acc: 0.670 Test Loss: 1.121 Test Acc: 0.670
Validation loss decreased (-0.669989 --> -0.669989).  Saving model ...
Epoch: 34 cost time: 6.016012907028198
Epoch: 34, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.121 Vali Acc: 0.673 Test Loss: 1.121 Test Acc: 0.673
Validation loss decreased (-0.669989 --> -0.673322).  Saving model ...
Epoch: 35 cost time: 6.485675096511841
Epoch: 35, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.115 Vali Acc: 0.670 Test Loss: 1.115 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.486709356307983
Epoch: 36, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.115 Vali Acc: 0.670 Test Loss: 1.115 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 6.86386251449585
Epoch: 37, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.101 Vali Acc: 0.670 Test Loss: 1.101 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 6.694515705108643
Epoch: 38, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.100 Vali Acc: 0.670 Test Loss: 1.100 Test Acc: 0.670
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 6.89348292350769
Epoch: 39, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.142 Vali Acc: 0.653 Test Loss: 1.142 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 7.298434019088745
Epoch: 40, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.107 Vali Acc: 0.683 Test Loss: 1.107 Test Acc: 0.683
Validation loss decreased (-0.673322 --> -0.683322).  Saving model ...
Epoch: 41 cost time: 7.056490182876587
Epoch: 41, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.102 Vali Acc: 0.680 Test Loss: 1.102 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.38062596321106
Epoch: 42, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.097 Vali Acc: 0.687 Test Loss: 1.097 Test Acc: 0.687
Validation loss decreased (-0.683322 --> -0.686656).  Saving model ...
Epoch: 43 cost time: 6.757767677307129
Epoch: 43, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.096 Vali Acc: 0.677 Test Loss: 1.096 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.793830871582031
Epoch: 44, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.096 Vali Acc: 0.673 Test Loss: 1.096 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 6.4172492027282715
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.100 Vali Acc: 0.680 Test Loss: 1.100 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 6.70718789100647
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.100 Vali Acc: 0.680 Test Loss: 1.100 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 5.982742071151733
Epoch: 47, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.098 Vali Acc: 0.680 Test Loss: 1.098 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 6.430771112442017
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.097 Vali Acc: 0.680 Test Loss: 1.097 Test Acc: 0.680
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 5.8987414836883545
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.089 Vali Acc: 0.687 Test Loss: 1.089 Test Acc: 0.687
Validation loss decreased (-0.686656 --> -0.686656).  Saving model ...
Epoch: 50 cost time: 6.234718084335327
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.086 Vali Acc: 0.687 Test Loss: 1.086 Test Acc: 0.687
Validation loss decreased (-0.686656 --> -0.686656).  Saving model ...
Epoch: 51 cost time: 6.459838628768921
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.087 Vali Acc: 0.687 Test Loss: 1.087 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.373822212219238
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.089 Vali Acc: 0.683 Test Loss: 1.089 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.630089521408081
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.093 Vali Acc: 0.680 Test Loss: 1.093 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 6.864675521850586
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.087 Vali Acc: 0.683 Test Loss: 1.087 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 6.471005201339722
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.077 Vali Acc: 0.693 Test Loss: 1.077 Test Acc: 0.693
Validation loss decreased (-0.686656 --> -0.693323).  Saving model ...
Epoch: 56 cost time: 6.094834089279175
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.080 Vali Acc: 0.687 Test Loss: 1.080 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.250520944595337
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.084 Vali Acc: 0.687 Test Loss: 1.084 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 7.082198858261108
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.083 Vali Acc: 0.687 Test Loss: 1.083 Test Acc: 0.687
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 6.5669355392456055
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.085 Vali Acc: 0.690 Test Loss: 1.085 Test Acc: 0.690
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 6.743782043457031
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.082 Vali Acc: 0.687 Test Loss: 1.082 Test Acc: 0.687
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 6.716795444488525
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.084 Vali Acc: 0.687 Test Loss: 1.084 Test Acc: 0.687
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 5.927222967147827
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.081 Vali Acc: 0.690 Test Loss: 1.081 Test Acc: 0.690
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 6.47198748588562
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.693 Test Loss: 1.075 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 64 cost time: 6.376006841659546
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.072 Vali Acc: 0.693 Test Loss: 1.072 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 65 cost time: 7.029460906982422
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.690 Test Loss: 1.075 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 7.256814956665039
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.078 Vali Acc: 0.700 Test Loss: 1.078 Test Acc: 0.700
Validation loss decreased (-0.693323 --> -0.699989).  Saving model ...
Epoch: 67 cost time: 7.033797740936279
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.697 Test Loss: 1.079 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 6.84859037399292
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.081 Vali Acc: 0.693 Test Loss: 1.081 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 7.00081205368042
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.081 Vali Acc: 0.687 Test Loss: 1.081 Test Acc: 0.687
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 6.769075870513916
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.081 Vali Acc: 0.683 Test Loss: 1.081 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 5.971282243728638
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.080 Vali Acc: 0.687 Test Loss: 1.080 Test Acc: 0.687
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 6.446040630340576
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.687 Test Loss: 1.079 Test Acc: 0.687
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 6.2378435134887695
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.690 Test Loss: 1.079 Test Acc: 0.690
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 6.595654249191284
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.076 Vali Acc: 0.683 Test Loss: 1.076 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 6.375820636749268
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.078 Vali Acc: 0.680 Test Loss: 1.078 Test Acc: 0.680
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 6.566239833831787
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.078 Vali Acc: 0.690 Test Loss: 1.078 Test Acc: 0.690
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7
model parameter : 551833
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.791476249694824
Epoch: 1, Steps: 18 | Train Loss: 3.271 Vali Loss: 3.210 Vali Acc: 0.077 Test Loss: 3.210 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 6.9317498207092285
Epoch: 2, Steps: 18 | Train Loss: 3.114 Vali Loss: 3.083 Vali Acc: 0.133 Test Loss: 3.083 Test Acc: 0.133
Validation loss decreased (-0.076635 --> -0.133303).  Saving model ...
Epoch: 3 cost time: 7.016158103942871
Epoch: 3, Steps: 18 | Train Loss: 2.814 Vali Loss: 2.936 Vali Acc: 0.180 Test Loss: 2.936 Test Acc: 0.180
Validation loss decreased (-0.133303 --> -0.179971).  Saving model ...
Epoch: 4 cost time: 6.8026838302612305
Epoch: 4, Steps: 18 | Train Loss: 2.487 Vali Loss: 2.760 Vali Acc: 0.257 Test Loss: 2.760 Test Acc: 0.257
Validation loss decreased (-0.179971 --> -0.256639).  Saving model ...
Epoch: 5 cost time: 6.45225191116333
Epoch: 5, Steps: 18 | Train Loss: 2.152 Vali Loss: 2.593 Vali Acc: 0.317 Test Loss: 2.593 Test Acc: 0.317
Validation loss decreased (-0.256639 --> -0.316641).  Saving model ...
Epoch: 6 cost time: 6.2486841678619385
Epoch: 6, Steps: 18 | Train Loss: 1.744 Vali Loss: 2.441 Vali Acc: 0.357 Test Loss: 2.441 Test Acc: 0.357
Validation loss decreased (-0.316641 --> -0.356642).  Saving model ...
Epoch: 7 cost time: 6.292038679122925
Epoch: 7, Steps: 18 | Train Loss: 1.360 Vali Loss: 2.295 Vali Acc: 0.390 Test Loss: 2.295 Test Acc: 0.390
Validation loss decreased (-0.356642 --> -0.389977).  Saving model ...
Epoch: 8 cost time: 6.652985334396362
Epoch: 8, Steps: 18 | Train Loss: 0.976 Vali Loss: 2.186 Vali Acc: 0.367 Test Loss: 2.186 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.8361217975616455
Epoch: 9, Steps: 18 | Train Loss: 0.702 Vali Loss: 2.077 Vali Acc: 0.423 Test Loss: 2.077 Test Acc: 0.423
Validation loss decreased (-0.389977 --> -0.423313).  Saving model ...
Epoch: 10 cost time: 6.5384321212768555
Epoch: 10, Steps: 18 | Train Loss: 0.437 Vali Loss: 2.005 Vali Acc: 0.413 Test Loss: 2.005 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.860195636749268
Epoch: 11, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.935 Vali Acc: 0.443 Test Loss: 1.935 Test Acc: 0.443
Validation loss decreased (-0.423313 --> -0.443314).  Saving model ...
Epoch: 12 cost time: 6.493840456008911
Epoch: 12, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.877 Vali Acc: 0.440 Test Loss: 1.877 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.202579021453857
Epoch: 13, Steps: 18 | Train Loss: 0.121 Vali Loss: 1.817 Vali Acc: 0.470 Test Loss: 1.817 Test Acc: 0.470
Validation loss decreased (-0.443314 --> -0.469982).  Saving model ...
Epoch: 14 cost time: 6.677671670913696
Epoch: 14, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.792 Vali Acc: 0.483 Test Loss: 1.792 Test Acc: 0.483
Validation loss decreased (-0.469982 --> -0.483315).  Saving model ...
Epoch: 15 cost time: 6.529914140701294
Epoch: 15, Steps: 18 | Train Loss: 0.065 Vali Loss: 1.736 Vali Acc: 0.497 Test Loss: 1.736 Test Acc: 0.497
Validation loss decreased (-0.483315 --> -0.496649).  Saving model ...
Epoch: 16 cost time: 6.748858213424683
Epoch: 16, Steps: 18 | Train Loss: 0.053 Vali Loss: 1.705 Vali Acc: 0.493 Test Loss: 1.705 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.612668037414551
Epoch: 17, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.671 Vali Acc: 0.517 Test Loss: 1.671 Test Acc: 0.517
Validation loss decreased (-0.496649 --> -0.516650).  Saving model ...
Epoch: 18 cost time: 6.941139459609985
Epoch: 18, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.656 Vali Acc: 0.493 Test Loss: 1.656 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.398224115371704
Epoch: 19, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.643 Vali Acc: 0.517 Test Loss: 1.643 Test Acc: 0.517
Validation loss decreased (-0.516650 --> -0.516650).  Saving model ...
Epoch: 20 cost time: 6.198145389556885
Epoch: 20, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.629 Vali Acc: 0.517 Test Loss: 1.629 Test Acc: 0.517
Validation loss decreased (-0.516650 --> -0.516650).  Saving model ...
Epoch: 21 cost time: 6.300859689712524
Epoch: 21, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.613 Vali Acc: 0.527 Test Loss: 1.613 Test Acc: 0.527
Validation loss decreased (-0.516650 --> -0.526651).  Saving model ...
Epoch: 22 cost time: 5.9672441482543945
Epoch: 22, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.590 Vali Acc: 0.523 Test Loss: 1.590 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.206888437271118
Epoch: 23, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.581 Vali Acc: 0.540 Test Loss: 1.581 Test Acc: 0.540
Validation loss decreased (-0.526651 --> -0.539984).  Saving model ...
Epoch: 24 cost time: 6.548938274383545
Epoch: 24, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.557 Vali Acc: 0.550 Test Loss: 1.557 Test Acc: 0.550
Validation loss decreased (-0.539984 --> -0.549984).  Saving model ...
Epoch: 25 cost time: 6.776038408279419
Epoch: 25, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.551 Vali Acc: 0.533 Test Loss: 1.551 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.4489970207214355
Epoch: 26, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.549 Vali Acc: 0.527 Test Loss: 1.549 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.980207681655884
Epoch: 27, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.530 Vali Acc: 0.553 Test Loss: 1.530 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553318).  Saving model ...
Epoch: 28 cost time: 6.153551816940308
Epoch: 28, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.522 Vali Acc: 0.537 Test Loss: 1.522 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.645055770874023
Epoch: 29, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.521 Vali Acc: 0.557 Test Loss: 1.521 Test Acc: 0.557
Validation loss decreased (-0.553318 --> -0.556651).  Saving model ...
Epoch: 30 cost time: 7.176140785217285
Epoch: 30, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.525 Vali Acc: 0.553 Test Loss: 1.525 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.754971027374268
Epoch: 31, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.512 Vali Acc: 0.567 Test Loss: 1.512 Test Acc: 0.567
Validation loss decreased (-0.556651 --> -0.566652).  Saving model ...
Epoch: 32 cost time: 6.625157117843628
Epoch: 32, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.506 Vali Acc: 0.557 Test Loss: 1.506 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.988444566726685
Epoch: 33, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.499 Vali Acc: 0.567 Test Loss: 1.499 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566652).  Saving model ...
Epoch: 34 cost time: 6.177865505218506
Epoch: 34, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.490 Vali Acc: 0.567 Test Loss: 1.490 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566652).  Saving model ...
Epoch: 35 cost time: 6.218516826629639
Epoch: 35, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.485 Vali Acc: 0.577 Test Loss: 1.485 Test Acc: 0.577
Validation loss decreased (-0.566652 --> -0.576652).  Saving model ...
Epoch: 36 cost time: 6.928926229476929
Epoch: 36, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.488 Vali Acc: 0.577 Test Loss: 1.488 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.963656663894653
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.487 Vali Acc: 0.573 Test Loss: 1.487 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 7.235208988189697
Epoch: 38, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.480 Vali Acc: 0.567 Test Loss: 1.480 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 7.582149267196655
Epoch: 39, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.483 Vali Acc: 0.570 Test Loss: 1.483 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 6.8424482345581055
Epoch: 40, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.484 Vali Acc: 0.573 Test Loss: 1.484 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 6.737035274505615
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.473 Vali Acc: 0.577 Test Loss: 1.473 Test Acc: 0.577
Validation loss decreased (-0.576652 --> -0.576652).  Saving model ...
Epoch: 42 cost time: 6.636526584625244
Epoch: 42, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.461 Vali Acc: 0.580 Test Loss: 1.461 Test Acc: 0.580
Validation loss decreased (-0.576652 --> -0.579985).  Saving model ...
Epoch: 43 cost time: 6.538151741027832
Epoch: 43, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.454 Vali Acc: 0.580 Test Loss: 1.454 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 44 cost time: 6.3877763748168945
Epoch: 44, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.451 Vali Acc: 0.583 Test Loss: 1.451 Test Acc: 0.583
Validation loss decreased (-0.579985 --> -0.583319).  Saving model ...
Epoch: 45 cost time: 6.647575855255127
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.462 Vali Acc: 0.577 Test Loss: 1.462 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.6688618659973145
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.459 Vali Acc: 0.580 Test Loss: 1.459 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 6.174979209899902
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.454 Vali Acc: 0.583 Test Loss: 1.454 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 6.624894142150879
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.454 Vali Acc: 0.587 Test Loss: 1.454 Test Acc: 0.587
Validation loss decreased (-0.583319 --> -0.586652).  Saving model ...
Epoch: 49 cost time: 6.7035744190216064
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.450 Vali Acc: 0.590 Test Loss: 1.450 Test Acc: 0.590
Validation loss decreased (-0.586652 --> -0.589986).  Saving model ...
Epoch: 50 cost time: 6.833980560302734
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.440 Vali Acc: 0.590 Test Loss: 1.440 Test Acc: 0.590
Validation loss decreased (-0.589986 --> -0.589986).  Saving model ...
Epoch: 51 cost time: 7.079381704330444
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.442 Vali Acc: 0.593 Test Loss: 1.442 Test Acc: 0.593
Validation loss decreased (-0.589986 --> -0.593319).  Saving model ...
Epoch: 52 cost time: 7.263005018234253
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.447 Vali Acc: 0.590 Test Loss: 1.447 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 6.71564507484436
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.446 Vali Acc: 0.590 Test Loss: 1.446 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 6.494552135467529
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.443 Vali Acc: 0.593 Test Loss: 1.443 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 6.149461269378662
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.435 Vali Acc: 0.587 Test Loss: 1.435 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 6.355907201766968
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.429 Vali Acc: 0.587 Test Loss: 1.429 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 6.129417896270752
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.429 Vali Acc: 0.587 Test Loss: 1.429 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 7.0414817333221436
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.425 Vali Acc: 0.593 Test Loss: 1.425 Test Acc: 0.593
Validation loss decreased (-0.593319 --> -0.593319).  Saving model ...
Epoch: 59 cost time: 7.479757308959961
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.429 Vali Acc: 0.587 Test Loss: 1.429 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 7.543541193008423
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.434 Vali Acc: 0.590 Test Loss: 1.434 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 6.8528666496276855
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.593 Test Loss: 1.430 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 6.721630811691284
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.432 Vali Acc: 0.593 Test Loss: 1.432 Test Acc: 0.593
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 7.159672021865845
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.429 Vali Acc: 0.587 Test Loss: 1.429 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 7.317810297012329
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.424 Vali Acc: 0.593 Test Loss: 1.424 Test Acc: 0.593
Validation loss decreased (-0.593319 --> -0.593319).  Saving model ...
Epoch: 65 cost time: 7.379840135574341
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.423 Vali Acc: 0.590 Test Loss: 1.423 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 7.474654197692871
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.433 Vali Acc: 0.587 Test Loss: 1.433 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 7.076282978057861
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.436 Vali Acc: 0.593 Test Loss: 1.436 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 7.329495191574097
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.428 Vali Acc: 0.590 Test Loss: 1.428 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 7.213809251785278
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.431 Vali Acc: 0.587 Test Loss: 1.431 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 7.502273321151733
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.433 Vali Acc: 0.583 Test Loss: 1.433 Test Acc: 0.583
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 7.215389728546143
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.587 Test Loss: 1.430 Test Acc: 0.587
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 7.482070207595825
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.424 Vali Acc: 0.583 Test Loss: 1.424 Test Acc: 0.583
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 7.13829779624939
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.422 Vali Acc: 0.593 Test Loss: 1.422 Test Acc: 0.593
Validation loss decreased (-0.593319 --> -0.593319).  Saving model ...
Epoch: 74 cost time: 6.731362342834473
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.422 Vali Acc: 0.597 Test Loss: 1.422 Test Acc: 0.597
Validation loss decreased (-0.593319 --> -0.596652).  Saving model ...
Epoch: 75 cost time: 6.68518328666687
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.414 Vali Acc: 0.600 Test Loss: 1.414 Test Acc: 0.600
Validation loss decreased (-0.596652 --> -0.599986).  Saving model ...
Epoch: 76 cost time: 7.405590295791626
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.413 Vali Acc: 0.593 Test Loss: 1.413 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 7.243630409240723
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.418 Vali Acc: 0.597 Test Loss: 1.418 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 6.810060262680054
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.600 Test Loss: 1.419 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 6.922096252441406
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.600 Test Loss: 1.419 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 6.770843029022217
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.600 Test Loss: 1.419 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 6.269631862640381
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.418 Vali Acc: 0.597 Test Loss: 1.418 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 7.2802650928497314
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.415 Vali Acc: 0.597 Test Loss: 1.415 Test Acc: 0.597
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 7.2025275230407715
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.415 Vali Acc: 0.597 Test Loss: 1.415 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 7.119329452514648
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.415 Vali Acc: 0.597 Test Loss: 1.415 Test Acc: 0.597
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 6.53633975982666
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.423 Vali Acc: 0.583 Test Loss: 1.423 Test Acc: 0.583
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6
model parameter : 551833
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.512706518173218
Epoch: 1, Steps: 18 | Train Loss: 3.303 Vali Loss: 3.257 Vali Acc: 0.043 Test Loss: 3.257 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 6.118878602981567
Epoch: 2, Steps: 18 | Train Loss: 3.148 Vali Loss: 3.156 Vali Acc: 0.077 Test Loss: 3.156 Test Acc: 0.077
Validation loss decreased (-0.043301 --> -0.076635).  Saving model ...
Epoch: 3 cost time: 5.65442681312561
Epoch: 3, Steps: 18 | Train Loss: 2.886 Vali Loss: 3.053 Vali Acc: 0.133 Test Loss: 3.053 Test Acc: 0.133
Validation loss decreased (-0.076635 --> -0.133303).  Saving model ...
Epoch: 4 cost time: 6.551009178161621
Epoch: 4, Steps: 18 | Train Loss: 2.598 Vali Loss: 2.942 Vali Acc: 0.190 Test Loss: 2.942 Test Acc: 0.190
Validation loss decreased (-0.133303 --> -0.189971).  Saving model ...
Epoch: 5 cost time: 6.070456266403198
Epoch: 5, Steps: 18 | Train Loss: 2.282 Vali Loss: 2.841 Vali Acc: 0.227 Test Loss: 2.841 Test Acc: 0.227
Validation loss decreased (-0.189971 --> -0.226638).  Saving model ...
Epoch: 6 cost time: 5.899490118026733
Epoch: 6, Steps: 18 | Train Loss: 1.920 Vali Loss: 2.748 Vali Acc: 0.273 Test Loss: 2.748 Test Acc: 0.273
Validation loss decreased (-0.226638 --> -0.273306).  Saving model ...
Epoch: 7 cost time: 5.936622619628906
Epoch: 7, Steps: 18 | Train Loss: 1.550 Vali Loss: 2.658 Vali Acc: 0.297 Test Loss: 2.658 Test Acc: 0.297
Validation loss decreased (-0.273306 --> -0.296640).  Saving model ...
Epoch: 8 cost time: 6.264089822769165
Epoch: 8, Steps: 18 | Train Loss: 1.170 Vali Loss: 2.562 Vali Acc: 0.303 Test Loss: 2.562 Test Acc: 0.303
Validation loss decreased (-0.296640 --> -0.303308).  Saving model ...
Epoch: 9 cost time: 6.776921272277832
Epoch: 9, Steps: 18 | Train Loss: 0.891 Vali Loss: 2.488 Vali Acc: 0.310 Test Loss: 2.488 Test Acc: 0.310
Validation loss decreased (-0.303308 --> -0.309975).  Saving model ...
Epoch: 10 cost time: 5.772982120513916
Epoch: 10, Steps: 18 | Train Loss: 0.601 Vali Loss: 2.405 Vali Acc: 0.337 Test Loss: 2.405 Test Acc: 0.337
Validation loss decreased (-0.309975 --> -0.336643).  Saving model ...
Epoch: 11 cost time: 5.905245065689087
Epoch: 11, Steps: 18 | Train Loss: 0.413 Vali Loss: 2.376 Vali Acc: 0.330 Test Loss: 2.376 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.685293912887573
Epoch: 12, Steps: 18 | Train Loss: 0.258 Vali Loss: 2.330 Vali Acc: 0.333 Test Loss: 2.330 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.997868299484253
Epoch: 13, Steps: 18 | Train Loss: 0.173 Vali Loss: 2.294 Vali Acc: 0.347 Test Loss: 2.294 Test Acc: 0.347
Validation loss decreased (-0.336643 --> -0.346644).  Saving model ...
Epoch: 14 cost time: 6.070399045944214
Epoch: 14, Steps: 18 | Train Loss: 0.120 Vali Loss: 2.250 Vali Acc: 0.373 Test Loss: 2.250 Test Acc: 0.373
Validation loss decreased (-0.346644 --> -0.373311).  Saving model ...
Epoch: 15 cost time: 7.101247310638428
Epoch: 15, Steps: 18 | Train Loss: 0.089 Vali Loss: 2.211 Vali Acc: 0.377 Test Loss: 2.211 Test Acc: 0.377
Validation loss decreased (-0.373311 --> -0.376645).  Saving model ...
Epoch: 16 cost time: 6.761617183685303
Epoch: 16, Steps: 18 | Train Loss: 0.064 Vali Loss: 2.177 Vali Acc: 0.403 Test Loss: 2.177 Test Acc: 0.403
Validation loss decreased (-0.376645 --> -0.403312).  Saving model ...
Epoch: 17 cost time: 6.115746736526489
Epoch: 17, Steps: 18 | Train Loss: 0.054 Vali Loss: 2.137 Vali Acc: 0.390 Test Loss: 2.137 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.438045501708984
Epoch: 18, Steps: 18 | Train Loss: 0.041 Vali Loss: 2.142 Vali Acc: 0.390 Test Loss: 2.142 Test Acc: 0.390
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.379980087280273
Epoch: 19, Steps: 18 | Train Loss: 0.036 Vali Loss: 2.119 Vali Acc: 0.397 Test Loss: 2.119 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.095685720443726
Epoch: 20, Steps: 18 | Train Loss: 0.031 Vali Loss: 2.107 Vali Acc: 0.410 Test Loss: 2.107 Test Acc: 0.410
Validation loss decreased (-0.403312 --> -0.409979).  Saving model ...
Epoch: 21 cost time: 6.800849914550781
Epoch: 21, Steps: 18 | Train Loss: 0.025 Vali Loss: 2.103 Vali Acc: 0.410 Test Loss: 2.103 Test Acc: 0.410
Validation loss decreased (-0.409979 --> -0.409979).  Saving model ...
Epoch: 22 cost time: 5.716232061386108
Epoch: 22, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.077 Vali Acc: 0.427 Test Loss: 2.077 Test Acc: 0.427
Validation loss decreased (-0.409979 --> -0.426646).  Saving model ...
Epoch: 23 cost time: 6.402735233306885
Epoch: 23, Steps: 18 | Train Loss: 0.020 Vali Loss: 2.076 Vali Acc: 0.410 Test Loss: 2.076 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.899685621261597
Epoch: 24, Steps: 18 | Train Loss: 0.018 Vali Loss: 2.050 Vali Acc: 0.423 Test Loss: 2.050 Test Acc: 0.423
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.851314067840576
Epoch: 25, Steps: 18 | Train Loss: 0.015 Vali Loss: 2.024 Vali Acc: 0.443 Test Loss: 2.024 Test Acc: 0.443
Validation loss decreased (-0.426646 --> -0.443313).  Saving model ...
Epoch: 26 cost time: 7.139867544174194
Epoch: 26, Steps: 18 | Train Loss: 0.014 Vali Loss: 2.011 Vali Acc: 0.453 Test Loss: 2.011 Test Acc: 0.453
Validation loss decreased (-0.443313 --> -0.453313).  Saving model ...
Epoch: 27 cost time: 6.43680214881897
Epoch: 27, Steps: 18 | Train Loss: 0.013 Vali Loss: 2.014 Vali Acc: 0.453 Test Loss: 2.014 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.619931936264038
Epoch: 28, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.006 Vali Acc: 0.440 Test Loss: 2.006 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.559307813644409
Epoch: 29, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.979 Vali Acc: 0.453 Test Loss: 1.979 Test Acc: 0.453
Validation loss decreased (-0.453313 --> -0.453314).  Saving model ...
Epoch: 30 cost time: 6.407735109329224
Epoch: 30, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.962 Vali Acc: 0.463 Test Loss: 1.962 Test Acc: 0.463
Validation loss decreased (-0.453314 --> -0.463314).  Saving model ...
Epoch: 31 cost time: 6.413114786148071
Epoch: 31, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.970 Vali Acc: 0.457 Test Loss: 1.970 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.488407850265503
Epoch: 32, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.964 Vali Acc: 0.463 Test Loss: 1.964 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 7.0964014530181885
Epoch: 33, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.946 Vali Acc: 0.457 Test Loss: 1.946 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 7.169142246246338
Epoch: 34, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.948 Vali Acc: 0.457 Test Loss: 1.948 Test Acc: 0.457
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 7.026299238204956
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.938 Vali Acc: 0.457 Test Loss: 1.938 Test Acc: 0.457
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 6.674759387969971
Epoch: 36, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.930 Vali Acc: 0.457 Test Loss: 1.930 Test Acc: 0.457
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 6.520339727401733
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.909 Vali Acc: 0.453 Test Loss: 1.909 Test Acc: 0.453
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 6.791515588760376
Epoch: 38, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.897 Vali Acc: 0.467 Test Loss: 1.897 Test Acc: 0.467
Validation loss decreased (-0.463314 --> -0.466648).  Saving model ...
Epoch: 39 cost time: 6.48906683921814
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.926 Vali Acc: 0.450 Test Loss: 1.926 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.91621470451355
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.901 Vali Acc: 0.467 Test Loss: 1.901 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.66706109046936
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.896 Vali Acc: 0.463 Test Loss: 1.896 Test Acc: 0.463
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 6.746185541152954
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.892 Vali Acc: 0.463 Test Loss: 1.892 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 6.653584957122803
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.872 Vali Acc: 0.470 Test Loss: 1.872 Test Acc: 0.470
Validation loss decreased (-0.466648 --> -0.469981).  Saving model ...
Epoch: 44 cost time: 6.253722429275513
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.871 Vali Acc: 0.470 Test Loss: 1.871 Test Acc: 0.470
Validation loss decreased (-0.469981 --> -0.469981).  Saving model ...
Epoch: 45 cost time: 6.455278158187866
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.870 Vali Acc: 0.473 Test Loss: 1.870 Test Acc: 0.473
Validation loss decreased (-0.469981 --> -0.473315).  Saving model ...
Epoch: 46 cost time: 6.36303973197937
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.859 Vali Acc: 0.470 Test Loss: 1.859 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.5136559009552
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.846 Vali Acc: 0.477 Test Loss: 1.846 Test Acc: 0.477
Validation loss decreased (-0.473315 --> -0.476648).  Saving model ...
Epoch: 48 cost time: 6.5879106521606445
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.846 Vali Acc: 0.467 Test Loss: 1.846 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.579523324966431
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.846 Vali Acc: 0.473 Test Loss: 1.846 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 7.034138441085815
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.840 Vali Acc: 0.473 Test Loss: 1.840 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.884065866470337
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.831 Vali Acc: 0.470 Test Loss: 1.831 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 6.414058685302734
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.824 Vali Acc: 0.487 Test Loss: 1.824 Test Acc: 0.487
Validation loss decreased (-0.476648 --> -0.486648).  Saving model ...
Epoch: 53 cost time: 6.101073503494263
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.816 Vali Acc: 0.480 Test Loss: 1.816 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.068671941757202
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.813 Vali Acc: 0.480 Test Loss: 1.813 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.702172517776489
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.819 Vali Acc: 0.480 Test Loss: 1.819 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 6.657557010650635
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.827 Vali Acc: 0.473 Test Loss: 1.827 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 6.357532501220703
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.821 Vali Acc: 0.473 Test Loss: 1.821 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 6.504288673400879
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.811 Vali Acc: 0.483 Test Loss: 1.811 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 6.5511720180511475
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.807 Vali Acc: 0.490 Test Loss: 1.807 Test Acc: 0.490
Validation loss decreased (-0.486648 --> -0.489982).  Saving model ...
Epoch: 60 cost time: 6.668066501617432
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.795 Vali Acc: 0.487 Test Loss: 1.795 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 5.827397108078003
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.788 Vali Acc: 0.497 Test Loss: 1.788 Test Acc: 0.497
Validation loss decreased (-0.489982 --> -0.496649).  Saving model ...
Epoch: 62 cost time: 5.995742559432983
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.792 Vali Acc: 0.490 Test Loss: 1.792 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 5.709796667098999
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.788 Vali Acc: 0.483 Test Loss: 1.788 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 5.8308844566345215
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.781 Vali Acc: 0.490 Test Loss: 1.781 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 5.876330852508545
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.773 Vali Acc: 0.497 Test Loss: 1.773 Test Acc: 0.497
Validation loss decreased (-0.496649 --> -0.496649).  Saving model ...
Epoch: 66 cost time: 5.805121183395386
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.769 Vali Acc: 0.503 Test Loss: 1.769 Test Acc: 0.503
Validation loss decreased (-0.496649 --> -0.503316).  Saving model ...
Epoch: 67 cost time: 5.846583843231201
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.775 Vali Acc: 0.500 Test Loss: 1.775 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 5.892110586166382
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.781 Vali Acc: 0.493 Test Loss: 1.781 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 6.414621829986572
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.490 Test Loss: 1.787 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 6.291165828704834
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.793 Vali Acc: 0.490 Test Loss: 1.793 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 6.4633872509002686
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.790 Vali Acc: 0.497 Test Loss: 1.790 Test Acc: 0.497
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 6.390197038650513
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.777 Vali Acc: 0.503 Test Loss: 1.777 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 6.532190799713135
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.769 Vali Acc: 0.500 Test Loss: 1.769 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 6.483356475830078
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.761 Vali Acc: 0.507 Test Loss: 1.761 Test Acc: 0.507
Validation loss decreased (-0.503316 --> -0.506649).  Saving model ...
Epoch: 75 cost time: 7.076982021331787
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.765 Vali Acc: 0.500 Test Loss: 1.765 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 6.316654920578003
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.771 Vali Acc: 0.500 Test Loss: 1.771 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 6.553478002548218
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.762 Vali Acc: 0.500 Test Loss: 1.762 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 6.27253794670105
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.759 Vali Acc: 0.497 Test Loss: 1.759 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 6.498379230499268
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.747 Vali Acc: 0.507 Test Loss: 1.747 Test Acc: 0.507
Validation loss decreased (-0.506649 --> -0.506649).  Saving model ...
Epoch: 80 cost time: 6.654598712921143
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.507 Test Loss: 1.749 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 6.016178846359253
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.750 Vali Acc: 0.500 Test Loss: 1.750 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 6.047017335891724
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.752 Vali Acc: 0.503 Test Loss: 1.752 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 6.300495147705078
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.751 Vali Acc: 0.503 Test Loss: 1.751 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 6.394364595413208
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.500 Test Loss: 1.749 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 6.342010974884033
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.744 Vali Acc: 0.507 Test Loss: 1.744 Test Acc: 0.507
Validation loss decreased (-0.506649 --> -0.506649).  Saving model ...
Epoch: 86 cost time: 6.292731761932373
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.740 Vali Acc: 0.513 Test Loss: 1.740 Test Acc: 0.513
Validation loss decreased (-0.506649 --> -0.513316).  Saving model ...
Epoch: 87 cost time: 6.240202903747559
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.735 Vali Acc: 0.510 Test Loss: 1.735 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 6.651995658874512
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.741 Vali Acc: 0.510 Test Loss: 1.741 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 6.086230993270874
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.740 Vali Acc: 0.510 Test Loss: 1.740 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 5.978919982910156
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.736 Vali Acc: 0.517 Test Loss: 1.736 Test Acc: 0.517
Validation loss decreased (-0.513316 --> -0.516649).  Saving model ...
Epoch: 91 cost time: 6.254648923873901
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.736 Vali Acc: 0.503 Test Loss: 1.736 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 6.705857276916504
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.730 Vali Acc: 0.513 Test Loss: 1.730 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 6.734007835388184
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.517 Test Loss: 1.734 Test Acc: 0.517
Validation loss decreased (-0.516649 --> -0.516649).  Saving model ...
Epoch: 94 cost time: 6.35029411315918
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.737 Vali Acc: 0.517 Test Loss: 1.737 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 6.091805934906006
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.736 Vali Acc: 0.513 Test Loss: 1.736 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 6.5583508014678955
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.729 Vali Acc: 0.530 Test Loss: 1.729 Test Acc: 0.530
Validation loss decreased (-0.516649 --> -0.529983).  Saving model ...
Epoch: 97 cost time: 6.861263990402222
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.523 Test Loss: 1.727 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 6.141992092132568
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.730 Vali Acc: 0.520 Test Loss: 1.730 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 6.777503967285156
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.523 Test Loss: 1.727 Test Acc: 0.523
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 6.071812152862549
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.726 Vali Acc: 0.523 Test Loss: 1.726 Test Acc: 0.523
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.53
model parameter : 551833
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.541687250137329
Epoch: 1, Steps: 18 | Train Loss: 3.291 Vali Loss: 3.245 Vali Acc: 0.043 Test Loss: 3.245 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 5.958239555358887
Epoch: 2, Steps: 18 | Train Loss: 3.127 Vali Loss: 3.197 Vali Acc: 0.063 Test Loss: 3.197 Test Acc: 0.063
Validation loss decreased (-0.043301 --> -0.063301).  Saving model ...
Epoch: 3 cost time: 6.662846326828003
Epoch: 3, Steps: 18 | Train Loss: 2.927 Vali Loss: 3.138 Vali Acc: 0.070 Test Loss: 3.138 Test Acc: 0.070
Validation loss decreased (-0.063301 --> -0.069969).  Saving model ...
Epoch: 4 cost time: 6.453886032104492
Epoch: 4, Steps: 18 | Train Loss: 2.663 Vali Loss: 3.068 Vali Acc: 0.107 Test Loss: 3.068 Test Acc: 0.107
Validation loss decreased (-0.069969 --> -0.106636).  Saving model ...
Epoch: 5 cost time: 6.704024791717529
Epoch: 5, Steps: 18 | Train Loss: 2.383 Vali Loss: 3.000 Vali Acc: 0.120 Test Loss: 3.000 Test Acc: 0.120
Validation loss decreased (-0.106636 --> -0.119970).  Saving model ...
Epoch: 6 cost time: 6.817759037017822
Epoch: 6, Steps: 18 | Train Loss: 2.088 Vali Loss: 2.931 Vali Acc: 0.117 Test Loss: 2.931 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.342240333557129
Epoch: 7, Steps: 18 | Train Loss: 1.764 Vali Loss: 2.868 Vali Acc: 0.137 Test Loss: 2.868 Test Acc: 0.137
Validation loss decreased (-0.119970 --> -0.136638).  Saving model ...
Epoch: 8 cost time: 6.196573972702026
Epoch: 8, Steps: 18 | Train Loss: 1.399 Vali Loss: 2.801 Vali Acc: 0.160 Test Loss: 2.801 Test Acc: 0.160
Validation loss decreased (-0.136638 --> -0.159972).  Saving model ...
Epoch: 9 cost time: 5.64470100402832
Epoch: 9, Steps: 18 | Train Loss: 1.107 Vali Loss: 2.755 Vali Acc: 0.167 Test Loss: 2.755 Test Acc: 0.167
Validation loss decreased (-0.159972 --> -0.166639).  Saving model ...
Epoch: 10 cost time: 6.04425311088562
Epoch: 10, Steps: 18 | Train Loss: 0.812 Vali Loss: 2.690 Vali Acc: 0.180 Test Loss: 2.690 Test Acc: 0.180
Validation loss decreased (-0.166639 --> -0.179973).  Saving model ...
Epoch: 11 cost time: 5.906130313873291
Epoch: 11, Steps: 18 | Train Loss: 0.634 Vali Loss: 2.643 Vali Acc: 0.207 Test Loss: 2.643 Test Acc: 0.207
Validation loss decreased (-0.179973 --> -0.206640).  Saving model ...
Epoch: 12 cost time: 5.99121880531311
Epoch: 12, Steps: 18 | Train Loss: 0.414 Vali Loss: 2.564 Vali Acc: 0.233 Test Loss: 2.564 Test Acc: 0.233
Validation loss decreased (-0.206640 --> -0.233308).  Saving model ...
Epoch: 13 cost time: 6.633305549621582
Epoch: 13, Steps: 18 | Train Loss: 0.297 Vali Loss: 2.519 Vali Acc: 0.230 Test Loss: 2.519 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.618621826171875
Epoch: 14, Steps: 18 | Train Loss: 0.194 Vali Loss: 2.478 Vali Acc: 0.267 Test Loss: 2.478 Test Acc: 0.267
Validation loss decreased (-0.233308 --> -0.266642).  Saving model ...
Epoch: 15 cost time: 6.620100498199463
Epoch: 15, Steps: 18 | Train Loss: 0.139 Vali Loss: 2.365 Vali Acc: 0.307 Test Loss: 2.365 Test Acc: 0.307
Validation loss decreased (-0.266642 --> -0.306643).  Saving model ...
Epoch: 16 cost time: 6.713261604309082
Epoch: 16, Steps: 18 | Train Loss: 0.095 Vali Loss: 2.340 Vali Acc: 0.293 Test Loss: 2.340 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.191685199737549
Epoch: 17, Steps: 18 | Train Loss: 0.071 Vali Loss: 2.275 Vali Acc: 0.297 Test Loss: 2.275 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.232560396194458
Epoch: 18, Steps: 18 | Train Loss: 0.056 Vali Loss: 2.267 Vali Acc: 0.330 Test Loss: 2.267 Test Acc: 0.330
Validation loss decreased (-0.306643 --> -0.329977).  Saving model ...
Epoch: 19 cost time: 6.986516714096069
Epoch: 19, Steps: 18 | Train Loss: 0.045 Vali Loss: 2.235 Vali Acc: 0.327 Test Loss: 2.235 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.80731987953186
Epoch: 20, Steps: 18 | Train Loss: 0.042 Vali Loss: 2.217 Vali Acc: 0.330 Test Loss: 2.217 Test Acc: 0.330
Validation loss decreased (-0.329977 --> -0.329978).  Saving model ...
Epoch: 21 cost time: 6.454217195510864
Epoch: 21, Steps: 18 | Train Loss: 0.033 Vali Loss: 2.185 Vali Acc: 0.350 Test Loss: 2.185 Test Acc: 0.350
Validation loss decreased (-0.329978 --> -0.349978).  Saving model ...
Epoch: 22 cost time: 6.063006401062012
Epoch: 22, Steps: 18 | Train Loss: 0.029 Vali Loss: 2.145 Vali Acc: 0.370 Test Loss: 2.145 Test Acc: 0.370
Validation loss decreased (-0.349978 --> -0.369979).  Saving model ...
Epoch: 23 cost time: 6.20522665977478
Epoch: 23, Steps: 18 | Train Loss: 0.026 Vali Loss: 2.126 Vali Acc: 0.373 Test Loss: 2.126 Test Acc: 0.373
Validation loss decreased (-0.369979 --> -0.373312).  Saving model ...
Epoch: 24 cost time: 7.347178936004639
Epoch: 24, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.139 Vali Acc: 0.383 Test Loss: 2.139 Test Acc: 0.383
Validation loss decreased (-0.373312 --> -0.383312).  Saving model ...
Epoch: 25 cost time: 6.550859689712524
Epoch: 25, Steps: 18 | Train Loss: 0.018 Vali Loss: 2.124 Vali Acc: 0.370 Test Loss: 2.124 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.104335308074951
Epoch: 26, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.100 Vali Acc: 0.380 Test Loss: 2.100 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.481358289718628
Epoch: 27, Steps: 18 | Train Loss: 0.016 Vali Loss: 2.090 Vali Acc: 0.380 Test Loss: 2.090 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.503126859664917
Epoch: 28, Steps: 18 | Train Loss: 0.014 Vali Loss: 2.106 Vali Acc: 0.377 Test Loss: 2.106 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.913569450378418
Epoch: 29, Steps: 18 | Train Loss: 0.013 Vali Loss: 2.060 Vali Acc: 0.390 Test Loss: 2.060 Test Acc: 0.390
Validation loss decreased (-0.383312 --> -0.389979).  Saving model ...
Epoch: 30 cost time: 6.740445137023926
Epoch: 30, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.031 Vali Acc: 0.410 Test Loss: 2.031 Test Acc: 0.410
Validation loss decreased (-0.389979 --> -0.409980).  Saving model ...
Epoch: 31 cost time: 6.500822067260742
Epoch: 31, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.034 Vali Acc: 0.410 Test Loss: 2.034 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.305274248123169
Epoch: 32, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.039 Vali Acc: 0.397 Test Loss: 2.039 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.2946202754974365
Epoch: 33, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.020 Vali Acc: 0.413 Test Loss: 2.020 Test Acc: 0.413
Validation loss decreased (-0.409980 --> -0.413313).  Saving model ...
Epoch: 34 cost time: 7.145881414413452
Epoch: 34, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.022 Vali Acc: 0.413 Test Loss: 2.022 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 7.113189935684204
Epoch: 35, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.009 Vali Acc: 0.407 Test Loss: 2.009 Test Acc: 0.407
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 7.358580112457275
Epoch: 36, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.987 Vali Acc: 0.423 Test Loss: 1.987 Test Acc: 0.423
Validation loss decreased (-0.413313 --> -0.423313).  Saving model ...
Epoch: 37 cost time: 6.6667938232421875
Epoch: 37, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.003 Vali Acc: 0.410 Test Loss: 2.003 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.593675374984741
Epoch: 38, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.998 Vali Acc: 0.413 Test Loss: 1.998 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 7.133412837982178
Epoch: 39, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.988 Vali Acc: 0.413 Test Loss: 1.988 Test Acc: 0.413
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 6.986566543579102
Epoch: 40, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.966 Vali Acc: 0.433 Test Loss: 1.966 Test Acc: 0.433
Validation loss decreased (-0.423313 --> -0.433314).  Saving model ...
Epoch: 41 cost time: 6.335650682449341
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.992 Vali Acc: 0.437 Test Loss: 1.992 Test Acc: 0.437
Validation loss decreased (-0.433314 --> -0.436647).  Saving model ...
Epoch: 42 cost time: 6.698508024215698
Epoch: 42, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.985 Vali Acc: 0.423 Test Loss: 1.985 Test Acc: 0.423
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.6360557079315186
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.967 Vali Acc: 0.417 Test Loss: 1.967 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 6.602900505065918
Epoch: 44, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.953 Vali Acc: 0.427 Test Loss: 1.953 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 6.521121501922607
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.957 Vali Acc: 0.430 Test Loss: 1.957 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 6.566032886505127
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.944 Vali Acc: 0.440 Test Loss: 1.944 Test Acc: 0.440
Validation loss decreased (-0.436647 --> -0.439981).  Saving model ...
Epoch: 47 cost time: 6.411787986755371
Epoch: 47, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.926 Vali Acc: 0.443 Test Loss: 1.926 Test Acc: 0.443
Validation loss decreased (-0.439981 --> -0.443314).  Saving model ...
Epoch: 48 cost time: 7.376022577285767
Epoch: 48, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.914 Vali Acc: 0.453 Test Loss: 1.914 Test Acc: 0.453
Validation loss decreased (-0.443314 --> -0.453314).  Saving model ...
Epoch: 49 cost time: 6.7535247802734375
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.916 Vali Acc: 0.450 Test Loss: 1.916 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.87705397605896
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.916 Vali Acc: 0.450 Test Loss: 1.916 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 7.118729829788208
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.911 Vali Acc: 0.450 Test Loss: 1.911 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 6.5539867877960205
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.910 Vali Acc: 0.450 Test Loss: 1.910 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 6.164644956588745
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.909 Vali Acc: 0.457 Test Loss: 1.909 Test Acc: 0.457
Validation loss decreased (-0.453314 --> -0.456648).  Saving model ...
Epoch: 54 cost time: 6.201914310455322
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.908 Vali Acc: 0.460 Test Loss: 1.908 Test Acc: 0.460
Validation loss decreased (-0.456648 --> -0.459981).  Saving model ...
Epoch: 55 cost time: 6.540006160736084
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.923 Vali Acc: 0.457 Test Loss: 1.923 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 7.157701253890991
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.915 Vali Acc: 0.450 Test Loss: 1.915 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 6.897881507873535
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.901 Vali Acc: 0.453 Test Loss: 1.901 Test Acc: 0.453
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 7.6814680099487305
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.900 Vali Acc: 0.450 Test Loss: 1.900 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 7.022400617599487
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.886 Vali Acc: 0.460 Test Loss: 1.886 Test Acc: 0.460
Validation loss decreased (-0.459981 --> -0.459981).  Saving model ...
Epoch: 60 cost time: 7.202084541320801
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.890 Vali Acc: 0.477 Test Loss: 1.890 Test Acc: 0.477
Validation loss decreased (-0.459981 --> -0.476648).  Saving model ...
Epoch: 61 cost time: 7.08574104309082
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.888 Vali Acc: 0.483 Test Loss: 1.888 Test Acc: 0.483
Validation loss decreased (-0.476648 --> -0.483314).  Saving model ...
Epoch: 62 cost time: 6.960390090942383
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.890 Vali Acc: 0.480 Test Loss: 1.890 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 6.8961567878723145
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.880 Vali Acc: 0.470 Test Loss: 1.880 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 6.52905797958374
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.878 Vali Acc: 0.470 Test Loss: 1.878 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 6.543198347091675
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.866 Vali Acc: 0.477 Test Loss: 1.866 Test Acc: 0.477
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 6.685621738433838
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.869 Vali Acc: 0.467 Test Loss: 1.869 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 6.858724117279053
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.865 Vali Acc: 0.467 Test Loss: 1.865 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 6.754670858383179
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.868 Vali Acc: 0.470 Test Loss: 1.868 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 6.3437111377716064
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.875 Vali Acc: 0.473 Test Loss: 1.875 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 6.787479877471924
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.869 Vali Acc: 0.470 Test Loss: 1.869 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 6.621335983276367
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.858 Vali Acc: 0.483 Test Loss: 1.858 Test Acc: 0.483
Validation loss decreased (-0.483314 --> -0.483315).  Saving model ...
Epoch: 72 cost time: 6.131179571151733
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.858 Vali Acc: 0.483 Test Loss: 1.858 Test Acc: 0.483
Validation loss decreased (-0.483315 --> -0.483315).  Saving model ...
Epoch: 73 cost time: 6.442287921905518
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.859 Vali Acc: 0.490 Test Loss: 1.859 Test Acc: 0.490
Validation loss decreased (-0.483315 --> -0.489981).  Saving model ...
Epoch: 74 cost time: 6.959893465042114
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.856 Vali Acc: 0.490 Test Loss: 1.856 Test Acc: 0.490
Validation loss decreased (-0.489981 --> -0.489981).  Saving model ...
Epoch: 75 cost time: 6.702502012252808
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.857 Vali Acc: 0.493 Test Loss: 1.857 Test Acc: 0.493
Validation loss decreased (-0.489981 --> -0.493315).  Saving model ...
Epoch: 76 cost time: 6.200852394104004
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.852 Vali Acc: 0.493 Test Loss: 1.852 Test Acc: 0.493
Validation loss decreased (-0.493315 --> -0.493315).  Saving model ...
Epoch: 77 cost time: 6.061583757400513
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.840 Vali Acc: 0.503 Test Loss: 1.840 Test Acc: 0.503
Validation loss decreased (-0.493315 --> -0.503315).  Saving model ...
Epoch: 78 cost time: 6.165733575820923
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.832 Vali Acc: 0.507 Test Loss: 1.832 Test Acc: 0.507
Validation loss decreased (-0.503315 --> -0.506648).  Saving model ...
Epoch: 79 cost time: 6.200219631195068
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.826 Vali Acc: 0.507 Test Loss: 1.826 Test Acc: 0.507
Validation loss decreased (-0.506648 --> -0.506648).  Saving model ...
Epoch: 80 cost time: 7.266036748886108
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.835 Vali Acc: 0.507 Test Loss: 1.835 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 7.932072877883911
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.837 Vali Acc: 0.497 Test Loss: 1.837 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 6.292275905609131
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.837 Vali Acc: 0.500 Test Loss: 1.837 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 6.580534219741821
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.840 Vali Acc: 0.497 Test Loss: 1.840 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 6.532433032989502
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.510 Test Loss: 1.830 Test Acc: 0.510
Validation loss decreased (-0.506648 --> -0.509982).  Saving model ...
Epoch: 85 cost time: 5.931559801101685
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.825 Vali Acc: 0.510 Test Loss: 1.825 Test Acc: 0.510
Validation loss decreased (-0.509982 --> -0.509982).  Saving model ...
Epoch: 86 cost time: 6.411645412445068
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.827 Vali Acc: 0.503 Test Loss: 1.827 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 6.789811849594116
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.829 Vali Acc: 0.507 Test Loss: 1.829 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 7.520366668701172
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.823 Vali Acc: 0.507 Test Loss: 1.823 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 7.2209155559539795
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.822 Vali Acc: 0.510 Test Loss: 1.822 Test Acc: 0.510
Validation loss decreased (-0.509982 --> -0.509982).  Saving model ...
Epoch: 90 cost time: 7.0377795696258545
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.816 Vali Acc: 0.503 Test Loss: 1.816 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 7.13645339012146
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.812 Vali Acc: 0.507 Test Loss: 1.812 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 6.858829736709595
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.814 Vali Acc: 0.507 Test Loss: 1.814 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 6.2597815990448
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.517 Test Loss: 1.830 Test Acc: 0.517
Validation loss decreased (-0.509982 --> -0.516648).  Saving model ...
Epoch: 94 cost time: 6.877125978469849
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.836 Vali Acc: 0.513 Test Loss: 1.836 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 5.98012900352478
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.827 Vali Acc: 0.513 Test Loss: 1.827 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 6.082869052886963
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.819 Vali Acc: 0.517 Test Loss: 1.819 Test Acc: 0.517
Validation loss decreased (-0.516648 --> -0.516648).  Saving model ...
Epoch: 97 cost time: 6.541895389556885
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.823 Vali Acc: 0.513 Test Loss: 1.823 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 6.43664026260376
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.829 Vali Acc: 0.513 Test Loss: 1.829 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 6.5172438621521
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.520 Test Loss: 1.822 Test Acc: 0.520
Validation loss decreased (-0.516648 --> -0.519982).  Saving model ...
Epoch: 100 cost time: 6.715267658233643
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.818 Vali Acc: 0.513 Test Loss: 1.818 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.52
model parameter : 551833
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.457190752029419
Epoch: 1, Steps: 18 | Train Loss: 3.273 Vali Loss: 3.245 Vali Acc: 0.050 Test Loss: 3.245 Test Acc: 0.050
Validation loss decreased (inf --> -0.049968).  Saving model ...
Epoch: 2 cost time: 5.82008695602417
Epoch: 2, Steps: 18 | Train Loss: 3.184 Vali Loss: 3.192 Vali Acc: 0.047 Test Loss: 3.192 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.130734205245972
Epoch: 3, Steps: 18 | Train Loss: 3.013 Vali Loss: 3.140 Vali Acc: 0.067 Test Loss: 3.140 Test Acc: 0.067
Validation loss decreased (-0.049968 --> -0.066635).  Saving model ...
Epoch: 4 cost time: 6.355422019958496
Epoch: 4, Steps: 18 | Train Loss: 2.730 Vali Loss: 3.081 Vali Acc: 0.093 Test Loss: 3.081 Test Acc: 0.093
Validation loss decreased (-0.066635 --> -0.093303).  Saving model ...
Epoch: 5 cost time: 6.2201828956604
Epoch: 5, Steps: 18 | Train Loss: 2.565 Vali Loss: 3.023 Vali Acc: 0.090 Test Loss: 3.023 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.179834604263306
Epoch: 6, Steps: 18 | Train Loss: 2.331 Vali Loss: 2.964 Vali Acc: 0.133 Test Loss: 2.964 Test Acc: 0.133
Validation loss decreased (-0.093303 --> -0.133304).  Saving model ...
Epoch: 7 cost time: 6.3153746128082275
Epoch: 7, Steps: 18 | Train Loss: 2.028 Vali Loss: 2.915 Vali Acc: 0.140 Test Loss: 2.915 Test Acc: 0.140
Validation loss decreased (-0.133304 --> -0.139971).  Saving model ...
Epoch: 8 cost time: 6.297456502914429
Epoch: 8, Steps: 18 | Train Loss: 1.751 Vali Loss: 2.841 Vali Acc: 0.167 Test Loss: 2.841 Test Acc: 0.167
Validation loss decreased (-0.139971 --> -0.166638).  Saving model ...
Epoch: 9 cost time: 5.977755546569824
Epoch: 9, Steps: 18 | Train Loss: 1.461 Vali Loss: 2.802 Vali Acc: 0.140 Test Loss: 2.802 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.179592132568359
Epoch: 10, Steps: 18 | Train Loss: 1.170 Vali Loss: 2.715 Vali Acc: 0.190 Test Loss: 2.715 Test Acc: 0.190
Validation loss decreased (-0.166638 --> -0.189973).  Saving model ...
Epoch: 11 cost time: 6.353290319442749
Epoch: 11, Steps: 18 | Train Loss: 0.936 Vali Loss: 2.676 Vali Acc: 0.180 Test Loss: 2.676 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.801248073577881
Epoch: 12, Steps: 18 | Train Loss: 0.676 Vali Loss: 2.546 Vali Acc: 0.257 Test Loss: 2.546 Test Acc: 0.257
Validation loss decreased (-0.189973 --> -0.256641).  Saving model ...
Epoch: 13 cost time: 6.482221603393555
Epoch: 13, Steps: 18 | Train Loss: 0.535 Vali Loss: 2.548 Vali Acc: 0.227 Test Loss: 2.548 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.296470880508423
Epoch: 14, Steps: 18 | Train Loss: 0.389 Vali Loss: 2.467 Vali Acc: 0.267 Test Loss: 2.467 Test Acc: 0.267
Validation loss decreased (-0.256641 --> -0.266642).  Saving model ...
Epoch: 15 cost time: 6.512012243270874
Epoch: 15, Steps: 18 | Train Loss: 0.259 Vali Loss: 2.279 Vali Acc: 0.323 Test Loss: 2.279 Test Acc: 0.323
Validation loss decreased (-0.266642 --> -0.323311).  Saving model ...
Epoch: 16 cost time: 6.12012243270874
Epoch: 16, Steps: 18 | Train Loss: 0.191 Vali Loss: 2.276 Vali Acc: 0.327 Test Loss: 2.276 Test Acc: 0.327
Validation loss decreased (-0.323311 --> -0.326644).  Saving model ...
Epoch: 17 cost time: 6.563663005828857
Epoch: 17, Steps: 18 | Train Loss: 0.139 Vali Loss: 2.190 Vali Acc: 0.360 Test Loss: 2.190 Test Acc: 0.360
Validation loss decreased (-0.326644 --> -0.359978).  Saving model ...
Epoch: 18 cost time: 6.9008777141571045
Epoch: 18, Steps: 18 | Train Loss: 0.103 Vali Loss: 2.154 Vali Acc: 0.357 Test Loss: 2.154 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.607564210891724
Epoch: 19, Steps: 18 | Train Loss: 0.075 Vali Loss: 2.073 Vali Acc: 0.390 Test Loss: 2.073 Test Acc: 0.390
Validation loss decreased (-0.359978 --> -0.389979).  Saving model ...
Epoch: 20 cost time: 6.557600736618042
Epoch: 20, Steps: 18 | Train Loss: 0.071 Vali Loss: 2.050 Vali Acc: 0.400 Test Loss: 2.050 Test Acc: 0.400
Validation loss decreased (-0.389979 --> -0.399980).  Saving model ...
Epoch: 21 cost time: 6.608366966247559
Epoch: 21, Steps: 18 | Train Loss: 0.057 Vali Loss: 2.023 Vali Acc: 0.393 Test Loss: 2.023 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.442091464996338
Epoch: 22, Steps: 18 | Train Loss: 0.046 Vali Loss: 2.027 Vali Acc: 0.393 Test Loss: 2.027 Test Acc: 0.393
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.325618743896484
Epoch: 23, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.962 Vali Acc: 0.423 Test Loss: 1.962 Test Acc: 0.423
Validation loss decreased (-0.399980 --> -0.423314).  Saving model ...
Epoch: 24 cost time: 6.076822996139526
Epoch: 24, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.936 Vali Acc: 0.420 Test Loss: 1.936 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.181550025939941
Epoch: 25, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.902 Vali Acc: 0.457 Test Loss: 1.902 Test Acc: 0.457
Validation loss decreased (-0.423314 --> -0.456648).  Saving model ...
Epoch: 26 cost time: 6.0683252811431885
Epoch: 26, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.877 Vali Acc: 0.447 Test Loss: 1.877 Test Acc: 0.447
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.458380460739136
Epoch: 27, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.886 Vali Acc: 0.440 Test Loss: 1.886 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.828315496444702
Epoch: 28, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.884 Vali Acc: 0.437 Test Loss: 1.884 Test Acc: 0.437
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.191264867782593
Epoch: 29, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.868 Vali Acc: 0.437 Test Loss: 1.868 Test Acc: 0.437
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.58404541015625
Epoch: 30, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.811 Vali Acc: 0.463 Test Loss: 1.811 Test Acc: 0.463
Validation loss decreased (-0.456648 --> -0.463315).  Saving model ...
Epoch: 31 cost time: 6.5520100593566895
Epoch: 31, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.769 Vali Acc: 0.477 Test Loss: 1.769 Test Acc: 0.477
Validation loss decreased (-0.463315 --> -0.476649).  Saving model ...
Epoch: 32 cost time: 6.583009481430054
Epoch: 32, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.775 Vali Acc: 0.473 Test Loss: 1.775 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.267668008804321
Epoch: 33, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.737 Vali Acc: 0.493 Test Loss: 1.737 Test Acc: 0.493
Validation loss decreased (-0.476649 --> -0.493316).  Saving model ...
Epoch: 34 cost time: 6.291937828063965
Epoch: 34, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.750 Vali Acc: 0.493 Test Loss: 1.750 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.915769815444946
Epoch: 35, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.736 Vali Acc: 0.497 Test Loss: 1.736 Test Acc: 0.497
Validation loss decreased (-0.493316 --> -0.496649).  Saving model ...
Epoch: 36 cost time: 6.235811233520508
Epoch: 36, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.712 Vali Acc: 0.497 Test Loss: 1.712 Test Acc: 0.497
Validation loss decreased (-0.496649 --> -0.496650).  Saving model ...
Epoch: 37 cost time: 6.754796028137207
Epoch: 37, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.700 Vali Acc: 0.497 Test Loss: 1.700 Test Acc: 0.497
Validation loss decreased (-0.496650 --> -0.496650).  Saving model ...
Epoch: 38 cost time: 5.765756607055664
Epoch: 38, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.711 Vali Acc: 0.503 Test Loss: 1.711 Test Acc: 0.503
Validation loss decreased (-0.496650 --> -0.503316).  Saving model ...
Epoch: 39 cost time: 6.043456554412842
Epoch: 39, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.684 Vali Acc: 0.513 Test Loss: 1.684 Test Acc: 0.513
Validation loss decreased (-0.503316 --> -0.513316).  Saving model ...
Epoch: 40 cost time: 6.573547840118408
Epoch: 40, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.655 Vali Acc: 0.533 Test Loss: 1.655 Test Acc: 0.533
Validation loss decreased (-0.513316 --> -0.533317).  Saving model ...
Epoch: 41 cost time: 6.83303165435791
Epoch: 41, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.692 Vali Acc: 0.513 Test Loss: 1.692 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 7.297420978546143
Epoch: 42, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.683 Vali Acc: 0.513 Test Loss: 1.683 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 6.151559829711914
Epoch: 43, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.662 Vali Acc: 0.510 Test Loss: 1.662 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 7.034940481185913
Epoch: 44, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.636 Vali Acc: 0.527 Test Loss: 1.636 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 6.2518908977508545
Epoch: 45, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.625 Vali Acc: 0.527 Test Loss: 1.625 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 6.446300029754639
Epoch: 46, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.682 Vali Acc: 0.510 Test Loss: 1.682 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 6.21540641784668
Epoch: 47, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.690 Vali Acc: 0.517 Test Loss: 1.690 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 6.753564119338989
Epoch: 48, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.644 Vali Acc: 0.517 Test Loss: 1.644 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 7.039474725723267
Epoch: 49, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.656 Vali Acc: 0.523 Test Loss: 1.656 Test Acc: 0.523
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 6.541895866394043
Epoch: 50, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.644 Vali Acc: 0.537 Test Loss: 1.644 Test Acc: 0.537
Validation loss decreased (-0.533317 --> -0.536650).  Saving model ...
Epoch: 51 cost time: 6.458691835403442
Epoch: 51, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.612 Vali Acc: 0.530 Test Loss: 1.612 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.27658486366272
Epoch: 52, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.611 Vali Acc: 0.533 Test Loss: 1.611 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.071031093597412
Epoch: 53, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.603 Vali Acc: 0.543 Test Loss: 1.603 Test Acc: 0.543
Validation loss decreased (-0.536650 --> -0.543317).  Saving model ...
Epoch: 54 cost time: 6.634556293487549
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.593 Vali Acc: 0.550 Test Loss: 1.593 Test Acc: 0.550
Validation loss decreased (-0.543317 --> -0.549984).  Saving model ...
Epoch: 55 cost time: 6.220543622970581
Epoch: 55, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.594 Vali Acc: 0.550 Test Loss: 1.594 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 6.527864217758179
Epoch: 56, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.625 Vali Acc: 0.543 Test Loss: 1.625 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 6.46074104309082
Epoch: 57, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.633 Vali Acc: 0.540 Test Loss: 1.633 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 6.165268659591675
Epoch: 58, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.614 Vali Acc: 0.537 Test Loss: 1.614 Test Acc: 0.537
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 6.0462164878845215
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.586 Vali Acc: 0.533 Test Loss: 1.586 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 6.022830963134766
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.603 Vali Acc: 0.537 Test Loss: 1.603 Test Acc: 0.537
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 6.239231586456299
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.637 Vali Acc: 0.533 Test Loss: 1.637 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 6.3710103034973145
Epoch: 62, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.593 Vali Acc: 0.547 Test Loss: 1.593 Test Acc: 0.547
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 6.504100799560547
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.587 Vali Acc: 0.553 Test Loss: 1.587 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553317).  Saving model ...
Epoch: 64 cost time: 6.427938938140869
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.600 Vali Acc: 0.543 Test Loss: 1.600 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 6.332060098648071
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.602 Vali Acc: 0.550 Test Loss: 1.602 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 5.959552526473999
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.586 Vali Acc: 0.543 Test Loss: 1.586 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 6.200577259063721
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.582 Vali Acc: 0.547 Test Loss: 1.582 Test Acc: 0.547
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 6.7022645473480225
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.598 Vali Acc: 0.550 Test Loss: 1.598 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 6.5168211460113525
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.610 Vali Acc: 0.550 Test Loss: 1.610 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 6.494015455245972
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.569 Vali Acc: 0.547 Test Loss: 1.569 Test Acc: 0.547
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 6.9736855030059814
Epoch: 71, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.549 Vali Acc: 0.553 Test Loss: 1.549 Test Acc: 0.553
Validation loss decreased (-0.553317 --> -0.553318).  Saving model ...
Epoch: 72 cost time: 5.858196496963501
Epoch: 72, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.552 Vali Acc: 0.550 Test Loss: 1.552 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 6.217564582824707
Epoch: 73, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.575 Vali Acc: 0.557 Test Loss: 1.575 Test Acc: 0.557
Validation loss decreased (-0.553318 --> -0.556651).  Saving model ...
Epoch: 74 cost time: 5.900369644165039
Epoch: 74, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.587 Vali Acc: 0.543 Test Loss: 1.587 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 5.766852140426636
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.590 Vali Acc: 0.540 Test Loss: 1.590 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 6.638255834579468
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.567 Vali Acc: 0.553 Test Loss: 1.567 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 6.244338512420654
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.559 Vali Acc: 0.553 Test Loss: 1.559 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 6.470133066177368
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.553 Vali Acc: 0.550 Test Loss: 1.553 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 6.592573404312134
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.547 Vali Acc: 0.557 Test Loss: 1.547 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 80 cost time: 5.9991772174835205
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.546 Vali Acc: 0.560 Test Loss: 1.546 Test Acc: 0.560
Validation loss decreased (-0.556651 --> -0.559985).  Saving model ...
Epoch: 81 cost time: 6.056267023086548
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.550 Vali Acc: 0.557 Test Loss: 1.550 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 5.532414674758911
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.555 Vali Acc: 0.553 Test Loss: 1.555 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 5.902266263961792
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.556 Vali Acc: 0.557 Test Loss: 1.556 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 6.1962926387786865
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.553 Vali Acc: 0.560 Test Loss: 1.553 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 6.106585502624512
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.560 Vali Acc: 0.553 Test Loss: 1.560 Test Acc: 0.553
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 6.376968145370483
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.565 Vali Acc: 0.557 Test Loss: 1.565 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 5.9945995807647705
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.543 Vali Acc: 0.553 Test Loss: 1.543 Test Acc: 0.553
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 6.110719442367554
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.546 Vali Acc: 0.563 Test Loss: 1.546 Test Acc: 0.563
Validation loss decreased (-0.559985 --> -0.563318).  Saving model ...
Epoch: 89 cost time: 6.166321754455566
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.573 Vali Acc: 0.550 Test Loss: 1.573 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 6.286582946777344
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.557 Vali Acc: 0.553 Test Loss: 1.557 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 6.646744966506958
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.543 Vali Acc: 0.563 Test Loss: 1.543 Test Acc: 0.563
Validation loss decreased (-0.563318 --> -0.563318).  Saving model ...
Epoch: 92 cost time: 6.211292743682861
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.548 Vali Acc: 0.563 Test Loss: 1.548 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 6.255365371704102
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.536 Vali Acc: 0.570 Test Loss: 1.536 Test Acc: 0.570
Validation loss decreased (-0.563318 --> -0.569985).  Saving model ...
Epoch: 94 cost time: 5.860040903091431
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.567 Test Loss: 1.544 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 5.838505506515503
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.591 Vali Acc: 0.560 Test Loss: 1.591 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 6.099104404449463
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.570 Vali Acc: 0.567 Test Loss: 1.570 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 6.3659374713897705
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.542 Vali Acc: 0.563 Test Loss: 1.542 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 6.141696214675903
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.529 Vali Acc: 0.560 Test Loss: 1.529 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 6.864427804946899
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.563 Test Loss: 1.530 Test Acc: 0.563
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 6.590595960617065
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.563 Test Loss: 1.526 Test Acc: 0.563
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.57
model parameter : 551833
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.23286247253418
Epoch: 1, Steps: 18 | Train Loss: 3.281 Vali Loss: 3.260 Vali Acc: 0.047 Test Loss: 3.260 Test Acc: 0.047
Validation loss decreased (inf --> -0.046634).  Saving model ...
Epoch: 2 cost time: 6.993326902389526
Epoch: 2, Steps: 18 | Train Loss: 3.180 Vali Loss: 3.224 Vali Acc: 0.050 Test Loss: 3.224 Test Acc: 0.050
Validation loss decreased (-0.046634 --> -0.049968).  Saving model ...
Epoch: 3 cost time: 6.553920030593872
Epoch: 3, Steps: 18 | Train Loss: 3.015 Vali Loss: 3.181 Vali Acc: 0.070 Test Loss: 3.181 Test Acc: 0.070
Validation loss decreased (-0.049968 --> -0.069968).  Saving model ...
Epoch: 4 cost time: 6.526386499404907
Epoch: 4, Steps: 18 | Train Loss: 2.827 Vali Loss: 3.132 Vali Acc: 0.083 Test Loss: 3.132 Test Acc: 0.083
Validation loss decreased (-0.069968 --> -0.083302).  Saving model ...
Epoch: 5 cost time: 6.557994842529297
Epoch: 5, Steps: 18 | Train Loss: 2.585 Vali Loss: 3.072 Vali Acc: 0.100 Test Loss: 3.072 Test Acc: 0.100
Validation loss decreased (-0.083302 --> -0.099969).  Saving model ...
Epoch: 6 cost time: 5.945799827575684
Epoch: 6, Steps: 18 | Train Loss: 2.332 Vali Loss: 3.016 Vali Acc: 0.110 Test Loss: 3.016 Test Acc: 0.110
Validation loss decreased (-0.099969 --> -0.109970).  Saving model ...
Epoch: 7 cost time: 6.098336696624756
Epoch: 7, Steps: 18 | Train Loss: 2.038 Vali Loss: 2.964 Vali Acc: 0.133 Test Loss: 2.964 Test Acc: 0.133
Validation loss decreased (-0.109970 --> -0.133304).  Saving model ...
Epoch: 8 cost time: 6.110297918319702
Epoch: 8, Steps: 18 | Train Loss: 1.727 Vali Loss: 2.890 Vali Acc: 0.173 Test Loss: 2.890 Test Acc: 0.173
Validation loss decreased (-0.133304 --> -0.173304).  Saving model ...
Epoch: 9 cost time: 6.20471978187561
Epoch: 9, Steps: 18 | Train Loss: 1.455 Vali Loss: 2.849 Vali Acc: 0.163 Test Loss: 2.849 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.566118955612183
Epoch: 10, Steps: 18 | Train Loss: 1.164 Vali Loss: 2.765 Vali Acc: 0.177 Test Loss: 2.765 Test Acc: 0.177
Validation loss decreased (-0.173304 --> -0.176639).  Saving model ...
Epoch: 11 cost time: 6.509998798370361
Epoch: 11, Steps: 18 | Train Loss: 0.914 Vali Loss: 2.690 Vali Acc: 0.187 Test Loss: 2.690 Test Acc: 0.187
Validation loss decreased (-0.176639 --> -0.186640).  Saving model ...
Epoch: 12 cost time: 6.7040629386901855
Epoch: 12, Steps: 18 | Train Loss: 0.656 Vali Loss: 2.607 Vali Acc: 0.220 Test Loss: 2.607 Test Acc: 0.220
Validation loss decreased (-0.186640 --> -0.219974).  Saving model ...
Epoch: 13 cost time: 6.161244869232178
Epoch: 13, Steps: 18 | Train Loss: 0.523 Vali Loss: 2.552 Vali Acc: 0.250 Test Loss: 2.552 Test Acc: 0.250
Validation loss decreased (-0.219974 --> -0.249974).  Saving model ...
Epoch: 14 cost time: 5.85002326965332
Epoch: 14, Steps: 18 | Train Loss: 0.366 Vali Loss: 2.419 Vali Acc: 0.290 Test Loss: 2.419 Test Acc: 0.290
Validation loss decreased (-0.249974 --> -0.289976).  Saving model ...
Epoch: 15 cost time: 6.2882490158081055
Epoch: 15, Steps: 18 | Train Loss: 0.254 Vali Loss: 2.315 Vali Acc: 0.327 Test Loss: 2.315 Test Acc: 0.327
Validation loss decreased (-0.289976 --> -0.326644).  Saving model ...
Epoch: 16 cost time: 6.020254135131836
Epoch: 16, Steps: 18 | Train Loss: 0.169 Vali Loss: 2.236 Vali Acc: 0.350 Test Loss: 2.236 Test Acc: 0.350
Validation loss decreased (-0.326644 --> -0.349978).  Saving model ...
Epoch: 17 cost time: 6.241352319717407
Epoch: 17, Steps: 18 | Train Loss: 0.122 Vali Loss: 2.175 Vali Acc: 0.373 Test Loss: 2.175 Test Acc: 0.373
Validation loss decreased (-0.349978 --> -0.373312).  Saving model ...
Epoch: 18 cost time: 6.675548315048218
Epoch: 18, Steps: 18 | Train Loss: 0.093 Vali Loss: 2.070 Vali Acc: 0.360 Test Loss: 2.070 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.070218324661255
Epoch: 19, Steps: 18 | Train Loss: 0.075 Vali Loss: 2.049 Vali Acc: 0.390 Test Loss: 2.049 Test Acc: 0.390
Validation loss decreased (-0.373312 --> -0.389980).  Saving model ...
Epoch: 20 cost time: 6.374229907989502
Epoch: 20, Steps: 18 | Train Loss: 0.063 Vali Loss: 2.006 Vali Acc: 0.400 Test Loss: 2.006 Test Acc: 0.400
Validation loss decreased (-0.389980 --> -0.399980).  Saving model ...
Epoch: 21 cost time: 6.451956033706665
Epoch: 21, Steps: 18 | Train Loss: 0.049 Vali Loss: 2.006 Vali Acc: 0.383 Test Loss: 2.006 Test Acc: 0.383
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.013473033905029
Epoch: 22, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.973 Vali Acc: 0.407 Test Loss: 1.973 Test Acc: 0.407
Validation loss decreased (-0.399980 --> -0.406647).  Saving model ...
Epoch: 23 cost time: 5.931392669677734
Epoch: 23, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.891 Vali Acc: 0.427 Test Loss: 1.891 Test Acc: 0.427
Validation loss decreased (-0.406647 --> -0.426648).  Saving model ...
Epoch: 24 cost time: 5.95914888381958
Epoch: 24, Steps: 18 | Train Loss: 0.031 Vali Loss: 1.836 Vali Acc: 0.457 Test Loss: 1.836 Test Acc: 0.457
Validation loss decreased (-0.426648 --> -0.456648).  Saving model ...
Epoch: 25 cost time: 6.234310626983643
Epoch: 25, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.839 Vali Acc: 0.443 Test Loss: 1.839 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.991825342178345
Epoch: 26, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.805 Vali Acc: 0.447 Test Loss: 1.805 Test Acc: 0.447
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.400768518447876
Epoch: 27, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.814 Vali Acc: 0.457 Test Loss: 1.814 Test Acc: 0.457
Validation loss decreased (-0.456648 --> -0.456649).  Saving model ...
Epoch: 28 cost time: 6.329995632171631
Epoch: 28, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.796 Vali Acc: 0.453 Test Loss: 1.796 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.132793426513672
Epoch: 29, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.756 Vali Acc: 0.473 Test Loss: 1.756 Test Acc: 0.473
Validation loss decreased (-0.456649 --> -0.473316).  Saving model ...
Epoch: 30 cost time: 6.083410263061523
Epoch: 30, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.716 Vali Acc: 0.513 Test Loss: 1.716 Test Acc: 0.513
Validation loss decreased (-0.473316 --> -0.513316).  Saving model ...
Epoch: 31 cost time: 6.588784456253052
Epoch: 31, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.708 Vali Acc: 0.497 Test Loss: 1.708 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.5319390296936035
Epoch: 32, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.693 Vali Acc: 0.510 Test Loss: 1.693 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.99098539352417
Epoch: 33, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.669 Vali Acc: 0.513 Test Loss: 1.669 Test Acc: 0.513
Validation loss decreased (-0.513316 --> -0.513317).  Saving model ...
Epoch: 34 cost time: 6.198117256164551
Epoch: 34, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.659 Vali Acc: 0.517 Test Loss: 1.659 Test Acc: 0.517
Validation loss decreased (-0.513317 --> -0.516650).  Saving model ...
Epoch: 35 cost time: 5.919695138931274
Epoch: 35, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.659 Vali Acc: 0.533 Test Loss: 1.659 Test Acc: 0.533
Validation loss decreased (-0.516650 --> -0.533317).  Saving model ...
Epoch: 36 cost time: 6.335284233093262
Epoch: 36, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.657 Vali Acc: 0.513 Test Loss: 1.657 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.3069233894348145
Epoch: 37, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.640 Vali Acc: 0.527 Test Loss: 1.640 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 6.458461046218872
Epoch: 38, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.630 Vali Acc: 0.543 Test Loss: 1.630 Test Acc: 0.543
Validation loss decreased (-0.533317 --> -0.543317).  Saving model ...
Epoch: 39 cost time: 6.678216934204102
Epoch: 39, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.612 Vali Acc: 0.537 Test Loss: 1.612 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.683206081390381
Epoch: 40, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.580 Vali Acc: 0.537 Test Loss: 1.580 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 5.9662926197052
Epoch: 41, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.589 Vali Acc: 0.533 Test Loss: 1.589 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 6.234869003295898
Epoch: 42, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.588 Vali Acc: 0.547 Test Loss: 1.588 Test Acc: 0.547
Validation loss decreased (-0.543317 --> -0.546651).  Saving model ...
Epoch: 43 cost time: 6.196434736251831
Epoch: 43, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.580 Vali Acc: 0.547 Test Loss: 1.580 Test Acc: 0.547
Validation loss decreased (-0.546651 --> -0.546651).  Saving model ...
Epoch: 44 cost time: 6.25939154624939
Epoch: 44, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.553 Vali Acc: 0.547 Test Loss: 1.553 Test Acc: 0.547
Validation loss decreased (-0.546651 --> -0.546651).  Saving model ...
Epoch: 45 cost time: 6.423986196517944
Epoch: 45, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.551 Vali Acc: 0.550 Test Loss: 1.551 Test Acc: 0.550
Validation loss decreased (-0.546651 --> -0.549984).  Saving model ...
Epoch: 46 cost time: 6.0965895652771
Epoch: 46, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.559 Vali Acc: 0.553 Test Loss: 1.559 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553318).  Saving model ...
Epoch: 47 cost time: 6.580408334732056
Epoch: 47, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.565 Vali Acc: 0.550 Test Loss: 1.565 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 6.590110778808594
Epoch: 48, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.540 Vali Acc: 0.550 Test Loss: 1.540 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 6.433722734451294
Epoch: 49, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.531 Vali Acc: 0.543 Test Loss: 1.531 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 6.39460825920105
Epoch: 50, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.530 Vali Acc: 0.557 Test Loss: 1.530 Test Acc: 0.557
Validation loss decreased (-0.553318 --> -0.556651).  Saving model ...
Epoch: 51 cost time: 6.160363674163818
Epoch: 51, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.524 Vali Acc: 0.557 Test Loss: 1.524 Test Acc: 0.557
Validation loss decreased (-0.556651 --> -0.556651).  Saving model ...
Epoch: 52 cost time: 6.414425373077393
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.510 Vali Acc: 0.560 Test Loss: 1.510 Test Acc: 0.560
Validation loss decreased (-0.556651 --> -0.559985).  Saving model ...
Epoch: 53 cost time: 7.008036136627197
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.502 Vali Acc: 0.560 Test Loss: 1.502 Test Acc: 0.560
Validation loss decreased (-0.559985 --> -0.559985).  Saving model ...
Epoch: 54 cost time: 6.448306560516357
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.490 Vali Acc: 0.567 Test Loss: 1.490 Test Acc: 0.567
Validation loss decreased (-0.559985 --> -0.566652).  Saving model ...
Epoch: 55 cost time: 7.424522399902344
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.482 Vali Acc: 0.563 Test Loss: 1.482 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 6.59442663192749
Epoch: 56, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.478 Vali Acc: 0.577 Test Loss: 1.478 Test Acc: 0.577
Validation loss decreased (-0.566652 --> -0.576652).  Saving model ...
Epoch: 57 cost time: 6.258098602294922
Epoch: 57, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.480 Vali Acc: 0.570 Test Loss: 1.480 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 5.952883005142212
Epoch: 58, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.479 Vali Acc: 0.570 Test Loss: 1.479 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 6.9731409549713135
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.470 Vali Acc: 0.557 Test Loss: 1.470 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 6.610400676727295
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.471 Vali Acc: 0.557 Test Loss: 1.471 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 6.645528078079224
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.475 Vali Acc: 0.560 Test Loss: 1.475 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 7.194796323776245
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.466 Vali Acc: 0.557 Test Loss: 1.466 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 6.4232470989227295
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.463 Vali Acc: 0.567 Test Loss: 1.463 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 6.639641046524048
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.459 Vali Acc: 0.563 Test Loss: 1.459 Test Acc: 0.563
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 6.630603790283203
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.461 Vali Acc: 0.560 Test Loss: 1.461 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 7.787630319595337
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.451 Vali Acc: 0.563 Test Loss: 1.451 Test Acc: 0.563
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5766666666666667
model parameter : 551833
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.66482424736023
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 7.121114015579224
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.042196750640869
Epoch: 3, Steps: 18 | Train Loss: 3.218 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.865055561065674
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 5 cost time: 7.036441087722778
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 6 cost time: 7.294342279434204
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.394278287887573
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.069995880126953
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.690969228744507
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.886929273605347
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.678136348724365
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.361905336380005
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.126705884933472
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.292625427246094
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.631192445755005
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 551833
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.825443267822266
Epoch: 1, Steps: 18 | Train Loss: 3.220 Vali Loss: 2.968 Vali Acc: 0.193 Test Loss: 2.968 Test Acc: 0.193
Validation loss decreased (inf --> -0.193304).  Saving model ...
Epoch: 2 cost time: 6.962416172027588
Epoch: 2, Steps: 18 | Train Loss: 2.748 Vali Loss: 2.395 Vali Acc: 0.623 Test Loss: 2.395 Test Acc: 0.623
Validation loss decreased (-0.193304 --> -0.623309).  Saving model ...
Epoch: 3 cost time: 7.0884850025177
Epoch: 3, Steps: 18 | Train Loss: 2.059 Vali Loss: 1.773 Vali Acc: 0.737 Test Loss: 1.773 Test Acc: 0.737
Validation loss decreased (-0.623309 --> -0.736649).  Saving model ...
Epoch: 4 cost time: 7.216548919677734
Epoch: 4, Steps: 18 | Train Loss: 1.350 Vali Loss: 1.239 Vali Acc: 0.797 Test Loss: 1.239 Test Acc: 0.797
Validation loss decreased (-0.736649 --> -0.796654).  Saving model ...
Epoch: 5 cost time: 6.639005899429321
Epoch: 5, Steps: 18 | Train Loss: 0.811 Vali Loss: 0.894 Vali Acc: 0.823 Test Loss: 0.894 Test Acc: 0.823
Validation loss decreased (-0.796654 --> -0.823324).  Saving model ...
Epoch: 6 cost time: 6.575984001159668
Epoch: 6, Steps: 18 | Train Loss: 0.447 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
Validation loss decreased (-0.823324 --> -0.849993).  Saving model ...
Epoch: 7 cost time: 6.759026050567627
Epoch: 7, Steps: 18 | Train Loss: 0.250 Vali Loss: 0.583 Vali Acc: 0.870 Test Loss: 0.583 Test Acc: 0.870
Validation loss decreased (-0.849993 --> -0.869994).  Saving model ...
Epoch: 8 cost time: 6.804397344589233
Epoch: 8, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.532 Vali Acc: 0.873 Test Loss: 0.532 Test Acc: 0.873
Validation loss decreased (-0.869994 --> -0.873328).  Saving model ...
Epoch: 9 cost time: 6.351909637451172
Epoch: 9, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.493 Vali Acc: 0.887 Test Loss: 0.493 Test Acc: 0.887
Validation loss decreased (-0.873328 --> -0.886662).  Saving model ...
Epoch: 10 cost time: 6.769016981124878
Epoch: 10, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.474 Vali Acc: 0.887 Test Loss: 0.474 Test Acc: 0.887
Validation loss decreased (-0.886662 --> -0.886662).  Saving model ...
Epoch: 11 cost time: 6.31347918510437
Epoch: 11, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.455 Vali Acc: 0.880 Test Loss: 0.455 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.909982204437256
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.452 Vali Acc: 0.880 Test Loss: 0.452 Test Acc: 0.880
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.122436285018921
Epoch: 13, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.439 Vali Acc: 0.880 Test Loss: 0.439 Test Acc: 0.880
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.719402551651001
Epoch: 14, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.373225688934326
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.431 Vali Acc: 0.887 Test Loss: 0.431 Test Acc: 0.887
Validation loss decreased (-0.886662 --> -0.886662).  Saving model ...
Epoch: 16 cost time: 6.499389171600342
Epoch: 16, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.428 Vali Acc: 0.887 Test Loss: 0.428 Test Acc: 0.887
Validation loss decreased (-0.886662 --> -0.886662).  Saving model ...
Epoch: 17 cost time: 6.071033239364624
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.421 Vali Acc: 0.893 Test Loss: 0.421 Test Acc: 0.893
Validation loss decreased (-0.886662 --> -0.893329).  Saving model ...
Epoch: 18 cost time: 6.355489730834961
Epoch: 18, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.419 Vali Acc: 0.893 Test Loss: 0.419 Test Acc: 0.893
Validation loss decreased (-0.893329 --> -0.893329).  Saving model ...
Epoch: 19 cost time: 6.3448474407196045
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.414 Vali Acc: 0.890 Test Loss: 0.414 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.41054105758667
Epoch: 20, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.412 Vali Acc: 0.890 Test Loss: 0.412 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.315287351608276
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.411 Vali Acc: 0.893 Test Loss: 0.411 Test Acc: 0.893
Validation loss decreased (-0.893329 --> -0.893329).  Saving model ...
Epoch: 22 cost time: 5.7303831577301025
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.413 Vali Acc: 0.897 Test Loss: 0.413 Test Acc: 0.897
Validation loss decreased (-0.893329 --> -0.896663).  Saving model ...
Epoch: 23 cost time: 6.30761194229126
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.411 Vali Acc: 0.890 Test Loss: 0.411 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.847546100616455
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.404 Vali Acc: 0.893 Test Loss: 0.404 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.551276206970215
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
Validation loss decreased (-0.896663 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 5.884389162063599
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 6.009286403656006
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.401 Vali Acc: 0.897 Test Loss: 0.401 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.5383312702178955
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.524989128112793
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.402 Vali Acc: 0.897 Test Loss: 0.402 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.340795993804932
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 31 cost time: 6.47562837600708
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 6.470402002334595
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 6.934921741485596
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 6.868717432022095
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.391 Vali Acc: 0.907 Test Loss: 0.391 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.906663).  Saving model ...
Epoch: 35 cost time: 6.121822118759155
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.903 Test Loss: 0.391 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.185466289520264
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 6.438307762145996
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.389 Vali Acc: 0.903 Test Loss: 0.389 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 6.284115552902222
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.386 Vali Acc: 0.907 Test Loss: 0.386 Test Acc: 0.907
Validation loss decreased (-0.906663 --> -0.906663).  Saving model ...
Epoch: 39 cost time: 6.668221950531006
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.385 Vali Acc: 0.910 Test Loss: 0.385 Test Acc: 0.910
Validation loss decreased (-0.906663 --> -0.909996).  Saving model ...
Epoch: 40 cost time: 6.646473169326782
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.384 Vali Acc: 0.907 Test Loss: 0.384 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.443504095077515
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.386 Vali Acc: 0.910 Test Loss: 0.386 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.6394312381744385
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.388 Vali Acc: 0.910 Test Loss: 0.388 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.5049357414245605
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.387 Vali Acc: 0.910 Test Loss: 0.387 Test Acc: 0.910
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.817964792251587
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.384 Vali Acc: 0.903 Test Loss: 0.384 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 7.355284690856934
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.907 Test Loss: 0.382 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 7.407443523406982
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.381 Vali Acc: 0.907 Test Loss: 0.381 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 6.9800474643707275
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.907 Test Loss: 0.378 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 6.590755939483643
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 7.058600902557373
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.910 Test Loss: 0.377 Test Acc: 0.910
Validation loss decreased (-0.909996 --> -0.909996).  Saving model ...
Epoch: 50 cost time: 6.927334785461426
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.910 Test Loss: 0.377 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 6.867041110992432
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 7.151644706726074
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 7.7202582359313965
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 7.391585350036621
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.910 Test Loss: 0.376 Test Acc: 0.910
Validation loss decreased (-0.909996 --> -0.909996).  Saving model ...
Epoch: 55 cost time: 6.936357259750366
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.910 Test Loss: 0.375 Test Acc: 0.910
Validation loss decreased (-0.909996 --> -0.909996).  Saving model ...
Epoch: 56 cost time: 6.72945499420166
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.907 Test Loss: 0.375 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 7.046293497085571
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.907 Test Loss: 0.376 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 6.987287998199463
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.907 Test Loss: 0.376 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 6.639033317565918
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.907 Test Loss: 0.376 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 7.387298583984375
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.907 Test Loss: 0.376 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 6.984764814376831
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.907 Test Loss: 0.375 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 6.9900500774383545
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.907 Test Loss: 0.375 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 6.532078981399536
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.907 Test Loss: 0.375 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 7.683312892913818
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.910 Test Loss: 0.377 Test Acc: 0.910
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 7.465126276016235
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.910 Test Loss: 0.376 Test Acc: 0.910
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.91
model parameter : 355225
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.842438459396362
Epoch: 1, Steps: 18 | Train Loss: 3.255 Vali Loss: 3.048 Vali Acc: 0.147 Test Loss: 3.048 Test Acc: 0.147
Validation loss decreased (inf --> -0.146636).  Saving model ...
Epoch: 2 cost time: 7.0528244972229
Epoch: 2, Steps: 18 | Train Loss: 2.879 Vali Loss: 2.599 Vali Acc: 0.503 Test Loss: 2.599 Test Acc: 0.503
Validation loss decreased (-0.146636 --> -0.503307).  Saving model ...
Epoch: 3 cost time: 7.287614822387695
Epoch: 3, Steps: 18 | Train Loss: 2.306 Vali Loss: 2.067 Vali Acc: 0.690 Test Loss: 2.067 Test Acc: 0.690
Validation loss decreased (-0.503307 --> -0.689979).  Saving model ...
Epoch: 4 cost time: 6.775025844573975
Epoch: 4, Steps: 18 | Train Loss: 1.631 Vali Loss: 1.541 Vali Acc: 0.740 Test Loss: 1.541 Test Acc: 0.740
Validation loss decreased (-0.689979 --> -0.739985).  Saving model ...
Epoch: 5 cost time: 6.439173221588135
Epoch: 5, Steps: 18 | Train Loss: 1.062 Vali Loss: 1.149 Vali Acc: 0.780 Test Loss: 1.149 Test Acc: 0.780
Validation loss decreased (-0.739985 --> -0.779989).  Saving model ...
Epoch: 6 cost time: 6.171690225601196
Epoch: 6, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.896 Vali Acc: 0.810 Test Loss: 0.896 Test Acc: 0.810
Validation loss decreased (-0.779989 --> -0.809991).  Saving model ...
Epoch: 7 cost time: 6.590167284011841
Epoch: 7, Steps: 18 | Train Loss: 0.362 Vali Loss: 0.759 Vali Acc: 0.840 Test Loss: 0.759 Test Acc: 0.840
Validation loss decreased (-0.809991 --> -0.839992).  Saving model ...
Epoch: 8 cost time: 7.11395001411438
Epoch: 8, Steps: 18 | Train Loss: 0.211 Vali Loss: 0.684 Vali Acc: 0.840 Test Loss: 0.684 Test Acc: 0.840
Validation loss decreased (-0.839992 --> -0.839993).  Saving model ...
Epoch: 9 cost time: 6.985118865966797
Epoch: 9, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.643 Vali Acc: 0.843 Test Loss: 0.643 Test Acc: 0.843
Validation loss decreased (-0.839993 --> -0.843327).  Saving model ...
Epoch: 10 cost time: 6.961360931396484
Epoch: 10, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.608 Vali Acc: 0.853 Test Loss: 0.608 Test Acc: 0.853
Validation loss decreased (-0.843327 --> -0.853327).  Saving model ...
Epoch: 11 cost time: 6.180567264556885
Epoch: 11, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.588 Vali Acc: 0.843 Test Loss: 0.588 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.211074352264404
Epoch: 12, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.581 Vali Acc: 0.840 Test Loss: 0.581 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.522868633270264
Epoch: 13, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.612476587295532
Epoch: 14, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.562 Vali Acc: 0.857 Test Loss: 0.562 Test Acc: 0.857
Validation loss decreased (-0.853327 --> -0.856661).  Saving model ...
Epoch: 15 cost time: 7.131882905960083
Epoch: 15, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.558 Vali Acc: 0.853 Test Loss: 0.558 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.554062604904175
Epoch: 16, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.554 Vali Acc: 0.847 Test Loss: 0.554 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.5547685623168945
Epoch: 17, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.543 Vali Acc: 0.860 Test Loss: 0.543 Test Acc: 0.860
Validation loss decreased (-0.856661 --> -0.859995).  Saving model ...
Epoch: 18 cost time: 6.143219470977783
Epoch: 18, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.541 Vali Acc: 0.843 Test Loss: 0.541 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.052559852600098
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.541 Vali Acc: 0.853 Test Loss: 0.541 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.668844223022461
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.536 Vali Acc: 0.860 Test Loss: 0.536 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 21 cost time: 6.61068320274353
Epoch: 21, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.536 Vali Acc: 0.857 Test Loss: 0.536 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.708346843719482
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.534 Vali Acc: 0.860 Test Loss: 0.534 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 23 cost time: 6.733876943588257
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.531 Vali Acc: 0.853 Test Loss: 0.531 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.345607042312622
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.525 Vali Acc: 0.857 Test Loss: 0.525 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.194998741149902
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.417190313339233
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.527 Vali Acc: 0.857 Test Loss: 0.527 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.483012676239014
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.522 Vali Acc: 0.857 Test Loss: 0.522 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.354217290878296
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.520 Vali Acc: 0.860 Test Loss: 0.520 Test Acc: 0.860
Validation loss decreased (-0.859995 --> -0.859995).  Saving model ...
Epoch: 29 cost time: 6.330475091934204
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.517 Vali Acc: 0.863 Test Loss: 0.517 Test Acc: 0.863
Validation loss decreased (-0.859995 --> -0.863328).  Saving model ...
Epoch: 30 cost time: 6.498260974884033
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.515 Vali Acc: 0.863 Test Loss: 0.515 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 31 cost time: 6.754205942153931
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.515 Vali Acc: 0.860 Test Loss: 0.515 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.345811128616333
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.511 Vali Acc: 0.860 Test Loss: 0.511 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.396472930908203
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.512 Vali Acc: 0.860 Test Loss: 0.512 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.733976602554321
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.860 Test Loss: 0.513 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 6.588742017745972
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.510 Vali Acc: 0.863 Test Loss: 0.510 Test Acc: 0.863
Validation loss decreased (-0.863328 --> -0.863328).  Saving model ...
Epoch: 36 cost time: 6.963376045227051
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.509 Vali Acc: 0.860 Test Loss: 0.509 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.491417407989502
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.508 Vali Acc: 0.860 Test Loss: 0.508 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 6.771904945373535
Epoch: 38, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.505 Vali Acc: 0.860 Test Loss: 0.505 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 6.63997745513916
Epoch: 39, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.506 Vali Acc: 0.860 Test Loss: 0.506 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 6.501648664474487
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.857 Test Loss: 0.505 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 6.605632066726685
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.853 Test Loss: 0.507 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 7.059475898742676
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.857 Test Loss: 0.511 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 6.310542821884155
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.857 Test Loss: 0.512 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 6.539484977722168
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.840 Test Loss: 0.517 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 6.571628570556641
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.840 Test Loss: 0.518 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8633333333333333
model parameter : 355225
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.692095518112183
Epoch: 1, Steps: 18 | Train Loss: 3.269 Vali Loss: 3.123 Vali Acc: 0.097 Test Loss: 3.123 Test Acc: 0.097
Validation loss decreased (inf --> -0.096635).  Saving model ...
Epoch: 2 cost time: 6.503949403762817
Epoch: 2, Steps: 18 | Train Loss: 2.980 Vali Loss: 2.816 Vali Acc: 0.360 Test Loss: 2.816 Test Acc: 0.360
Validation loss decreased (-0.096635 --> -0.359972).  Saving model ...
Epoch: 3 cost time: 7.165750741958618
Epoch: 3, Steps: 18 | Train Loss: 2.560 Vali Loss: 2.447 Vali Acc: 0.510 Test Loss: 2.447 Test Acc: 0.510
Validation loss decreased (-0.359972 --> -0.509976).  Saving model ...
Epoch: 4 cost time: 7.225825786590576
Epoch: 4, Steps: 18 | Train Loss: 2.017 Vali Loss: 2.031 Vali Acc: 0.617 Test Loss: 2.031 Test Acc: 0.617
Validation loss decreased (-0.509976 --> -0.616646).  Saving model ...
Epoch: 5 cost time: 7.179234981536865
Epoch: 5, Steps: 18 | Train Loss: 1.464 Vali Loss: 1.646 Vali Acc: 0.677 Test Loss: 1.646 Test Acc: 0.677
Validation loss decreased (-0.616646 --> -0.676650).  Saving model ...
Epoch: 6 cost time: 6.990943670272827
Epoch: 6, Steps: 18 | Train Loss: 0.982 Vali Loss: 1.345 Vali Acc: 0.717 Test Loss: 1.345 Test Acc: 0.717
Validation loss decreased (-0.676650 --> -0.716653).  Saving model ...
Epoch: 7 cost time: 6.469768285751343
Epoch: 7, Steps: 18 | Train Loss: 0.602 Vali Loss: 1.139 Vali Acc: 0.753 Test Loss: 1.139 Test Acc: 0.753
Validation loss decreased (-0.716653 --> -0.753322).  Saving model ...
Epoch: 8 cost time: 7.023747444152832
Epoch: 8, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.018 Vali Acc: 0.767 Test Loss: 1.018 Test Acc: 0.767
Validation loss decreased (-0.753322 --> -0.766656).  Saving model ...
Epoch: 9 cost time: 6.4410316944122314
Epoch: 9, Steps: 18 | Train Loss: 0.195 Vali Loss: 0.947 Vali Acc: 0.770 Test Loss: 0.947 Test Acc: 0.770
Validation loss decreased (-0.766656 --> -0.769991).  Saving model ...
Epoch: 10 cost time: 6.890645742416382
Epoch: 10, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.906 Vali Acc: 0.777 Test Loss: 0.906 Test Acc: 0.777
Validation loss decreased (-0.769991 --> -0.776658).  Saving model ...
Epoch: 11 cost time: 7.001963376998901
Epoch: 11, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.870 Vali Acc: 0.780 Test Loss: 0.870 Test Acc: 0.780
Validation loss decreased (-0.776658 --> -0.779991).  Saving model ...
Epoch: 12 cost time: 7.286464691162109
Epoch: 12, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.862 Vali Acc: 0.787 Test Loss: 0.862 Test Acc: 0.787
Validation loss decreased (-0.779991 --> -0.786658).  Saving model ...
Epoch: 13 cost time: 7.434845685958862
Epoch: 13, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.848 Vali Acc: 0.783 Test Loss: 0.848 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.8295934200286865
Epoch: 14, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.833 Vali Acc: 0.787 Test Loss: 0.833 Test Acc: 0.787
Validation loss decreased (-0.786658 --> -0.786658).  Saving model ...
Epoch: 15 cost time: 7.178354024887085
Epoch: 15, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.842 Vali Acc: 0.777 Test Loss: 0.842 Test Acc: 0.777
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.568160772323608
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.836 Vali Acc: 0.770 Test Loss: 0.836 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.937696695327759
Epoch: 17, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.827 Vali Acc: 0.787 Test Loss: 0.827 Test Acc: 0.787
Validation loss decreased (-0.786658 --> -0.786658).  Saving model ...
Epoch: 18 cost time: 7.080319166183472
Epoch: 18, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.814 Vali Acc: 0.790 Test Loss: 0.814 Test Acc: 0.790
Validation loss decreased (-0.786658 --> -0.789992).  Saving model ...
Epoch: 19 cost time: 6.966314792633057
Epoch: 19, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.810 Vali Acc: 0.793 Test Loss: 0.810 Test Acc: 0.793
Validation loss decreased (-0.789992 --> -0.793325).  Saving model ...
Epoch: 20 cost time: 7.41653299331665
Epoch: 20, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.809 Vali Acc: 0.783 Test Loss: 0.809 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.4918835163116455
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.808 Vali Acc: 0.787 Test Loss: 0.808 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.337522506713867
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.810 Vali Acc: 0.803 Test Loss: 0.810 Test Acc: 0.803
Validation loss decreased (-0.793325 --> -0.803325).  Saving model ...
Epoch: 23 cost time: 7.993370771408081
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.809 Vali Acc: 0.797 Test Loss: 0.809 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.780504941940308
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.806 Vali Acc: 0.790 Test Loss: 0.806 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.411673307418823
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.800 Vali Acc: 0.790 Test Loss: 0.800 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.575249433517456
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.796 Vali Acc: 0.807 Test Loss: 0.796 Test Acc: 0.807
Validation loss decreased (-0.803325 --> -0.806659).  Saving model ...
Epoch: 27 cost time: 7.1226043701171875
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.792 Vali Acc: 0.790 Test Loss: 0.792 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.7033851146698
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.795 Vali Acc: 0.793 Test Loss: 0.795 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.951991558074951
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.797 Vali Acc: 0.793 Test Loss: 0.797 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.968888998031616
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.7625346183776855
Epoch: 31, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.794 Vali Acc: 0.803 Test Loss: 0.794 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 7.586927175521851
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.790 Vali Acc: 0.800 Test Loss: 0.790 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 7.205864429473877
Epoch: 33, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.795 Vali Acc: 0.803 Test Loss: 0.795 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 7.4519243240356445
Epoch: 34, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.798 Vali Acc: 0.800 Test Loss: 0.798 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 7.423243045806885
Epoch: 35, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.800 Test Loss: 0.793 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 7.0025551319122314
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.791 Vali Acc: 0.807 Test Loss: 0.791 Test Acc: 0.807
Validation loss decreased (-0.806659 --> -0.806659).  Saving model ...
Epoch: 37 cost time: 7.244070529937744
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.790 Vali Acc: 0.810 Test Loss: 0.790 Test Acc: 0.810
Validation loss decreased (-0.806659 --> -0.809992).  Saving model ...
Epoch: 38 cost time: 7.494558334350586
Epoch: 38, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.788 Vali Acc: 0.807 Test Loss: 0.788 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 7.241068363189697
Epoch: 39, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.791 Vali Acc: 0.803 Test Loss: 0.791 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.543871641159058
Epoch: 40, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.791 Vali Acc: 0.803 Test Loss: 0.791 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 7.2472405433654785
Epoch: 41, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.796 Vali Acc: 0.797 Test Loss: 0.796 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 7.508177042007446
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 6.936938047409058
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.799 Vali Acc: 0.797 Test Loss: 0.799 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 8.382327556610107
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.801 Vali Acc: 0.807 Test Loss: 0.801 Test Acc: 0.807
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 7.446913719177246
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.799 Vali Acc: 0.807 Test Loss: 0.799 Test Acc: 0.807
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 7.2190234661102295
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.794 Vali Acc: 0.800 Test Loss: 0.794 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 7.587321996688843
Epoch: 47, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.795 Vali Acc: 0.803 Test Loss: 0.795 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.81
model parameter : 355225
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.620431184768677
Epoch: 1, Steps: 18 | Train Loss: 3.271 Vali Loss: 3.184 Vali Acc: 0.063 Test Loss: 3.184 Test Acc: 0.063
Validation loss decreased (inf --> -0.063301).  Saving model ...
Epoch: 2 cost time: 6.996075391769409
Epoch: 2, Steps: 18 | Train Loss: 3.074 Vali Loss: 2.993 Vali Acc: 0.247 Test Loss: 2.993 Test Acc: 0.247
Validation loss decreased (-0.063301 --> -0.246637).  Saving model ...
Epoch: 3 cost time: 6.73154091835022
Epoch: 3, Steps: 18 | Train Loss: 2.754 Vali Loss: 2.777 Vali Acc: 0.337 Test Loss: 2.777 Test Acc: 0.337
Validation loss decreased (-0.246637 --> -0.336639).  Saving model ...
Epoch: 4 cost time: 6.379872798919678
Epoch: 4, Steps: 18 | Train Loss: 2.360 Vali Loss: 2.521 Vali Acc: 0.417 Test Loss: 2.521 Test Acc: 0.417
Validation loss decreased (-0.336639 --> -0.416641).  Saving model ...
Epoch: 5 cost time: 6.69542932510376
Epoch: 5, Steps: 18 | Train Loss: 1.895 Vali Loss: 2.252 Vali Acc: 0.500 Test Loss: 2.252 Test Acc: 0.500
Validation loss decreased (-0.416641 --> -0.499977).  Saving model ...
Epoch: 6 cost time: 6.35163688659668
Epoch: 6, Steps: 18 | Train Loss: 1.417 Vali Loss: 2.008 Vali Acc: 0.507 Test Loss: 2.008 Test Acc: 0.507
Validation loss decreased (-0.499977 --> -0.506647).  Saving model ...
Epoch: 7 cost time: 7.4471354484558105
Epoch: 7, Steps: 18 | Train Loss: 1.024 Vali Loss: 1.797 Vali Acc: 0.567 Test Loss: 1.797 Test Acc: 0.567
Validation loss decreased (-0.506647 --> -0.566649).  Saving model ...
Epoch: 8 cost time: 6.50178074836731
Epoch: 8, Steps: 18 | Train Loss: 0.667 Vali Loss: 1.637 Vali Acc: 0.557 Test Loss: 1.637 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.810084104537964
Epoch: 9, Steps: 18 | Train Loss: 0.406 Vali Loss: 1.509 Vali Acc: 0.563 Test Loss: 1.509 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.3644561767578125
Epoch: 10, Steps: 18 | Train Loss: 0.246 Vali Loss: 1.424 Vali Acc: 0.570 Test Loss: 1.424 Test Acc: 0.570
Validation loss decreased (-0.566649 --> -0.569986).  Saving model ...
Epoch: 11 cost time: 6.569879531860352
Epoch: 11, Steps: 18 | Train Loss: 0.153 Vali Loss: 1.362 Vali Acc: 0.583 Test Loss: 1.362 Test Acc: 0.583
Validation loss decreased (-0.569986 --> -0.583320).  Saving model ...
Epoch: 12 cost time: 6.4399333000183105
Epoch: 12, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.343 Vali Acc: 0.610 Test Loss: 1.343 Test Acc: 0.610
Validation loss decreased (-0.583320 --> -0.609987).  Saving model ...
Epoch: 13 cost time: 6.897783994674683
Epoch: 13, Steps: 18 | Train Loss: 0.072 Vali Loss: 1.314 Vali Acc: 0.600 Test Loss: 1.314 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.579719066619873
Epoch: 14, Steps: 18 | Train Loss: 0.056 Vali Loss: 1.282 Vali Acc: 0.587 Test Loss: 1.282 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.22114372253418
Epoch: 15, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.267 Vali Acc: 0.590 Test Loss: 1.267 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.035302639007568
Epoch: 16, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.259 Vali Acc: 0.600 Test Loss: 1.259 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.736247777938843
Epoch: 17, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.240 Vali Acc: 0.607 Test Loss: 1.240 Test Acc: 0.607
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.946136236190796
Epoch: 18, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.226 Vali Acc: 0.607 Test Loss: 1.226 Test Acc: 0.607
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.304708480834961
Epoch: 19, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.224 Vali Acc: 0.603 Test Loss: 1.224 Test Acc: 0.603
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.514350891113281
Epoch: 20, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.215 Vali Acc: 0.603 Test Loss: 1.215 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.856547594070435
Epoch: 21, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.188 Vali Acc: 0.617 Test Loss: 1.188 Test Acc: 0.617
Validation loss decreased (-0.609987 --> -0.616655).  Saving model ...
Epoch: 22 cost time: 6.660720586776733
Epoch: 22, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.188 Vali Acc: 0.617 Test Loss: 1.188 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.819644927978516
Epoch: 23, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.180 Vali Acc: 0.617 Test Loss: 1.180 Test Acc: 0.617
Validation loss decreased (-0.616655 --> -0.616655).  Saving model ...
Epoch: 24 cost time: 6.6018595695495605
Epoch: 24, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.174 Vali Acc: 0.620 Test Loss: 1.174 Test Acc: 0.620
Validation loss decreased (-0.616655 --> -0.619988).  Saving model ...
Epoch: 25 cost time: 6.320696115493774
Epoch: 25, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.164 Vali Acc: 0.617 Test Loss: 1.164 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.600376844406128
Epoch: 26, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.152 Vali Acc: 0.630 Test Loss: 1.152 Test Acc: 0.630
Validation loss decreased (-0.619988 --> -0.629988).  Saving model ...
Epoch: 27 cost time: 6.688977479934692
Epoch: 27, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.149 Vali Acc: 0.627 Test Loss: 1.149 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.407926797866821
Epoch: 28, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.140 Vali Acc: 0.623 Test Loss: 1.140 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.233595609664917
Epoch: 29, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.138 Vali Acc: 0.623 Test Loss: 1.138 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.623310565948486
Epoch: 30, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.132 Vali Acc: 0.620 Test Loss: 1.132 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.608027219772339
Epoch: 31, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.132 Vali Acc: 0.630 Test Loss: 1.132 Test Acc: 0.630
Validation loss decreased (-0.629988 --> -0.629989).  Saving model ...
Epoch: 32 cost time: 6.713640928268433
Epoch: 32, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.124 Vali Acc: 0.630 Test Loss: 1.124 Test Acc: 0.630
Validation loss decreased (-0.629989 --> -0.629989).  Saving model ...
Epoch: 33 cost time: 6.941858768463135
Epoch: 33, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.123 Vali Acc: 0.640 Test Loss: 1.123 Test Acc: 0.640
Validation loss decreased (-0.629989 --> -0.639989).  Saving model ...
Epoch: 34 cost time: 6.411767482757568
Epoch: 34, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.118 Vali Acc: 0.647 Test Loss: 1.118 Test Acc: 0.647
Validation loss decreased (-0.639989 --> -0.646655).  Saving model ...
Epoch: 35 cost time: 6.567831754684448
Epoch: 35, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.109 Vali Acc: 0.640 Test Loss: 1.109 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.394269943237305
Epoch: 36, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.106 Vali Acc: 0.643 Test Loss: 1.106 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 6.561971664428711
Epoch: 37, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.104 Vali Acc: 0.653 Test Loss: 1.104 Test Acc: 0.653
Validation loss decreased (-0.646655 --> -0.653322).  Saving model ...
Epoch: 38 cost time: 6.92138147354126
Epoch: 38, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.105 Vali Acc: 0.657 Test Loss: 1.105 Test Acc: 0.657
Validation loss decreased (-0.653322 --> -0.656656).  Saving model ...
Epoch: 39 cost time: 6.376912355422974
Epoch: 39, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.103 Vali Acc: 0.653 Test Loss: 1.103 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.616722106933594
Epoch: 40, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.100 Vali Acc: 0.653 Test Loss: 1.100 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.689615488052368
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.110 Vali Acc: 0.657 Test Loss: 1.110 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 6.552084922790527
Epoch: 42, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.110 Vali Acc: 0.653 Test Loss: 1.110 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 6.667935848236084
Epoch: 43, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.105 Vali Acc: 0.657 Test Loss: 1.105 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 6.520701885223389
Epoch: 44, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.095 Vali Acc: 0.663 Test Loss: 1.095 Test Acc: 0.663
Validation loss decreased (-0.656656 --> -0.663322).  Saving model ...
Epoch: 45 cost time: 6.649406671524048
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.087 Vali Acc: 0.663 Test Loss: 1.087 Test Acc: 0.663
Validation loss decreased (-0.663322 --> -0.663322).  Saving model ...
Epoch: 46 cost time: 6.164466619491577
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.088 Vali Acc: 0.660 Test Loss: 1.088 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.632602691650391
Epoch: 47, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.090 Vali Acc: 0.663 Test Loss: 1.090 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 6.276925563812256
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.088 Vali Acc: 0.663 Test Loss: 1.088 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 6.911510467529297
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.083 Vali Acc: 0.667 Test Loss: 1.083 Test Acc: 0.667
Validation loss decreased (-0.663322 --> -0.666656).  Saving model ...
Epoch: 50 cost time: 6.281430959701538
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.081 Vali Acc: 0.663 Test Loss: 1.081 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 6.674268960952759
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.078 Vali Acc: 0.663 Test Loss: 1.078 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 6.759485483169556
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.074 Vali Acc: 0.667 Test Loss: 1.074 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 53 cost time: 6.9769978523254395
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.078 Vali Acc: 0.670 Test Loss: 1.078 Test Acc: 0.670
Validation loss decreased (-0.666656 --> -0.669989).  Saving model ...
Epoch: 54 cost time: 6.415225267410278
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.080 Vali Acc: 0.670 Test Loss: 1.080 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 7.121432781219482
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.077 Vali Acc: 0.680 Test Loss: 1.077 Test Acc: 0.680
Validation loss decreased (-0.669989 --> -0.679989).  Saving model ...
Epoch: 56 cost time: 6.306895017623901
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.077 Vali Acc: 0.667 Test Loss: 1.077 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.323904991149902
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.673 Test Loss: 1.075 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 6.56149435043335
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.077 Vali Acc: 0.673 Test Loss: 1.077 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 6.506246328353882
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.677 Test Loss: 1.075 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 6.669035196304321
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.073 Vali Acc: 0.680 Test Loss: 1.073 Test Acc: 0.680
Validation loss decreased (-0.679989 --> -0.679989).  Saving model ...
Epoch: 61 cost time: 6.26900577545166
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.071 Vali Acc: 0.677 Test Loss: 1.071 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.433509826660156
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.070 Vali Acc: 0.673 Test Loss: 1.070 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 7.3430399894714355
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.071 Vali Acc: 0.673 Test Loss: 1.071 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 6.820555210113525
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.069 Vali Acc: 0.677 Test Loss: 1.069 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 6.439870357513428
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.067 Vali Acc: 0.677 Test Loss: 1.067 Test Acc: 0.677
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 6.776634931564331
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.066 Vali Acc: 0.677 Test Loss: 1.066 Test Acc: 0.677
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 7.603259325027466
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.064 Vali Acc: 0.680 Test Loss: 1.064 Test Acc: 0.680
Validation loss decreased (-0.679989 --> -0.679989).  Saving model ...
Epoch: 68 cost time: 6.871452331542969
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.062 Vali Acc: 0.677 Test Loss: 1.062 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.879928827285767
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.059 Vali Acc: 0.680 Test Loss: 1.059 Test Acc: 0.680
Validation loss decreased (-0.679989 --> -0.679989).  Saving model ...
Epoch: 70 cost time: 6.942052125930786
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.057 Vali Acc: 0.683 Test Loss: 1.057 Test Acc: 0.683
Validation loss decreased (-0.679989 --> -0.683323).  Saving model ...
Epoch: 71 cost time: 6.649825572967529
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.055 Vali Acc: 0.680 Test Loss: 1.055 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 7.003567218780518
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.053 Vali Acc: 0.680 Test Loss: 1.053 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.2388386726379395
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.052 Vali Acc: 0.680 Test Loss: 1.052 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 6.094092845916748
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.053 Vali Acc: 0.677 Test Loss: 1.053 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 6.476432800292969
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.050 Vali Acc: 0.677 Test Loss: 1.050 Test Acc: 0.677
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 6.514634132385254
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.049 Vali Acc: 0.677 Test Loss: 1.049 Test Acc: 0.677
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 6.54130744934082
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.047 Vali Acc: 0.680 Test Loss: 1.047 Test Acc: 0.680
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 6.418078184127808
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.680 Test Loss: 1.046 Test Acc: 0.680
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 6.6713645458221436
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.687 Test Loss: 1.045 Test Acc: 0.687
Validation loss decreased (-0.683323 --> -0.686656).  Saving model ...
Epoch: 80 cost time: 6.675999402999878
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.047 Vali Acc: 0.687 Test Loss: 1.047 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 6.606239318847656
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.052 Vali Acc: 0.680 Test Loss: 1.052 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 6.903555393218994
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.057 Vali Acc: 0.680 Test Loss: 1.057 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 7.0179102420806885
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.055 Vali Acc: 0.683 Test Loss: 1.055 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 7.405300140380859
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.052 Vali Acc: 0.680 Test Loss: 1.052 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 7.29853367805481
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.052 Vali Acc: 0.677 Test Loss: 1.052 Test Acc: 0.677
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 7.52290415763855
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.051 Vali Acc: 0.683 Test Loss: 1.051 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 7.3061583042144775
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.050 Vali Acc: 0.683 Test Loss: 1.050 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 7.4046876430511475
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.680 Test Loss: 1.050 Test Acc: 0.680
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 7.162328243255615
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.683 Test Loss: 1.048 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6866666666666666
model parameter : 355225
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.049538135528564
Epoch: 1, Steps: 18 | Train Loss: 3.291 Vali Loss: 3.234 Vali Acc: 0.050 Test Loss: 3.234 Test Acc: 0.050
Validation loss decreased (inf --> -0.049968).  Saving model ...
Epoch: 2 cost time: 6.75810980796814
Epoch: 2, Steps: 18 | Train Loss: 3.128 Vali Loss: 3.111 Vali Acc: 0.133 Test Loss: 3.111 Test Acc: 0.133
Validation loss decreased (-0.049968 --> -0.133302).  Saving model ...
Epoch: 3 cost time: 7.647193431854248
Epoch: 3, Steps: 18 | Train Loss: 2.877 Vali Loss: 2.982 Vali Acc: 0.177 Test Loss: 2.982 Test Acc: 0.177
Validation loss decreased (-0.133302 --> -0.176637).  Saving model ...
Epoch: 4 cost time: 6.760080575942993
Epoch: 4, Steps: 18 | Train Loss: 2.563 Vali Loss: 2.825 Vali Acc: 0.237 Test Loss: 2.825 Test Acc: 0.237
Validation loss decreased (-0.176637 --> -0.236638).  Saving model ...
Epoch: 5 cost time: 7.4055750370025635
Epoch: 5, Steps: 18 | Train Loss: 2.166 Vali Loss: 2.655 Vali Acc: 0.273 Test Loss: 2.655 Test Acc: 0.273
Validation loss decreased (-0.236638 --> -0.273307).  Saving model ...
Epoch: 6 cost time: 7.204644441604614
Epoch: 6, Steps: 18 | Train Loss: 1.746 Vali Loss: 2.501 Vali Acc: 0.310 Test Loss: 2.501 Test Acc: 0.310
Validation loss decreased (-0.273307 --> -0.309975).  Saving model ...
Epoch: 7 cost time: 6.796215295791626
Epoch: 7, Steps: 18 | Train Loss: 1.365 Vali Loss: 2.358 Vali Acc: 0.327 Test Loss: 2.358 Test Acc: 0.327
Validation loss decreased (-0.309975 --> -0.326643).  Saving model ...
Epoch: 8 cost time: 6.909300804138184
Epoch: 8, Steps: 18 | Train Loss: 0.995 Vali Loss: 2.240 Vali Acc: 0.337 Test Loss: 2.240 Test Acc: 0.337
Validation loss decreased (-0.326643 --> -0.336644).  Saving model ...
Epoch: 9 cost time: 7.0221168994903564
Epoch: 9, Steps: 18 | Train Loss: 0.697 Vali Loss: 2.136 Vali Acc: 0.387 Test Loss: 2.136 Test Acc: 0.387
Validation loss decreased (-0.336644 --> -0.386645).  Saving model ...
Epoch: 10 cost time: 7.040762424468994
Epoch: 10, Steps: 18 | Train Loss: 0.445 Vali Loss: 2.038 Vali Acc: 0.407 Test Loss: 2.038 Test Acc: 0.407
Validation loss decreased (-0.386645 --> -0.406646).  Saving model ...
Epoch: 11 cost time: 6.773536920547485
Epoch: 11, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.949 Vali Acc: 0.417 Test Loss: 1.949 Test Acc: 0.417
Validation loss decreased (-0.406646 --> -0.416647).  Saving model ...
Epoch: 12 cost time: 6.750170469284058
Epoch: 12, Steps: 18 | Train Loss: 0.177 Vali Loss: 1.894 Vali Acc: 0.427 Test Loss: 1.894 Test Acc: 0.427
Validation loss decreased (-0.416647 --> -0.426648).  Saving model ...
Epoch: 13 cost time: 6.667551517486572
Epoch: 13, Steps: 18 | Train Loss: 0.126 Vali Loss: 1.840 Vali Acc: 0.440 Test Loss: 1.840 Test Acc: 0.440
Validation loss decreased (-0.426648 --> -0.439982).  Saving model ...
Epoch: 14 cost time: 6.693785667419434
Epoch: 14, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.794 Vali Acc: 0.450 Test Loss: 1.794 Test Acc: 0.450
Validation loss decreased (-0.439982 --> -0.449982).  Saving model ...
Epoch: 15 cost time: 7.668989419937134
Epoch: 15, Steps: 18 | Train Loss: 0.067 Vali Loss: 1.753 Vali Acc: 0.483 Test Loss: 1.753 Test Acc: 0.483
Validation loss decreased (-0.449982 --> -0.483316).  Saving model ...
Epoch: 16 cost time: 6.921886920928955
Epoch: 16, Steps: 18 | Train Loss: 0.050 Vali Loss: 1.720 Vali Acc: 0.477 Test Loss: 1.720 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.133618593215942
Epoch: 17, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.672 Vali Acc: 0.493 Test Loss: 1.672 Test Acc: 0.493
Validation loss decreased (-0.483316 --> -0.493317).  Saving model ...
Epoch: 18 cost time: 7.116436719894409
Epoch: 18, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.645 Vali Acc: 0.520 Test Loss: 1.645 Test Acc: 0.520
Validation loss decreased (-0.493317 --> -0.519984).  Saving model ...
Epoch: 19 cost time: 7.065635442733765
Epoch: 19, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.632 Vali Acc: 0.533 Test Loss: 1.632 Test Acc: 0.533
Validation loss decreased (-0.519984 --> -0.533317).  Saving model ...
Epoch: 20 cost time: 7.650801181793213
Epoch: 20, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.610 Vali Acc: 0.527 Test Loss: 1.610 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.889001369476318
Epoch: 21, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.587 Vali Acc: 0.537 Test Loss: 1.587 Test Acc: 0.537
Validation loss decreased (-0.533317 --> -0.536651).  Saving model ...
Epoch: 22 cost time: 6.948696613311768
Epoch: 22, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.576 Vali Acc: 0.537 Test Loss: 1.576 Test Acc: 0.537
Validation loss decreased (-0.536651 --> -0.536651).  Saving model ...
Epoch: 23 cost time: 7.666538238525391
Epoch: 23, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.557 Vali Acc: 0.540 Test Loss: 1.557 Test Acc: 0.540
Validation loss decreased (-0.536651 --> -0.539984).  Saving model ...
Epoch: 24 cost time: 7.218573570251465
Epoch: 24, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.545 Vali Acc: 0.550 Test Loss: 1.545 Test Acc: 0.550
Validation loss decreased (-0.539984 --> -0.549985).  Saving model ...
Epoch: 25 cost time: 7.2042927742004395
Epoch: 25, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.532 Vali Acc: 0.557 Test Loss: 1.532 Test Acc: 0.557
Validation loss decreased (-0.549985 --> -0.556651).  Saving model ...
Epoch: 26 cost time: 7.411494255065918
Epoch: 26, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.526 Vali Acc: 0.560 Test Loss: 1.526 Test Acc: 0.560
Validation loss decreased (-0.556651 --> -0.559985).  Saving model ...
Epoch: 27 cost time: 6.850698232650757
Epoch: 27, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.513 Vali Acc: 0.567 Test Loss: 1.513 Test Acc: 0.567
Validation loss decreased (-0.559985 --> -0.566652).  Saving model ...
Epoch: 28 cost time: 6.183409214019775
Epoch: 28, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.505 Vali Acc: 0.557 Test Loss: 1.505 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.693732976913452
Epoch: 29, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.492 Vali Acc: 0.567 Test Loss: 1.492 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566652).  Saving model ...
Epoch: 30 cost time: 6.640094757080078
Epoch: 30, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.479 Vali Acc: 0.573 Test Loss: 1.479 Test Acc: 0.573
Validation loss decreased (-0.566652 --> -0.573319).  Saving model ...
Epoch: 31 cost time: 6.014643907546997
Epoch: 31, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.477 Vali Acc: 0.577 Test Loss: 1.477 Test Acc: 0.577
Validation loss decreased (-0.573319 --> -0.576652).  Saving model ...
Epoch: 32 cost time: 6.8228654861450195
Epoch: 32, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.467 Vali Acc: 0.570 Test Loss: 1.467 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.634382963180542
Epoch: 33, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.467 Vali Acc: 0.570 Test Loss: 1.467 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.8360536098480225
Epoch: 34, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.462 Vali Acc: 0.583 Test Loss: 1.462 Test Acc: 0.583
Validation loss decreased (-0.576652 --> -0.583319).  Saving model ...
Epoch: 35 cost time: 7.214635848999023
Epoch: 35, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.451 Vali Acc: 0.577 Test Loss: 1.451 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 7.193365573883057
Epoch: 36, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.441 Vali Acc: 0.587 Test Loss: 1.441 Test Acc: 0.587
Validation loss decreased (-0.583319 --> -0.586652).  Saving model ...
Epoch: 37 cost time: 7.058046340942383
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.441 Vali Acc: 0.587 Test Loss: 1.441 Test Acc: 0.587
Validation loss decreased (-0.586652 --> -0.586652).  Saving model ...
Epoch: 38 cost time: 6.7284767627716064
Epoch: 38, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.450 Vali Acc: 0.583 Test Loss: 1.450 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.5571448802948
Epoch: 39, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.439 Vali Acc: 0.590 Test Loss: 1.439 Test Acc: 0.590
Validation loss decreased (-0.586652 --> -0.589986).  Saving model ...
Epoch: 40 cost time: 6.976057529449463
Epoch: 40, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.433 Vali Acc: 0.600 Test Loss: 1.433 Test Acc: 0.600
Validation loss decreased (-0.589986 --> -0.599986).  Saving model ...
Epoch: 41 cost time: 6.6131205558776855
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.437 Vali Acc: 0.597 Test Loss: 1.437 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.5928544998168945
Epoch: 42, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.431 Vali Acc: 0.603 Test Loss: 1.431 Test Acc: 0.603
Validation loss decreased (-0.599986 --> -0.603319).  Saving model ...
Epoch: 43 cost time: 6.817134141921997
Epoch: 43, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.428 Vali Acc: 0.600 Test Loss: 1.428 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.74324107170105
Epoch: 44, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.420 Vali Acc: 0.607 Test Loss: 1.420 Test Acc: 0.607
Validation loss decreased (-0.603319 --> -0.606652).  Saving model ...
Epoch: 45 cost time: 6.73349404335022
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.414 Vali Acc: 0.603 Test Loss: 1.414 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.860708951950073
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.416 Vali Acc: 0.610 Test Loss: 1.416 Test Acc: 0.610
Validation loss decreased (-0.606652 --> -0.609986).  Saving model ...
Epoch: 47 cost time: 6.62568998336792
Epoch: 47, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.412 Vali Acc: 0.610 Test Loss: 1.412 Test Acc: 0.610
Validation loss decreased (-0.609986 --> -0.609986).  Saving model ...
Epoch: 48 cost time: 7.308372259140015
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.408 Vali Acc: 0.607 Test Loss: 1.408 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.998431205749512
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.400 Vali Acc: 0.620 Test Loss: 1.400 Test Acc: 0.620
Validation loss decreased (-0.609986 --> -0.619986).  Saving model ...
Epoch: 50 cost time: 6.428249835968018
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.399 Vali Acc: 0.623 Test Loss: 1.399 Test Acc: 0.623
Validation loss decreased (-0.619986 --> -0.623319).  Saving model ...
Epoch: 51 cost time: 7.3697545528411865
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.397 Vali Acc: 0.620 Test Loss: 1.397 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.874268293380737
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.397 Vali Acc: 0.620 Test Loss: 1.397 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 7.088115453720093
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.397 Vali Acc: 0.613 Test Loss: 1.397 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 6.995838403701782
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.392 Vali Acc: 0.613 Test Loss: 1.392 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 7.032012462615967
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.393 Vali Acc: 0.613 Test Loss: 1.393 Test Acc: 0.613
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 7.4152350425720215
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.394 Vali Acc: 0.617 Test Loss: 1.394 Test Acc: 0.617
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 7.449254274368286
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.617 Test Loss: 1.400 Test Acc: 0.617
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 6.771925210952759
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.404 Vali Acc: 0.627 Test Loss: 1.404 Test Acc: 0.627
Validation loss decreased (-0.623319 --> -0.626653).  Saving model ...
Epoch: 59 cost time: 7.359534025192261
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.401 Vali Acc: 0.617 Test Loss: 1.401 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 6.713755369186401
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.395 Vali Acc: 0.613 Test Loss: 1.395 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 7.295392990112305
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.389 Vali Acc: 0.627 Test Loss: 1.389 Test Acc: 0.627
Validation loss decreased (-0.626653 --> -0.626653).  Saving model ...
Epoch: 62 cost time: 7.075947046279907
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.385 Vali Acc: 0.630 Test Loss: 1.385 Test Acc: 0.630
Validation loss decreased (-0.626653 --> -0.629986).  Saving model ...
Epoch: 63 cost time: 6.566705942153931
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.380 Vali Acc: 0.630 Test Loss: 1.380 Test Acc: 0.630
Validation loss decreased (-0.629986 --> -0.629986).  Saving model ...
Epoch: 64 cost time: 6.549137115478516
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.633 Test Loss: 1.381 Test Acc: 0.633
Validation loss decreased (-0.629986 --> -0.633320).  Saving model ...
Epoch: 65 cost time: 6.796082019805908
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.633 Test Loss: 1.381 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 66 cost time: 7.348809003829956
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.382 Vali Acc: 0.630 Test Loss: 1.382 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 6.858503341674805
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.380 Vali Acc: 0.623 Test Loss: 1.380 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 7.513146877288818
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.633 Test Loss: 1.381 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 6.946173906326294
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.630 Test Loss: 1.379 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 8.125399112701416
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.376 Vali Acc: 0.630 Test Loss: 1.376 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 7.501910448074341
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.375 Vali Acc: 0.637 Test Loss: 1.375 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.636653).  Saving model ...
Epoch: 72 cost time: 7.3891730308532715
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.375 Vali Acc: 0.643 Test Loss: 1.375 Test Acc: 0.643
Validation loss decreased (-0.636653 --> -0.643320).  Saving model ...
Epoch: 73 cost time: 7.4738242626190186
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.374 Vali Acc: 0.637 Test Loss: 1.374 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 7.1679465770721436
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.373 Vali Acc: 0.637 Test Loss: 1.373 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 7.201004266738892
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.372 Vali Acc: 0.637 Test Loss: 1.372 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 6.89347505569458
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.377 Vali Acc: 0.633 Test Loss: 1.377 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 6.967425346374512
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.623 Test Loss: 1.381 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 6.892846584320068
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.375 Vali Acc: 0.637 Test Loss: 1.375 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 7.315638303756714
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.371 Vali Acc: 0.643 Test Loss: 1.371 Test Acc: 0.643
Validation loss decreased (-0.643320 --> -0.643320).  Saving model ...
Epoch: 80 cost time: 6.91395115852356
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.374 Vali Acc: 0.640 Test Loss: 1.374 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 7.2438178062438965
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.374 Vali Acc: 0.643 Test Loss: 1.374 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 7.058968544006348
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.375 Vali Acc: 0.630 Test Loss: 1.375 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 6.901186943054199
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.377 Vali Acc: 0.630 Test Loss: 1.377 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 7.369674444198608
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.630 Test Loss: 1.379 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 6.948745489120483
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.637 Test Loss: 1.379 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 7.320369005203247
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.376 Vali Acc: 0.637 Test Loss: 1.376 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 6.847606897354126
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.373 Vali Acc: 0.633 Test Loss: 1.373 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 7.462621688842773
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.630 Test Loss: 1.376 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 6.761715412139893
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.627 Test Loss: 1.376 Test Acc: 0.627
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6433333333333333
model parameter : 355225
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.9722020626068115
Epoch: 1, Steps: 18 | Train Loss: 3.283 Vali Loss: 3.239 Vali Acc: 0.063 Test Loss: 3.239 Test Acc: 0.063
Validation loss decreased (inf --> -0.063301).  Saving model ...
Epoch: 2 cost time: 6.931060314178467
Epoch: 2, Steps: 18 | Train Loss: 3.140 Vali Loss: 3.145 Vali Acc: 0.103 Test Loss: 3.145 Test Acc: 0.103
Validation loss decreased (-0.063301 --> -0.103302).  Saving model ...
Epoch: 3 cost time: 6.203608751296997
Epoch: 3, Steps: 18 | Train Loss: 2.929 Vali Loss: 3.049 Vali Acc: 0.127 Test Loss: 3.049 Test Acc: 0.127
Validation loss decreased (-0.103302 --> -0.126636).  Saving model ...
Epoch: 4 cost time: 6.42792272567749
Epoch: 4, Steps: 18 | Train Loss: 2.615 Vali Loss: 2.940 Vali Acc: 0.187 Test Loss: 2.940 Test Acc: 0.187
Validation loss decreased (-0.126636 --> -0.186637).  Saving model ...
Epoch: 5 cost time: 6.3857033252716064
Epoch: 5, Steps: 18 | Train Loss: 2.303 Vali Loss: 2.825 Vali Acc: 0.230 Test Loss: 2.825 Test Acc: 0.230
Validation loss decreased (-0.186637 --> -0.229972).  Saving model ...
Epoch: 6 cost time: 6.300982713699341
Epoch: 6, Steps: 18 | Train Loss: 1.899 Vali Loss: 2.724 Vali Acc: 0.250 Test Loss: 2.724 Test Acc: 0.250
Validation loss decreased (-0.229972 --> -0.249973).  Saving model ...
Epoch: 7 cost time: 6.531084775924683
Epoch: 7, Steps: 18 | Train Loss: 1.541 Vali Loss: 2.637 Vali Acc: 0.253 Test Loss: 2.637 Test Acc: 0.253
Validation loss decreased (-0.249973 --> -0.253307).  Saving model ...
Epoch: 8 cost time: 7.026184320449829
Epoch: 8, Steps: 18 | Train Loss: 1.182 Vali Loss: 2.560 Vali Acc: 0.273 Test Loss: 2.560 Test Acc: 0.273
Validation loss decreased (-0.253307 --> -0.273308).  Saving model ...
Epoch: 9 cost time: 6.073705434799194
Epoch: 9, Steps: 18 | Train Loss: 0.872 Vali Loss: 2.485 Vali Acc: 0.280 Test Loss: 2.485 Test Acc: 0.280
Validation loss decreased (-0.273308 --> -0.279975).  Saving model ...
Epoch: 10 cost time: 6.620004415512085
Epoch: 10, Steps: 18 | Train Loss: 0.603 Vali Loss: 2.420 Vali Acc: 0.287 Test Loss: 2.420 Test Acc: 0.287
Validation loss decreased (-0.279975 --> -0.286642).  Saving model ...
Epoch: 11 cost time: 6.45565390586853
Epoch: 11, Steps: 18 | Train Loss: 0.388 Vali Loss: 2.364 Vali Acc: 0.273 Test Loss: 2.364 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.382864952087402
Epoch: 12, Steps: 18 | Train Loss: 0.251 Vali Loss: 2.305 Vali Acc: 0.320 Test Loss: 2.305 Test Acc: 0.320
Validation loss decreased (-0.286642 --> -0.319977).  Saving model ...
Epoch: 13 cost time: 6.4069883823394775
Epoch: 13, Steps: 18 | Train Loss: 0.179 Vali Loss: 2.264 Vali Acc: 0.323 Test Loss: 2.264 Test Acc: 0.323
Validation loss decreased (-0.319977 --> -0.323311).  Saving model ...
Epoch: 14 cost time: 6.9865007400512695
Epoch: 14, Steps: 18 | Train Loss: 0.126 Vali Loss: 2.231 Vali Acc: 0.307 Test Loss: 2.231 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.619060516357422
Epoch: 15, Steps: 18 | Train Loss: 0.088 Vali Loss: 2.175 Vali Acc: 0.333 Test Loss: 2.175 Test Acc: 0.333
Validation loss decreased (-0.323311 --> -0.333312).  Saving model ...
Epoch: 16 cost time: 6.552914619445801
Epoch: 16, Steps: 18 | Train Loss: 0.061 Vali Loss: 2.153 Vali Acc: 0.353 Test Loss: 2.153 Test Acc: 0.353
Validation loss decreased (-0.333312 --> -0.353312).  Saving model ...
Epoch: 17 cost time: 6.609213829040527
Epoch: 17, Steps: 18 | Train Loss: 0.048 Vali Loss: 2.119 Vali Acc: 0.353 Test Loss: 2.119 Test Acc: 0.353
Validation loss decreased (-0.353312 --> -0.353312).  Saving model ...
Epoch: 18 cost time: 6.48234748840332
Epoch: 18, Steps: 18 | Train Loss: 0.040 Vali Loss: 2.089 Vali Acc: 0.367 Test Loss: 2.089 Test Acc: 0.367
Validation loss decreased (-0.353312 --> -0.366646).  Saving model ...
Epoch: 19 cost time: 6.417367696762085
Epoch: 19, Steps: 18 | Train Loss: 0.036 Vali Loss: 2.061 Vali Acc: 0.387 Test Loss: 2.061 Test Acc: 0.387
Validation loss decreased (-0.366646 --> -0.386646).  Saving model ...
Epoch: 20 cost time: 6.605290412902832
Epoch: 20, Steps: 18 | Train Loss: 0.030 Vali Loss: 2.027 Vali Acc: 0.390 Test Loss: 2.027 Test Acc: 0.390
Validation loss decreased (-0.386646 --> -0.389980).  Saving model ...
Epoch: 21 cost time: 6.6611034870147705
Epoch: 21, Steps: 18 | Train Loss: 0.025 Vali Loss: 2.001 Vali Acc: 0.400 Test Loss: 2.001 Test Acc: 0.400
Validation loss decreased (-0.389980 --> -0.399980).  Saving model ...
Epoch: 22 cost time: 6.509044408798218
Epoch: 22, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.992 Vali Acc: 0.403 Test Loss: 1.992 Test Acc: 0.403
Validation loss decreased (-0.399980 --> -0.403313).  Saving model ...
Epoch: 23 cost time: 6.522324085235596
Epoch: 23, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.972 Vali Acc: 0.413 Test Loss: 1.972 Test Acc: 0.413
Validation loss decreased (-0.403313 --> -0.413314).  Saving model ...
Epoch: 24 cost time: 6.6431427001953125
Epoch: 24, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.944 Vali Acc: 0.423 Test Loss: 1.944 Test Acc: 0.423
Validation loss decreased (-0.413314 --> -0.423314).  Saving model ...
Epoch: 25 cost time: 6.360839128494263
Epoch: 25, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.920 Vali Acc: 0.433 Test Loss: 1.920 Test Acc: 0.433
Validation loss decreased (-0.423314 --> -0.433314).  Saving model ...
Epoch: 26 cost time: 6.7705979347229
Epoch: 26, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.910 Vali Acc: 0.423 Test Loss: 1.910 Test Acc: 0.423
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.0474231243133545
Epoch: 27, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.894 Vali Acc: 0.423 Test Loss: 1.894 Test Acc: 0.423
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.692923545837402
Epoch: 28, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.874 Vali Acc: 0.450 Test Loss: 1.874 Test Acc: 0.450
Validation loss decreased (-0.433314 --> -0.449981).  Saving model ...
Epoch: 29 cost time: 6.969990015029907
Epoch: 29, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.858 Vali Acc: 0.457 Test Loss: 1.858 Test Acc: 0.457
Validation loss decreased (-0.449981 --> -0.456648).  Saving model ...
Epoch: 30 cost time: 6.5499043464660645
Epoch: 30, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.853 Vali Acc: 0.463 Test Loss: 1.853 Test Acc: 0.463
Validation loss decreased (-0.456648 --> -0.463315).  Saving model ...
Epoch: 31 cost time: 6.504599332809448
Epoch: 31, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.843 Vali Acc: 0.467 Test Loss: 1.843 Test Acc: 0.467
Validation loss decreased (-0.463315 --> -0.466648).  Saving model ...
Epoch: 32 cost time: 6.624431848526001
Epoch: 32, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.820 Vali Acc: 0.473 Test Loss: 1.820 Test Acc: 0.473
Validation loss decreased (-0.466648 --> -0.473315).  Saving model ...
Epoch: 33 cost time: 6.759889364242554
Epoch: 33, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.821 Vali Acc: 0.467 Test Loss: 1.821 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.158959150314331
Epoch: 34, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.806 Vali Acc: 0.470 Test Loss: 1.806 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.36624002456665
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.791 Vali Acc: 0.477 Test Loss: 1.791 Test Acc: 0.477
Validation loss decreased (-0.473315 --> -0.476649).  Saving model ...
Epoch: 36 cost time: 6.342331409454346
Epoch: 36, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.786 Vali Acc: 0.483 Test Loss: 1.786 Test Acc: 0.483
Validation loss decreased (-0.476649 --> -0.483315).  Saving model ...
Epoch: 37 cost time: 6.607698440551758
Epoch: 37, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.801 Vali Acc: 0.470 Test Loss: 1.801 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.375539302825928
Epoch: 38, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.784 Vali Acc: 0.483 Test Loss: 1.784 Test Acc: 0.483
Validation loss decreased (-0.483315 --> -0.483315).  Saving model ...
Epoch: 39 cost time: 6.160985708236694
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.769 Vali Acc: 0.490 Test Loss: 1.769 Test Acc: 0.490
Validation loss decreased (-0.483315 --> -0.489982).  Saving model ...
Epoch: 40 cost time: 6.612140893936157
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.751 Vali Acc: 0.483 Test Loss: 1.751 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.932390928268433
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.753 Vali Acc: 0.487 Test Loss: 1.753 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.526057243347168
Epoch: 42, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.750 Vali Acc: 0.480 Test Loss: 1.750 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.211272954940796
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.742 Vali Acc: 0.487 Test Loss: 1.742 Test Acc: 0.487
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.446564674377441
Epoch: 44, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.725 Vali Acc: 0.490 Test Loss: 1.725 Test Acc: 0.490
Validation loss decreased (-0.489982 --> -0.489983).  Saving model ...
Epoch: 45 cost time: 5.936707019805908
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.718 Vali Acc: 0.490 Test Loss: 1.718 Test Acc: 0.490
Validation loss decreased (-0.489983 --> -0.489983).  Saving model ...
Epoch: 46 cost time: 6.17546010017395
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.717 Vali Acc: 0.483 Test Loss: 1.717 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.364076137542725
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.712 Vali Acc: 0.487 Test Loss: 1.712 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 6.522448539733887
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.709 Vali Acc: 0.490 Test Loss: 1.709 Test Acc: 0.490
Validation loss decreased (-0.489983 --> -0.489983).  Saving model ...
Epoch: 49 cost time: 6.7269065380096436
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.689 Vali Acc: 0.500 Test Loss: 1.689 Test Acc: 0.500
Validation loss decreased (-0.489983 --> -0.499983).  Saving model ...
Epoch: 50 cost time: 6.781646966934204
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.681 Vali Acc: 0.513 Test Loss: 1.681 Test Acc: 0.513
Validation loss decreased (-0.499983 --> -0.513317).  Saving model ...
Epoch: 51 cost time: 6.7815306186676025
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.678 Vali Acc: 0.500 Test Loss: 1.678 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 7.49141001701355
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.673 Vali Acc: 0.507 Test Loss: 1.673 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.9576756954193115
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.671 Vali Acc: 0.510 Test Loss: 1.671 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 6.864977121353149
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.669 Vali Acc: 0.507 Test Loss: 1.669 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 6.21380615234375
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.669 Vali Acc: 0.513 Test Loss: 1.669 Test Acc: 0.513
Validation loss decreased (-0.513317 --> -0.513317).  Saving model ...
Epoch: 56 cost time: 6.3229193687438965
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.661 Vali Acc: 0.523 Test Loss: 1.661 Test Acc: 0.523
Validation loss decreased (-0.513317 --> -0.523317).  Saving model ...
Epoch: 57 cost time: 6.083127021789551
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.661 Vali Acc: 0.520 Test Loss: 1.661 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.105749607086182
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.655 Vali Acc: 0.523 Test Loss: 1.655 Test Acc: 0.523
Validation loss decreased (-0.523317 --> -0.523317).  Saving model ...
Epoch: 59 cost time: 6.503661870956421
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.653 Vali Acc: 0.530 Test Loss: 1.653 Test Acc: 0.530
Validation loss decreased (-0.523317 --> -0.529983).  Saving model ...
Epoch: 60 cost time: 6.0031514167785645
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.641 Vali Acc: 0.533 Test Loss: 1.641 Test Acc: 0.533
Validation loss decreased (-0.529983 --> -0.533317).  Saving model ...
Epoch: 61 cost time: 6.359600782394409
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.636 Vali Acc: 0.540 Test Loss: 1.636 Test Acc: 0.540
Validation loss decreased (-0.533317 --> -0.539984).  Saving model ...
Epoch: 62 cost time: 6.298395872116089
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.627 Vali Acc: 0.547 Test Loss: 1.627 Test Acc: 0.547
Validation loss decreased (-0.539984 --> -0.546650).  Saving model ...
Epoch: 63 cost time: 6.315336227416992
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.630 Vali Acc: 0.543 Test Loss: 1.630 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.9991936683654785
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.629 Vali Acc: 0.533 Test Loss: 1.629 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 6.336201906204224
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.622 Vali Acc: 0.543 Test Loss: 1.622 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 6.1562659740448
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.553 Test Loss: 1.619 Test Acc: 0.553
Validation loss decreased (-0.546650 --> -0.553317).  Saving model ...
Epoch: 67 cost time: 6.2360618114471436
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.615 Vali Acc: 0.560 Test Loss: 1.615 Test Acc: 0.560
Validation loss decreased (-0.553317 --> -0.559984).  Saving model ...
Epoch: 68 cost time: 6.155773639678955
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.605 Vali Acc: 0.557 Test Loss: 1.605 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.621175289154053
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.550 Test Loss: 1.600 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 6.4656360149383545
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.593 Vali Acc: 0.557 Test Loss: 1.593 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 6.512234926223755
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.590 Vali Acc: 0.550 Test Loss: 1.590 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 6.524464130401611
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.587 Vali Acc: 0.553 Test Loss: 1.587 Test Acc: 0.553
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 6.324914216995239
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.587 Vali Acc: 0.560 Test Loss: 1.587 Test Acc: 0.560
Validation loss decreased (-0.559984 --> -0.559984).  Saving model ...
Epoch: 74 cost time: 6.628655433654785
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.591 Vali Acc: 0.560 Test Loss: 1.591 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 6.891516923904419
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.590 Vali Acc: 0.563 Test Loss: 1.590 Test Acc: 0.563
Validation loss decreased (-0.559984 --> -0.563317).  Saving model ...
Epoch: 76 cost time: 6.785048484802246
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.590 Vali Acc: 0.560 Test Loss: 1.590 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 6.5922462940216064
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.586 Vali Acc: 0.553 Test Loss: 1.586 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 6.652567148208618
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.580 Vali Acc: 0.557 Test Loss: 1.580 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 6.898760557174683
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.578 Vali Acc: 0.557 Test Loss: 1.578 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 6.3092968463897705
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.572 Vali Acc: 0.563 Test Loss: 1.572 Test Acc: 0.563
Validation loss decreased (-0.563317 --> -0.563318).  Saving model ...
Epoch: 81 cost time: 6.560553789138794
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.568 Vali Acc: 0.563 Test Loss: 1.568 Test Acc: 0.563
Validation loss decreased (-0.563318 --> -0.563318).  Saving model ...
Epoch: 82 cost time: 6.286668062210083
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.570 Test Loss: 1.566 Test Acc: 0.570
Validation loss decreased (-0.563318 --> -0.569984).  Saving model ...
Epoch: 83 cost time: 6.131757020950317
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.565 Vali Acc: 0.570 Test Loss: 1.565 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 84 cost time: 6.585972785949707
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.565 Vali Acc: 0.570 Test Loss: 1.565 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 6.682349443435669
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.561 Vali Acc: 0.573 Test Loss: 1.561 Test Acc: 0.573
Validation loss decreased (-0.569984 --> -0.573318).  Saving model ...
Epoch: 86 cost time: 6.575395345687866
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.559 Vali Acc: 0.573 Test Loss: 1.559 Test Acc: 0.573
Validation loss decreased (-0.573318 --> -0.573318).  Saving model ...
Epoch: 87 cost time: 6.725123643875122
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.555 Vali Acc: 0.580 Test Loss: 1.555 Test Acc: 0.580
Validation loss decreased (-0.573318 --> -0.579984).  Saving model ...
Epoch: 88 cost time: 6.788716793060303
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.554 Vali Acc: 0.587 Test Loss: 1.554 Test Acc: 0.587
Validation loss decreased (-0.579984 --> -0.586651).  Saving model ...
Epoch: 89 cost time: 6.530906438827515
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.552 Vali Acc: 0.583 Test Loss: 1.552 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 6.169065713882446
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.556 Vali Acc: 0.580 Test Loss: 1.556 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 7.259232997894287
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.554 Vali Acc: 0.573 Test Loss: 1.554 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 7.064406156539917
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.553 Vali Acc: 0.577 Test Loss: 1.553 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 7.141341924667358
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.573 Test Loss: 1.551 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 7.117326974868774
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.549 Vali Acc: 0.573 Test Loss: 1.549 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 6.3837926387786865
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.547 Vali Acc: 0.577 Test Loss: 1.547 Test Acc: 0.577
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 7.133492708206177
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.573 Test Loss: 1.541 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 7.267184734344482
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.537 Vali Acc: 0.573 Test Loss: 1.537 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 7.324726104736328
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.580 Test Loss: 1.540 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5866666666666667
model parameter : 355225
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.514492511749268
Epoch: 1, Steps: 18 | Train Loss: 3.297 Vali Loss: 3.251 Vali Acc: 0.070 Test Loss: 3.251 Test Acc: 0.070
Validation loss decreased (inf --> -0.069967).  Saving model ...
Epoch: 2 cost time: 6.6781299114227295
Epoch: 2, Steps: 18 | Train Loss: 3.148 Vali Loss: 3.201 Vali Acc: 0.070 Test Loss: 3.201 Test Acc: 0.070
Validation loss decreased (-0.069967 --> -0.069968).  Saving model ...
Epoch: 3 cost time: 7.0167396068573
Epoch: 3, Steps: 18 | Train Loss: 2.922 Vali Loss: 3.141 Vali Acc: 0.103 Test Loss: 3.141 Test Acc: 0.103
Validation loss decreased (-0.069968 --> -0.103302).  Saving model ...
Epoch: 4 cost time: 6.7976086139678955
Epoch: 4, Steps: 18 | Train Loss: 2.699 Vali Loss: 3.069 Vali Acc: 0.137 Test Loss: 3.069 Test Acc: 0.137
Validation loss decreased (-0.103302 --> -0.136636).  Saving model ...
Epoch: 5 cost time: 6.305014610290527
Epoch: 5, Steps: 18 | Train Loss: 2.401 Vali Loss: 3.005 Vali Acc: 0.150 Test Loss: 3.005 Test Acc: 0.150
Validation loss decreased (-0.136636 --> -0.149970).  Saving model ...
Epoch: 6 cost time: 6.699316024780273
Epoch: 6, Steps: 18 | Train Loss: 2.041 Vali Loss: 2.954 Vali Acc: 0.137 Test Loss: 2.954 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.905136585235596
Epoch: 7, Steps: 18 | Train Loss: 1.723 Vali Loss: 2.900 Vali Acc: 0.163 Test Loss: 2.900 Test Acc: 0.163
Validation loss decreased (-0.149970 --> -0.163304).  Saving model ...
Epoch: 8 cost time: 6.710653066635132
Epoch: 8, Steps: 18 | Train Loss: 1.400 Vali Loss: 2.836 Vali Acc: 0.177 Test Loss: 2.836 Test Acc: 0.177
Validation loss decreased (-0.163304 --> -0.176638).  Saving model ...
Epoch: 9 cost time: 7.156954765319824
Epoch: 9, Steps: 18 | Train Loss: 1.092 Vali Loss: 2.777 Vali Acc: 0.177 Test Loss: 2.777 Test Acc: 0.177
Validation loss decreased (-0.176638 --> -0.176639).  Saving model ...
Epoch: 10 cost time: 7.3547515869140625
Epoch: 10, Steps: 18 | Train Loss: 0.818 Vali Loss: 2.726 Vali Acc: 0.210 Test Loss: 2.726 Test Acc: 0.210
Validation loss decreased (-0.176639 --> -0.209973).  Saving model ...
Epoch: 11 cost time: 7.002624273300171
Epoch: 11, Steps: 18 | Train Loss: 0.585 Vali Loss: 2.676 Vali Acc: 0.227 Test Loss: 2.676 Test Acc: 0.227
Validation loss decreased (-0.209973 --> -0.226640).  Saving model ...
Epoch: 12 cost time: 7.461757659912109
Epoch: 12, Steps: 18 | Train Loss: 0.403 Vali Loss: 2.628 Vali Acc: 0.230 Test Loss: 2.628 Test Acc: 0.230
Validation loss decreased (-0.226640 --> -0.229974).  Saving model ...
Epoch: 13 cost time: 6.889308929443359
Epoch: 13, Steps: 18 | Train Loss: 0.284 Vali Loss: 2.567 Vali Acc: 0.257 Test Loss: 2.567 Test Acc: 0.257
Validation loss decreased (-0.229974 --> -0.256641).  Saving model ...
Epoch: 14 cost time: 7.292733669281006
Epoch: 14, Steps: 18 | Train Loss: 0.179 Vali Loss: 2.537 Vali Acc: 0.250 Test Loss: 2.537 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.28831672668457
Epoch: 15, Steps: 18 | Train Loss: 0.126 Vali Loss: 2.452 Vali Acc: 0.273 Test Loss: 2.452 Test Acc: 0.273
Validation loss decreased (-0.256641 --> -0.273309).  Saving model ...
Epoch: 16 cost time: 6.601041793823242
Epoch: 16, Steps: 18 | Train Loss: 0.089 Vali Loss: 2.438 Vali Acc: 0.270 Test Loss: 2.438 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.659960508346558
Epoch: 17, Steps: 18 | Train Loss: 0.073 Vali Loss: 2.401 Vali Acc: 0.287 Test Loss: 2.401 Test Acc: 0.287
Validation loss decreased (-0.273309 --> -0.286643).  Saving model ...
Epoch: 18 cost time: 6.472229957580566
Epoch: 18, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.352 Vali Acc: 0.297 Test Loss: 2.352 Test Acc: 0.297
Validation loss decreased (-0.286643 --> -0.296643).  Saving model ...
Epoch: 19 cost time: 6.366162538528442
Epoch: 19, Steps: 18 | Train Loss: 0.054 Vali Loss: 2.320 Vali Acc: 0.313 Test Loss: 2.320 Test Acc: 0.313
Validation loss decreased (-0.296643 --> -0.313310).  Saving model ...
Epoch: 20 cost time: 6.473316192626953
Epoch: 20, Steps: 18 | Train Loss: 0.041 Vali Loss: 2.307 Vali Acc: 0.317 Test Loss: 2.307 Test Acc: 0.317
Validation loss decreased (-0.313310 --> -0.316644).  Saving model ...
Epoch: 21 cost time: 6.202164888381958
Epoch: 21, Steps: 18 | Train Loss: 0.035 Vali Loss: 2.251 Vali Acc: 0.337 Test Loss: 2.251 Test Acc: 0.337
Validation loss decreased (-0.316644 --> -0.336644).  Saving model ...
Epoch: 22 cost time: 7.006687641143799
Epoch: 22, Steps: 18 | Train Loss: 0.028 Vali Loss: 2.233 Vali Acc: 0.340 Test Loss: 2.233 Test Acc: 0.340
Validation loss decreased (-0.336644 --> -0.339978).  Saving model ...
Epoch: 23 cost time: 6.728976249694824
Epoch: 23, Steps: 18 | Train Loss: 0.025 Vali Loss: 2.210 Vali Acc: 0.343 Test Loss: 2.210 Test Acc: 0.343
Validation loss decreased (-0.339978 --> -0.343311).  Saving model ...
Epoch: 24 cost time: 6.804946660995483
Epoch: 24, Steps: 18 | Train Loss: 0.021 Vali Loss: 2.164 Vali Acc: 0.360 Test Loss: 2.164 Test Acc: 0.360
Validation loss decreased (-0.343311 --> -0.359978).  Saving model ...
Epoch: 25 cost time: 7.094762563705444
Epoch: 25, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.147 Vali Acc: 0.360 Test Loss: 2.147 Test Acc: 0.360
Validation loss decreased (-0.359978 --> -0.359979).  Saving model ...
Epoch: 26 cost time: 6.502102613449097
Epoch: 26, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.140 Vali Acc: 0.357 Test Loss: 2.140 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.725494623184204
Epoch: 27, Steps: 18 | Train Loss: 0.016 Vali Loss: 2.126 Vali Acc: 0.370 Test Loss: 2.126 Test Acc: 0.370
Validation loss decreased (-0.359979 --> -0.369979).  Saving model ...
Epoch: 28 cost time: 6.4632322788238525
Epoch: 28, Steps: 18 | Train Loss: 0.014 Vali Loss: 2.100 Vali Acc: 0.380 Test Loss: 2.100 Test Acc: 0.380
Validation loss decreased (-0.369979 --> -0.379979).  Saving model ...
Epoch: 29 cost time: 6.3480448722839355
Epoch: 29, Steps: 18 | Train Loss: 0.013 Vali Loss: 2.095 Vali Acc: 0.390 Test Loss: 2.095 Test Acc: 0.390
Validation loss decreased (-0.379979 --> -0.389979).  Saving model ...
Epoch: 30 cost time: 6.639894962310791
Epoch: 30, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.092 Vali Acc: 0.380 Test Loss: 2.092 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.340766906738281
Epoch: 31, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.073 Vali Acc: 0.407 Test Loss: 2.073 Test Acc: 0.407
Validation loss decreased (-0.389979 --> -0.406646).  Saving model ...
Epoch: 32 cost time: 6.256814241409302
Epoch: 32, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.049 Vali Acc: 0.407 Test Loss: 2.049 Test Acc: 0.407
Validation loss decreased (-0.406646 --> -0.406646).  Saving model ...
Epoch: 33 cost time: 6.684910774230957
Epoch: 33, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.061 Vali Acc: 0.397 Test Loss: 2.061 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.536098003387451
Epoch: 34, Steps: 18 | Train Loss: 0.009 Vali Loss: 2.053 Vali Acc: 0.410 Test Loss: 2.053 Test Acc: 0.410
Validation loss decreased (-0.406646 --> -0.409979).  Saving model ...
Epoch: 35 cost time: 7.167349100112915
Epoch: 35, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.045 Vali Acc: 0.413 Test Loss: 2.045 Test Acc: 0.413
Validation loss decreased (-0.409979 --> -0.413313).  Saving model ...
Epoch: 36 cost time: 7.536855936050415
Epoch: 36, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.031 Vali Acc: 0.420 Test Loss: 2.031 Test Acc: 0.420
Validation loss decreased (-0.413313 --> -0.419980).  Saving model ...
Epoch: 37 cost time: 6.726093053817749
Epoch: 37, Steps: 18 | Train Loss: 0.007 Vali Loss: 2.016 Vali Acc: 0.423 Test Loss: 2.016 Test Acc: 0.423
Validation loss decreased (-0.419980 --> -0.423313).  Saving model ...
Epoch: 38 cost time: 7.77133321762085
Epoch: 38, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.999 Vali Acc: 0.443 Test Loss: 1.999 Test Acc: 0.443
Validation loss decreased (-0.423313 --> -0.443313).  Saving model ...
Epoch: 39 cost time: 6.521279811859131
Epoch: 39, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.994 Vali Acc: 0.440 Test Loss: 1.994 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.970010042190552
Epoch: 40, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.975 Vali Acc: 0.443 Test Loss: 1.975 Test Acc: 0.443
Validation loss decreased (-0.443313 --> -0.443314).  Saving model ...
Epoch: 41 cost time: 6.5864739418029785
Epoch: 41, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.028 Vali Acc: 0.427 Test Loss: 2.028 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.3327789306640625
Epoch: 42, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.996 Vali Acc: 0.430 Test Loss: 1.996 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 6.777450323104858
Epoch: 43, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.970 Vali Acc: 0.450 Test Loss: 1.970 Test Acc: 0.450
Validation loss decreased (-0.443314 --> -0.449980).  Saving model ...
Epoch: 44 cost time: 6.339185476303101
Epoch: 44, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.958 Vali Acc: 0.453 Test Loss: 1.958 Test Acc: 0.453
Validation loss decreased (-0.449980 --> -0.453314).  Saving model ...
Epoch: 45 cost time: 6.492525815963745
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.943 Vali Acc: 0.447 Test Loss: 1.943 Test Acc: 0.447
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.431023836135864
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.940 Vali Acc: 0.453 Test Loss: 1.940 Test Acc: 0.453
Validation loss decreased (-0.453314 --> -0.453314).  Saving model ...
Epoch: 47 cost time: 7.218667268753052
Epoch: 47, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.934 Vali Acc: 0.450 Test Loss: 1.934 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 6.5052361488342285
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.935 Vali Acc: 0.457 Test Loss: 1.935 Test Acc: 0.457
Validation loss decreased (-0.453314 --> -0.456647).  Saving model ...
Epoch: 49 cost time: 6.824855089187622
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.925 Vali Acc: 0.470 Test Loss: 1.925 Test Acc: 0.470
Validation loss decreased (-0.456647 --> -0.469981).  Saving model ...
Epoch: 50 cost time: 6.675443887710571
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.913 Vali Acc: 0.473 Test Loss: 1.913 Test Acc: 0.473
Validation loss decreased (-0.469981 --> -0.473314).  Saving model ...
Epoch: 51 cost time: 6.917509078979492
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.910 Vali Acc: 0.470 Test Loss: 1.910 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.690601587295532
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.909 Vali Acc: 0.467 Test Loss: 1.909 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.440312385559082
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.897 Vali Acc: 0.470 Test Loss: 1.897 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 6.681716203689575
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.890 Vali Acc: 0.490 Test Loss: 1.890 Test Acc: 0.490
Validation loss decreased (-0.473314 --> -0.489981).  Saving model ...
Epoch: 55 cost time: 6.526926279067993
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.890 Vali Acc: 0.483 Test Loss: 1.890 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 6.456646680831909
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.890 Vali Acc: 0.487 Test Loss: 1.890 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 6.282339572906494
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.888 Vali Acc: 0.490 Test Loss: 1.888 Test Acc: 0.490
Validation loss decreased (-0.489981 --> -0.489981).  Saving model ...
Epoch: 58 cost time: 6.363588094711304
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.878 Vali Acc: 0.493 Test Loss: 1.878 Test Acc: 0.493
Validation loss decreased (-0.489981 --> -0.493315).  Saving model ...
Epoch: 59 cost time: 7.196726560592651
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.877 Vali Acc: 0.487 Test Loss: 1.877 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 6.490750312805176
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.868 Vali Acc: 0.490 Test Loss: 1.868 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 7.065085172653198
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.857 Vali Acc: 0.490 Test Loss: 1.857 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 6.875208616256714
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.855 Vali Acc: 0.500 Test Loss: 1.855 Test Acc: 0.500
Validation loss decreased (-0.493315 --> -0.499981).  Saving model ...
Epoch: 63 cost time: 6.327150344848633
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.854 Vali Acc: 0.497 Test Loss: 1.854 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 5.989727020263672
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.852 Vali Acc: 0.503 Test Loss: 1.852 Test Acc: 0.503
Validation loss decreased (-0.499981 --> -0.503315).  Saving model ...
Epoch: 65 cost time: 6.910891532897949
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.844 Vali Acc: 0.507 Test Loss: 1.844 Test Acc: 0.507
Validation loss decreased (-0.503315 --> -0.506648).  Saving model ...
Epoch: 66 cost time: 6.711583852767944
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.839 Vali Acc: 0.510 Test Loss: 1.839 Test Acc: 0.510
Validation loss decreased (-0.506648 --> -0.509982).  Saving model ...
Epoch: 67 cost time: 6.217066049575806
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.833 Vali Acc: 0.510 Test Loss: 1.833 Test Acc: 0.510
Validation loss decreased (-0.509982 --> -0.509982).  Saving model ...
Epoch: 68 cost time: 6.762423038482666
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.832 Vali Acc: 0.510 Test Loss: 1.832 Test Acc: 0.510
Validation loss decreased (-0.509982 --> -0.509982).  Saving model ...
Epoch: 69 cost time: 6.313159704208374
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.517 Test Loss: 1.830 Test Acc: 0.517
Validation loss decreased (-0.509982 --> -0.516648).  Saving model ...
Epoch: 70 cost time: 6.866077661514282
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.829 Vali Acc: 0.517 Test Loss: 1.829 Test Acc: 0.517
Validation loss decreased (-0.516648 --> -0.516648).  Saving model ...
Epoch: 71 cost time: 7.179563760757446
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.831 Vali Acc: 0.523 Test Loss: 1.831 Test Acc: 0.523
Validation loss decreased (-0.516648 --> -0.523315).  Saving model ...
Epoch: 72 cost time: 6.502280950546265
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.829 Vali Acc: 0.523 Test Loss: 1.829 Test Acc: 0.523
Validation loss decreased (-0.523315 --> -0.523315).  Saving model ...
Epoch: 73 cost time: 6.872645616531372
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.821 Vali Acc: 0.517 Test Loss: 1.821 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 6.804210662841797
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.821 Vali Acc: 0.533 Test Loss: 1.821 Test Acc: 0.533
Validation loss decreased (-0.523315 --> -0.533315).  Saving model ...
Epoch: 75 cost time: 6.566445589065552
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.817 Vali Acc: 0.520 Test Loss: 1.817 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 6.447484731674194
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.813 Vali Acc: 0.530 Test Loss: 1.813 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 6.825959920883179
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.807 Vali Acc: 0.527 Test Loss: 1.807 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 6.459805727005005
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.807 Vali Acc: 0.527 Test Loss: 1.807 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 6.716593503952026
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.808 Vali Acc: 0.530 Test Loss: 1.808 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 6.495420694351196
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.804 Vali Acc: 0.530 Test Loss: 1.804 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 6.4809839725494385
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.799 Vali Acc: 0.533 Test Loss: 1.799 Test Acc: 0.533
Validation loss decreased (-0.533315 --> -0.533315).  Saving model ...
Epoch: 82 cost time: 7.062398433685303
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.795 Vali Acc: 0.540 Test Loss: 1.795 Test Acc: 0.540
Validation loss decreased (-0.533315 --> -0.539982).  Saving model ...
Epoch: 83 cost time: 6.921714782714844
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.537 Test Loss: 1.787 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 6.754768371582031
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.790 Vali Acc: 0.533 Test Loss: 1.790 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 7.2059221267700195
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.790 Vali Acc: 0.533 Test Loss: 1.790 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 6.642329216003418
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.780 Vali Acc: 0.533 Test Loss: 1.780 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 6.771509647369385
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.533 Test Loss: 1.776 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 6.386763572692871
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.777 Vali Acc: 0.543 Test Loss: 1.777 Test Acc: 0.543
Validation loss decreased (-0.539982 --> -0.543316).  Saving model ...
Epoch: 89 cost time: 6.354530096054077
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.543 Test Loss: 1.776 Test Acc: 0.543
Validation loss decreased (-0.543316 --> -0.543316).  Saving model ...
Epoch: 90 cost time: 6.289593935012817
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.780 Vali Acc: 0.540 Test Loss: 1.780 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 6.499257802963257
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.780 Vali Acc: 0.537 Test Loss: 1.780 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 6.5193517208099365
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.543 Test Loss: 1.776 Test Acc: 0.543
Validation loss decreased (-0.543316 --> -0.543316).  Saving model ...
Epoch: 93 cost time: 6.508510112762451
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.540 Test Loss: 1.776 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 6.511919260025024
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.775 Vali Acc: 0.540 Test Loss: 1.775 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 6.062517881393433
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.775 Vali Acc: 0.540 Test Loss: 1.775 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 6.432781934738159
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.540 Test Loss: 1.776 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 6.747692108154297
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.774 Vali Acc: 0.537 Test Loss: 1.774 Test Acc: 0.537
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 6.809703588485718
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.774 Vali Acc: 0.543 Test Loss: 1.774 Test Acc: 0.543
Validation loss decreased (-0.543316 --> -0.543316).  Saving model ...
Epoch: 99 cost time: 6.450430154800415
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.774 Vali Acc: 0.547 Test Loss: 1.774 Test Acc: 0.547
Validation loss decreased (-0.543316 --> -0.546649).  Saving model ...
Epoch: 100 cost time: 6.419463157653809
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.773 Vali Acc: 0.540 Test Loss: 1.773 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5466666666666666
model parameter : 355225
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.498212337493896
Epoch: 1, Steps: 18 | Train Loss: 3.299 Vali Loss: 3.249 Vali Acc: 0.057 Test Loss: 3.249 Test Acc: 0.057
Validation loss decreased (inf --> -0.056634).  Saving model ...
Epoch: 2 cost time: 6.550671577453613
Epoch: 2, Steps: 18 | Train Loss: 3.221 Vali Loss: 3.205 Vali Acc: 0.040 Test Loss: 3.205 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.694457054138184
Epoch: 3, Steps: 18 | Train Loss: 3.022 Vali Loss: 3.151 Vali Acc: 0.070 Test Loss: 3.151 Test Acc: 0.070
Validation loss decreased (-0.056634 --> -0.069968).  Saving model ...
Epoch: 4 cost time: 7.062616348266602
Epoch: 4, Steps: 18 | Train Loss: 2.821 Vali Loss: 3.090 Vali Acc: 0.087 Test Loss: 3.090 Test Acc: 0.087
Validation loss decreased (-0.069968 --> -0.086636).  Saving model ...
Epoch: 5 cost time: 6.409841537475586
Epoch: 5, Steps: 18 | Train Loss: 2.554 Vali Loss: 3.020 Vali Acc: 0.097 Test Loss: 3.020 Test Acc: 0.097
Validation loss decreased (-0.086636 --> -0.096636).  Saving model ...
Epoch: 6 cost time: 6.995859146118164
Epoch: 6, Steps: 18 | Train Loss: 2.232 Vali Loss: 2.970 Vali Acc: 0.113 Test Loss: 2.970 Test Acc: 0.113
Validation loss decreased (-0.096636 --> -0.113304).  Saving model ...
Epoch: 7 cost time: 6.463252067565918
Epoch: 7, Steps: 18 | Train Loss: 2.011 Vali Loss: 2.917 Vali Acc: 0.110 Test Loss: 2.917 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.322103977203369
Epoch: 8, Steps: 18 | Train Loss: 1.668 Vali Loss: 2.870 Vali Acc: 0.110 Test Loss: 2.870 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.202211141586304
Epoch: 9, Steps: 18 | Train Loss: 1.397 Vali Loss: 2.801 Vali Acc: 0.183 Test Loss: 2.801 Test Acc: 0.183
Validation loss decreased (-0.113304 --> -0.183305).  Saving model ...
Epoch: 10 cost time: 6.071388483047485
Epoch: 10, Steps: 18 | Train Loss: 1.157 Vali Loss: 2.762 Vali Acc: 0.190 Test Loss: 2.762 Test Acc: 0.190
Validation loss decreased (-0.183305 --> -0.189972).  Saving model ...
Epoch: 11 cost time: 6.323491096496582
Epoch: 11, Steps: 18 | Train Loss: 0.895 Vali Loss: 2.712 Vali Acc: 0.173 Test Loss: 2.712 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.290753364562988
Epoch: 12, Steps: 18 | Train Loss: 0.684 Vali Loss: 2.697 Vali Acc: 0.177 Test Loss: 2.697 Test Acc: 0.177
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.066064834594727
Epoch: 13, Steps: 18 | Train Loss: 0.521 Vali Loss: 2.614 Vali Acc: 0.230 Test Loss: 2.614 Test Acc: 0.230
Validation loss decreased (-0.189972 --> -0.229974).  Saving model ...
Epoch: 14 cost time: 6.637443542480469
Epoch: 14, Steps: 18 | Train Loss: 0.388 Vali Loss: 2.582 Vali Acc: 0.240 Test Loss: 2.582 Test Acc: 0.240
Validation loss decreased (-0.229974 --> -0.239974).  Saving model ...
Epoch: 15 cost time: 6.356506824493408
Epoch: 15, Steps: 18 | Train Loss: 0.265 Vali Loss: 2.437 Vali Acc: 0.263 Test Loss: 2.437 Test Acc: 0.263
Validation loss decreased (-0.239974 --> -0.263309).  Saving model ...
Epoch: 16 cost time: 6.385707139968872
Epoch: 16, Steps: 18 | Train Loss: 0.181 Vali Loss: 2.476 Vali Acc: 0.263 Test Loss: 2.476 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.422393560409546
Epoch: 17, Steps: 18 | Train Loss: 0.126 Vali Loss: 2.414 Vali Acc: 0.257 Test Loss: 2.414 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.649178981781006
Epoch: 18, Steps: 18 | Train Loss: 0.100 Vali Loss: 2.359 Vali Acc: 0.293 Test Loss: 2.359 Test Acc: 0.293
Validation loss decreased (-0.263309 --> -0.293310).  Saving model ...
Epoch: 19 cost time: 6.545888900756836
Epoch: 19, Steps: 18 | Train Loss: 0.079 Vali Loss: 2.364 Vali Acc: 0.287 Test Loss: 2.364 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.871020078659058
Epoch: 20, Steps: 18 | Train Loss: 0.068 Vali Loss: 2.231 Vali Acc: 0.307 Test Loss: 2.231 Test Acc: 0.307
Validation loss decreased (-0.293310 --> -0.306644).  Saving model ...
Epoch: 21 cost time: 6.819762945175171
Epoch: 21, Steps: 18 | Train Loss: 0.054 Vali Loss: 2.204 Vali Acc: 0.340 Test Loss: 2.204 Test Acc: 0.340
Validation loss decreased (-0.306644 --> -0.339978).  Saving model ...
Epoch: 22 cost time: 6.832007884979248
Epoch: 22, Steps: 18 | Train Loss: 0.053 Vali Loss: 2.163 Vali Acc: 0.340 Test Loss: 2.163 Test Acc: 0.340
Validation loss decreased (-0.339978 --> -0.339978).  Saving model ...
Epoch: 23 cost time: 7.723207712173462
Epoch: 23, Steps: 18 | Train Loss: 0.053 Vali Loss: 2.212 Vali Acc: 0.347 Test Loss: 2.212 Test Acc: 0.347
Validation loss decreased (-0.339978 --> -0.346645).  Saving model ...
Epoch: 24 cost time: 6.669796705245972
Epoch: 24, Steps: 18 | Train Loss: 0.037 Vali Loss: 2.134 Vali Acc: 0.360 Test Loss: 2.134 Test Acc: 0.360
Validation loss decreased (-0.346645 --> -0.359979).  Saving model ...
Epoch: 25 cost time: 6.557811737060547
Epoch: 25, Steps: 18 | Train Loss: 0.036 Vali Loss: 2.069 Vali Acc: 0.363 Test Loss: 2.069 Test Acc: 0.363
Validation loss decreased (-0.359979 --> -0.363313).  Saving model ...
Epoch: 26 cost time: 6.263277530670166
Epoch: 26, Steps: 18 | Train Loss: 0.031 Vali Loss: 2.058 Vali Acc: 0.397 Test Loss: 2.058 Test Acc: 0.397
Validation loss decreased (-0.363313 --> -0.396646).  Saving model ...
Epoch: 27 cost time: 6.420599937438965
Epoch: 27, Steps: 18 | Train Loss: 0.026 Vali Loss: 2.057 Vali Acc: 0.387 Test Loss: 2.057 Test Acc: 0.387
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.586129426956177
Epoch: 28, Steps: 18 | Train Loss: 0.021 Vali Loss: 2.017 Vali Acc: 0.387 Test Loss: 2.017 Test Acc: 0.387
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.365592002868652
Epoch: 29, Steps: 18 | Train Loss: 0.019 Vali Loss: 2.018 Vali Acc: 0.390 Test Loss: 2.018 Test Acc: 0.390
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.014096975326538
Epoch: 30, Steps: 18 | Train Loss: 0.019 Vali Loss: 2.028 Vali Acc: 0.393 Test Loss: 2.028 Test Acc: 0.393
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.496083736419678
Epoch: 31, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.014 Vali Acc: 0.423 Test Loss: 2.014 Test Acc: 0.423
Validation loss decreased (-0.396646 --> -0.423313).  Saving model ...
Epoch: 32 cost time: 6.642575979232788
Epoch: 32, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.938 Vali Acc: 0.417 Test Loss: 1.938 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.287426233291626
Epoch: 33, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.954 Vali Acc: 0.403 Test Loss: 1.954 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.846120357513428
Epoch: 34, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.928 Vali Acc: 0.430 Test Loss: 1.928 Test Acc: 0.430
Validation loss decreased (-0.423313 --> -0.429981).  Saving model ...
Epoch: 35 cost time: 7.018966913223267
Epoch: 35, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.913 Vali Acc: 0.423 Test Loss: 1.913 Test Acc: 0.423
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.378543138504028
Epoch: 36, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.929 Vali Acc: 0.420 Test Loss: 1.929 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 6.283903360366821
Epoch: 37, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.957 Vali Acc: 0.407 Test Loss: 1.957 Test Acc: 0.407
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 6.303213834762573
Epoch: 38, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.894 Vali Acc: 0.430 Test Loss: 1.894 Test Acc: 0.430
Validation loss decreased (-0.429981 --> -0.429981).  Saving model ...
Epoch: 39 cost time: 6.440339088439941
Epoch: 39, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.890 Vali Acc: 0.433 Test Loss: 1.890 Test Acc: 0.433
Validation loss decreased (-0.429981 --> -0.433314).  Saving model ...
Epoch: 40 cost time: 5.955728769302368
Epoch: 40, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.869 Vali Acc: 0.433 Test Loss: 1.869 Test Acc: 0.433
Validation loss decreased (-0.433314 --> -0.433315).  Saving model ...
Epoch: 41 cost time: 6.1290788650512695
Epoch: 41, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.852 Vali Acc: 0.440 Test Loss: 1.852 Test Acc: 0.440
Validation loss decreased (-0.433315 --> -0.439981).  Saving model ...
Epoch: 42 cost time: 6.033490896224976
Epoch: 42, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.850 Vali Acc: 0.443 Test Loss: 1.850 Test Acc: 0.443
Validation loss decreased (-0.439981 --> -0.443315).  Saving model ...
Epoch: 43 cost time: 6.267115354537964
Epoch: 43, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.849 Vali Acc: 0.467 Test Loss: 1.849 Test Acc: 0.467
Validation loss decreased (-0.443315 --> -0.466648).  Saving model ...
Epoch: 44 cost time: 6.091244697570801
Epoch: 44, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.851 Vali Acc: 0.450 Test Loss: 1.851 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 6.139501094818115
Epoch: 45, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.814 Vali Acc: 0.460 Test Loss: 1.814 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 6.251605272293091
Epoch: 46, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.797 Vali Acc: 0.460 Test Loss: 1.797 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 6.084557056427002
Epoch: 47, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.806 Vali Acc: 0.460 Test Loss: 1.806 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 6.534718990325928
Epoch: 48, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.791 Vali Acc: 0.470 Test Loss: 1.791 Test Acc: 0.470
Validation loss decreased (-0.466648 --> -0.469982).  Saving model ...
Epoch: 49 cost time: 6.76793098449707
Epoch: 49, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.780 Vali Acc: 0.473 Test Loss: 1.780 Test Acc: 0.473
Validation loss decreased (-0.469982 --> -0.473316).  Saving model ...
Epoch: 50 cost time: 6.38759183883667
Epoch: 50, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.776 Vali Acc: 0.467 Test Loss: 1.776 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 6.494250774383545
Epoch: 51, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.783 Vali Acc: 0.470 Test Loss: 1.783 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 7.126060962677002
Epoch: 52, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.797 Vali Acc: 0.457 Test Loss: 1.797 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 6.46082878112793
Epoch: 53, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.778 Vali Acc: 0.467 Test Loss: 1.778 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 6.435992479324341
Epoch: 54, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.746 Vali Acc: 0.497 Test Loss: 1.746 Test Acc: 0.497
Validation loss decreased (-0.473316 --> -0.496649).  Saving model ...
Epoch: 55 cost time: 6.507123708724976
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.779 Vali Acc: 0.487 Test Loss: 1.779 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 6.289026975631714
Epoch: 56, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.764 Vali Acc: 0.490 Test Loss: 1.764 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 6.7837841510772705
Epoch: 57, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.749 Vali Acc: 0.487 Test Loss: 1.749 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 6.899980306625366
Epoch: 58, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.756 Vali Acc: 0.487 Test Loss: 1.756 Test Acc: 0.487
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 7.159359693527222
Epoch: 59, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.761 Vali Acc: 0.497 Test Loss: 1.761 Test Acc: 0.497
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 6.749765634536743
Epoch: 60, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.753 Vali Acc: 0.500 Test Loss: 1.753 Test Acc: 0.500
Validation loss decreased (-0.496649 --> -0.499982).  Saving model ...
Epoch: 61 cost time: 6.779568910598755
Epoch: 61, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.727 Vali Acc: 0.493 Test Loss: 1.727 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.874648332595825
Epoch: 62, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.704 Vali Acc: 0.497 Test Loss: 1.704 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 6.800534009933472
Epoch: 63, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.709 Vali Acc: 0.493 Test Loss: 1.709 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 6.6047046184539795
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.701 Vali Acc: 0.500 Test Loss: 1.701 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499983).  Saving model ...
Epoch: 65 cost time: 6.9424097537994385
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.706 Vali Acc: 0.503 Test Loss: 1.706 Test Acc: 0.503
Validation loss decreased (-0.499983 --> -0.503316).  Saving model ...
Epoch: 66 cost time: 7.178961515426636
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.709 Vali Acc: 0.497 Test Loss: 1.709 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 6.624840974807739
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.702 Vali Acc: 0.500 Test Loss: 1.702 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 7.2998552322387695
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.700 Vali Acc: 0.507 Test Loss: 1.700 Test Acc: 0.507
Validation loss decreased (-0.503316 --> -0.506650).  Saving model ...
Epoch: 69 cost time: 6.678861618041992
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.701 Vali Acc: 0.503 Test Loss: 1.701 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 7.025027513504028
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.696 Vali Acc: 0.503 Test Loss: 1.696 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 6.923360824584961
Epoch: 71, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.693 Vali Acc: 0.507 Test Loss: 1.693 Test Acc: 0.507
Validation loss decreased (-0.506650 --> -0.506650).  Saving model ...
Epoch: 72 cost time: 7.000594615936279
Epoch: 72, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.693 Vali Acc: 0.510 Test Loss: 1.693 Test Acc: 0.510
Validation loss decreased (-0.506650 --> -0.509983).  Saving model ...
Epoch: 73 cost time: 6.808199644088745
Epoch: 73, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.684 Vali Acc: 0.507 Test Loss: 1.684 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 6.6368701457977295
Epoch: 74, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.656 Vali Acc: 0.510 Test Loss: 1.656 Test Acc: 0.510
Validation loss decreased (-0.509983 --> -0.509983).  Saving model ...
Epoch: 75 cost time: 6.873547792434692
Epoch: 75, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.651 Vali Acc: 0.523 Test Loss: 1.651 Test Acc: 0.523
Validation loss decreased (-0.509983 --> -0.523317).  Saving model ...
Epoch: 76 cost time: 6.562642574310303
Epoch: 76, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.662 Vali Acc: 0.510 Test Loss: 1.662 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 7.1521618366241455
Epoch: 77, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.655 Vali Acc: 0.510 Test Loss: 1.655 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 6.484744071960449
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.651 Vali Acc: 0.520 Test Loss: 1.651 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 6.46179461479187
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.665 Vali Acc: 0.530 Test Loss: 1.665 Test Acc: 0.530
Validation loss decreased (-0.523317 --> -0.529983).  Saving model ...
Epoch: 80 cost time: 7.010050535202026
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.686 Vali Acc: 0.523 Test Loss: 1.686 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 7.2949817180633545
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.675 Vali Acc: 0.530 Test Loss: 1.675 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 7.39937949180603
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.655 Vali Acc: 0.527 Test Loss: 1.655 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 7.371165037155151
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.654 Vali Acc: 0.530 Test Loss: 1.654 Test Acc: 0.530
Validation loss decreased (-0.529983 --> -0.529983).  Saving model ...
Epoch: 84 cost time: 7.406603097915649
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.649 Vali Acc: 0.523 Test Loss: 1.649 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 7.363897800445557
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.642 Vali Acc: 0.527 Test Loss: 1.642 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 7.55208158493042
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.632 Vali Acc: 0.527 Test Loss: 1.632 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 7.068005800247192
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.624 Vali Acc: 0.530 Test Loss: 1.624 Test Acc: 0.530
Validation loss decreased (-0.529983 --> -0.529984).  Saving model ...
Epoch: 88 cost time: 7.0004723072052
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.623 Vali Acc: 0.537 Test Loss: 1.623 Test Acc: 0.537
Validation loss decreased (-0.529984 --> -0.536650).  Saving model ...
Epoch: 89 cost time: 6.432470083236694
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.621 Vali Acc: 0.533 Test Loss: 1.621 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 7.090554237365723
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.624 Vali Acc: 0.543 Test Loss: 1.624 Test Acc: 0.543
Validation loss decreased (-0.536650 --> -0.543317).  Saving model ...
Epoch: 91 cost time: 6.514232397079468
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.537 Test Loss: 1.606 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 6.242424964904785
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.595 Vali Acc: 0.540 Test Loss: 1.595 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 6.168478965759277
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.594 Vali Acc: 0.540 Test Loss: 1.594 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 6.542852163314819
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.594 Vali Acc: 0.547 Test Loss: 1.594 Test Acc: 0.547
Validation loss decreased (-0.543317 --> -0.546651).  Saving model ...
Epoch: 95 cost time: 6.941746711730957
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.597 Vali Acc: 0.547 Test Loss: 1.597 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 7.023788690567017
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.610 Vali Acc: 0.540 Test Loss: 1.610 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 7.085957050323486
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.612 Vali Acc: 0.533 Test Loss: 1.612 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 6.4152891635894775
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.613 Vali Acc: 0.537 Test Loss: 1.613 Test Acc: 0.537
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 6.773139953613281
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.628 Vali Acc: 0.540 Test Loss: 1.628 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 6.9181342124938965
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.537 Test Loss: 1.633 Test Acc: 0.537
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5466666666666666
model parameter : 355225
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.354401588439941
Epoch: 1, Steps: 18 | Train Loss: 3.306 Vali Loss: 3.272 Vali Acc: 0.057 Test Loss: 3.272 Test Acc: 0.057
Validation loss decreased (inf --> -0.056634).  Saving model ...
Epoch: 2 cost time: 6.6328465938568115
Epoch: 2, Steps: 18 | Train Loss: 3.228 Vali Loss: 3.234 Vali Acc: 0.063 Test Loss: 3.234 Test Acc: 0.063
Validation loss decreased (-0.056634 --> -0.063301).  Saving model ...
Epoch: 3 cost time: 6.257145881652832
Epoch: 3, Steps: 18 | Train Loss: 3.009 Vali Loss: 3.187 Vali Acc: 0.050 Test Loss: 3.187 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.81388783454895
Epoch: 4, Steps: 18 | Train Loss: 2.821 Vali Loss: 3.132 Vali Acc: 0.077 Test Loss: 3.132 Test Acc: 0.077
Validation loss decreased (-0.063301 --> -0.076635).  Saving model ...
Epoch: 5 cost time: 6.409357309341431
Epoch: 5, Steps: 18 | Train Loss: 2.613 Vali Loss: 3.067 Vali Acc: 0.113 Test Loss: 3.067 Test Acc: 0.113
Validation loss decreased (-0.076635 --> -0.113303).  Saving model ...
Epoch: 6 cost time: 6.340021848678589
Epoch: 6, Steps: 18 | Train Loss: 2.284 Vali Loss: 3.021 Vali Acc: 0.110 Test Loss: 3.021 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.598905086517334
Epoch: 7, Steps: 18 | Train Loss: 2.040 Vali Loss: 2.962 Vali Acc: 0.130 Test Loss: 2.962 Test Acc: 0.130
Validation loss decreased (-0.113303 --> -0.129970).  Saving model ...
Epoch: 8 cost time: 6.710691690444946
Epoch: 8, Steps: 18 | Train Loss: 1.717 Vali Loss: 2.900 Vali Acc: 0.150 Test Loss: 2.900 Test Acc: 0.150
Validation loss decreased (-0.129970 --> -0.149971).  Saving model ...
Epoch: 9 cost time: 6.7169249057769775
Epoch: 9, Steps: 18 | Train Loss: 1.418 Vali Loss: 2.836 Vali Acc: 0.167 Test Loss: 2.836 Test Acc: 0.167
Validation loss decreased (-0.149971 --> -0.166638).  Saving model ...
Epoch: 10 cost time: 6.791119813919067
Epoch: 10, Steps: 18 | Train Loss: 1.189 Vali Loss: 2.788 Vali Acc: 0.193 Test Loss: 2.788 Test Acc: 0.193
Validation loss decreased (-0.166638 --> -0.193305).  Saving model ...
Epoch: 11 cost time: 6.498247861862183
Epoch: 11, Steps: 18 | Train Loss: 0.893 Vali Loss: 2.724 Vali Acc: 0.203 Test Loss: 2.724 Test Acc: 0.203
Validation loss decreased (-0.193305 --> -0.203306).  Saving model ...
Epoch: 12 cost time: 7.225799798965454
Epoch: 12, Steps: 18 | Train Loss: 0.689 Vali Loss: 2.664 Vali Acc: 0.197 Test Loss: 2.664 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.065805673599243
Epoch: 13, Steps: 18 | Train Loss: 0.500 Vali Loss: 2.575 Vali Acc: 0.210 Test Loss: 2.575 Test Acc: 0.210
Validation loss decreased (-0.203306 --> -0.209974).  Saving model ...
Epoch: 14 cost time: 6.710173845291138
Epoch: 14, Steps: 18 | Train Loss: 0.367 Vali Loss: 2.495 Vali Acc: 0.237 Test Loss: 2.495 Test Acc: 0.237
Validation loss decreased (-0.209974 --> -0.236642).  Saving model ...
Epoch: 15 cost time: 6.346188068389893
Epoch: 15, Steps: 18 | Train Loss: 0.239 Vali Loss: 2.345 Vali Acc: 0.273 Test Loss: 2.345 Test Acc: 0.273
Validation loss decreased (-0.236642 --> -0.273310).  Saving model ...
Epoch: 16 cost time: 6.650164604187012
Epoch: 16, Steps: 18 | Train Loss: 0.164 Vali Loss: 2.321 Vali Acc: 0.280 Test Loss: 2.321 Test Acc: 0.280
Validation loss decreased (-0.273310 --> -0.279977).  Saving model ...
Epoch: 17 cost time: 6.88592004776001
Epoch: 17, Steps: 18 | Train Loss: 0.110 Vali Loss: 2.220 Vali Acc: 0.303 Test Loss: 2.220 Test Acc: 0.303
Validation loss decreased (-0.279977 --> -0.303311).  Saving model ...
Epoch: 18 cost time: 6.690698623657227
Epoch: 18, Steps: 18 | Train Loss: 0.087 Vali Loss: 2.159 Vali Acc: 0.333 Test Loss: 2.159 Test Acc: 0.333
Validation loss decreased (-0.303311 --> -0.333312).  Saving model ...
Epoch: 19 cost time: 6.915685415267944
Epoch: 19, Steps: 18 | Train Loss: 0.074 Vali Loss: 2.152 Vali Acc: 0.317 Test Loss: 2.152 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.614341735839844
Epoch: 20, Steps: 18 | Train Loss: 0.058 Vali Loss: 2.056 Vali Acc: 0.360 Test Loss: 2.056 Test Acc: 0.360
Validation loss decreased (-0.333312 --> -0.359979).  Saving model ...
Epoch: 21 cost time: 6.788374662399292
Epoch: 21, Steps: 18 | Train Loss: 0.050 Vali Loss: 1.994 Vali Acc: 0.393 Test Loss: 1.994 Test Acc: 0.393
Validation loss decreased (-0.359979 --> -0.393313).  Saving model ...
Epoch: 22 cost time: 6.806619644165039
Epoch: 22, Steps: 18 | Train Loss: 0.044 Vali Loss: 1.953 Vali Acc: 0.393 Test Loss: 1.953 Test Acc: 0.393
Validation loss decreased (-0.393313 --> -0.393314).  Saving model ...
Epoch: 23 cost time: 7.239232778549194
Epoch: 23, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.958 Vali Acc: 0.397 Test Loss: 1.958 Test Acc: 0.397
Validation loss decreased (-0.393314 --> -0.396647).  Saving model ...
Epoch: 24 cost time: 6.666226387023926
Epoch: 24, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.914 Vali Acc: 0.400 Test Loss: 1.914 Test Acc: 0.400
Validation loss decreased (-0.396647 --> -0.399981).  Saving model ...
Epoch: 25 cost time: 6.669158220291138
Epoch: 25, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.858 Vali Acc: 0.413 Test Loss: 1.858 Test Acc: 0.413
Validation loss decreased (-0.399981 --> -0.413315).  Saving model ...
Epoch: 26 cost time: 6.880605697631836
Epoch: 26, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.831 Vali Acc: 0.433 Test Loss: 1.831 Test Acc: 0.433
Validation loss decreased (-0.413315 --> -0.433315).  Saving model ...
Epoch: 27 cost time: 6.789085388183594
Epoch: 27, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.824 Vali Acc: 0.417 Test Loss: 1.824 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.912956953048706
Epoch: 28, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.787 Vali Acc: 0.440 Test Loss: 1.787 Test Acc: 0.440
Validation loss decreased (-0.433315 --> -0.439982).  Saving model ...
Epoch: 29 cost time: 6.419106960296631
Epoch: 29, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.775 Vali Acc: 0.437 Test Loss: 1.775 Test Acc: 0.437
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.759157657623291
Epoch: 30, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.764 Vali Acc: 0.430 Test Loss: 1.764 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.1909120082855225
Epoch: 31, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.733 Vali Acc: 0.450 Test Loss: 1.733 Test Acc: 0.450
Validation loss decreased (-0.439982 --> -0.449983).  Saving model ...
Epoch: 32 cost time: 6.201742887496948
Epoch: 32, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.706 Vali Acc: 0.470 Test Loss: 1.706 Test Acc: 0.470
Validation loss decreased (-0.449983 --> -0.469983).  Saving model ...
Epoch: 33 cost time: 5.984499931335449
Epoch: 33, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.691 Vali Acc: 0.463 Test Loss: 1.691 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.222963809967041
Epoch: 34, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.663 Vali Acc: 0.483 Test Loss: 1.663 Test Acc: 0.483
Validation loss decreased (-0.469983 --> -0.483317).  Saving model ...
Epoch: 35 cost time: 6.788172483444214
Epoch: 35, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.650 Vali Acc: 0.483 Test Loss: 1.650 Test Acc: 0.483
Validation loss decreased (-0.483317 --> -0.483317).  Saving model ...
Epoch: 36 cost time: 7.035027980804443
Epoch: 36, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.657 Vali Acc: 0.493 Test Loss: 1.657 Test Acc: 0.493
Validation loss decreased (-0.483317 --> -0.493317).  Saving model ...
Epoch: 37 cost time: 7.002508640289307
Epoch: 37, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.664 Vali Acc: 0.473 Test Loss: 1.664 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 7.379814863204956
Epoch: 38, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.627 Vali Acc: 0.493 Test Loss: 1.627 Test Acc: 0.493
Validation loss decreased (-0.493317 --> -0.493317).  Saving model ...
Epoch: 39 cost time: 6.910489320755005
Epoch: 39, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.635 Vali Acc: 0.483 Test Loss: 1.635 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.506306409835815
Epoch: 40, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.623 Vali Acc: 0.493 Test Loss: 1.623 Test Acc: 0.493
Validation loss decreased (-0.493317 --> -0.493317).  Saving model ...
Epoch: 41 cost time: 6.770905494689941
Epoch: 41, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.612 Vali Acc: 0.500 Test Loss: 1.612 Test Acc: 0.500
Validation loss decreased (-0.493317 --> -0.499984).  Saving model ...
Epoch: 42 cost time: 6.420725584030151
Epoch: 42, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.601 Vali Acc: 0.510 Test Loss: 1.601 Test Acc: 0.510
Validation loss decreased (-0.499984 --> -0.509984).  Saving model ...
Epoch: 43 cost time: 5.900369167327881
Epoch: 43, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.593 Vali Acc: 0.517 Test Loss: 1.593 Test Acc: 0.517
Validation loss decreased (-0.509984 --> -0.516651).  Saving model ...
Epoch: 44 cost time: 6.504163980484009
Epoch: 44, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.578 Vali Acc: 0.520 Test Loss: 1.578 Test Acc: 0.520
Validation loss decreased (-0.516651 --> -0.519984).  Saving model ...
Epoch: 45 cost time: 6.483880519866943
Epoch: 45, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.560 Vali Acc: 0.510 Test Loss: 1.560 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.257611274719238
Epoch: 46, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.549 Vali Acc: 0.527 Test Loss: 1.549 Test Acc: 0.527
Validation loss decreased (-0.519984 --> -0.526651).  Saving model ...
Epoch: 47 cost time: 6.144664525985718
Epoch: 47, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.552 Vali Acc: 0.530 Test Loss: 1.552 Test Acc: 0.530
Validation loss decreased (-0.526651 --> -0.529984).  Saving model ...
Epoch: 48 cost time: 6.590715169906616
Epoch: 48, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.538 Vali Acc: 0.533 Test Loss: 1.538 Test Acc: 0.533
Validation loss decreased (-0.529984 --> -0.533318).  Saving model ...
Epoch: 49 cost time: 6.288892030715942
Epoch: 49, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.532 Vali Acc: 0.523 Test Loss: 1.532 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 7.475504636764526
Epoch: 50, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.517 Vali Acc: 0.533 Test Loss: 1.517 Test Acc: 0.533
Validation loss decreased (-0.533318 --> -0.533318).  Saving model ...
Epoch: 51 cost time: 7.063575744628906
Epoch: 51, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.508 Vali Acc: 0.530 Test Loss: 1.508 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.41349983215332
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.510 Vali Acc: 0.547 Test Loss: 1.510 Test Acc: 0.547
Validation loss decreased (-0.533318 --> -0.546652).  Saving model ...
Epoch: 53 cost time: 7.310787916183472
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.500 Vali Acc: 0.540 Test Loss: 1.500 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.391735076904297
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.484 Vali Acc: 0.543 Test Loss: 1.484 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.552819728851318
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.478 Vali Acc: 0.537 Test Loss: 1.478 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 6.790248155593872
Epoch: 56, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.471 Vali Acc: 0.547 Test Loss: 1.471 Test Acc: 0.547
Validation loss decreased (-0.546652 --> -0.546652).  Saving model ...
Epoch: 57 cost time: 6.339680910110474
Epoch: 57, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.467 Vali Acc: 0.553 Test Loss: 1.467 Test Acc: 0.553
Validation loss decreased (-0.546652 --> -0.553319).  Saving model ...
Epoch: 58 cost time: 6.347965240478516
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.469 Vali Acc: 0.550 Test Loss: 1.469 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.597236633300781
Epoch: 59, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.468 Vali Acc: 0.563 Test Loss: 1.468 Test Acc: 0.563
Validation loss decreased (-0.553319 --> -0.563319).  Saving model ...
Epoch: 60 cost time: 6.3028647899627686
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.458 Vali Acc: 0.573 Test Loss: 1.458 Test Acc: 0.573
Validation loss decreased (-0.563319 --> -0.573319).  Saving model ...
Epoch: 61 cost time: 6.635391473770142
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.451 Vali Acc: 0.570 Test Loss: 1.451 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.3722758293151855
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.442 Vali Acc: 0.573 Test Loss: 1.442 Test Acc: 0.573
Validation loss decreased (-0.573319 --> -0.573319).  Saving model ...
Epoch: 63 cost time: 6.871969938278198
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.438 Vali Acc: 0.573 Test Loss: 1.438 Test Acc: 0.573
Validation loss decreased (-0.573319 --> -0.573319).  Saving model ...
Epoch: 64 cost time: 6.834792613983154
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.433 Vali Acc: 0.573 Test Loss: 1.433 Test Acc: 0.573
Validation loss decreased (-0.573319 --> -0.573319).  Saving model ...
Epoch: 65 cost time: 6.762260913848877
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.436 Vali Acc: 0.570 Test Loss: 1.436 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 6.516227960586548
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.443 Vali Acc: 0.567 Test Loss: 1.443 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 6.247555255889893
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.441 Vali Acc: 0.580 Test Loss: 1.441 Test Acc: 0.580
Validation loss decreased (-0.573319 --> -0.579986).  Saving model ...
Epoch: 68 cost time: 6.139801502227783
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.432 Vali Acc: 0.583 Test Loss: 1.432 Test Acc: 0.583
Validation loss decreased (-0.579986 --> -0.583319).  Saving model ...
Epoch: 69 cost time: 6.633589267730713
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.424 Vali Acc: 0.580 Test Loss: 1.424 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 6.600344181060791
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.424 Vali Acc: 0.583 Test Loss: 1.424 Test Acc: 0.583
Validation loss decreased (-0.583319 --> -0.583319).  Saving model ...
Epoch: 71 cost time: 6.550439357757568
Epoch: 71, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.429 Vali Acc: 0.583 Test Loss: 1.429 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 6.392947673797607
Epoch: 72, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.427 Vali Acc: 0.573 Test Loss: 1.427 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.76139497756958
Epoch: 73, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.424 Vali Acc: 0.573 Test Loss: 1.424 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 6.94881796836853
Epoch: 74, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.420 Vali Acc: 0.573 Test Loss: 1.420 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 6.597387075424194
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.418 Vali Acc: 0.577 Test Loss: 1.418 Test Acc: 0.577
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 6.699225664138794
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.418 Vali Acc: 0.577 Test Loss: 1.418 Test Acc: 0.577
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 6.29919171333313
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.577 Test Loss: 1.419 Test Acc: 0.577
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 6.379731893539429
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.414 Vali Acc: 0.583 Test Loss: 1.414 Test Acc: 0.583
Validation loss decreased (-0.583319 --> -0.583319).  Saving model ...
Epoch: 79 cost time: 6.5162739753723145
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.416 Vali Acc: 0.590 Test Loss: 1.416 Test Acc: 0.590
Validation loss decreased (-0.583319 --> -0.589986).  Saving model ...
Epoch: 80 cost time: 6.399044036865234
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.415 Vali Acc: 0.590 Test Loss: 1.415 Test Acc: 0.590
Validation loss decreased (-0.589986 --> -0.589986).  Saving model ...
Epoch: 81 cost time: 6.40001368522644
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.408 Vali Acc: 0.583 Test Loss: 1.408 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 6.592235803604126
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.403 Vali Acc: 0.577 Test Loss: 1.403 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 6.550416946411133
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.587 Test Loss: 1.398 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 6.622053384780884
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.395 Vali Acc: 0.587 Test Loss: 1.395 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 7.076026916503906
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.392 Vali Acc: 0.587 Test Loss: 1.392 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 6.566792964935303
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.384 Vali Acc: 0.593 Test Loss: 1.384 Test Acc: 0.593
Validation loss decreased (-0.589986 --> -0.593319).  Saving model ...
Epoch: 87 cost time: 6.773242950439453
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.597 Test Loss: 1.386 Test Acc: 0.597
Validation loss decreased (-0.593319 --> -0.596653).  Saving model ...
Epoch: 88 cost time: 6.372390270233154
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.388 Vali Acc: 0.590 Test Loss: 1.388 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 6.354774713516235
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.384 Vali Acc: 0.597 Test Loss: 1.384 Test Acc: 0.597
Validation loss decreased (-0.596653 --> -0.596653).  Saving model ...
Epoch: 90 cost time: 6.292243003845215
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.377 Vali Acc: 0.607 Test Loss: 1.377 Test Acc: 0.607
Validation loss decreased (-0.596653 --> -0.606653).  Saving model ...
Epoch: 91 cost time: 6.244707345962524
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.372 Vali Acc: 0.600 Test Loss: 1.372 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 6.6526265144348145
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.371 Vali Acc: 0.597 Test Loss: 1.371 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 6.264526128768921
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.371 Vali Acc: 0.597 Test Loss: 1.371 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 7.075441837310791
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.368 Vali Acc: 0.600 Test Loss: 1.368 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 6.862793922424316
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.360 Vali Acc: 0.600 Test Loss: 1.360 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 6.826373815536499
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.364 Vali Acc: 0.597 Test Loss: 1.364 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 6.6223976612091064
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.365 Vali Acc: 0.607 Test Loss: 1.365 Test Acc: 0.607
Validation loss decreased (-0.606653 --> -0.606653).  Saving model ...
Epoch: 98 cost time: 6.161321401596069
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.363 Vali Acc: 0.610 Test Loss: 1.363 Test Acc: 0.610
Validation loss decreased (-0.606653 --> -0.609986).  Saving model ...
Epoch: 99 cost time: 6.4702160358428955
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.364 Vali Acc: 0.597 Test Loss: 1.364 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 6.424758672714233
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.364 Vali Acc: 0.597 Test Loss: 1.364 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.61
model parameter : 355225
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.692182302474976
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 6.334674596786499
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.615288734436035
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.625725030899048
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 5 cost time: 7.284870386123657
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 6 cost time: 6.858422040939331
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 7 cost time: 6.604476451873779
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.183871030807495
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.682645320892334
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 10 cost time: 6.271778583526611
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.393629550933838
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.370325565338135
Epoch: 12, Steps: 18 | Train Loss: 3.218 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.734379529953003
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.767366170883179
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.678668022155762
Epoch: 15, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.801907539367676
Epoch: 16, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.05639910697937
Epoch: 17, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.310842514038086
Epoch: 18, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.7899370193481445
Epoch: 19, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 355225
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.83910608291626
Epoch: 1, Steps: 18 | Train Loss: 3.222 Vali Loss: 3.001 Vali Acc: 0.173 Test Loss: 3.001 Test Acc: 0.173
Validation loss decreased (inf --> -0.173303).  Saving model ...
Epoch: 2 cost time: 6.303211688995361
Epoch: 2, Steps: 18 | Train Loss: 2.718 Vali Loss: 2.435 Vali Acc: 0.603 Test Loss: 2.435 Test Acc: 0.603
Validation loss decreased (-0.173303 --> -0.603309).  Saving model ...
Epoch: 3 cost time: 6.041177749633789
Epoch: 3, Steps: 18 | Train Loss: 2.063 Vali Loss: 1.818 Vali Acc: 0.740 Test Loss: 1.818 Test Acc: 0.740
Validation loss decreased (-0.603309 --> -0.739982).  Saving model ...
Epoch: 4 cost time: 6.2178637981414795
Epoch: 4, Steps: 18 | Train Loss: 1.365 Vali Loss: 1.288 Vali Acc: 0.787 Test Loss: 1.288 Test Acc: 0.787
Validation loss decreased (-0.739982 --> -0.786654).  Saving model ...
Epoch: 5 cost time: 6.133651256561279
Epoch: 5, Steps: 18 | Train Loss: 0.870 Vali Loss: 0.925 Vali Acc: 0.833 Test Loss: 0.925 Test Acc: 0.833
Validation loss decreased (-0.786654 --> -0.833324).  Saving model ...
Epoch: 6 cost time: 6.734185218811035
Epoch: 6, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.707 Vali Acc: 0.847 Test Loss: 0.707 Test Acc: 0.847
Validation loss decreased (-0.833324 --> -0.846660).  Saving model ...
Epoch: 7 cost time: 6.395283937454224
Epoch: 7, Steps: 18 | Train Loss: 0.262 Vali Loss: 0.588 Vali Acc: 0.873 Test Loss: 0.588 Test Acc: 0.873
Validation loss decreased (-0.846660 --> -0.873327).  Saving model ...
Epoch: 8 cost time: 6.882485628128052
Epoch: 8, Steps: 18 | Train Loss: 0.158 Vali Loss: 0.524 Vali Acc: 0.880 Test Loss: 0.524 Test Acc: 0.880
Validation loss decreased (-0.873327 --> -0.879995).  Saving model ...
Epoch: 9 cost time: 6.304664134979248
Epoch: 9, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.493 Vali Acc: 0.880 Test Loss: 0.493 Test Acc: 0.880
Validation loss decreased (-0.879995 --> -0.879995).  Saving model ...
Epoch: 10 cost time: 6.275055408477783
Epoch: 10, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.478 Vali Acc: 0.880 Test Loss: 0.478 Test Acc: 0.880
Validation loss decreased (-0.879995 --> -0.879995).  Saving model ...
Epoch: 11 cost time: 6.47098445892334
Epoch: 11, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.452 Vali Acc: 0.880 Test Loss: 0.452 Test Acc: 0.880
Validation loss decreased (-0.879995 --> -0.879995).  Saving model ...
Epoch: 12 cost time: 5.76157021522522
Epoch: 12, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.436 Vali Acc: 0.887 Test Loss: 0.436 Test Acc: 0.887
Validation loss decreased (-0.879995 --> -0.886662).  Saving model ...
Epoch: 13 cost time: 6.2834367752075195
Epoch: 13, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.428 Vali Acc: 0.890 Test Loss: 0.428 Test Acc: 0.890
Validation loss decreased (-0.886662 --> -0.889996).  Saving model ...
Epoch: 14 cost time: 5.710746765136719
Epoch: 14, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.421 Vali Acc: 0.890 Test Loss: 0.421 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 15 cost time: 6.225481986999512
Epoch: 15, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
Validation loss decreased (-0.889996 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 5.6387412548065186
Epoch: 16, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.407 Vali Acc: 0.890 Test Loss: 0.407 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.079262733459473
Epoch: 17, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.403 Vali Acc: 0.893 Test Loss: 0.403 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.036810874938965
Epoch: 18, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.402 Vali Acc: 0.890 Test Loss: 0.402 Test Acc: 0.890
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.466107130050659
Epoch: 19, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.401 Vali Acc: 0.887 Test Loss: 0.401 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.201307773590088
Epoch: 20, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.399 Vali Acc: 0.887 Test Loss: 0.399 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.516616106033325
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.395 Vali Acc: 0.893 Test Loss: 0.395 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.283663749694824
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.391 Vali Acc: 0.897 Test Loss: 0.391 Test Acc: 0.897
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.518219232559204
Epoch: 23, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.390 Vali Acc: 0.893 Test Loss: 0.390 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.555977821350098
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.388 Vali Acc: 0.893 Test Loss: 0.388 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.11252498626709
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.384 Vali Acc: 0.893 Test Loss: 0.384 Test Acc: 0.893
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9
model parameter : 256921
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.96250581741333
Epoch: 1, Steps: 18 | Train Loss: 3.266 Vali Loss: 3.095 Vali Acc: 0.107 Test Loss: 3.095 Test Acc: 0.107
Validation loss decreased (inf --> -0.106636).  Saving model ...
Epoch: 2 cost time: 6.687592029571533
Epoch: 2, Steps: 18 | Train Loss: 2.853 Vali Loss: 2.665 Vali Acc: 0.473 Test Loss: 2.665 Test Acc: 0.473
Validation loss decreased (-0.106636 --> -0.473307).  Saving model ...
Epoch: 3 cost time: 6.378394842147827
Epoch: 3, Steps: 18 | Train Loss: 2.333 Vali Loss: 2.165 Vali Acc: 0.650 Test Loss: 2.165 Test Acc: 0.650
Validation loss decreased (-0.473307 --> -0.649978).  Saving model ...
Epoch: 4 cost time: 6.587862491607666
Epoch: 4, Steps: 18 | Train Loss: 1.700 Vali Loss: 1.660 Vali Acc: 0.723 Test Loss: 1.660 Test Acc: 0.723
Validation loss decreased (-0.649978 --> -0.723317).  Saving model ...
Epoch: 5 cost time: 7.158039808273315
Epoch: 5, Steps: 18 | Train Loss: 1.168 Vali Loss: 1.252 Vali Acc: 0.787 Test Loss: 1.252 Test Acc: 0.787
Validation loss decreased (-0.723317 --> -0.786654).  Saving model ...
Epoch: 6 cost time: 6.687330961227417
Epoch: 6, Steps: 18 | Train Loss: 0.713 Vali Loss: 0.974 Vali Acc: 0.817 Test Loss: 0.974 Test Acc: 0.817
Validation loss decreased (-0.786654 --> -0.816657).  Saving model ...
Epoch: 7 cost time: 7.009211540222168
Epoch: 7, Steps: 18 | Train Loss: 0.389 Vali Loss: 0.801 Vali Acc: 0.847 Test Loss: 0.801 Test Acc: 0.847
Validation loss decreased (-0.816657 --> -0.846659).  Saving model ...
Epoch: 8 cost time: 6.91689658164978
Epoch: 8, Steps: 18 | Train Loss: 0.218 Vali Loss: 0.706 Vali Acc: 0.863 Test Loss: 0.706 Test Acc: 0.863
Validation loss decreased (-0.846659 --> -0.863326).  Saving model ...
Epoch: 9 cost time: 6.428268909454346
Epoch: 9, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.664 Vali Acc: 0.843 Test Loss: 0.664 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.269769191741943
Epoch: 10, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.630 Vali Acc: 0.843 Test Loss: 0.630 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.063857316970825
Epoch: 11, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.603 Vali Acc: 0.843 Test Loss: 0.603 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.127720832824707
Epoch: 12, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.585 Vali Acc: 0.860 Test Loss: 0.585 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.205979108810425
Epoch: 13, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.577 Vali Acc: 0.863 Test Loss: 0.577 Test Acc: 0.863
Validation loss decreased (-0.863326 --> -0.863328).  Saving model ...
Epoch: 14 cost time: 6.4126057624816895
Epoch: 14, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.566 Vali Acc: 0.860 Test Loss: 0.566 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.531735181808472
Epoch: 15, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.561 Vali Acc: 0.867 Test Loss: 0.561 Test Acc: 0.867
Validation loss decreased (-0.863328 --> -0.866661).  Saving model ...
Epoch: 16 cost time: 6.652402400970459
Epoch: 16, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.553 Vali Acc: 0.860 Test Loss: 0.553 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.705846548080444
Epoch: 17, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.543 Vali Acc: 0.863 Test Loss: 0.543 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.912545680999756
Epoch: 18, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.540 Vali Acc: 0.853 Test Loss: 0.540 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.901052951812744
Epoch: 19, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.543 Vali Acc: 0.857 Test Loss: 0.543 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.006993055343628
Epoch: 20, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.541 Vali Acc: 0.860 Test Loss: 0.541 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.097450256347656
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.536 Vali Acc: 0.860 Test Loss: 0.536 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.969669818878174
Epoch: 22, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.532 Vali Acc: 0.863 Test Loss: 0.532 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.631483554840088
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.530 Vali Acc: 0.860 Test Loss: 0.530 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.089627504348755
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.527 Vali Acc: 0.863 Test Loss: 0.527 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.4865031242370605
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.520 Vali Acc: 0.873 Test Loss: 0.520 Test Acc: 0.873
Validation loss decreased (-0.866661 --> -0.873328).  Saving model ...
Epoch: 26 cost time: 6.4987311363220215
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.524 Vali Acc: 0.860 Test Loss: 0.524 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.587743282318115
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.415940523147583
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.520 Vali Acc: 0.867 Test Loss: 0.520 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.796962261199951
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.514 Vali Acc: 0.873 Test Loss: 0.514 Test Acc: 0.873
Validation loss decreased (-0.873328 --> -0.873328).  Saving model ...
Epoch: 30 cost time: 6.396873474121094
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.514 Vali Acc: 0.870 Test Loss: 0.514 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.8129963874816895
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.566280364990234
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.2969584465026855
Epoch: 33, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 6.576737642288208
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 6.015103340148926
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.509 Vali Acc: 0.863 Test Loss: 0.509 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 6.30903434753418
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.508 Vali Acc: 0.863 Test Loss: 0.508 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 6.644212961196899
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 6.194998264312744
Epoch: 38, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.508 Vali Acc: 0.863 Test Loss: 0.508 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 6.117951393127441
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.863 Test Loss: 0.509 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8733333333333333
model parameter : 256921
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.14430284500122
Epoch: 1, Steps: 18 | Train Loss: 3.297 Vali Loss: 3.178 Vali Acc: 0.087 Test Loss: 3.178 Test Acc: 0.087
Validation loss decreased (inf --> -0.086635).  Saving model ...
Epoch: 2 cost time: 7.230642318725586
Epoch: 2, Steps: 18 | Train Loss: 2.991 Vali Loss: 2.885 Vali Acc: 0.263 Test Loss: 2.885 Test Acc: 0.263
Validation loss decreased (-0.086635 --> -0.263304).  Saving model ...
Epoch: 3 cost time: 7.327189922332764
Epoch: 3, Steps: 18 | Train Loss: 2.584 Vali Loss: 2.540 Vali Acc: 0.527 Test Loss: 2.540 Test Acc: 0.527
Validation loss decreased (-0.263304 --> -0.526641).  Saving model ...
Epoch: 4 cost time: 6.890904903411865
Epoch: 4, Steps: 18 | Train Loss: 2.082 Vali Loss: 2.154 Vali Acc: 0.613 Test Loss: 2.154 Test Acc: 0.613
Validation loss decreased (-0.526641 --> -0.613312).  Saving model ...
Epoch: 5 cost time: 6.752037048339844
Epoch: 5, Steps: 18 | Train Loss: 1.594 Vali Loss: 1.788 Vali Acc: 0.667 Test Loss: 1.788 Test Acc: 0.667
Validation loss decreased (-0.613312 --> -0.666649).  Saving model ...
Epoch: 6 cost time: 7.231463670730591
Epoch: 6, Steps: 18 | Train Loss: 1.073 Vali Loss: 1.456 Vali Acc: 0.703 Test Loss: 1.456 Test Acc: 0.703
Validation loss decreased (-0.666649 --> -0.703319).  Saving model ...
Epoch: 7 cost time: 7.210082769393921
Epoch: 7, Steps: 18 | Train Loss: 0.687 Vali Loss: 1.227 Vali Acc: 0.753 Test Loss: 1.227 Test Acc: 0.753
Validation loss decreased (-0.703319 --> -0.753321).  Saving model ...
Epoch: 8 cost time: 6.579045534133911
Epoch: 8, Steps: 18 | Train Loss: 0.404 Vali Loss: 1.051 Vali Acc: 0.760 Test Loss: 1.051 Test Acc: 0.760
Validation loss decreased (-0.753321 --> -0.759989).  Saving model ...
Epoch: 9 cost time: 6.5654823780059814
Epoch: 9, Steps: 18 | Train Loss: 0.230 Vali Loss: 0.975 Vali Acc: 0.763 Test Loss: 0.975 Test Acc: 0.763
Validation loss decreased (-0.759989 --> -0.763324).  Saving model ...
Epoch: 10 cost time: 6.8765387535095215
Epoch: 10, Steps: 18 | Train Loss: 0.129 Vali Loss: 0.903 Vali Acc: 0.797 Test Loss: 0.903 Test Acc: 0.797
Validation loss decreased (-0.763324 --> -0.796658).  Saving model ...
Epoch: 11 cost time: 7.1080451011657715
Epoch: 11, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.879 Vali Acc: 0.797 Test Loss: 0.879 Test Acc: 0.797
Validation loss decreased (-0.796658 --> -0.796658).  Saving model ...
Epoch: 12 cost time: 6.651674032211304
Epoch: 12, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.850 Vali Acc: 0.807 Test Loss: 0.850 Test Acc: 0.807
Validation loss decreased (-0.796658 --> -0.806658).  Saving model ...
Epoch: 13 cost time: 6.590504884719849
Epoch: 13, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.832 Vali Acc: 0.813 Test Loss: 0.832 Test Acc: 0.813
Validation loss decreased (-0.806658 --> -0.813325).  Saving model ...
Epoch: 14 cost time: 6.686950922012329
Epoch: 14, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.816 Vali Acc: 0.803 Test Loss: 0.816 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.385345458984375
Epoch: 15, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.816 Vali Acc: 0.820 Test Loss: 0.816 Test Acc: 0.820
Validation loss decreased (-0.813325 --> -0.819992).  Saving model ...
Epoch: 16 cost time: 6.706908226013184
Epoch: 16, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.809 Vali Acc: 0.820 Test Loss: 0.809 Test Acc: 0.820
Validation loss decreased (-0.819992 --> -0.819992).  Saving model ...
Epoch: 17 cost time: 6.683655500411987
Epoch: 17, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.794 Vali Acc: 0.817 Test Loss: 0.794 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.708707571029663
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.793 Vali Acc: 0.813 Test Loss: 0.793 Test Acc: 0.813
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.193085432052612
Epoch: 19, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.794 Vali Acc: 0.803 Test Loss: 0.794 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.429701328277588
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.788 Vali Acc: 0.803 Test Loss: 0.788 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.814127445220947
Epoch: 21, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.782 Vali Acc: 0.810 Test Loss: 0.782 Test Acc: 0.810
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.565767288208008
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.776 Vali Acc: 0.813 Test Loss: 0.776 Test Acc: 0.813
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.164873361587524
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.774 Vali Acc: 0.813 Test Loss: 0.774 Test Acc: 0.813
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.873932361602783
Epoch: 24, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.779 Vali Acc: 0.817 Test Loss: 0.779 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.970504283905029
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.773 Vali Acc: 0.813 Test Loss: 0.773 Test Acc: 0.813
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.81833291053772
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.775 Vali Acc: 0.807 Test Loss: 0.775 Test Acc: 0.807
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.82
model parameter : 256921
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.671744585037231
Epoch: 1, Steps: 18 | Train Loss: 3.282 Vali Loss: 3.230 Vali Acc: 0.067 Test Loss: 3.230 Test Acc: 0.067
Validation loss decreased (inf --> -0.066634).  Saving model ...
Epoch: 2 cost time: 7.158555746078491
Epoch: 2, Steps: 18 | Train Loss: 3.077 Vali Loss: 3.050 Vali Acc: 0.150 Test Loss: 3.050 Test Acc: 0.150
Validation loss decreased (-0.066634 --> -0.149970).  Saving model ...
Epoch: 3 cost time: 6.788736581802368
Epoch: 3, Steps: 18 | Train Loss: 2.782 Vali Loss: 2.843 Vali Acc: 0.283 Test Loss: 2.843 Test Acc: 0.283
Validation loss decreased (-0.149970 --> -0.283305).  Saving model ...
Epoch: 4 cost time: 6.4631428718566895
Epoch: 4, Steps: 18 | Train Loss: 2.411 Vali Loss: 2.605 Vali Acc: 0.350 Test Loss: 2.605 Test Acc: 0.350
Validation loss decreased (-0.283305 --> -0.349974).  Saving model ...
Epoch: 5 cost time: 6.334392070770264
Epoch: 5, Steps: 18 | Train Loss: 2.040 Vali Loss: 2.360 Vali Acc: 0.467 Test Loss: 2.360 Test Acc: 0.467
Validation loss decreased (-0.349974 --> -0.466643).  Saving model ...
Epoch: 6 cost time: 6.952376365661621
Epoch: 6, Steps: 18 | Train Loss: 1.539 Vali Loss: 2.111 Vali Acc: 0.503 Test Loss: 2.111 Test Acc: 0.503
Validation loss decreased (-0.466643 --> -0.503312).  Saving model ...
Epoch: 7 cost time: 6.286267280578613
Epoch: 7, Steps: 18 | Train Loss: 1.098 Vali Loss: 1.896 Vali Acc: 0.530 Test Loss: 1.896 Test Acc: 0.530
Validation loss decreased (-0.503312 --> -0.529981).  Saving model ...
Epoch: 8 cost time: 6.697575330734253
Epoch: 8, Steps: 18 | Train Loss: 0.724 Vali Loss: 1.713 Vali Acc: 0.580 Test Loss: 1.713 Test Acc: 0.580
Validation loss decreased (-0.529981 --> -0.579983).  Saving model ...
Epoch: 9 cost time: 6.696045398712158
Epoch: 9, Steps: 18 | Train Loss: 0.461 Vali Loss: 1.576 Vali Acc: 0.577 Test Loss: 1.576 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.131523132324219
Epoch: 10, Steps: 18 | Train Loss: 0.257 Vali Loss: 1.482 Vali Acc: 0.607 Test Loss: 1.482 Test Acc: 0.607
Validation loss decreased (-0.579983 --> -0.606652).  Saving model ...
Epoch: 11 cost time: 6.468298435211182
Epoch: 11, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.411 Vali Acc: 0.590 Test Loss: 1.411 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.068588733673096
Epoch: 12, Steps: 18 | Train Loss: 0.107 Vali Loss: 1.367 Vali Acc: 0.597 Test Loss: 1.367 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.108897686004639
Epoch: 13, Steps: 18 | Train Loss: 0.080 Vali Loss: 1.336 Vali Acc: 0.623 Test Loss: 1.336 Test Acc: 0.623
Validation loss decreased (-0.606652 --> -0.623320).  Saving model ...
Epoch: 14 cost time: 7.242438554763794
Epoch: 14, Steps: 18 | Train Loss: 0.061 Vali Loss: 1.299 Vali Acc: 0.627 Test Loss: 1.299 Test Acc: 0.627
Validation loss decreased (-0.623320 --> -0.626654).  Saving model ...
Epoch: 15 cost time: 6.400373220443726
Epoch: 15, Steps: 18 | Train Loss: 0.046 Vali Loss: 1.286 Vali Acc: 0.623 Test Loss: 1.286 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.718817234039307
Epoch: 16, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.271 Vali Acc: 0.643 Test Loss: 1.271 Test Acc: 0.643
Validation loss decreased (-0.626654 --> -0.643321).  Saving model ...
Epoch: 17 cost time: 6.298000812530518
Epoch: 17, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.250 Vali Acc: 0.633 Test Loss: 1.250 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.852169752120972
Epoch: 18, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.249 Vali Acc: 0.627 Test Loss: 1.249 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.357975244522095
Epoch: 19, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.238 Vali Acc: 0.633 Test Loss: 1.238 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.2831737995147705
Epoch: 20, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.223 Vali Acc: 0.650 Test Loss: 1.223 Test Acc: 0.650
Validation loss decreased (-0.643321 --> -0.649988).  Saving model ...
Epoch: 21 cost time: 6.594592809677124
Epoch: 21, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.216 Vali Acc: 0.640 Test Loss: 1.216 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.985901355743408
Epoch: 22, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.202 Vali Acc: 0.643 Test Loss: 1.202 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.7499542236328125
Epoch: 23, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.203 Vali Acc: 0.653 Test Loss: 1.203 Test Acc: 0.653
Validation loss decreased (-0.649988 --> -0.653321).  Saving model ...
Epoch: 24 cost time: 7.43086051940918
Epoch: 24, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.203 Vali Acc: 0.650 Test Loss: 1.203 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.136505603790283
Epoch: 25, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.191 Vali Acc: 0.637 Test Loss: 1.191 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.835039138793945
Epoch: 26, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.184 Vali Acc: 0.653 Test Loss: 1.184 Test Acc: 0.653
Validation loss decreased (-0.653321 --> -0.653321).  Saving model ...
Epoch: 27 cost time: 6.6118340492248535
Epoch: 27, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.177 Vali Acc: 0.657 Test Loss: 1.177 Test Acc: 0.657
Validation loss decreased (-0.653321 --> -0.656655).  Saving model ...
Epoch: 28 cost time: 6.681135654449463
Epoch: 28, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.182 Vali Acc: 0.657 Test Loss: 1.182 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.684076309204102
Epoch: 29, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.177 Vali Acc: 0.653 Test Loss: 1.177 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.917121171951294
Epoch: 30, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.168 Vali Acc: 0.650 Test Loss: 1.168 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 7.018833875656128
Epoch: 31, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.161 Vali Acc: 0.657 Test Loss: 1.161 Test Acc: 0.657
Validation loss decreased (-0.656655 --> -0.656655).  Saving model ...
Epoch: 32 cost time: 6.696580410003662
Epoch: 32, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.161 Vali Acc: 0.657 Test Loss: 1.161 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 7.050773859024048
Epoch: 33, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.153 Vali Acc: 0.650 Test Loss: 1.153 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 7.318323373794556
Epoch: 34, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.148 Vali Acc: 0.660 Test Loss: 1.148 Test Acc: 0.660
Validation loss decreased (-0.656655 --> -0.659989).  Saving model ...
Epoch: 35 cost time: 7.6004798412323
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.145 Vali Acc: 0.670 Test Loss: 1.145 Test Acc: 0.670
Validation loss decreased (-0.659989 --> -0.669989).  Saving model ...
Epoch: 36 cost time: 7.153651237487793
Epoch: 36, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.145 Vali Acc: 0.657 Test Loss: 1.145 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 7.415647268295288
Epoch: 37, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.144 Vali Acc: 0.663 Test Loss: 1.144 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 6.648065805435181
Epoch: 38, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.142 Vali Acc: 0.667 Test Loss: 1.142 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 6.36348032951355
Epoch: 39, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.143 Vali Acc: 0.660 Test Loss: 1.143 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 7.089919567108154
Epoch: 40, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.136 Vali Acc: 0.663 Test Loss: 1.136 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 6.621553421020508
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.134 Vali Acc: 0.653 Test Loss: 1.134 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 7.124593019485474
Epoch: 42, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.130 Vali Acc: 0.660 Test Loss: 1.130 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 7.02372145652771
Epoch: 43, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.125 Vali Acc: 0.663 Test Loss: 1.125 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 7.406710386276245
Epoch: 44, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.119 Vali Acc: 0.657 Test Loss: 1.119 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 6.841678857803345
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.121 Vali Acc: 0.680 Test Loss: 1.121 Test Acc: 0.680
Validation loss decreased (-0.669989 --> -0.679989).  Saving model ...
Epoch: 46 cost time: 7.063999652862549
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.118 Vali Acc: 0.683 Test Loss: 1.118 Test Acc: 0.683
Validation loss decreased (-0.679989 --> -0.683322).  Saving model ...
Epoch: 47 cost time: 6.628480434417725
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.123 Vali Acc: 0.683 Test Loss: 1.123 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 6.600193500518799
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.123 Vali Acc: 0.680 Test Loss: 1.123 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 6.919640064239502
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.119 Vali Acc: 0.683 Test Loss: 1.119 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 6.768521308898926
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.118 Vali Acc: 0.683 Test Loss: 1.118 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 51 cost time: 6.6543097496032715
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.117 Vali Acc: 0.680 Test Loss: 1.117 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.832019329071045
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.114 Vali Acc: 0.687 Test Loss: 1.114 Test Acc: 0.687
Validation loss decreased (-0.683322 --> -0.686656).  Saving model ...
Epoch: 53 cost time: 6.517770767211914
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.112 Vali Acc: 0.683 Test Loss: 1.112 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.982943534851074
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.110 Vali Acc: 0.690 Test Loss: 1.110 Test Acc: 0.690
Validation loss decreased (-0.686656 --> -0.689989).  Saving model ...
Epoch: 55 cost time: 6.907800197601318
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.109 Vali Acc: 0.690 Test Loss: 1.109 Test Acc: 0.690
Validation loss decreased (-0.689989 --> -0.689989).  Saving model ...
Epoch: 56 cost time: 7.853061199188232
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.101 Vali Acc: 0.687 Test Loss: 1.101 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 7.37635064125061
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.099 Vali Acc: 0.690 Test Loss: 1.099 Test Acc: 0.690
Validation loss decreased (-0.689989 --> -0.689989).  Saving model ...
Epoch: 58 cost time: 6.957892656326294
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.098 Vali Acc: 0.693 Test Loss: 1.098 Test Acc: 0.693
Validation loss decreased (-0.689989 --> -0.693322).  Saving model ...
Epoch: 59 cost time: 7.684539556503296
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.101 Vali Acc: 0.693 Test Loss: 1.101 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 6.602015972137451
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.100 Vali Acc: 0.697 Test Loss: 1.100 Test Acc: 0.697
Validation loss decreased (-0.693322 --> -0.696656).  Saving model ...
Epoch: 61 cost time: 7.041452169418335
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.101 Vali Acc: 0.697 Test Loss: 1.101 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.501967430114746
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.102 Vali Acc: 0.690 Test Loss: 1.102 Test Acc: 0.690
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 6.355048418045044
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.101 Vali Acc: 0.697 Test Loss: 1.101 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 7.087639093399048
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.100 Vali Acc: 0.700 Test Loss: 1.100 Test Acc: 0.700
Validation loss decreased (-0.696656 --> -0.699989).  Saving model ...
Epoch: 65 cost time: 7.454957723617554
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.097 Vali Acc: 0.690 Test Loss: 1.097 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 7.178377866744995
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.097 Vali Acc: 0.700 Test Loss: 1.097 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 67 cost time: 7.532423734664917
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.096 Vali Acc: 0.700 Test Loss: 1.096 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 68 cost time: 6.67993426322937
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.093 Vali Acc: 0.703 Test Loss: 1.093 Test Acc: 0.703
Validation loss decreased (-0.699989 --> -0.703322).  Saving model ...
Epoch: 69 cost time: 6.841659307479858
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.092 Vali Acc: 0.700 Test Loss: 1.092 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 7.121996164321899
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.091 Vali Acc: 0.700 Test Loss: 1.091 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 6.62673544883728
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.090 Vali Acc: 0.707 Test Loss: 1.090 Test Acc: 0.707
Validation loss decreased (-0.703322 --> -0.706656).  Saving model ...
Epoch: 72 cost time: 7.166320562362671
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.089 Vali Acc: 0.703 Test Loss: 1.089 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 6.847881078720093
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.088 Vali Acc: 0.703 Test Loss: 1.088 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 6.965958118438721
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.086 Vali Acc: 0.703 Test Loss: 1.086 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 7.750141143798828
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.084 Vali Acc: 0.700 Test Loss: 1.084 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 6.785898208618164
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.083 Vali Acc: 0.710 Test Loss: 1.083 Test Acc: 0.710
Validation loss decreased (-0.706656 --> -0.709989).  Saving model ...
Epoch: 77 cost time: 6.70832371711731
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.083 Vali Acc: 0.710 Test Loss: 1.083 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 6.80284309387207
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.081 Vali Acc: 0.713 Test Loss: 1.081 Test Acc: 0.713
Validation loss decreased (-0.709989 --> -0.713323).  Saving model ...
Epoch: 79 cost time: 6.922590732574463
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.713 Test Loss: 1.079 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 80 cost time: 7.11243462562561
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.078 Vali Acc: 0.710 Test Loss: 1.078 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 6.726097106933594
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.078 Vali Acc: 0.710 Test Loss: 1.078 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 6.71535062789917
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.078 Vali Acc: 0.713 Test Loss: 1.078 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 83 cost time: 6.766698598861694
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.077 Vali Acc: 0.713 Test Loss: 1.077 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 84 cost time: 7.2451677322387695
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.078 Vali Acc: 0.710 Test Loss: 1.078 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 6.4772374629974365
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.077 Vali Acc: 0.707 Test Loss: 1.077 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 6.620774984359741
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.077 Vali Acc: 0.713 Test Loss: 1.077 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 6.847663402557373
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.077 Vali Acc: 0.710 Test Loss: 1.077 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 7.111745834350586
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.076 Vali Acc: 0.710 Test Loss: 1.076 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 7.72078013420105
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.710 Test Loss: 1.075 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 6.888074159622192
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.073 Vali Acc: 0.713 Test Loss: 1.073 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 91 cost time: 7.4045093059539795
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.074 Vali Acc: 0.710 Test Loss: 1.074 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 6.284342050552368
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.710 Test Loss: 1.073 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 6.359771966934204
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.717 Test Loss: 1.074 Test Acc: 0.717
Validation loss decreased (-0.713323 --> -0.716656).  Saving model ...
Epoch: 94 cost time: 6.42348575592041
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.713 Test Loss: 1.071 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 6.401528835296631
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.713 Test Loss: 1.073 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 7.251338243484497
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.713 Test Loss: 1.073 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 7.40562891960144
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.710 Test Loss: 1.074 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 6.759958982467651
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.707 Test Loss: 1.074 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 6.7188849449157715
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.703 Test Loss: 1.072 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 6.965146064758301
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.703 Test Loss: 1.071 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7166666666666667
model parameter : 256921
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.8081793785095215
Epoch: 1, Steps: 18 | Train Loss: 3.299 Vali Loss: 3.246 Vali Acc: 0.050 Test Loss: 3.246 Test Acc: 0.050
Validation loss decreased (inf --> -0.049968).  Saving model ...
Epoch: 2 cost time: 6.299877405166626
Epoch: 2, Steps: 18 | Train Loss: 3.104 Vali Loss: 3.121 Vali Acc: 0.110 Test Loss: 3.121 Test Acc: 0.110
Validation loss decreased (-0.049968 --> -0.109969).  Saving model ...
Epoch: 3 cost time: 6.56496000289917
Epoch: 3, Steps: 18 | Train Loss: 2.870 Vali Loss: 2.988 Vali Acc: 0.193 Test Loss: 2.988 Test Acc: 0.193
Validation loss decreased (-0.109969 --> -0.193303).  Saving model ...
Epoch: 4 cost time: 6.6659862995147705
Epoch: 4, Steps: 18 | Train Loss: 2.553 Vali Loss: 2.839 Vali Acc: 0.237 Test Loss: 2.839 Test Acc: 0.237
Validation loss decreased (-0.193303 --> -0.236638).  Saving model ...
Epoch: 5 cost time: 6.636057615280151
Epoch: 5, Steps: 18 | Train Loss: 2.225 Vali Loss: 2.679 Vali Acc: 0.300 Test Loss: 2.679 Test Acc: 0.300
Validation loss decreased (-0.236638 --> -0.299973).  Saving model ...
Epoch: 6 cost time: 6.224406957626343
Epoch: 6, Steps: 18 | Train Loss: 1.804 Vali Loss: 2.517 Vali Acc: 0.363 Test Loss: 2.517 Test Acc: 0.363
Validation loss decreased (-0.299973 --> -0.363308).  Saving model ...
Epoch: 7 cost time: 6.246600866317749
Epoch: 7, Steps: 18 | Train Loss: 1.421 Vali Loss: 2.368 Vali Acc: 0.363 Test Loss: 2.368 Test Acc: 0.363
Validation loss decreased (-0.363308 --> -0.363310).  Saving model ...
Epoch: 8 cost time: 6.824418783187866
Epoch: 8, Steps: 18 | Train Loss: 1.040 Vali Loss: 2.234 Vali Acc: 0.393 Test Loss: 2.234 Test Acc: 0.393
Validation loss decreased (-0.363310 --> -0.393311).  Saving model ...
Epoch: 9 cost time: 7.006914854049683
Epoch: 9, Steps: 18 | Train Loss: 0.729 Vali Loss: 2.115 Vali Acc: 0.417 Test Loss: 2.115 Test Acc: 0.417
Validation loss decreased (-0.393311 --> -0.416646).  Saving model ...
Epoch: 10 cost time: 7.459126949310303
Epoch: 10, Steps: 18 | Train Loss: 0.467 Vali Loss: 2.010 Vali Acc: 0.403 Test Loss: 2.010 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.871514081954956
Epoch: 11, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.921 Vali Acc: 0.443 Test Loss: 1.921 Test Acc: 0.443
Validation loss decreased (-0.416646 --> -0.443314).  Saving model ...
Epoch: 12 cost time: 6.929039239883423
Epoch: 12, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.857 Vali Acc: 0.473 Test Loss: 1.857 Test Acc: 0.473
Validation loss decreased (-0.443314 --> -0.473315).  Saving model ...
Epoch: 13 cost time: 6.876292943954468
Epoch: 13, Steps: 18 | Train Loss: 0.126 Vali Loss: 1.805 Vali Acc: 0.470 Test Loss: 1.805 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.8166234493255615
Epoch: 14, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.740 Vali Acc: 0.490 Test Loss: 1.740 Test Acc: 0.490
Validation loss decreased (-0.473315 --> -0.489983).  Saving model ...
Epoch: 15 cost time: 6.778745174407959
Epoch: 15, Steps: 18 | Train Loss: 0.063 Vali Loss: 1.704 Vali Acc: 0.520 Test Loss: 1.704 Test Acc: 0.520
Validation loss decreased (-0.489983 --> -0.519983).  Saving model ...
Epoch: 16 cost time: 5.717134237289429
Epoch: 16, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.667 Vali Acc: 0.520 Test Loss: 1.667 Test Acc: 0.520
Validation loss decreased (-0.519983 --> -0.519983).  Saving model ...
Epoch: 17 cost time: 7.150243759155273
Epoch: 17, Steps: 18 | Train Loss: 0.041 Vali Loss: 1.632 Vali Acc: 0.527 Test Loss: 1.632 Test Acc: 0.527
Validation loss decreased (-0.519983 --> -0.526650).  Saving model ...
Epoch: 18 cost time: 7.455310106277466
Epoch: 18, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.625 Vali Acc: 0.510 Test Loss: 1.625 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.042953014373779
Epoch: 19, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.599 Vali Acc: 0.530 Test Loss: 1.599 Test Acc: 0.530
Validation loss decreased (-0.526650 --> -0.529984).  Saving model ...
Epoch: 20 cost time: 6.587430238723755
Epoch: 20, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.583 Vali Acc: 0.530 Test Loss: 1.583 Test Acc: 0.530
Validation loss decreased (-0.529984 --> -0.529984).  Saving model ...
Epoch: 21 cost time: 6.3981614112854
Epoch: 21, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.560 Vali Acc: 0.533 Test Loss: 1.560 Test Acc: 0.533
Validation loss decreased (-0.529984 --> -0.533318).  Saving model ...
Epoch: 22 cost time: 6.408108949661255
Epoch: 22, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.542 Vali Acc: 0.530 Test Loss: 1.542 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.597048997879028
Epoch: 23, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.532 Vali Acc: 0.533 Test Loss: 1.532 Test Acc: 0.533
Validation loss decreased (-0.533318 --> -0.533318).  Saving model ...
Epoch: 24 cost time: 6.721432685852051
Epoch: 24, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.523 Vali Acc: 0.547 Test Loss: 1.523 Test Acc: 0.547
Validation loss decreased (-0.533318 --> -0.546651).  Saving model ...
Epoch: 25 cost time: 7.4520533084869385
Epoch: 25, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.505 Vali Acc: 0.540 Test Loss: 1.505 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.113475322723389
Epoch: 26, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.497 Vali Acc: 0.550 Test Loss: 1.497 Test Acc: 0.550
Validation loss decreased (-0.546651 --> -0.549985).  Saving model ...
Epoch: 27 cost time: 7.050796747207642
Epoch: 27, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.488 Vali Acc: 0.550 Test Loss: 1.488 Test Acc: 0.550
Validation loss decreased (-0.549985 --> -0.549985).  Saving model ...
Epoch: 28 cost time: 6.531466484069824
Epoch: 28, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.479 Vali Acc: 0.557 Test Loss: 1.479 Test Acc: 0.557
Validation loss decreased (-0.549985 --> -0.556652).  Saving model ...
Epoch: 29 cost time: 6.564586400985718
Epoch: 29, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.475 Vali Acc: 0.567 Test Loss: 1.475 Test Acc: 0.567
Validation loss decreased (-0.556652 --> -0.566652).  Saving model ...
Epoch: 30 cost time: 6.934414625167847
Epoch: 30, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.466 Vali Acc: 0.560 Test Loss: 1.466 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 7.155943870544434
Epoch: 31, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.458 Vali Acc: 0.573 Test Loss: 1.458 Test Acc: 0.573
Validation loss decreased (-0.566652 --> -0.573319).  Saving model ...
Epoch: 32 cost time: 6.928383111953735
Epoch: 32, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.457 Vali Acc: 0.557 Test Loss: 1.457 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 7.085499048233032
Epoch: 33, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.450 Vali Acc: 0.560 Test Loss: 1.450 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.938593149185181
Epoch: 34, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.442 Vali Acc: 0.560 Test Loss: 1.442 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 6.669742822647095
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.435 Vali Acc: 0.573 Test Loss: 1.435 Test Acc: 0.573
Validation loss decreased (-0.573319 --> -0.573319).  Saving model ...
Epoch: 36 cost time: 6.604153394699097
Epoch: 36, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.434 Vali Acc: 0.587 Test Loss: 1.434 Test Acc: 0.587
Validation loss decreased (-0.573319 --> -0.586652).  Saving model ...
Epoch: 37 cost time: 6.7530481815338135
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.426 Vali Acc: 0.587 Test Loss: 1.426 Test Acc: 0.587
Validation loss decreased (-0.586652 --> -0.586652).  Saving model ...
Epoch: 38 cost time: 6.978872060775757
Epoch: 38, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.427 Vali Acc: 0.593 Test Loss: 1.427 Test Acc: 0.593
Validation loss decreased (-0.586652 --> -0.593319).  Saving model ...
Epoch: 39 cost time: 7.418110609054565
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.442 Vali Acc: 0.580 Test Loss: 1.442 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 7.4616639614105225
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.429 Vali Acc: 0.580 Test Loss: 1.429 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.553143739700317
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.419 Vali Acc: 0.590 Test Loss: 1.419 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 6.829209804534912
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.412 Vali Acc: 0.597 Test Loss: 1.412 Test Acc: 0.597
Validation loss decreased (-0.593319 --> -0.596653).  Saving model ...
Epoch: 43 cost time: 6.575059175491333
Epoch: 43, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.403 Vali Acc: 0.590 Test Loss: 1.403 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.935350656509399
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.397 Vali Acc: 0.600 Test Loss: 1.397 Test Acc: 0.600
Validation loss decreased (-0.596653 --> -0.599986).  Saving model ...
Epoch: 45 cost time: 7.307261228561401
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.396 Vali Acc: 0.607 Test Loss: 1.396 Test Acc: 0.607
Validation loss decreased (-0.599986 --> -0.606653).  Saving model ...
Epoch: 46 cost time: 6.856699705123901
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.390 Vali Acc: 0.600 Test Loss: 1.390 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 7.219492197036743
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.386 Vali Acc: 0.607 Test Loss: 1.386 Test Acc: 0.607
Validation loss decreased (-0.606653 --> -0.606653).  Saving model ...
Epoch: 48 cost time: 6.933985948562622
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.383 Vali Acc: 0.607 Test Loss: 1.383 Test Acc: 0.607
Validation loss decreased (-0.606653 --> -0.606653).  Saving model ...
Epoch: 49 cost time: 6.357562303543091
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.382 Vali Acc: 0.607 Test Loss: 1.382 Test Acc: 0.607
Validation loss decreased (-0.606653 --> -0.606653).  Saving model ...
Epoch: 50 cost time: 6.514044284820557
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.381 Vali Acc: 0.600 Test Loss: 1.381 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 6.138819932937622
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.378 Vali Acc: 0.603 Test Loss: 1.378 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 6.576407432556152
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.372 Vali Acc: 0.613 Test Loss: 1.372 Test Acc: 0.613
Validation loss decreased (-0.606653 --> -0.613320).  Saving model ...
Epoch: 53 cost time: 7.32599139213562
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.370 Vali Acc: 0.613 Test Loss: 1.370 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 54 cost time: 6.946448802947998
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.369 Vali Acc: 0.603 Test Loss: 1.369 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.9776434898376465
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.368 Vali Acc: 0.603 Test Loss: 1.368 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 6.8353798389434814
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.365 Vali Acc: 0.610 Test Loss: 1.365 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 6.901332378387451
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.364 Vali Acc: 0.610 Test Loss: 1.364 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 6.649487257003784
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.363 Vali Acc: 0.613 Test Loss: 1.363 Test Acc: 0.613
Validation loss decreased (-0.613320 --> -0.613320).  Saving model ...
Epoch: 59 cost time: 6.534430742263794
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.368 Vali Acc: 0.620 Test Loss: 1.368 Test Acc: 0.620
Validation loss decreased (-0.613320 --> -0.619986).  Saving model ...
Epoch: 60 cost time: 7.208266258239746
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.367 Vali Acc: 0.617 Test Loss: 1.367 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.4888389110565186
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.363 Vali Acc: 0.623 Test Loss: 1.363 Test Acc: 0.623
Validation loss decreased (-0.619986 --> -0.623320).  Saving model ...
Epoch: 62 cost time: 6.489258050918579
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.359 Vali Acc: 0.613 Test Loss: 1.359 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 6.617693901062012
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.355 Vali Acc: 0.613 Test Loss: 1.355 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 6.9055259227752686
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.353 Vali Acc: 0.610 Test Loss: 1.353 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 6.0537896156311035
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.351 Vali Acc: 0.613 Test Loss: 1.351 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 6.596484899520874
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.348 Vali Acc: 0.617 Test Loss: 1.348 Test Acc: 0.617
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 6.784520387649536
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.610 Test Loss: 1.345 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 6.9363791942596436
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.341 Vali Acc: 0.613 Test Loss: 1.341 Test Acc: 0.613
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 7.0540642738342285
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.339 Vali Acc: 0.617 Test Loss: 1.339 Test Acc: 0.617
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 6.622434377670288
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.336 Vali Acc: 0.613 Test Loss: 1.336 Test Acc: 0.613
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 6.8657026290893555
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.335 Vali Acc: 0.623 Test Loss: 1.335 Test Acc: 0.623
Validation loss decreased (-0.623320 --> -0.623320).  Saving model ...
Epoch: 72 cost time: 6.547753095626831
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.334 Vali Acc: 0.620 Test Loss: 1.334 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 6.429670095443726
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.333 Vali Acc: 0.617 Test Loss: 1.333 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 6.4440758228302
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.332 Vali Acc: 0.620 Test Loss: 1.332 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 6.4936158657073975
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.331 Vali Acc: 0.620 Test Loss: 1.331 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 6.555329084396362
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.329 Vali Acc: 0.613 Test Loss: 1.329 Test Acc: 0.613
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 6.71071982383728
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.613 Test Loss: 1.330 Test Acc: 0.613
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 6.621413230895996
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.627 Test Loss: 1.328 Test Acc: 0.627
Validation loss decreased (-0.623320 --> -0.626653).  Saving model ...
Epoch: 79 cost time: 6.642768383026123
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.623 Test Loss: 1.328 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 6.916235685348511
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.329 Vali Acc: 0.617 Test Loss: 1.329 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 6.940381765365601
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.620 Test Loss: 1.330 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 6.235832691192627
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.623 Test Loss: 1.330 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 5.965399742126465
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.620 Test Loss: 1.330 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 5.933857679367065
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.620 Test Loss: 1.330 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 6.60981297492981
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.331 Vali Acc: 0.620 Test Loss: 1.331 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 6.800076723098755
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.623 Test Loss: 1.330 Test Acc: 0.623
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 6.56409478187561
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.633 Test Loss: 1.328 Test Acc: 0.633
Validation loss decreased (-0.626653 --> -0.633320).  Saving model ...
Epoch: 88 cost time: 6.596472978591919
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.630 Test Loss: 1.328 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 6.5490562915802
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.327 Vali Acc: 0.633 Test Loss: 1.327 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 90 cost time: 6.444756746292114
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.633 Test Loss: 1.323 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 91 cost time: 7.173867464065552
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.322 Vali Acc: 0.633 Test Loss: 1.322 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 92 cost time: 6.4163408279418945
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.322 Vali Acc: 0.633 Test Loss: 1.322 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 93 cost time: 6.7720112800598145
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.321 Vali Acc: 0.633 Test Loss: 1.321 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 94 cost time: 7.102842092514038
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.630 Test Loss: 1.323 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 6.213269948959351
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.627 Test Loss: 1.324 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 6.414318084716797
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.630 Test Loss: 1.324 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 5.884422779083252
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.630 Test Loss: 1.321 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 7.200655221939087
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.320 Vali Acc: 0.630 Test Loss: 1.320 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 7.438480854034424
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.627 Test Loss: 1.322 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 6.942721128463745
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.623 Test Loss: 1.323 Test Acc: 0.623
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6333333333333333
model parameter : 256921
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.317059755325317
Epoch: 1, Steps: 18 | Train Loss: 3.314 Vali Loss: 3.273 Vali Acc: 0.057 Test Loss: 3.273 Test Acc: 0.057
Validation loss decreased (inf --> -0.056634).  Saving model ...
Epoch: 2 cost time: 6.753214359283447
Epoch: 2, Steps: 18 | Train Loss: 3.130 Vali Loss: 3.172 Vali Acc: 0.103 Test Loss: 3.172 Test Acc: 0.103
Validation loss decreased (-0.056634 --> -0.103302).  Saving model ...
Epoch: 3 cost time: 6.592824220657349
Epoch: 3, Steps: 18 | Train Loss: 2.911 Vali Loss: 3.075 Vali Acc: 0.130 Test Loss: 3.075 Test Acc: 0.130
Validation loss decreased (-0.103302 --> -0.129969).  Saving model ...
Epoch: 4 cost time: 6.11702823638916
Epoch: 4, Steps: 18 | Train Loss: 2.646 Vali Loss: 2.970 Vali Acc: 0.157 Test Loss: 2.970 Test Acc: 0.157
Validation loss decreased (-0.129969 --> -0.156637).  Saving model ...
Epoch: 5 cost time: 6.765475273132324
Epoch: 5, Steps: 18 | Train Loss: 2.329 Vali Loss: 2.863 Vali Acc: 0.230 Test Loss: 2.863 Test Acc: 0.230
Validation loss decreased (-0.156637 --> -0.229971).  Saving model ...
Epoch: 6 cost time: 6.156883239746094
Epoch: 6, Steps: 18 | Train Loss: 1.948 Vali Loss: 2.761 Vali Acc: 0.237 Test Loss: 2.761 Test Acc: 0.237
Validation loss decreased (-0.229971 --> -0.236639).  Saving model ...
Epoch: 7 cost time: 6.087851524353027
Epoch: 7, Steps: 18 | Train Loss: 1.585 Vali Loss: 2.655 Vali Acc: 0.293 Test Loss: 2.655 Test Acc: 0.293
Validation loss decreased (-0.236639 --> -0.293307).  Saving model ...
Epoch: 8 cost time: 6.081358194351196
Epoch: 8, Steps: 18 | Train Loss: 1.228 Vali Loss: 2.576 Vali Acc: 0.297 Test Loss: 2.576 Test Acc: 0.297
Validation loss decreased (-0.293307 --> -0.296641).  Saving model ...
Epoch: 9 cost time: 6.6769256591796875
Epoch: 9, Steps: 18 | Train Loss: 0.916 Vali Loss: 2.493 Vali Acc: 0.297 Test Loss: 2.493 Test Acc: 0.297
Validation loss decreased (-0.296641 --> -0.296642).  Saving model ...
Epoch: 10 cost time: 6.337530612945557
Epoch: 10, Steps: 18 | Train Loss: 0.596 Vali Loss: 2.438 Vali Acc: 0.300 Test Loss: 2.438 Test Acc: 0.300
Validation loss decreased (-0.296642 --> -0.299976).  Saving model ...
Epoch: 11 cost time: 6.70212459564209
Epoch: 11, Steps: 18 | Train Loss: 0.428 Vali Loss: 2.386 Vali Acc: 0.323 Test Loss: 2.386 Test Acc: 0.323
Validation loss decreased (-0.299976 --> -0.323309).  Saving model ...
Epoch: 12 cost time: 6.409123182296753
Epoch: 12, Steps: 18 | Train Loss: 0.270 Vali Loss: 2.329 Vali Acc: 0.333 Test Loss: 2.329 Test Acc: 0.333
Validation loss decreased (-0.323309 --> -0.333310).  Saving model ...
Epoch: 13 cost time: 6.860822677612305
Epoch: 13, Steps: 18 | Train Loss: 0.185 Vali Loss: 2.276 Vali Acc: 0.350 Test Loss: 2.276 Test Acc: 0.350
Validation loss decreased (-0.333310 --> -0.349977).  Saving model ...
Epoch: 14 cost time: 6.18812894821167
Epoch: 14, Steps: 18 | Train Loss: 0.138 Vali Loss: 2.253 Vali Acc: 0.343 Test Loss: 2.253 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.299918174743652
Epoch: 15, Steps: 18 | Train Loss: 0.096 Vali Loss: 2.232 Vali Acc: 0.380 Test Loss: 2.232 Test Acc: 0.380
Validation loss decreased (-0.349977 --> -0.379978).  Saving model ...
Epoch: 16 cost time: 5.698266983032227
Epoch: 16, Steps: 18 | Train Loss: 0.073 Vali Loss: 2.185 Vali Acc: 0.380 Test Loss: 2.185 Test Acc: 0.380
Validation loss decreased (-0.379978 --> -0.379978).  Saving model ...
Epoch: 17 cost time: 6.751367568969727
Epoch: 17, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.169 Vali Acc: 0.360 Test Loss: 2.169 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.406504392623901
Epoch: 18, Steps: 18 | Train Loss: 0.045 Vali Loss: 2.156 Vali Acc: 0.380 Test Loss: 2.156 Test Acc: 0.380
Validation loss decreased (-0.379978 --> -0.379978).  Saving model ...
Epoch: 19 cost time: 6.545008659362793
Epoch: 19, Steps: 18 | Train Loss: 0.039 Vali Loss: 2.135 Vali Acc: 0.387 Test Loss: 2.135 Test Acc: 0.387
Validation loss decreased (-0.379978 --> -0.386645).  Saving model ...
Epoch: 20 cost time: 6.2011237144470215
Epoch: 20, Steps: 18 | Train Loss: 0.031 Vali Loss: 2.118 Vali Acc: 0.403 Test Loss: 2.118 Test Acc: 0.403
Validation loss decreased (-0.386645 --> -0.403312).  Saving model ...
Epoch: 21 cost time: 6.714060068130493
Epoch: 21, Steps: 18 | Train Loss: 0.026 Vali Loss: 2.110 Vali Acc: 0.397 Test Loss: 2.110 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.453687906265259
Epoch: 22, Steps: 18 | Train Loss: 0.025 Vali Loss: 2.092 Vali Acc: 0.413 Test Loss: 2.092 Test Acc: 0.413
Validation loss decreased (-0.403312 --> -0.413312).  Saving model ...
Epoch: 23 cost time: 6.759021043777466
Epoch: 23, Steps: 18 | Train Loss: 0.024 Vali Loss: 2.083 Vali Acc: 0.400 Test Loss: 2.083 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.792518138885498
Epoch: 24, Steps: 18 | Train Loss: 0.021 Vali Loss: 2.070 Vali Acc: 0.403 Test Loss: 2.070 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.974214792251587
Epoch: 25, Steps: 18 | Train Loss: 0.019 Vali Loss: 2.040 Vali Acc: 0.417 Test Loss: 2.040 Test Acc: 0.417
Validation loss decreased (-0.413312 --> -0.416646).  Saving model ...
Epoch: 26 cost time: 7.466948509216309
Epoch: 26, Steps: 18 | Train Loss: 0.016 Vali Loss: 2.033 Vali Acc: 0.420 Test Loss: 2.033 Test Acc: 0.420
Validation loss decreased (-0.416646 --> -0.419980).  Saving model ...
Epoch: 27 cost time: 6.765202522277832
Epoch: 27, Steps: 18 | Train Loss: 0.013 Vali Loss: 2.015 Vali Acc: 0.430 Test Loss: 2.015 Test Acc: 0.430
Validation loss decreased (-0.419980 --> -0.429980).  Saving model ...
Epoch: 28 cost time: 6.519968271255493
Epoch: 28, Steps: 18 | Train Loss: 0.013 Vali Loss: 2.012 Vali Acc: 0.427 Test Loss: 2.012 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.2876622676849365
Epoch: 29, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.993 Vali Acc: 0.430 Test Loss: 1.993 Test Acc: 0.430
Validation loss decreased (-0.429980 --> -0.429980).  Saving model ...
Epoch: 30 cost time: 7.055629730224609
Epoch: 30, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.973 Vali Acc: 0.433 Test Loss: 1.973 Test Acc: 0.433
Validation loss decreased (-0.429980 --> -0.433314).  Saving model ...
Epoch: 31 cost time: 7.221029281616211
Epoch: 31, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.973 Vali Acc: 0.427 Test Loss: 1.973 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 7.0944983959198
Epoch: 32, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.969 Vali Acc: 0.423 Test Loss: 1.969 Test Acc: 0.423
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 7.221107721328735
Epoch: 33, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.956 Vali Acc: 0.437 Test Loss: 1.956 Test Acc: 0.437
Validation loss decreased (-0.433314 --> -0.436647).  Saving model ...
Epoch: 34 cost time: 6.680849075317383
Epoch: 34, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.946 Vali Acc: 0.440 Test Loss: 1.946 Test Acc: 0.440
Validation loss decreased (-0.436647 --> -0.439981).  Saving model ...
Epoch: 35 cost time: 6.866062641143799
Epoch: 35, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.934 Vali Acc: 0.443 Test Loss: 1.934 Test Acc: 0.443
Validation loss decreased (-0.439981 --> -0.443314).  Saving model ...
Epoch: 36 cost time: 6.891407012939453
Epoch: 36, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.925 Vali Acc: 0.443 Test Loss: 1.925 Test Acc: 0.443
Validation loss decreased (-0.443314 --> -0.443314).  Saving model ...
Epoch: 37 cost time: 6.614478349685669
Epoch: 37, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.910 Vali Acc: 0.453 Test Loss: 1.910 Test Acc: 0.453
Validation loss decreased (-0.443314 --> -0.453314).  Saving model ...
Epoch: 38 cost time: 6.904878854751587
Epoch: 38, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.903 Vali Acc: 0.450 Test Loss: 1.903 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.8046324253082275
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.903 Vali Acc: 0.440 Test Loss: 1.903 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.291924476623535
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.900 Vali Acc: 0.447 Test Loss: 1.900 Test Acc: 0.447
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 5.85355544090271
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.888 Vali Acc: 0.463 Test Loss: 1.888 Test Acc: 0.463
Validation loss decreased (-0.453314 --> -0.463314).  Saving model ...
Epoch: 42 cost time: 6.577035665512085
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.884 Vali Acc: 0.470 Test Loss: 1.884 Test Acc: 0.470
Validation loss decreased (-0.463314 --> -0.469981).  Saving model ...
Epoch: 43 cost time: 7.38052773475647
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.874 Vali Acc: 0.467 Test Loss: 1.874 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 7.007633209228516
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.872 Vali Acc: 0.457 Test Loss: 1.872 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 7.503986358642578
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.857 Vali Acc: 0.470 Test Loss: 1.857 Test Acc: 0.470
Validation loss decreased (-0.469981 --> -0.469981).  Saving model ...
Epoch: 46 cost time: 6.6945154666900635
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.851 Vali Acc: 0.460 Test Loss: 1.851 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.941903352737427
Epoch: 47, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.848 Vali Acc: 0.460 Test Loss: 1.848 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 6.628782272338867
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.842 Vali Acc: 0.467 Test Loss: 1.842 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 6.64364767074585
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.840 Vali Acc: 0.477 Test Loss: 1.840 Test Acc: 0.477
Validation loss decreased (-0.469981 --> -0.476648).  Saving model ...
Epoch: 50 cost time: 6.982121229171753
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.835 Vali Acc: 0.487 Test Loss: 1.835 Test Acc: 0.487
Validation loss decreased (-0.476648 --> -0.486648).  Saving model ...
Epoch: 51 cost time: 6.863970994949341
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.829 Vali Acc: 0.490 Test Loss: 1.829 Test Acc: 0.490
Validation loss decreased (-0.486648 --> -0.489982).  Saving model ...
Epoch: 52 cost time: 6.888421058654785
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.822 Vali Acc: 0.483 Test Loss: 1.822 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 7.254924774169922
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.819 Vali Acc: 0.487 Test Loss: 1.819 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 7.457825183868408
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.817 Vali Acc: 0.483 Test Loss: 1.817 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 7.578458786010742
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.812 Vali Acc: 0.483 Test Loss: 1.812 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 7.3186540603637695
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.806 Vali Acc: 0.487 Test Loss: 1.806 Test Acc: 0.487
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 7.330439567565918
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.799 Vali Acc: 0.483 Test Loss: 1.799 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 7.694608449935913
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.795 Vali Acc: 0.483 Test Loss: 1.795 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 6.709038019180298
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.791 Vali Acc: 0.490 Test Loss: 1.791 Test Acc: 0.490
Validation loss decreased (-0.489982 --> -0.489982).  Saving model ...
Epoch: 60 cost time: 6.461681365966797
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.791 Vali Acc: 0.493 Test Loss: 1.791 Test Acc: 0.493
Validation loss decreased (-0.489982 --> -0.493315).  Saving model ...
Epoch: 61 cost time: 6.605937242507935
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.781 Vali Acc: 0.497 Test Loss: 1.781 Test Acc: 0.497
Validation loss decreased (-0.493315 --> -0.496649).  Saving model ...
Epoch: 62 cost time: 6.671068429946899
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.775 Vali Acc: 0.497 Test Loss: 1.775 Test Acc: 0.497
Validation loss decreased (-0.496649 --> -0.496649).  Saving model ...
Epoch: 63 cost time: 7.302231073379517
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.774 Vali Acc: 0.500 Test Loss: 1.774 Test Acc: 0.500
Validation loss decreased (-0.496649 --> -0.499982).  Saving model ...
Epoch: 64 cost time: 7.119333982467651
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.771 Vali Acc: 0.510 Test Loss: 1.771 Test Acc: 0.510
Validation loss decreased (-0.499982 --> -0.509982).  Saving model ...
Epoch: 65 cost time: 6.830523729324341
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.764 Vali Acc: 0.517 Test Loss: 1.764 Test Acc: 0.517
Validation loss decreased (-0.509982 --> -0.516649).  Saving model ...
Epoch: 66 cost time: 7.046832323074341
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.761 Vali Acc: 0.510 Test Loss: 1.761 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 7.33431077003479
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.756 Vali Acc: 0.507 Test Loss: 1.756 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 7.555821895599365
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.751 Vali Acc: 0.503 Test Loss: 1.751 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 6.7624053955078125
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.752 Vali Acc: 0.510 Test Loss: 1.752 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 6.686030864715576
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.745 Vali Acc: 0.513 Test Loss: 1.745 Test Acc: 0.513
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 7.170397996902466
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.743 Vali Acc: 0.520 Test Loss: 1.743 Test Acc: 0.520
Validation loss decreased (-0.516649 --> -0.519983).  Saving model ...
Epoch: 72 cost time: 6.982050895690918
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.739 Vali Acc: 0.517 Test Loss: 1.739 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 7.128131628036499
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.513 Test Loss: 1.734 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 7.154823541641235
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.732 Vali Acc: 0.520 Test Loss: 1.732 Test Acc: 0.520
Validation loss decreased (-0.519983 --> -0.519983).  Saving model ...
Epoch: 75 cost time: 6.915896892547607
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.733 Vali Acc: 0.517 Test Loss: 1.733 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 6.9731175899505615
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.730 Vali Acc: 0.520 Test Loss: 1.730 Test Acc: 0.520
Validation loss decreased (-0.519983 --> -0.519983).  Saving model ...
Epoch: 77 cost time: 7.233438730239868
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.730 Vali Acc: 0.527 Test Loss: 1.730 Test Acc: 0.527
Validation loss decreased (-0.519983 --> -0.526649).  Saving model ...
Epoch: 78 cost time: 7.043838024139404
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.728 Vali Acc: 0.527 Test Loss: 1.728 Test Acc: 0.527
Validation loss decreased (-0.526649 --> -0.526649).  Saving model ...
Epoch: 79 cost time: 6.919205188751221
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.732 Vali Acc: 0.523 Test Loss: 1.732 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 6.805960655212402
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.731 Vali Acc: 0.520 Test Loss: 1.731 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 6.763257741928101
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.727 Vali Acc: 0.523 Test Loss: 1.727 Test Acc: 0.523
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 6.845959901809692
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.726 Vali Acc: 0.527 Test Loss: 1.726 Test Acc: 0.527
Validation loss decreased (-0.526649 --> -0.526649).  Saving model ...
Epoch: 83 cost time: 6.589619874954224
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.523 Test Loss: 1.723 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 7.064594507217407
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.527 Test Loss: 1.719 Test Acc: 0.527
Validation loss decreased (-0.526649 --> -0.526649).  Saving model ...
Epoch: 85 cost time: 6.879142999649048
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.714 Vali Acc: 0.527 Test Loss: 1.714 Test Acc: 0.527
Validation loss decreased (-0.526649 --> -0.526650).  Saving model ...
Epoch: 86 cost time: 7.734441518783569
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.710 Vali Acc: 0.527 Test Loss: 1.710 Test Acc: 0.527
Validation loss decreased (-0.526650 --> -0.526650).  Saving model ...
Epoch: 87 cost time: 7.602715015411377
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.710 Vali Acc: 0.527 Test Loss: 1.710 Test Acc: 0.527
Validation loss decreased (-0.526650 --> -0.526650).  Saving model ...
Epoch: 88 cost time: 7.900199890136719
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.708 Vali Acc: 0.523 Test Loss: 1.708 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 7.004165172576904
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.702 Vali Acc: 0.527 Test Loss: 1.702 Test Acc: 0.527
Validation loss decreased (-0.526650 --> -0.526650).  Saving model ...
Epoch: 90 cost time: 7.094522476196289
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.697 Vali Acc: 0.530 Test Loss: 1.697 Test Acc: 0.530
Validation loss decreased (-0.526650 --> -0.529983).  Saving model ...
Epoch: 91 cost time: 7.0800275802612305
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.695 Vali Acc: 0.537 Test Loss: 1.695 Test Acc: 0.537
Validation loss decreased (-0.529983 --> -0.536650).  Saving model ...
Epoch: 92 cost time: 7.115710735321045
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.694 Vali Acc: 0.537 Test Loss: 1.694 Test Acc: 0.537
Validation loss decreased (-0.536650 --> -0.536650).  Saving model ...
Epoch: 93 cost time: 6.7756569385528564
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.691 Vali Acc: 0.540 Test Loss: 1.691 Test Acc: 0.540
Validation loss decreased (-0.536650 --> -0.539983).  Saving model ...
Epoch: 94 cost time: 6.532785654067993
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.540 Test Loss: 1.690 Test Acc: 0.540
Validation loss decreased (-0.539983 --> -0.539983).  Saving model ...
Epoch: 95 cost time: 6.736488342285156
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.540 Test Loss: 1.690 Test Acc: 0.540
Validation loss decreased (-0.539983 --> -0.539983).  Saving model ...
Epoch: 96 cost time: 7.007723808288574
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.684 Vali Acc: 0.547 Test Loss: 1.684 Test Acc: 0.547
Validation loss decreased (-0.539983 --> -0.546650).  Saving model ...
Epoch: 97 cost time: 7.5924646854400635
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.681 Vali Acc: 0.543 Test Loss: 1.681 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 7.420015811920166
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.678 Vali Acc: 0.547 Test Loss: 1.678 Test Acc: 0.547
Validation loss decreased (-0.546650 --> -0.546650).  Saving model ...
Epoch: 99 cost time: 7.409179925918579
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.681 Vali Acc: 0.547 Test Loss: 1.681 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 6.67982292175293
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.682 Vali Acc: 0.553 Test Loss: 1.682 Test Acc: 0.553
Validation loss decreased (-0.546650 --> -0.553317).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5533333333333333
model parameter : 256921
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.291757583618164
Epoch: 1, Steps: 18 | Train Loss: 3.305 Vali Loss: 3.283 Vali Acc: 0.053 Test Loss: 3.283 Test Acc: 0.053
Validation loss decreased (inf --> -0.053301).  Saving model ...
Epoch: 2 cost time: 6.602435350418091
Epoch: 2, Steps: 18 | Train Loss: 3.164 Vali Loss: 3.227 Vali Acc: 0.057 Test Loss: 3.227 Test Acc: 0.057
Validation loss decreased (-0.053301 --> -0.056634).  Saving model ...
Epoch: 3 cost time: 6.6322808265686035
Epoch: 3, Steps: 18 | Train Loss: 2.947 Vali Loss: 3.165 Vali Acc: 0.063 Test Loss: 3.165 Test Acc: 0.063
Validation loss decreased (-0.056634 --> -0.063302).  Saving model ...
Epoch: 4 cost time: 5.985389947891235
Epoch: 4, Steps: 18 | Train Loss: 2.682 Vali Loss: 3.093 Vali Acc: 0.097 Test Loss: 3.093 Test Acc: 0.097
Validation loss decreased (-0.063302 --> -0.096636).  Saving model ...
Epoch: 5 cost time: 6.546946287155151
Epoch: 5, Steps: 18 | Train Loss: 2.419 Vali Loss: 3.027 Vali Acc: 0.120 Test Loss: 3.027 Test Acc: 0.120
Validation loss decreased (-0.096636 --> -0.119970).  Saving model ...
Epoch: 6 cost time: 6.06594443321228
Epoch: 6, Steps: 18 | Train Loss: 2.077 Vali Loss: 2.961 Vali Acc: 0.117 Test Loss: 2.961 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.02260422706604
Epoch: 7, Steps: 18 | Train Loss: 1.777 Vali Loss: 2.880 Vali Acc: 0.147 Test Loss: 2.880 Test Acc: 0.147
Validation loss decreased (-0.119970 --> -0.146638).  Saving model ...
Epoch: 8 cost time: 6.754707098007202
Epoch: 8, Steps: 18 | Train Loss: 1.409 Vali Loss: 2.811 Vali Acc: 0.143 Test Loss: 2.811 Test Acc: 0.143
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.271500825881958
Epoch: 9, Steps: 18 | Train Loss: 1.095 Vali Loss: 2.761 Vali Acc: 0.183 Test Loss: 2.761 Test Acc: 0.183
Validation loss decreased (-0.146638 --> -0.183306).  Saving model ...
Epoch: 10 cost time: 6.65826678276062
Epoch: 10, Steps: 18 | Train Loss: 0.802 Vali Loss: 2.686 Vali Acc: 0.180 Test Loss: 2.686 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.911414384841919
Epoch: 11, Steps: 18 | Train Loss: 0.591 Vali Loss: 2.645 Vali Acc: 0.207 Test Loss: 2.645 Test Acc: 0.207
Validation loss decreased (-0.183306 --> -0.206640).  Saving model ...
Epoch: 12 cost time: 6.240649461746216
Epoch: 12, Steps: 18 | Train Loss: 0.433 Vali Loss: 2.542 Vali Acc: 0.217 Test Loss: 2.542 Test Acc: 0.217
Validation loss decreased (-0.206640 --> -0.216641).  Saving model ...
Epoch: 13 cost time: 6.599981784820557
Epoch: 13, Steps: 18 | Train Loss: 0.278 Vali Loss: 2.475 Vali Acc: 0.223 Test Loss: 2.475 Test Acc: 0.223
Validation loss decreased (-0.216641 --> -0.223309).  Saving model ...
Epoch: 14 cost time: 6.8070573806762695
Epoch: 14, Steps: 18 | Train Loss: 0.194 Vali Loss: 2.394 Vali Acc: 0.280 Test Loss: 2.394 Test Acc: 0.280
Validation loss decreased (-0.223309 --> -0.279976).  Saving model ...
Epoch: 15 cost time: 6.7141945362091064
Epoch: 15, Steps: 18 | Train Loss: 0.130 Vali Loss: 2.334 Vali Acc: 0.290 Test Loss: 2.334 Test Acc: 0.290
Validation loss decreased (-0.279976 --> -0.289977).  Saving model ...
Epoch: 16 cost time: 6.636582136154175
Epoch: 16, Steps: 18 | Train Loss: 0.096 Vali Loss: 2.268 Vali Acc: 0.300 Test Loss: 2.268 Test Acc: 0.300
Validation loss decreased (-0.289977 --> -0.299977).  Saving model ...
Epoch: 17 cost time: 6.308888673782349
Epoch: 17, Steps: 18 | Train Loss: 0.079 Vali Loss: 2.279 Vali Acc: 0.283 Test Loss: 2.279 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.204312562942505
Epoch: 18, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.217 Vali Acc: 0.320 Test Loss: 2.217 Test Acc: 0.320
Validation loss decreased (-0.299977 --> -0.319978).  Saving model ...
Epoch: 19 cost time: 6.4916417598724365
Epoch: 19, Steps: 18 | Train Loss: 0.049 Vali Loss: 2.183 Vali Acc: 0.333 Test Loss: 2.183 Test Acc: 0.333
Validation loss decreased (-0.319978 --> -0.333312).  Saving model ...
Epoch: 20 cost time: 6.600372791290283
Epoch: 20, Steps: 18 | Train Loss: 0.039 Vali Loss: 2.141 Vali Acc: 0.330 Test Loss: 2.141 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.445903062820435
Epoch: 21, Steps: 18 | Train Loss: 0.035 Vali Loss: 2.118 Vali Acc: 0.350 Test Loss: 2.118 Test Acc: 0.350
Validation loss decreased (-0.333312 --> -0.349979).  Saving model ...
Epoch: 22 cost time: 6.381235599517822
Epoch: 22, Steps: 18 | Train Loss: 0.033 Vali Loss: 2.084 Vali Acc: 0.360 Test Loss: 2.084 Test Acc: 0.360
Validation loss decreased (-0.349979 --> -0.359979).  Saving model ...
Epoch: 23 cost time: 5.756915092468262
Epoch: 23, Steps: 18 | Train Loss: 0.025 Vali Loss: 2.067 Vali Acc: 0.363 Test Loss: 2.067 Test Acc: 0.363
Validation loss decreased (-0.359979 --> -0.363313).  Saving model ...
Epoch: 24 cost time: 5.464772939682007
Epoch: 24, Steps: 18 | Train Loss: 0.026 Vali Loss: 2.044 Vali Acc: 0.370 Test Loss: 2.044 Test Acc: 0.370
Validation loss decreased (-0.363313 --> -0.369980).  Saving model ...
Epoch: 25 cost time: 6.389041185379028
Epoch: 25, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.015 Vali Acc: 0.400 Test Loss: 2.015 Test Acc: 0.400
Validation loss decreased (-0.369980 --> -0.399980).  Saving model ...
Epoch: 26 cost time: 6.410228967666626
Epoch: 26, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.998 Vali Acc: 0.393 Test Loss: 1.998 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.0530760288238525
Epoch: 27, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.981 Vali Acc: 0.410 Test Loss: 1.981 Test Acc: 0.410
Validation loss decreased (-0.399980 --> -0.409980).  Saving model ...
Epoch: 28 cost time: 6.255563735961914
Epoch: 28, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.971 Vali Acc: 0.410 Test Loss: 1.971 Test Acc: 0.410
Validation loss decreased (-0.409980 --> -0.409980).  Saving model ...
Epoch: 29 cost time: 6.331437826156616
Epoch: 29, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.944 Vali Acc: 0.413 Test Loss: 1.944 Test Acc: 0.413
Validation loss decreased (-0.409980 --> -0.413314).  Saving model ...
Epoch: 30 cost time: 6.867268323898315
Epoch: 30, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.920 Vali Acc: 0.430 Test Loss: 1.920 Test Acc: 0.430
Validation loss decreased (-0.413314 --> -0.429981).  Saving model ...
Epoch: 31 cost time: 7.397027015686035
Epoch: 31, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.923 Vali Acc: 0.420 Test Loss: 1.923 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.681218862533569
Epoch: 32, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.907 Vali Acc: 0.437 Test Loss: 1.907 Test Acc: 0.437
Validation loss decreased (-0.429981 --> -0.436648).  Saving model ...
Epoch: 33 cost time: 7.026128530502319
Epoch: 33, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.881 Vali Acc: 0.447 Test Loss: 1.881 Test Acc: 0.447
Validation loss decreased (-0.436648 --> -0.446648).  Saving model ...
Epoch: 34 cost time: 6.077715873718262
Epoch: 34, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.875 Vali Acc: 0.447 Test Loss: 1.875 Test Acc: 0.447
Validation loss decreased (-0.446648 --> -0.446648).  Saving model ...
Epoch: 35 cost time: 6.212207317352295
Epoch: 35, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.857 Vali Acc: 0.450 Test Loss: 1.857 Test Acc: 0.450
Validation loss decreased (-0.446648 --> -0.449981).  Saving model ...
Epoch: 36 cost time: 6.29308295249939
Epoch: 36, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.843 Vali Acc: 0.463 Test Loss: 1.843 Test Acc: 0.463
Validation loss decreased (-0.449981 --> -0.463315).  Saving model ...
Epoch: 37 cost time: 6.2210469245910645
Epoch: 37, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.833 Vali Acc: 0.473 Test Loss: 1.833 Test Acc: 0.473
Validation loss decreased (-0.463315 --> -0.473315).  Saving model ...
Epoch: 38 cost time: 6.535512208938599
Epoch: 38, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.827 Vali Acc: 0.473 Test Loss: 1.827 Test Acc: 0.473
Validation loss decreased (-0.473315 --> -0.473315).  Saving model ...
Epoch: 39 cost time: 6.683828353881836
Epoch: 39, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.822 Vali Acc: 0.470 Test Loss: 1.822 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.192877769470215
Epoch: 40, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.820 Vali Acc: 0.467 Test Loss: 1.820 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.715891599655151
Epoch: 41, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.811 Vali Acc: 0.470 Test Loss: 1.811 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 6.543478012084961
Epoch: 42, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.801 Vali Acc: 0.467 Test Loss: 1.801 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 6.51955509185791
Epoch: 43, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.793 Vali Acc: 0.473 Test Loss: 1.793 Test Acc: 0.473
Validation loss decreased (-0.473315 --> -0.473315).  Saving model ...
Epoch: 44 cost time: 6.586971044540405
Epoch: 44, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.782 Vali Acc: 0.473 Test Loss: 1.782 Test Acc: 0.473
Validation loss decreased (-0.473315 --> -0.473316).  Saving model ...
Epoch: 45 cost time: 7.162506341934204
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.763 Vali Acc: 0.487 Test Loss: 1.763 Test Acc: 0.487
Validation loss decreased (-0.473316 --> -0.486649).  Saving model ...
Epoch: 46 cost time: 7.088986158370972
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.754 Vali Acc: 0.483 Test Loss: 1.754 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.499340772628784
Epoch: 47, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.744 Vali Acc: 0.487 Test Loss: 1.744 Test Acc: 0.487
Validation loss decreased (-0.486649 --> -0.486649).  Saving model ...
Epoch: 48 cost time: 5.666889667510986
Epoch: 48, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.737 Vali Acc: 0.497 Test Loss: 1.737 Test Acc: 0.497
Validation loss decreased (-0.486649 --> -0.496649).  Saving model ...
Epoch: 49 cost time: 6.46622371673584
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.720 Vali Acc: 0.510 Test Loss: 1.720 Test Acc: 0.510
Validation loss decreased (-0.496649 --> -0.509983).  Saving model ...
Epoch: 50 cost time: 6.298222780227661
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.714 Vali Acc: 0.503 Test Loss: 1.714 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 6.296538829803467
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.717 Vali Acc: 0.503 Test Loss: 1.717 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 6.42386794090271
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.716 Vali Acc: 0.503 Test Loss: 1.716 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 5.687720775604248
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.716 Vali Acc: 0.503 Test Loss: 1.716 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 5.690370559692383
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.716 Vali Acc: 0.503 Test Loss: 1.716 Test Acc: 0.503
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 6.660517692565918
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.708 Vali Acc: 0.510 Test Loss: 1.708 Test Acc: 0.510
Validation loss decreased (-0.509983 --> -0.509983).  Saving model ...
Epoch: 56 cost time: 6.002672433853149
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.708 Vali Acc: 0.517 Test Loss: 1.708 Test Acc: 0.517
Validation loss decreased (-0.509983 --> -0.516650).  Saving model ...
Epoch: 57 cost time: 6.588088035583496
Epoch: 57, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.697 Vali Acc: 0.513 Test Loss: 1.697 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.429728984832764
Epoch: 58, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.698 Vali Acc: 0.517 Test Loss: 1.698 Test Acc: 0.517
Validation loss decreased (-0.516650 --> -0.516650).  Saving model ...
Epoch: 59 cost time: 6.182464599609375
Epoch: 59, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.686 Vali Acc: 0.520 Test Loss: 1.686 Test Acc: 0.520
Validation loss decreased (-0.516650 --> -0.519983).  Saving model ...
Epoch: 60 cost time: 7.120356321334839
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.689 Vali Acc: 0.527 Test Loss: 1.689 Test Acc: 0.527
Validation loss decreased (-0.519983 --> -0.526650).  Saving model ...
Epoch: 61 cost time: 7.191765785217285
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.686 Vali Acc: 0.520 Test Loss: 1.686 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.951308488845825
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.685 Vali Acc: 0.513 Test Loss: 1.685 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 6.4282002449035645
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.681 Vali Acc: 0.520 Test Loss: 1.681 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 6.3135905265808105
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.673 Vali Acc: 0.520 Test Loss: 1.673 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 7.320391654968262
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.664 Vali Acc: 0.530 Test Loss: 1.664 Test Acc: 0.530
Validation loss decreased (-0.526650 --> -0.529983).  Saving model ...
Epoch: 66 cost time: 6.701448678970337
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.660 Vali Acc: 0.530 Test Loss: 1.660 Test Acc: 0.530
Validation loss decreased (-0.529983 --> -0.529983).  Saving model ...
Epoch: 67 cost time: 6.792291641235352
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.664 Vali Acc: 0.523 Test Loss: 1.664 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 6.620438814163208
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.662 Vali Acc: 0.523 Test Loss: 1.662 Test Acc: 0.523
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 6.938602924346924
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.659 Vali Acc: 0.527 Test Loss: 1.659 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 7.387675762176514
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.650 Vali Acc: 0.530 Test Loss: 1.650 Test Acc: 0.530
Validation loss decreased (-0.529983 --> -0.529984).  Saving model ...
Epoch: 71 cost time: 7.187369108200073
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.642 Vali Acc: 0.533 Test Loss: 1.642 Test Acc: 0.533
Validation loss decreased (-0.529984 --> -0.533317).  Saving model ...
Epoch: 72 cost time: 6.730190992355347
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.637 Vali Acc: 0.533 Test Loss: 1.637 Test Acc: 0.533
Validation loss decreased (-0.533317 --> -0.533317).  Saving model ...
Epoch: 73 cost time: 6.63873553276062
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.537 Test Loss: 1.641 Test Acc: 0.537
Validation loss decreased (-0.533317 --> -0.536650).  Saving model ...
Epoch: 74 cost time: 7.0938942432403564
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.638 Vali Acc: 0.540 Test Loss: 1.638 Test Acc: 0.540
Validation loss decreased (-0.536650 --> -0.539984).  Saving model ...
Epoch: 75 cost time: 7.3425822257995605
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.627 Vali Acc: 0.550 Test Loss: 1.627 Test Acc: 0.550
Validation loss decreased (-0.539984 --> -0.549984).  Saving model ...
Epoch: 76 cost time: 6.735157251358032
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.625 Vali Acc: 0.543 Test Loss: 1.625 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 7.021881341934204
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.624 Vali Acc: 0.540 Test Loss: 1.624 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 7.0478246212005615
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.621 Vali Acc: 0.550 Test Loss: 1.621 Test Acc: 0.550
Validation loss decreased (-0.549984 --> -0.549984).  Saving model ...
Epoch: 79 cost time: 7.409484148025513
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.626 Vali Acc: 0.560 Test Loss: 1.626 Test Acc: 0.560
Validation loss decreased (-0.549984 --> -0.559984).  Saving model ...
Epoch: 80 cost time: 7.649184226989746
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.627 Vali Acc: 0.550 Test Loss: 1.627 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 6.709089279174805
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.618 Vali Acc: 0.543 Test Loss: 1.618 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 6.751708745956421
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.617 Vali Acc: 0.547 Test Loss: 1.617 Test Acc: 0.547
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 7.624714136123657
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.613 Vali Acc: 0.553 Test Loss: 1.613 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 6.570791721343994
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.553 Test Loss: 1.633 Test Acc: 0.553
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 7.0630879402160645
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.626 Vali Acc: 0.550 Test Loss: 1.626 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 6.258973836898804
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.547 Test Loss: 1.619 Test Acc: 0.547
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 6.418079614639282
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.614 Vali Acc: 0.553 Test Loss: 1.614 Test Acc: 0.553
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 7.090481996536255
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.557 Test Loss: 1.606 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 7.389073371887207
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.602 Vali Acc: 0.557 Test Loss: 1.602 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.56
model parameter : 256921
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.36863660812378
Epoch: 1, Steps: 18 | Train Loss: 3.306 Vali Loss: 3.272 Vali Acc: 0.050 Test Loss: 3.272 Test Acc: 0.050
Validation loss decreased (inf --> -0.049967).  Saving model ...
Epoch: 2 cost time: 7.3172595500946045
Epoch: 2, Steps: 18 | Train Loss: 3.170 Vali Loss: 3.223 Vali Acc: 0.060 Test Loss: 3.223 Test Acc: 0.060
Validation loss decreased (-0.049967 --> -0.059968).  Saving model ...
Epoch: 3 cost time: 6.884709358215332
Epoch: 3, Steps: 18 | Train Loss: 3.022 Vali Loss: 3.173 Vali Acc: 0.067 Test Loss: 3.173 Test Acc: 0.067
Validation loss decreased (-0.059968 --> -0.066635).  Saving model ...
Epoch: 4 cost time: 7.232881784439087
Epoch: 4, Steps: 18 | Train Loss: 2.775 Vali Loss: 3.113 Vali Acc: 0.083 Test Loss: 3.113 Test Acc: 0.083
Validation loss decreased (-0.066635 --> -0.083302).  Saving model ...
Epoch: 5 cost time: 7.0954320430755615
Epoch: 5, Steps: 18 | Train Loss: 2.590 Vali Loss: 3.060 Vali Acc: 0.090 Test Loss: 3.060 Test Acc: 0.090
Validation loss decreased (-0.083302 --> -0.089969).  Saving model ...
Epoch: 6 cost time: 6.957900762557983
Epoch: 6, Steps: 18 | Train Loss: 2.265 Vali Loss: 3.003 Vali Acc: 0.100 Test Loss: 3.003 Test Acc: 0.100
Validation loss decreased (-0.089969 --> -0.099970).  Saving model ...
Epoch: 7 cost time: 7.259087324142456
Epoch: 7, Steps: 18 | Train Loss: 2.021 Vali Loss: 2.938 Vali Acc: 0.100 Test Loss: 2.938 Test Acc: 0.100
Validation loss decreased (-0.099970 --> -0.099971).  Saving model ...
Epoch: 8 cost time: 7.483038425445557
Epoch: 8, Steps: 18 | Train Loss: 1.681 Vali Loss: 2.869 Vali Acc: 0.143 Test Loss: 2.869 Test Acc: 0.143
Validation loss decreased (-0.099971 --> -0.143305).  Saving model ...
Epoch: 9 cost time: 6.460096120834351
Epoch: 9, Steps: 18 | Train Loss: 1.409 Vali Loss: 2.846 Vali Acc: 0.130 Test Loss: 2.846 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.769549608230591
Epoch: 10, Steps: 18 | Train Loss: 1.122 Vali Loss: 2.779 Vali Acc: 0.147 Test Loss: 2.779 Test Acc: 0.147
Validation loss decreased (-0.143305 --> -0.146639).  Saving model ...
Epoch: 11 cost time: 7.24274206161499
Epoch: 11, Steps: 18 | Train Loss: 0.911 Vali Loss: 2.773 Vali Acc: 0.157 Test Loss: 2.773 Test Acc: 0.157
Validation loss decreased (-0.146639 --> -0.156639).  Saving model ...
Epoch: 12 cost time: 6.881414175033569
Epoch: 12, Steps: 18 | Train Loss: 0.645 Vali Loss: 2.684 Vali Acc: 0.187 Test Loss: 2.684 Test Acc: 0.187
Validation loss decreased (-0.156639 --> -0.186640).  Saving model ...
Epoch: 13 cost time: 6.855159282684326
Epoch: 13, Steps: 18 | Train Loss: 0.533 Vali Loss: 2.629 Vali Acc: 0.203 Test Loss: 2.629 Test Acc: 0.203
Validation loss decreased (-0.186640 --> -0.203307).  Saving model ...
Epoch: 14 cost time: 6.822772741317749
Epoch: 14, Steps: 18 | Train Loss: 0.373 Vali Loss: 2.599 Vali Acc: 0.190 Test Loss: 2.599 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.086528301239014
Epoch: 15, Steps: 18 | Train Loss: 0.272 Vali Loss: 2.480 Vali Acc: 0.243 Test Loss: 2.480 Test Acc: 0.243
Validation loss decreased (-0.203307 --> -0.243309).  Saving model ...
Epoch: 16 cost time: 7.609133958816528
Epoch: 16, Steps: 18 | Train Loss: 0.185 Vali Loss: 2.380 Vali Acc: 0.297 Test Loss: 2.380 Test Acc: 0.297
Validation loss decreased (-0.243309 --> -0.296643).  Saving model ...
Epoch: 17 cost time: 6.315097093582153
Epoch: 17, Steps: 18 | Train Loss: 0.127 Vali Loss: 2.408 Vali Acc: 0.247 Test Loss: 2.408 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.84364914894104
Epoch: 18, Steps: 18 | Train Loss: 0.112 Vali Loss: 2.317 Vali Acc: 0.317 Test Loss: 2.317 Test Acc: 0.317
Validation loss decreased (-0.296643 --> -0.316643).  Saving model ...
Epoch: 19 cost time: 6.44972562789917
Epoch: 19, Steps: 18 | Train Loss: 0.080 Vali Loss: 2.319 Vali Acc: 0.293 Test Loss: 2.319 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.450711965560913
Epoch: 20, Steps: 18 | Train Loss: 0.069 Vali Loss: 2.194 Vali Acc: 0.323 Test Loss: 2.194 Test Acc: 0.323
Validation loss decreased (-0.316643 --> -0.323311).  Saving model ...
Epoch: 21 cost time: 5.805537700653076
Epoch: 21, Steps: 18 | Train Loss: 0.054 Vali Loss: 2.156 Vali Acc: 0.350 Test Loss: 2.156 Test Acc: 0.350
Validation loss decreased (-0.323311 --> -0.349978).  Saving model ...
Epoch: 22 cost time: 6.002678394317627
Epoch: 22, Steps: 18 | Train Loss: 0.046 Vali Loss: 2.116 Vali Acc: 0.357 Test Loss: 2.116 Test Acc: 0.357
Validation loss decreased (-0.349978 --> -0.356646).  Saving model ...
Epoch: 23 cost time: 6.443637132644653
Epoch: 23, Steps: 18 | Train Loss: 0.043 Vali Loss: 2.103 Vali Acc: 0.377 Test Loss: 2.103 Test Acc: 0.377
Validation loss decreased (-0.356646 --> -0.376646).  Saving model ...
Epoch: 24 cost time: 6.525008201599121
Epoch: 24, Steps: 18 | Train Loss: 0.034 Vali Loss: 2.067 Vali Acc: 0.380 Test Loss: 2.067 Test Acc: 0.380
Validation loss decreased (-0.376646 --> -0.379979).  Saving model ...
Epoch: 25 cost time: 6.323245286941528
Epoch: 25, Steps: 18 | Train Loss: 0.029 Vali Loss: 2.050 Vali Acc: 0.380 Test Loss: 2.050 Test Acc: 0.380
Validation loss decreased (-0.379979 --> -0.379980).  Saving model ...
Epoch: 26 cost time: 6.717968940734863
Epoch: 26, Steps: 18 | Train Loss: 0.029 Vali Loss: 2.036 Vali Acc: 0.393 Test Loss: 2.036 Test Acc: 0.393
Validation loss decreased (-0.379980 --> -0.393313).  Saving model ...
Epoch: 27 cost time: 6.3035969734191895
Epoch: 27, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.019 Vali Acc: 0.393 Test Loss: 2.019 Test Acc: 0.393
Validation loss decreased (-0.393313 --> -0.393313).  Saving model ...
Epoch: 28 cost time: 7.028154611587524
Epoch: 28, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.984 Vali Acc: 0.423 Test Loss: 1.984 Test Acc: 0.423
Validation loss decreased (-0.393313 --> -0.423313).  Saving model ...
Epoch: 29 cost time: 7.163511276245117
Epoch: 29, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.950 Vali Acc: 0.417 Test Loss: 1.950 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 7.055026292800903
Epoch: 30, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.914 Vali Acc: 0.427 Test Loss: 1.914 Test Acc: 0.427
Validation loss decreased (-0.423313 --> -0.426648).  Saving model ...
Epoch: 31 cost time: 6.288951873779297
Epoch: 31, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.927 Vali Acc: 0.427 Test Loss: 1.927 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.23353910446167
Epoch: 32, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.919 Vali Acc: 0.427 Test Loss: 1.919 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.5321269035339355
Epoch: 33, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.893 Vali Acc: 0.433 Test Loss: 1.893 Test Acc: 0.433
Validation loss decreased (-0.426648 --> -0.433314).  Saving model ...
Epoch: 34 cost time: 6.958159685134888
Epoch: 34, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.878 Vali Acc: 0.447 Test Loss: 1.878 Test Acc: 0.447
Validation loss decreased (-0.433314 --> -0.446648).  Saving model ...
Epoch: 35 cost time: 7.339297294616699
Epoch: 35, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.858 Vali Acc: 0.440 Test Loss: 1.858 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.594036817550659
Epoch: 36, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.834 Vali Acc: 0.437 Test Loss: 1.834 Test Acc: 0.437
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 6.223692893981934
Epoch: 37, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.827 Vali Acc: 0.463 Test Loss: 1.827 Test Acc: 0.463
Validation loss decreased (-0.446648 --> -0.463315).  Saving model ...
Epoch: 38 cost time: 6.784648418426514
Epoch: 38, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.828 Vali Acc: 0.457 Test Loss: 1.828 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 7.183145761489868
Epoch: 39, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.806 Vali Acc: 0.473 Test Loss: 1.806 Test Acc: 0.473
Validation loss decreased (-0.463315 --> -0.473315).  Saving model ...
Epoch: 40 cost time: 7.04102349281311
Epoch: 40, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.823 Vali Acc: 0.483 Test Loss: 1.823 Test Acc: 0.483
Validation loss decreased (-0.473315 --> -0.483315).  Saving model ...
Epoch: 41 cost time: 6.362423658370972
Epoch: 41, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.790 Vali Acc: 0.470 Test Loss: 1.790 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.444717884063721
Epoch: 42, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.774 Vali Acc: 0.480 Test Loss: 1.774 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 6.802567720413208
Epoch: 43, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.786 Vali Acc: 0.483 Test Loss: 1.786 Test Acc: 0.483
Validation loss decreased (-0.483315 --> -0.483315).  Saving model ...
Epoch: 44 cost time: 7.086257457733154
Epoch: 44, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.775 Vali Acc: 0.470 Test Loss: 1.775 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 6.96869969367981
Epoch: 45, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.743 Vali Acc: 0.487 Test Loss: 1.743 Test Acc: 0.487
Validation loss decreased (-0.483315 --> -0.486649).  Saving model ...
Epoch: 46 cost time: 6.253555059432983
Epoch: 46, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.765 Vali Acc: 0.487 Test Loss: 1.765 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 7.092512369155884
Epoch: 47, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.778 Vali Acc: 0.487 Test Loss: 1.778 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 7.239582300186157
Epoch: 48, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.778 Vali Acc: 0.490 Test Loss: 1.778 Test Acc: 0.490
Validation loss decreased (-0.486649 --> -0.489982).  Saving model ...
Epoch: 49 cost time: 7.345247507095337
Epoch: 49, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.741 Vali Acc: 0.503 Test Loss: 1.741 Test Acc: 0.503
Validation loss decreased (-0.489982 --> -0.503316).  Saving model ...
Epoch: 50 cost time: 7.738921165466309
Epoch: 50, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.723 Vali Acc: 0.500 Test Loss: 1.723 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 6.4416491985321045
Epoch: 51, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.738 Vali Acc: 0.507 Test Loss: 1.738 Test Acc: 0.507
Validation loss decreased (-0.503316 --> -0.506649).  Saving model ...
Epoch: 52 cost time: 5.911037445068359
Epoch: 52, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.742 Vali Acc: 0.507 Test Loss: 1.742 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 7.151029348373413
Epoch: 53, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.737 Vali Acc: 0.497 Test Loss: 1.737 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 6.982430458068848
Epoch: 54, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.747 Vali Acc: 0.503 Test Loss: 1.747 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 6.492729425430298
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.740 Vali Acc: 0.497 Test Loss: 1.740 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 6.596295356750488
Epoch: 56, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.709 Vali Acc: 0.507 Test Loss: 1.709 Test Acc: 0.507
Validation loss decreased (-0.506649 --> -0.506650).  Saving model ...
Epoch: 57 cost time: 7.066031217575073
Epoch: 57, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.699 Vali Acc: 0.510 Test Loss: 1.699 Test Acc: 0.510
Validation loss decreased (-0.506650 --> -0.509983).  Saving model ...
Epoch: 58 cost time: 6.841373443603516
Epoch: 58, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.694 Vali Acc: 0.507 Test Loss: 1.694 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 7.047234773635864
Epoch: 59, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.682 Vali Acc: 0.513 Test Loss: 1.682 Test Acc: 0.513
Validation loss decreased (-0.509983 --> -0.513317).  Saving model ...
Epoch: 60 cost time: 6.668996095657349
Epoch: 60, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.678 Vali Acc: 0.503 Test Loss: 1.678 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.830984115600586
Epoch: 61, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.668 Vali Acc: 0.513 Test Loss: 1.668 Test Acc: 0.513
Validation loss decreased (-0.513317 --> -0.513317).  Saving model ...
Epoch: 62 cost time: 6.726433753967285
Epoch: 62, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.674 Vali Acc: 0.513 Test Loss: 1.674 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 7.381572961807251
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.671 Vali Acc: 0.503 Test Loss: 1.671 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 7.047040939331055
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.658 Vali Acc: 0.513 Test Loss: 1.658 Test Acc: 0.513
Validation loss decreased (-0.513317 --> -0.513317).  Saving model ...
Epoch: 65 cost time: 6.471997976303101
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.655 Vali Acc: 0.517 Test Loss: 1.655 Test Acc: 0.517
Validation loss decreased (-0.513317 --> -0.516650).  Saving model ...
Epoch: 66 cost time: 7.118852376937866
Epoch: 66, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.675 Vali Acc: 0.510 Test Loss: 1.675 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 7.3392956256866455
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.675 Vali Acc: 0.513 Test Loss: 1.675 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 7.322073698043823
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.648 Vali Acc: 0.517 Test Loss: 1.648 Test Acc: 0.517
Validation loss decreased (-0.516650 --> -0.516650).  Saving model ...
Epoch: 69 cost time: 6.586249351501465
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.651 Vali Acc: 0.517 Test Loss: 1.651 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 7.026017189025879
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.675 Vali Acc: 0.517 Test Loss: 1.675 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 7.259848117828369
Epoch: 71, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.679 Vali Acc: 0.517 Test Loss: 1.679 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 7.2813355922698975
Epoch: 72, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.663 Vali Acc: 0.533 Test Loss: 1.663 Test Acc: 0.533
Validation loss decreased (-0.516650 --> -0.533317).  Saving model ...
Epoch: 73 cost time: 7.346190452575684
Epoch: 73, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.655 Vali Acc: 0.533 Test Loss: 1.655 Test Acc: 0.533
Validation loss decreased (-0.533317 --> -0.533317).  Saving model ...
Epoch: 74 cost time: 6.67341685295105
Epoch: 74, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.658 Vali Acc: 0.523 Test Loss: 1.658 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 6.6889708042144775
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.666 Vali Acc: 0.523 Test Loss: 1.666 Test Acc: 0.523
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 6.754527807235718
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.661 Vali Acc: 0.523 Test Loss: 1.661 Test Acc: 0.523
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 7.029563903808594
Epoch: 77, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.653 Vali Acc: 0.530 Test Loss: 1.653 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 6.657716274261475
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.642 Vali Acc: 0.540 Test Loss: 1.642 Test Acc: 0.540
Validation loss decreased (-0.533317 --> -0.539984).  Saving model ...
Epoch: 79 cost time: 6.9998414516448975
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.647 Vali Acc: 0.533 Test Loss: 1.647 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 6.837485313415527
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.652 Vali Acc: 0.533 Test Loss: 1.652 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 7.044503927230835
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.643 Vali Acc: 0.540 Test Loss: 1.643 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 6.3829405307769775
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.638 Vali Acc: 0.533 Test Loss: 1.638 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 7.021666526794434
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.623 Vali Acc: 0.530 Test Loss: 1.623 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 7.168128967285156
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.622 Vali Acc: 0.537 Test Loss: 1.622 Test Acc: 0.537
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 7.020704507827759
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.603 Vali Acc: 0.540 Test Loss: 1.603 Test Acc: 0.540
Validation loss decreased (-0.539984 --> -0.539984).  Saving model ...
Epoch: 86 cost time: 6.647372245788574
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.610 Vali Acc: 0.540 Test Loss: 1.610 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 6.461237192153931
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.615 Vali Acc: 0.543 Test Loss: 1.615 Test Acc: 0.543
Validation loss decreased (-0.539984 --> -0.543317).  Saving model ...
Epoch: 88 cost time: 6.725645303726196
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.608 Vali Acc: 0.543 Test Loss: 1.608 Test Acc: 0.543
Validation loss decreased (-0.543317 --> -0.543317).  Saving model ...
Epoch: 89 cost time: 6.244979619979858
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.608 Vali Acc: 0.533 Test Loss: 1.608 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 6.135588884353638
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.602 Vali Acc: 0.547 Test Loss: 1.602 Test Acc: 0.547
Validation loss decreased (-0.543317 --> -0.546651).  Saving model ...
Epoch: 91 cost time: 6.434217929840088
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.602 Vali Acc: 0.547 Test Loss: 1.602 Test Acc: 0.547
Validation loss decreased (-0.546651 --> -0.546651).  Saving model ...
Epoch: 92 cost time: 6.7598960399627686
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.604 Vali Acc: 0.553 Test Loss: 1.604 Test Acc: 0.553
Validation loss decreased (-0.546651 --> -0.553317).  Saving model ...
Epoch: 93 cost time: 6.6534459590911865
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.613 Vali Acc: 0.557 Test Loss: 1.613 Test Acc: 0.557
Validation loss decreased (-0.553317 --> -0.556651).  Saving model ...
Epoch: 94 cost time: 6.296942949295044
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.602 Vali Acc: 0.567 Test Loss: 1.602 Test Acc: 0.567
Validation loss decreased (-0.556651 --> -0.566651).  Saving model ...
Epoch: 95 cost time: 7.009565353393555
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.557 Test Loss: 1.601 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 6.271469354629517
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.560 Test Loss: 1.601 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 6.5445051193237305
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.609 Vali Acc: 0.560 Test Loss: 1.609 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 6.3504798412323
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.602 Vali Acc: 0.557 Test Loss: 1.602 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 6.517879962921143
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.595 Vali Acc: 0.553 Test Loss: 1.595 Test Acc: 0.553
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 6.041019678115845
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.591 Vali Acc: 0.557 Test Loss: 1.591 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5666666666666667
model parameter : 256921
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.14938735961914
Epoch: 1, Steps: 18 | Train Loss: 3.308 Vali Loss: 3.295 Vali Acc: 0.053 Test Loss: 3.295 Test Acc: 0.053
Validation loss decreased (inf --> -0.053300).  Saving model ...
Epoch: 2 cost time: 6.741934061050415
Epoch: 2, Steps: 18 | Train Loss: 3.195 Vali Loss: 3.252 Vali Acc: 0.060 Test Loss: 3.252 Test Acc: 0.060
Validation loss decreased (-0.053300 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 6.423218727111816
Epoch: 3, Steps: 18 | Train Loss: 3.075 Vali Loss: 3.208 Vali Acc: 0.063 Test Loss: 3.208 Test Acc: 0.063
Validation loss decreased (-0.059967 --> -0.063301).  Saving model ...
Epoch: 4 cost time: 6.430786848068237
Epoch: 4, Steps: 18 | Train Loss: 2.848 Vali Loss: 3.155 Vali Acc: 0.097 Test Loss: 3.155 Test Acc: 0.097
Validation loss decreased (-0.063301 --> -0.096635).  Saving model ...
Epoch: 5 cost time: 6.367837905883789
Epoch: 5, Steps: 18 | Train Loss: 2.652 Vali Loss: 3.106 Vali Acc: 0.117 Test Loss: 3.106 Test Acc: 0.117
Validation loss decreased (-0.096635 --> -0.116636).  Saving model ...
Epoch: 6 cost time: 6.121989488601685
Epoch: 6, Steps: 18 | Train Loss: 2.342 Vali Loss: 3.057 Vali Acc: 0.130 Test Loss: 3.057 Test Acc: 0.130
Validation loss decreased (-0.116636 --> -0.129969).  Saving model ...
Epoch: 7 cost time: 6.375171422958374
Epoch: 7, Steps: 18 | Train Loss: 2.048 Vali Loss: 2.996 Vali Acc: 0.123 Test Loss: 2.996 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.089635610580444
Epoch: 8, Steps: 18 | Train Loss: 1.785 Vali Loss: 2.931 Vali Acc: 0.147 Test Loss: 2.931 Test Acc: 0.147
Validation loss decreased (-0.129969 --> -0.146637).  Saving model ...
Epoch: 9 cost time: 5.638110637664795
Epoch: 9, Steps: 18 | Train Loss: 1.454 Vali Loss: 2.898 Vali Acc: 0.147 Test Loss: 2.898 Test Acc: 0.147
Validation loss decreased (-0.146637 --> -0.146638).  Saving model ...
Epoch: 10 cost time: 5.891644477844238
Epoch: 10, Steps: 18 | Train Loss: 1.191 Vali Loss: 2.828 Vali Acc: 0.143 Test Loss: 2.828 Test Acc: 0.143
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.831673622131348
Epoch: 11, Steps: 18 | Train Loss: 0.938 Vali Loss: 2.803 Vali Acc: 0.163 Test Loss: 2.803 Test Acc: 0.163
Validation loss decreased (-0.146638 --> -0.163305).  Saving model ...
Epoch: 12 cost time: 6.255705833435059
Epoch: 12, Steps: 18 | Train Loss: 0.705 Vali Loss: 2.719 Vali Acc: 0.173 Test Loss: 2.719 Test Acc: 0.173
Validation loss decreased (-0.163305 --> -0.173306).  Saving model ...
Epoch: 13 cost time: 6.033143520355225
Epoch: 13, Steps: 18 | Train Loss: 0.550 Vali Loss: 2.668 Vali Acc: 0.200 Test Loss: 2.668 Test Acc: 0.200
Validation loss decreased (-0.173306 --> -0.199973).  Saving model ...
Epoch: 14 cost time: 6.221702575683594
Epoch: 14, Steps: 18 | Train Loss: 0.364 Vali Loss: 2.603 Vali Acc: 0.220 Test Loss: 2.603 Test Acc: 0.220
Validation loss decreased (-0.199973 --> -0.219974).  Saving model ...
Epoch: 15 cost time: 6.45535135269165
Epoch: 15, Steps: 18 | Train Loss: 0.268 Vali Loss: 2.502 Vali Acc: 0.260 Test Loss: 2.502 Test Acc: 0.260
Validation loss decreased (-0.219974 --> -0.259975).  Saving model ...
Epoch: 16 cost time: 6.084419012069702
Epoch: 16, Steps: 18 | Train Loss: 0.173 Vali Loss: 2.405 Vali Acc: 0.267 Test Loss: 2.405 Test Acc: 0.267
Validation loss decreased (-0.259975 --> -0.266643).  Saving model ...
Epoch: 17 cost time: 6.7444610595703125
Epoch: 17, Steps: 18 | Train Loss: 0.123 Vali Loss: 2.384 Vali Acc: 0.260 Test Loss: 2.384 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.953470468521118
Epoch: 18, Steps: 18 | Train Loss: 0.101 Vali Loss: 2.313 Vali Acc: 0.300 Test Loss: 2.313 Test Acc: 0.300
Validation loss decreased (-0.266643 --> -0.299977).  Saving model ...
Epoch: 19 cost time: 6.332789421081543
Epoch: 19, Steps: 18 | Train Loss: 0.076 Vali Loss: 2.279 Vali Acc: 0.303 Test Loss: 2.279 Test Acc: 0.303
Validation loss decreased (-0.299977 --> -0.303311).  Saving model ...
Epoch: 20 cost time: 6.0618250370025635
Epoch: 20, Steps: 18 | Train Loss: 0.065 Vali Loss: 2.186 Vali Acc: 0.340 Test Loss: 2.186 Test Acc: 0.340
Validation loss decreased (-0.303311 --> -0.339978).  Saving model ...
Epoch: 21 cost time: 6.206062316894531
Epoch: 21, Steps: 18 | Train Loss: 0.053 Vali Loss: 2.136 Vali Acc: 0.390 Test Loss: 2.136 Test Acc: 0.390
Validation loss decreased (-0.339978 --> -0.389979).  Saving model ...
Epoch: 22 cost time: 6.587860345840454
Epoch: 22, Steps: 18 | Train Loss: 0.049 Vali Loss: 2.107 Vali Acc: 0.360 Test Loss: 2.107 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.071523904800415
Epoch: 23, Steps: 18 | Train Loss: 0.043 Vali Loss: 2.080 Vali Acc: 0.373 Test Loss: 2.080 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.493811130523682
Epoch: 24, Steps: 18 | Train Loss: 0.035 Vali Loss: 2.055 Vali Acc: 0.393 Test Loss: 2.055 Test Acc: 0.393
Validation loss decreased (-0.389979 --> -0.393313).  Saving model ...
Epoch: 25 cost time: 5.979251861572266
Epoch: 25, Steps: 18 | Train Loss: 0.029 Vali Loss: 2.011 Vali Acc: 0.407 Test Loss: 2.011 Test Acc: 0.407
Validation loss decreased (-0.393313 --> -0.406647).  Saving model ...
Epoch: 26 cost time: 6.543564558029175
Epoch: 26, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.973 Vali Acc: 0.420 Test Loss: 1.973 Test Acc: 0.420
Validation loss decreased (-0.406647 --> -0.419980).  Saving model ...
Epoch: 27 cost time: 6.541346073150635
Epoch: 27, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.947 Vali Acc: 0.417 Test Loss: 1.947 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.815497875213623
Epoch: 28, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.926 Vali Acc: 0.420 Test Loss: 1.926 Test Acc: 0.420
Validation loss decreased (-0.419980 --> -0.419981).  Saving model ...
Epoch: 29 cost time: 6.421802759170532
Epoch: 29, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.892 Vali Acc: 0.417 Test Loss: 1.892 Test Acc: 0.417
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.747066497802734
Epoch: 30, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.873 Vali Acc: 0.413 Test Loss: 1.873 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.541256666183472
Epoch: 31, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.883 Vali Acc: 0.433 Test Loss: 1.883 Test Acc: 0.433
Validation loss decreased (-0.419981 --> -0.433314).  Saving model ...
Epoch: 32 cost time: 6.591465711593628
Epoch: 32, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.851 Vali Acc: 0.440 Test Loss: 1.851 Test Acc: 0.440
Validation loss decreased (-0.433314 --> -0.439981).  Saving model ...
Epoch: 33 cost time: 6.329769134521484
Epoch: 33, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.822 Vali Acc: 0.440 Test Loss: 1.822 Test Acc: 0.440
Validation loss decreased (-0.439981 --> -0.439982).  Saving model ...
Epoch: 34 cost time: 6.496844291687012
Epoch: 34, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.804 Vali Acc: 0.450 Test Loss: 1.804 Test Acc: 0.450
Validation loss decreased (-0.439982 --> -0.449982).  Saving model ...
Epoch: 35 cost time: 6.705486059188843
Epoch: 35, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.777 Vali Acc: 0.473 Test Loss: 1.777 Test Acc: 0.473
Validation loss decreased (-0.449982 --> -0.473316).  Saving model ...
Epoch: 36 cost time: 6.823277711868286
Epoch: 36, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.763 Vali Acc: 0.473 Test Loss: 1.763 Test Acc: 0.473
Validation loss decreased (-0.473316 --> -0.473316).  Saving model ...
Epoch: 37 cost time: 6.5318145751953125
Epoch: 37, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.751 Vali Acc: 0.477 Test Loss: 1.751 Test Acc: 0.477
Validation loss decreased (-0.473316 --> -0.476649).  Saving model ...
Epoch: 38 cost time: 6.184380292892456
Epoch: 38, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.745 Vali Acc: 0.480 Test Loss: 1.745 Test Acc: 0.480
Validation loss decreased (-0.476649 --> -0.479983).  Saving model ...
Epoch: 39 cost time: 6.448591232299805
Epoch: 39, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.728 Vali Acc: 0.493 Test Loss: 1.728 Test Acc: 0.493
Validation loss decreased (-0.479983 --> -0.493316).  Saving model ...
Epoch: 40 cost time: 6.252281427383423
Epoch: 40, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.723 Vali Acc: 0.487 Test Loss: 1.723 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.594764232635498
Epoch: 41, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.710 Vali Acc: 0.483 Test Loss: 1.710 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.257091045379639
Epoch: 42, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.703 Vali Acc: 0.487 Test Loss: 1.703 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.4137372970581055
Epoch: 43, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.710 Vali Acc: 0.480 Test Loss: 1.710 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.5170958042144775
Epoch: 44, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.684 Vali Acc: 0.493 Test Loss: 1.684 Test Acc: 0.493
Validation loss decreased (-0.493316 --> -0.493316).  Saving model ...
Epoch: 45 cost time: 6.2662248611450195
Epoch: 45, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.669 Vali Acc: 0.513 Test Loss: 1.669 Test Acc: 0.513
Validation loss decreased (-0.493316 --> -0.513317).  Saving model ...
Epoch: 46 cost time: 6.775144338607788
Epoch: 46, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.665 Vali Acc: 0.510 Test Loss: 1.665 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.802153587341309
Epoch: 47, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.659 Vali Acc: 0.513 Test Loss: 1.659 Test Acc: 0.513
Validation loss decreased (-0.513317 --> -0.513317).  Saving model ...
Epoch: 48 cost time: 7.014425992965698
Epoch: 48, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.655 Vali Acc: 0.517 Test Loss: 1.655 Test Acc: 0.517
Validation loss decreased (-0.513317 --> -0.516650).  Saving model ...
Epoch: 49 cost time: 6.809177398681641
Epoch: 49, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.642 Vali Acc: 0.517 Test Loss: 1.642 Test Acc: 0.517
Validation loss decreased (-0.516650 --> -0.516650).  Saving model ...
Epoch: 50 cost time: 6.441262722015381
Epoch: 50, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.635 Vali Acc: 0.523 Test Loss: 1.635 Test Acc: 0.523
Validation loss decreased (-0.516650 --> -0.523317).  Saving model ...
Epoch: 51 cost time: 6.929426908493042
Epoch: 51, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.638 Vali Acc: 0.520 Test Loss: 1.638 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.3153417110443115
Epoch: 52, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.633 Vali Acc: 0.527 Test Loss: 1.633 Test Acc: 0.527
Validation loss decreased (-0.523317 --> -0.526650).  Saving model ...
Epoch: 53 cost time: 6.329346656799316
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.631 Vali Acc: 0.520 Test Loss: 1.631 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.524126291275024
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.626 Vali Acc: 0.517 Test Loss: 1.626 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.156912326812744
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.627 Vali Acc: 0.527 Test Loss: 1.627 Test Acc: 0.527
Validation loss decreased (-0.526650 --> -0.526650).  Saving model ...
Epoch: 56 cost time: 6.932599067687988
Epoch: 56, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.615 Vali Acc: 0.530 Test Loss: 1.615 Test Acc: 0.530
Validation loss decreased (-0.526650 --> -0.529984).  Saving model ...
Epoch: 57 cost time: 6.464800834655762
Epoch: 57, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.606 Vali Acc: 0.533 Test Loss: 1.606 Test Acc: 0.533
Validation loss decreased (-0.529984 --> -0.533317).  Saving model ...
Epoch: 58 cost time: 6.704488515853882
Epoch: 58, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.609 Vali Acc: 0.523 Test Loss: 1.609 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.77132511138916
Epoch: 59, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.597 Vali Acc: 0.533 Test Loss: 1.597 Test Acc: 0.533
Validation loss decreased (-0.533317 --> -0.533317).  Saving model ...
Epoch: 60 cost time: 6.643565654754639
Epoch: 60, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.587 Vali Acc: 0.547 Test Loss: 1.587 Test Acc: 0.547
Validation loss decreased (-0.533317 --> -0.546651).  Saving model ...
Epoch: 61 cost time: 7.285582780838013
Epoch: 61, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.578 Vali Acc: 0.550 Test Loss: 1.578 Test Acc: 0.550
Validation loss decreased (-0.546651 --> -0.549984).  Saving model ...
Epoch: 62 cost time: 7.325500965118408
Epoch: 62, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.574 Vali Acc: 0.550 Test Loss: 1.574 Test Acc: 0.550
Validation loss decreased (-0.549984 --> -0.549984).  Saving model ...
Epoch: 63 cost time: 6.7337353229522705
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.567 Vali Acc: 0.557 Test Loss: 1.567 Test Acc: 0.557
Validation loss decreased (-0.549984 --> -0.556651).  Saving model ...
Epoch: 64 cost time: 6.825803279876709
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.562 Vali Acc: 0.560 Test Loss: 1.562 Test Acc: 0.560
Validation loss decreased (-0.556651 --> -0.559984).  Saving model ...
Epoch: 65 cost time: 6.181170701980591
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.553 Vali Acc: 0.567 Test Loss: 1.553 Test Acc: 0.567
Validation loss decreased (-0.559984 --> -0.566651).  Saving model ...
Epoch: 66 cost time: 6.58073353767395
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.567 Vali Acc: 0.553 Test Loss: 1.567 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 6.802896738052368
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.558 Vali Acc: 0.557 Test Loss: 1.558 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 6.183529853820801
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.543 Vali Acc: 0.553 Test Loss: 1.543 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 6.126275300979614
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.537 Vali Acc: 0.567 Test Loss: 1.537 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 70 cost time: 6.678755283355713
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.530 Vali Acc: 0.567 Test Loss: 1.530 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 71 cost time: 6.4453284740448
Epoch: 71, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.525 Vali Acc: 0.573 Test Loss: 1.525 Test Acc: 0.573
Validation loss decreased (-0.566651 --> -0.573318).  Saving model ...
Epoch: 72 cost time: 6.825699329376221
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.522 Vali Acc: 0.577 Test Loss: 1.522 Test Acc: 0.577
Validation loss decreased (-0.573318 --> -0.576651).  Saving model ...
Epoch: 73 cost time: 6.978640556335449
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.522 Vali Acc: 0.580 Test Loss: 1.522 Test Acc: 0.580
Validation loss decreased (-0.576651 --> -0.579985).  Saving model ...
Epoch: 74 cost time: 6.504724979400635
Epoch: 74, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.523 Vali Acc: 0.573 Test Loss: 1.523 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 6.6830668449401855
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.536 Vali Acc: 0.560 Test Loss: 1.536 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 7.183368682861328
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.563 Test Loss: 1.532 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 6.163944959640503
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.519 Vali Acc: 0.570 Test Loss: 1.519 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 6.438393831253052
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.513 Vali Acc: 0.567 Test Loss: 1.513 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 6.51728630065918
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.505 Vali Acc: 0.570 Test Loss: 1.505 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 6.373449087142944
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.505 Vali Acc: 0.573 Test Loss: 1.505 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 6.15440559387207
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.502 Vali Acc: 0.580 Test Loss: 1.502 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 82 cost time: 6.60988187789917
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.494 Vali Acc: 0.580 Test Loss: 1.494 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 83 cost time: 6.673452138900757
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.485 Vali Acc: 0.580 Test Loss: 1.485 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579985).  Saving model ...
Epoch: 84 cost time: 6.749463319778442
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.488 Vali Acc: 0.577 Test Loss: 1.488 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 6.959260940551758
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.484 Vali Acc: 0.577 Test Loss: 1.484 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 5.873743295669556
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.481 Vali Acc: 0.583 Test Loss: 1.481 Test Acc: 0.583
Validation loss decreased (-0.579985 --> -0.583319).  Saving model ...
Epoch: 87 cost time: 6.589447021484375
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.481 Vali Acc: 0.583 Test Loss: 1.481 Test Acc: 0.583
Validation loss decreased (-0.583319 --> -0.583319).  Saving model ...
Epoch: 88 cost time: 6.182416677474976
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.577 Test Loss: 1.475 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 6.848457098007202
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.577 Test Loss: 1.474 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 6.421645879745483
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.469 Vali Acc: 0.580 Test Loss: 1.469 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 6.738542318344116
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.463 Vali Acc: 0.587 Test Loss: 1.463 Test Acc: 0.587
Validation loss decreased (-0.583319 --> -0.586652).  Saving model ...
Epoch: 92 cost time: 6.384021043777466
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.461 Vali Acc: 0.587 Test Loss: 1.461 Test Acc: 0.587
Validation loss decreased (-0.586652 --> -0.586652).  Saving model ...
Epoch: 93 cost time: 6.677404165267944
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.467 Vali Acc: 0.583 Test Loss: 1.467 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 6.549019813537598
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.471 Vali Acc: 0.580 Test Loss: 1.471 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 6.313875675201416
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.464 Vali Acc: 0.580 Test Loss: 1.464 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 6.069812536239624
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.462 Vali Acc: 0.587 Test Loss: 1.462 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 6.08166766166687
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.462 Vali Acc: 0.590 Test Loss: 1.462 Test Acc: 0.590
Validation loss decreased (-0.586652 --> -0.589985).  Saving model ...
Epoch: 98 cost time: 6.337016582489014
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.464 Vali Acc: 0.583 Test Loss: 1.464 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 6.05196475982666
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.459 Vali Acc: 0.590 Test Loss: 1.459 Test Acc: 0.590
Validation loss decreased (-0.589985 --> -0.589985).  Saving model ...
Epoch: 100 cost time: 6.179658889770508
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.457 Vali Acc: 0.583 Test Loss: 1.457 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.59
model parameter : 256921
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.959407091140747
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 6.858758926391602
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.866809606552124
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.920046806335449
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 5 cost time: 6.354040861129761
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.551531076431274
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.8581602573394775
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.359966993331909
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.361634254455566
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.899643659591675
Epoch: 10, Steps: 18 | Train Loss: 3.218 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.894093036651611
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.694262742996216
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.068705081939697
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.354204416275024
Epoch: 14, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 256921
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.222987174987793
Epoch: 1, Steps: 18 | Train Loss: 3.241 Vali Loss: 3.041 Vali Acc: 0.107 Test Loss: 3.041 Test Acc: 0.107
Validation loss decreased (inf --> -0.106636).  Saving model ...
Epoch: 2 cost time: 6.583142042160034
Epoch: 2, Steps: 18 | Train Loss: 2.771 Vali Loss: 2.489 Vali Acc: 0.607 Test Loss: 2.489 Test Acc: 0.607
Validation loss decreased (-0.106636 --> -0.606642).  Saving model ...
Epoch: 3 cost time: 6.722250699996948
Epoch: 3, Steps: 18 | Train Loss: 2.142 Vali Loss: 1.889 Vali Acc: 0.743 Test Loss: 1.889 Test Acc: 0.743
Validation loss decreased (-0.606642 --> -0.743314).  Saving model ...
Epoch: 4 cost time: 6.485104560852051
Epoch: 4, Steps: 18 | Train Loss: 1.466 Vali Loss: 1.359 Vali Acc: 0.810 Test Loss: 1.359 Test Acc: 0.810
Validation loss decreased (-0.743314 --> -0.809986).  Saving model ...
Epoch: 5 cost time: 6.545764923095703
Epoch: 5, Steps: 18 | Train Loss: 0.888 Vali Loss: 0.991 Vali Acc: 0.817 Test Loss: 0.991 Test Acc: 0.817
Validation loss decreased (-0.809986 --> -0.816657).  Saving model ...
Epoch: 6 cost time: 6.299028158187866
Epoch: 6, Steps: 18 | Train Loss: 0.532 Vali Loss: 0.761 Vali Acc: 0.843 Test Loss: 0.761 Test Acc: 0.843
Validation loss decreased (-0.816657 --> -0.843326).  Saving model ...
Epoch: 7 cost time: 6.71021294593811
Epoch: 7, Steps: 18 | Train Loss: 0.277 Vali Loss: 0.646 Vali Acc: 0.840 Test Loss: 0.646 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.709894418716431
Epoch: 8, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.576 Vali Acc: 0.857 Test Loss: 0.576 Test Acc: 0.857
Validation loss decreased (-0.843326 --> -0.856661).  Saving model ...
Epoch: 9 cost time: 7.059335231781006
Epoch: 9, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.530 Vali Acc: 0.863 Test Loss: 0.530 Test Acc: 0.863
Validation loss decreased (-0.856661 --> -0.863328).  Saving model ...
Epoch: 10 cost time: 6.797543525695801
Epoch: 10, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.516 Vali Acc: 0.870 Test Loss: 0.516 Test Acc: 0.870
Validation loss decreased (-0.863328 --> -0.869995).  Saving model ...
Epoch: 11 cost time: 6.432469129562378
Epoch: 11, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.495 Vali Acc: 0.870 Test Loss: 0.495 Test Acc: 0.870
Validation loss decreased (-0.869995 --> -0.869995).  Saving model ...
Epoch: 12 cost time: 6.189370155334473
Epoch: 12, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.484 Vali Acc: 0.873 Test Loss: 0.484 Test Acc: 0.873
Validation loss decreased (-0.869995 --> -0.873328).  Saving model ...
Epoch: 13 cost time: 6.2186877727508545
Epoch: 13, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.476 Vali Acc: 0.883 Test Loss: 0.476 Test Acc: 0.883
Validation loss decreased (-0.873328 --> -0.883329).  Saving model ...
Epoch: 14 cost time: 6.149736166000366
Epoch: 14, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.463 Vali Acc: 0.873 Test Loss: 0.463 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.046126842498779
Epoch: 15, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.459 Vali Acc: 0.880 Test Loss: 0.459 Test Acc: 0.880
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.596952676773071
Epoch: 16, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.454 Vali Acc: 0.883 Test Loss: 0.454 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 17 cost time: 6.605830192565918
Epoch: 17, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.453 Vali Acc: 0.880 Test Loss: 0.453 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.195230484008789
Epoch: 18, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.449 Vali Acc: 0.883 Test Loss: 0.449 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 19 cost time: 6.707369089126587
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.441 Vali Acc: 0.880 Test Loss: 0.441 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.477392196655273
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.438 Vali Acc: 0.883 Test Loss: 0.438 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 21 cost time: 6.6847429275512695
Epoch: 21, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.438 Vali Acc: 0.890 Test Loss: 0.438 Test Acc: 0.890
Validation loss decreased (-0.883329 --> -0.889996).  Saving model ...
Epoch: 22 cost time: 6.614320993423462
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.436 Vali Acc: 0.890 Test Loss: 0.436 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 23 cost time: 6.330920934677124
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.434 Vali Acc: 0.887 Test Loss: 0.434 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.1572675704956055
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.434 Vali Acc: 0.887 Test Loss: 0.434 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.6390509605407715
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.432 Vali Acc: 0.890 Test Loss: 0.432 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 26 cost time: 6.202385663986206
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.429 Vali Acc: 0.890 Test Loss: 0.429 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 27 cost time: 6.468616962432861
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.429 Vali Acc: 0.887 Test Loss: 0.429 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.752919435501099
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.426 Vali Acc: 0.890 Test Loss: 0.426 Test Acc: 0.890
Validation loss decreased (-0.889996 --> -0.889996).  Saving model ...
Epoch: 29 cost time: 6.685635328292847
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.423 Vali Acc: 0.893 Test Loss: 0.423 Test Acc: 0.893
Validation loss decreased (-0.889996 --> -0.893329).  Saving model ...
Epoch: 30 cost time: 6.824639558792114
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.425 Vali Acc: 0.893 Test Loss: 0.425 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 7.239604473114014
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.424 Vali Acc: 0.897 Test Loss: 0.424 Test Acc: 0.897
Validation loss decreased (-0.893329 --> -0.896662).  Saving model ...
Epoch: 32 cost time: 7.365721702575684
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.423 Vali Acc: 0.893 Test Loss: 0.423 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.661815166473389
Epoch: 33, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.422 Vali Acc: 0.897 Test Loss: 0.422 Test Acc: 0.897
Validation loss decreased (-0.896662 --> -0.896662).  Saving model ...
Epoch: 34 cost time: 6.410171031951904
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.420 Vali Acc: 0.897 Test Loss: 0.420 Test Acc: 0.897
Validation loss decreased (-0.896662 --> -0.896662).  Saving model ...
Epoch: 35 cost time: 6.716519832611084
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.418 Vali Acc: 0.897 Test Loss: 0.418 Test Acc: 0.897
Validation loss decreased (-0.896662 --> -0.896662).  Saving model ...
Epoch: 36 cost time: 6.425252437591553
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.897 Test Loss: 0.417 Test Acc: 0.897
Validation loss decreased (-0.896662 --> -0.896662).  Saving model ...
Epoch: 37 cost time: 6.118013381958008
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.416 Vali Acc: 0.897 Test Loss: 0.416 Test Acc: 0.897
Validation loss decreased (-0.896662 --> -0.896663).  Saving model ...
Epoch: 38 cost time: 6.4243364334106445
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.897 Test Loss: 0.415 Test Acc: 0.897
Validation loss decreased (-0.896663 --> -0.896663).  Saving model ...
Epoch: 39 cost time: 6.124913930892944
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.897 Test Loss: 0.414 Test Acc: 0.897
Validation loss decreased (-0.896663 --> -0.896663).  Saving model ...
Epoch: 40 cost time: 6.772024393081665
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.897 Test Loss: 0.414 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.783824682235718
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.897 Test Loss: 0.415 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.798330307006836
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.416 Vali Acc: 0.897 Test Loss: 0.416 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 7.012750625610352
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.416 Vali Acc: 0.897 Test Loss: 0.416 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.979299306869507
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.897 Test Loss: 0.415 Test Acc: 0.897
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 6.608155727386475
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.897 Test Loss: 0.414 Test Acc: 0.897
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 6.581961631774902
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.897 Test Loss: 0.414 Test Acc: 0.897
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 6.768213748931885
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.897 Test Loss: 0.415 Test Acc: 0.897
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 6.718542575836182
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.897 Test Loss: 0.413 Test Acc: 0.897
Validation loss decreased (-0.896663 --> -0.896663).  Saving model ...
Epoch: 49 cost time: 6.630547285079956
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.897 Test Loss: 0.413 Test Acc: 0.897
Validation loss decreased (-0.896663 --> -0.896663).  Saving model ...
Epoch: 50 cost time: 5.773200511932373
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
Validation loss decreased (-0.896663 --> -0.899996).  Saving model ...
Epoch: 51 cost time: 6.067884922027588
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.897 Test Loss: 0.412 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.535062551498413
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.514562606811523
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 54 cost time: 6.0072290897369385
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.897 Test Loss: 0.410 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.300064325332642
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 56 cost time: 6.463234186172485
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 57 cost time: 7.114592552185059
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.903 Test Loss: 0.411 Test Acc: 0.903
Validation loss decreased (-0.899996 --> -0.903329).  Saving model ...
Epoch: 58 cost time: 6.0323405265808105
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.347326755523682
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 6.497828483581543
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 6.708705186843872
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 6.835347652435303
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 6.156789302825928
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.903 Test Loss: 0.408 Test Acc: 0.903
Validation loss decreased (-0.903329 --> -0.903329).  Saving model ...
Epoch: 64 cost time: 6.089606523513794
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.903 Test Loss: 0.406 Test Acc: 0.903
Validation loss decreased (-0.903329 --> -0.903329).  Saving model ...
Epoch: 65 cost time: 6.315043210983276
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.903 Test Loss: 0.406 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 6.5056304931640625
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.903 Test Loss: 0.405 Test Acc: 0.903
Validation loss decreased (-0.903329 --> -0.903329).  Saving model ...
Epoch: 67 cost time: 6.047333717346191
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.903 Test Loss: 0.405 Test Acc: 0.903
Validation loss decreased (-0.903329 --> -0.903329).  Saving model ...
Epoch: 68 cost time: 6.489495277404785
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.404 Vali Acc: 0.903 Test Loss: 0.404 Test Acc: 0.903
Validation loss decreased (-0.903329 --> -0.903329).  Saving model ...
Epoch: 69 cost time: 6.612417221069336
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.903 Test Loss: 0.405 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 6.826669454574585
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.903 Test Loss: 0.405 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 6.555926561355591
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.903 Test Loss: 0.406 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 6.9678356647491455
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 6.4630982875823975
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.903 Test Loss: 0.407 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 6.165893793106079
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.903 Test Loss: 0.406 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 6.3665032386779785
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.903 Test Loss: 0.406 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 6.379149913787842
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.903 Test Loss: 0.406 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 5.877904176712036
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.903 Test Loss: 0.405 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 6.2883923053741455
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.903 Test Loss: 0.404 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9033333333333333
model parameter : 207769
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.15957236289978
Epoch: 1, Steps: 18 | Train Loss: 3.278 Vali Loss: 3.115 Vali Acc: 0.093 Test Loss: 3.115 Test Acc: 0.093
Validation loss decreased (inf --> -0.093302).  Saving model ...
Epoch: 2 cost time: 6.529364109039307
Epoch: 2, Steps: 18 | Train Loss: 2.910 Vali Loss: 2.699 Vali Acc: 0.470 Test Loss: 2.699 Test Acc: 0.470
Validation loss decreased (-0.093302 --> -0.469973).  Saving model ...
Epoch: 3 cost time: 6.293296813964844
Epoch: 3, Steps: 18 | Train Loss: 2.398 Vali Loss: 2.219 Vali Acc: 0.657 Test Loss: 2.219 Test Acc: 0.657
Validation loss decreased (-0.469973 --> -0.656644).  Saving model ...
Epoch: 4 cost time: 6.378063678741455
Epoch: 4, Steps: 18 | Train Loss: 1.803 Vali Loss: 1.724 Vali Acc: 0.763 Test Loss: 1.724 Test Acc: 0.763
Validation loss decreased (-0.656644 --> -0.763316).  Saving model ...
Epoch: 5 cost time: 6.410694122314453
Epoch: 5, Steps: 18 | Train Loss: 1.211 Vali Loss: 1.314 Vali Acc: 0.797 Test Loss: 1.314 Test Acc: 0.797
Validation loss decreased (-0.763316 --> -0.796654).  Saving model ...
Epoch: 6 cost time: 6.079419136047363
Epoch: 6, Steps: 18 | Train Loss: 0.764 Vali Loss: 1.019 Vali Acc: 0.830 Test Loss: 1.019 Test Acc: 0.830
Validation loss decreased (-0.796654 --> -0.829990).  Saving model ...
Epoch: 7 cost time: 5.763437747955322
Epoch: 7, Steps: 18 | Train Loss: 0.417 Vali Loss: 0.848 Vali Acc: 0.820 Test Loss: 0.848 Test Acc: 0.820
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.7491607666015625
Epoch: 8, Steps: 18 | Train Loss: 0.255 Vali Loss: 0.744 Vali Acc: 0.840 Test Loss: 0.744 Test Acc: 0.840
Validation loss decreased (-0.829990 --> -0.839993).  Saving model ...
Epoch: 9 cost time: 5.93027400970459
Epoch: 9, Steps: 18 | Train Loss: 0.143 Vali Loss: 0.679 Vali Acc: 0.840 Test Loss: 0.679 Test Acc: 0.840
Validation loss decreased (-0.839993 --> -0.839993).  Saving model ...
Epoch: 10 cost time: 6.093858480453491
Epoch: 10, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.659 Vali Acc: 0.857 Test Loss: 0.659 Test Acc: 0.857
Validation loss decreased (-0.839993 --> -0.856660).  Saving model ...
Epoch: 11 cost time: 6.499542474746704
Epoch: 11, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.633 Vali Acc: 0.847 Test Loss: 0.633 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.751816272735596
Epoch: 12, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.616 Vali Acc: 0.847 Test Loss: 0.616 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.537568807601929
Epoch: 13, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.606 Vali Acc: 0.840 Test Loss: 0.606 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.300446510314941
Epoch: 14, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.591 Vali Acc: 0.847 Test Loss: 0.591 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.9975502490997314
Epoch: 15, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.587 Vali Acc: 0.840 Test Loss: 0.587 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.05318808555603
Epoch: 16, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.582 Vali Acc: 0.840 Test Loss: 0.582 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.299423933029175
Epoch: 17, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.579 Vali Acc: 0.837 Test Loss: 0.579 Test Acc: 0.837
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.003148317337036
Epoch: 18, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.575 Vali Acc: 0.847 Test Loss: 0.575 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.30637001991272
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.590818405151367
Epoch: 20, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8566666666666667
model parameter : 207769
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.8379225730896
Epoch: 1, Steps: 18 | Train Loss: 3.309 Vali Loss: 3.181 Vali Acc: 0.077 Test Loss: 3.181 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 6.42743182182312
Epoch: 2, Steps: 18 | Train Loss: 3.020 Vali Loss: 2.899 Vali Acc: 0.290 Test Loss: 2.899 Test Acc: 0.290
Validation loss decreased (-0.076635 --> -0.289971).  Saving model ...
Epoch: 3 cost time: 6.094026803970337
Epoch: 3, Steps: 18 | Train Loss: 2.641 Vali Loss: 2.568 Vali Acc: 0.480 Test Loss: 2.568 Test Acc: 0.480
Validation loss decreased (-0.289971 --> -0.479974).  Saving model ...
Epoch: 4 cost time: 6.250483274459839
Epoch: 4, Steps: 18 | Train Loss: 2.155 Vali Loss: 2.194 Vali Acc: 0.633 Test Loss: 2.194 Test Acc: 0.633
Validation loss decreased (-0.479974 --> -0.633311).  Saving model ...
Epoch: 5 cost time: 6.437598705291748
Epoch: 5, Steps: 18 | Train Loss: 1.652 Vali Loss: 1.832 Vali Acc: 0.680 Test Loss: 1.832 Test Acc: 0.680
Validation loss decreased (-0.633311 --> -0.679982).  Saving model ...
Epoch: 6 cost time: 6.239101409912109
Epoch: 6, Steps: 18 | Train Loss: 1.147 Vali Loss: 1.516 Vali Acc: 0.743 Test Loss: 1.516 Test Acc: 0.743
Validation loss decreased (-0.679982 --> -0.743318).  Saving model ...
Epoch: 7 cost time: 5.877791166305542
Epoch: 7, Steps: 18 | Train Loss: 0.710 Vali Loss: 1.272 Vali Acc: 0.743 Test Loss: 1.272 Test Acc: 0.743
Validation loss decreased (-0.743318 --> -0.743321).  Saving model ...
Epoch: 8 cost time: 6.267861366271973
Epoch: 8, Steps: 18 | Train Loss: 0.445 Vali Loss: 1.103 Vali Acc: 0.757 Test Loss: 1.103 Test Acc: 0.757
Validation loss decreased (-0.743321 --> -0.756656).  Saving model ...
Epoch: 9 cost time: 5.700921535491943
Epoch: 9, Steps: 18 | Train Loss: 0.256 Vali Loss: 1.004 Vali Acc: 0.767 Test Loss: 1.004 Test Acc: 0.767
Validation loss decreased (-0.756656 --> -0.766657).  Saving model ...
Epoch: 10 cost time: 6.736635208129883
Epoch: 10, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.950 Vali Acc: 0.767 Test Loss: 0.950 Test Acc: 0.767
Validation loss decreased (-0.766657 --> -0.766657).  Saving model ...
Epoch: 11 cost time: 6.062624931335449
Epoch: 11, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.906 Vali Acc: 0.767 Test Loss: 0.906 Test Acc: 0.767
Validation loss decreased (-0.766657 --> -0.766658).  Saving model ...
Epoch: 12 cost time: 6.787389278411865
Epoch: 12, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.882 Vali Acc: 0.783 Test Loss: 0.882 Test Acc: 0.783
Validation loss decreased (-0.766658 --> -0.783325).  Saving model ...
Epoch: 13 cost time: 6.362825155258179
Epoch: 13, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.862 Vali Acc: 0.790 Test Loss: 0.862 Test Acc: 0.790
Validation loss decreased (-0.783325 --> -0.789991).  Saving model ...
Epoch: 14 cost time: 6.539354562759399
Epoch: 14, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.844 Vali Acc: 0.797 Test Loss: 0.844 Test Acc: 0.797
Validation loss decreased (-0.789991 --> -0.796658).  Saving model ...
Epoch: 15 cost time: 6.529924392700195
Epoch: 15, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.839 Vali Acc: 0.790 Test Loss: 0.839 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.784692287445068
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.830 Vali Acc: 0.793 Test Loss: 0.830 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.915045499801636
Epoch: 17, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.828 Vali Acc: 0.790 Test Loss: 0.828 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.062466621398926
Epoch: 18, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.823 Vali Acc: 0.790 Test Loss: 0.823 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.117756128311157
Epoch: 19, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.809 Vali Acc: 0.790 Test Loss: 0.809 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.1807050704956055
Epoch: 20, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.805 Vali Acc: 0.793 Test Loss: 0.805 Test Acc: 0.793
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.156723260879517
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.809 Vali Acc: 0.790 Test Loss: 0.809 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.372814655303955
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.810 Vali Acc: 0.787 Test Loss: 0.810 Test Acc: 0.787
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.163588047027588
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.804 Vali Acc: 0.800 Test Loss: 0.804 Test Acc: 0.800
Validation loss decreased (-0.796658 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 6.939243793487549
Epoch: 24, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.800 Vali Acc: 0.807 Test Loss: 0.800 Test Acc: 0.807
Validation loss decreased (-0.799992 --> -0.806659).  Saving model ...
Epoch: 25 cost time: 6.964401483535767
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.799 Vali Acc: 0.797 Test Loss: 0.799 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.841277360916138
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.791 Vali Acc: 0.790 Test Loss: 0.791 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.595139026641846
Epoch: 27, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.793 Vali Acc: 0.793 Test Loss: 0.793 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.033989429473877
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.796 Vali Acc: 0.790 Test Loss: 0.796 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.171608924865723
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.791 Vali Acc: 0.797 Test Loss: 0.791 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.101858139038086
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.795 Vali Acc: 0.793 Test Loss: 0.795 Test Acc: 0.793
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.35199761390686
Epoch: 31, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.795 Vali Acc: 0.793 Test Loss: 0.795 Test Acc: 0.793
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.767767667770386
Epoch: 32, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.794 Vali Acc: 0.793 Test Loss: 0.794 Test Acc: 0.793
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 6.4101951122283936
Epoch: 33, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.794 Vali Acc: 0.793 Test Loss: 0.794 Test Acc: 0.793
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.2985453605651855
Epoch: 34, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8066666666666666
model parameter : 207769
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.175248384475708
Epoch: 1, Steps: 18 | Train Loss: 3.292 Vali Loss: 3.218 Vali Acc: 0.060 Test Loss: 3.218 Test Acc: 0.060
Validation loss decreased (inf --> -0.059968).  Saving model ...
Epoch: 2 cost time: 6.794831275939941
Epoch: 2, Steps: 18 | Train Loss: 3.106 Vali Loss: 3.048 Vali Acc: 0.153 Test Loss: 3.048 Test Acc: 0.153
Validation loss decreased (-0.059968 --> -0.153303).  Saving model ...
Epoch: 3 cost time: 6.701701641082764
Epoch: 3, Steps: 18 | Train Loss: 2.831 Vali Loss: 2.852 Vali Acc: 0.223 Test Loss: 2.852 Test Acc: 0.223
Validation loss decreased (-0.153303 --> -0.223305).  Saving model ...
Epoch: 4 cost time: 6.438044786453247
Epoch: 4, Steps: 18 | Train Loss: 2.435 Vali Loss: 2.620 Vali Acc: 0.387 Test Loss: 2.620 Test Acc: 0.387
Validation loss decreased (-0.223305 --> -0.386640).  Saving model ...
Epoch: 5 cost time: 6.842866897583008
Epoch: 5, Steps: 18 | Train Loss: 2.055 Vali Loss: 2.380 Vali Acc: 0.467 Test Loss: 2.380 Test Acc: 0.467
Validation loss decreased (-0.386640 --> -0.466643).  Saving model ...
Epoch: 6 cost time: 6.717238426208496
Epoch: 6, Steps: 18 | Train Loss: 1.602 Vali Loss: 2.146 Vali Acc: 0.510 Test Loss: 2.146 Test Acc: 0.510
Validation loss decreased (-0.466643 --> -0.509979).  Saving model ...
Epoch: 7 cost time: 5.95447564125061
Epoch: 7, Steps: 18 | Train Loss: 1.148 Vali Loss: 1.927 Vali Acc: 0.550 Test Loss: 1.927 Test Acc: 0.550
Validation loss decreased (-0.509979 --> -0.549981).  Saving model ...
Epoch: 8 cost time: 6.9251017570495605
Epoch: 8, Steps: 18 | Train Loss: 0.797 Vali Loss: 1.747 Vali Acc: 0.540 Test Loss: 1.747 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.372682571411133
Epoch: 9, Steps: 18 | Train Loss: 0.503 Vali Loss: 1.604 Vali Acc: 0.583 Test Loss: 1.604 Test Acc: 0.583
Validation loss decreased (-0.549981 --> -0.583317).  Saving model ...
Epoch: 10 cost time: 6.763512849807739
Epoch: 10, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.491 Vali Acc: 0.553 Test Loss: 1.491 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.977146148681641
Epoch: 11, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.426 Vali Acc: 0.560 Test Loss: 1.426 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.7507219314575195
Epoch: 12, Steps: 18 | Train Loss: 0.117 Vali Loss: 1.389 Vali Acc: 0.580 Test Loss: 1.389 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.759766340255737
Epoch: 13, Steps: 18 | Train Loss: 0.086 Vali Loss: 1.337 Vali Acc: 0.600 Test Loss: 1.337 Test Acc: 0.600
Validation loss decreased (-0.583317 --> -0.599987).  Saving model ...
Epoch: 14 cost time: 6.1957902908325195
Epoch: 14, Steps: 18 | Train Loss: 0.059 Vali Loss: 1.307 Vali Acc: 0.597 Test Loss: 1.307 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.231932878494263
Epoch: 15, Steps: 18 | Train Loss: 0.055 Vali Loss: 1.281 Vali Acc: 0.617 Test Loss: 1.281 Test Acc: 0.617
Validation loss decreased (-0.599987 --> -0.616654).  Saving model ...
Epoch: 16 cost time: 6.131108522415161
Epoch: 16, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.260 Vali Acc: 0.597 Test Loss: 1.260 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.36996865272522
Epoch: 17, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.247 Vali Acc: 0.603 Test Loss: 1.247 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.25131893157959
Epoch: 18, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.247 Vali Acc: 0.610 Test Loss: 1.247 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.20036244392395
Epoch: 19, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.220 Vali Acc: 0.623 Test Loss: 1.220 Test Acc: 0.623
Validation loss decreased (-0.616654 --> -0.623321).  Saving model ...
Epoch: 20 cost time: 6.530236721038818
Epoch: 20, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.211 Vali Acc: 0.627 Test Loss: 1.211 Test Acc: 0.627
Validation loss decreased (-0.623321 --> -0.626655).  Saving model ...
Epoch: 21 cost time: 6.480338096618652
Epoch: 21, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.206 Vali Acc: 0.623 Test Loss: 1.206 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.43698787689209
Epoch: 22, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.194 Vali Acc: 0.623 Test Loss: 1.194 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.277137041091919
Epoch: 23, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.181 Vali Acc: 0.623 Test Loss: 1.181 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.250725269317627
Epoch: 24, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.169 Vali Acc: 0.633 Test Loss: 1.169 Test Acc: 0.633
Validation loss decreased (-0.626655 --> -0.633322).  Saving model ...
Epoch: 25 cost time: 6.213667154312134
Epoch: 25, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.158 Vali Acc: 0.630 Test Loss: 1.158 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.456354141235352
Epoch: 26, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.148 Vali Acc: 0.630 Test Loss: 1.148 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.412657737731934
Epoch: 27, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.142 Vali Acc: 0.637 Test Loss: 1.142 Test Acc: 0.637
Validation loss decreased (-0.633322 --> -0.636655).  Saving model ...
Epoch: 28 cost time: 6.645031213760376
Epoch: 28, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.137 Vali Acc: 0.640 Test Loss: 1.137 Test Acc: 0.640
Validation loss decreased (-0.636655 --> -0.639989).  Saving model ...
Epoch: 29 cost time: 6.187804460525513
Epoch: 29, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.132 Vali Acc: 0.643 Test Loss: 1.132 Test Acc: 0.643
Validation loss decreased (-0.639989 --> -0.643322).  Saving model ...
Epoch: 30 cost time: 6.838706016540527
Epoch: 30, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.130 Vali Acc: 0.643 Test Loss: 1.130 Test Acc: 0.643
Validation loss decreased (-0.643322 --> -0.643322).  Saving model ...
Epoch: 31 cost time: 6.147143602371216
Epoch: 31, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.126 Vali Acc: 0.633 Test Loss: 1.126 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.978677272796631
Epoch: 32, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.118 Vali Acc: 0.647 Test Loss: 1.118 Test Acc: 0.647
Validation loss decreased (-0.643322 --> -0.646655).  Saving model ...
Epoch: 33 cost time: 6.584165811538696
Epoch: 33, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.113 Vali Acc: 0.647 Test Loss: 1.113 Test Acc: 0.647
Validation loss decreased (-0.646655 --> -0.646656).  Saving model ...
Epoch: 34 cost time: 6.124506950378418
Epoch: 34, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.103 Vali Acc: 0.647 Test Loss: 1.103 Test Acc: 0.647
Validation loss decreased (-0.646656 --> -0.646656).  Saving model ...
Epoch: 35 cost time: 6.5481648445129395
Epoch: 35, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.102 Vali Acc: 0.650 Test Loss: 1.102 Test Acc: 0.650
Validation loss decreased (-0.646656 --> -0.649989).  Saving model ...
Epoch: 36 cost time: 6.74800443649292
Epoch: 36, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.097 Vali Acc: 0.650 Test Loss: 1.097 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 37 cost time: 6.470991134643555
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.094 Vali Acc: 0.650 Test Loss: 1.094 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 38 cost time: 6.975387334823608
Epoch: 38, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.091 Vali Acc: 0.647 Test Loss: 1.091 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.4987921714782715
Epoch: 39, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.090 Vali Acc: 0.653 Test Loss: 1.090 Test Acc: 0.653
Validation loss decreased (-0.649989 --> -0.653322).  Saving model ...
Epoch: 40 cost time: 6.402763605117798
Epoch: 40, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.087 Vali Acc: 0.657 Test Loss: 1.087 Test Acc: 0.657
Validation loss decreased (-0.653322 --> -0.656656).  Saving model ...
Epoch: 41 cost time: 6.709662914276123
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.082 Vali Acc: 0.653 Test Loss: 1.082 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.509026288986206
Epoch: 42, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.077 Vali Acc: 0.660 Test Loss: 1.077 Test Acc: 0.660
Validation loss decreased (-0.656656 --> -0.659989).  Saving model ...
Epoch: 43 cost time: 5.972177028656006
Epoch: 43, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.076 Vali Acc: 0.657 Test Loss: 1.076 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.605035781860352
Epoch: 44, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.074 Vali Acc: 0.657 Test Loss: 1.074 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 6.125283718109131
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.069 Vali Acc: 0.657 Test Loss: 1.069 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 6.278451204299927
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.070 Vali Acc: 0.657 Test Loss: 1.070 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 6.524949073791504
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.069 Vali Acc: 0.653 Test Loss: 1.069 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 6.563172817230225
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.066 Vali Acc: 0.657 Test Loss: 1.066 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 6.859719514846802
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.064 Vali Acc: 0.663 Test Loss: 1.064 Test Acc: 0.663
Validation loss decreased (-0.659989 --> -0.663323).  Saving model ...
Epoch: 50 cost time: 6.207273960113525
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.062 Vali Acc: 0.663 Test Loss: 1.062 Test Acc: 0.663
Validation loss decreased (-0.663323 --> -0.663323).  Saving model ...
Epoch: 51 cost time: 6.348031520843506
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.059 Vali Acc: 0.667 Test Loss: 1.059 Test Acc: 0.667
Validation loss decreased (-0.663323 --> -0.666656).  Saving model ...
Epoch: 52 cost time: 6.312429904937744
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.057 Vali Acc: 0.670 Test Loss: 1.057 Test Acc: 0.670
Validation loss decreased (-0.666656 --> -0.669989).  Saving model ...
Epoch: 53 cost time: 6.1319420337677
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.056 Vali Acc: 0.677 Test Loss: 1.056 Test Acc: 0.677
Validation loss decreased (-0.669989 --> -0.676656).  Saving model ...
Epoch: 54 cost time: 6.2564616203308105
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.054 Vali Acc: 0.680 Test Loss: 1.054 Test Acc: 0.680
Validation loss decreased (-0.676656 --> -0.679989).  Saving model ...
Epoch: 55 cost time: 6.230439186096191
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.051 Vali Acc: 0.680 Test Loss: 1.051 Test Acc: 0.680
Validation loss decreased (-0.679989 --> -0.679989).  Saving model ...
Epoch: 56 cost time: 6.3611931800842285
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.051 Vali Acc: 0.683 Test Loss: 1.051 Test Acc: 0.683
Validation loss decreased (-0.679989 --> -0.683323).  Saving model ...
Epoch: 57 cost time: 6.26456093788147
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.053 Vali Acc: 0.673 Test Loss: 1.053 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.609498023986816
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.055 Vali Acc: 0.673 Test Loss: 1.055 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 6.626565217971802
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.050 Vali Acc: 0.680 Test Loss: 1.050 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 6.737027406692505
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.047 Vali Acc: 0.680 Test Loss: 1.047 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 6.21083402633667
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.042 Vali Acc: 0.687 Test Loss: 1.042 Test Acc: 0.687
Validation loss decreased (-0.683323 --> -0.686656).  Saving model ...
Epoch: 62 cost time: 6.8189356327056885
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.040 Vali Acc: 0.687 Test Loss: 1.040 Test Acc: 0.687
Validation loss decreased (-0.686656 --> -0.686656).  Saving model ...
Epoch: 63 cost time: 6.544071197509766
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.038 Vali Acc: 0.690 Test Loss: 1.038 Test Acc: 0.690
Validation loss decreased (-0.686656 --> -0.689990).  Saving model ...
Epoch: 64 cost time: 5.9353766441345215
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.039 Vali Acc: 0.693 Test Loss: 1.039 Test Acc: 0.693
Validation loss decreased (-0.689990 --> -0.693323).  Saving model ...
Epoch: 65 cost time: 6.2608418464660645
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.043 Vali Acc: 0.683 Test Loss: 1.043 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 6.284631729125977
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.042 Vali Acc: 0.683 Test Loss: 1.042 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 6.404858112335205
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.040 Vali Acc: 0.687 Test Loss: 1.040 Test Acc: 0.687
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 6.871734380722046
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.037 Vali Acc: 0.690 Test Loss: 1.037 Test Acc: 0.690
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 7.4051854610443115
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.034 Vali Acc: 0.693 Test Loss: 1.034 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 70 cost time: 6.931288719177246
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.690 Test Loss: 1.030 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 6.631895065307617
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.028 Vali Acc: 0.690 Test Loss: 1.028 Test Acc: 0.690
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 6.67403244972229
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.027 Vali Acc: 0.693 Test Loss: 1.027 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 73 cost time: 6.27338981628418
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.026 Vali Acc: 0.683 Test Loss: 1.026 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 5.951328754425049
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.023 Vali Acc: 0.687 Test Loss: 1.023 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 5.632108688354492
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.687 Test Loss: 1.024 Test Acc: 0.687
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 6.028218984603882
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.690 Test Loss: 1.024 Test Acc: 0.690
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 6.542140007019043
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.693 Test Loss: 1.024 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 78 cost time: 6.558176279067993
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.025 Vali Acc: 0.697 Test Loss: 1.025 Test Acc: 0.697
Validation loss decreased (-0.693323 --> -0.696656).  Saving model ...
Epoch: 79 cost time: 6.726928472518921
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.693 Test Loss: 1.024 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 6.46562933921814
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.020 Vali Acc: 0.693 Test Loss: 1.020 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 6.295141696929932
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.020 Vali Acc: 0.697 Test Loss: 1.020 Test Acc: 0.697
Validation loss decreased (-0.696656 --> -0.696656).  Saving model ...
Epoch: 82 cost time: 6.454951763153076
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.018 Vali Acc: 0.700 Test Loss: 1.018 Test Acc: 0.700
Validation loss decreased (-0.696656 --> -0.699990).  Saving model ...
Epoch: 83 cost time: 5.994396209716797
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.697 Test Loss: 1.017 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 6.121061086654663
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.018 Vali Acc: 0.703 Test Loss: 1.018 Test Acc: 0.703
Validation loss decreased (-0.699990 --> -0.703323).  Saving model ...
Epoch: 85 cost time: 5.932345390319824
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.018 Vali Acc: 0.703 Test Loss: 1.018 Test Acc: 0.703
Validation loss decreased (-0.703323 --> -0.703323).  Saving model ...
Epoch: 86 cost time: 6.490521192550659
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.707 Test Loss: 1.014 Test Acc: 0.707
Validation loss decreased (-0.703323 --> -0.706657).  Saving model ...
Epoch: 87 cost time: 6.118130922317505
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.012 Vali Acc: 0.703 Test Loss: 1.012 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 6.943378925323486
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.009 Vali Acc: 0.703 Test Loss: 1.009 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 6.5834009647369385
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.006 Vali Acc: 0.703 Test Loss: 1.006 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 6.338122844696045
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.700 Test Loss: 1.007 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 6.781953573226929
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.707 Test Loss: 1.010 Test Acc: 0.707
Validation loss decreased (-0.706657 --> -0.706657).  Saving model ...
Epoch: 92 cost time: 6.563490867614746
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.703 Test Loss: 1.011 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 6.374699354171753
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 6.211675643920898
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.707 Test Loss: 1.009 Test Acc: 0.707
Validation loss decreased (-0.706657 --> -0.706657).  Saving model ...
Epoch: 95 cost time: 6.51956844329834
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.707 Test Loss: 1.010 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 5.621991157531738
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.707 Test Loss: 1.010 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 6.044252395629883
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.707 Test Loss: 1.007 Test Acc: 0.707
Validation loss decreased (-0.706657 --> -0.706657).  Saving model ...
Epoch: 98 cost time: 6.19605016708374
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.707 Test Loss: 1.005 Test Acc: 0.707
Validation loss decreased (-0.706657 --> -0.706657).  Saving model ...
Epoch: 99 cost time: 6.788273572921753
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.710 Test Loss: 1.005 Test Acc: 0.710
Validation loss decreased (-0.706657 --> -0.709990).  Saving model ...
Epoch: 100 cost time: 6.69035005569458
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.710 Test Loss: 1.005 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.71
model parameter : 207769
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.4963059425354
Epoch: 1, Steps: 18 | Train Loss: 3.309 Vali Loss: 3.237 Vali Acc: 0.033 Test Loss: 3.237 Test Acc: 0.033
Validation loss decreased (inf --> -0.033301).  Saving model ...
Epoch: 2 cost time: 6.3109190464019775
Epoch: 2, Steps: 18 | Train Loss: 3.147 Vali Loss: 3.114 Vali Acc: 0.120 Test Loss: 3.114 Test Acc: 0.120
Validation loss decreased (-0.033301 --> -0.119969).  Saving model ...
Epoch: 3 cost time: 6.237462282180786
Epoch: 3, Steps: 18 | Train Loss: 2.906 Vali Loss: 2.987 Vali Acc: 0.190 Test Loss: 2.987 Test Acc: 0.190
Validation loss decreased (-0.119969 --> -0.189970).  Saving model ...
Epoch: 4 cost time: 6.0940752029418945
Epoch: 4, Steps: 18 | Train Loss: 2.590 Vali Loss: 2.842 Vali Acc: 0.217 Test Loss: 2.842 Test Acc: 0.217
Validation loss decreased (-0.189970 --> -0.216638).  Saving model ...
Epoch: 5 cost time: 6.043698310852051
Epoch: 5, Steps: 18 | Train Loss: 2.244 Vali Loss: 2.690 Vali Acc: 0.270 Test Loss: 2.690 Test Acc: 0.270
Validation loss decreased (-0.216638 --> -0.269973).  Saving model ...
Epoch: 6 cost time: 6.254666566848755
Epoch: 6, Steps: 18 | Train Loss: 1.875 Vali Loss: 2.538 Vali Acc: 0.307 Test Loss: 2.538 Test Acc: 0.307
Validation loss decreased (-0.269973 --> -0.306641).  Saving model ...
Epoch: 7 cost time: 6.053554058074951
Epoch: 7, Steps: 18 | Train Loss: 1.463 Vali Loss: 2.384 Vali Acc: 0.363 Test Loss: 2.384 Test Acc: 0.363
Validation loss decreased (-0.306641 --> -0.363309).  Saving model ...
Epoch: 8 cost time: 6.162622690200806
Epoch: 8, Steps: 18 | Train Loss: 1.095 Vali Loss: 2.257 Vali Acc: 0.353 Test Loss: 2.257 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.078351259231567
Epoch: 9, Steps: 18 | Train Loss: 0.799 Vali Loss: 2.146 Vali Acc: 0.393 Test Loss: 2.146 Test Acc: 0.393
Validation loss decreased (-0.363309 --> -0.393312).  Saving model ...
Epoch: 10 cost time: 6.503405809402466
Epoch: 10, Steps: 18 | Train Loss: 0.528 Vali Loss: 2.041 Vali Acc: 0.427 Test Loss: 2.041 Test Acc: 0.427
Validation loss decreased (-0.393312 --> -0.426646).  Saving model ...
Epoch: 11 cost time: 6.489514350891113
Epoch: 11, Steps: 18 | Train Loss: 0.339 Vali Loss: 1.941 Vali Acc: 0.437 Test Loss: 1.941 Test Acc: 0.437
Validation loss decreased (-0.426646 --> -0.436647).  Saving model ...
Epoch: 12 cost time: 6.207566499710083
Epoch: 12, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.878 Vali Acc: 0.440 Test Loss: 1.878 Test Acc: 0.440
Validation loss decreased (-0.436647 --> -0.439981).  Saving model ...
Epoch: 13 cost time: 6.758804798126221
Epoch: 13, Steps: 18 | Train Loss: 0.134 Vali Loss: 1.799 Vali Acc: 0.467 Test Loss: 1.799 Test Acc: 0.467
Validation loss decreased (-0.439981 --> -0.466649).  Saving model ...
Epoch: 14 cost time: 5.947167634963989
Epoch: 14, Steps: 18 | Train Loss: 0.092 Vali Loss: 1.757 Vali Acc: 0.483 Test Loss: 1.757 Test Acc: 0.483
Validation loss decreased (-0.466649 --> -0.483316).  Saving model ...
Epoch: 15 cost time: 6.520315647125244
Epoch: 15, Steps: 18 | Train Loss: 0.073 Vali Loss: 1.704 Vali Acc: 0.507 Test Loss: 1.704 Test Acc: 0.507
Validation loss decreased (-0.483316 --> -0.506650).  Saving model ...
Epoch: 16 cost time: 5.939428806304932
Epoch: 16, Steps: 18 | Train Loss: 0.051 Vali Loss: 1.651 Vali Acc: 0.543 Test Loss: 1.651 Test Acc: 0.543
Validation loss decreased (-0.506650 --> -0.543317).  Saving model ...
Epoch: 17 cost time: 6.383591890335083
Epoch: 17, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.617 Vali Acc: 0.530 Test Loss: 1.617 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.804594278335571
Epoch: 18, Steps: 18 | Train Loss: 0.038 Vali Loss: 1.601 Vali Acc: 0.520 Test Loss: 1.601 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.213756084442139
Epoch: 19, Steps: 18 | Train Loss: 0.031 Vali Loss: 1.573 Vali Acc: 0.533 Test Loss: 1.573 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.725361347198486
Epoch: 20, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.553 Vali Acc: 0.550 Test Loss: 1.553 Test Acc: 0.550
Validation loss decreased (-0.543317 --> -0.549984).  Saving model ...
Epoch: 21 cost time: 6.730966567993164
Epoch: 21, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.520 Vali Acc: 0.553 Test Loss: 1.520 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553318).  Saving model ...
Epoch: 22 cost time: 6.707162618637085
Epoch: 22, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.496 Vali Acc: 0.553 Test Loss: 1.496 Test Acc: 0.553
Validation loss decreased (-0.553318 --> -0.553318).  Saving model ...
Epoch: 23 cost time: 6.671905517578125
Epoch: 23, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.479 Vali Acc: 0.553 Test Loss: 1.479 Test Acc: 0.553
Validation loss decreased (-0.553318 --> -0.553319).  Saving model ...
Epoch: 24 cost time: 6.22361946105957
Epoch: 24, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.450 Vali Acc: 0.563 Test Loss: 1.450 Test Acc: 0.563
Validation loss decreased (-0.553319 --> -0.563319).  Saving model ...
Epoch: 25 cost time: 6.450747966766357
Epoch: 25, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.431 Vali Acc: 0.587 Test Loss: 1.431 Test Acc: 0.587
Validation loss decreased (-0.563319 --> -0.586652).  Saving model ...
Epoch: 26 cost time: 5.833633661270142
Epoch: 26, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.423 Vali Acc: 0.567 Test Loss: 1.423 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.421022653579712
Epoch: 27, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.415 Vali Acc: 0.570 Test Loss: 1.415 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.980233907699585
Epoch: 28, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.410 Vali Acc: 0.587 Test Loss: 1.410 Test Acc: 0.587
Validation loss decreased (-0.586652 --> -0.586653).  Saving model ...
Epoch: 29 cost time: 6.182334661483765
Epoch: 29, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.403 Vali Acc: 0.587 Test Loss: 1.403 Test Acc: 0.587
Validation loss decreased (-0.586653 --> -0.586653).  Saving model ...
Epoch: 30 cost time: 6.238917589187622
Epoch: 30, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.392 Vali Acc: 0.583 Test Loss: 1.392 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.378957509994507
Epoch: 31, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.383 Vali Acc: 0.590 Test Loss: 1.383 Test Acc: 0.590
Validation loss decreased (-0.586653 --> -0.589986).  Saving model ...
Epoch: 32 cost time: 5.987444639205933
Epoch: 32, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.375 Vali Acc: 0.587 Test Loss: 1.375 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.0858917236328125
Epoch: 33, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.363 Vali Acc: 0.590 Test Loss: 1.363 Test Acc: 0.590
Validation loss decreased (-0.589986 --> -0.589986).  Saving model ...
Epoch: 34 cost time: 5.372307062149048
Epoch: 34, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.356 Vali Acc: 0.587 Test Loss: 1.356 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.758392095565796
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.355 Vali Acc: 0.573 Test Loss: 1.355 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.4212119579315186
Epoch: 36, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.347 Vali Acc: 0.587 Test Loss: 1.347 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 6.335900545120239
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.342 Vali Acc: 0.593 Test Loss: 1.342 Test Acc: 0.593
Validation loss decreased (-0.589986 --> -0.593320).  Saving model ...
Epoch: 38 cost time: 6.346172571182251
Epoch: 38, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.337 Vali Acc: 0.593 Test Loss: 1.337 Test Acc: 0.593
Validation loss decreased (-0.593320 --> -0.593320).  Saving model ...
Epoch: 39 cost time: 6.6832969188690186
Epoch: 39, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.331 Vali Acc: 0.597 Test Loss: 1.331 Test Acc: 0.597
Validation loss decreased (-0.593320 --> -0.596653).  Saving model ...
Epoch: 40 cost time: 5.871031999588013
Epoch: 40, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.320 Vali Acc: 0.603 Test Loss: 1.320 Test Acc: 0.603
Validation loss decreased (-0.596653 --> -0.603320).  Saving model ...
Epoch: 41 cost time: 6.539180040359497
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.319 Vali Acc: 0.610 Test Loss: 1.319 Test Acc: 0.610
Validation loss decreased (-0.603320 --> -0.609987).  Saving model ...
Epoch: 42 cost time: 6.318766117095947
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.310 Vali Acc: 0.617 Test Loss: 1.310 Test Acc: 0.617
Validation loss decreased (-0.609987 --> -0.616654).  Saving model ...
Epoch: 43 cost time: 6.020803689956665
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.306 Vali Acc: 0.613 Test Loss: 1.306 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.020262956619263
Epoch: 44, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.305 Vali Acc: 0.620 Test Loss: 1.305 Test Acc: 0.620
Validation loss decreased (-0.616654 --> -0.619987).  Saving model ...
Epoch: 45 cost time: 5.971661567687988
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.305 Vali Acc: 0.610 Test Loss: 1.305 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.031775951385498
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.309 Vali Acc: 0.620 Test Loss: 1.309 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 6.737106800079346
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.307 Vali Acc: 0.617 Test Loss: 1.307 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 6.499565362930298
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.299 Vali Acc: 0.623 Test Loss: 1.299 Test Acc: 0.623
Validation loss decreased (-0.619987 --> -0.623320).  Saving model ...
Epoch: 49 cost time: 6.472688674926758
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.296 Vali Acc: 0.613 Test Loss: 1.296 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 7.272212028503418
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.293 Vali Acc: 0.613 Test Loss: 1.293 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 6.002538442611694
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.293 Vali Acc: 0.620 Test Loss: 1.293 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 6.694943428039551
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.291 Vali Acc: 0.617 Test Loss: 1.291 Test Acc: 0.617
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 6.749872446060181
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.285 Vali Acc: 0.620 Test Loss: 1.285 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 6.164125442504883
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.281 Vali Acc: 0.617 Test Loss: 1.281 Test Acc: 0.617
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 6.553496837615967
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.277 Vali Acc: 0.613 Test Loss: 1.277 Test Acc: 0.613
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 6.558021783828735
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.275 Vali Acc: 0.613 Test Loss: 1.275 Test Acc: 0.613
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 6.367846488952637
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.272 Vali Acc: 0.620 Test Loss: 1.272 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 6.634858131408691
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.276 Vali Acc: 0.617 Test Loss: 1.276 Test Acc: 0.617
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6233333333333333
model parameter : 207769
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.640812873840332
Epoch: 1, Steps: 18 | Train Loss: 3.295 Vali Loss: 3.245 Vali Acc: 0.043 Test Loss: 3.245 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 6.20616602897644
Epoch: 2, Steps: 18 | Train Loss: 3.131 Vali Loss: 3.157 Vali Acc: 0.060 Test Loss: 3.157 Test Acc: 0.060
Validation loss decreased (-0.043301 --> -0.059968).  Saving model ...
Epoch: 3 cost time: 5.8153235912323
Epoch: 3, Steps: 18 | Train Loss: 2.945 Vali Loss: 3.070 Vali Acc: 0.107 Test Loss: 3.070 Test Acc: 0.107
Validation loss decreased (-0.059968 --> -0.106636).  Saving model ...
Epoch: 4 cost time: 6.34581184387207
Epoch: 4, Steps: 18 | Train Loss: 2.656 Vali Loss: 2.966 Vali Acc: 0.197 Test Loss: 2.966 Test Acc: 0.197
Validation loss decreased (-0.106636 --> -0.196637).  Saving model ...
Epoch: 5 cost time: 6.647683143615723
Epoch: 5, Steps: 18 | Train Loss: 2.363 Vali Loss: 2.859 Vali Acc: 0.207 Test Loss: 2.859 Test Acc: 0.207
Validation loss decreased (-0.196637 --> -0.206638).  Saving model ...
Epoch: 6 cost time: 6.453149795532227
Epoch: 6, Steps: 18 | Train Loss: 2.008 Vali Loss: 2.753 Vali Acc: 0.253 Test Loss: 2.753 Test Acc: 0.253
Validation loss decreased (-0.206638 --> -0.253306).  Saving model ...
Epoch: 7 cost time: 6.448613405227661
Epoch: 7, Steps: 18 | Train Loss: 1.598 Vali Loss: 2.641 Vali Acc: 0.270 Test Loss: 2.641 Test Acc: 0.270
Validation loss decreased (-0.253306 --> -0.269974).  Saving model ...
Epoch: 8 cost time: 6.6549646854400635
Epoch: 8, Steps: 18 | Train Loss: 1.260 Vali Loss: 2.557 Vali Acc: 0.267 Test Loss: 2.557 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.022013187408447
Epoch: 9, Steps: 18 | Train Loss: 0.972 Vali Loss: 2.471 Vali Acc: 0.283 Test Loss: 2.471 Test Acc: 0.283
Validation loss decreased (-0.269974 --> -0.283309).  Saving model ...
Epoch: 10 cost time: 5.807420015335083
Epoch: 10, Steps: 18 | Train Loss: 0.676 Vali Loss: 2.403 Vali Acc: 0.313 Test Loss: 2.403 Test Acc: 0.313
Validation loss decreased (-0.283309 --> -0.313309).  Saving model ...
Epoch: 11 cost time: 5.846623420715332
Epoch: 11, Steps: 18 | Train Loss: 0.454 Vali Loss: 2.324 Vali Acc: 0.323 Test Loss: 2.324 Test Acc: 0.323
Validation loss decreased (-0.313309 --> -0.323310).  Saving model ...
Epoch: 12 cost time: 5.9765942096710205
Epoch: 12, Steps: 18 | Train Loss: 0.296 Vali Loss: 2.261 Vali Acc: 0.313 Test Loss: 2.261 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.165269613265991
Epoch: 13, Steps: 18 | Train Loss: 0.194 Vali Loss: 2.200 Vali Acc: 0.367 Test Loss: 2.200 Test Acc: 0.367
Validation loss decreased (-0.323310 --> -0.366645).  Saving model ...
Epoch: 14 cost time: 6.044912099838257
Epoch: 14, Steps: 18 | Train Loss: 0.122 Vali Loss: 2.151 Vali Acc: 0.367 Test Loss: 2.151 Test Acc: 0.367
Validation loss decreased (-0.366645 --> -0.366645).  Saving model ...
Epoch: 15 cost time: 6.427362442016602
Epoch: 15, Steps: 18 | Train Loss: 0.095 Vali Loss: 2.105 Vali Acc: 0.377 Test Loss: 2.105 Test Acc: 0.377
Validation loss decreased (-0.366645 --> -0.376646).  Saving model ...
Epoch: 16 cost time: 6.278765916824341
Epoch: 16, Steps: 18 | Train Loss: 0.069 Vali Loss: 2.060 Vali Acc: 0.380 Test Loss: 2.060 Test Acc: 0.380
Validation loss decreased (-0.376646 --> -0.379979).  Saving model ...
Epoch: 17 cost time: 6.576965808868408
Epoch: 17, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.032 Vali Acc: 0.393 Test Loss: 2.032 Test Acc: 0.393
Validation loss decreased (-0.379979 --> -0.393313).  Saving model ...
Epoch: 18 cost time: 5.632483243942261
Epoch: 18, Steps: 18 | Train Loss: 0.048 Vali Loss: 2.008 Vali Acc: 0.427 Test Loss: 2.008 Test Acc: 0.427
Validation loss decreased (-0.393313 --> -0.426647).  Saving model ...
Epoch: 19 cost time: 5.791092157363892
Epoch: 19, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.980 Vali Acc: 0.413 Test Loss: 1.980 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.612843751907349
Epoch: 20, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.970 Vali Acc: 0.420 Test Loss: 1.970 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.045663356781006
Epoch: 21, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.932 Vali Acc: 0.437 Test Loss: 1.932 Test Acc: 0.437
Validation loss decreased (-0.426647 --> -0.436647).  Saving model ...
Epoch: 22 cost time: 6.4490978717803955
Epoch: 22, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.905 Vali Acc: 0.430 Test Loss: 1.905 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.182487726211548
Epoch: 23, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.890 Vali Acc: 0.427 Test Loss: 1.890 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.507551908493042
Epoch: 24, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.871 Vali Acc: 0.427 Test Loss: 1.871 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.241862773895264
Epoch: 25, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.855 Vali Acc: 0.447 Test Loss: 1.855 Test Acc: 0.447
Validation loss decreased (-0.436647 --> -0.446648).  Saving model ...
Epoch: 26 cost time: 6.5054850578308105
Epoch: 26, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.836 Vali Acc: 0.450 Test Loss: 1.836 Test Acc: 0.450
Validation loss decreased (-0.446648 --> -0.449982).  Saving model ...
Epoch: 27 cost time: 6.0982232093811035
Epoch: 27, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.830 Vali Acc: 0.467 Test Loss: 1.830 Test Acc: 0.467
Validation loss decreased (-0.449982 --> -0.466648).  Saving model ...
Epoch: 28 cost time: 6.50366997718811
Epoch: 28, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.814 Vali Acc: 0.460 Test Loss: 1.814 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.16561222076416
Epoch: 29, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.801 Vali Acc: 0.470 Test Loss: 1.801 Test Acc: 0.470
Validation loss decreased (-0.466648 --> -0.469982).  Saving model ...
Epoch: 30 cost time: 5.966672897338867
Epoch: 30, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.790 Vali Acc: 0.473 Test Loss: 1.790 Test Acc: 0.473
Validation loss decreased (-0.469982 --> -0.473315).  Saving model ...
Epoch: 31 cost time: 6.419284105300903
Epoch: 31, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.782 Vali Acc: 0.473 Test Loss: 1.782 Test Acc: 0.473
Validation loss decreased (-0.473315 --> -0.473316).  Saving model ...
Epoch: 32 cost time: 6.282071352005005
Epoch: 32, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.767 Vali Acc: 0.480 Test Loss: 1.767 Test Acc: 0.480
Validation loss decreased (-0.473316 --> -0.479982).  Saving model ...
Epoch: 33 cost time: 5.760734796524048
Epoch: 33, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.761 Vali Acc: 0.487 Test Loss: 1.761 Test Acc: 0.487
Validation loss decreased (-0.479982 --> -0.486649).  Saving model ...
Epoch: 34 cost time: 6.138913631439209
Epoch: 34, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.751 Vali Acc: 0.483 Test Loss: 1.751 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.709068298339844
Epoch: 35, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.747 Vali Acc: 0.487 Test Loss: 1.747 Test Acc: 0.487
Validation loss decreased (-0.486649 --> -0.486649).  Saving model ...
Epoch: 36 cost time: 6.206871032714844
Epoch: 36, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.740 Vali Acc: 0.490 Test Loss: 1.740 Test Acc: 0.490
Validation loss decreased (-0.486649 --> -0.489983).  Saving model ...
Epoch: 37 cost time: 6.1059410572052
Epoch: 37, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.737 Vali Acc: 0.497 Test Loss: 1.737 Test Acc: 0.497
Validation loss decreased (-0.489983 --> -0.496649).  Saving model ...
Epoch: 38 cost time: 5.988187551498413
Epoch: 38, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.732 Vali Acc: 0.490 Test Loss: 1.732 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.150832176208496
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.726 Vali Acc: 0.500 Test Loss: 1.726 Test Acc: 0.500
Validation loss decreased (-0.496649 --> -0.499983).  Saving model ...
Epoch: 40 cost time: 6.602672338485718
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.712 Vali Acc: 0.493 Test Loss: 1.712 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.313986301422119
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.707 Vali Acc: 0.503 Test Loss: 1.707 Test Acc: 0.503
Validation loss decreased (-0.499983 --> -0.503316).  Saving model ...
Epoch: 42 cost time: 6.04687237739563
Epoch: 42, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.702 Vali Acc: 0.500 Test Loss: 1.702 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.960573673248291
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.701 Vali Acc: 0.490 Test Loss: 1.701 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 6.093181610107422
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.701 Vali Acc: 0.490 Test Loss: 1.701 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 6.182196855545044
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.692 Vali Acc: 0.507 Test Loss: 1.692 Test Acc: 0.507
Validation loss decreased (-0.503316 --> -0.506650).  Saving model ...
Epoch: 46 cost time: 6.137308597564697
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.690 Vali Acc: 0.500 Test Loss: 1.690 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.05756139755249
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.689 Vali Acc: 0.510 Test Loss: 1.689 Test Acc: 0.510
Validation loss decreased (-0.506650 --> -0.509983).  Saving model ...
Epoch: 48 cost time: 6.307942867279053
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.680 Vali Acc: 0.507 Test Loss: 1.680 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.783286809921265
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.671 Vali Acc: 0.513 Test Loss: 1.671 Test Acc: 0.513
Validation loss decreased (-0.509983 --> -0.513317).  Saving model ...
Epoch: 50 cost time: 6.706610202789307
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.666 Vali Acc: 0.510 Test Loss: 1.666 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 6.425224781036377
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.663 Vali Acc: 0.520 Test Loss: 1.663 Test Acc: 0.520
Validation loss decreased (-0.513317 --> -0.519983).  Saving model ...
Epoch: 52 cost time: 6.580790758132935
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.662 Vali Acc: 0.517 Test Loss: 1.662 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 6.303225517272949
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.656 Vali Acc: 0.517 Test Loss: 1.656 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 5.996687650680542
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.649 Vali Acc: 0.523 Test Loss: 1.649 Test Acc: 0.523
Validation loss decreased (-0.519983 --> -0.523317).  Saving model ...
Epoch: 55 cost time: 5.711955785751343
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.642 Vali Acc: 0.523 Test Loss: 1.642 Test Acc: 0.523
Validation loss decreased (-0.523317 --> -0.523317).  Saving model ...
Epoch: 56 cost time: 5.575563192367554
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.639 Vali Acc: 0.523 Test Loss: 1.639 Test Acc: 0.523
Validation loss decreased (-0.523317 --> -0.523317).  Saving model ...
Epoch: 57 cost time: 6.232785940170288
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.636 Vali Acc: 0.520 Test Loss: 1.636 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.856301546096802
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.633 Vali Acc: 0.520 Test Loss: 1.633 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 6.2573792934417725
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.628 Vali Acc: 0.527 Test Loss: 1.628 Test Acc: 0.527
Validation loss decreased (-0.523317 --> -0.526650).  Saving model ...
Epoch: 60 cost time: 6.2772088050842285
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.626 Vali Acc: 0.527 Test Loss: 1.626 Test Acc: 0.527
Validation loss decreased (-0.526650 --> -0.526650).  Saving model ...
Epoch: 61 cost time: 6.477158308029175
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.624 Vali Acc: 0.533 Test Loss: 1.624 Test Acc: 0.533
Validation loss decreased (-0.526650 --> -0.533317).  Saving model ...
Epoch: 62 cost time: 6.275112628936768
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.622 Vali Acc: 0.543 Test Loss: 1.622 Test Acc: 0.543
Validation loss decreased (-0.533317 --> -0.543317).  Saving model ...
Epoch: 63 cost time: 6.144667387008667
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.616 Vali Acc: 0.533 Test Loss: 1.616 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 6.016948699951172
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.612 Vali Acc: 0.537 Test Loss: 1.612 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 5.886688709259033
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.608 Vali Acc: 0.540 Test Loss: 1.608 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 6.351358413696289
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.543 Test Loss: 1.606 Test Acc: 0.543
Validation loss decreased (-0.543317 --> -0.543317).  Saving model ...
Epoch: 67 cost time: 6.263743877410889
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.605 Vali Acc: 0.540 Test Loss: 1.605 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 6.504162311553955
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.540 Test Loss: 1.601 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 6.135097980499268
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.540 Test Loss: 1.600 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 6.214096307754517
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.598 Vali Acc: 0.547 Test Loss: 1.598 Test Acc: 0.547
Validation loss decreased (-0.543317 --> -0.546651).  Saving model ...
Epoch: 71 cost time: 6.114941358566284
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.597 Vali Acc: 0.547 Test Loss: 1.597 Test Acc: 0.547
Validation loss decreased (-0.546651 --> -0.546651).  Saving model ...
Epoch: 72 cost time: 6.1247406005859375
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.596 Vali Acc: 0.540 Test Loss: 1.596 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 6.4169604778289795
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.598 Vali Acc: 0.550 Test Loss: 1.598 Test Acc: 0.550
Validation loss decreased (-0.546651 --> -0.549984).  Saving model ...
Epoch: 74 cost time: 6.609341859817505
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.592 Vali Acc: 0.550 Test Loss: 1.592 Test Acc: 0.550
Validation loss decreased (-0.549984 --> -0.549984).  Saving model ...
Epoch: 75 cost time: 6.631334066390991
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.589 Vali Acc: 0.570 Test Loss: 1.589 Test Acc: 0.570
Validation loss decreased (-0.549984 --> -0.569984).  Saving model ...
Epoch: 76 cost time: 6.552875995635986
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.587 Vali Acc: 0.563 Test Loss: 1.587 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 6.911197662353516
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.580 Vali Acc: 0.567 Test Loss: 1.580 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 6.910558700561523
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.579 Vali Acc: 0.570 Test Loss: 1.579 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 79 cost time: 5.846708536148071
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.579 Vali Acc: 0.570 Test Loss: 1.579 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569984).  Saving model ...
Epoch: 80 cost time: 5.979785919189453
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.573 Test Loss: 1.576 Test Acc: 0.573
Validation loss decreased (-0.569984 --> -0.573318).  Saving model ...
Epoch: 81 cost time: 5.955440998077393
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.567 Test Loss: 1.576 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 5.900571823120117
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.570 Test Loss: 1.576 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 6.134037256240845
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.575 Vali Acc: 0.567 Test Loss: 1.575 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 6.483452558517456
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.574 Vali Acc: 0.567 Test Loss: 1.574 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 6.76397180557251
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.569 Vali Acc: 0.567 Test Loss: 1.569 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 6.8519182205200195
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.567 Vali Acc: 0.567 Test Loss: 1.567 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 6.298273086547852
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.570 Test Loss: 1.566 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 5.683075666427612
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.563 Vali Acc: 0.570 Test Loss: 1.563 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 5.592641115188599
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.558 Vali Acc: 0.577 Test Loss: 1.558 Test Acc: 0.577
Validation loss decreased (-0.573318 --> -0.576651).  Saving model ...
Epoch: 90 cost time: 5.770364046096802
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.556 Vali Acc: 0.583 Test Loss: 1.556 Test Acc: 0.583
Validation loss decreased (-0.576651 --> -0.583318).  Saving model ...
Epoch: 91 cost time: 5.994189500808716
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.557 Vali Acc: 0.587 Test Loss: 1.557 Test Acc: 0.587
Validation loss decreased (-0.583318 --> -0.586651).  Saving model ...
Epoch: 92 cost time: 6.312009811401367
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.556 Vali Acc: 0.590 Test Loss: 1.556 Test Acc: 0.590
Validation loss decreased (-0.586651 --> -0.589984).  Saving model ...
Epoch: 93 cost time: 6.517944574356079
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.593 Test Loss: 1.551 Test Acc: 0.593
Validation loss decreased (-0.589984 --> -0.593318).  Saving model ...
Epoch: 94 cost time: 6.66636848449707
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.593 Test Loss: 1.551 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 95 cost time: 6.469306707382202
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.553 Vali Acc: 0.590 Test Loss: 1.553 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 6.236528158187866
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.552 Vali Acc: 0.587 Test Loss: 1.552 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 5.997668266296387
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.550 Vali Acc: 0.593 Test Loss: 1.550 Test Acc: 0.593
Validation loss decreased (-0.593318 --> -0.593318).  Saving model ...
Epoch: 98 cost time: 5.930494546890259
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.587 Test Loss: 1.547 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 5.8279736042022705
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.545 Vali Acc: 0.587 Test Loss: 1.545 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 5.789709091186523
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.548 Vali Acc: 0.590 Test Loss: 1.548 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5933333333333334
model parameter : 207769
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.894062042236328
Epoch: 1, Steps: 18 | Train Loss: 3.306 Vali Loss: 3.272 Vali Acc: 0.043 Test Loss: 3.272 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 6.041375160217285
Epoch: 2, Steps: 18 | Train Loss: 3.202 Vali Loss: 3.222 Vali Acc: 0.047 Test Loss: 3.222 Test Acc: 0.047
Validation loss decreased (-0.043301 --> -0.046634).  Saving model ...
Epoch: 3 cost time: 6.224930286407471
Epoch: 3, Steps: 18 | Train Loss: 2.977 Vali Loss: 3.165 Vali Acc: 0.070 Test Loss: 3.165 Test Acc: 0.070
Validation loss decreased (-0.046634 --> -0.069968).  Saving model ...
Epoch: 4 cost time: 6.218569278717041
Epoch: 4, Steps: 18 | Train Loss: 2.684 Vali Loss: 3.100 Vali Acc: 0.083 Test Loss: 3.100 Test Acc: 0.083
Validation loss decreased (-0.069968 --> -0.083302).  Saving model ...
Epoch: 5 cost time: 6.030003547668457
Epoch: 5, Steps: 18 | Train Loss: 2.451 Vali Loss: 3.037 Vali Acc: 0.103 Test Loss: 3.037 Test Acc: 0.103
Validation loss decreased (-0.083302 --> -0.103303).  Saving model ...
Epoch: 6 cost time: 6.023295879364014
Epoch: 6, Steps: 18 | Train Loss: 2.132 Vali Loss: 2.969 Vali Acc: 0.123 Test Loss: 2.969 Test Acc: 0.123
Validation loss decreased (-0.103303 --> -0.123304).  Saving model ...
Epoch: 7 cost time: 6.2359771728515625
Epoch: 7, Steps: 18 | Train Loss: 1.768 Vali Loss: 2.899 Vali Acc: 0.147 Test Loss: 2.899 Test Acc: 0.147
Validation loss decreased (-0.123304 --> -0.146638).  Saving model ...
Epoch: 8 cost time: 6.089892148971558
Epoch: 8, Steps: 18 | Train Loss: 1.434 Vali Loss: 2.845 Vali Acc: 0.140 Test Loss: 2.845 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.755668878555298
Epoch: 9, Steps: 18 | Train Loss: 1.165 Vali Loss: 2.790 Vali Acc: 0.150 Test Loss: 2.790 Test Acc: 0.150
Validation loss decreased (-0.146638 --> -0.149972).  Saving model ...
Epoch: 10 cost time: 6.00467848777771
Epoch: 10, Steps: 18 | Train Loss: 0.840 Vali Loss: 2.726 Vali Acc: 0.180 Test Loss: 2.726 Test Acc: 0.180
Validation loss decreased (-0.149972 --> -0.179973).  Saving model ...
Epoch: 11 cost time: 6.334347248077393
Epoch: 11, Steps: 18 | Train Loss: 0.646 Vali Loss: 2.678 Vali Acc: 0.177 Test Loss: 2.678 Test Acc: 0.177
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.462827920913696
Epoch: 12, Steps: 18 | Train Loss: 0.428 Vali Loss: 2.616 Vali Acc: 0.200 Test Loss: 2.616 Test Acc: 0.200
Validation loss decreased (-0.179973 --> -0.199974).  Saving model ...
Epoch: 13 cost time: 6.172577857971191
Epoch: 13, Steps: 18 | Train Loss: 0.301 Vali Loss: 2.567 Vali Acc: 0.197 Test Loss: 2.567 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.071090936660767
Epoch: 14, Steps: 18 | Train Loss: 0.196 Vali Loss: 2.511 Vali Acc: 0.217 Test Loss: 2.511 Test Acc: 0.217
Validation loss decreased (-0.199974 --> -0.216642).  Saving model ...
Epoch: 15 cost time: 6.181393146514893
Epoch: 15, Steps: 18 | Train Loss: 0.132 Vali Loss: 2.430 Vali Acc: 0.250 Test Loss: 2.430 Test Acc: 0.250
Validation loss decreased (-0.216642 --> -0.249976).  Saving model ...
Epoch: 16 cost time: 6.285830020904541
Epoch: 16, Steps: 18 | Train Loss: 0.097 Vali Loss: 2.387 Vali Acc: 0.253 Test Loss: 2.387 Test Acc: 0.253
Validation loss decreased (-0.249976 --> -0.253309).  Saving model ...
Epoch: 17 cost time: 6.683424711227417
Epoch: 17, Steps: 18 | Train Loss: 0.086 Vali Loss: 2.351 Vali Acc: 0.260 Test Loss: 2.351 Test Acc: 0.260
Validation loss decreased (-0.253309 --> -0.259976).  Saving model ...
Epoch: 18 cost time: 6.473952054977417
Epoch: 18, Steps: 18 | Train Loss: 0.066 Vali Loss: 2.308 Vali Acc: 0.293 Test Loss: 2.308 Test Acc: 0.293
Validation loss decreased (-0.259976 --> -0.293310).  Saving model ...
Epoch: 19 cost time: 6.568171501159668
Epoch: 19, Steps: 18 | Train Loss: 0.051 Vali Loss: 2.255 Vali Acc: 0.310 Test Loss: 2.255 Test Acc: 0.310
Validation loss decreased (-0.293310 --> -0.309977).  Saving model ...
Epoch: 20 cost time: 6.480661630630493
Epoch: 20, Steps: 18 | Train Loss: 0.045 Vali Loss: 2.245 Vali Acc: 0.313 Test Loss: 2.245 Test Acc: 0.313
Validation loss decreased (-0.309977 --> -0.313311).  Saving model ...
Epoch: 21 cost time: 6.34757661819458
Epoch: 21, Steps: 18 | Train Loss: 0.037 Vali Loss: 2.182 Vali Acc: 0.317 Test Loss: 2.182 Test Acc: 0.317
Validation loss decreased (-0.313311 --> -0.316645).  Saving model ...
Epoch: 22 cost time: 5.554192304611206
Epoch: 22, Steps: 18 | Train Loss: 0.031 Vali Loss: 2.155 Vali Acc: 0.347 Test Loss: 2.155 Test Acc: 0.347
Validation loss decreased (-0.316645 --> -0.346645).  Saving model ...
Epoch: 23 cost time: 5.777108907699585
Epoch: 23, Steps: 18 | Train Loss: 0.028 Vali Loss: 2.168 Vali Acc: 0.333 Test Loss: 2.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.920148134231567
Epoch: 24, Steps: 18 | Train Loss: 0.024 Vali Loss: 2.153 Vali Acc: 0.357 Test Loss: 2.153 Test Acc: 0.357
Validation loss decreased (-0.346645 --> -0.356645).  Saving model ...
Epoch: 25 cost time: 6.520668983459473
Epoch: 25, Steps: 18 | Train Loss: 0.023 Vali Loss: 2.106 Vali Acc: 0.373 Test Loss: 2.106 Test Acc: 0.373
Validation loss decreased (-0.356645 --> -0.373312).  Saving model ...
Epoch: 26 cost time: 6.246925592422485
Epoch: 26, Steps: 18 | Train Loss: 0.018 Vali Loss: 2.077 Vali Acc: 0.373 Test Loss: 2.077 Test Acc: 0.373
Validation loss decreased (-0.373312 --> -0.373313).  Saving model ...
Epoch: 27 cost time: 6.2510085105896
Epoch: 27, Steps: 18 | Train Loss: 0.016 Vali Loss: 2.060 Vali Acc: 0.390 Test Loss: 2.060 Test Acc: 0.390
Validation loss decreased (-0.373313 --> -0.389979).  Saving model ...
Epoch: 28 cost time: 6.2481303215026855
Epoch: 28, Steps: 18 | Train Loss: 0.016 Vali Loss: 2.050 Vali Acc: 0.377 Test Loss: 2.050 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.7854602336883545
Epoch: 29, Steps: 18 | Train Loss: 0.014 Vali Loss: 2.047 Vali Acc: 0.383 Test Loss: 2.047 Test Acc: 0.383
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.194555282592773
Epoch: 30, Steps: 18 | Train Loss: 0.013 Vali Loss: 2.040 Vali Acc: 0.393 Test Loss: 2.040 Test Acc: 0.393
Validation loss decreased (-0.389979 --> -0.393313).  Saving model ...
Epoch: 31 cost time: 6.223181962966919
Epoch: 31, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.025 Vali Acc: 0.397 Test Loss: 2.025 Test Acc: 0.397
Validation loss decreased (-0.393313 --> -0.396646).  Saving model ...
Epoch: 32 cost time: 5.740845203399658
Epoch: 32, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.017 Vali Acc: 0.400 Test Loss: 2.017 Test Acc: 0.400
Validation loss decreased (-0.396646 --> -0.399980).  Saving model ...
Epoch: 33 cost time: 6.203531503677368
Epoch: 33, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.995 Vali Acc: 0.393 Test Loss: 1.995 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.811896800994873
Epoch: 34, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.975 Vali Acc: 0.400 Test Loss: 1.975 Test Acc: 0.400
Validation loss decreased (-0.399980 --> -0.399980).  Saving model ...
Epoch: 35 cost time: 5.45855188369751
Epoch: 35, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.966 Vali Acc: 0.407 Test Loss: 1.966 Test Acc: 0.407
Validation loss decreased (-0.399980 --> -0.406647).  Saving model ...
Epoch: 36 cost time: 5.80193305015564
Epoch: 36, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.954 Vali Acc: 0.413 Test Loss: 1.954 Test Acc: 0.413
Validation loss decreased (-0.406647 --> -0.413314).  Saving model ...
Epoch: 37 cost time: 5.524428844451904
Epoch: 37, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.937 Vali Acc: 0.437 Test Loss: 1.937 Test Acc: 0.437
Validation loss decreased (-0.413314 --> -0.436647).  Saving model ...
Epoch: 38 cost time: 6.388265371322632
Epoch: 38, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.939 Vali Acc: 0.437 Test Loss: 1.939 Test Acc: 0.437
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.3301613330841064
Epoch: 39, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.929 Vali Acc: 0.437 Test Loss: 1.929 Test Acc: 0.437
Validation loss decreased (-0.436647 --> -0.436647).  Saving model ...
Epoch: 40 cost time: 6.377620220184326
Epoch: 40, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.917 Vali Acc: 0.437 Test Loss: 1.917 Test Acc: 0.437
Validation loss decreased (-0.436647 --> -0.436647).  Saving model ...
Epoch: 41 cost time: 6.233242511749268
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.910 Vali Acc: 0.437 Test Loss: 1.910 Test Acc: 0.437
Validation loss decreased (-0.436647 --> -0.436648).  Saving model ...
Epoch: 42 cost time: 6.26249361038208
Epoch: 42, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.905 Vali Acc: 0.440 Test Loss: 1.905 Test Acc: 0.440
Validation loss decreased (-0.436648 --> -0.439981).  Saving model ...
Epoch: 43 cost time: 5.938302040100098
Epoch: 43, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.898 Vali Acc: 0.443 Test Loss: 1.898 Test Acc: 0.443
Validation loss decreased (-0.439981 --> -0.443314).  Saving model ...
Epoch: 44 cost time: 5.862413644790649
Epoch: 44, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.890 Vali Acc: 0.460 Test Loss: 1.890 Test Acc: 0.460
Validation loss decreased (-0.443314 --> -0.459981).  Saving model ...
Epoch: 45 cost time: 6.518842458724976
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.880 Vali Acc: 0.457 Test Loss: 1.880 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.484514474868774
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.877 Vali Acc: 0.453 Test Loss: 1.877 Test Acc: 0.453
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.887121677398682
Epoch: 47, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.871 Vali Acc: 0.460 Test Loss: 1.871 Test Acc: 0.460
Validation loss decreased (-0.459981 --> -0.459981).  Saving model ...
Epoch: 48 cost time: 6.516351938247681
Epoch: 48, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.871 Vali Acc: 0.460 Test Loss: 1.871 Test Acc: 0.460
Validation loss decreased (-0.459981 --> -0.459981).  Saving model ...
Epoch: 49 cost time: 6.43981671333313
Epoch: 49, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.869 Vali Acc: 0.467 Test Loss: 1.869 Test Acc: 0.467
Validation loss decreased (-0.459981 --> -0.466648).  Saving model ...
Epoch: 50 cost time: 6.422124147415161
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.855 Vali Acc: 0.477 Test Loss: 1.855 Test Acc: 0.477
Validation loss decreased (-0.466648 --> -0.476648).  Saving model ...
Epoch: 51 cost time: 6.540182113647461
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.839 Vali Acc: 0.477 Test Loss: 1.839 Test Acc: 0.477
Validation loss decreased (-0.476648 --> -0.476648).  Saving model ...
Epoch: 52 cost time: 6.766641139984131
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.838 Vali Acc: 0.470 Test Loss: 1.838 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 6.594594717025757
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.836 Vali Acc: 0.463 Test Loss: 1.836 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 6.954126358032227
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.828 Vali Acc: 0.473 Test Loss: 1.828 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 6.348952054977417
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.827 Vali Acc: 0.470 Test Loss: 1.827 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 6.200991153717041
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.823 Vali Acc: 0.473 Test Loss: 1.823 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 6.223079681396484
Epoch: 57, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.825 Vali Acc: 0.487 Test Loss: 1.825 Test Acc: 0.487
Validation loss decreased (-0.476648 --> -0.486648).  Saving model ...
Epoch: 58 cost time: 6.197198867797852
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.820 Vali Acc: 0.480 Test Loss: 1.820 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.844318151473999
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.806 Vali Acc: 0.487 Test Loss: 1.806 Test Acc: 0.487
Validation loss decreased (-0.486648 --> -0.486649).  Saving model ...
Epoch: 60 cost time: 6.694470643997192
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.804 Vali Acc: 0.497 Test Loss: 1.804 Test Acc: 0.497
Validation loss decreased (-0.486649 --> -0.496649).  Saving model ...
Epoch: 61 cost time: 6.294506788253784
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.801 Vali Acc: 0.493 Test Loss: 1.801 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.314897537231445
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.798 Vali Acc: 0.503 Test Loss: 1.798 Test Acc: 0.503
Validation loss decreased (-0.496649 --> -0.503315).  Saving model ...
Epoch: 63 cost time: 6.198652744293213
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.790 Vali Acc: 0.510 Test Loss: 1.790 Test Acc: 0.510
Validation loss decreased (-0.503315 --> -0.509982).  Saving model ...
Epoch: 64 cost time: 6.979413986206055
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.789 Vali Acc: 0.510 Test Loss: 1.789 Test Acc: 0.510
Validation loss decreased (-0.509982 --> -0.509982).  Saving model ...
Epoch: 65 cost time: 6.456084251403809
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.784 Vali Acc: 0.503 Test Loss: 1.784 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 6.66439962387085
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.783 Vali Acc: 0.500 Test Loss: 1.783 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 6.854385614395142
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.781 Vali Acc: 0.503 Test Loss: 1.781 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 6.335353374481201
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.777 Vali Acc: 0.503 Test Loss: 1.777 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 6.150648593902588
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.772 Vali Acc: 0.507 Test Loss: 1.772 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 7.198909044265747
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.768 Vali Acc: 0.510 Test Loss: 1.768 Test Acc: 0.510
Validation loss decreased (-0.509982 --> -0.509982).  Saving model ...
Epoch: 71 cost time: 6.851539373397827
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.762 Vali Acc: 0.513 Test Loss: 1.762 Test Acc: 0.513
Validation loss decreased (-0.509982 --> -0.513316).  Saving model ...
Epoch: 72 cost time: 6.703456401824951
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.758 Vali Acc: 0.510 Test Loss: 1.758 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 6.889702558517456
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.759 Vali Acc: 0.510 Test Loss: 1.759 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 6.351359844207764
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.757 Vali Acc: 0.520 Test Loss: 1.757 Test Acc: 0.520
Validation loss decreased (-0.513316 --> -0.519982).  Saving model ...
Epoch: 75 cost time: 6.581617593765259
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.753 Vali Acc: 0.520 Test Loss: 1.753 Test Acc: 0.520
Validation loss decreased (-0.519982 --> -0.519982).  Saving model ...
Epoch: 76 cost time: 6.410150766372681
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.755 Vali Acc: 0.517 Test Loss: 1.755 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 6.452026844024658
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.748 Vali Acc: 0.510 Test Loss: 1.748 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 6.590631008148193
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.740 Vali Acc: 0.520 Test Loss: 1.740 Test Acc: 0.520
Validation loss decreased (-0.519982 --> -0.519983).  Saving model ...
Epoch: 79 cost time: 6.7310638427734375
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.739 Vali Acc: 0.520 Test Loss: 1.739 Test Acc: 0.520
Validation loss decreased (-0.519983 --> -0.519983).  Saving model ...
Epoch: 80 cost time: 5.892047882080078
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.743 Vali Acc: 0.517 Test Loss: 1.743 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 6.7169189453125
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.739 Vali Acc: 0.517 Test Loss: 1.739 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 6.2626402378082275
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.733 Vali Acc: 0.523 Test Loss: 1.733 Test Acc: 0.523
Validation loss decreased (-0.519983 --> -0.523316).  Saving model ...
Epoch: 83 cost time: 6.653126239776611
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.731 Vali Acc: 0.527 Test Loss: 1.731 Test Acc: 0.527
Validation loss decreased (-0.523316 --> -0.526649).  Saving model ...
Epoch: 84 cost time: 6.977720737457275
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.729 Vali Acc: 0.527 Test Loss: 1.729 Test Acc: 0.527
Validation loss decreased (-0.526649 --> -0.526649).  Saving model ...
Epoch: 85 cost time: 6.7665605545043945
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.527 Test Loss: 1.719 Test Acc: 0.527
Validation loss decreased (-0.526649 --> -0.526649).  Saving model ...
Epoch: 86 cost time: 6.837262392044067
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.533 Test Loss: 1.719 Test Acc: 0.533
Validation loss decreased (-0.526649 --> -0.533316).  Saving model ...
Epoch: 87 cost time: 6.04443621635437
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.543 Test Loss: 1.719 Test Acc: 0.543
Validation loss decreased (-0.533316 --> -0.543316).  Saving model ...
Epoch: 88 cost time: 6.329082250595093
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.533 Test Loss: 1.723 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 5.972898721694946
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.720 Vali Acc: 0.530 Test Loss: 1.720 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 6.639151573181152
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.717 Vali Acc: 0.527 Test Loss: 1.717 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 6.777997970581055
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.715 Vali Acc: 0.533 Test Loss: 1.715 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 5.799411296844482
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.711 Vali Acc: 0.533 Test Loss: 1.711 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 6.337306976318359
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.705 Vali Acc: 0.537 Test Loss: 1.705 Test Acc: 0.537
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 6.513494491577148
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.702 Vali Acc: 0.537 Test Loss: 1.702 Test Acc: 0.537
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 6.418233871459961
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.701 Vali Acc: 0.537 Test Loss: 1.701 Test Acc: 0.537
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 6.812002182006836
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.701 Vali Acc: 0.540 Test Loss: 1.701 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 6.595102310180664
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.700 Vali Acc: 0.543 Test Loss: 1.700 Test Acc: 0.543
Validation loss decreased (-0.543316 --> -0.543316).  Saving model ...
Epoch: 98 cost time: 6.876877784729004
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.533 Test Loss: 1.698 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 6.812152624130249
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.695 Vali Acc: 0.543 Test Loss: 1.695 Test Acc: 0.543
Validation loss decreased (-0.543316 --> -0.543316).  Saving model ...
Epoch: 100 cost time: 6.256751298904419
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.693 Vali Acc: 0.553 Test Loss: 1.693 Test Acc: 0.553
Validation loss decreased (-0.543316 --> -0.553316).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5533333333333333
model parameter : 207769
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.408083438873291
Epoch: 1, Steps: 18 | Train Loss: 3.341 Vali Loss: 3.277 Vali Acc: 0.043 Test Loss: 3.277 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 6.796599864959717
Epoch: 2, Steps: 18 | Train Loss: 3.202 Vali Loss: 3.228 Vali Acc: 0.063 Test Loss: 3.228 Test Acc: 0.063
Validation loss decreased (-0.043301 --> -0.063301).  Saving model ...
Epoch: 3 cost time: 6.142919063568115
Epoch: 3, Steps: 18 | Train Loss: 3.062 Vali Loss: 3.173 Vali Acc: 0.063 Test Loss: 3.173 Test Acc: 0.063
Validation loss decreased (-0.063301 --> -0.063302).  Saving model ...
Epoch: 4 cost time: 6.026906251907349
Epoch: 4, Steps: 18 | Train Loss: 2.795 Vali Loss: 3.113 Vali Acc: 0.073 Test Loss: 3.113 Test Acc: 0.073
Validation loss decreased (-0.063302 --> -0.073302).  Saving model ...
Epoch: 5 cost time: 6.323291778564453
Epoch: 5, Steps: 18 | Train Loss: 2.626 Vali Loss: 3.055 Vali Acc: 0.097 Test Loss: 3.055 Test Acc: 0.097
Validation loss decreased (-0.073302 --> -0.096636).  Saving model ...
Epoch: 6 cost time: 6.418232440948486
Epoch: 6, Steps: 18 | Train Loss: 2.342 Vali Loss: 2.997 Vali Acc: 0.097 Test Loss: 2.997 Test Acc: 0.097
Validation loss decreased (-0.096636 --> -0.096637).  Saving model ...
Epoch: 7 cost time: 6.326736688613892
Epoch: 7, Steps: 18 | Train Loss: 2.044 Vali Loss: 2.934 Vali Acc: 0.130 Test Loss: 2.934 Test Acc: 0.130
Validation loss decreased (-0.096637 --> -0.129971).  Saving model ...
Epoch: 8 cost time: 6.496248960494995
Epoch: 8, Steps: 18 | Train Loss: 1.730 Vali Loss: 2.880 Vali Acc: 0.117 Test Loss: 2.880 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.941204309463501
Epoch: 9, Steps: 18 | Train Loss: 1.474 Vali Loss: 2.838 Vali Acc: 0.137 Test Loss: 2.838 Test Acc: 0.137
Validation loss decreased (-0.129971 --> -0.136638).  Saving model ...
Epoch: 10 cost time: 6.281001806259155
Epoch: 10, Steps: 18 | Train Loss: 1.181 Vali Loss: 2.783 Vali Acc: 0.177 Test Loss: 2.783 Test Acc: 0.177
Validation loss decreased (-0.136638 --> -0.176639).  Saving model ...
Epoch: 11 cost time: 5.556865930557251
Epoch: 11, Steps: 18 | Train Loss: 0.939 Vali Loss: 2.725 Vali Acc: 0.170 Test Loss: 2.725 Test Acc: 0.170
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.332443475723267
Epoch: 12, Steps: 18 | Train Loss: 0.716 Vali Loss: 2.657 Vali Acc: 0.197 Test Loss: 2.657 Test Acc: 0.197
Validation loss decreased (-0.176639 --> -0.196640).  Saving model ...
Epoch: 13 cost time: 6.841516494750977
Epoch: 13, Steps: 18 | Train Loss: 0.562 Vali Loss: 2.611 Vali Acc: 0.217 Test Loss: 2.611 Test Acc: 0.217
Validation loss decreased (-0.196640 --> -0.216641).  Saving model ...
Epoch: 14 cost time: 6.111656665802002
Epoch: 14, Steps: 18 | Train Loss: 0.366 Vali Loss: 2.512 Vali Acc: 0.220 Test Loss: 2.512 Test Acc: 0.220
Validation loss decreased (-0.216641 --> -0.219975).  Saving model ...
Epoch: 15 cost time: 6.349015235900879
Epoch: 15, Steps: 18 | Train Loss: 0.269 Vali Loss: 2.437 Vali Acc: 0.280 Test Loss: 2.437 Test Acc: 0.280
Validation loss decreased (-0.219975 --> -0.279976).  Saving model ...
Epoch: 16 cost time: 6.745723485946655
Epoch: 16, Steps: 18 | Train Loss: 0.179 Vali Loss: 2.364 Vali Acc: 0.290 Test Loss: 2.364 Test Acc: 0.290
Validation loss decreased (-0.279976 --> -0.289976).  Saving model ...
Epoch: 17 cost time: 6.594352960586548
Epoch: 17, Steps: 18 | Train Loss: 0.157 Vali Loss: 2.288 Vali Acc: 0.300 Test Loss: 2.288 Test Acc: 0.300
Validation loss decreased (-0.289976 --> -0.299977).  Saving model ...
Epoch: 18 cost time: 6.291569232940674
Epoch: 18, Steps: 18 | Train Loss: 0.101 Vali Loss: 2.225 Vali Acc: 0.327 Test Loss: 2.225 Test Acc: 0.327
Validation loss decreased (-0.299977 --> -0.326644).  Saving model ...
Epoch: 19 cost time: 6.343291282653809
Epoch: 19, Steps: 18 | Train Loss: 0.083 Vali Loss: 2.195 Vali Acc: 0.340 Test Loss: 2.195 Test Acc: 0.340
Validation loss decreased (-0.326644 --> -0.339978).  Saving model ...
Epoch: 20 cost time: 6.278296232223511
Epoch: 20, Steps: 18 | Train Loss: 0.071 Vali Loss: 2.137 Vali Acc: 0.343 Test Loss: 2.137 Test Acc: 0.343
Validation loss decreased (-0.339978 --> -0.343312).  Saving model ...
Epoch: 21 cost time: 6.628959894180298
Epoch: 21, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.084 Vali Acc: 0.353 Test Loss: 2.084 Test Acc: 0.353
Validation loss decreased (-0.343312 --> -0.353312).  Saving model ...
Epoch: 22 cost time: 6.521687984466553
Epoch: 22, Steps: 18 | Train Loss: 0.050 Vali Loss: 2.041 Vali Acc: 0.383 Test Loss: 2.041 Test Acc: 0.383
Validation loss decreased (-0.353312 --> -0.383313).  Saving model ...
Epoch: 23 cost time: 6.463165998458862
Epoch: 23, Steps: 18 | Train Loss: 0.039 Vali Loss: 2.041 Vali Acc: 0.377 Test Loss: 2.041 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.334386348724365
Epoch: 24, Steps: 18 | Train Loss: 0.034 Vali Loss: 2.019 Vali Acc: 0.373 Test Loss: 2.019 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.1083338260650635
Epoch: 25, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.989 Vali Acc: 0.387 Test Loss: 1.989 Test Acc: 0.387
Validation loss decreased (-0.383313 --> -0.386647).  Saving model ...
Epoch: 26 cost time: 6.288657903671265
Epoch: 26, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.968 Vali Acc: 0.400 Test Loss: 1.968 Test Acc: 0.400
Validation loss decreased (-0.386647 --> -0.399980).  Saving model ...
Epoch: 27 cost time: 6.38257360458374
Epoch: 27, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.931 Vali Acc: 0.423 Test Loss: 1.931 Test Acc: 0.423
Validation loss decreased (-0.399980 --> -0.423314).  Saving model ...
Epoch: 28 cost time: 7.188316822052002
Epoch: 28, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.962 Vali Acc: 0.420 Test Loss: 1.962 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.7853007316589355
Epoch: 29, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.946 Vali Acc: 0.413 Test Loss: 1.946 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.682942867279053
Epoch: 30, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.917 Vali Acc: 0.423 Test Loss: 1.917 Test Acc: 0.423
Validation loss decreased (-0.423314 --> -0.423314).  Saving model ...
Epoch: 31 cost time: 6.832122802734375
Epoch: 31, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.886 Vali Acc: 0.433 Test Loss: 1.886 Test Acc: 0.433
Validation loss decreased (-0.423314 --> -0.433314).  Saving model ...
Epoch: 32 cost time: 6.40720534324646
Epoch: 32, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.879 Vali Acc: 0.440 Test Loss: 1.879 Test Acc: 0.440
Validation loss decreased (-0.433314 --> -0.439981).  Saving model ...
Epoch: 33 cost time: 5.586193323135376
Epoch: 33, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.863 Vali Acc: 0.450 Test Loss: 1.863 Test Acc: 0.450
Validation loss decreased (-0.439981 --> -0.449981).  Saving model ...
Epoch: 34 cost time: 6.623743057250977
Epoch: 34, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.867 Vali Acc: 0.443 Test Loss: 1.867 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.127545118331909
Epoch: 35, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.877 Vali Acc: 0.440 Test Loss: 1.877 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 6.7272138595581055
Epoch: 36, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.844 Vali Acc: 0.440 Test Loss: 1.844 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 6.267498254776001
Epoch: 37, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.813 Vali Acc: 0.457 Test Loss: 1.813 Test Acc: 0.457
Validation loss decreased (-0.449981 --> -0.456649).  Saving model ...
Epoch: 38 cost time: 6.134445667266846
Epoch: 38, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.828 Vali Acc: 0.450 Test Loss: 1.828 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.874136686325073
Epoch: 39, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.846 Vali Acc: 0.457 Test Loss: 1.846 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.887617588043213
Epoch: 40, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.827 Vali Acc: 0.453 Test Loss: 1.827 Test Acc: 0.453
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 6.874368906021118
Epoch: 41, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.802 Vali Acc: 0.453 Test Loss: 1.802 Test Acc: 0.453
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 5.858910083770752
Epoch: 42, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.812 Vali Acc: 0.447 Test Loss: 1.812 Test Acc: 0.447
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 6.462641477584839
Epoch: 43, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.821 Vali Acc: 0.447 Test Loss: 1.821 Test Acc: 0.447
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 6.469740629196167
Epoch: 44, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.813 Vali Acc: 0.457 Test Loss: 1.813 Test Acc: 0.457
Validation loss decreased (-0.456649 --> -0.456649).  Saving model ...
Epoch: 45 cost time: 6.5520265102386475
Epoch: 45, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.795 Vali Acc: 0.470 Test Loss: 1.795 Test Acc: 0.470
Validation loss decreased (-0.456649 --> -0.469982).  Saving model ...
Epoch: 46 cost time: 6.44596266746521
Epoch: 46, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.781 Vali Acc: 0.470 Test Loss: 1.781 Test Acc: 0.470
Validation loss decreased (-0.469982 --> -0.469982).  Saving model ...
Epoch: 47 cost time: 6.768519639968872
Epoch: 47, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.774 Vali Acc: 0.463 Test Loss: 1.774 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.9453675746917725
Epoch: 48, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.792 Vali Acc: 0.473 Test Loss: 1.792 Test Acc: 0.473
Validation loss decreased (-0.469982 --> -0.473315).  Saving model ...
Epoch: 49 cost time: 6.616492033004761
Epoch: 49, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.777 Vali Acc: 0.487 Test Loss: 1.777 Test Acc: 0.487
Validation loss decreased (-0.473315 --> -0.486649).  Saving model ...
Epoch: 50 cost time: 6.906613349914551
Epoch: 50, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.759 Vali Acc: 0.490 Test Loss: 1.759 Test Acc: 0.490
Validation loss decreased (-0.486649 --> -0.489982).  Saving model ...
Epoch: 51 cost time: 7.118251085281372
Epoch: 51, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.769 Vali Acc: 0.497 Test Loss: 1.769 Test Acc: 0.497
Validation loss decreased (-0.489982 --> -0.496649).  Saving model ...
Epoch: 52 cost time: 6.499142408370972
Epoch: 52, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.773 Vali Acc: 0.493 Test Loss: 1.773 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 6.373337507247925
Epoch: 53, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.760 Vali Acc: 0.483 Test Loss: 1.760 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 7.02322793006897
Epoch: 54, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.756 Vali Acc: 0.490 Test Loss: 1.756 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 5.970704793930054
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.760 Vali Acc: 0.507 Test Loss: 1.760 Test Acc: 0.507
Validation loss decreased (-0.496649 --> -0.506649).  Saving model ...
Epoch: 56 cost time: 6.331384658813477
Epoch: 56, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.754 Vali Acc: 0.503 Test Loss: 1.754 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.083787441253662
Epoch: 57, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.750 Vali Acc: 0.507 Test Loss: 1.750 Test Acc: 0.507
Validation loss decreased (-0.506649 --> -0.506649).  Saving model ...
Epoch: 58 cost time: 6.427382469177246
Epoch: 58, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.761 Vali Acc: 0.490 Test Loss: 1.761 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.045506954193115
Epoch: 59, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.739 Vali Acc: 0.507 Test Loss: 1.739 Test Acc: 0.507
Validation loss decreased (-0.506649 --> -0.506649).  Saving model ...
Epoch: 60 cost time: 6.499567270278931
Epoch: 60, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.751 Vali Acc: 0.493 Test Loss: 1.751 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.379264831542969
Epoch: 61, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.759 Vali Acc: 0.490 Test Loss: 1.759 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 6.709253549575806
Epoch: 62, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.762 Vali Acc: 0.497 Test Loss: 1.762 Test Acc: 0.497
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 7.17792272567749
Epoch: 63, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.746 Vali Acc: 0.507 Test Loss: 1.746 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 6.827356815338135
Epoch: 64, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.745 Vali Acc: 0.507 Test Loss: 1.745 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 6.820475816726685
Epoch: 65, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.721 Vali Acc: 0.497 Test Loss: 1.721 Test Acc: 0.497
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 5.904463768005371
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.716 Vali Acc: 0.517 Test Loss: 1.716 Test Acc: 0.517
Validation loss decreased (-0.506649 --> -0.516650).  Saving model ...
Epoch: 67 cost time: 6.191704511642456
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.731 Vali Acc: 0.510 Test Loss: 1.731 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 6.500549077987671
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.738 Vali Acc: 0.513 Test Loss: 1.738 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 6.3626391887664795
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.724 Vali Acc: 0.513 Test Loss: 1.724 Test Acc: 0.513
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 6.246642112731934
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.713 Vali Acc: 0.517 Test Loss: 1.713 Test Acc: 0.517
Validation loss decreased (-0.516650 --> -0.516650).  Saving model ...
Epoch: 71 cost time: 6.294918537139893
Epoch: 71, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.708 Vali Acc: 0.523 Test Loss: 1.708 Test Acc: 0.523
Validation loss decreased (-0.516650 --> -0.523316).  Saving model ...
Epoch: 72 cost time: 6.490803480148315
Epoch: 72, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.691 Vali Acc: 0.523 Test Loss: 1.691 Test Acc: 0.523
Validation loss decreased (-0.523316 --> -0.523316).  Saving model ...
Epoch: 73 cost time: 7.7984373569488525
Epoch: 73, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.685 Vali Acc: 0.533 Test Loss: 1.685 Test Acc: 0.533
Validation loss decreased (-0.523316 --> -0.533316).  Saving model ...
Epoch: 74 cost time: 6.905082941055298
Epoch: 74, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.682 Vali Acc: 0.527 Test Loss: 1.682 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 7.004155397415161
Epoch: 75, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.694 Vali Acc: 0.520 Test Loss: 1.694 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 6.447159051895142
Epoch: 76, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.691 Vali Acc: 0.520 Test Loss: 1.691 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 6.574831008911133
Epoch: 77, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.680 Vali Acc: 0.530 Test Loss: 1.680 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 5.679143190383911
Epoch: 78, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.684 Vali Acc: 0.530 Test Loss: 1.684 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 6.749734163284302
Epoch: 79, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.696 Vali Acc: 0.530 Test Loss: 1.696 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 6.5827131271362305
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.694 Vali Acc: 0.533 Test Loss: 1.694 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 6.661277532577515
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.537 Test Loss: 1.690 Test Acc: 0.537
Validation loss decreased (-0.533316 --> -0.536650).  Saving model ...
Epoch: 82 cost time: 6.595396995544434
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.701 Vali Acc: 0.533 Test Loss: 1.701 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 6.378883361816406
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.696 Vali Acc: 0.530 Test Loss: 1.696 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 6.434381484985352
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.697 Vali Acc: 0.530 Test Loss: 1.697 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 6.404559373855591
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.530 Test Loss: 1.690 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 7.5527024269104
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.676 Vali Acc: 0.540 Test Loss: 1.676 Test Acc: 0.540
Validation loss decreased (-0.536650 --> -0.539983).  Saving model ...
Epoch: 87 cost time: 6.680435657501221
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.677 Vali Acc: 0.537 Test Loss: 1.677 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 6.568443059921265
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.672 Vali Acc: 0.540 Test Loss: 1.672 Test Acc: 0.540
Validation loss decreased (-0.539983 --> -0.539983).  Saving model ...
Epoch: 89 cost time: 5.8544981479644775
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.660 Vali Acc: 0.543 Test Loss: 1.660 Test Acc: 0.543
Validation loss decreased (-0.539983 --> -0.543317).  Saving model ...
Epoch: 90 cost time: 5.991461992263794
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.665 Vali Acc: 0.537 Test Loss: 1.665 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 6.624505519866943
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.675 Vali Acc: 0.537 Test Loss: 1.675 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 6.1094019412994385
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.683 Vali Acc: 0.540 Test Loss: 1.683 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 7.159897804260254
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.691 Vali Acc: 0.537 Test Loss: 1.691 Test Acc: 0.537
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 6.812704086303711
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.693 Vali Acc: 0.533 Test Loss: 1.693 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 6.011435508728027
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.547 Test Loss: 1.689 Test Acc: 0.547
Validation loss decreased (-0.543317 --> -0.546650).  Saving model ...
Epoch: 96 cost time: 6.284069061279297
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.547 Test Loss: 1.690 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 6.347041130065918
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.685 Vali Acc: 0.547 Test Loss: 1.685 Test Acc: 0.547
Validation loss decreased (-0.546650 --> -0.546650).  Saving model ...
Epoch: 98 cost time: 6.58009147644043
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.680 Vali Acc: 0.547 Test Loss: 1.680 Test Acc: 0.547
Validation loss decreased (-0.546650 --> -0.546650).  Saving model ...
Epoch: 99 cost time: 6.49507212638855
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.677 Vali Acc: 0.543 Test Loss: 1.677 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 6.841685056686401
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.683 Vali Acc: 0.537 Test Loss: 1.683 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5466666666666666
model parameter : 207769
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.673877716064453
Epoch: 1, Steps: 18 | Train Loss: 3.310 Vali Loss: 3.278 Vali Acc: 0.047 Test Loss: 3.278 Test Acc: 0.047
Validation loss decreased (inf --> -0.046634).  Saving model ...
Epoch: 2 cost time: 6.552423000335693
Epoch: 2, Steps: 18 | Train Loss: 3.158 Vali Loss: 3.238 Vali Acc: 0.057 Test Loss: 3.238 Test Acc: 0.057
Validation loss decreased (-0.046634 --> -0.056634).  Saving model ...
Epoch: 3 cost time: 6.612976789474487
Epoch: 3, Steps: 18 | Train Loss: 3.044 Vali Loss: 3.193 Vali Acc: 0.070 Test Loss: 3.193 Test Acc: 0.070
Validation loss decreased (-0.056634 --> -0.069968).  Saving model ...
Epoch: 4 cost time: 6.987325191497803
Epoch: 4, Steps: 18 | Train Loss: 2.819 Vali Loss: 3.142 Vali Acc: 0.070 Test Loss: 3.142 Test Acc: 0.070
Validation loss decreased (-0.069968 --> -0.069969).  Saving model ...
Epoch: 5 cost time: 6.593939781188965
Epoch: 5, Steps: 18 | Train Loss: 2.628 Vali Loss: 3.095 Vali Acc: 0.080 Test Loss: 3.095 Test Acc: 0.080
Validation loss decreased (-0.069969 --> -0.079969).  Saving model ...
Epoch: 6 cost time: 6.975101470947266
Epoch: 6, Steps: 18 | Train Loss: 2.334 Vali Loss: 3.043 Vali Acc: 0.093 Test Loss: 3.043 Test Acc: 0.093
Validation loss decreased (-0.079969 --> -0.093303).  Saving model ...
Epoch: 7 cost time: 6.387015342712402
Epoch: 7, Steps: 18 | Train Loss: 2.062 Vali Loss: 2.983 Vali Acc: 0.100 Test Loss: 2.983 Test Acc: 0.100
Validation loss decreased (-0.093303 --> -0.099970).  Saving model ...
Epoch: 8 cost time: 6.587897539138794
Epoch: 8, Steps: 18 | Train Loss: 1.762 Vali Loss: 2.931 Vali Acc: 0.130 Test Loss: 2.931 Test Acc: 0.130
Validation loss decreased (-0.099970 --> -0.129971).  Saving model ...
Epoch: 9 cost time: 6.747105836868286
Epoch: 9, Steps: 18 | Train Loss: 1.464 Vali Loss: 2.881 Vali Acc: 0.137 Test Loss: 2.881 Test Acc: 0.137
Validation loss decreased (-0.129971 --> -0.136638).  Saving model ...
Epoch: 10 cost time: 6.438460826873779
Epoch: 10, Steps: 18 | Train Loss: 1.198 Vali Loss: 2.822 Vali Acc: 0.160 Test Loss: 2.822 Test Acc: 0.160
Validation loss decreased (-0.136638 --> -0.159972).  Saving model ...
Epoch: 11 cost time: 6.813483715057373
Epoch: 11, Steps: 18 | Train Loss: 0.947 Vali Loss: 2.768 Vali Acc: 0.167 Test Loss: 2.768 Test Acc: 0.167
Validation loss decreased (-0.159972 --> -0.166639).  Saving model ...
Epoch: 12 cost time: 6.387649059295654
Epoch: 12, Steps: 18 | Train Loss: 0.727 Vali Loss: 2.695 Vali Acc: 0.200 Test Loss: 2.695 Test Acc: 0.200
Validation loss decreased (-0.166639 --> -0.199973).  Saving model ...
Epoch: 13 cost time: 6.444098711013794
Epoch: 13, Steps: 18 | Train Loss: 0.545 Vali Loss: 2.644 Vali Acc: 0.187 Test Loss: 2.644 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.34741735458374
Epoch: 14, Steps: 18 | Train Loss: 0.366 Vali Loss: 2.546 Vali Acc: 0.203 Test Loss: 2.546 Test Acc: 0.203
Validation loss decreased (-0.199973 --> -0.203308).  Saving model ...
Epoch: 15 cost time: 6.472821474075317
Epoch: 15, Steps: 18 | Train Loss: 0.258 Vali Loss: 2.450 Vali Acc: 0.250 Test Loss: 2.450 Test Acc: 0.250
Validation loss decreased (-0.203308 --> -0.249975).  Saving model ...
Epoch: 16 cost time: 7.35912823677063
Epoch: 16, Steps: 18 | Train Loss: 0.166 Vali Loss: 2.409 Vali Acc: 0.253 Test Loss: 2.409 Test Acc: 0.253
Validation loss decreased (-0.249975 --> -0.253309).  Saving model ...
Epoch: 17 cost time: 6.326194524765015
Epoch: 17, Steps: 18 | Train Loss: 0.141 Vali Loss: 2.328 Vali Acc: 0.277 Test Loss: 2.328 Test Acc: 0.277
Validation loss decreased (-0.253309 --> -0.276643).  Saving model ...
Epoch: 18 cost time: 6.489457845687866
Epoch: 18, Steps: 18 | Train Loss: 0.096 Vali Loss: 2.256 Vali Acc: 0.293 Test Loss: 2.256 Test Acc: 0.293
Validation loss decreased (-0.276643 --> -0.293311).  Saving model ...
Epoch: 19 cost time: 6.609433889389038
Epoch: 19, Steps: 18 | Train Loss: 0.085 Vali Loss: 2.231 Vali Acc: 0.310 Test Loss: 2.231 Test Acc: 0.310
Validation loss decreased (-0.293311 --> -0.309978).  Saving model ...
Epoch: 20 cost time: 6.861927032470703
Epoch: 20, Steps: 18 | Train Loss: 0.060 Vali Loss: 2.186 Vali Acc: 0.337 Test Loss: 2.186 Test Acc: 0.337
Validation loss decreased (-0.309978 --> -0.336645).  Saving model ...
Epoch: 21 cost time: 7.073669672012329
Epoch: 21, Steps: 18 | Train Loss: 0.055 Vali Loss: 2.130 Vali Acc: 0.327 Test Loss: 2.130 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.696629047393799
Epoch: 22, Steps: 18 | Train Loss: 0.047 Vali Loss: 2.081 Vali Acc: 0.357 Test Loss: 2.081 Test Acc: 0.357
Validation loss decreased (-0.336645 --> -0.356646).  Saving model ...
Epoch: 23 cost time: 6.2048609256744385
Epoch: 23, Steps: 18 | Train Loss: 0.039 Vali Loss: 2.077 Vali Acc: 0.353 Test Loss: 2.077 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.975625038146973
Epoch: 24, Steps: 18 | Train Loss: 0.033 Vali Loss: 2.032 Vali Acc: 0.353 Test Loss: 2.032 Test Acc: 0.353
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.578304052352905
Epoch: 25, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.965 Vali Acc: 0.403 Test Loss: 1.965 Test Acc: 0.403
Validation loss decreased (-0.356646 --> -0.403314).  Saving model ...
Epoch: 26 cost time: 6.6417763233184814
Epoch: 26, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.945 Vali Acc: 0.397 Test Loss: 1.945 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.608832597732544
Epoch: 27, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.930 Vali Acc: 0.407 Test Loss: 1.930 Test Acc: 0.407
Validation loss decreased (-0.403314 --> -0.406647).  Saving model ...
Epoch: 28 cost time: 6.80952000617981
Epoch: 28, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.916 Vali Acc: 0.403 Test Loss: 1.916 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.885097503662109
Epoch: 29, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.890 Vali Acc: 0.407 Test Loss: 1.890 Test Acc: 0.407
Validation loss decreased (-0.406647 --> -0.406648).  Saving model ...
Epoch: 30 cost time: 6.906301021575928
Epoch: 30, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.875 Vali Acc: 0.423 Test Loss: 1.875 Test Acc: 0.423
Validation loss decreased (-0.406648 --> -0.423315).  Saving model ...
Epoch: 31 cost time: 6.807653903961182
Epoch: 31, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.858 Vali Acc: 0.430 Test Loss: 1.858 Test Acc: 0.430
Validation loss decreased (-0.423315 --> -0.429981).  Saving model ...
Epoch: 32 cost time: 6.237238645553589
Epoch: 32, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.839 Vali Acc: 0.427 Test Loss: 1.839 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.427548170089722
Epoch: 33, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.806 Vali Acc: 0.437 Test Loss: 1.806 Test Acc: 0.437
Validation loss decreased (-0.429981 --> -0.436649).  Saving model ...
Epoch: 34 cost time: 6.509824752807617
Epoch: 34, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.797 Vali Acc: 0.433 Test Loss: 1.797 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.387053489685059
Epoch: 35, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.792 Vali Acc: 0.437 Test Loss: 1.792 Test Acc: 0.437
Validation loss decreased (-0.436649 --> -0.436649).  Saving model ...
Epoch: 36 cost time: 6.6614062786102295
Epoch: 36, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.766 Vali Acc: 0.440 Test Loss: 1.766 Test Acc: 0.440
Validation loss decreased (-0.436649 --> -0.439982).  Saving model ...
Epoch: 37 cost time: 7.510351896286011
Epoch: 37, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.741 Vali Acc: 0.440 Test Loss: 1.741 Test Acc: 0.440
Validation loss decreased (-0.439982 --> -0.439983).  Saving model ...
Epoch: 38 cost time: 6.460701942443848
Epoch: 38, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.742 Vali Acc: 0.453 Test Loss: 1.742 Test Acc: 0.453
Validation loss decreased (-0.439983 --> -0.453316).  Saving model ...
Epoch: 39 cost time: 6.510396718978882
Epoch: 39, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.745 Vali Acc: 0.443 Test Loss: 1.745 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.499730110168457
Epoch: 40, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.724 Vali Acc: 0.447 Test Loss: 1.724 Test Acc: 0.447
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 7.09976053237915
Epoch: 41, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.701 Vali Acc: 0.473 Test Loss: 1.701 Test Acc: 0.473
Validation loss decreased (-0.453316 --> -0.473316).  Saving model ...
Epoch: 42 cost time: 6.9709792137146
Epoch: 42, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.699 Vali Acc: 0.463 Test Loss: 1.699 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.5547873973846436
Epoch: 43, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.686 Vali Acc: 0.467 Test Loss: 1.686 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.87594747543335
Epoch: 44, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.678 Vali Acc: 0.477 Test Loss: 1.678 Test Acc: 0.477
Validation loss decreased (-0.473316 --> -0.476650).  Saving model ...
Epoch: 45 cost time: 6.70088791847229
Epoch: 45, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.661 Vali Acc: 0.483 Test Loss: 1.661 Test Acc: 0.483
Validation loss decreased (-0.476650 --> -0.483317).  Saving model ...
Epoch: 46 cost time: 6.740785837173462
Epoch: 46, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.648 Vali Acc: 0.483 Test Loss: 1.648 Test Acc: 0.483
Validation loss decreased (-0.483317 --> -0.483317).  Saving model ...
Epoch: 47 cost time: 6.637670278549194
Epoch: 47, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.635 Vali Acc: 0.487 Test Loss: 1.635 Test Acc: 0.487
Validation loss decreased (-0.483317 --> -0.486650).  Saving model ...
Epoch: 48 cost time: 6.960117816925049
Epoch: 48, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.637 Vali Acc: 0.493 Test Loss: 1.637 Test Acc: 0.493
Validation loss decreased (-0.486650 --> -0.493317).  Saving model ...
Epoch: 49 cost time: 6.5348827838897705
Epoch: 49, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.631 Vali Acc: 0.490 Test Loss: 1.631 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.308948516845703
Epoch: 50, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.626 Vali Acc: 0.497 Test Loss: 1.626 Test Acc: 0.497
Validation loss decreased (-0.493317 --> -0.496650).  Saving model ...
Epoch: 51 cost time: 7.40831732749939
Epoch: 51, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.624 Vali Acc: 0.507 Test Loss: 1.624 Test Acc: 0.507
Validation loss decreased (-0.496650 --> -0.506650).  Saving model ...
Epoch: 52 cost time: 7.014833927154541
Epoch: 52, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.623 Vali Acc: 0.510 Test Loss: 1.623 Test Acc: 0.510
Validation loss decreased (-0.506650 --> -0.509984).  Saving model ...
Epoch: 53 cost time: 7.527917861938477
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.618 Vali Acc: 0.510 Test Loss: 1.618 Test Acc: 0.510
Validation loss decreased (-0.509984 --> -0.509984).  Saving model ...
Epoch: 54 cost time: 6.578282594680786
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.609 Vali Acc: 0.523 Test Loss: 1.609 Test Acc: 0.523
Validation loss decreased (-0.509984 --> -0.523317).  Saving model ...
Epoch: 55 cost time: 6.278820753097534
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.605 Vali Acc: 0.513 Test Loss: 1.605 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 7.484217405319214
Epoch: 56, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.603 Vali Acc: 0.507 Test Loss: 1.603 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 6.951640605926514
Epoch: 57, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.609 Vali Acc: 0.513 Test Loss: 1.609 Test Acc: 0.513
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 6.727664232254028
Epoch: 58, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.610 Vali Acc: 0.513 Test Loss: 1.610 Test Acc: 0.513
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 6.677246332168579
Epoch: 59, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.590 Vali Acc: 0.517 Test Loss: 1.590 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 6.7850987911224365
Epoch: 60, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.578 Vali Acc: 0.520 Test Loss: 1.578 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 7.220757722854614
Epoch: 61, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.569 Vali Acc: 0.530 Test Loss: 1.569 Test Acc: 0.530
Validation loss decreased (-0.523317 --> -0.529984).  Saving model ...
Epoch: 62 cost time: 7.124687910079956
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.570 Vali Acc: 0.517 Test Loss: 1.570 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 7.059347152709961
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.568 Vali Acc: 0.523 Test Loss: 1.568 Test Acc: 0.523
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 6.2331812381744385
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.570 Vali Acc: 0.527 Test Loss: 1.570 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 6.206741094589233
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.567 Vali Acc: 0.530 Test Loss: 1.567 Test Acc: 0.530
Validation loss decreased (-0.529984 --> -0.529984).  Saving model ...
Epoch: 66 cost time: 6.536702394485474
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.564 Vali Acc: 0.523 Test Loss: 1.564 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 6.593649387359619
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.557 Vali Acc: 0.520 Test Loss: 1.557 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 6.660560846328735
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.555 Vali Acc: 0.527 Test Loss: 1.555 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 6.267681360244751
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.543 Vali Acc: 0.537 Test Loss: 1.543 Test Acc: 0.537
Validation loss decreased (-0.529984 --> -0.536651).  Saving model ...
Epoch: 70 cost time: 6.537597417831421
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.533 Vali Acc: 0.537 Test Loss: 1.533 Test Acc: 0.537
Validation loss decreased (-0.536651 --> -0.536651).  Saving model ...
Epoch: 71 cost time: 6.100704669952393
Epoch: 71, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.528 Vali Acc: 0.537 Test Loss: 1.528 Test Acc: 0.537
Validation loss decreased (-0.536651 --> -0.536651).  Saving model ...
Epoch: 72 cost time: 6.858170509338379
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.522 Vali Acc: 0.540 Test Loss: 1.522 Test Acc: 0.540
Validation loss decreased (-0.536651 --> -0.539985).  Saving model ...
Epoch: 73 cost time: 6.372238874435425
Epoch: 73, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.515 Vali Acc: 0.533 Test Loss: 1.515 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 6.891229629516602
Epoch: 74, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.505 Vali Acc: 0.547 Test Loss: 1.505 Test Acc: 0.547
Validation loss decreased (-0.539985 --> -0.546652).  Saving model ...
Epoch: 75 cost time: 6.708719253540039
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.505 Vali Acc: 0.550 Test Loss: 1.505 Test Acc: 0.550
Validation loss decreased (-0.546652 --> -0.549985).  Saving model ...
Epoch: 76 cost time: 6.154294490814209
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.506 Vali Acc: 0.557 Test Loss: 1.506 Test Acc: 0.557
Validation loss decreased (-0.549985 --> -0.556652).  Saving model ...
Epoch: 77 cost time: 6.384687185287476
Epoch: 77, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.496 Vali Acc: 0.550 Test Loss: 1.496 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 6.939603805541992
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.489 Vali Acc: 0.550 Test Loss: 1.489 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 6.786068439483643
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.488 Vali Acc: 0.553 Test Loss: 1.488 Test Acc: 0.553
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 6.52324104309082
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.496 Vali Acc: 0.553 Test Loss: 1.496 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 6.539516925811768
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.493 Vali Acc: 0.550 Test Loss: 1.493 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 6.59309720993042
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.493 Vali Acc: 0.553 Test Loss: 1.493 Test Acc: 0.553
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 6.879225730895996
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.490 Vali Acc: 0.557 Test Loss: 1.490 Test Acc: 0.557
Validation loss decreased (-0.556652 --> -0.556652).  Saving model ...
Epoch: 84 cost time: 7.039082288742065
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.490 Vali Acc: 0.560 Test Loss: 1.490 Test Acc: 0.560
Validation loss decreased (-0.556652 --> -0.559985).  Saving model ...
Epoch: 85 cost time: 6.679274797439575
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.483 Vali Acc: 0.560 Test Loss: 1.483 Test Acc: 0.560
Validation loss decreased (-0.559985 --> -0.559985).  Saving model ...
Epoch: 86 cost time: 6.557424306869507
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.479 Vali Acc: 0.567 Test Loss: 1.479 Test Acc: 0.567
Validation loss decreased (-0.559985 --> -0.566652).  Saving model ...
Epoch: 87 cost time: 6.757944107055664
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.563 Test Loss: 1.477 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 6.949638366699219
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.469 Vali Acc: 0.563 Test Loss: 1.469 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 7.173812627792358
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.461 Vali Acc: 0.573 Test Loss: 1.461 Test Acc: 0.573
Validation loss decreased (-0.566652 --> -0.573319).  Saving model ...
Epoch: 90 cost time: 6.2610650062561035
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.464 Vali Acc: 0.570 Test Loss: 1.464 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 6.368934631347656
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.468 Vali Acc: 0.560 Test Loss: 1.468 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 6.987498760223389
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.466 Vali Acc: 0.560 Test Loss: 1.466 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 6.954780578613281
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.463 Vali Acc: 0.563 Test Loss: 1.463 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 6.177906274795532
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.466 Vali Acc: 0.560 Test Loss: 1.466 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 5.853178262710571
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.467 Vali Acc: 0.550 Test Loss: 1.467 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 6.525796175003052
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.468 Vali Acc: 0.560 Test Loss: 1.468 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 6.589240074157715
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.466 Vali Acc: 0.567 Test Loss: 1.466 Test Acc: 0.567
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 6.492023944854736
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.465 Vali Acc: 0.573 Test Loss: 1.465 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 6.106064319610596
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.463 Vali Acc: 0.567 Test Loss: 1.463 Test Acc: 0.567
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5733333333333334
model parameter : 207769
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.230629920959473
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 6.416933059692383
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 3 cost time: 6.247661352157593
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.869966983795166
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.845630645751953
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.1472625732421875
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.920426845550537
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.193312883377075
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.263310194015503
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.890117406845093
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.2028419971466064
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.767054796218872
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 207769
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.22426724433899
Epoch: 1, Steps: 18 | Train Loss: 3.214 Vali Loss: 3.038 Vali Acc: 0.183 Test Loss: 3.038 Test Acc: 0.183
Validation loss decreased (inf --> -0.183303).  Saving model ...
Epoch: 2 cost time: 6.136879920959473
Epoch: 2, Steps: 18 | Train Loss: 2.775 Vali Loss: 2.502 Vali Acc: 0.573 Test Loss: 2.502 Test Acc: 0.573
Validation loss decreased (-0.183303 --> -0.573308).  Saving model ...
Epoch: 3 cost time: 7.012183427810669
Epoch: 3, Steps: 18 | Train Loss: 2.155 Vali Loss: 1.911 Vali Acc: 0.740 Test Loss: 1.911 Test Acc: 0.740
Validation loss decreased (-0.573308 --> -0.739981).  Saving model ...
Epoch: 4 cost time: 6.592238426208496
Epoch: 4, Steps: 18 | Train Loss: 1.467 Vali Loss: 1.395 Vali Acc: 0.793 Test Loss: 1.395 Test Acc: 0.793
Validation loss decreased (-0.739981 --> -0.793319).  Saving model ...
Epoch: 5 cost time: 6.479710102081299
Epoch: 5, Steps: 18 | Train Loss: 0.929 Vali Loss: 1.028 Vali Acc: 0.823 Test Loss: 1.028 Test Acc: 0.823
Validation loss decreased (-0.793319 --> -0.823323).  Saving model ...
Epoch: 6 cost time: 6.129146099090576
Epoch: 6, Steps: 18 | Train Loss: 0.541 Vali Loss: 0.793 Vali Acc: 0.837 Test Loss: 0.793 Test Acc: 0.837
Validation loss decreased (-0.823323 --> -0.836659).  Saving model ...
Epoch: 7 cost time: 6.529344320297241
Epoch: 7, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.650 Vali Acc: 0.867 Test Loss: 0.650 Test Acc: 0.867
Validation loss decreased (-0.836659 --> -0.866660).  Saving model ...
Epoch: 8 cost time: 6.252546548843384
Epoch: 8, Steps: 18 | Train Loss: 0.178 Vali Loss: 0.591 Vali Acc: 0.870 Test Loss: 0.591 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.869994).  Saving model ...
Epoch: 9 cost time: 7.137969493865967
Epoch: 9, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.549 Vali Acc: 0.870 Test Loss: 0.549 Test Acc: 0.870
Validation loss decreased (-0.869994 --> -0.869995).  Saving model ...
Epoch: 10 cost time: 6.4326817989349365
Epoch: 10, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.523 Vali Acc: 0.873 Test Loss: 0.523 Test Acc: 0.873
Validation loss decreased (-0.869995 --> -0.873328).  Saving model ...
Epoch: 11 cost time: 5.865158319473267
Epoch: 11, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.509 Vali Acc: 0.893 Test Loss: 0.509 Test Acc: 0.893
Validation loss decreased (-0.873328 --> -0.893328).  Saving model ...
Epoch: 12 cost time: 6.518407821655273
Epoch: 12, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.486 Vali Acc: 0.883 Test Loss: 0.486 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.631421089172363
Epoch: 13, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.471 Vali Acc: 0.887 Test Loss: 0.471 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.54940390586853
Epoch: 14, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.463 Vali Acc: 0.887 Test Loss: 0.463 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.395578384399414
Epoch: 15, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.452 Vali Acc: 0.883 Test Loss: 0.452 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.333517074584961
Epoch: 16, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.447 Vali Acc: 0.890 Test Loss: 0.447 Test Acc: 0.890
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.860444068908691
Epoch: 17, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.442 Vali Acc: 0.887 Test Loss: 0.442 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.624385356903076
Epoch: 18, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.444 Vali Acc: 0.883 Test Loss: 0.444 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.075803756713867
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.441 Vali Acc: 0.883 Test Loss: 0.441 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.248598337173462
Epoch: 20, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.438 Vali Acc: 0.887 Test Loss: 0.438 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.781745672225952
Epoch: 21, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.432 Vali Acc: 0.887 Test Loss: 0.432 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8933333333333333
model parameter : 183193
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.301717042922974
Epoch: 1, Steps: 18 | Train Loss: 3.229 Vali Loss: 3.105 Vali Acc: 0.113 Test Loss: 3.105 Test Acc: 0.113
Validation loss decreased (inf --> -0.113302).  Saving model ...
Epoch: 2 cost time: 7.274659633636475
Epoch: 2, Steps: 18 | Train Loss: 2.879 Vali Loss: 2.700 Vali Acc: 0.450 Test Loss: 2.700 Test Acc: 0.450
Validation loss decreased (-0.113302 --> -0.449973).  Saving model ...
Epoch: 3 cost time: 7.030338764190674
Epoch: 3, Steps: 18 | Train Loss: 2.393 Vali Loss: 2.227 Vali Acc: 0.637 Test Loss: 2.227 Test Acc: 0.637
Validation loss decreased (-0.449973 --> -0.636644).  Saving model ...
Epoch: 4 cost time: 7.1340649127960205
Epoch: 4, Steps: 18 | Train Loss: 1.786 Vali Loss: 1.764 Vali Acc: 0.723 Test Loss: 1.764 Test Acc: 0.723
Validation loss decreased (-0.636644 --> -0.723316).  Saving model ...
Epoch: 5 cost time: 6.498885631561279
Epoch: 5, Steps: 18 | Train Loss: 1.239 Vali Loss: 1.375 Vali Acc: 0.753 Test Loss: 1.375 Test Acc: 0.753
Validation loss decreased (-0.723316 --> -0.753320).  Saving model ...
Epoch: 6 cost time: 6.6857874393463135
Epoch: 6, Steps: 18 | Train Loss: 0.777 Vali Loss: 1.078 Vali Acc: 0.787 Test Loss: 1.078 Test Acc: 0.787
Validation loss decreased (-0.753320 --> -0.786656).  Saving model ...
Epoch: 7 cost time: 7.000803709030151
Epoch: 7, Steps: 18 | Train Loss: 0.477 Vali Loss: 0.880 Vali Acc: 0.827 Test Loss: 0.880 Test Acc: 0.827
Validation loss decreased (-0.786656 --> -0.826658).  Saving model ...
Epoch: 8 cost time: 7.187798738479614
Epoch: 8, Steps: 18 | Train Loss: 0.270 Vali Loss: 0.779 Vali Acc: 0.817 Test Loss: 0.779 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.380472183227539
Epoch: 9, Steps: 18 | Train Loss: 0.179 Vali Loss: 0.713 Vali Acc: 0.830 Test Loss: 0.713 Test Acc: 0.830
Validation loss decreased (-0.826658 --> -0.829993).  Saving model ...
Epoch: 10 cost time: 6.377356052398682
Epoch: 10, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.681 Vali Acc: 0.837 Test Loss: 0.681 Test Acc: 0.837
Validation loss decreased (-0.829993 --> -0.836660).  Saving model ...
Epoch: 11 cost time: 6.523555278778076
Epoch: 11, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.658 Vali Acc: 0.843 Test Loss: 0.658 Test Acc: 0.843
Validation loss decreased (-0.836660 --> -0.843327).  Saving model ...
Epoch: 12 cost time: 6.565485715866089
Epoch: 12, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.628 Vali Acc: 0.840 Test Loss: 0.628 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.527389287948608
Epoch: 13, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.608 Vali Acc: 0.837 Test Loss: 0.608 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.020934820175171
Epoch: 14, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.9019575119018555
Epoch: 15, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.587 Vali Acc: 0.843 Test Loss: 0.587 Test Acc: 0.843
Validation loss decreased (-0.843327 --> -0.843327).  Saving model ...
Epoch: 16 cost time: 6.4408745765686035
Epoch: 16, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.585 Vali Acc: 0.840 Test Loss: 0.585 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.110719680786133
Epoch: 17, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.577 Vali Acc: 0.843 Test Loss: 0.577 Test Acc: 0.843
Validation loss decreased (-0.843327 --> -0.843328).  Saving model ...
Epoch: 18 cost time: 7.219052076339722
Epoch: 18, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.574 Vali Acc: 0.847 Test Loss: 0.574 Test Acc: 0.847
Validation loss decreased (-0.843328 --> -0.846661).  Saving model ...
Epoch: 19 cost time: 6.350400686264038
Epoch: 19, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
Validation loss decreased (-0.846661 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 6.366895437240601
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.473342180252075
Epoch: 21, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.563 Vali Acc: 0.847 Test Loss: 0.563 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.770293712615967
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.563 Vali Acc: 0.847 Test Loss: 0.563 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.663020849227905
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 7.269165992736816
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.555 Vali Acc: 0.853 Test Loss: 0.555 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853328).  Saving model ...
Epoch: 25 cost time: 6.965822219848633
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.737200975418091
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.993956089019775
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.551 Vali Acc: 0.853 Test Loss: 0.551 Test Acc: 0.853
Validation loss decreased (-0.853328 --> -0.853328).  Saving model ...
Epoch: 28 cost time: 7.125630855560303
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.549 Vali Acc: 0.853 Test Loss: 0.549 Test Acc: 0.853
Validation loss decreased (-0.853328 --> -0.853328).  Saving model ...
Epoch: 29 cost time: 7.4556403160095215
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.550 Vali Acc: 0.853 Test Loss: 0.550 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.601330518722534
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.853 Test Loss: 0.548 Test Acc: 0.853
Validation loss decreased (-0.853328 --> -0.853328).  Saving model ...
Epoch: 31 cost time: 6.645109176635742
Epoch: 31, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.853 Test Loss: 0.548 Test Acc: 0.853
Validation loss decreased (-0.853328 --> -0.853328).  Saving model ...
Epoch: 32 cost time: 7.685233116149902
Epoch: 32, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.853 Test Loss: 0.548 Test Acc: 0.853
Validation loss decreased (-0.853328 --> -0.853328).  Saving model ...
Epoch: 33 cost time: 6.891552448272705
Epoch: 33, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.546 Vali Acc: 0.853 Test Loss: 0.546 Test Acc: 0.853
Validation loss decreased (-0.853328 --> -0.853328).  Saving model ...
Epoch: 34 cost time: 6.781089782714844
Epoch: 34, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.544 Vali Acc: 0.853 Test Loss: 0.544 Test Acc: 0.853
Validation loss decreased (-0.853328 --> -0.853328).  Saving model ...
Epoch: 35 cost time: 6.7444963455200195
Epoch: 35, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.542 Vali Acc: 0.853 Test Loss: 0.542 Test Acc: 0.853
Validation loss decreased (-0.853328 --> -0.853328).  Saving model ...
Epoch: 36 cost time: 6.893664121627808
Epoch: 36, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.542 Vali Acc: 0.853 Test Loss: 0.542 Test Acc: 0.853
Validation loss decreased (-0.853328 --> -0.853328).  Saving model ...
Epoch: 37 cost time: 6.974007844924927
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.164276599884033
Epoch: 38, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 6.506957054138184
Epoch: 39, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.543 Vali Acc: 0.853 Test Loss: 0.543 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 7.098367691040039
Epoch: 40, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.853 Test Loss: 0.544 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 6.571046829223633
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.543 Vali Acc: 0.853 Test Loss: 0.543 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 6.3110504150390625
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.542 Vali Acc: 0.853 Test Loss: 0.542 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 6.614370107650757
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.541 Vali Acc: 0.853 Test Loss: 0.541 Test Acc: 0.853
Validation loss decreased (-0.853328 --> -0.853328).  Saving model ...
Epoch: 44 cost time: 6.607492923736572
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.857 Test Loss: 0.539 Test Acc: 0.857
Validation loss decreased (-0.853328 --> -0.856661).  Saving model ...
Epoch: 45 cost time: 6.979866981506348
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.857 Test Loss: 0.538 Test Acc: 0.857
Validation loss decreased (-0.856661 --> -0.856661).  Saving model ...
Epoch: 46 cost time: 6.602292776107788
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.857 Test Loss: 0.539 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 7.04697585105896
Epoch: 47, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.853 Test Loss: 0.539 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 6.977248907089233
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.857 Test Loss: 0.539 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 6.8502538204193115
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.857 Test Loss: 0.538 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 6.495306015014648
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.857 Test Loss: 0.538 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 6.706133127212524
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.857 Test Loss: 0.538 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 6.876743316650391
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.857 Test Loss: 0.540 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 7.02679705619812
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.857 Test Loss: 0.541 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 6.854438543319702
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.857 Test Loss: 0.541 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 7.045322895050049
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.857 Test Loss: 0.541 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.8566666666666667
model parameter : 183193
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.818577289581299
Epoch: 1, Steps: 18 | Train Loss: 3.251 Vali Loss: 3.166 Vali Acc: 0.083 Test Loss: 3.166 Test Acc: 0.083
Validation loss decreased (inf --> -0.083302).  Saving model ...
Epoch: 2 cost time: 6.309498310089111
Epoch: 2, Steps: 18 | Train Loss: 2.985 Vali Loss: 2.891 Vali Acc: 0.307 Test Loss: 2.891 Test Acc: 0.307
Validation loss decreased (-0.083302 --> -0.306638).  Saving model ...
Epoch: 3 cost time: 6.515568971633911
Epoch: 3, Steps: 18 | Train Loss: 2.624 Vali Loss: 2.559 Vali Acc: 0.490 Test Loss: 2.559 Test Acc: 0.490
Validation loss decreased (-0.306638 --> -0.489974).  Saving model ...
Epoch: 4 cost time: 6.846550703048706
Epoch: 4, Steps: 18 | Train Loss: 2.129 Vali Loss: 2.210 Vali Acc: 0.590 Test Loss: 2.210 Test Acc: 0.590
Validation loss decreased (-0.489974 --> -0.589978).  Saving model ...
Epoch: 5 cost time: 6.377325057983398
Epoch: 5, Steps: 18 | Train Loss: 1.631 Vali Loss: 1.873 Vali Acc: 0.647 Test Loss: 1.873 Test Acc: 0.647
Validation loss decreased (-0.589978 --> -0.646648).  Saving model ...
Epoch: 6 cost time: 6.405189752578735
Epoch: 6, Steps: 18 | Train Loss: 1.167 Vali Loss: 1.565 Vali Acc: 0.707 Test Loss: 1.565 Test Acc: 0.707
Validation loss decreased (-0.646648 --> -0.706651).  Saving model ...
Epoch: 7 cost time: 6.254103183746338
Epoch: 7, Steps: 18 | Train Loss: 0.787 Vali Loss: 1.318 Vali Acc: 0.723 Test Loss: 1.318 Test Acc: 0.723
Validation loss decreased (-0.706651 --> -0.723320).  Saving model ...
Epoch: 8 cost time: 6.163683652877808
Epoch: 8, Steps: 18 | Train Loss: 0.475 Vali Loss: 1.162 Vali Acc: 0.723 Test Loss: 1.162 Test Acc: 0.723
Validation loss decreased (-0.723320 --> -0.723322).  Saving model ...
Epoch: 9 cost time: 6.311805963516235
Epoch: 9, Steps: 18 | Train Loss: 0.294 Vali Loss: 1.041 Vali Acc: 0.750 Test Loss: 1.041 Test Acc: 0.750
Validation loss decreased (-0.723322 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 5.8076276779174805
Epoch: 10, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.980 Vali Acc: 0.760 Test Loss: 0.980 Test Acc: 0.760
Validation loss decreased (-0.749990 --> -0.759990).  Saving model ...
Epoch: 11 cost time: 6.175313472747803
Epoch: 11, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.948 Vali Acc: 0.757 Test Loss: 0.948 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.372916221618652
Epoch: 12, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.900 Vali Acc: 0.773 Test Loss: 0.900 Test Acc: 0.773
Validation loss decreased (-0.759990 --> -0.773324).  Saving model ...
Epoch: 13 cost time: 6.593787908554077
Epoch: 13, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.880 Vali Acc: 0.777 Test Loss: 0.880 Test Acc: 0.777
Validation loss decreased (-0.773324 --> -0.776658).  Saving model ...
Epoch: 14 cost time: 6.275197982788086
Epoch: 14, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.874 Vali Acc: 0.770 Test Loss: 0.874 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.533379077911377
Epoch: 15, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.857 Vali Acc: 0.780 Test Loss: 0.857 Test Acc: 0.780
Validation loss decreased (-0.776658 --> -0.779991).  Saving model ...
Epoch: 16 cost time: 6.636573314666748
Epoch: 16, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.848 Vali Acc: 0.773 Test Loss: 0.848 Test Acc: 0.773
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.5211639404296875
Epoch: 17, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.838 Vali Acc: 0.787 Test Loss: 0.838 Test Acc: 0.787
Validation loss decreased (-0.779991 --> -0.786658).  Saving model ...
Epoch: 18 cost time: 6.660667181015015
Epoch: 18, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.832 Vali Acc: 0.787 Test Loss: 0.832 Test Acc: 0.787
Validation loss decreased (-0.786658 --> -0.786658).  Saving model ...
Epoch: 19 cost time: 5.998350143432617
Epoch: 19, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.827 Vali Acc: 0.787 Test Loss: 0.827 Test Acc: 0.787
Validation loss decreased (-0.786658 --> -0.786658).  Saving model ...
Epoch: 20 cost time: 6.264727354049683
Epoch: 20, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.828 Vali Acc: 0.783 Test Loss: 0.828 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.074984312057495
Epoch: 21, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.818 Vali Acc: 0.783 Test Loss: 0.818 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.903508901596069
Epoch: 22, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.817 Vali Acc: 0.793 Test Loss: 0.817 Test Acc: 0.793
Validation loss decreased (-0.786658 --> -0.793325).  Saving model ...
Epoch: 23 cost time: 5.8675453662872314
Epoch: 23, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.807 Vali Acc: 0.787 Test Loss: 0.807 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.313899040222168
Epoch: 24, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.805 Vali Acc: 0.787 Test Loss: 0.805 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.002737283706665
Epoch: 25, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.804 Vali Acc: 0.790 Test Loss: 0.804 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.946665287017822
Epoch: 26, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.808 Vali Acc: 0.790 Test Loss: 0.808 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.467297554016113
Epoch: 27, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.803 Vali Acc: 0.790 Test Loss: 0.803 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.7060866355896
Epoch: 28, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.802 Vali Acc: 0.787 Test Loss: 0.802 Test Acc: 0.787
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.994745969772339
Epoch: 29, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.806 Vali Acc: 0.790 Test Loss: 0.806 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.7292492389678955
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.805 Vali Acc: 0.787 Test Loss: 0.805 Test Acc: 0.787
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.119708299636841
Epoch: 31, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.804 Vali Acc: 0.783 Test Loss: 0.804 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.845444917678833
Epoch: 32, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.801 Vali Acc: 0.783 Test Loss: 0.801 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.7933333333333333
model parameter : 183193
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.843764305114746
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 3.207 Vali Acc: 0.053 Test Loss: 3.207 Test Acc: 0.053
Validation loss decreased (inf --> -0.053301).  Saving model ...
Epoch: 2 cost time: 5.984571933746338
Epoch: 2, Steps: 18 | Train Loss: 3.048 Vali Loss: 3.035 Vali Acc: 0.170 Test Loss: 3.035 Test Acc: 0.170
Validation loss decreased (-0.053301 --> -0.169970).  Saving model ...
Epoch: 3 cost time: 6.2062976360321045
Epoch: 3, Steps: 18 | Train Loss: 2.796 Vali Loss: 2.835 Vali Acc: 0.277 Test Loss: 2.835 Test Acc: 0.277
Validation loss decreased (-0.169970 --> -0.276638).  Saving model ...
Epoch: 4 cost time: 6.262274980545044
Epoch: 4, Steps: 18 | Train Loss: 2.421 Vali Loss: 2.625 Vali Acc: 0.323 Test Loss: 2.625 Test Acc: 0.323
Validation loss decreased (-0.276638 --> -0.323307).  Saving model ...
Epoch: 5 cost time: 6.142585515975952
Epoch: 5, Steps: 18 | Train Loss: 2.006 Vali Loss: 2.401 Vali Acc: 0.410 Test Loss: 2.401 Test Acc: 0.410
Validation loss decreased (-0.323307 --> -0.409976).  Saving model ...
Epoch: 6 cost time: 6.023606061935425
Epoch: 6, Steps: 18 | Train Loss: 1.628 Vali Loss: 2.171 Vali Acc: 0.477 Test Loss: 2.171 Test Acc: 0.477
Validation loss decreased (-0.409976 --> -0.476645).  Saving model ...
Epoch: 7 cost time: 6.295465469360352
Epoch: 7, Steps: 18 | Train Loss: 1.236 Vali Loss: 1.959 Vali Acc: 0.557 Test Loss: 1.959 Test Acc: 0.557
Validation loss decreased (-0.476645 --> -0.556647).  Saving model ...
Epoch: 8 cost time: 6.064902067184448
Epoch: 8, Steps: 18 | Train Loss: 0.851 Vali Loss: 1.795 Vali Acc: 0.523 Test Loss: 1.795 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.876638889312744
Epoch: 9, Steps: 18 | Train Loss: 0.547 Vali Loss: 1.641 Vali Acc: 0.537 Test Loss: 1.641 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.990018606185913
Epoch: 10, Steps: 18 | Train Loss: 0.376 Vali Loss: 1.522 Vali Acc: 0.567 Test Loss: 1.522 Test Acc: 0.567
Validation loss decreased (-0.556647 --> -0.566651).  Saving model ...
Epoch: 11 cost time: 5.5358569622039795
Epoch: 11, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.449 Vali Acc: 0.593 Test Loss: 1.449 Test Acc: 0.593
Validation loss decreased (-0.566651 --> -0.593319).  Saving model ...
Epoch: 12 cost time: 6.252595901489258
Epoch: 12, Steps: 18 | Train Loss: 0.132 Vali Loss: 1.389 Vali Acc: 0.567 Test Loss: 1.389 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.792125463485718
Epoch: 13, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.357 Vali Acc: 0.573 Test Loss: 1.357 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.981668710708618
Epoch: 14, Steps: 18 | Train Loss: 0.067 Vali Loss: 1.332 Vali Acc: 0.593 Test Loss: 1.332 Test Acc: 0.593
Validation loss decreased (-0.593319 --> -0.593320).  Saving model ...
Epoch: 15 cost time: 6.223444700241089
Epoch: 15, Steps: 18 | Train Loss: 0.052 Vali Loss: 1.299 Vali Acc: 0.600 Test Loss: 1.299 Test Acc: 0.600
Validation loss decreased (-0.593320 --> -0.599987).  Saving model ...
Epoch: 16 cost time: 6.5126471519470215
Epoch: 16, Steps: 18 | Train Loss: 0.042 Vali Loss: 1.290 Vali Acc: 0.567 Test Loss: 1.290 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.334834814071655
Epoch: 17, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.265 Vali Acc: 0.597 Test Loss: 1.265 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.748201370239258
Epoch: 18, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.259 Vali Acc: 0.593 Test Loss: 1.259 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.171422958374023
Epoch: 19, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.233 Vali Acc: 0.617 Test Loss: 1.233 Test Acc: 0.617
Validation loss decreased (-0.599987 --> -0.616654).  Saving model ...
Epoch: 20 cost time: 6.356207847595215
Epoch: 20, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.225 Vali Acc: 0.613 Test Loss: 1.225 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.087063550949097
Epoch: 21, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.205 Vali Acc: 0.620 Test Loss: 1.205 Test Acc: 0.620
Validation loss decreased (-0.616654 --> -0.619988).  Saving model ...
Epoch: 22 cost time: 6.323060035705566
Epoch: 22, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.202 Vali Acc: 0.620 Test Loss: 1.202 Test Acc: 0.620
Validation loss decreased (-0.619988 --> -0.619988).  Saving model ...
Epoch: 23 cost time: 5.8652024269104
Epoch: 23, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.190 Vali Acc: 0.610 Test Loss: 1.190 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.263065338134766
Epoch: 24, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.184 Vali Acc: 0.617 Test Loss: 1.184 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.740674257278442
Epoch: 25, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.182 Vali Acc: 0.623 Test Loss: 1.182 Test Acc: 0.623
Validation loss decreased (-0.619988 --> -0.623322).  Saving model ...
Epoch: 26 cost time: 6.373834609985352
Epoch: 26, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.175 Vali Acc: 0.623 Test Loss: 1.175 Test Acc: 0.623
Validation loss decreased (-0.623322 --> -0.623322).  Saving model ...
Epoch: 27 cost time: 6.573031902313232
Epoch: 27, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.165 Vali Acc: 0.617 Test Loss: 1.165 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.6634440422058105
Epoch: 28, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.161 Vali Acc: 0.623 Test Loss: 1.161 Test Acc: 0.623
Validation loss decreased (-0.623322 --> -0.623322).  Saving model ...
Epoch: 29 cost time: 6.476388931274414
Epoch: 29, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.149 Vali Acc: 0.633 Test Loss: 1.149 Test Acc: 0.633
Validation loss decreased (-0.623322 --> -0.633322).  Saving model ...
Epoch: 30 cost time: 6.686200380325317
Epoch: 30, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.144 Vali Acc: 0.633 Test Loss: 1.144 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 31 cost time: 6.267189264297485
Epoch: 31, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.136 Vali Acc: 0.633 Test Loss: 1.136 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 32 cost time: 6.668324947357178
Epoch: 32, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.129 Vali Acc: 0.650 Test Loss: 1.129 Test Acc: 0.650
Validation loss decreased (-0.633322 --> -0.649989).  Saving model ...
Epoch: 33 cost time: 5.802752494812012
Epoch: 33, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.131 Vali Acc: 0.647 Test Loss: 1.131 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.099289178848267
Epoch: 34, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.133 Vali Acc: 0.647 Test Loss: 1.133 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.296002626419067
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.127 Vali Acc: 0.653 Test Loss: 1.127 Test Acc: 0.653
Validation loss decreased (-0.649989 --> -0.653322).  Saving model ...
Epoch: 36 cost time: 6.374185800552368
Epoch: 36, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.125 Vali Acc: 0.650 Test Loss: 1.125 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.960237979888916
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.120 Vali Acc: 0.647 Test Loss: 1.120 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 6.198160886764526
Epoch: 38, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.119 Vali Acc: 0.647 Test Loss: 1.119 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 6.2355146408081055
Epoch: 39, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.118 Vali Acc: 0.640 Test Loss: 1.118 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 6.374001502990723
Epoch: 40, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.112 Vali Acc: 0.650 Test Loss: 1.112 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 6.4559571743011475
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.107 Vali Acc: 0.653 Test Loss: 1.107 Test Acc: 0.653
Validation loss decreased (-0.653322 --> -0.653322).  Saving model ...
Epoch: 42 cost time: 6.706618070602417
Epoch: 42, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.104 Vali Acc: 0.657 Test Loss: 1.104 Test Acc: 0.657
Validation loss decreased (-0.653322 --> -0.656656).  Saving model ...
Epoch: 43 cost time: 6.392070055007935
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.098 Vali Acc: 0.657 Test Loss: 1.098 Test Acc: 0.657
Validation loss decreased (-0.656656 --> -0.656656).  Saving model ...
Epoch: 44 cost time: 5.994426965713501
Epoch: 44, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.094 Vali Acc: 0.667 Test Loss: 1.094 Test Acc: 0.667
Validation loss decreased (-0.656656 --> -0.666656).  Saving model ...
Epoch: 45 cost time: 5.873262882232666
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.090 Vali Acc: 0.660 Test Loss: 1.090 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.064016819000244
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.092 Vali Acc: 0.657 Test Loss: 1.092 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.48372483253479
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.086 Vali Acc: 0.663 Test Loss: 1.086 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 6.012382745742798
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.083 Vali Acc: 0.660 Test Loss: 1.083 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 6.270342588424683
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.083 Vali Acc: 0.657 Test Loss: 1.083 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 6.176837205886841
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.079 Vali Acc: 0.667 Test Loss: 1.079 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 51 cost time: 6.638413429260254
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.077 Vali Acc: 0.663 Test Loss: 1.077 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.184905052185059
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.076 Vali Acc: 0.667 Test Loss: 1.076 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 53 cost time: 6.771611213684082
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.071 Vali Acc: 0.670 Test Loss: 1.071 Test Acc: 0.670
Validation loss decreased (-0.666656 --> -0.669989).  Saving model ...
Epoch: 54 cost time: 6.525214195251465
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.067 Vali Acc: 0.667 Test Loss: 1.067 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.550092935562134
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.063 Vali Acc: 0.673 Test Loss: 1.063 Test Acc: 0.673
Validation loss decreased (-0.669989 --> -0.673323).  Saving model ...
Epoch: 56 cost time: 5.907331705093384
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.062 Vali Acc: 0.680 Test Loss: 1.062 Test Acc: 0.680
Validation loss decreased (-0.673323 --> -0.679989).  Saving model ...
Epoch: 57 cost time: 6.0712409019470215
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.062 Vali Acc: 0.680 Test Loss: 1.062 Test Acc: 0.680
Validation loss decreased (-0.679989 --> -0.679989).  Saving model ...
Epoch: 58 cost time: 6.089056968688965
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.063 Vali Acc: 0.680 Test Loss: 1.063 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.398558139801025
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.059 Vali Acc: 0.683 Test Loss: 1.059 Test Acc: 0.683
Validation loss decreased (-0.679989 --> -0.683323).  Saving model ...
Epoch: 60 cost time: 5.825587034225464
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.061 Vali Acc: 0.693 Test Loss: 1.061 Test Acc: 0.693
Validation loss decreased (-0.683323 --> -0.693323).  Saving model ...
Epoch: 61 cost time: 6.326842308044434
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.058 Vali Acc: 0.690 Test Loss: 1.058 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.200796365737915
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.056 Vali Acc: 0.687 Test Loss: 1.056 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 6.457137823104858
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.055 Vali Acc: 0.690 Test Loss: 1.055 Test Acc: 0.690
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 6.164952516555786
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.053 Vali Acc: 0.690 Test Loss: 1.053 Test Acc: 0.690
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 6.410458087921143
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.051 Vali Acc: 0.693 Test Loss: 1.051 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 66 cost time: 5.967361688613892
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.051 Vali Acc: 0.683 Test Loss: 1.051 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 5.985686302185059
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.047 Vali Acc: 0.687 Test Loss: 1.047 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 5.915175199508667
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.044 Vali Acc: 0.687 Test Loss: 1.044 Test Acc: 0.687
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 5.843809366226196
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.039 Vali Acc: 0.690 Test Loss: 1.039 Test Acc: 0.690
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 5.88366436958313
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.037 Vali Acc: 0.690 Test Loss: 1.037 Test Acc: 0.690
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 5.764678239822388
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.035 Vali Acc: 0.690 Test Loss: 1.035 Test Acc: 0.690
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 6.300629377365112
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.034 Vali Acc: 0.693 Test Loss: 1.034 Test Acc: 0.693
Validation loss decreased (-0.693323 --> -0.693323).  Saving model ...
Epoch: 73 cost time: 6.290953874588013
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.033 Vali Acc: 0.697 Test Loss: 1.033 Test Acc: 0.697
Validation loss decreased (-0.693323 --> -0.696656).  Saving model ...
Epoch: 74 cost time: 6.139475584030151
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.697 Test Loss: 1.030 Test Acc: 0.697
Validation loss decreased (-0.696656 --> -0.696656).  Saving model ...
Epoch: 75 cost time: 6.578983783721924
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.703 Test Loss: 1.030 Test Acc: 0.703
Validation loss decreased (-0.696656 --> -0.703323).  Saving model ...
Epoch: 76 cost time: 6.233052730560303
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.029 Vali Acc: 0.707 Test Loss: 1.029 Test Acc: 0.707
Validation loss decreased (-0.703323 --> -0.706656).  Saving model ...
Epoch: 77 cost time: 6.364405870437622
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.028 Vali Acc: 0.703 Test Loss: 1.028 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 6.3453145027160645
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 5.9931793212890625
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.029 Vali Acc: 0.710 Test Loss: 1.029 Test Acc: 0.710
Validation loss decreased (-0.706656 --> -0.709990).  Saving model ...
Epoch: 80 cost time: 5.462608814239502
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.029 Vali Acc: 0.713 Test Loss: 1.029 Test Acc: 0.713
Validation loss decreased (-0.709990 --> -0.713323).  Saving model ...
Epoch: 81 cost time: 5.67342209815979
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.029 Vali Acc: 0.710 Test Loss: 1.029 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 5.619821786880493
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.710 Test Loss: 1.030 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 5.83251166343689
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.028 Vali Acc: 0.713 Test Loss: 1.028 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 84 cost time: 6.064778804779053
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.025 Vali Acc: 0.710 Test Loss: 1.025 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 5.892812490463257
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.703 Test Loss: 1.024 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 6.377732753753662
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.023 Vali Acc: 0.713 Test Loss: 1.023 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 87 cost time: 6.398292303085327
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.023 Vali Acc: 0.710 Test Loss: 1.023 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 5.490499258041382
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.020 Vali Acc: 0.710 Test Loss: 1.020 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 6.088920831680298
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.713 Test Loss: 1.017 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 90 cost time: 5.791791200637817
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.710 Test Loss: 1.014 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 5.880343198776245
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.015 Vali Acc: 0.707 Test Loss: 1.015 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 5.909900665283203
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.710 Test Loss: 1.014 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 5.748941898345947
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.707 Test Loss: 1.012 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 5.735139846801758
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.713 Test Loss: 1.010 Test Acc: 0.713
Validation loss decreased (-0.713323 --> -0.713323).  Saving model ...
Epoch: 95 cost time: 6.065958738327026
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.717 Test Loss: 1.011 Test Acc: 0.717
Validation loss decreased (-0.713323 --> -0.716657).  Saving model ...
Epoch: 96 cost time: 5.785802602767944
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.717 Test Loss: 1.011 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 6.097073554992676
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.713 Test Loss: 1.011 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 6.58283257484436
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.720 Test Loss: 1.010 Test Acc: 0.720
Validation loss decreased (-0.716657 --> -0.719990).  Saving model ...
Epoch: 99 cost time: 5.95334005355835
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.720 Test Loss: 1.008 Test Acc: 0.720
Validation loss decreased (-0.719990 --> -0.719990).  Saving model ...
Epoch: 100 cost time: 6.367856502532959
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.006 Vali Acc: 0.717 Test Loss: 1.006 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.72
model parameter : 183193
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.258999824523926
Epoch: 1, Steps: 18 | Train Loss: 3.254 Vali Loss: 3.257 Vali Acc: 0.047 Test Loss: 3.257 Test Acc: 0.047
Validation loss decreased (inf --> -0.046634).  Saving model ...
Epoch: 2 cost time: 5.941099405288696
Epoch: 2, Steps: 18 | Train Loss: 3.127 Vali Loss: 3.148 Vali Acc: 0.060 Test Loss: 3.148 Test Acc: 0.060
Validation loss decreased (-0.046634 --> -0.059969).  Saving model ...
Epoch: 3 cost time: 6.937572479248047
Epoch: 3, Steps: 18 | Train Loss: 2.888 Vali Loss: 3.019 Vali Acc: 0.163 Test Loss: 3.019 Test Acc: 0.163
Validation loss decreased (-0.059969 --> -0.163303).  Saving model ...
Epoch: 4 cost time: 6.8506457805633545
Epoch: 4, Steps: 18 | Train Loss: 2.597 Vali Loss: 2.882 Vali Acc: 0.223 Test Loss: 2.882 Test Acc: 0.223
Validation loss decreased (-0.163303 --> -0.223305).  Saving model ...
Epoch: 5 cost time: 6.826064109802246
Epoch: 5, Steps: 18 | Train Loss: 2.229 Vali Loss: 2.731 Vali Acc: 0.273 Test Loss: 2.731 Test Acc: 0.273
Validation loss decreased (-0.223305 --> -0.273306).  Saving model ...
Epoch: 6 cost time: 6.583460330963135
Epoch: 6, Steps: 18 | Train Loss: 1.898 Vali Loss: 2.580 Vali Acc: 0.310 Test Loss: 2.580 Test Acc: 0.310
Validation loss decreased (-0.273306 --> -0.309974).  Saving model ...
Epoch: 7 cost time: 6.488687038421631
Epoch: 7, Steps: 18 | Train Loss: 1.540 Vali Loss: 2.434 Vali Acc: 0.330 Test Loss: 2.434 Test Acc: 0.330
Validation loss decreased (-0.309974 --> -0.329976).  Saving model ...
Epoch: 8 cost time: 6.757147312164307
Epoch: 8, Steps: 18 | Train Loss: 1.160 Vali Loss: 2.317 Vali Acc: 0.323 Test Loss: 2.317 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.567929029464722
Epoch: 9, Steps: 18 | Train Loss: 0.847 Vali Loss: 2.185 Vali Acc: 0.380 Test Loss: 2.185 Test Acc: 0.380
Validation loss decreased (-0.329976 --> -0.379978).  Saving model ...
Epoch: 10 cost time: 6.715933561325073
Epoch: 10, Steps: 18 | Train Loss: 0.579 Vali Loss: 2.072 Vali Acc: 0.393 Test Loss: 2.072 Test Acc: 0.393
Validation loss decreased (-0.379978 --> -0.393313).  Saving model ...
Epoch: 11 cost time: 6.039038181304932
Epoch: 11, Steps: 18 | Train Loss: 0.376 Vali Loss: 1.980 Vali Acc: 0.410 Test Loss: 1.980 Test Acc: 0.410
Validation loss decreased (-0.393313 --> -0.409980).  Saving model ...
Epoch: 12 cost time: 5.881072759628296
Epoch: 12, Steps: 18 | Train Loss: 0.215 Vali Loss: 1.887 Vali Acc: 0.457 Test Loss: 1.887 Test Acc: 0.457
Validation loss decreased (-0.409980 --> -0.456648).  Saving model ...
Epoch: 13 cost time: 5.879578351974487
Epoch: 13, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.811 Vali Acc: 0.453 Test Loss: 1.811 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.257741451263428
Epoch: 14, Steps: 18 | Train Loss: 0.099 Vali Loss: 1.764 Vali Acc: 0.483 Test Loss: 1.764 Test Acc: 0.483
Validation loss decreased (-0.456648 --> -0.483316).  Saving model ...
Epoch: 15 cost time: 5.8334832191467285
Epoch: 15, Steps: 18 | Train Loss: 0.073 Vali Loss: 1.708 Vali Acc: 0.487 Test Loss: 1.708 Test Acc: 0.487
Validation loss decreased (-0.483316 --> -0.486650).  Saving model ...
Epoch: 16 cost time: 6.1119678020477295
Epoch: 16, Steps: 18 | Train Loss: 0.056 Vali Loss: 1.689 Vali Acc: 0.487 Test Loss: 1.689 Test Acc: 0.487
Validation loss decreased (-0.486650 --> -0.486650).  Saving model ...
Epoch: 17 cost time: 6.295083522796631
Epoch: 17, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.645 Vali Acc: 0.507 Test Loss: 1.645 Test Acc: 0.507
Validation loss decreased (-0.486650 --> -0.506650).  Saving model ...
Epoch: 18 cost time: 6.490383863449097
Epoch: 18, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.626 Vali Acc: 0.503 Test Loss: 1.626 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.447269678115845
Epoch: 19, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.596 Vali Acc: 0.513 Test Loss: 1.596 Test Acc: 0.513
Validation loss decreased (-0.506650 --> -0.513317).  Saving model ...
Epoch: 20 cost time: 6.188913583755493
Epoch: 20, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.577 Vali Acc: 0.513 Test Loss: 1.577 Test Acc: 0.513
Validation loss decreased (-0.513317 --> -0.513318).  Saving model ...
Epoch: 21 cost time: 6.383434772491455
Epoch: 21, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.540 Vali Acc: 0.527 Test Loss: 1.540 Test Acc: 0.527
Validation loss decreased (-0.513318 --> -0.526651).  Saving model ...
Epoch: 22 cost time: 5.961349964141846
Epoch: 22, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.545 Vali Acc: 0.530 Test Loss: 1.545 Test Acc: 0.530
Validation loss decreased (-0.526651 --> -0.529985).  Saving model ...
Epoch: 23 cost time: 6.143364906311035
Epoch: 23, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.518 Vali Acc: 0.537 Test Loss: 1.518 Test Acc: 0.537
Validation loss decreased (-0.529985 --> -0.536651).  Saving model ...
Epoch: 24 cost time: 6.210434675216675
Epoch: 24, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.504 Vali Acc: 0.540 Test Loss: 1.504 Test Acc: 0.540
Validation loss decreased (-0.536651 --> -0.539985).  Saving model ...
Epoch: 25 cost time: 5.639686584472656
Epoch: 25, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.493 Vali Acc: 0.550 Test Loss: 1.493 Test Acc: 0.550
Validation loss decreased (-0.539985 --> -0.549985).  Saving model ...
Epoch: 26 cost time: 5.3366944789886475
Epoch: 26, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.480 Vali Acc: 0.547 Test Loss: 1.480 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.164856195449829
Epoch: 27, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.470 Vali Acc: 0.540 Test Loss: 1.470 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.328166961669922
Epoch: 28, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.450 Vali Acc: 0.550 Test Loss: 1.450 Test Acc: 0.550
Validation loss decreased (-0.549985 --> -0.549985).  Saving model ...
Epoch: 29 cost time: 6.155782222747803
Epoch: 29, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.438 Vali Acc: 0.567 Test Loss: 1.438 Test Acc: 0.567
Validation loss decreased (-0.549985 --> -0.566652).  Saving model ...
Epoch: 30 cost time: 6.4815380573272705
Epoch: 30, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.430 Vali Acc: 0.573 Test Loss: 1.430 Test Acc: 0.573
Validation loss decreased (-0.566652 --> -0.573319).  Saving model ...
Epoch: 31 cost time: 6.1414830684661865
Epoch: 31, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.430 Vali Acc: 0.563 Test Loss: 1.430 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.263915538787842
Epoch: 32, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.418 Vali Acc: 0.577 Test Loss: 1.418 Test Acc: 0.577
Validation loss decreased (-0.573319 --> -0.576652).  Saving model ...
Epoch: 33 cost time: 6.569890975952148
Epoch: 33, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.410 Vali Acc: 0.573 Test Loss: 1.410 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.028455972671509
Epoch: 34, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.407 Vali Acc: 0.567 Test Loss: 1.407 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.728772163391113
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.399 Vali Acc: 0.570 Test Loss: 1.399 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.984194278717041
Epoch: 36, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.391 Vali Acc: 0.583 Test Loss: 1.391 Test Acc: 0.583
Validation loss decreased (-0.576652 --> -0.583319).  Saving model ...
Epoch: 37 cost time: 6.116936445236206
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.387 Vali Acc: 0.577 Test Loss: 1.387 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.318058967590332
Epoch: 38, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.380 Vali Acc: 0.583 Test Loss: 1.380 Test Acc: 0.583
Validation loss decreased (-0.583319 --> -0.583320).  Saving model ...
Epoch: 39 cost time: 6.443615913391113
Epoch: 39, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.376 Vali Acc: 0.587 Test Loss: 1.376 Test Acc: 0.587
Validation loss decreased (-0.583320 --> -0.586653).  Saving model ...
Epoch: 40 cost time: 6.229429483413696
Epoch: 40, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.367 Vali Acc: 0.590 Test Loss: 1.367 Test Acc: 0.590
Validation loss decreased (-0.586653 --> -0.589986).  Saving model ...
Epoch: 41 cost time: 6.516127109527588
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.357 Vali Acc: 0.607 Test Loss: 1.357 Test Acc: 0.607
Validation loss decreased (-0.589986 --> -0.606653).  Saving model ...
Epoch: 42 cost time: 6.567138195037842
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.351 Vali Acc: 0.600 Test Loss: 1.351 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.13182258605957
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.346 Vali Acc: 0.600 Test Loss: 1.346 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 6.182379245758057
Epoch: 44, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.342 Vali Acc: 0.603 Test Loss: 1.342 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 6.294651746749878
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.338 Vali Acc: 0.603 Test Loss: 1.338 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 6.1056554317474365
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.338 Vali Acc: 0.607 Test Loss: 1.338 Test Acc: 0.607
Validation loss decreased (-0.606653 --> -0.606653).  Saving model ...
Epoch: 47 cost time: 5.7782301902771
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.336 Vali Acc: 0.603 Test Loss: 1.336 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 6.299837589263916
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.330 Vali Acc: 0.603 Test Loss: 1.330 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 6.0536627769470215
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.328 Vali Acc: 0.610 Test Loss: 1.328 Test Acc: 0.610
Validation loss decreased (-0.606653 --> -0.609987).  Saving model ...
Epoch: 50 cost time: 6.326219320297241
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.324 Vali Acc: 0.617 Test Loss: 1.324 Test Acc: 0.617
Validation loss decreased (-0.609987 --> -0.616653).  Saving model ...
Epoch: 51 cost time: 5.983297824859619
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.315 Vali Acc: 0.613 Test Loss: 1.315 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.108611822128296
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.311 Vali Acc: 0.603 Test Loss: 1.311 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.26595401763916
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.307 Vali Acc: 0.610 Test Loss: 1.307 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 5.826451778411865
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.307 Vali Acc: 0.603 Test Loss: 1.307 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 5.645965576171875
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.305 Vali Acc: 0.617 Test Loss: 1.305 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616654).  Saving model ...
Epoch: 56 cost time: 5.585350036621094
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.301 Vali Acc: 0.610 Test Loss: 1.301 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.750576972961426
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.300 Vali Acc: 0.617 Test Loss: 1.300 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616654).  Saving model ...
Epoch: 58 cost time: 5.933774709701538
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.298 Vali Acc: 0.617 Test Loss: 1.298 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616654).  Saving model ...
Epoch: 59 cost time: 6.184242486953735
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.297 Vali Acc: 0.630 Test Loss: 1.297 Test Acc: 0.630
Validation loss decreased (-0.616654 --> -0.629987).  Saving model ...
Epoch: 60 cost time: 6.359001636505127
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.300 Vali Acc: 0.617 Test Loss: 1.300 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.123090505599976
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.299 Vali Acc: 0.617 Test Loss: 1.299 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 6.072280406951904
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.295 Vali Acc: 0.613 Test Loss: 1.295 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 5.926623344421387
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.291 Vali Acc: 0.617 Test Loss: 1.291 Test Acc: 0.617
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 6.501851320266724
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.289 Vali Acc: 0.617 Test Loss: 1.289 Test Acc: 0.617
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 6.18321967124939
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.286 Vali Acc: 0.617 Test Loss: 1.286 Test Acc: 0.617
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 5.944940090179443
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.281 Vali Acc: 0.630 Test Loss: 1.281 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 67 cost time: 6.005260229110718
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.277 Vali Acc: 0.623 Test Loss: 1.277 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 6.203439235687256
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.276 Vali Acc: 0.630 Test Loss: 1.276 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 69 cost time: 5.708847284317017
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.274 Vali Acc: 0.630 Test Loss: 1.274 Test Acc: 0.630
Validation loss decreased (-0.629987 --> -0.629987).  Saving model ...
Epoch: 70 cost time: 6.096693992614746
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.270 Vali Acc: 0.633 Test Loss: 1.270 Test Acc: 0.633
Validation loss decreased (-0.629987 --> -0.633321).  Saving model ...
Epoch: 71 cost time: 6.103955268859863
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.267 Vali Acc: 0.623 Test Loss: 1.267 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.951524496078491
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.266 Vali Acc: 0.627 Test Loss: 1.266 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.026320934295654
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.266 Vali Acc: 0.630 Test Loss: 1.266 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 6.15517783164978
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.265 Vali Acc: 0.637 Test Loss: 1.265 Test Acc: 0.637
Validation loss decreased (-0.633321 --> -0.636654).  Saving model ...
Epoch: 75 cost time: 6.253474712371826
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.265 Vali Acc: 0.643 Test Loss: 1.265 Test Acc: 0.643
Validation loss decreased (-0.636654 --> -0.643321).  Saving model ...
Epoch: 76 cost time: 5.956860303878784
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.263 Vali Acc: 0.637 Test Loss: 1.263 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 6.297984600067139
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.262 Vali Acc: 0.637 Test Loss: 1.262 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 5.825182199478149
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.259 Vali Acc: 0.643 Test Loss: 1.259 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 79 cost time: 5.561937570571899
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.258 Vali Acc: 0.637 Test Loss: 1.258 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 5.94384241104126
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.257 Vali Acc: 0.643 Test Loss: 1.257 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 81 cost time: 6.068353891372681
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.258 Vali Acc: 0.643 Test Loss: 1.258 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 6.259276628494263
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.259 Vali Acc: 0.640 Test Loss: 1.259 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 6.025575399398804
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.259 Vali Acc: 0.630 Test Loss: 1.259 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 6.55547571182251
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.257 Vali Acc: 0.637 Test Loss: 1.257 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 6.43485164642334
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.254 Vali Acc: 0.640 Test Loss: 1.254 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 6.040044069290161
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.254 Vali Acc: 0.640 Test Loss: 1.254 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 5.958629369735718
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.253 Vali Acc: 0.637 Test Loss: 1.253 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 5.761594295501709
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.249 Vali Acc: 0.640 Test Loss: 1.249 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 5.7911152839660645
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.249 Vali Acc: 0.643 Test Loss: 1.249 Test Acc: 0.643
Validation loss decreased (-0.643321 --> -0.643321).  Saving model ...
Epoch: 90 cost time: 5.78104043006897
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.249 Vali Acc: 0.650 Test Loss: 1.249 Test Acc: 0.650
Validation loss decreased (-0.643321 --> -0.649988).  Saving model ...
Epoch: 91 cost time: 5.560012340545654
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.248 Vali Acc: 0.653 Test Loss: 1.248 Test Acc: 0.653
Validation loss decreased (-0.649988 --> -0.653321).  Saving model ...
Epoch: 92 cost time: 5.789221525192261
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.245 Vali Acc: 0.657 Test Loss: 1.245 Test Acc: 0.657
Validation loss decreased (-0.653321 --> -0.656654).  Saving model ...
Epoch: 93 cost time: 6.028010845184326
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.242 Vali Acc: 0.650 Test Loss: 1.242 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 6.038572072982788
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.242 Vali Acc: 0.650 Test Loss: 1.242 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 6.260597467422485
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.243 Vali Acc: 0.653 Test Loss: 1.243 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 5.860877513885498
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.247 Vali Acc: 0.647 Test Loss: 1.247 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 6.32559609413147
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.249 Vali Acc: 0.643 Test Loss: 1.249 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 5.758797645568848
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.245 Vali Acc: 0.650 Test Loss: 1.245 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 6.163858413696289
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.244 Vali Acc: 0.657 Test Loss: 1.244 Test Acc: 0.657
Validation loss decreased (-0.656654 --> -0.656654).  Saving model ...
Epoch: 100 cost time: 6.039669036865234
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.653 Test Loss: 1.241 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.6566666666666666
model parameter : 183193
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.826986789703369
Epoch: 1, Steps: 18 | Train Loss: 3.224 Vali Loss: 3.244 Vali Acc: 0.053 Test Loss: 3.244 Test Acc: 0.053
Validation loss decreased (inf --> -0.053301).  Saving model ...
Epoch: 2 cost time: 6.646793365478516
Epoch: 2, Steps: 18 | Train Loss: 3.115 Vali Loss: 3.160 Vali Acc: 0.077 Test Loss: 3.160 Test Acc: 0.077
Validation loss decreased (-0.053301 --> -0.076635).  Saving model ...
Epoch: 3 cost time: 6.717214107513428
Epoch: 3, Steps: 18 | Train Loss: 2.923 Vali Loss: 3.071 Vali Acc: 0.107 Test Loss: 3.071 Test Acc: 0.107
Validation loss decreased (-0.076635 --> -0.106636).  Saving model ...
Epoch: 4 cost time: 6.580645799636841
Epoch: 4, Steps: 18 | Train Loss: 2.646 Vali Loss: 2.979 Vali Acc: 0.183 Test Loss: 2.979 Test Acc: 0.183
Validation loss decreased (-0.106636 --> -0.183304).  Saving model ...
Epoch: 5 cost time: 6.715003728866577
Epoch: 5, Steps: 18 | Train Loss: 2.302 Vali Loss: 2.882 Vali Acc: 0.180 Test Loss: 2.882 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.334495306015015
Epoch: 6, Steps: 18 | Train Loss: 2.010 Vali Loss: 2.775 Vali Acc: 0.233 Test Loss: 2.775 Test Acc: 0.233
Validation loss decreased (-0.183304 --> -0.233306).  Saving model ...
Epoch: 7 cost time: 6.672647953033447
Epoch: 7, Steps: 18 | Train Loss: 1.668 Vali Loss: 2.671 Vali Acc: 0.280 Test Loss: 2.671 Test Acc: 0.280
Validation loss decreased (-0.233306 --> -0.279973).  Saving model ...
Epoch: 8 cost time: 6.263132333755493
Epoch: 8, Steps: 18 | Train Loss: 1.300 Vali Loss: 2.598 Vali Acc: 0.257 Test Loss: 2.598 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.175590515136719
Epoch: 9, Steps: 18 | Train Loss: 0.986 Vali Loss: 2.510 Vali Acc: 0.280 Test Loss: 2.510 Test Acc: 0.280
Validation loss decreased (-0.279973 --> -0.279975).  Saving model ...
Epoch: 10 cost time: 6.7662248611450195
Epoch: 10, Steps: 18 | Train Loss: 0.737 Vali Loss: 2.433 Vali Acc: 0.320 Test Loss: 2.433 Test Acc: 0.320
Validation loss decreased (-0.279975 --> -0.319976).  Saving model ...
Epoch: 11 cost time: 6.881464719772339
Epoch: 11, Steps: 18 | Train Loss: 0.483 Vali Loss: 2.369 Vali Acc: 0.303 Test Loss: 2.369 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.702258348464966
Epoch: 12, Steps: 18 | Train Loss: 0.304 Vali Loss: 2.285 Vali Acc: 0.343 Test Loss: 2.285 Test Acc: 0.343
Validation loss decreased (-0.319976 --> -0.343310).  Saving model ...
Epoch: 13 cost time: 6.66857647895813
Epoch: 13, Steps: 18 | Train Loss: 0.200 Vali Loss: 2.219 Vali Acc: 0.367 Test Loss: 2.219 Test Acc: 0.367
Validation loss decreased (-0.343310 --> -0.366644).  Saving model ...
Epoch: 14 cost time: 6.764361381530762
Epoch: 14, Steps: 18 | Train Loss: 0.135 Vali Loss: 2.175 Vali Acc: 0.383 Test Loss: 2.175 Test Acc: 0.383
Validation loss decreased (-0.366644 --> -0.383312).  Saving model ...
Epoch: 15 cost time: 6.327159881591797
Epoch: 15, Steps: 18 | Train Loss: 0.095 Vali Loss: 2.131 Vali Acc: 0.397 Test Loss: 2.131 Test Acc: 0.397
Validation loss decreased (-0.383312 --> -0.396645).  Saving model ...
Epoch: 16 cost time: 5.760660409927368
Epoch: 16, Steps: 18 | Train Loss: 0.070 Vali Loss: 2.097 Vali Acc: 0.390 Test Loss: 2.097 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.751841306686401
Epoch: 17, Steps: 18 | Train Loss: 0.058 Vali Loss: 2.051 Vali Acc: 0.420 Test Loss: 2.051 Test Acc: 0.420
Validation loss decreased (-0.396645 --> -0.419979).  Saving model ...
Epoch: 18 cost time: 6.167527437210083
Epoch: 18, Steps: 18 | Train Loss: 0.047 Vali Loss: 2.031 Vali Acc: 0.410 Test Loss: 2.031 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.225096940994263
Epoch: 19, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.998 Vali Acc: 0.413 Test Loss: 1.998 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.947927474975586
Epoch: 20, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.977 Vali Acc: 0.427 Test Loss: 1.977 Test Acc: 0.427
Validation loss decreased (-0.419979 --> -0.426647).  Saving model ...
Epoch: 21 cost time: 6.30185341835022
Epoch: 21, Steps: 18 | Train Loss: 0.033 Vali Loss: 1.938 Vali Acc: 0.450 Test Loss: 1.938 Test Acc: 0.450
Validation loss decreased (-0.426647 --> -0.449981).  Saving model ...
Epoch: 22 cost time: 6.625237226486206
Epoch: 22, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.941 Vali Acc: 0.433 Test Loss: 1.941 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.77069091796875
Epoch: 23, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.917 Vali Acc: 0.450 Test Loss: 1.917 Test Acc: 0.450
Validation loss decreased (-0.449981 --> -0.449981).  Saving model ...
Epoch: 24 cost time: 6.889652967453003
Epoch: 24, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.893 Vali Acc: 0.450 Test Loss: 1.893 Test Acc: 0.450
Validation loss decreased (-0.449981 --> -0.449981).  Saving model ...
Epoch: 25 cost time: 6.199024677276611
Epoch: 25, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.883 Vali Acc: 0.450 Test Loss: 1.883 Test Acc: 0.450
Validation loss decreased (-0.449981 --> -0.449981).  Saving model ...
Epoch: 26 cost time: 6.226714372634888
Epoch: 26, Steps: 18 | Train Loss: 0.016 Vali Loss: 1.870 Vali Acc: 0.450 Test Loss: 1.870 Test Acc: 0.450
Validation loss decreased (-0.449981 --> -0.449981).  Saving model ...
Epoch: 27 cost time: 5.86836051940918
Epoch: 27, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.854 Vali Acc: 0.450 Test Loss: 1.854 Test Acc: 0.450
Validation loss decreased (-0.449981 --> -0.449981).  Saving model ...
Epoch: 28 cost time: 6.31216835975647
Epoch: 28, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.829 Vali Acc: 0.460 Test Loss: 1.829 Test Acc: 0.460
Validation loss decreased (-0.449981 --> -0.459982).  Saving model ...
Epoch: 29 cost time: 5.658017635345459
Epoch: 29, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.816 Vali Acc: 0.473 Test Loss: 1.816 Test Acc: 0.473
Validation loss decreased (-0.459982 --> -0.473315).  Saving model ...
Epoch: 30 cost time: 5.9643332958221436
Epoch: 30, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.803 Vali Acc: 0.477 Test Loss: 1.803 Test Acc: 0.477
Validation loss decreased (-0.473315 --> -0.476649).  Saving model ...
Epoch: 31 cost time: 6.344268560409546
Epoch: 31, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.790 Vali Acc: 0.483 Test Loss: 1.790 Test Acc: 0.483
Validation loss decreased (-0.476649 --> -0.483315).  Saving model ...
Epoch: 32 cost time: 6.725934267044067
Epoch: 32, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.778 Vali Acc: 0.487 Test Loss: 1.778 Test Acc: 0.487
Validation loss decreased (-0.483315 --> -0.486649).  Saving model ...
Epoch: 33 cost time: 6.418592691421509
Epoch: 33, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.774 Vali Acc: 0.487 Test Loss: 1.774 Test Acc: 0.487
Validation loss decreased (-0.486649 --> -0.486649).  Saving model ...
Epoch: 34 cost time: 6.505146503448486
Epoch: 34, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.776 Vali Acc: 0.483 Test Loss: 1.776 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.625319957733154
Epoch: 35, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.765 Vali Acc: 0.490 Test Loss: 1.765 Test Acc: 0.490
Validation loss decreased (-0.486649 --> -0.489982).  Saving model ...
Epoch: 36 cost time: 6.26750111579895
Epoch: 36, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.754 Vali Acc: 0.493 Test Loss: 1.754 Test Acc: 0.493
Validation loss decreased (-0.489982 --> -0.493316).  Saving model ...
Epoch: 37 cost time: 6.461013317108154
Epoch: 37, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.748 Vali Acc: 0.500 Test Loss: 1.748 Test Acc: 0.500
Validation loss decreased (-0.493316 --> -0.499983).  Saving model ...
Epoch: 38 cost time: 6.195407867431641
Epoch: 38, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.740 Vali Acc: 0.503 Test Loss: 1.740 Test Acc: 0.503
Validation loss decreased (-0.499983 --> -0.503316).  Saving model ...
Epoch: 39 cost time: 6.091103553771973
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.736 Vali Acc: 0.500 Test Loss: 1.736 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.5840771198272705
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.721 Vali Acc: 0.507 Test Loss: 1.721 Test Acc: 0.507
Validation loss decreased (-0.503316 --> -0.506649).  Saving model ...
Epoch: 41 cost time: 6.911302089691162
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.704 Vali Acc: 0.517 Test Loss: 1.704 Test Acc: 0.517
Validation loss decreased (-0.506649 --> -0.516650).  Saving model ...
Epoch: 42 cost time: 6.628140926361084
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.697 Vali Acc: 0.520 Test Loss: 1.697 Test Acc: 0.520
Validation loss decreased (-0.516650 --> -0.519983).  Saving model ...
Epoch: 43 cost time: 7.111652851104736
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.692 Vali Acc: 0.517 Test Loss: 1.692 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.266783714294434
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.685 Vali Acc: 0.530 Test Loss: 1.685 Test Acc: 0.530
Validation loss decreased (-0.519983 --> -0.529983).  Saving model ...
Epoch: 45 cost time: 5.894718408584595
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.679 Vali Acc: 0.527 Test Loss: 1.679 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.550037145614624
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.679 Vali Acc: 0.530 Test Loss: 1.679 Test Acc: 0.530
Validation loss decreased (-0.529983 --> -0.529983).  Saving model ...
Epoch: 47 cost time: 6.3239874839782715
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.671 Vali Acc: 0.527 Test Loss: 1.671 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.749762058258057
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.661 Vali Acc: 0.527 Test Loss: 1.661 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 6.332448720932007
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.659 Vali Acc: 0.523 Test Loss: 1.659 Test Acc: 0.523
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 6.516246795654297
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.660 Vali Acc: 0.527 Test Loss: 1.660 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 7.072978734970093
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.659 Vali Acc: 0.530 Test Loss: 1.659 Test Acc: 0.530
Validation loss decreased (-0.529983 --> -0.529983).  Saving model ...
Epoch: 52 cost time: 6.621091365814209
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.654 Vali Acc: 0.537 Test Loss: 1.654 Test Acc: 0.537
Validation loss decreased (-0.529983 --> -0.536650).  Saving model ...
Epoch: 53 cost time: 6.45242714881897
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.648 Vali Acc: 0.530 Test Loss: 1.648 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.881604909896851
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.644 Vali Acc: 0.533 Test Loss: 1.644 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.366285085678101
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.641 Vali Acc: 0.533 Test Loss: 1.641 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 6.473023414611816
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.636 Vali Acc: 0.533 Test Loss: 1.636 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 5.6219353675842285
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.632 Vali Acc: 0.533 Test Loss: 1.632 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 6.554168462753296
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.629 Vali Acc: 0.533 Test Loss: 1.629 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 6.588090181350708
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.620 Vali Acc: 0.540 Test Loss: 1.620 Test Acc: 0.540
Validation loss decreased (-0.536650 --> -0.539984).  Saving model ...
Epoch: 60 cost time: 6.796411752700806
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.620 Vali Acc: 0.537 Test Loss: 1.620 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.301718473434448
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.613 Vali Acc: 0.540 Test Loss: 1.613 Test Acc: 0.540
Validation loss decreased (-0.539984 --> -0.539984).  Saving model ...
Epoch: 62 cost time: 6.371581077575684
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.612 Vali Acc: 0.537 Test Loss: 1.612 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 6.1899189949035645
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.607 Vali Acc: 0.537 Test Loss: 1.607 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 6.339209318161011
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.605 Vali Acc: 0.540 Test Loss: 1.605 Test Acc: 0.540
Validation loss decreased (-0.539984 --> -0.539984).  Saving model ...
Epoch: 65 cost time: 6.140525579452515
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.607 Vali Acc: 0.547 Test Loss: 1.607 Test Acc: 0.547
Validation loss decreased (-0.539984 --> -0.546651).  Saving model ...
Epoch: 66 cost time: 6.336304664611816
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.607 Vali Acc: 0.540 Test Loss: 1.607 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 6.29407262802124
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.608 Vali Acc: 0.547 Test Loss: 1.608 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 5.882647752761841
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.605 Vali Acc: 0.543 Test Loss: 1.605 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 6.560868978500366
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.543 Test Loss: 1.601 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 6.628664493560791
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.550 Test Loss: 1.600 Test Acc: 0.550
Validation loss decreased (-0.546651 --> -0.549984).  Saving model ...
Epoch: 71 cost time: 6.51790452003479
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.597 Vali Acc: 0.550 Test Loss: 1.597 Test Acc: 0.550
Validation loss decreased (-0.549984 --> -0.549984).  Saving model ...
Epoch: 72 cost time: 6.650252342224121
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.593 Vali Acc: 0.553 Test Loss: 1.593 Test Acc: 0.553
Validation loss decreased (-0.549984 --> -0.553317).  Saving model ...
Epoch: 73 cost time: 6.461646318435669
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.590 Vali Acc: 0.557 Test Loss: 1.590 Test Acc: 0.557
Validation loss decreased (-0.553317 --> -0.556651).  Saving model ...
Epoch: 74 cost time: 6.447636842727661
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.586 Vali Acc: 0.560 Test Loss: 1.586 Test Acc: 0.560
Validation loss decreased (-0.556651 --> -0.559984).  Saving model ...
Epoch: 75 cost time: 6.35649847984314
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.585 Vali Acc: 0.557 Test Loss: 1.585 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 6.230254411697388
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.581 Vali Acc: 0.553 Test Loss: 1.581 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 6.325009346008301
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.580 Vali Acc: 0.563 Test Loss: 1.580 Test Acc: 0.563
Validation loss decreased (-0.559984 --> -0.563318).  Saving model ...
Epoch: 78 cost time: 6.295135259628296
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.560 Test Loss: 1.576 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 6.3560826778411865
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.577 Vali Acc: 0.557 Test Loss: 1.577 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 6.44097638130188
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.573 Vali Acc: 0.557 Test Loss: 1.573 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 6.280340909957886
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.569 Vali Acc: 0.563 Test Loss: 1.569 Test Acc: 0.563
Validation loss decreased (-0.563318 --> -0.563318).  Saving model ...
Epoch: 82 cost time: 6.624196767807007
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.560 Test Loss: 1.566 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 5.795887470245361
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.567 Vali Acc: 0.563 Test Loss: 1.567 Test Acc: 0.563
Validation loss decreased (-0.563318 --> -0.563318).  Saving model ...
Epoch: 84 cost time: 6.231478691101074
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.569 Vali Acc: 0.547 Test Loss: 1.569 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 6.353445529937744
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.550 Test Loss: 1.566 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 6.540090799331665
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.565 Vali Acc: 0.550 Test Loss: 1.565 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 6.228978633880615
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.560 Test Loss: 1.566 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 5.9789135456085205
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.564 Vali Acc: 0.560 Test Loss: 1.564 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 6.037818431854248
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.563 Vali Acc: 0.557 Test Loss: 1.563 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 5.778599262237549
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.559 Vali Acc: 0.560 Test Loss: 1.559 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 6.540740251541138
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.556 Vali Acc: 0.567 Test Loss: 1.556 Test Acc: 0.567
Validation loss decreased (-0.563318 --> -0.566651).  Saving model ...
Epoch: 92 cost time: 6.396349191665649
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.567 Test Loss: 1.551 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 93 cost time: 6.659047603607178
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.567 Test Loss: 1.551 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 94 cost time: 6.541821002960205
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.550 Vali Acc: 0.570 Test Loss: 1.550 Test Acc: 0.570
Validation loss decreased (-0.566651 --> -0.569984).  Saving model ...
Epoch: 95 cost time: 6.897720813751221
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.570 Test Loss: 1.551 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 6.719933986663818
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.570 Test Loss: 1.551 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 6.485222816467285
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.550 Vali Acc: 0.570 Test Loss: 1.550 Test Acc: 0.570
Validation loss decreased (-0.569984 --> -0.569985).  Saving model ...
Epoch: 98 cost time: 6.013906955718994
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.549 Vali Acc: 0.573 Test Loss: 1.549 Test Acc: 0.573
Validation loss decreased (-0.569985 --> -0.573318).  Saving model ...
Epoch: 99 cost time: 6.081361770629883
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.546 Vali Acc: 0.573 Test Loss: 1.546 Test Acc: 0.573
Validation loss decreased (-0.573318 --> -0.573318).  Saving model ...
Epoch: 100 cost time: 6.116097450256348
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.545 Vali Acc: 0.567 Test Loss: 1.545 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5733333333333334
model parameter : 183193
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.854886054992676
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.283 Vali Acc: 0.050 Test Loss: 3.283 Test Acc: 0.050
Validation loss decreased (inf --> -0.049967).  Saving model ...
Epoch: 2 cost time: 5.849289417266846
Epoch: 2, Steps: 18 | Train Loss: 3.145 Vali Loss: 3.234 Vali Acc: 0.043 Test Loss: 3.234 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.025159597396851
Epoch: 3, Steps: 18 | Train Loss: 2.965 Vali Loss: 3.179 Vali Acc: 0.060 Test Loss: 3.179 Test Acc: 0.060
Validation loss decreased (-0.049967 --> -0.059968).  Saving model ...
Epoch: 4 cost time: 6.2062859535217285
Epoch: 4, Steps: 18 | Train Loss: 2.681 Vali Loss: 3.117 Vali Acc: 0.077 Test Loss: 3.117 Test Acc: 0.077
Validation loss decreased (-0.059968 --> -0.076635).  Saving model ...
Epoch: 5 cost time: 6.440071105957031
Epoch: 5, Steps: 18 | Train Loss: 2.385 Vali Loss: 3.051 Vali Acc: 0.097 Test Loss: 3.051 Test Acc: 0.097
Validation loss decreased (-0.076635 --> -0.096636).  Saving model ...
Epoch: 6 cost time: 5.948129177093506
Epoch: 6, Steps: 18 | Train Loss: 2.097 Vali Loss: 2.987 Vali Acc: 0.123 Test Loss: 2.987 Test Acc: 0.123
Validation loss decreased (-0.096636 --> -0.123303).  Saving model ...
Epoch: 7 cost time: 5.978328227996826
Epoch: 7, Steps: 18 | Train Loss: 1.791 Vali Loss: 2.921 Vali Acc: 0.120 Test Loss: 2.921 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.078500032424927
Epoch: 8, Steps: 18 | Train Loss: 1.475 Vali Loss: 2.868 Vali Acc: 0.133 Test Loss: 2.868 Test Acc: 0.133
Validation loss decreased (-0.123303 --> -0.133305).  Saving model ...
Epoch: 9 cost time: 6.177554607391357
Epoch: 9, Steps: 18 | Train Loss: 1.179 Vali Loss: 2.799 Vali Acc: 0.147 Test Loss: 2.799 Test Acc: 0.147
Validation loss decreased (-0.133305 --> -0.146639).  Saving model ...
Epoch: 10 cost time: 6.149308204650879
Epoch: 10, Steps: 18 | Train Loss: 0.916 Vali Loss: 2.738 Vali Acc: 0.183 Test Loss: 2.738 Test Acc: 0.183
Validation loss decreased (-0.146639 --> -0.183306).  Saving model ...
Epoch: 11 cost time: 6.003425359725952
Epoch: 11, Steps: 18 | Train Loss: 0.631 Vali Loss: 2.701 Vali Acc: 0.187 Test Loss: 2.701 Test Acc: 0.187
Validation loss decreased (-0.183306 --> -0.186640).  Saving model ...
Epoch: 12 cost time: 5.858027696609497
Epoch: 12, Steps: 18 | Train Loss: 0.421 Vali Loss: 2.629 Vali Acc: 0.187 Test Loss: 2.629 Test Acc: 0.187
Validation loss decreased (-0.186640 --> -0.186640).  Saving model ...
Epoch: 13 cost time: 6.548910617828369
Epoch: 13, Steps: 18 | Train Loss: 0.277 Vali Loss: 2.569 Vali Acc: 0.203 Test Loss: 2.569 Test Acc: 0.203
Validation loss decreased (-0.186640 --> -0.203308).  Saving model ...
Epoch: 14 cost time: 6.663205146789551
Epoch: 14, Steps: 18 | Train Loss: 0.195 Vali Loss: 2.486 Vali Acc: 0.243 Test Loss: 2.486 Test Acc: 0.243
Validation loss decreased (-0.203308 --> -0.243308).  Saving model ...
Epoch: 15 cost time: 6.554116725921631
Epoch: 15, Steps: 18 | Train Loss: 0.143 Vali Loss: 2.445 Vali Acc: 0.250 Test Loss: 2.445 Test Acc: 0.250
Validation loss decreased (-0.243308 --> -0.249976).  Saving model ...
Epoch: 16 cost time: 6.7086968421936035
Epoch: 16, Steps: 18 | Train Loss: 0.112 Vali Loss: 2.391 Vali Acc: 0.280 Test Loss: 2.391 Test Acc: 0.280
Validation loss decreased (-0.249976 --> -0.279976).  Saving model ...
Epoch: 17 cost time: 6.2126781940460205
Epoch: 17, Steps: 18 | Train Loss: 0.078 Vali Loss: 2.363 Vali Acc: 0.273 Test Loss: 2.363 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.911253929138184
Epoch: 18, Steps: 18 | Train Loss: 0.063 Vali Loss: 2.286 Vali Acc: 0.297 Test Loss: 2.286 Test Acc: 0.297
Validation loss decreased (-0.279976 --> -0.296644).  Saving model ...
Epoch: 19 cost time: 5.840384244918823
Epoch: 19, Steps: 18 | Train Loss: 0.055 Vali Loss: 2.256 Vali Acc: 0.300 Test Loss: 2.256 Test Acc: 0.300
Validation loss decreased (-0.296644 --> -0.299977).  Saving model ...
Epoch: 20 cost time: 5.633984804153442
Epoch: 20, Steps: 18 | Train Loss: 0.045 Vali Loss: 2.234 Vali Acc: 0.310 Test Loss: 2.234 Test Acc: 0.310
Validation loss decreased (-0.299977 --> -0.309978).  Saving model ...
Epoch: 21 cost time: 6.354222059249878
Epoch: 21, Steps: 18 | Train Loss: 0.040 Vali Loss: 2.192 Vali Acc: 0.343 Test Loss: 2.192 Test Acc: 0.343
Validation loss decreased (-0.309978 --> -0.343311).  Saving model ...
Epoch: 22 cost time: 6.523756980895996
Epoch: 22, Steps: 18 | Train Loss: 0.034 Vali Loss: 2.160 Vali Acc: 0.343 Test Loss: 2.160 Test Acc: 0.343
Validation loss decreased (-0.343311 --> -0.343312).  Saving model ...
Epoch: 23 cost time: 6.641538381576538
Epoch: 23, Steps: 18 | Train Loss: 0.028 Vali Loss: 2.138 Vali Acc: 0.350 Test Loss: 2.138 Test Acc: 0.350
Validation loss decreased (-0.343312 --> -0.349979).  Saving model ...
Epoch: 24 cost time: 6.430131196975708
Epoch: 24, Steps: 18 | Train Loss: 0.027 Vali Loss: 2.096 Vali Acc: 0.373 Test Loss: 2.096 Test Acc: 0.373
Validation loss decreased (-0.349979 --> -0.373312).  Saving model ...
Epoch: 25 cost time: 6.752936601638794
Epoch: 25, Steps: 18 | Train Loss: 0.025 Vali Loss: 2.073 Vali Acc: 0.373 Test Loss: 2.073 Test Acc: 0.373
Validation loss decreased (-0.373312 --> -0.373313).  Saving model ...
Epoch: 26 cost time: 6.692575216293335
Epoch: 26, Steps: 18 | Train Loss: 0.020 Vali Loss: 2.053 Vali Acc: 0.393 Test Loss: 2.053 Test Acc: 0.393
Validation loss decreased (-0.373313 --> -0.393313).  Saving model ...
Epoch: 27 cost time: 6.322474718093872
Epoch: 27, Steps: 18 | Train Loss: 0.018 Vali Loss: 2.027 Vali Acc: 0.397 Test Loss: 2.027 Test Acc: 0.397
Validation loss decreased (-0.393313 --> -0.396646).  Saving model ...
Epoch: 28 cost time: 5.8582704067230225
Epoch: 28, Steps: 18 | Train Loss: 0.015 Vali Loss: 2.007 Vali Acc: 0.417 Test Loss: 2.007 Test Acc: 0.417
Validation loss decreased (-0.396646 --> -0.416647).  Saving model ...
Epoch: 29 cost time: 6.152992010116577
Epoch: 29, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.991 Vali Acc: 0.410 Test Loss: 1.991 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.075318098068237
Epoch: 30, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.972 Vali Acc: 0.407 Test Loss: 1.972 Test Acc: 0.407
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.503180980682373
Epoch: 31, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.954 Vali Acc: 0.413 Test Loss: 1.954 Test Acc: 0.413
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.987627983093262
Epoch: 32, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.941 Vali Acc: 0.423 Test Loss: 1.941 Test Acc: 0.423
Validation loss decreased (-0.416647 --> -0.423314).  Saving model ...
Epoch: 33 cost time: 6.207959890365601
Epoch: 33, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.923 Vali Acc: 0.430 Test Loss: 1.923 Test Acc: 0.430
Validation loss decreased (-0.423314 --> -0.429981).  Saving model ...
Epoch: 34 cost time: 6.239842891693115
Epoch: 34, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.908 Vali Acc: 0.443 Test Loss: 1.908 Test Acc: 0.443
Validation loss decreased (-0.429981 --> -0.443314).  Saving model ...
Epoch: 35 cost time: 6.209050893783569
Epoch: 35, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.898 Vali Acc: 0.450 Test Loss: 1.898 Test Acc: 0.450
Validation loss decreased (-0.443314 --> -0.449981).  Saving model ...
Epoch: 36 cost time: 6.474111318588257
Epoch: 36, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.883 Vali Acc: 0.457 Test Loss: 1.883 Test Acc: 0.457
Validation loss decreased (-0.449981 --> -0.456648).  Saving model ...
Epoch: 37 cost time: 6.3727498054504395
Epoch: 37, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.875 Vali Acc: 0.457 Test Loss: 1.875 Test Acc: 0.457
Validation loss decreased (-0.456648 --> -0.456648).  Saving model ...
Epoch: 38 cost time: 6.674823760986328
Epoch: 38, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.865 Vali Acc: 0.453 Test Loss: 1.865 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.078065395355225
Epoch: 39, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.861 Vali Acc: 0.457 Test Loss: 1.861 Test Acc: 0.457
Validation loss decreased (-0.456648 --> -0.456648).  Saving model ...
Epoch: 40 cost time: 6.361737966537476
Epoch: 40, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.848 Vali Acc: 0.467 Test Loss: 1.848 Test Acc: 0.467
Validation loss decreased (-0.456648 --> -0.466648).  Saving model ...
Epoch: 41 cost time: 6.287586212158203
Epoch: 41, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.830 Vali Acc: 0.473 Test Loss: 1.830 Test Acc: 0.473
Validation loss decreased (-0.466648 --> -0.473315).  Saving model ...
Epoch: 42 cost time: 5.645879507064819
Epoch: 42, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.823 Vali Acc: 0.487 Test Loss: 1.823 Test Acc: 0.487
Validation loss decreased (-0.473315 --> -0.486648).  Saving model ...
Epoch: 43 cost time: 6.433072090148926
Epoch: 43, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.821 Vali Acc: 0.477 Test Loss: 1.821 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.040262937545776
Epoch: 44, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.812 Vali Acc: 0.480 Test Loss: 1.812 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 6.04351019859314
Epoch: 45, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.806 Vali Acc: 0.473 Test Loss: 1.806 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 6.099755764007568
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.797 Vali Acc: 0.487 Test Loss: 1.797 Test Acc: 0.487
Validation loss decreased (-0.486648 --> -0.486649).  Saving model ...
Epoch: 47 cost time: 5.827037572860718
Epoch: 47, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.787 Vali Acc: 0.497 Test Loss: 1.787 Test Acc: 0.497
Validation loss decreased (-0.486649 --> -0.496649).  Saving model ...
Epoch: 48 cost time: 5.9147560596466064
Epoch: 48, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.786 Vali Acc: 0.503 Test Loss: 1.786 Test Acc: 0.503
Validation loss decreased (-0.496649 --> -0.503315).  Saving model ...
Epoch: 49 cost time: 5.952620267868042
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.768 Vali Acc: 0.500 Test Loss: 1.768 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.72182035446167
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.766 Vali Acc: 0.507 Test Loss: 1.766 Test Acc: 0.507
Validation loss decreased (-0.503315 --> -0.506649).  Saving model ...
Epoch: 51 cost time: 6.696238040924072
Epoch: 51, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.762 Vali Acc: 0.510 Test Loss: 1.762 Test Acc: 0.510
Validation loss decreased (-0.506649 --> -0.509982).  Saving model ...
Epoch: 52 cost time: 6.389373302459717
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.765 Vali Acc: 0.523 Test Loss: 1.765 Test Acc: 0.523
Validation loss decreased (-0.509982 --> -0.523316).  Saving model ...
Epoch: 53 cost time: 6.220223903656006
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.759 Vali Acc: 0.520 Test Loss: 1.759 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.346783399581909
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.765 Vali Acc: 0.520 Test Loss: 1.765 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.146721839904785
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.760 Vali Acc: 0.513 Test Loss: 1.760 Test Acc: 0.513
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 6.078562021255493
Epoch: 56, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.749 Vali Acc: 0.507 Test Loss: 1.749 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 5.9654457569122314
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.738 Vali Acc: 0.507 Test Loss: 1.738 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 6.074584484100342
Epoch: 58, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.735 Vali Acc: 0.510 Test Loss: 1.735 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 6.393355131149292
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.730 Vali Acc: 0.530 Test Loss: 1.730 Test Acc: 0.530
Validation loss decreased (-0.523316 --> -0.529983).  Saving model ...
Epoch: 60 cost time: 6.683408498764038
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.726 Vali Acc: 0.530 Test Loss: 1.726 Test Acc: 0.530
Validation loss decreased (-0.529983 --> -0.529983).  Saving model ...
Epoch: 61 cost time: 6.433654069900513
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.719 Vali Acc: 0.537 Test Loss: 1.719 Test Acc: 0.537
Validation loss decreased (-0.529983 --> -0.536649).  Saving model ...
Epoch: 62 cost time: 6.521512508392334
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.711 Vali Acc: 0.540 Test Loss: 1.711 Test Acc: 0.540
Validation loss decreased (-0.536649 --> -0.539983).  Saving model ...
Epoch: 63 cost time: 5.856310606002808
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.704 Vali Acc: 0.530 Test Loss: 1.704 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 6.358993291854858
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.701 Vali Acc: 0.530 Test Loss: 1.701 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 5.2952563762664795
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.702 Vali Acc: 0.540 Test Loss: 1.702 Test Acc: 0.540
Validation loss decreased (-0.539983 --> -0.539983).  Saving model ...
Epoch: 66 cost time: 6.136060953140259
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.696 Vali Acc: 0.540 Test Loss: 1.696 Test Acc: 0.540
Validation loss decreased (-0.539983 --> -0.539983).  Saving model ...
Epoch: 67 cost time: 5.817201375961304
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.689 Vali Acc: 0.537 Test Loss: 1.689 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 5.968194484710693
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.687 Vali Acc: 0.547 Test Loss: 1.687 Test Acc: 0.547
Validation loss decreased (-0.539983 --> -0.546650).  Saving model ...
Epoch: 69 cost time: 5.806411027908325
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.684 Vali Acc: 0.543 Test Loss: 1.684 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 5.715697765350342
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.681 Vali Acc: 0.530 Test Loss: 1.681 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 5.7079176902771
Epoch: 71, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.679 Vali Acc: 0.527 Test Loss: 1.679 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 5.958958387374878
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.675 Vali Acc: 0.537 Test Loss: 1.675 Test Acc: 0.537
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 6.126060247421265
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.675 Vali Acc: 0.537 Test Loss: 1.675 Test Acc: 0.537
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 6.268561124801636
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.670 Vali Acc: 0.547 Test Loss: 1.670 Test Acc: 0.547
Validation loss decreased (-0.546650 --> -0.546650).  Saving model ...
Epoch: 75 cost time: 6.1066343784332275
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.670 Vali Acc: 0.550 Test Loss: 1.670 Test Acc: 0.550
Validation loss decreased (-0.546650 --> -0.549983).  Saving model ...
Epoch: 76 cost time: 5.749830722808838
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.669 Vali Acc: 0.550 Test Loss: 1.669 Test Acc: 0.550
Validation loss decreased (-0.549983 --> -0.549983).  Saving model ...
Epoch: 77 cost time: 6.066800117492676
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.668 Vali Acc: 0.550 Test Loss: 1.668 Test Acc: 0.550
Validation loss decreased (-0.549983 --> -0.549983).  Saving model ...
Epoch: 78 cost time: 5.904711484909058
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.668 Vali Acc: 0.547 Test Loss: 1.668 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 6.042130947113037
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.667 Vali Acc: 0.550 Test Loss: 1.667 Test Acc: 0.550
Validation loss decreased (-0.549983 --> -0.549983).  Saving model ...
Epoch: 80 cost time: 5.956028938293457
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.664 Vali Acc: 0.553 Test Loss: 1.664 Test Acc: 0.553
Validation loss decreased (-0.549983 --> -0.553317).  Saving model ...
Epoch: 81 cost time: 6.15368127822876
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.657 Vali Acc: 0.547 Test Loss: 1.657 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 6.504323244094849
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.652 Vali Acc: 0.547 Test Loss: 1.652 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 6.48111367225647
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.653 Vali Acc: 0.543 Test Loss: 1.653 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 6.296873331069946
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.653 Vali Acc: 0.540 Test Loss: 1.653 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 6.299584150314331
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.652 Vali Acc: 0.537 Test Loss: 1.652 Test Acc: 0.537
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 6.162911891937256
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.644 Vali Acc: 0.543 Test Loss: 1.644 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 5.6622700691223145
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.643 Vali Acc: 0.543 Test Loss: 1.643 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 6.134969711303711
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.553 Test Loss: 1.641 Test Acc: 0.553
Validation loss decreased (-0.553317 --> -0.553317).  Saving model ...
Epoch: 89 cost time: 5.9502716064453125
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.557 Test Loss: 1.641 Test Acc: 0.557
Validation loss decreased (-0.553317 --> -0.556650).  Saving model ...
Epoch: 90 cost time: 5.207885265350342
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.638 Vali Acc: 0.557 Test Loss: 1.638 Test Acc: 0.557
Validation loss decreased (-0.556650 --> -0.556650).  Saving model ...
Epoch: 91 cost time: 6.719788074493408
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.637 Vali Acc: 0.560 Test Loss: 1.637 Test Acc: 0.560
Validation loss decreased (-0.556650 --> -0.559984).  Saving model ...
Epoch: 92 cost time: 6.342456817626953
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.635 Vali Acc: 0.553 Test Loss: 1.635 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 6.269384860992432
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.635 Vali Acc: 0.557 Test Loss: 1.635 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 6.481455326080322
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.634 Vali Acc: 0.557 Test Loss: 1.634 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 6.136412858963013
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.631 Vali Acc: 0.557 Test Loss: 1.631 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 5.676111698150635
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.628 Vali Acc: 0.560 Test Loss: 1.628 Test Acc: 0.560
Validation loss decreased (-0.559984 --> -0.559984).  Saving model ...
Epoch: 97 cost time: 5.355316162109375
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.625 Vali Acc: 0.560 Test Loss: 1.625 Test Acc: 0.560
Validation loss decreased (-0.559984 --> -0.559984).  Saving model ...
Epoch: 98 cost time: 6.456845760345459
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.626 Vali Acc: 0.557 Test Loss: 1.626 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 5.848013162612915
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.627 Vali Acc: 0.550 Test Loss: 1.627 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 6.031864166259766
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.628 Vali Acc: 0.550 Test Loss: 1.628 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.56
model parameter : 183193
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.088201999664307
Epoch: 1, Steps: 18 | Train Loss: 3.248 Vali Loss: 3.266 Vali Acc: 0.040 Test Loss: 3.266 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 6.175310850143433
Epoch: 2, Steps: 18 | Train Loss: 3.153 Vali Loss: 3.219 Vali Acc: 0.047 Test Loss: 3.219 Test Acc: 0.047
Validation loss decreased (-0.039967 --> -0.046634).  Saving model ...
Epoch: 3 cost time: 5.91015625
Epoch: 3, Steps: 18 | Train Loss: 3.043 Vali Loss: 3.169 Vali Acc: 0.070 Test Loss: 3.169 Test Acc: 0.070
Validation loss decreased (-0.046634 --> -0.069968).  Saving model ...
Epoch: 4 cost time: 6.447025299072266
Epoch: 4, Steps: 18 | Train Loss: 2.779 Vali Loss: 3.113 Vali Acc: 0.080 Test Loss: 3.113 Test Acc: 0.080
Validation loss decreased (-0.069968 --> -0.079969).  Saving model ...
Epoch: 5 cost time: 6.425168037414551
Epoch: 5, Steps: 18 | Train Loss: 2.534 Vali Loss: 3.053 Vali Acc: 0.100 Test Loss: 3.053 Test Acc: 0.100
Validation loss decreased (-0.079969 --> -0.099969).  Saving model ...
Epoch: 6 cost time: 6.396118640899658
Epoch: 6, Steps: 18 | Train Loss: 2.286 Vali Loss: 2.992 Vali Acc: 0.117 Test Loss: 2.992 Test Acc: 0.117
Validation loss decreased (-0.099969 --> -0.116637).  Saving model ...
Epoch: 7 cost time: 6.436898469924927
Epoch: 7, Steps: 18 | Train Loss: 2.053 Vali Loss: 2.940 Vali Acc: 0.127 Test Loss: 2.940 Test Acc: 0.127
Validation loss decreased (-0.116637 --> -0.126637).  Saving model ...
Epoch: 8 cost time: 6.192632675170898
Epoch: 8, Steps: 18 | Train Loss: 1.756 Vali Loss: 2.889 Vali Acc: 0.167 Test Loss: 2.889 Test Acc: 0.167
Validation loss decreased (-0.126637 --> -0.166638).  Saving model ...
Epoch: 9 cost time: 6.385133743286133
Epoch: 9, Steps: 18 | Train Loss: 1.449 Vali Loss: 2.829 Vali Acc: 0.170 Test Loss: 2.829 Test Acc: 0.170
Validation loss decreased (-0.166638 --> -0.169972).  Saving model ...
Epoch: 10 cost time: 5.904531240463257
Epoch: 10, Steps: 18 | Train Loss: 1.244 Vali Loss: 2.766 Vali Acc: 0.180 Test Loss: 2.766 Test Acc: 0.180
Validation loss decreased (-0.169972 --> -0.179972).  Saving model ...
Epoch: 11 cost time: 5.9919538497924805
Epoch: 11, Steps: 18 | Train Loss: 0.965 Vali Loss: 2.733 Vali Acc: 0.177 Test Loss: 2.733 Test Acc: 0.177
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.588205814361572
Epoch: 12, Steps: 18 | Train Loss: 0.712 Vali Loss: 2.673 Vali Acc: 0.173 Test Loss: 2.673 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.886310815811157
Epoch: 13, Steps: 18 | Train Loss: 0.495 Vali Loss: 2.616 Vali Acc: 0.220 Test Loss: 2.616 Test Acc: 0.220
Validation loss decreased (-0.179972 --> -0.219974).  Saving model ...
Epoch: 14 cost time: 6.934732437133789
Epoch: 14, Steps: 18 | Train Loss: 0.372 Vali Loss: 2.525 Vali Acc: 0.240 Test Loss: 2.525 Test Acc: 0.240
Validation loss decreased (-0.219974 --> -0.239975).  Saving model ...
Epoch: 15 cost time: 6.784899473190308
Epoch: 15, Steps: 18 | Train Loss: 0.255 Vali Loss: 2.512 Vali Acc: 0.237 Test Loss: 2.512 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.12022590637207
Epoch: 16, Steps: 18 | Train Loss: 0.185 Vali Loss: 2.417 Vali Acc: 0.250 Test Loss: 2.417 Test Acc: 0.250
Validation loss decreased (-0.239975 --> -0.249976).  Saving model ...
Epoch: 17 cost time: 5.974982738494873
Epoch: 17, Steps: 18 | Train Loss: 0.144 Vali Loss: 2.363 Vali Acc: 0.280 Test Loss: 2.363 Test Acc: 0.280
Validation loss decreased (-0.249976 --> -0.279976).  Saving model ...
Epoch: 18 cost time: 6.371017694473267
Epoch: 18, Steps: 18 | Train Loss: 0.112 Vali Loss: 2.276 Vali Acc: 0.327 Test Loss: 2.276 Test Acc: 0.327
Validation loss decreased (-0.279976 --> -0.326644).  Saving model ...
Epoch: 19 cost time: 6.263671159744263
Epoch: 19, Steps: 18 | Train Loss: 0.082 Vali Loss: 2.270 Vali Acc: 0.313 Test Loss: 2.270 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.446619987487793
Epoch: 20, Steps: 18 | Train Loss: 0.066 Vali Loss: 2.251 Vali Acc: 0.330 Test Loss: 2.251 Test Acc: 0.330
Validation loss decreased (-0.326644 --> -0.329977).  Saving model ...
Epoch: 21 cost time: 6.529858112335205
Epoch: 21, Steps: 18 | Train Loss: 0.077 Vali Loss: 2.221 Vali Acc: 0.340 Test Loss: 2.221 Test Acc: 0.340
Validation loss decreased (-0.329977 --> -0.339978).  Saving model ...
Epoch: 22 cost time: 6.726683855056763
Epoch: 22, Steps: 18 | Train Loss: 0.048 Vali Loss: 2.209 Vali Acc: 0.343 Test Loss: 2.209 Test Acc: 0.343
Validation loss decreased (-0.339978 --> -0.343311).  Saving model ...
Epoch: 23 cost time: 7.194295167922974
Epoch: 23, Steps: 18 | Train Loss: 0.042 Vali Loss: 2.169 Vali Acc: 0.353 Test Loss: 2.169 Test Acc: 0.353
Validation loss decreased (-0.343311 --> -0.353312).  Saving model ...
Epoch: 24 cost time: 6.247821569442749
Epoch: 24, Steps: 18 | Train Loss: 0.036 Vali Loss: 2.145 Vali Acc: 0.350 Test Loss: 2.145 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.174889087677002
Epoch: 25, Steps: 18 | Train Loss: 0.034 Vali Loss: 2.112 Vali Acc: 0.357 Test Loss: 2.112 Test Acc: 0.357
Validation loss decreased (-0.353312 --> -0.356646).  Saving model ...
Epoch: 26 cost time: 6.428317546844482
Epoch: 26, Steps: 18 | Train Loss: 0.029 Vali Loss: 2.129 Vali Acc: 0.357 Test Loss: 2.129 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.842466354370117
Epoch: 27, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.129 Vali Acc: 0.357 Test Loss: 2.129 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.018941164016724
Epoch: 28, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.106 Vali Acc: 0.357 Test Loss: 2.106 Test Acc: 0.357
Validation loss decreased (-0.356646 --> -0.356646).  Saving model ...
Epoch: 29 cost time: 6.7700910568237305
Epoch: 29, Steps: 18 | Train Loss: 0.021 Vali Loss: 2.086 Vali Acc: 0.387 Test Loss: 2.086 Test Acc: 0.387
Validation loss decreased (-0.356646 --> -0.386646).  Saving model ...
Epoch: 30 cost time: 6.584409236907959
Epoch: 30, Steps: 18 | Train Loss: 0.020 Vali Loss: 2.083 Vali Acc: 0.387 Test Loss: 2.083 Test Acc: 0.387
Validation loss decreased (-0.386646 --> -0.386646).  Saving model ...
Epoch: 31 cost time: 6.327133893966675
Epoch: 31, Steps: 18 | Train Loss: 0.016 Vali Loss: 2.051 Vali Acc: 0.370 Test Loss: 2.051 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.130988359451294
Epoch: 32, Steps: 18 | Train Loss: 0.015 Vali Loss: 2.050 Vali Acc: 0.387 Test Loss: 2.050 Test Acc: 0.387
Validation loss decreased (-0.386646 --> -0.386646).  Saving model ...
Epoch: 33 cost time: 6.475857734680176
Epoch: 33, Steps: 18 | Train Loss: 0.013 Vali Loss: 2.043 Vali Acc: 0.390 Test Loss: 2.043 Test Acc: 0.390
Validation loss decreased (-0.386646 --> -0.389980).  Saving model ...
Epoch: 34 cost time: 6.532250642776489
Epoch: 34, Steps: 18 | Train Loss: 0.014 Vali Loss: 2.052 Vali Acc: 0.393 Test Loss: 2.052 Test Acc: 0.393
Validation loss decreased (-0.389980 --> -0.393313).  Saving model ...
Epoch: 35 cost time: 6.523391485214233
Epoch: 35, Steps: 18 | Train Loss: 0.014 Vali Loss: 2.040 Vali Acc: 0.403 Test Loss: 2.040 Test Acc: 0.403
Validation loss decreased (-0.393313 --> -0.403313).  Saving model ...
Epoch: 36 cost time: 6.253411293029785
Epoch: 36, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.021 Vali Acc: 0.410 Test Loss: 2.021 Test Acc: 0.410
Validation loss decreased (-0.403313 --> -0.409980).  Saving model ...
Epoch: 37 cost time: 6.708637237548828
Epoch: 37, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.046 Vali Acc: 0.410 Test Loss: 2.046 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.230600357055664
Epoch: 38, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.026 Vali Acc: 0.413 Test Loss: 2.026 Test Acc: 0.413
Validation loss decreased (-0.409980 --> -0.413313).  Saving model ...
Epoch: 39 cost time: 6.399951696395874
Epoch: 39, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.007 Vali Acc: 0.427 Test Loss: 2.007 Test Acc: 0.427
Validation loss decreased (-0.413313 --> -0.426647).  Saving model ...
Epoch: 40 cost time: 6.514093637466431
Epoch: 40, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.986 Vali Acc: 0.423 Test Loss: 1.986 Test Acc: 0.423
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.105574131011963
Epoch: 41, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.964 Vali Acc: 0.443 Test Loss: 1.964 Test Acc: 0.443
Validation loss decreased (-0.426647 --> -0.443314).  Saving model ...
Epoch: 42 cost time: 6.557948112487793
Epoch: 42, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.949 Vali Acc: 0.443 Test Loss: 1.949 Test Acc: 0.443
Validation loss decreased (-0.443314 --> -0.443314).  Saving model ...
Epoch: 43 cost time: 5.912691116333008
Epoch: 43, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.934 Vali Acc: 0.450 Test Loss: 1.934 Test Acc: 0.450
Validation loss decreased (-0.443314 --> -0.449981).  Saving model ...
Epoch: 44 cost time: 6.587594509124756
Epoch: 44, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.933 Vali Acc: 0.453 Test Loss: 1.933 Test Acc: 0.453
Validation loss decreased (-0.449981 --> -0.453314).  Saving model ...
Epoch: 45 cost time: 6.625050067901611
Epoch: 45, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.931 Vali Acc: 0.457 Test Loss: 1.931 Test Acc: 0.457
Validation loss decreased (-0.453314 --> -0.456647).  Saving model ...
Epoch: 46 cost time: 6.206850528717041
Epoch: 46, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.919 Vali Acc: 0.460 Test Loss: 1.919 Test Acc: 0.460
Validation loss decreased (-0.456647 --> -0.459981).  Saving model ...
Epoch: 47 cost time: 6.11694598197937
Epoch: 47, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.880 Vali Acc: 0.463 Test Loss: 1.880 Test Acc: 0.463
Validation loss decreased (-0.459981 --> -0.463315).  Saving model ...
Epoch: 48 cost time: 5.896102666854858
Epoch: 48, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.877 Vali Acc: 0.473 Test Loss: 1.877 Test Acc: 0.473
Validation loss decreased (-0.463315 --> -0.473315).  Saving model ...
Epoch: 49 cost time: 5.993997812271118
Epoch: 49, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.871 Vali Acc: 0.470 Test Loss: 1.871 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.9718029499053955
Epoch: 50, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.878 Vali Acc: 0.470 Test Loss: 1.878 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 6.262737512588501
Epoch: 51, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.875 Vali Acc: 0.473 Test Loss: 1.875 Test Acc: 0.473
Validation loss decreased (-0.473315 --> -0.473315).  Saving model ...
Epoch: 52 cost time: 6.513050317764282
Epoch: 52, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.873 Vali Acc: 0.480 Test Loss: 1.873 Test Acc: 0.480
Validation loss decreased (-0.473315 --> -0.479981).  Saving model ...
Epoch: 53 cost time: 6.223903656005859
Epoch: 53, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.872 Vali Acc: 0.480 Test Loss: 1.872 Test Acc: 0.480
Validation loss decreased (-0.479981 --> -0.479981).  Saving model ...
Epoch: 54 cost time: 6.612643718719482
Epoch: 54, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.874 Vali Acc: 0.483 Test Loss: 1.874 Test Acc: 0.483
Validation loss decreased (-0.479981 --> -0.483315).  Saving model ...
Epoch: 55 cost time: 6.547122001647949
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.865 Vali Acc: 0.477 Test Loss: 1.865 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 6.3735737800598145
Epoch: 56, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.868 Vali Acc: 0.480 Test Loss: 1.868 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 5.964749574661255
Epoch: 57, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.857 Vali Acc: 0.483 Test Loss: 1.857 Test Acc: 0.483
Validation loss decreased (-0.483315 --> -0.483315).  Saving model ...
Epoch: 58 cost time: 6.4167563915252686
Epoch: 58, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.849 Vali Acc: 0.487 Test Loss: 1.849 Test Acc: 0.487
Validation loss decreased (-0.483315 --> -0.486648).  Saving model ...
Epoch: 59 cost time: 6.551321744918823
Epoch: 59, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.855 Vali Acc: 0.490 Test Loss: 1.855 Test Acc: 0.490
Validation loss decreased (-0.486648 --> -0.489981).  Saving model ...
Epoch: 60 cost time: 6.958832502365112
Epoch: 60, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.839 Vali Acc: 0.490 Test Loss: 1.839 Test Acc: 0.490
Validation loss decreased (-0.489981 --> -0.489982).  Saving model ...
Epoch: 61 cost time: 6.446092844009399
Epoch: 61, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.827 Vali Acc: 0.487 Test Loss: 1.827 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 6.275251865386963
Epoch: 62, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.836 Vali Acc: 0.493 Test Loss: 1.836 Test Acc: 0.493
Validation loss decreased (-0.489982 --> -0.493315).  Saving model ...
Epoch: 63 cost time: 6.045105218887329
Epoch: 63, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.789 Vali Acc: 0.487 Test Loss: 1.789 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 6.057085990905762
Epoch: 64, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.775 Vali Acc: 0.500 Test Loss: 1.775 Test Acc: 0.500
Validation loss decreased (-0.493315 --> -0.499982).  Saving model ...
Epoch: 65 cost time: 5.732578992843628
Epoch: 65, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.777 Vali Acc: 0.500 Test Loss: 1.777 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.950363397598267
Epoch: 66, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.798 Vali Acc: 0.490 Test Loss: 1.798 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 6.226964950561523
Epoch: 67, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.822 Vali Acc: 0.490 Test Loss: 1.822 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 6.483482360839844
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.816 Vali Acc: 0.490 Test Loss: 1.816 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 5.895540475845337
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.804 Vali Acc: 0.497 Test Loss: 1.804 Test Acc: 0.497
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 5.589761257171631
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.798 Vali Acc: 0.503 Test Loss: 1.798 Test Acc: 0.503
Validation loss decreased (-0.499982 --> -0.503315).  Saving model ...
Epoch: 71 cost time: 5.601386070251465
Epoch: 71, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.810 Vali Acc: 0.503 Test Loss: 1.810 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.88527250289917
Epoch: 72, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.809 Vali Acc: 0.503 Test Loss: 1.809 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.031412363052368
Epoch: 73, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.799 Vali Acc: 0.493 Test Loss: 1.799 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 6.258828639984131
Epoch: 74, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.796 Vali Acc: 0.493 Test Loss: 1.796 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 6.20019006729126
Epoch: 75, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.782 Vali Acc: 0.507 Test Loss: 1.782 Test Acc: 0.507
Validation loss decreased (-0.503315 --> -0.506649).  Saving model ...
Epoch: 76 cost time: 6.443266153335571
Epoch: 76, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.819 Vali Acc: 0.503 Test Loss: 1.819 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 6.282641410827637
Epoch: 77, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.855 Vali Acc: 0.507 Test Loss: 1.855 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 6.206949949264526
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.828 Vali Acc: 0.503 Test Loss: 1.828 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 6.058297395706177
Epoch: 79, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.797 Vali Acc: 0.503 Test Loss: 1.797 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 6.055398464202881
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.771 Vali Acc: 0.510 Test Loss: 1.771 Test Acc: 0.510
Validation loss decreased (-0.506649 --> -0.509982).  Saving model ...
Epoch: 81 cost time: 5.898449659347534
Epoch: 81, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.760 Vali Acc: 0.510 Test Loss: 1.760 Test Acc: 0.510
Validation loss decreased (-0.509982 --> -0.509982).  Saving model ...
Epoch: 82 cost time: 6.298841953277588
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.757 Vali Acc: 0.500 Test Loss: 1.757 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 5.976438999176025
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.753 Vali Acc: 0.513 Test Loss: 1.753 Test Acc: 0.513
Validation loss decreased (-0.509982 --> -0.513316).  Saving model ...
Epoch: 84 cost time: 6.0411646366119385
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.755 Vali Acc: 0.507 Test Loss: 1.755 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 6.096354961395264
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.772 Vali Acc: 0.503 Test Loss: 1.772 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 6.688777685165405
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.767 Vali Acc: 0.510 Test Loss: 1.767 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 7.012401342391968
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.762 Vali Acc: 0.513 Test Loss: 1.762 Test Acc: 0.513
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 6.482590675354004
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.763 Vali Acc: 0.513 Test Loss: 1.763 Test Acc: 0.513
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 6.159566879272461
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.754 Vali Acc: 0.523 Test Loss: 1.754 Test Acc: 0.523
Validation loss decreased (-0.513316 --> -0.523316).  Saving model ...
Epoch: 90 cost time: 6.055391550064087
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.735 Vali Acc: 0.537 Test Loss: 1.735 Test Acc: 0.537
Validation loss decreased (-0.523316 --> -0.536649).  Saving model ...
Epoch: 91 cost time: 6.229572772979736
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.732 Vali Acc: 0.530 Test Loss: 1.732 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 6.498433589935303
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.732 Vali Acc: 0.540 Test Loss: 1.732 Test Acc: 0.540
Validation loss decreased (-0.536649 --> -0.539983).  Saving model ...
Epoch: 93 cost time: 6.536441802978516
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.735 Vali Acc: 0.527 Test Loss: 1.735 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 6.229233741760254
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.727 Vali Acc: 0.520 Test Loss: 1.727 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 6.075218439102173
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.523 Test Loss: 1.723 Test Acc: 0.523
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 6.198568105697632
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.733 Vali Acc: 0.520 Test Loss: 1.733 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 6.4384894371032715
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.735 Vali Acc: 0.517 Test Loss: 1.735 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 6.435925722122192
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.737 Vali Acc: 0.510 Test Loss: 1.737 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 6.508984804153442
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.736 Vali Acc: 0.510 Test Loss: 1.736 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 6.561398506164551
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.523 Test Loss: 1.734 Test Acc: 0.523
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.54
model parameter : 183193
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.89627480506897
Epoch: 1, Steps: 18 | Train Loss: 3.276 Vali Loss: 3.249 Vali Acc: 0.063 Test Loss: 3.249 Test Acc: 0.063
Validation loss decreased (inf --> -0.063301).  Saving model ...
Epoch: 2 cost time: 5.50566291809082
Epoch: 2, Steps: 18 | Train Loss: 3.163 Vali Loss: 3.209 Vali Acc: 0.057 Test Loss: 3.209 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.687938451766968
Epoch: 3, Steps: 18 | Train Loss: 3.027 Vali Loss: 3.167 Vali Acc: 0.077 Test Loss: 3.167 Test Acc: 0.077
Validation loss decreased (-0.063301 --> -0.076635).  Saving model ...
Epoch: 4 cost time: 6.2549543380737305
Epoch: 4, Steps: 18 | Train Loss: 2.788 Vali Loss: 3.117 Vali Acc: 0.093 Test Loss: 3.117 Test Acc: 0.093
Validation loss decreased (-0.076635 --> -0.093302).  Saving model ...
Epoch: 5 cost time: 5.87740159034729
Epoch: 5, Steps: 18 | Train Loss: 2.572 Vali Loss: 3.063 Vali Acc: 0.097 Test Loss: 3.063 Test Acc: 0.097
Validation loss decreased (-0.093302 --> -0.096636).  Saving model ...
Epoch: 6 cost time: 5.538458824157715
Epoch: 6, Steps: 18 | Train Loss: 2.320 Vali Loss: 3.006 Vali Acc: 0.120 Test Loss: 3.006 Test Acc: 0.120
Validation loss decreased (-0.096636 --> -0.119970).  Saving model ...
Epoch: 7 cost time: 5.764912843704224
Epoch: 7, Steps: 18 | Train Loss: 2.088 Vali Loss: 2.953 Vali Acc: 0.120 Test Loss: 2.953 Test Acc: 0.120
Validation loss decreased (-0.119970 --> -0.119970).  Saving model ...
Epoch: 8 cost time: 5.9340660572052
Epoch: 8, Steps: 18 | Train Loss: 1.790 Vali Loss: 2.898 Vali Acc: 0.133 Test Loss: 2.898 Test Acc: 0.133
Validation loss decreased (-0.119970 --> -0.133304).  Saving model ...
Epoch: 9 cost time: 5.924473524093628
Epoch: 9, Steps: 18 | Train Loss: 1.516 Vali Loss: 2.836 Vali Acc: 0.140 Test Loss: 2.836 Test Acc: 0.140
Validation loss decreased (-0.133304 --> -0.139972).  Saving model ...
Epoch: 10 cost time: 5.880205154418945
Epoch: 10, Steps: 18 | Train Loss: 1.283 Vali Loss: 2.759 Vali Acc: 0.190 Test Loss: 2.759 Test Acc: 0.190
Validation loss decreased (-0.139972 --> -0.189972).  Saving model ...
Epoch: 11 cost time: 5.744584083557129
Epoch: 11, Steps: 18 | Train Loss: 0.985 Vali Loss: 2.714 Vali Acc: 0.157 Test Loss: 2.714 Test Acc: 0.157
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.396801471710205
Epoch: 12, Steps: 18 | Train Loss: 0.726 Vali Loss: 2.636 Vali Acc: 0.180 Test Loss: 2.636 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.6371307373046875
Epoch: 13, Steps: 18 | Train Loss: 0.539 Vali Loss: 2.546 Vali Acc: 0.200 Test Loss: 2.546 Test Acc: 0.200
Validation loss decreased (-0.189972 --> -0.199975).  Saving model ...
Epoch: 14 cost time: 5.682947874069214
Epoch: 14, Steps: 18 | Train Loss: 0.388 Vali Loss: 2.420 Vali Acc: 0.237 Test Loss: 2.420 Test Acc: 0.237
Validation loss decreased (-0.199975 --> -0.236642).  Saving model ...
Epoch: 15 cost time: 6.138507843017578
Epoch: 15, Steps: 18 | Train Loss: 0.244 Vali Loss: 2.349 Vali Acc: 0.267 Test Loss: 2.349 Test Acc: 0.267
Validation loss decreased (-0.236642 --> -0.266643).  Saving model ...
Epoch: 16 cost time: 5.910090446472168
Epoch: 16, Steps: 18 | Train Loss: 0.174 Vali Loss: 2.257 Vali Acc: 0.277 Test Loss: 2.257 Test Acc: 0.277
Validation loss decreased (-0.266643 --> -0.276644).  Saving model ...
Epoch: 17 cost time: 6.080191373825073
Epoch: 17, Steps: 18 | Train Loss: 0.125 Vali Loss: 2.185 Vali Acc: 0.290 Test Loss: 2.185 Test Acc: 0.290
Validation loss decreased (-0.276644 --> -0.289978).  Saving model ...
Epoch: 18 cost time: 6.39281964302063
Epoch: 18, Steps: 18 | Train Loss: 0.107 Vali Loss: 2.087 Vali Acc: 0.320 Test Loss: 2.087 Test Acc: 0.320
Validation loss decreased (-0.289978 --> -0.319979).  Saving model ...
Epoch: 19 cost time: 5.55260443687439
Epoch: 19, Steps: 18 | Train Loss: 0.080 Vali Loss: 2.056 Vali Acc: 0.343 Test Loss: 2.056 Test Acc: 0.343
Validation loss decreased (-0.319979 --> -0.343313).  Saving model ...
Epoch: 20 cost time: 5.555891990661621
Epoch: 20, Steps: 18 | Train Loss: 0.065 Vali Loss: 2.012 Vali Acc: 0.363 Test Loss: 2.012 Test Acc: 0.363
Validation loss decreased (-0.343313 --> -0.363313).  Saving model ...
Epoch: 21 cost time: 5.819357872009277
Epoch: 21, Steps: 18 | Train Loss: 0.062 Vali Loss: 1.944 Vali Acc: 0.373 Test Loss: 1.944 Test Acc: 0.373
Validation loss decreased (-0.363313 --> -0.373314).  Saving model ...
Epoch: 22 cost time: 5.879838466644287
Epoch: 22, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.928 Vali Acc: 0.373 Test Loss: 1.928 Test Acc: 0.373
Validation loss decreased (-0.373314 --> -0.373314).  Saving model ...
Epoch: 23 cost time: 6.375272035598755
Epoch: 23, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.909 Vali Acc: 0.377 Test Loss: 1.909 Test Acc: 0.377
Validation loss decreased (-0.373314 --> -0.376648).  Saving model ...
Epoch: 24 cost time: 5.6454596519470215
Epoch: 24, Steps: 18 | Train Loss: 0.031 Vali Loss: 1.877 Vali Acc: 0.387 Test Loss: 1.877 Test Acc: 0.387
Validation loss decreased (-0.376648 --> -0.386648).  Saving model ...
Epoch: 25 cost time: 5.598201513290405
Epoch: 25, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.846 Vali Acc: 0.393 Test Loss: 1.846 Test Acc: 0.393
Validation loss decreased (-0.386648 --> -0.393315).  Saving model ...
Epoch: 26 cost time: 5.204673528671265
Epoch: 26, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.829 Vali Acc: 0.410 Test Loss: 1.829 Test Acc: 0.410
Validation loss decreased (-0.393315 --> -0.409982).  Saving model ...
Epoch: 27 cost time: 5.855801582336426
Epoch: 27, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.813 Vali Acc: 0.423 Test Loss: 1.813 Test Acc: 0.423
Validation loss decreased (-0.409982 --> -0.423315).  Saving model ...
Epoch: 28 cost time: 5.8234899044036865
Epoch: 28, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.790 Vali Acc: 0.420 Test Loss: 1.790 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.893573760986328
Epoch: 29, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.769 Vali Acc: 0.433 Test Loss: 1.769 Test Acc: 0.433
Validation loss decreased (-0.423315 --> -0.433316).  Saving model ...
Epoch: 30 cost time: 5.746425151824951
Epoch: 30, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.761 Vali Acc: 0.430 Test Loss: 1.761 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.9627039432525635
Epoch: 31, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.738 Vali Acc: 0.430 Test Loss: 1.738 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.7122437953948975
Epoch: 32, Steps: 18 | Train Loss: 0.013 Vali Loss: 1.729 Vali Acc: 0.437 Test Loss: 1.729 Test Acc: 0.437
Validation loss decreased (-0.433316 --> -0.436649).  Saving model ...
Epoch: 33 cost time: 5.708246469497681
Epoch: 33, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.711 Vali Acc: 0.443 Test Loss: 1.711 Test Acc: 0.443
Validation loss decreased (-0.436649 --> -0.443316).  Saving model ...
Epoch: 34 cost time: 6.435271263122559
Epoch: 34, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.698 Vali Acc: 0.457 Test Loss: 1.698 Test Acc: 0.457
Validation loss decreased (-0.443316 --> -0.456650).  Saving model ...
Epoch: 35 cost time: 6.488505840301514
Epoch: 35, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.686 Vali Acc: 0.463 Test Loss: 1.686 Test Acc: 0.463
Validation loss decreased (-0.456650 --> -0.463316).  Saving model ...
Epoch: 36 cost time: 6.193423748016357
Epoch: 36, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.670 Vali Acc: 0.467 Test Loss: 1.670 Test Acc: 0.467
Validation loss decreased (-0.463316 --> -0.466650).  Saving model ...
Epoch: 37 cost time: 5.9554359912872314
Epoch: 37, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.668 Vali Acc: 0.460 Test Loss: 1.668 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.33687686920166
Epoch: 38, Steps: 18 | Train Loss: 0.009 Vali Loss: 1.654 Vali Acc: 0.463 Test Loss: 1.654 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 5.651644229888916
Epoch: 39, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.643 Vali Acc: 0.467 Test Loss: 1.643 Test Acc: 0.467
Validation loss decreased (-0.466650 --> -0.466650).  Saving model ...
Epoch: 40 cost time: 5.220801591873169
Epoch: 40, Steps: 18 | Train Loss: 0.008 Vali Loss: 1.626 Vali Acc: 0.483 Test Loss: 1.626 Test Acc: 0.483
Validation loss decreased (-0.466650 --> -0.483317).  Saving model ...
Epoch: 41 cost time: 5.898990154266357
Epoch: 41, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.604 Vali Acc: 0.483 Test Loss: 1.604 Test Acc: 0.483
Validation loss decreased (-0.483317 --> -0.483317).  Saving model ...
Epoch: 42 cost time: 5.892878293991089
Epoch: 42, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.598 Vali Acc: 0.490 Test Loss: 1.598 Test Acc: 0.490
Validation loss decreased (-0.483317 --> -0.489984).  Saving model ...
Epoch: 43 cost time: 6.059065341949463
Epoch: 43, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.592 Vali Acc: 0.490 Test Loss: 1.592 Test Acc: 0.490
Validation loss decreased (-0.489984 --> -0.489984).  Saving model ...
Epoch: 44 cost time: 5.767331838607788
Epoch: 44, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.590 Vali Acc: 0.487 Test Loss: 1.590 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.463296890258789
Epoch: 45, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.588 Vali Acc: 0.483 Test Loss: 1.588 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 6.120038986206055
Epoch: 46, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.577 Vali Acc: 0.497 Test Loss: 1.577 Test Acc: 0.497
Validation loss decreased (-0.489984 --> -0.496651).  Saving model ...
Epoch: 47 cost time: 6.1994030475616455
Epoch: 47, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.566 Vali Acc: 0.510 Test Loss: 1.566 Test Acc: 0.510
Validation loss decreased (-0.496651 --> -0.509984).  Saving model ...
Epoch: 48 cost time: 6.023216485977173
Epoch: 48, Steps: 18 | Train Loss: 0.006 Vali Loss: 1.558 Vali Acc: 0.510 Test Loss: 1.558 Test Acc: 0.510
Validation loss decreased (-0.509984 --> -0.509984).  Saving model ...
Epoch: 49 cost time: 6.386436700820923
Epoch: 49, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.547 Vali Acc: 0.503 Test Loss: 1.547 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.784570693969727
Epoch: 50, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.545 Vali Acc: 0.517 Test Loss: 1.545 Test Acc: 0.517
Validation loss decreased (-0.509984 --> -0.516651).  Saving model ...
Epoch: 51 cost time: 5.814478635787964
Epoch: 51, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.544 Vali Acc: 0.513 Test Loss: 1.544 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.45237135887146
Epoch: 52, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.543 Vali Acc: 0.510 Test Loss: 1.543 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 5.415272951126099
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.537 Vali Acc: 0.517 Test Loss: 1.537 Test Acc: 0.517
Validation loss decreased (-0.516651 --> -0.516651).  Saving model ...
Epoch: 54 cost time: 5.698455572128296
Epoch: 54, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.529 Vali Acc: 0.517 Test Loss: 1.529 Test Acc: 0.517
Validation loss decreased (-0.516651 --> -0.516651).  Saving model ...
Epoch: 55 cost time: 5.815916299819946
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.525 Vali Acc: 0.527 Test Loss: 1.525 Test Acc: 0.527
Validation loss decreased (-0.516651 --> -0.526651).  Saving model ...
Epoch: 56 cost time: 5.875719785690308
Epoch: 56, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.514 Vali Acc: 0.527 Test Loss: 1.514 Test Acc: 0.527
Validation loss decreased (-0.526651 --> -0.526652).  Saving model ...
Epoch: 57 cost time: 5.708634614944458
Epoch: 57, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.500 Vali Acc: 0.533 Test Loss: 1.500 Test Acc: 0.533
Validation loss decreased (-0.526652 --> -0.533318).  Saving model ...
Epoch: 58 cost time: 5.6248085498809814
Epoch: 58, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.489 Vali Acc: 0.540 Test Loss: 1.489 Test Acc: 0.540
Validation loss decreased (-0.533318 --> -0.539985).  Saving model ...
Epoch: 59 cost time: 5.725258111953735
Epoch: 59, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.510 Vali Acc: 0.543 Test Loss: 1.510 Test Acc: 0.543
Validation loss decreased (-0.539985 --> -0.543318).  Saving model ...
Epoch: 60 cost time: 6.38557243347168
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.505 Vali Acc: 0.540 Test Loss: 1.505 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.227048397064209
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.495 Vali Acc: 0.533 Test Loss: 1.495 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 5.9309608936309814
Epoch: 62, Steps: 18 | Train Loss: 0.003 Vali Loss: 1.484 Vali Acc: 0.523 Test Loss: 1.484 Test Acc: 0.523
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 5.689631462097168
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.476 Vali Acc: 0.530 Test Loss: 1.476 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 5.503990411758423
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.468 Vali Acc: 0.547 Test Loss: 1.468 Test Acc: 0.547
Validation loss decreased (-0.543318 --> -0.546652).  Saving model ...
Epoch: 65 cost time: 5.606307029724121
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.463 Vali Acc: 0.553 Test Loss: 1.463 Test Acc: 0.553
Validation loss decreased (-0.546652 --> -0.553319).  Saving model ...
Epoch: 66 cost time: 5.941213130950928
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.462 Vali Acc: 0.547 Test Loss: 1.462 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 6.055356502532959
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.467 Vali Acc: 0.560 Test Loss: 1.467 Test Acc: 0.560
Validation loss decreased (-0.553319 --> -0.559985).  Saving model ...
Epoch: 68 cost time: 6.241132974624634
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.465 Vali Acc: 0.560 Test Loss: 1.465 Test Acc: 0.560
Validation loss decreased (-0.559985 --> -0.559985).  Saving model ...
Epoch: 69 cost time: 6.289903879165649
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.475 Vali Acc: 0.563 Test Loss: 1.475 Test Acc: 0.563
Validation loss decreased (-0.559985 --> -0.563319).  Saving model ...
Epoch: 70 cost time: 6.214574575424194
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.462 Vali Acc: 0.563 Test Loss: 1.462 Test Acc: 0.563
Validation loss decreased (-0.563319 --> -0.563319).  Saving model ...
Epoch: 71 cost time: 5.679242372512817
Epoch: 71, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.456 Vali Acc: 0.560 Test Loss: 1.456 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.8620383739471436
Epoch: 72, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.455 Vali Acc: 0.560 Test Loss: 1.455 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.378047466278076
Epoch: 73, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.449 Vali Acc: 0.563 Test Loss: 1.449 Test Acc: 0.563
Validation loss decreased (-0.563319 --> -0.563319).  Saving model ...
Epoch: 74 cost time: 6.0770649909973145
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.447 Vali Acc: 0.570 Test Loss: 1.447 Test Acc: 0.570
Validation loss decreased (-0.563319 --> -0.569986).  Saving model ...
Epoch: 75 cost time: 6.061399459838867
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.440 Vali Acc: 0.577 Test Loss: 1.440 Test Acc: 0.577
Validation loss decreased (-0.569986 --> -0.576652).  Saving model ...
Epoch: 76 cost time: 5.8539628982543945
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.438 Vali Acc: 0.583 Test Loss: 1.438 Test Acc: 0.583
Validation loss decreased (-0.576652 --> -0.583319).  Saving model ...
Epoch: 77 cost time: 5.459123134613037
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.438 Vali Acc: 0.573 Test Loss: 1.438 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 5.886329650878906
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.573 Test Loss: 1.430 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 6.199910402297974
Epoch: 79, Steps: 18 | Train Loss: 0.002 Vali Loss: 1.429 Vali Acc: 0.580 Test Loss: 1.429 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 6.240740776062012
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.428 Vali Acc: 0.583 Test Loss: 1.428 Test Acc: 0.583
Validation loss decreased (-0.583319 --> -0.583319).  Saving model ...
Epoch: 81 cost time: 6.20075535774231
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.427 Vali Acc: 0.580 Test Loss: 1.427 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 6.243955135345459
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.427 Vali Acc: 0.590 Test Loss: 1.427 Test Acc: 0.590
Validation loss decreased (-0.583319 --> -0.589986).  Saving model ...
Epoch: 83 cost time: 5.914941072463989
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.421 Vali Acc: 0.597 Test Loss: 1.421 Test Acc: 0.597
Validation loss decreased (-0.589986 --> -0.596652).  Saving model ...
Epoch: 84 cost time: 5.8697099685668945
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.418 Vali Acc: 0.597 Test Loss: 1.418 Test Acc: 0.597
Validation loss decreased (-0.596652 --> -0.596652).  Saving model ...
Epoch: 85 cost time: 5.854203224182129
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.420 Vali Acc: 0.587 Test Loss: 1.420 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 5.87899923324585
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.412 Vali Acc: 0.580 Test Loss: 1.412 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 5.610819578170776
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.414 Vali Acc: 0.570 Test Loss: 1.414 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 5.735629081726074
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.415 Vali Acc: 0.577 Test Loss: 1.415 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 6.149447202682495
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.412 Vali Acc: 0.583 Test Loss: 1.412 Test Acc: 0.583
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 5.97781777381897
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.411 Vali Acc: 0.577 Test Loss: 1.411 Test Acc: 0.577
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 5.893543720245361
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.580 Test Loss: 1.410 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 5.8957741260528564
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.593 Test Loss: 1.398 Test Acc: 0.593
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 6.0646443367004395
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.396 Vali Acc: 0.587 Test Loss: 1.396 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 6.324885845184326
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 1.397 Vali Acc: 0.580 Test Loss: 1.397 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.5966666666666667
model parameter : 183193
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.719500303268433
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (inf --> -0.039968).  Saving model ...
Epoch: 2 cost time: 5.637234926223755
Epoch: 2, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.704620599746704
Epoch: 3, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
Validation loss decreased (-0.039968 --> -0.039968).  Saving model ...
Epoch: 4 cost time: 6.2928407192230225
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.0696189403533936
Epoch: 5, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.184428930282593
Epoch: 6, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.095913887023926
Epoch: 7, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.398629903793335
Epoch: 8, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.290611743927002
Epoch: 9, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.438005685806274
Epoch: 10, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.706587791442871
Epoch: 11, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.155771493911743
Epoch: 12, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.546529769897461
Epoch: 13, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.219 Vali Acc: 0.040 Test Loss: 3.219 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.04
model parameter : 183193
model size : 1.94MB
