Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 129.775452375412
Epoch: 1, Steps: 18 | Train Loss: 2.274 Vali Loss: 5.755 Vali Acc: 0.530 Test Loss: 5.755 Test Acc: 0.530
Validation loss decreased (inf --> -0.529942).  Saving model ...
Epoch: 2 cost time: 134.70113563537598
Epoch: 2, Steps: 18 | Train Loss: 4.090 Vali Loss: 4.400 Vali Acc: 0.560 Test Loss: 4.400 Test Acc: 0.560
Validation loss decreased (-0.529942 --> -0.559956).  Saving model ...
Epoch: 3 cost time: 133.02287077903748
Epoch: 3, Steps: 18 | Train Loss: 2.351 Vali Loss: 13.747 Vali Acc: 0.480 Test Loss: 13.747 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 146.54740858078003
Epoch: 4, Steps: 18 | Train Loss: 8.885 Vali Loss: 13.919 Vali Acc: 0.520 Test Loss: 13.919 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 136.93074321746826
Epoch: 5, Steps: 18 | Train Loss: 5.473 Vali Loss: 8.719 Vali Acc: 0.520 Test Loss: 8.719 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 152.52155184745789
Epoch: 6, Steps: 18 | Train Loss: 3.988 Vali Loss: 38.124 Vali Acc: 0.500 Test Loss: 38.124 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 151.03349924087524
Epoch: 7, Steps: 18 | Train Loss: 4.563 Vali Loss: 17.009 Vali Acc: 0.490 Test Loss: 17.009 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 165.33224534988403
Epoch: 8, Steps: 18 | Train Loss: 6.656 Vali Loss: 15.865 Vali Acc: 0.570 Test Loss: 15.865 Test Acc: 0.570
Validation loss decreased (-0.559956 --> -0.569841).  Saving model ...
Epoch: 9 cost time: 163.79884505271912
Epoch: 9, Steps: 18 | Train Loss: 4.114 Vali Loss: 15.173 Vali Acc: 0.540 Test Loss: 15.173 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 170.32178664207458
Epoch: 10, Steps: 18 | Train Loss: 7.632 Vali Loss: 33.198 Vali Acc: 0.560 Test Loss: 33.198 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 177.40627431869507
Epoch: 11, Steps: 18 | Train Loss: 3.320 Vali Loss: 22.989 Vali Acc: 0.540 Test Loss: 22.989 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 168.8720293045044
Epoch: 12, Steps: 18 | Train Loss: 5.765 Vali Loss: 30.292 Vali Acc: 0.540 Test Loss: 30.292 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 173.68521285057068
Epoch: 13, Steps: 18 | Train Loss: 2.991 Vali Loss: 43.786 Vali Acc: 0.490 Test Loss: 43.786 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 167.31685209274292
Epoch: 14, Steps: 18 | Train Loss: 3.478 Vali Loss: 26.065 Vali Acc: 0.580 Test Loss: 26.065 Test Acc: 0.580
Validation loss decreased (-0.569841 --> -0.579739).  Saving model ...
Epoch: 15 cost time: 164.220228433609
Epoch: 15, Steps: 18 | Train Loss: 11.351 Vali Loss: 81.061 Vali Acc: 0.540 Test Loss: 81.061 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 175.99859070777893
Epoch: 16, Steps: 18 | Train Loss: 3.520 Vali Loss: 36.604 Vali Acc: 0.510 Test Loss: 36.604 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 170.01418209075928
Epoch: 17, Steps: 18 | Train Loss: 9.426 Vali Loss: 54.598 Vali Acc: 0.530 Test Loss: 54.598 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 173.48520612716675
Epoch: 18, Steps: 18 | Train Loss: 1.082 Vali Loss: 67.163 Vali Acc: 0.520 Test Loss: 67.163 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 173.5517475605011
Epoch: 19, Steps: 18 | Train Loss: 3.800 Vali Loss: 61.602 Vali Acc: 0.540 Test Loss: 61.602 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 164.61781859397888
Epoch: 20, Steps: 18 | Train Loss: 3.973 Vali Loss: 39.893 Vali Acc: 0.540 Test Loss: 39.893 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 166.4549105167389
Epoch: 21, Steps: 18 | Train Loss: 7.732 Vali Loss: 40.984 Vali Acc: 0.560 Test Loss: 40.984 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 174.49410390853882
Epoch: 22, Steps: 18 | Train Loss: 1.662 Vali Loss: 44.068 Vali Acc: 0.500 Test Loss: 44.068 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 170.5676724910736
Epoch: 23, Steps: 18 | Train Loss: 2.832 Vali Loss: 38.143 Vali Acc: 0.560 Test Loss: 38.143 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 166.1348361968994
Epoch: 24, Steps: 18 | Train Loss: 3.666 Vali Loss: 105.458 Vali Acc: 0.490 Test Loss: 105.458 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 19972610
model size : 95.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 108.71642446517944
Epoch: 1, Steps: 18 | Train Loss: 2.183 Vali Loss: 4.650 Vali Acc: 0.550 Test Loss: 4.650 Test Acc: 0.550
Validation loss decreased (inf --> -0.549953).  Saving model ...
Epoch: 2 cost time: 101.4070508480072
Epoch: 2, Steps: 18 | Train Loss: 3.849 Vali Loss: 4.080 Vali Acc: 0.520 Test Loss: 4.080 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 105.54076027870178
Epoch: 3, Steps: 18 | Train Loss: 3.370 Vali Loss: 6.881 Vali Acc: 0.510 Test Loss: 6.881 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 103.02337098121643
Epoch: 4, Steps: 18 | Train Loss: 3.696 Vali Loss: 5.962 Vali Acc: 0.520 Test Loss: 5.962 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 110.56468319892883
Epoch: 5, Steps: 18 | Train Loss: 3.621 Vali Loss: 8.124 Vali Acc: 0.550 Test Loss: 8.124 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 111.30881476402283
Epoch: 6, Steps: 18 | Train Loss: 3.271 Vali Loss: 21.940 Vali Acc: 0.480 Test Loss: 21.940 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 117.69629335403442
Epoch: 7, Steps: 18 | Train Loss: 2.792 Vali Loss: 17.938 Vali Acc: 0.490 Test Loss: 17.938 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 118.26742959022522
Epoch: 8, Steps: 18 | Train Loss: 5.512 Vali Loss: 16.478 Vali Acc: 0.530 Test Loss: 16.478 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 125.06265640258789
Epoch: 9, Steps: 18 | Train Loss: 4.396 Vali Loss: 16.048 Vali Acc: 0.490 Test Loss: 16.048 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 110.18662977218628
Epoch: 10, Steps: 18 | Train Loss: 10.279 Vali Loss: 27.104 Vali Acc: 0.550 Test Loss: 27.104 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 126.59530520439148
Epoch: 11, Steps: 18 | Train Loss: 4.557 Vali Loss: 16.364 Vali Acc: 0.550 Test Loss: 16.364 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 19972610
model size : 95.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 79.1437201499939
Epoch: 1, Steps: 18 | Train Loss: 2.478 Vali Loss: 3.935 Vali Acc: 0.540 Test Loss: 3.935 Test Acc: 0.540
Validation loss decreased (inf --> -0.539961).  Saving model ...
Epoch: 2 cost time: 85.9329833984375
Epoch: 2, Steps: 18 | Train Loss: 3.865 Vali Loss: 7.060 Vali Acc: 0.510 Test Loss: 7.060 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 81.8858335018158
Epoch: 3, Steps: 18 | Train Loss: 2.403 Vali Loss: 9.839 Vali Acc: 0.480 Test Loss: 9.839 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 81.57028365135193
Epoch: 4, Steps: 18 | Train Loss: 3.949 Vali Loss: 12.637 Vali Acc: 0.520 Test Loss: 12.637 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 92.68175101280212
Epoch: 5, Steps: 18 | Train Loss: 5.309 Vali Loss: 5.947 Vali Acc: 0.570 Test Loss: 5.947 Test Acc: 0.570
Validation loss decreased (-0.539961 --> -0.569941).  Saving model ...
Epoch: 6 cost time: 96.84148120880127
Epoch: 6, Steps: 18 | Train Loss: 5.651 Vali Loss: 29.419 Vali Acc: 0.520 Test Loss: 29.419 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 95.52161979675293
Epoch: 7, Steps: 18 | Train Loss: 5.963 Vali Loss: 13.083 Vali Acc: 0.600 Test Loss: 13.083 Test Acc: 0.600
Validation loss decreased (-0.569941 --> -0.599869).  Saving model ...
Epoch: 8 cost time: 95.47118878364563
Epoch: 8, Steps: 18 | Train Loss: 3.552 Vali Loss: 21.362 Vali Acc: 0.590 Test Loss: 21.362 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 100.48746085166931
Epoch: 9, Steps: 18 | Train Loss: 4.209 Vali Loss: 13.337 Vali Acc: 0.590 Test Loss: 13.337 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 109.81776666641235
Epoch: 10, Steps: 18 | Train Loss: 3.058 Vali Loss: 59.123 Vali Acc: 0.520 Test Loss: 59.123 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 106.18747878074646
Epoch: 11, Steps: 18 | Train Loss: 7.233 Vali Loss: 35.478 Vali Acc: 0.490 Test Loss: 35.478 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 106.04446363449097
Epoch: 12, Steps: 18 | Train Loss: 3.623 Vali Loss: 39.094 Vali Acc: 0.490 Test Loss: 39.094 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 100.7165014743805
Epoch: 13, Steps: 18 | Train Loss: 5.122 Vali Loss: 32.434 Vali Acc: 0.590 Test Loss: 32.434 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 98.63052535057068
Epoch: 14, Steps: 18 | Train Loss: 6.155 Vali Loss: 71.319 Vali Acc: 0.480 Test Loss: 71.319 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 99.48800873756409
Epoch: 15, Steps: 18 | Train Loss: 10.546 Vali Loss: 38.363 Vali Acc: 0.550 Test Loss: 38.363 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 107.04449915885925
Epoch: 16, Steps: 18 | Train Loss: 7.839 Vali Loss: 32.345 Vali Acc: 0.500 Test Loss: 32.345 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 104.90725827217102
Epoch: 17, Steps: 18 | Train Loss: 2.118 Vali Loss: 35.683 Vali Acc: 0.450 Test Loss: 35.683 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 19972610
model size : 95.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 68.79008555412292
Epoch: 1, Steps: 18 | Train Loss: 1.657 Vali Loss: 3.860 Vali Acc: 0.510 Test Loss: 3.860 Test Acc: 0.510
Validation loss decreased (inf --> -0.509961).  Saving model ...
Epoch: 2 cost time: 61.58279037475586
Epoch: 2, Steps: 18 | Train Loss: 2.946 Vali Loss: 3.294 Vali Acc: 0.560 Test Loss: 3.294 Test Acc: 0.560
Validation loss decreased (-0.509961 --> -0.559967).  Saving model ...
Epoch: 3 cost time: 66.26485443115234
Epoch: 3, Steps: 18 | Train Loss: 4.098 Vali Loss: 6.037 Vali Acc: 0.540 Test Loss: 6.037 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 63.55107498168945
Epoch: 4, Steps: 18 | Train Loss: 4.359 Vali Loss: 7.601 Vali Acc: 0.560 Test Loss: 7.601 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 71.78755283355713
Epoch: 5, Steps: 18 | Train Loss: 5.630 Vali Loss: 13.436 Vali Acc: 0.570 Test Loss: 13.436 Test Acc: 0.570
Validation loss decreased (-0.559967 --> -0.569866).  Saving model ...
Epoch: 6 cost time: 67.18972182273865
Epoch: 6, Steps: 18 | Train Loss: 3.350 Vali Loss: 13.761 Vali Acc: 0.560 Test Loss: 13.761 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 71.39129137992859
Epoch: 7, Steps: 18 | Train Loss: 2.257 Vali Loss: 12.001 Vali Acc: 0.530 Test Loss: 12.001 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 83.65351176261902
Epoch: 8, Steps: 18 | Train Loss: 4.326 Vali Loss: 21.231 Vali Acc: 0.520 Test Loss: 21.231 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 79.3039801120758
Epoch: 9, Steps: 18 | Train Loss: 3.669 Vali Loss: 23.113 Vali Acc: 0.450 Test Loss: 23.113 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 80.48165249824524
Epoch: 10, Steps: 18 | Train Loss: 2.931 Vali Loss: 27.395 Vali Acc: 0.510 Test Loss: 27.395 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 83.48812556266785
Epoch: 11, Steps: 18 | Train Loss: 3.034 Vali Loss: 23.478 Vali Acc: 0.580 Test Loss: 23.478 Test Acc: 0.580
Validation loss decreased (-0.569866 --> -0.579765).  Saving model ...
Epoch: 12 cost time: 75.1178686618805
Epoch: 12, Steps: 18 | Train Loss: 4.164 Vali Loss: 54.147 Vali Acc: 0.510 Test Loss: 54.147 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 77.74476265907288
Epoch: 13, Steps: 18 | Train Loss: 11.487 Vali Loss: 25.706 Vali Acc: 0.570 Test Loss: 25.706 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 73.66867446899414
Epoch: 14, Steps: 18 | Train Loss: 10.996 Vali Loss: 36.483 Vali Acc: 0.490 Test Loss: 36.483 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 74.72923016548157
Epoch: 15, Steps: 18 | Train Loss: 3.388 Vali Loss: 32.466 Vali Acc: 0.580 Test Loss: 32.466 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 82.3012228012085
Epoch: 16, Steps: 18 | Train Loss: 2.412 Vali Loss: 66.175 Vali Acc: 0.490 Test Loss: 66.175 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 80.75749278068542
Epoch: 17, Steps: 18 | Train Loss: 4.599 Vali Loss: 59.849 Vali Acc: 0.510 Test Loss: 59.849 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 72.55444431304932
Epoch: 18, Steps: 18 | Train Loss: 3.283 Vali Loss: 35.896 Vali Acc: 0.560 Test Loss: 35.896 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 83.7270998954773
Epoch: 19, Steps: 18 | Train Loss: 4.492 Vali Loss: 66.137 Vali Acc: 0.510 Test Loss: 66.137 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 72.26663374900818
Epoch: 20, Steps: 18 | Train Loss: 10.926 Vali Loss: 51.097 Vali Acc: 0.500 Test Loss: 51.097 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 79.81375455856323
Epoch: 21, Steps: 18 | Train Loss: 3.684 Vali Loss: 56.353 Vali Acc: 0.530 Test Loss: 56.353 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 19972610
model size : 95.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 51.223352909088135
Epoch: 1, Steps: 18 | Train Loss: 2.702 Vali Loss: 2.524 Vali Acc: 0.470 Test Loss: 2.524 Test Acc: 0.470
Validation loss decreased (inf --> -0.469975).  Saving model ...
Epoch: 2 cost time: 43.680251359939575
Epoch: 2, Steps: 18 | Train Loss: 2.811 Vali Loss: 8.693 Vali Acc: 0.500 Test Loss: 8.693 Test Acc: 0.500
Validation loss decreased (-0.469975 --> -0.499913).  Saving model ...
Epoch: 3 cost time: 49.72120928764343
Epoch: 3, Steps: 18 | Train Loss: 3.302 Vali Loss: 3.626 Vali Acc: 0.470 Test Loss: 3.626 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 45.51268124580383
Epoch: 4, Steps: 18 | Train Loss: 2.315 Vali Loss: 6.917 Vali Acc: 0.510 Test Loss: 6.917 Test Acc: 0.510
Validation loss decreased (-0.499913 --> -0.509931).  Saving model ...
Epoch: 5 cost time: 40.29342246055603
Epoch: 5, Steps: 18 | Train Loss: 2.584 Vali Loss: 6.370 Vali Acc: 0.500 Test Loss: 6.370 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 38.21866798400879
Epoch: 6, Steps: 18 | Train Loss: 2.549 Vali Loss: 22.898 Vali Acc: 0.500 Test Loss: 22.898 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 54.470566749572754
Epoch: 7, Steps: 18 | Train Loss: 8.478 Vali Loss: 15.557 Vali Acc: 0.470 Test Loss: 15.557 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 50.30957889556885
Epoch: 8, Steps: 18 | Train Loss: 4.000 Vali Loss: 12.193 Vali Acc: 0.570 Test Loss: 12.193 Test Acc: 0.570
Validation loss decreased (-0.509931 --> -0.569878).  Saving model ...
Epoch: 9 cost time: 56.10472798347473
Epoch: 9, Steps: 18 | Train Loss: 6.688 Vali Loss: 26.358 Vali Acc: 0.550 Test Loss: 26.358 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 53.68051767349243
Epoch: 10, Steps: 18 | Train Loss: 6.413 Vali Loss: 16.539 Vali Acc: 0.540 Test Loss: 16.539 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 52.608389139175415
Epoch: 11, Steps: 18 | Train Loss: 4.343 Vali Loss: 44.641 Vali Acc: 0.490 Test Loss: 44.641 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 56.018261432647705
Epoch: 12, Steps: 18 | Train Loss: 6.291 Vali Loss: 26.968 Vali Acc: 0.560 Test Loss: 26.968 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 51.1734983921051
Epoch: 13, Steps: 18 | Train Loss: 4.336 Vali Loss: 41.261 Vali Acc: 0.500 Test Loss: 41.261 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 51.35401153564453
Epoch: 14, Steps: 18 | Train Loss: 5.283 Vali Loss: 90.114 Vali Acc: 0.510 Test Loss: 90.114 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 50.75617527961731
Epoch: 15, Steps: 18 | Train Loss: 9.158 Vali Loss: 36.079 Vali Acc: 0.440 Test Loss: 36.079 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 57.59521269798279
Epoch: 16, Steps: 18 | Train Loss: 0.373 Vali Loss: 58.508 Vali Acc: 0.500 Test Loss: 58.508 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 52.580851316452026
Epoch: 17, Steps: 18 | Train Loss: 1.608 Vali Loss: 36.967 Vali Acc: 0.430 Test Loss: 36.967 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 56.586395502090454
Epoch: 18, Steps: 18 | Train Loss: 4.386 Vali Loss: 39.790 Vali Acc: 0.610 Test Loss: 39.790 Test Acc: 0.610
Validation loss decreased (-0.569878 --> -0.609602).  Saving model ...
Epoch: 19 cost time: 54.73016047477722
Epoch: 19, Steps: 18 | Train Loss: 7.480 Vali Loss: 42.132 Vali Acc: 0.500 Test Loss: 42.132 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 50.33939719200134
Epoch: 20, Steps: 18 | Train Loss: 5.751 Vali Loss: 58.421 Vali Acc: 0.540 Test Loss: 58.421 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 55.42793011665344
Epoch: 21, Steps: 18 | Train Loss: 7.095 Vali Loss: 67.307 Vali Acc: 0.440 Test Loss: 67.307 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 47.565361738204956
Epoch: 22, Steps: 18 | Train Loss: 3.342 Vali Loss: 111.898 Vali Acc: 0.460 Test Loss: 111.898 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 56.05298161506653
Epoch: 23, Steps: 18 | Train Loss: 5.719 Vali Loss: 60.978 Vali Acc: 0.470 Test Loss: 60.978 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 51.66016221046448
Epoch: 24, Steps: 18 | Train Loss: 3.482 Vali Loss: 64.351 Vali Acc: 0.540 Test Loss: 64.351 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 56.78089356422424
Epoch: 25, Steps: 18 | Train Loss: 2.538 Vali Loss: 47.945 Vali Acc: 0.560 Test Loss: 47.945 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 53.15587067604065
Epoch: 26, Steps: 18 | Train Loss: 6.210 Vali Loss: 56.861 Vali Acc: 0.560 Test Loss: 56.861 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 51.72300672531128
Epoch: 27, Steps: 18 | Train Loss: 3.663 Vali Loss: 46.165 Vali Acc: 0.560 Test Loss: 46.165 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 53.72990822792053
Epoch: 28, Steps: 18 | Train Loss: 5.433 Vali Loss: 75.817 Vali Acc: 0.500 Test Loss: 75.817 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 19972610
model size : 95.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 37.509308099746704
Epoch: 1, Steps: 18 | Train Loss: 2.391 Vali Loss: 2.360 Vali Acc: 0.520 Test Loss: 2.360 Test Acc: 0.520
Validation loss decreased (inf --> -0.519976).  Saving model ...
Epoch: 2 cost time: 39.050663232803345
Epoch: 2, Steps: 18 | Train Loss: 2.651 Vali Loss: 2.606 Vali Acc: 0.500 Test Loss: 2.606 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 33.202611684799194
Epoch: 3, Steps: 18 | Train Loss: 3.112 Vali Loss: 6.007 Vali Acc: 0.520 Test Loss: 6.007 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 38.35790491104126
Epoch: 4, Steps: 18 | Train Loss: 3.440 Vali Loss: 9.305 Vali Acc: 0.540 Test Loss: 9.305 Test Acc: 0.540
Validation loss decreased (-0.519976 --> -0.539907).  Saving model ...
Epoch: 5 cost time: 40.282113790512085
Epoch: 5, Steps: 18 | Train Loss: 4.381 Vali Loss: 6.459 Vali Acc: 0.540 Test Loss: 6.459 Test Acc: 0.540
Validation loss decreased (-0.539907 --> -0.539935).  Saving model ...
Epoch: 6 cost time: 36.522987604141235
Epoch: 6, Steps: 18 | Train Loss: 3.375 Vali Loss: 8.339 Vali Acc: 0.560 Test Loss: 8.339 Test Acc: 0.560
Validation loss decreased (-0.539935 --> -0.559917).  Saving model ...
Epoch: 7 cost time: 40.34607815742493
Epoch: 7, Steps: 18 | Train Loss: 2.541 Vali Loss: 29.034 Vali Acc: 0.500 Test Loss: 29.034 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 42.62786793708801
Epoch: 8, Steps: 18 | Train Loss: 4.752 Vali Loss: 8.441 Vali Acc: 0.590 Test Loss: 8.441 Test Acc: 0.590
Validation loss decreased (-0.559917 --> -0.589916).  Saving model ...
Epoch: 9 cost time: 38.07539653778076
Epoch: 9, Steps: 18 | Train Loss: 3.727 Vali Loss: 25.579 Vali Acc: 0.470 Test Loss: 25.579 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 42.08123540878296
Epoch: 10, Steps: 18 | Train Loss: 4.113 Vali Loss: 18.583 Vali Acc: 0.490 Test Loss: 18.583 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 43.591206789016724
Epoch: 11, Steps: 18 | Train Loss: 3.223 Vali Loss: 22.476 Vali Acc: 0.500 Test Loss: 22.476 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 37.56803560256958
Epoch: 12, Steps: 18 | Train Loss: 4.379 Vali Loss: 19.703 Vali Acc: 0.450 Test Loss: 19.703 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 43.17120671272278
Epoch: 13, Steps: 18 | Train Loss: 3.666 Vali Loss: 27.518 Vali Acc: 0.490 Test Loss: 27.518 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 41.16134309768677
Epoch: 14, Steps: 18 | Train Loss: 4.454 Vali Loss: 28.888 Vali Acc: 0.580 Test Loss: 28.888 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 37.10321402549744
Epoch: 15, Steps: 18 | Train Loss: 3.900 Vali Loss: 43.439 Vali Acc: 0.530 Test Loss: 43.439 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 44.10563325881958
Epoch: 16, Steps: 18 | Train Loss: 3.761 Vali Loss: 56.889 Vali Acc: 0.530 Test Loss: 56.889 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 43.19784641265869
Epoch: 17, Steps: 18 | Train Loss: 7.074 Vali Loss: 31.718 Vali Acc: 0.520 Test Loss: 31.718 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 37.52357482910156
Epoch: 18, Steps: 18 | Train Loss: 2.675 Vali Loss: 32.094 Vali Acc: 0.560 Test Loss: 32.094 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 19972610
model size : 95.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 36.47909736633301
Epoch: 1, Steps: 18 | Train Loss: 2.283 Vali Loss: 2.234 Vali Acc: 0.560 Test Loss: 2.234 Test Acc: 0.560
Validation loss decreased (inf --> -0.559978).  Saving model ...
Epoch: 2 cost time: 33.29137635231018
Epoch: 2, Steps: 18 | Train Loss: 2.485 Vali Loss: 6.315 Vali Acc: 0.480 Test Loss: 6.315 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 34.013497829437256
Epoch: 3, Steps: 18 | Train Loss: 2.745 Vali Loss: 7.184 Vali Acc: 0.540 Test Loss: 7.184 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 35.608779430389404
Epoch: 4, Steps: 18 | Train Loss: 3.907 Vali Loss: 14.607 Vali Acc: 0.490 Test Loss: 14.607 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 34.86727833747864
Epoch: 5, Steps: 18 | Train Loss: 7.904 Vali Loss: 10.028 Vali Acc: 0.530 Test Loss: 10.028 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 30.363542079925537
Epoch: 6, Steps: 18 | Train Loss: 9.129 Vali Loss: 25.472 Vali Acc: 0.520 Test Loss: 25.472 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 37.39420485496521
Epoch: 7, Steps: 18 | Train Loss: 3.859 Vali Loss: 15.381 Vali Acc: 0.520 Test Loss: 15.381 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 37.664506912231445
Epoch: 8, Steps: 18 | Train Loss: 4.736 Vali Loss: 14.334 Vali Acc: 0.590 Test Loss: 14.334 Test Acc: 0.590
Validation loss decreased (-0.559978 --> -0.589857).  Saving model ...
Epoch: 9 cost time: 34.39402198791504
Epoch: 9, Steps: 18 | Train Loss: 4.156 Vali Loss: 14.252 Vali Acc: 0.560 Test Loss: 14.252 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 35.747278451919556
Epoch: 10, Steps: 18 | Train Loss: 3.443 Vali Loss: 24.466 Vali Acc: 0.530 Test Loss: 24.466 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 36.440542459487915
Epoch: 11, Steps: 18 | Train Loss: 2.233 Vali Loss: 26.760 Vali Acc: 0.480 Test Loss: 26.760 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 33.65499401092529
Epoch: 12, Steps: 18 | Train Loss: 3.608 Vali Loss: 27.463 Vali Acc: 0.480 Test Loss: 27.463 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 32.37217688560486
Epoch: 13, Steps: 18 | Train Loss: 4.528 Vali Loss: 25.606 Vali Acc: 0.480 Test Loss: 25.606 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 38.02192211151123
Epoch: 14, Steps: 18 | Train Loss: 2.835 Vali Loss: 46.323 Vali Acc: 0.510 Test Loss: 46.323 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 38.23757743835449
Epoch: 15, Steps: 18 | Train Loss: 3.912 Vali Loss: 35.024 Vali Acc: 0.550 Test Loss: 35.024 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 33.36318826675415
Epoch: 16, Steps: 18 | Train Loss: 2.679 Vali Loss: 35.233 Vali Acc: 0.510 Test Loss: 35.233 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 38.28606605529785
Epoch: 17, Steps: 18 | Train Loss: 2.521 Vali Loss: 37.508 Vali Acc: 0.590 Test Loss: 37.508 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 38.24694585800171
Epoch: 18, Steps: 18 | Train Loss: 2.158 Vali Loss: 75.173 Vali Acc: 0.490 Test Loss: 75.173 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 19972610
model size : 95.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 28.786391258239746
Epoch: 1, Steps: 18 | Train Loss: 1.403 Vali Loss: 3.499 Vali Acc: 0.480 Test Loss: 3.499 Test Acc: 0.480
Validation loss decreased (inf --> -0.479965).  Saving model ...
Epoch: 2 cost time: 33.40978646278381
Epoch: 2, Steps: 18 | Train Loss: 1.871 Vali Loss: 3.737 Vali Acc: 0.540 Test Loss: 3.737 Test Acc: 0.540
Validation loss decreased (-0.479965 --> -0.539963).  Saving model ...
Epoch: 3 cost time: 34.902124643325806
Epoch: 3, Steps: 18 | Train Loss: 1.666 Vali Loss: 5.706 Vali Acc: 0.470 Test Loss: 5.706 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 31.04670548439026
Epoch: 4, Steps: 18 | Train Loss: 1.609 Vali Loss: 5.807 Vali Acc: 0.490 Test Loss: 5.807 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 33.2539427280426
Epoch: 5, Steps: 18 | Train Loss: 2.438 Vali Loss: 18.043 Vali Acc: 0.500 Test Loss: 18.043 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 32.74756073951721
Epoch: 6, Steps: 18 | Train Loss: 5.737 Vali Loss: 10.376 Vali Acc: 0.570 Test Loss: 10.376 Test Acc: 0.570
Validation loss decreased (-0.539963 --> -0.569896).  Saving model ...
Epoch: 7 cost time: 30.81059718132019
Epoch: 7, Steps: 18 | Train Loss: 3.529 Vali Loss: 21.862 Vali Acc: 0.490 Test Loss: 21.862 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 30.735886812210083
Epoch: 8, Steps: 18 | Train Loss: 2.300 Vali Loss: 8.776 Vali Acc: 0.570 Test Loss: 8.776 Test Acc: 0.570
Validation loss decreased (-0.569896 --> -0.569912).  Saving model ...
Epoch: 9 cost time: 37.67785096168518
Epoch: 9, Steps: 18 | Train Loss: 1.541 Vali Loss: 35.018 Vali Acc: 0.490 Test Loss: 35.018 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 37.633153676986694
Epoch: 10, Steps: 18 | Train Loss: 3.027 Vali Loss: 29.059 Vali Acc: 0.490 Test Loss: 29.059 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 32.88751220703125
Epoch: 11, Steps: 18 | Train Loss: 3.057 Vali Loss: 16.712 Vali Acc: 0.540 Test Loss: 16.712 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 33.365556955337524
Epoch: 12, Steps: 18 | Train Loss: 4.057 Vali Loss: 26.704 Vali Acc: 0.510 Test Loss: 26.704 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 30.94463038444519
Epoch: 13, Steps: 18 | Train Loss: 9.866 Vali Loss: 25.383 Vali Acc: 0.530 Test Loss: 25.383 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 35.18212008476257
Epoch: 14, Steps: 18 | Train Loss: 3.192 Vali Loss: 32.398 Vali Acc: 0.530 Test Loss: 32.398 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 32.23641300201416
Epoch: 15, Steps: 18 | Train Loss: 2.034 Vali Loss: 35.383 Vali Acc: 0.470 Test Loss: 35.383 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 37.30671977996826
Epoch: 16, Steps: 18 | Train Loss: 6.107 Vali Loss: 48.555 Vali Acc: 0.510 Test Loss: 48.555 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 35.999143838882446
Epoch: 17, Steps: 18 | Train Loss: 1.748 Vali Loss: 31.792 Vali Acc: 0.470 Test Loss: 31.792 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 29.99228286743164
Epoch: 18, Steps: 18 | Train Loss: 5.012 Vali Loss: 36.997 Vali Acc: 0.580 Test Loss: 36.997 Test Acc: 0.580
Validation loss decreased (-0.569912 --> -0.579630).  Saving model ...
Epoch: 19 cost time: 32.62229013442993
Epoch: 19, Steps: 18 | Train Loss: 0.994 Vali Loss: 31.354 Vali Acc: 0.480 Test Loss: 31.354 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 34.97496724128723
Epoch: 20, Steps: 18 | Train Loss: 4.096 Vali Loss: 34.876 Vali Acc: 0.500 Test Loss: 34.876 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 36.72207164764404
Epoch: 21, Steps: 18 | Train Loss: 1.261 Vali Loss: 36.527 Vali Acc: 0.550 Test Loss: 36.527 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 32.93605971336365
Epoch: 22, Steps: 18 | Train Loss: 1.868 Vali Loss: 37.153 Vali Acc: 0.550 Test Loss: 37.153 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 37.09757351875305
Epoch: 23, Steps: 18 | Train Loss: 2.666 Vali Loss: 25.158 Vali Acc: 0.570 Test Loss: 25.158 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 35.67100644111633
Epoch: 24, Steps: 18 | Train Loss: 3.332 Vali Loss: 34.415 Vali Acc: 0.560 Test Loss: 34.415 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 29.292309999465942
Epoch: 25, Steps: 18 | Train Loss: 1.409 Vali Loss: 31.906 Vali Acc: 0.550 Test Loss: 31.906 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 29.27984070777893
Epoch: 26, Steps: 18 | Train Loss: 3.615 Vali Loss: 30.003 Vali Acc: 0.550 Test Loss: 30.003 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 27.444785833358765
Epoch: 27, Steps: 18 | Train Loss: 2.489 Vali Loss: 58.020 Vali Acc: 0.530 Test Loss: 58.020 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 27.50562882423401
Epoch: 28, Steps: 18 | Train Loss: 5.490 Vali Loss: 48.901 Vali Acc: 0.490 Test Loss: 48.901 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 19972610
model size : 95.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 30.057043313980103
Epoch: 1, Steps: 18 | Train Loss: 1.900 Vali Loss: 4.840 Vali Acc: 0.510 Test Loss: 4.840 Test Acc: 0.510
Validation loss decreased (inf --> -0.509952).  Saving model ...
Epoch: 2 cost time: 31.958490133285522
Epoch: 2, Steps: 18 | Train Loss: 2.721 Vali Loss: 5.917 Vali Acc: 0.510 Test Loss: 5.917 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 30.47375202178955
Epoch: 3, Steps: 18 | Train Loss: 1.960 Vali Loss: 9.429 Vali Acc: 0.530 Test Loss: 9.429 Test Acc: 0.530
Validation loss decreased (-0.509952 --> -0.529906).  Saving model ...
Epoch: 4 cost time: 32.77594327926636
Epoch: 4, Steps: 18 | Train Loss: 3.634 Vali Loss: 17.893 Vali Acc: 0.530 Test Loss: 17.893 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 28.261831045150757
Epoch: 5, Steps: 18 | Train Loss: 4.362 Vali Loss: 10.519 Vali Acc: 0.540 Test Loss: 10.519 Test Acc: 0.540
Validation loss decreased (-0.529906 --> -0.539895).  Saving model ...
Epoch: 6 cost time: 28.424566745758057
Epoch: 6, Steps: 18 | Train Loss: 2.119 Vali Loss: 8.528 Vali Acc: 0.520 Test Loss: 8.528 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 29.719218969345093
Epoch: 7, Steps: 18 | Train Loss: 2.441 Vali Loss: 12.120 Vali Acc: 0.520 Test Loss: 12.120 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 34.150694847106934
Epoch: 8, Steps: 18 | Train Loss: 2.482 Vali Loss: 17.517 Vali Acc: 0.620 Test Loss: 17.517 Test Acc: 0.620
Validation loss decreased (-0.539895 --> -0.619825).  Saving model ...
Epoch: 9 cost time: 31.12201166152954
Epoch: 9, Steps: 18 | Train Loss: 4.476 Vali Loss: 31.060 Vali Acc: 0.500 Test Loss: 31.060 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 28.00662064552307
Epoch: 10, Steps: 18 | Train Loss: 5.394 Vali Loss: 14.985 Vali Acc: 0.470 Test Loss: 14.985 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 31.391979694366455
Epoch: 11, Steps: 18 | Train Loss: 1.730 Vali Loss: 22.906 Vali Acc: 0.430 Test Loss: 22.906 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 33.02930736541748
Epoch: 12, Steps: 18 | Train Loss: 6.945 Vali Loss: 17.218 Vali Acc: 0.480 Test Loss: 17.218 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 32.554423093795776
Epoch: 13, Steps: 18 | Train Loss: 6.778 Vali Loss: 23.224 Vali Acc: 0.550 Test Loss: 23.224 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 28.10675883293152
Epoch: 14, Steps: 18 | Train Loss: 3.358 Vali Loss: 19.277 Vali Acc: 0.550 Test Loss: 19.277 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 32.960044145584106
Epoch: 15, Steps: 18 | Train Loss: 3.015 Vali Loss: 40.895 Vali Acc: 0.520 Test Loss: 40.895 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 31.960190534591675
Epoch: 16, Steps: 18 | Train Loss: 1.452 Vali Loss: 15.547 Vali Acc: 0.530 Test Loss: 15.547 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 31.448315858840942
Epoch: 17, Steps: 18 | Train Loss: 1.865 Vali Loss: 44.874 Vali Acc: 0.390 Test Loss: 44.874 Test Acc: 0.390
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 28.534893035888672
Epoch: 18, Steps: 18 | Train Loss: 1.371 Vali Loss: 10.328 Vali Acc: 0.490 Test Loss: 10.328 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 19972610
model size : 95.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 30.77220869064331
Epoch: 1, Steps: 18 | Train Loss: 1.300 Vali Loss: 2.705 Vali Acc: 0.500 Test Loss: 2.705 Test Acc: 0.500
Validation loss decreased (inf --> -0.499973).  Saving model ...
Epoch: 2 cost time: 30.452467679977417
Epoch: 2, Steps: 18 | Train Loss: 2.186 Vali Loss: 1.159 Vali Acc: 0.590 Test Loss: 1.159 Test Acc: 0.590
Validation loss decreased (-0.499973 --> -0.589988).  Saving model ...
Epoch: 3 cost time: 27.116987943649292
Epoch: 3, Steps: 18 | Train Loss: 1.974 Vali Loss: 4.098 Vali Acc: 0.500 Test Loss: 4.098 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 29.59268856048584
Epoch: 4, Steps: 18 | Train Loss: 2.648 Vali Loss: 2.077 Vali Acc: 0.570 Test Loss: 2.077 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 30.72719430923462
Epoch: 5, Steps: 18 | Train Loss: 1.184 Vali Loss: 14.179 Vali Acc: 0.500 Test Loss: 14.179 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 30.345069408416748
Epoch: 6, Steps: 18 | Train Loss: 4.304 Vali Loss: 5.967 Vali Acc: 0.490 Test Loss: 5.967 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 23.461455821990967
Epoch: 7, Steps: 18 | Train Loss: 1.329 Vali Loss: 3.192 Vali Acc: 0.490 Test Loss: 3.192 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 32.01274085044861
Epoch: 8, Steps: 18 | Train Loss: 1.700 Vali Loss: 5.302 Vali Acc: 0.510 Test Loss: 5.302 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 30.382123947143555
Epoch: 9, Steps: 18 | Train Loss: 1.045 Vali Loss: 13.396 Vali Acc: 0.500 Test Loss: 13.396 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 30.57339382171631
Epoch: 10, Steps: 18 | Train Loss: 4.129 Vali Loss: 5.781 Vali Acc: 0.490 Test Loss: 5.781 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 28.083513021469116
Epoch: 11, Steps: 18 | Train Loss: 0.850 Vali Loss: 7.609 Vali Acc: 0.480 Test Loss: 7.609 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 33.06205129623413
Epoch: 12, Steps: 18 | Train Loss: 0.999 Vali Loss: 7.207 Vali Acc: 0.470 Test Loss: 7.207 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 19972610
model size : 95.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 123.29482865333557
Epoch: 1, Steps: 18 | Train Loss: 2.120 Vali Loss: 4.722 Vali Acc: 0.520 Test Loss: 4.722 Test Acc: 0.520
Validation loss decreased (inf --> -0.519953).  Saving model ...
Epoch: 2 cost time: 120.40103125572205
Epoch: 2, Steps: 18 | Train Loss: 4.001 Vali Loss: 6.836 Vali Acc: 0.500 Test Loss: 6.836 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 123.66171360015869
Epoch: 3, Steps: 18 | Train Loss: 5.128 Vali Loss: 14.236 Vali Acc: 0.490 Test Loss: 14.236 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 122.65695548057556
Epoch: 4, Steps: 18 | Train Loss: 3.219 Vali Loss: 6.998 Vali Acc: 0.470 Test Loss: 6.998 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 120.41014218330383
Epoch: 5, Steps: 18 | Train Loss: 2.879 Vali Loss: 13.228 Vali Acc: 0.460 Test Loss: 13.228 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 139.73094964027405
Epoch: 6, Steps: 18 | Train Loss: 7.099 Vali Loss: 11.155 Vali Acc: 0.520 Test Loss: 11.155 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 127.39634370803833
Epoch: 7, Steps: 18 | Train Loss: 6.357 Vali Loss: 9.397 Vali Acc: 0.540 Test Loss: 9.397 Test Acc: 0.540
Validation loss decreased (-0.519953 --> -0.539906).  Saving model ...
Epoch: 8 cost time: 149.56048250198364
Epoch: 8, Steps: 18 | Train Loss: 3.865 Vali Loss: 36.522 Vali Acc: 0.490 Test Loss: 36.522 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 149.59865379333496
Epoch: 9, Steps: 18 | Train Loss: 4.672 Vali Loss: 17.072 Vali Acc: 0.510 Test Loss: 17.072 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 156.6483931541443
Epoch: 10, Steps: 18 | Train Loss: 6.493 Vali Loss: 23.748 Vali Acc: 0.460 Test Loss: 23.748 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 155.8279628753662
Epoch: 11, Steps: 18 | Train Loss: 8.193 Vali Loss: 39.463 Vali Acc: 0.530 Test Loss: 39.463 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 160.76702785491943
Epoch: 12, Steps: 18 | Train Loss: 3.150 Vali Loss: 25.918 Vali Acc: 0.500 Test Loss: 25.918 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 155.5427360534668
Epoch: 13, Steps: 18 | Train Loss: 4.425 Vali Loss: 48.511 Vali Acc: 0.520 Test Loss: 48.511 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 161.7312126159668
Epoch: 14, Steps: 18 | Train Loss: 2.224 Vali Loss: 45.528 Vali Acc: 0.490 Test Loss: 45.528 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 156.44983530044556
Epoch: 15, Steps: 18 | Train Loss: 3.701 Vali Loss: 25.856 Vali Acc: 0.530 Test Loss: 25.856 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 151.31562900543213
Epoch: 16, Steps: 18 | Train Loss: 7.773 Vali Loss: 61.325 Vali Acc: 0.530 Test Loss: 61.325 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 155.75880479812622
Epoch: 17, Steps: 18 | Train Loss: 5.602 Vali Loss: 33.615 Vali Acc: 0.580 Test Loss: 33.615 Test Acc: 0.580
Validation loss decreased (-0.539906 --> -0.579664).  Saving model ...
Epoch: 18 cost time: 158.4201865196228
Epoch: 18, Steps: 18 | Train Loss: 6.633 Vali Loss: 100.115 Vali Acc: 0.500 Test Loss: 100.115 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 146.84752082824707
Epoch: 19, Steps: 18 | Train Loss: 4.291 Vali Loss: 32.886 Vali Acc: 0.480 Test Loss: 32.886 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 152.45624685287476
Epoch: 20, Steps: 18 | Train Loss: 5.632 Vali Loss: 88.194 Vali Acc: 0.520 Test Loss: 88.194 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 155.44618272781372
Epoch: 21, Steps: 18 | Train Loss: 4.555 Vali Loss: 69.201 Vali Acc: 0.520 Test Loss: 69.201 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 156.51425957679749
Epoch: 22, Steps: 18 | Train Loss: 2.332 Vali Loss: 56.478 Vali Acc: 0.530 Test Loss: 56.478 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 154.90552520751953
Epoch: 23, Steps: 18 | Train Loss: 2.101 Vali Loss: 57.806 Vali Acc: 0.510 Test Loss: 57.806 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 153.56923365592957
Epoch: 24, Steps: 18 | Train Loss: 2.855 Vali Loss: 57.151 Vali Acc: 0.520 Test Loss: 57.151 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 159.36705923080444
Epoch: 25, Steps: 18 | Train Loss: 2.317 Vali Loss: 98.004 Vali Acc: 0.520 Test Loss: 98.004 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 150.3084545135498
Epoch: 26, Steps: 18 | Train Loss: 2.493 Vali Loss: 57.971 Vali Acc: 0.550 Test Loss: 57.971 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 154.4820945262909
Epoch: 27, Steps: 18 | Train Loss: 10.190 Vali Loss: 147.297 Vali Acc: 0.530 Test Loss: 147.297 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 16826882
model size : 83.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 93.01075601577759
Epoch: 1, Steps: 18 | Train Loss: 2.034 Vali Loss: 6.838 Vali Acc: 0.490 Test Loss: 6.838 Test Acc: 0.490
Validation loss decreased (inf --> -0.489932).  Saving model ...
Epoch: 2 cost time: 92.32724714279175
Epoch: 2, Steps: 18 | Train Loss: 2.978 Vali Loss: 4.959 Vali Acc: 0.450 Test Loss: 4.959 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 94.25895071029663
Epoch: 3, Steps: 18 | Train Loss: 3.877 Vali Loss: 20.495 Vali Acc: 0.500 Test Loss: 20.495 Test Acc: 0.500
Validation loss decreased (-0.489932 --> -0.499795).  Saving model ...
Epoch: 4 cost time: 98.73660945892334
Epoch: 4, Steps: 18 | Train Loss: 5.799 Vali Loss: 7.272 Vali Acc: 0.510 Test Loss: 7.272 Test Acc: 0.510
Validation loss decreased (-0.499795 --> -0.509927).  Saving model ...
Epoch: 5 cost time: 83.56367039680481
Epoch: 5, Steps: 18 | Train Loss: 2.910 Vali Loss: 24.792 Vali Acc: 0.500 Test Loss: 24.792 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 110.84881043434143
Epoch: 6, Steps: 18 | Train Loss: 8.988 Vali Loss: 13.498 Vali Acc: 0.570 Test Loss: 13.498 Test Acc: 0.570
Validation loss decreased (-0.509927 --> -0.569865).  Saving model ...
Epoch: 7 cost time: 109.16348910331726
Epoch: 7, Steps: 18 | Train Loss: 2.517 Vali Loss: 24.261 Vali Acc: 0.520 Test Loss: 24.261 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 116.5080361366272
Epoch: 8, Steps: 18 | Train Loss: 5.760 Vali Loss: 28.922 Vali Acc: 0.530 Test Loss: 28.922 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 123.27446818351746
Epoch: 9, Steps: 18 | Train Loss: 3.175 Vali Loss: 24.387 Vali Acc: 0.490 Test Loss: 24.387 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 121.03013396263123
Epoch: 10, Steps: 18 | Train Loss: 2.892 Vali Loss: 39.768 Vali Acc: 0.510 Test Loss: 39.768 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 116.90401983261108
Epoch: 11, Steps: 18 | Train Loss: 8.980 Vali Loss: 18.822 Vali Acc: 0.490 Test Loss: 18.822 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 128.4985706806183
Epoch: 12, Steps: 18 | Train Loss: 3.296 Vali Loss: 22.684 Vali Acc: 0.490 Test Loss: 22.684 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 126.88935112953186
Epoch: 13, Steps: 18 | Train Loss: 2.878 Vali Loss: 25.250 Vali Acc: 0.530 Test Loss: 25.250 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 128.10301613807678
Epoch: 14, Steps: 18 | Train Loss: 2.336 Vali Loss: 54.196 Vali Acc: 0.540 Test Loss: 54.196 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 127.42920994758606
Epoch: 15, Steps: 18 | Train Loss: 3.610 Vali Loss: 25.678 Vali Acc: 0.510 Test Loss: 25.678 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 126.68673157691956
Epoch: 16, Steps: 18 | Train Loss: 6.043 Vali Loss: 28.140 Vali Acc: 0.560 Test Loss: 28.140 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 16826882
model size : 83.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 78.90817880630493
Epoch: 1, Steps: 18 | Train Loss: 2.044 Vali Loss: 2.135 Vali Acc: 0.510 Test Loss: 2.135 Test Acc: 0.510
Validation loss decreased (inf --> -0.509979).  Saving model ...
Epoch: 2 cost time: 75.20371341705322
Epoch: 2, Steps: 18 | Train Loss: 2.645 Vali Loss: 3.914 Vali Acc: 0.520 Test Loss: 3.914 Test Acc: 0.520
Validation loss decreased (-0.509979 --> -0.519961).  Saving model ...
Epoch: 3 cost time: 72.5841817855835
Epoch: 3, Steps: 18 | Train Loss: 7.335 Vali Loss: 9.205 Vali Acc: 0.520 Test Loss: 9.205 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 83.0323555469513
Epoch: 4, Steps: 18 | Train Loss: 6.613 Vali Loss: 12.558 Vali Acc: 0.510 Test Loss: 12.558 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 81.67633414268494
Epoch: 5, Steps: 18 | Train Loss: 3.549 Vali Loss: 18.000 Vali Acc: 0.550 Test Loss: 18.000 Test Acc: 0.550
Validation loss decreased (-0.519961 --> -0.549820).  Saving model ...
Epoch: 6 cost time: 82.3877546787262
Epoch: 6, Steps: 18 | Train Loss: 2.892 Vali Loss: 10.828 Vali Acc: 0.500 Test Loss: 10.828 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 89.69710946083069
Epoch: 7, Steps: 18 | Train Loss: 3.425 Vali Loss: 38.202 Vali Acc: 0.520 Test Loss: 38.202 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 91.91064620018005
Epoch: 8, Steps: 18 | Train Loss: 11.310 Vali Loss: 26.509 Vali Acc: 0.520 Test Loss: 26.509 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 89.64627480506897
Epoch: 9, Steps: 18 | Train Loss: 6.431 Vali Loss: 54.722 Vali Acc: 0.510 Test Loss: 54.722 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 84.32033729553223
Epoch: 10, Steps: 18 | Train Loss: 13.597 Vali Loss: 37.306 Vali Acc: 0.530 Test Loss: 37.306 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 92.89389252662659
Epoch: 11, Steps: 18 | Train Loss: 7.497 Vali Loss: 29.952 Vali Acc: 0.540 Test Loss: 29.952 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 91.62770915031433
Epoch: 12, Steps: 18 | Train Loss: 8.155 Vali Loss: 65.321 Vali Acc: 0.530 Test Loss: 65.321 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 87.64682841300964
Epoch: 13, Steps: 18 | Train Loss: 4.506 Vali Loss: 51.600 Vali Acc: 0.530 Test Loss: 51.600 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 93.91971397399902
Epoch: 14, Steps: 18 | Train Loss: 3.334 Vali Loss: 28.407 Vali Acc: 0.490 Test Loss: 28.407 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 95.59200692176819
Epoch: 15, Steps: 18 | Train Loss: 1.928 Vali Loss: 20.338 Vali Acc: 0.620 Test Loss: 20.338 Test Acc: 0.620
Validation loss decreased (-0.549820 --> -0.619797).  Saving model ...
Epoch: 16 cost time: 101.43350553512573
Epoch: 16, Steps: 18 | Train Loss: 3.437 Vali Loss: 34.557 Vali Acc: 0.600 Test Loss: 34.557 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 95.90497183799744
Epoch: 17, Steps: 18 | Train Loss: 2.849 Vali Loss: 48.651 Vali Acc: 0.510 Test Loss: 48.651 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 92.44009828567505
Epoch: 18, Steps: 18 | Train Loss: 3.605 Vali Loss: 46.150 Vali Acc: 0.560 Test Loss: 46.150 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 91.01580262184143
Epoch: 19, Steps: 18 | Train Loss: 3.695 Vali Loss: 45.083 Vali Acc: 0.520 Test Loss: 45.083 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 96.1764748096466
Epoch: 20, Steps: 18 | Train Loss: 5.457 Vali Loss: 47.345 Vali Acc: 0.540 Test Loss: 47.345 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 100.34849143028259
Epoch: 21, Steps: 18 | Train Loss: 1.247 Vali Loss: 77.321 Vali Acc: 0.520 Test Loss: 77.321 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 95.11389136314392
Epoch: 22, Steps: 18 | Train Loss: 2.274 Vali Loss: 46.519 Vali Acc: 0.490 Test Loss: 46.519 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 90.98977637290955
Epoch: 23, Steps: 18 | Train Loss: 4.503 Vali Loss: 106.296 Vali Acc: 0.530 Test Loss: 106.296 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 86.79518151283264
Epoch: 24, Steps: 18 | Train Loss: 4.053 Vali Loss: 40.730 Vali Acc: 0.580 Test Loss: 40.730 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 96.40931749343872
Epoch: 25, Steps: 18 | Train Loss: 5.677 Vali Loss: 43.404 Vali Acc: 0.600 Test Loss: 43.404 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 16826882
model size : 83.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 59.401506662368774
Epoch: 1, Steps: 18 | Train Loss: 1.931 Vali Loss: 2.743 Vali Acc: 0.500 Test Loss: 2.743 Test Acc: 0.500
Validation loss decreased (inf --> -0.499973).  Saving model ...
Epoch: 2 cost time: 53.15614557266235
Epoch: 2, Steps: 18 | Train Loss: 2.461 Vali Loss: 8.193 Vali Acc: 0.510 Test Loss: 8.193 Test Acc: 0.510
Validation loss decreased (-0.499973 --> -0.509918).  Saving model ...
Epoch: 3 cost time: 60.08645248413086
Epoch: 3, Steps: 18 | Train Loss: 2.756 Vali Loss: 7.367 Vali Acc: 0.520 Test Loss: 7.367 Test Acc: 0.520
Validation loss decreased (-0.509918 --> -0.519926).  Saving model ...
Epoch: 4 cost time: 53.3003945350647
Epoch: 4, Steps: 18 | Train Loss: 3.526 Vali Loss: 14.931 Vali Acc: 0.530 Test Loss: 14.931 Test Acc: 0.530
Validation loss decreased (-0.519926 --> -0.529851).  Saving model ...
Epoch: 5 cost time: 49.66762042045593
Epoch: 5, Steps: 18 | Train Loss: 4.022 Vali Loss: 21.231 Vali Acc: 0.500 Test Loss: 21.231 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 63.271337270736694
Epoch: 6, Steps: 18 | Train Loss: 2.030 Vali Loss: 12.720 Vali Acc: 0.480 Test Loss: 12.720 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 62.190659523010254
Epoch: 7, Steps: 18 | Train Loss: 6.008 Vali Loss: 15.247 Vali Acc: 0.500 Test Loss: 15.247 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 72.2663848400116
Epoch: 8, Steps: 18 | Train Loss: 6.139 Vali Loss: 30.861 Vali Acc: 0.500 Test Loss: 30.861 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 63.40370035171509
Epoch: 9, Steps: 18 | Train Loss: 4.698 Vali Loss: 33.835 Vali Acc: 0.510 Test Loss: 33.835 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 73.19113850593567
Epoch: 10, Steps: 18 | Train Loss: 4.736 Vali Loss: 47.480 Vali Acc: 0.490 Test Loss: 47.480 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 77.15144371986389
Epoch: 11, Steps: 18 | Train Loss: 2.056 Vali Loss: 23.085 Vali Acc: 0.490 Test Loss: 23.085 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 71.96889019012451
Epoch: 12, Steps: 18 | Train Loss: 2.142 Vali Loss: 33.261 Vali Acc: 0.560 Test Loss: 33.261 Test Acc: 0.560
Validation loss decreased (-0.529851 --> -0.559667).  Saving model ...
Epoch: 13 cost time: 73.26712107658386
Epoch: 13, Steps: 18 | Train Loss: 3.954 Vali Loss: 37.208 Vali Acc: 0.460 Test Loss: 37.208 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 74.35731625556946
Epoch: 14, Steps: 18 | Train Loss: 5.469 Vali Loss: 28.979 Vali Acc: 0.530 Test Loss: 28.979 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 65.44791340827942
Epoch: 15, Steps: 18 | Train Loss: 12.354 Vali Loss: 75.612 Vali Acc: 0.520 Test Loss: 75.612 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 71.68813800811768
Epoch: 16, Steps: 18 | Train Loss: 9.914 Vali Loss: 23.653 Vali Acc: 0.490 Test Loss: 23.653 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 69.72372031211853
Epoch: 17, Steps: 18 | Train Loss: 2.074 Vali Loss: 72.162 Vali Acc: 0.510 Test Loss: 72.162 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 68.78716492652893
Epoch: 18, Steps: 18 | Train Loss: 3.114 Vali Loss: 38.709 Vali Acc: 0.510 Test Loss: 38.709 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 76.4392192363739
Epoch: 19, Steps: 18 | Train Loss: 3.094 Vali Loss: 41.790 Vali Acc: 0.520 Test Loss: 41.790 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 68.46876239776611
Epoch: 20, Steps: 18 | Train Loss: 2.325 Vali Loss: 100.406 Vali Acc: 0.470 Test Loss: 100.406 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 75.33074426651001
Epoch: 21, Steps: 18 | Train Loss: 5.098 Vali Loss: 39.212 Vali Acc: 0.530 Test Loss: 39.212 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 73.64363718032837
Epoch: 22, Steps: 18 | Train Loss: 3.859 Vali Loss: 65.479 Vali Acc: 0.530 Test Loss: 65.479 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 16826882
model size : 83.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 36.835652112960815
Epoch: 1, Steps: 18 | Train Loss: 1.576 Vali Loss: 2.032 Vali Acc: 0.480 Test Loss: 2.032 Test Acc: 0.480
Validation loss decreased (inf --> -0.479980).  Saving model ...
Epoch: 2 cost time: 42.295315742492676
Epoch: 2, Steps: 18 | Train Loss: 1.875 Vali Loss: 12.938 Vali Acc: 0.500 Test Loss: 12.938 Test Acc: 0.500
Validation loss decreased (-0.479980 --> -0.499871).  Saving model ...
Epoch: 3 cost time: 42.726399183273315
Epoch: 3, Steps: 18 | Train Loss: 5.046 Vali Loss: 5.146 Vali Acc: 0.560 Test Loss: 5.146 Test Acc: 0.560
Validation loss decreased (-0.499871 --> -0.559949).  Saving model ...
Epoch: 4 cost time: 37.397629499435425
Epoch: 4, Steps: 18 | Train Loss: 2.596 Vali Loss: 8.670 Vali Acc: 0.520 Test Loss: 8.670 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 44.50261998176575
Epoch: 5, Steps: 18 | Train Loss: 3.103 Vali Loss: 9.810 Vali Acc: 0.580 Test Loss: 9.810 Test Acc: 0.580
Validation loss decreased (-0.559949 --> -0.579902).  Saving model ...
Epoch: 6 cost time: 43.9877450466156
Epoch: 6, Steps: 18 | Train Loss: 6.482 Vali Loss: 15.166 Vali Acc: 0.560 Test Loss: 15.166 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 40.5810489654541
Epoch: 7, Steps: 18 | Train Loss: 5.472 Vali Loss: 12.574 Vali Acc: 0.500 Test Loss: 12.574 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 36.07198095321655
Epoch: 8, Steps: 18 | Train Loss: 1.628 Vali Loss: 28.732 Vali Acc: 0.520 Test Loss: 28.732 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 38.926960706710815
Epoch: 9, Steps: 18 | Train Loss: 4.086 Vali Loss: 19.958 Vali Acc: 0.500 Test Loss: 19.958 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 50.401005029678345
Epoch: 10, Steps: 18 | Train Loss: 5.242 Vali Loss: 21.604 Vali Acc: 0.520 Test Loss: 21.604 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 46.7714638710022
Epoch: 11, Steps: 18 | Train Loss: 3.981 Vali Loss: 18.275 Vali Acc: 0.540 Test Loss: 18.275 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 49.41601324081421
Epoch: 12, Steps: 18 | Train Loss: 0.782 Vali Loss: 45.634 Vali Acc: 0.520 Test Loss: 45.634 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 48.71527290344238
Epoch: 13, Steps: 18 | Train Loss: 6.961 Vali Loss: 28.024 Vali Acc: 0.490 Test Loss: 28.024 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 45.43983244895935
Epoch: 14, Steps: 18 | Train Loss: 5.541 Vali Loss: 34.880 Vali Acc: 0.550 Test Loss: 34.880 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 49.84929704666138
Epoch: 15, Steps: 18 | Train Loss: 5.055 Vali Loss: 79.126 Vali Acc: 0.500 Test Loss: 79.126 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 16826882
model size : 83.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 32.496017932891846
Epoch: 1, Steps: 18 | Train Loss: 1.633 Vali Loss: 2.326 Vali Acc: 0.470 Test Loss: 2.326 Test Acc: 0.470
Validation loss decreased (inf --> -0.469977).  Saving model ...
Epoch: 2 cost time: 35.86794114112854
Epoch: 2, Steps: 18 | Train Loss: 2.058 Vali Loss: 4.247 Vali Acc: 0.490 Test Loss: 4.247 Test Acc: 0.490
Validation loss decreased (-0.469977 --> -0.489958).  Saving model ...
Epoch: 3 cost time: 35.0214900970459
Epoch: 3, Steps: 18 | Train Loss: 2.706 Vali Loss: 11.535 Vali Acc: 0.510 Test Loss: 11.535 Test Acc: 0.510
Validation loss decreased (-0.489958 --> -0.509885).  Saving model ...
Epoch: 4 cost time: 28.011986255645752
Epoch: 4, Steps: 18 | Train Loss: 2.956 Vali Loss: 11.046 Vali Acc: 0.500 Test Loss: 11.046 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 32.81433391571045
Epoch: 5, Steps: 18 | Train Loss: 3.250 Vali Loss: 6.844 Vali Acc: 0.530 Test Loss: 6.844 Test Acc: 0.530
Validation loss decreased (-0.509885 --> -0.529932).  Saving model ...
Epoch: 6 cost time: 33.10502529144287
Epoch: 6, Steps: 18 | Train Loss: 3.037 Vali Loss: 28.474 Vali Acc: 0.480 Test Loss: 28.474 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 34.14076375961304
Epoch: 7, Steps: 18 | Train Loss: 5.065 Vali Loss: 34.260 Vali Acc: 0.500 Test Loss: 34.260 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 36.51504063606262
Epoch: 8, Steps: 18 | Train Loss: 9.810 Vali Loss: 14.974 Vali Acc: 0.520 Test Loss: 14.974 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 39.68865990638733
Epoch: 9, Steps: 18 | Train Loss: 2.622 Vali Loss: 21.317 Vali Acc: 0.470 Test Loss: 21.317 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 36.490835428237915
Epoch: 10, Steps: 18 | Train Loss: 2.138 Vali Loss: 30.452 Vali Acc: 0.480 Test Loss: 30.452 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 29.489107847213745
Epoch: 11, Steps: 18 | Train Loss: 3.507 Vali Loss: 45.311 Vali Acc: 0.490 Test Loss: 45.311 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 37.54689621925354
Epoch: 12, Steps: 18 | Train Loss: 6.395 Vali Loss: 41.081 Vali Acc: 0.520 Test Loss: 41.081 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 36.19918727874756
Epoch: 13, Steps: 18 | Train Loss: 8.417 Vali Loss: 47.965 Vali Acc: 0.470 Test Loss: 47.965 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 33.111464977264404
Epoch: 14, Steps: 18 | Train Loss: 12.636 Vali Loss: 70.235 Vali Acc: 0.520 Test Loss: 70.235 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 38.231629610061646
Epoch: 15, Steps: 18 | Train Loss: 4.459 Vali Loss: 35.085 Vali Acc: 0.470 Test Loss: 35.085 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 16826882
model size : 83.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 28.424072980880737
Epoch: 1, Steps: 18 | Train Loss: 1.693 Vali Loss: 1.738 Vali Acc: 0.530 Test Loss: 1.738 Test Acc: 0.530
Validation loss decreased (inf --> -0.529983).  Saving model ...
Epoch: 2 cost time: 26.506937742233276
Epoch: 2, Steps: 18 | Train Loss: 1.973 Vali Loss: 2.981 Vali Acc: 0.560 Test Loss: 2.981 Test Acc: 0.560
Validation loss decreased (-0.529983 --> -0.559970).  Saving model ...
Epoch: 3 cost time: 32.027682304382324
Epoch: 3, Steps: 18 | Train Loss: 2.333 Vali Loss: 8.441 Vali Acc: 0.510 Test Loss: 8.441 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 31.276100397109985
Epoch: 4, Steps: 18 | Train Loss: 2.037 Vali Loss: 14.256 Vali Acc: 0.490 Test Loss: 14.256 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 28.73613715171814
Epoch: 5, Steps: 18 | Train Loss: 3.297 Vali Loss: 6.941 Vali Acc: 0.550 Test Loss: 6.941 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 29.171035051345825
Epoch: 6, Steps: 18 | Train Loss: 3.489 Vali Loss: 15.652 Vali Acc: 0.530 Test Loss: 15.652 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 31.476948022842407
Epoch: 7, Steps: 18 | Train Loss: 1.485 Vali Loss: 18.921 Vali Acc: 0.510 Test Loss: 18.921 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 28.620234727859497
Epoch: 8, Steps: 18 | Train Loss: 1.896 Vali Loss: 18.011 Vali Acc: 0.510 Test Loss: 18.011 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 30.569525003433228
Epoch: 9, Steps: 18 | Train Loss: 2.155 Vali Loss: 18.657 Vali Acc: 0.520 Test Loss: 18.657 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 32.074615716934204
Epoch: 10, Steps: 18 | Train Loss: 2.244 Vali Loss: 17.755 Vali Acc: 0.540 Test Loss: 17.755 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 33.26718616485596
Epoch: 11, Steps: 18 | Train Loss: 2.566 Vali Loss: 40.694 Vali Acc: 0.490 Test Loss: 40.694 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 29.895920515060425
Epoch: 12, Steps: 18 | Train Loss: 4.217 Vali Loss: 25.243 Vali Acc: 0.480 Test Loss: 25.243 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 16826882
model size : 83.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 30.168484926223755
Epoch: 1, Steps: 18 | Train Loss: 1.825 Vali Loss: 1.340 Vali Acc: 0.600 Test Loss: 1.340 Test Acc: 0.600
Validation loss decreased (inf --> -0.599987).  Saving model ...
Epoch: 2 cost time: 31.70766043663025
Epoch: 2, Steps: 18 | Train Loss: 2.231 Vali Loss: 6.557 Vali Acc: 0.530 Test Loss: 6.557 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.078832149505615
Epoch: 3, Steps: 18 | Train Loss: 5.076 Vali Loss: 10.912 Vali Acc: 0.500 Test Loss: 10.912 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.832384824752808
Epoch: 4, Steps: 18 | Train Loss: 5.072 Vali Loss: 7.521 Vali Acc: 0.460 Test Loss: 7.521 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 29.806427001953125
Epoch: 5, Steps: 18 | Train Loss: 2.027 Vali Loss: 12.017 Vali Acc: 0.470 Test Loss: 12.017 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 29.448047161102295
Epoch: 6, Steps: 18 | Train Loss: 1.896 Vali Loss: 6.720 Vali Acc: 0.510 Test Loss: 6.720 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 26.840294122695923
Epoch: 7, Steps: 18 | Train Loss: 1.640 Vali Loss: 7.640 Vali Acc: 0.530 Test Loss: 7.640 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 27.173256397247314
Epoch: 8, Steps: 18 | Train Loss: 2.165 Vali Loss: 14.291 Vali Acc: 0.560 Test Loss: 14.291 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 29.84770703315735
Epoch: 9, Steps: 18 | Train Loss: 2.127 Vali Loss: 38.905 Vali Acc: 0.500 Test Loss: 38.905 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 31.382879734039307
Epoch: 10, Steps: 18 | Train Loss: 5.420 Vali Loss: 18.648 Vali Acc: 0.570 Test Loss: 18.648 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 27.30452537536621
Epoch: 11, Steps: 18 | Train Loss: 2.715 Vali Loss: 22.729 Vali Acc: 0.510 Test Loss: 22.729 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 16826882
model size : 83.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.68765902519226
Epoch: 1, Steps: 18 | Train Loss: 1.442 Vali Loss: 4.109 Vali Acc: 0.530 Test Loss: 4.109 Test Acc: 0.530
Validation loss decreased (inf --> -0.529959).  Saving model ...
Epoch: 2 cost time: 21.648427724838257
Epoch: 2, Steps: 18 | Train Loss: 1.997 Vali Loss: 7.069 Vali Acc: 0.510 Test Loss: 7.069 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.356072187423706
Epoch: 3, Steps: 18 | Train Loss: 4.086 Vali Loss: 2.754 Vali Acc: 0.390 Test Loss: 2.754 Test Acc: 0.390
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 26.357039213180542
Epoch: 4, Steps: 18 | Train Loss: 1.991 Vali Loss: 6.978 Vali Acc: 0.470 Test Loss: 6.978 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.355250597000122
Epoch: 5, Steps: 18 | Train Loss: 4.971 Vali Loss: 14.955 Vali Acc: 0.430 Test Loss: 14.955 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 22.693226099014282
Epoch: 6, Steps: 18 | Train Loss: 3.512 Vali Loss: 14.824 Vali Acc: 0.510 Test Loss: 14.824 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 25.549875020980835
Epoch: 7, Steps: 18 | Train Loss: 1.703 Vali Loss: 7.536 Vali Acc: 0.460 Test Loss: 7.536 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 23.552685260772705
Epoch: 8, Steps: 18 | Train Loss: 2.222 Vali Loss: 16.682 Vali Acc: 0.550 Test Loss: 16.682 Test Acc: 0.550
Validation loss decreased (-0.529959 --> -0.549833).  Saving model ...
Epoch: 9 cost time: 26.793598890304565
Epoch: 9, Steps: 18 | Train Loss: 3.046 Vali Loss: 27.457 Vali Acc: 0.500 Test Loss: 27.457 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.823993921279907
Epoch: 10, Steps: 18 | Train Loss: 5.176 Vali Loss: 17.459 Vali Acc: 0.510 Test Loss: 17.459 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 20.295988082885742
Epoch: 11, Steps: 18 | Train Loss: 3.202 Vali Loss: 14.224 Vali Acc: 0.480 Test Loss: 14.224 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 27.405029773712158
Epoch: 12, Steps: 18 | Train Loss: 1.952 Vali Loss: 31.628 Vali Acc: 0.430 Test Loss: 31.628 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 27.855472087860107
Epoch: 13, Steps: 18 | Train Loss: 2.150 Vali Loss: 39.973 Vali Acc: 0.520 Test Loss: 39.973 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 24.085742473602295
Epoch: 14, Steps: 18 | Train Loss: 3.272 Vali Loss: 28.142 Vali Acc: 0.490 Test Loss: 28.142 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 22.908201932907104
Epoch: 15, Steps: 18 | Train Loss: 1.594 Vali Loss: 35.317 Vali Acc: 0.490 Test Loss: 35.317 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 24.505985975265503
Epoch: 16, Steps: 18 | Train Loss: 3.981 Vali Loss: 41.539 Vali Acc: 0.480 Test Loss: 41.539 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 24.342334747314453
Epoch: 17, Steps: 18 | Train Loss: 5.499 Vali Loss: 19.344 Vali Acc: 0.490 Test Loss: 19.344 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 27.074307203292847
Epoch: 18, Steps: 18 | Train Loss: 1.412 Vali Loss: 30.051 Vali Acc: 0.550 Test Loss: 30.051 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 16826882
model size : 83.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.646800994873047
Epoch: 1, Steps: 18 | Train Loss: 1.708 Vali Loss: 4.767 Vali Acc: 0.500 Test Loss: 4.767 Test Acc: 0.500
Validation loss decreased (inf --> -0.499952).  Saving model ...
Epoch: 2 cost time: 23.242787837982178
Epoch: 2, Steps: 18 | Train Loss: 1.990 Vali Loss: 1.018 Vali Acc: 0.590 Test Loss: 1.018 Test Acc: 0.590
Validation loss decreased (-0.499952 --> -0.589990).  Saving model ...
Epoch: 3 cost time: 22.707791805267334
Epoch: 3, Steps: 18 | Train Loss: 1.708 Vali Loss: 1.216 Vali Acc: 0.540 Test Loss: 1.216 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.810032606124878
Epoch: 4, Steps: 18 | Train Loss: 0.754 Vali Loss: 1.439 Vali Acc: 0.480 Test Loss: 1.439 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.45788049697876
Epoch: 5, Steps: 18 | Train Loss: 0.867 Vali Loss: 1.866 Vali Acc: 0.550 Test Loss: 1.866 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 22.102112770080566
Epoch: 6, Steps: 18 | Train Loss: 2.262 Vali Loss: 6.651 Vali Acc: 0.500 Test Loss: 6.651 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 19.219707489013672
Epoch: 7, Steps: 18 | Train Loss: 1.065 Vali Loss: 5.692 Vali Acc: 0.520 Test Loss: 5.692 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 27.178465604782104
Epoch: 8, Steps: 18 | Train Loss: 1.220 Vali Loss: 5.546 Vali Acc: 0.500 Test Loss: 5.546 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 22.95693063735962
Epoch: 9, Steps: 18 | Train Loss: 0.645 Vali Loss: 7.559 Vali Acc: 0.520 Test Loss: 7.559 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 24.10562777519226
Epoch: 10, Steps: 18 | Train Loss: 1.556 Vali Loss: 4.040 Vali Acc: 0.520 Test Loss: 4.040 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 23.81718945503235
Epoch: 11, Steps: 18 | Train Loss: 1.248 Vali Loss: 9.433 Vali Acc: 0.510 Test Loss: 9.433 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 19.805819988250732
Epoch: 12, Steps: 18 | Train Loss: 1.138 Vali Loss: 7.124 Vali Acc: 0.610 Test Loss: 7.124 Test Acc: 0.610
Validation loss decreased (-0.589990 --> -0.609929).  Saving model ...
Epoch: 13 cost time: 25.271423816680908
Epoch: 13, Steps: 18 | Train Loss: 2.946 Vali Loss: 6.442 Vali Acc: 0.590 Test Loss: 6.442 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 27.350855588912964
Epoch: 14, Steps: 18 | Train Loss: 2.075 Vali Loss: 12.931 Vali Acc: 0.520 Test Loss: 12.931 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 20.756060123443604
Epoch: 15, Steps: 18 | Train Loss: 1.512 Vali Loss: 18.221 Vali Acc: 0.510 Test Loss: 18.221 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 23.200456142425537
Epoch: 16, Steps: 18 | Train Loss: 0.993 Vali Loss: 6.845 Vali Acc: 0.510 Test Loss: 6.845 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 23.272529125213623
Epoch: 17, Steps: 18 | Train Loss: 0.618 Vali Loss: 7.227 Vali Acc: 0.600 Test Loss: 7.227 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 22.04630208015442
Epoch: 18, Steps: 18 | Train Loss: 1.943 Vali Loss: 9.048 Vali Acc: 0.530 Test Loss: 9.048 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 27.878748893737793
Epoch: 19, Steps: 18 | Train Loss: 2.783 Vali Loss: 12.241 Vali Acc: 0.550 Test Loss: 12.241 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 24.168244123458862
Epoch: 20, Steps: 18 | Train Loss: 1.904 Vali Loss: 16.707 Vali Acc: 0.520 Test Loss: 16.707 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 19.213783740997314
Epoch: 21, Steps: 18 | Train Loss: 1.151 Vali Loss: 42.045 Vali Acc: 0.500 Test Loss: 42.045 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 27.365915060043335
Epoch: 22, Steps: 18 | Train Loss: 7.293 Vali Loss: 39.112 Vali Acc: 0.510 Test Loss: 39.112 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 16826882
model size : 83.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 102.84216451644897
Epoch: 1, Steps: 18 | Train Loss: 2.847 Vali Loss: 2.519 Vali Acc: 0.440 Test Loss: 2.519 Test Acc: 0.440
Validation loss decreased (inf --> -0.439975).  Saving model ...
Epoch: 2 cost time: 99.4176094532013
Epoch: 2, Steps: 18 | Train Loss: 3.317 Vali Loss: 3.258 Vali Acc: 0.570 Test Loss: 3.258 Test Acc: 0.570
Validation loss decreased (-0.439975 --> -0.569967).  Saving model ...
Epoch: 3 cost time: 104.72013068199158
Epoch: 3, Steps: 18 | Train Loss: 2.685 Vali Loss: 6.757 Vali Acc: 0.530 Test Loss: 6.757 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 112.76534819602966
Epoch: 4, Steps: 18 | Train Loss: 4.954 Vali Loss: 19.616 Vali Acc: 0.450 Test Loss: 19.616 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 119.41159892082214
Epoch: 5, Steps: 18 | Train Loss: 5.953 Vali Loss: 18.342 Vali Acc: 0.490 Test Loss: 18.342 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 125.3468291759491
Epoch: 6, Steps: 18 | Train Loss: 5.092 Vali Loss: 8.618 Vali Acc: 0.530 Test Loss: 8.618 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 125.24988079071045
Epoch: 7, Steps: 18 | Train Loss: 4.359 Vali Loss: 16.364 Vali Acc: 0.510 Test Loss: 16.364 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 126.99435687065125
Epoch: 8, Steps: 18 | Train Loss: 5.597 Vali Loss: 18.193 Vali Acc: 0.440 Test Loss: 18.193 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 132.42824149131775
Epoch: 9, Steps: 18 | Train Loss: 7.334 Vali Loss: 43.422 Vali Acc: 0.500 Test Loss: 43.422 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 126.10615539550781
Epoch: 10, Steps: 18 | Train Loss: 12.272 Vali Loss: 44.080 Vali Acc: 0.530 Test Loss: 44.080 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 128.13026881217957
Epoch: 11, Steps: 18 | Train Loss: 4.456 Vali Loss: 46.133 Vali Acc: 0.520 Test Loss: 46.133 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 126.11860752105713
Epoch: 12, Steps: 18 | Train Loss: 3.582 Vali Loss: 22.107 Vali Acc: 0.580 Test Loss: 22.107 Test Acc: 0.580
Validation loss decreased (-0.569967 --> -0.579779).  Saving model ...
Epoch: 13 cost time: 129.02075695991516
Epoch: 13, Steps: 18 | Train Loss: 1.083 Vali Loss: 28.674 Vali Acc: 0.460 Test Loss: 28.674 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 134.96886038780212
Epoch: 14, Steps: 18 | Train Loss: 2.891 Vali Loss: 45.426 Vali Acc: 0.510 Test Loss: 45.426 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 132.33412909507751
Epoch: 15, Steps: 18 | Train Loss: 2.130 Vali Loss: 48.608 Vali Acc: 0.550 Test Loss: 48.608 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 134.69783759117126
Epoch: 16, Steps: 18 | Train Loss: 3.392 Vali Loss: 65.350 Vali Acc: 0.540 Test Loss: 65.350 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 135.85029482841492
Epoch: 17, Steps: 18 | Train Loss: 2.149 Vali Loss: 66.905 Vali Acc: 0.530 Test Loss: 66.905 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 133.3482255935669
Epoch: 18, Steps: 18 | Train Loss: 2.877 Vali Loss: 27.026 Vali Acc: 0.550 Test Loss: 27.026 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 131.97143721580505
Epoch: 19, Steps: 18 | Train Loss: 3.090 Vali Loss: 32.807 Vali Acc: 0.530 Test Loss: 32.807 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 132.8585443496704
Epoch: 20, Steps: 18 | Train Loss: 5.151 Vali Loss: 51.691 Vali Acc: 0.510 Test Loss: 51.691 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 127.48268485069275
Epoch: 21, Steps: 18 | Train Loss: 4.587 Vali Loss: 35.538 Vali Acc: 0.520 Test Loss: 35.538 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 137.15745282173157
Epoch: 22, Steps: 18 | Train Loss: 3.739 Vali Loss: 69.450 Vali Acc: 0.460 Test Loss: 69.450 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 15254018
model size : 77.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 86.28117895126343
Epoch: 1, Steps: 18 | Train Loss: 2.356 Vali Loss: 2.494 Vali Acc: 0.560 Test Loss: 2.494 Test Acc: 0.560
Validation loss decreased (inf --> -0.559975).  Saving model ...
Epoch: 2 cost time: 82.97129726409912
Epoch: 2, Steps: 18 | Train Loss: 2.265 Vali Loss: 7.722 Vali Acc: 0.490 Test Loss: 7.722 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 79.1124746799469
Epoch: 3, Steps: 18 | Train Loss: 2.824 Vali Loss: 12.021 Vali Acc: 0.510 Test Loss: 12.021 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 86.94732356071472
Epoch: 4, Steps: 18 | Train Loss: 3.542 Vali Loss: 24.774 Vali Acc: 0.520 Test Loss: 24.774 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 101.22186136245728
Epoch: 5, Steps: 18 | Train Loss: 8.100 Vali Loss: 8.258 Vali Acc: 0.550 Test Loss: 8.258 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 99.73746347427368
Epoch: 6, Steps: 18 | Train Loss: 5.024 Vali Loss: 9.971 Vali Acc: 0.500 Test Loss: 9.971 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 100.30576658248901
Epoch: 7, Steps: 18 | Train Loss: 3.711 Vali Loss: 46.629 Vali Acc: 0.500 Test Loss: 46.629 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 98.58832621574402
Epoch: 8, Steps: 18 | Train Loss: 5.652 Vali Loss: 12.730 Vali Acc: 0.550 Test Loss: 12.730 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 102.15935039520264
Epoch: 9, Steps: 18 | Train Loss: 5.182 Vali Loss: 41.341 Vali Acc: 0.490 Test Loss: 41.341 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 103.5466856956482
Epoch: 10, Steps: 18 | Train Loss: 4.518 Vali Loss: 28.947 Vali Acc: 0.460 Test Loss: 28.947 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 111.83947610855103
Epoch: 11, Steps: 18 | Train Loss: 3.851 Vali Loss: 49.141 Vali Acc: 0.490 Test Loss: 49.141 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 15254018
model size : 77.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 66.74510145187378
Epoch: 1, Steps: 18 | Train Loss: 2.217 Vali Loss: 2.009 Vali Acc: 0.560 Test Loss: 2.009 Test Acc: 0.560
Validation loss decreased (inf --> -0.559980).  Saving model ...
Epoch: 2 cost time: 65.2875907421112
Epoch: 2, Steps: 18 | Train Loss: 2.628 Vali Loss: 14.571 Vali Acc: 0.510 Test Loss: 14.571 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 70.6532142162323
Epoch: 3, Steps: 18 | Train Loss: 4.806 Vali Loss: 6.886 Vali Acc: 0.520 Test Loss: 6.886 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 70.16416382789612
Epoch: 4, Steps: 18 | Train Loss: 5.777 Vali Loss: 11.852 Vali Acc: 0.510 Test Loss: 11.852 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 68.87780094146729
Epoch: 5, Steps: 18 | Train Loss: 2.502 Vali Loss: 14.089 Vali Acc: 0.500 Test Loss: 14.089 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 76.94219374656677
Epoch: 6, Steps: 18 | Train Loss: 3.443 Vali Loss: 7.125 Vali Acc: 0.530 Test Loss: 7.125 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 75.9625895023346
Epoch: 7, Steps: 18 | Train Loss: 11.442 Vali Loss: 40.187 Vali Acc: 0.500 Test Loss: 40.187 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 82.03881931304932
Epoch: 8, Steps: 18 | Train Loss: 7.834 Vali Loss: 17.968 Vali Acc: 0.520 Test Loss: 17.968 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 85.10892605781555
Epoch: 9, Steps: 18 | Train Loss: 8.025 Vali Loss: 61.213 Vali Acc: 0.510 Test Loss: 61.213 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 81.26312398910522
Epoch: 10, Steps: 18 | Train Loss: 12.126 Vali Loss: 16.403 Vali Acc: 0.510 Test Loss: 16.403 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 82.6974184513092
Epoch: 11, Steps: 18 | Train Loss: 3.037 Vali Loss: 21.057 Vali Acc: 0.560 Test Loss: 21.057 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 15254018
model size : 77.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 52.499062061309814
Epoch: 1, Steps: 18 | Train Loss: 1.971 Vali Loss: 1.943 Vali Acc: 0.480 Test Loss: 1.943 Test Acc: 0.480
Validation loss decreased (inf --> -0.479981).  Saving model ...
Epoch: 2 cost time: 49.3123414516449
Epoch: 2, Steps: 18 | Train Loss: 2.719 Vali Loss: 11.062 Vali Acc: 0.510 Test Loss: 11.062 Test Acc: 0.510
Validation loss decreased (-0.479981 --> -0.509889).  Saving model ...
Epoch: 3 cost time: 49.14314150810242
Epoch: 3, Steps: 18 | Train Loss: 3.038 Vali Loss: 4.523 Vali Acc: 0.500 Test Loss: 4.523 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 53.95639228820801
Epoch: 4, Steps: 18 | Train Loss: 3.185 Vali Loss: 10.710 Vali Acc: 0.520 Test Loss: 10.710 Test Acc: 0.520
Validation loss decreased (-0.509889 --> -0.519893).  Saving model ...
Epoch: 5 cost time: 51.42190337181091
Epoch: 5, Steps: 18 | Train Loss: 4.203 Vali Loss: 7.770 Vali Acc: 0.580 Test Loss: 7.770 Test Acc: 0.580
Validation loss decreased (-0.519893 --> -0.579922).  Saving model ...
Epoch: 6 cost time: 58.218427896499634
Epoch: 6, Steps: 18 | Train Loss: 3.214 Vali Loss: 10.013 Vali Acc: 0.560 Test Loss: 10.013 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 55.91069793701172
Epoch: 7, Steps: 18 | Train Loss: 10.166 Vali Loss: 31.335 Vali Acc: 0.520 Test Loss: 31.335 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 61.97658061981201
Epoch: 8, Steps: 18 | Train Loss: 3.636 Vali Loss: 15.138 Vali Acc: 0.560 Test Loss: 15.138 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 59.173980474472046
Epoch: 9, Steps: 18 | Train Loss: 3.831 Vali Loss: 14.742 Vali Acc: 0.530 Test Loss: 14.742 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 65.27492690086365
Epoch: 10, Steps: 18 | Train Loss: 2.465 Vali Loss: 25.349 Vali Acc: 0.510 Test Loss: 25.349 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 62.44938588142395
Epoch: 11, Steps: 18 | Train Loss: 3.033 Vali Loss: 36.640 Vali Acc: 0.500 Test Loss: 36.640 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 65.40274500846863
Epoch: 12, Steps: 18 | Train Loss: 2.694 Vali Loss: 19.165 Vali Acc: 0.510 Test Loss: 19.165 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 62.564441204071045
Epoch: 13, Steps: 18 | Train Loss: 7.921 Vali Loss: 46.517 Vali Acc: 0.500 Test Loss: 46.517 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 67.05609798431396
Epoch: 14, Steps: 18 | Train Loss: 3.234 Vali Loss: 25.077 Vali Acc: 0.540 Test Loss: 25.077 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 66.83734226226807
Epoch: 15, Steps: 18 | Train Loss: 1.663 Vali Loss: 42.473 Vali Acc: 0.500 Test Loss: 42.473 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 15254018
model size : 77.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 34.88458275794983
Epoch: 1, Steps: 18 | Train Loss: 2.231 Vali Loss: 2.891 Vali Acc: 0.490 Test Loss: 2.891 Test Acc: 0.490
Validation loss decreased (inf --> -0.489971).  Saving model ...
Epoch: 2 cost time: 38.76686096191406
Epoch: 2, Steps: 18 | Train Loss: 3.980 Vali Loss: 12.812 Vali Acc: 0.500 Test Loss: 12.812 Test Acc: 0.500
Validation loss decreased (-0.489971 --> -0.499872).  Saving model ...
Epoch: 3 cost time: 39.70073080062866
Epoch: 3, Steps: 18 | Train Loss: 4.822 Vali Loss: 6.597 Vali Acc: 0.480 Test Loss: 6.597 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 36.000079870224
Epoch: 4, Steps: 18 | Train Loss: 4.532 Vali Loss: 24.986 Vali Acc: 0.500 Test Loss: 24.986 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 41.469282388687134
Epoch: 5, Steps: 18 | Train Loss: 4.264 Vali Loss: 7.281 Vali Acc: 0.510 Test Loss: 7.281 Test Acc: 0.510
Validation loss decreased (-0.499872 --> -0.509927).  Saving model ...
Epoch: 6 cost time: 41.073893308639526
Epoch: 6, Steps: 18 | Train Loss: 4.576 Vali Loss: 9.912 Vali Acc: 0.500 Test Loss: 9.912 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 40.350173234939575
Epoch: 7, Steps: 18 | Train Loss: 3.062 Vali Loss: 10.708 Vali Acc: 0.510 Test Loss: 10.708 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 38.79484748840332
Epoch: 8, Steps: 18 | Train Loss: 6.583 Vali Loss: 40.744 Vali Acc: 0.520 Test Loss: 40.744 Test Acc: 0.520
Validation loss decreased (-0.509927 --> -0.519593).  Saving model ...
Epoch: 9 cost time: 39.10154104232788
Epoch: 9, Steps: 18 | Train Loss: 6.134 Vali Loss: 15.115 Vali Acc: 0.510 Test Loss: 15.115 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 42.519449949264526
Epoch: 10, Steps: 18 | Train Loss: 3.337 Vali Loss: 23.249 Vali Acc: 0.470 Test Loss: 23.249 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 43.530019760131836
Epoch: 11, Steps: 18 | Train Loss: 5.962 Vali Loss: 21.858 Vali Acc: 0.470 Test Loss: 21.858 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 39.134724617004395
Epoch: 12, Steps: 18 | Train Loss: 4.831 Vali Loss: 23.375 Vali Acc: 0.560 Test Loss: 23.375 Test Acc: 0.560
Validation loss decreased (-0.519593 --> -0.559766).  Saving model ...
Epoch: 13 cost time: 44.77916860580444
Epoch: 13, Steps: 18 | Train Loss: 2.513 Vali Loss: 28.962 Vali Acc: 0.480 Test Loss: 28.962 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 43.897746324539185
Epoch: 14, Steps: 18 | Train Loss: 0.742 Vali Loss: 29.744 Vali Acc: 0.500 Test Loss: 29.744 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 40.98426151275635
Epoch: 15, Steps: 18 | Train Loss: 1.118 Vali Loss: 31.205 Vali Acc: 0.550 Test Loss: 31.205 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 45.66561317443848
Epoch: 16, Steps: 18 | Train Loss: 1.432 Vali Loss: 78.686 Vali Acc: 0.490 Test Loss: 78.686 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 39.80850839614868
Epoch: 17, Steps: 18 | Train Loss: 6.020 Vali Loss: 25.068 Vali Acc: 0.480 Test Loss: 25.068 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 42.178303956985474
Epoch: 18, Steps: 18 | Train Loss: 2.461 Vali Loss: 24.700 Vali Acc: 0.560 Test Loss: 24.700 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 43.472142696380615
Epoch: 19, Steps: 18 | Train Loss: 2.114 Vali Loss: 53.054 Vali Acc: 0.500 Test Loss: 53.054 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 38.435893058776855
Epoch: 20, Steps: 18 | Train Loss: 2.463 Vali Loss: 35.018 Vali Acc: 0.510 Test Loss: 35.018 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 45.0083487033844
Epoch: 21, Steps: 18 | Train Loss: 1.209 Vali Loss: 32.536 Vali Acc: 0.610 Test Loss: 32.536 Test Acc: 0.610
Validation loss decreased (-0.559766 --> -0.609675).  Saving model ...
Epoch: 22 cost time: 44.373701333999634
Epoch: 22, Steps: 18 | Train Loss: 1.296 Vali Loss: 41.990 Vali Acc: 0.560 Test Loss: 41.990 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 40.596126079559326
Epoch: 23, Steps: 18 | Train Loss: 4.366 Vali Loss: 50.097 Vali Acc: 0.520 Test Loss: 50.097 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 44.94735598564148
Epoch: 24, Steps: 18 | Train Loss: 1.387 Vali Loss: 43.067 Vali Acc: 0.550 Test Loss: 43.067 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 41.022321701049805
Epoch: 25, Steps: 18 | Train Loss: 5.167 Vali Loss: 46.236 Vali Acc: 0.510 Test Loss: 46.236 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 43.08546566963196
Epoch: 26, Steps: 18 | Train Loss: 1.120 Vali Loss: 57.308 Vali Acc: 0.550 Test Loss: 57.308 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 43.48441815376282
Epoch: 27, Steps: 18 | Train Loss: 3.838 Vali Loss: 47.863 Vali Acc: 0.540 Test Loss: 47.863 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 33.648805379867554
Epoch: 28, Steps: 18 | Train Loss: 1.716 Vali Loss: 52.299 Vali Acc: 0.520 Test Loss: 52.299 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 46.17996168136597
Epoch: 29, Steps: 18 | Train Loss: 1.345 Vali Loss: 48.845 Vali Acc: 0.540 Test Loss: 48.845 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 44.190717458724976
Epoch: 30, Steps: 18 | Train Loss: 2.096 Vali Loss: 79.629 Vali Acc: 0.490 Test Loss: 79.629 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 41.250749349594116
Epoch: 31, Steps: 18 | Train Loss: 1.121 Vali Loss: 47.714 Vali Acc: 0.550 Test Loss: 47.714 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 15254018
model size : 77.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 29.008094549179077
Epoch: 1, Steps: 18 | Train Loss: 1.433 Vali Loss: 3.418 Vali Acc: 0.500 Test Loss: 3.418 Test Acc: 0.500
Validation loss decreased (inf --> -0.499966).  Saving model ...
Epoch: 2 cost time: 25.24244713783264
Epoch: 2, Steps: 18 | Train Loss: 2.746 Vali Loss: 3.297 Vali Acc: 0.550 Test Loss: 3.297 Test Acc: 0.550
Validation loss decreased (-0.499966 --> -0.549967).  Saving model ...
Epoch: 3 cost time: 31.749953508377075
Epoch: 3, Steps: 18 | Train Loss: 4.562 Vali Loss: 4.194 Vali Acc: 0.520 Test Loss: 4.194 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 28.95928120613098
Epoch: 4, Steps: 18 | Train Loss: 5.786 Vali Loss: 6.133 Vali Acc: 0.520 Test Loss: 6.133 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 26.58242630958557
Epoch: 5, Steps: 18 | Train Loss: 2.917 Vali Loss: 11.850 Vali Acc: 0.490 Test Loss: 11.850 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 26.54332947731018
Epoch: 6, Steps: 18 | Train Loss: 3.253 Vali Loss: 17.089 Vali Acc: 0.540 Test Loss: 17.089 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 33.20230197906494
Epoch: 7, Steps: 18 | Train Loss: 2.313 Vali Loss: 12.866 Vali Acc: 0.520 Test Loss: 12.866 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 32.83735632896423
Epoch: 8, Steps: 18 | Train Loss: 3.559 Vali Loss: 17.636 Vali Acc: 0.470 Test Loss: 17.636 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 30.180161237716675
Epoch: 9, Steps: 18 | Train Loss: 2.620 Vali Loss: 8.944 Vali Acc: 0.580 Test Loss: 8.944 Test Acc: 0.580
Validation loss decreased (-0.549967 --> -0.579911).  Saving model ...
Epoch: 10 cost time: 27.31892728805542
Epoch: 10, Steps: 18 | Train Loss: 3.790 Vali Loss: 23.067 Vali Acc: 0.490 Test Loss: 23.067 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 32.478811264038086
Epoch: 11, Steps: 18 | Train Loss: 2.353 Vali Loss: 28.659 Vali Acc: 0.510 Test Loss: 28.659 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 32.520268201828
Epoch: 12, Steps: 18 | Train Loss: 4.238 Vali Loss: 26.670 Vali Acc: 0.430 Test Loss: 26.670 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 31.29292392730713
Epoch: 13, Steps: 18 | Train Loss: 2.469 Vali Loss: 17.135 Vali Acc: 0.540 Test Loss: 17.135 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 32.984525203704834
Epoch: 14, Steps: 18 | Train Loss: 2.714 Vali Loss: 29.374 Vali Acc: 0.490 Test Loss: 29.374 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 34.41117310523987
Epoch: 15, Steps: 18 | Train Loss: 3.315 Vali Loss: 21.394 Vali Acc: 0.560 Test Loss: 21.394 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 31.34836483001709
Epoch: 16, Steps: 18 | Train Loss: 4.997 Vali Loss: 55.227 Vali Acc: 0.490 Test Loss: 55.227 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 25.5815110206604
Epoch: 17, Steps: 18 | Train Loss: 2.484 Vali Loss: 37.024 Vali Acc: 0.550 Test Loss: 37.024 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 31.254915952682495
Epoch: 18, Steps: 18 | Train Loss: 1.476 Vali Loss: 56.260 Vali Acc: 0.530 Test Loss: 56.260 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 32.918089866638184
Epoch: 19, Steps: 18 | Train Loss: 1.495 Vali Loss: 21.676 Vali Acc: 0.540 Test Loss: 21.676 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 15254018
model size : 77.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.638570070266724
Epoch: 1, Steps: 18 | Train Loss: 1.352 Vali Loss: 3.597 Vali Acc: 0.510 Test Loss: 3.597 Test Acc: 0.510
Validation loss decreased (inf --> -0.509964).  Saving model ...
Epoch: 2 cost time: 21.698801279067993
Epoch: 2, Steps: 18 | Train Loss: 2.566 Vali Loss: 5.321 Vali Acc: 0.520 Test Loss: 5.321 Test Acc: 0.520
Validation loss decreased (-0.509964 --> -0.519947).  Saving model ...
Epoch: 3 cost time: 21.067058801651
Epoch: 3, Steps: 18 | Train Loss: 4.711 Vali Loss: 4.418 Vali Acc: 0.630 Test Loss: 4.418 Test Acc: 0.630
Validation loss decreased (-0.519947 --> -0.629956).  Saving model ...
Epoch: 4 cost time: 25.03364872932434
Epoch: 4, Steps: 18 | Train Loss: 2.818 Vali Loss: 10.678 Vali Acc: 0.520 Test Loss: 10.678 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.590409517288208
Epoch: 5, Steps: 18 | Train Loss: 3.321 Vali Loss: 9.354 Vali Acc: 0.560 Test Loss: 9.354 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 28.179572343826294
Epoch: 6, Steps: 18 | Train Loss: 2.906 Vali Loss: 14.425 Vali Acc: 0.510 Test Loss: 14.425 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 23.882684230804443
Epoch: 7, Steps: 18 | Train Loss: 2.798 Vali Loss: 16.533 Vali Acc: 0.520 Test Loss: 16.533 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 24.1506028175354
Epoch: 8, Steps: 18 | Train Loss: 2.516 Vali Loss: 11.602 Vali Acc: 0.550 Test Loss: 11.602 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 28.870442628860474
Epoch: 9, Steps: 18 | Train Loss: 1.887 Vali Loss: 11.647 Vali Acc: 0.590 Test Loss: 11.647 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 28.991361618041992
Epoch: 10, Steps: 18 | Train Loss: 3.205 Vali Loss: 15.048 Vali Acc: 0.570 Test Loss: 15.048 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 25.24434804916382
Epoch: 11, Steps: 18 | Train Loss: 8.610 Vali Loss: 19.903 Vali Acc: 0.580 Test Loss: 19.903 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 24.210398197174072
Epoch: 12, Steps: 18 | Train Loss: 2.035 Vali Loss: 25.701 Vali Acc: 0.480 Test Loss: 25.701 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 29.15408492088318
Epoch: 13, Steps: 18 | Train Loss: 4.375 Vali Loss: 47.437 Vali Acc: 0.480 Test Loss: 47.437 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 15254018
model size : 77.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 25.193130493164062
Epoch: 1, Steps: 18 | Train Loss: 1.587 Vali Loss: 1.865 Vali Acc: 0.550 Test Loss: 1.865 Test Acc: 0.550
Validation loss decreased (inf --> -0.549981).  Saving model ...
Epoch: 2 cost time: 19.590283632278442
Epoch: 2, Steps: 18 | Train Loss: 1.503 Vali Loss: 3.156 Vali Acc: 0.500 Test Loss: 3.156 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.267534255981445
Epoch: 3, Steps: 18 | Train Loss: 3.280 Vali Loss: 8.971 Vali Acc: 0.500 Test Loss: 8.971 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 27.307754039764404
Epoch: 4, Steps: 18 | Train Loss: 3.818 Vali Loss: 5.695 Vali Acc: 0.610 Test Loss: 5.695 Test Acc: 0.610
Validation loss decreased (-0.549981 --> -0.609943).  Saving model ...
Epoch: 5 cost time: 22.2647066116333
Epoch: 5, Steps: 18 | Train Loss: 2.031 Vali Loss: 10.861 Vali Acc: 0.410 Test Loss: 10.861 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.884891986846924
Epoch: 6, Steps: 18 | Train Loss: 2.348 Vali Loss: 7.418 Vali Acc: 0.540 Test Loss: 7.418 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 26.16798496246338
Epoch: 7, Steps: 18 | Train Loss: 2.036 Vali Loss: 10.142 Vali Acc: 0.460 Test Loss: 10.142 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 22.861257791519165
Epoch: 8, Steps: 18 | Train Loss: 1.740 Vali Loss: 9.317 Vali Acc: 0.510 Test Loss: 9.317 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 26.077665090560913
Epoch: 9, Steps: 18 | Train Loss: 1.012 Vali Loss: 8.742 Vali Acc: 0.560 Test Loss: 8.742 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 25.56183671951294
Epoch: 10, Steps: 18 | Train Loss: 1.798 Vali Loss: 11.681 Vali Acc: 0.560 Test Loss: 11.681 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 20.658433198928833
Epoch: 11, Steps: 18 | Train Loss: 1.265 Vali Loss: 16.844 Vali Acc: 0.530 Test Loss: 16.844 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 26.620823860168457
Epoch: 12, Steps: 18 | Train Loss: 1.159 Vali Loss: 18.445 Vali Acc: 0.550 Test Loss: 18.445 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 27.669546127319336
Epoch: 13, Steps: 18 | Train Loss: 2.138 Vali Loss: 16.288 Vali Acc: 0.560 Test Loss: 16.288 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 24.937785387039185
Epoch: 14, Steps: 18 | Train Loss: 2.465 Vali Loss: 14.850 Vali Acc: 0.560 Test Loss: 14.850 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 15254018
model size : 77.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.86480212211609
Epoch: 1, Steps: 18 | Train Loss: 2.059 Vali Loss: 4.229 Vali Acc: 0.580 Test Loss: 4.229 Test Acc: 0.580
Validation loss decreased (inf --> -0.579958).  Saving model ...
Epoch: 2 cost time: 18.131704568862915
Epoch: 2, Steps: 18 | Train Loss: 1.671 Vali Loss: 2.845 Vali Acc: 0.500 Test Loss: 2.845 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.70843005180359
Epoch: 3, Steps: 18 | Train Loss: 1.604 Vali Loss: 4.138 Vali Acc: 0.470 Test Loss: 4.138 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 21.154711961746216
Epoch: 4, Steps: 18 | Train Loss: 1.209 Vali Loss: 2.441 Vali Acc: 0.440 Test Loss: 2.441 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.41985249519348
Epoch: 5, Steps: 18 | Train Loss: 2.208 Vali Loss: 6.406 Vali Acc: 0.510 Test Loss: 6.406 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 25.797389030456543
Epoch: 6, Steps: 18 | Train Loss: 3.013 Vali Loss: 4.184 Vali Acc: 0.550 Test Loss: 4.184 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 21.67293953895569
Epoch: 7, Steps: 18 | Train Loss: 1.204 Vali Loss: 6.994 Vali Acc: 0.550 Test Loss: 6.994 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 22.668724060058594
Epoch: 8, Steps: 18 | Train Loss: 2.381 Vali Loss: 24.250 Vali Acc: 0.430 Test Loss: 24.250 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 20.483330726623535
Epoch: 9, Steps: 18 | Train Loss: 3.048 Vali Loss: 14.583 Vali Acc: 0.510 Test Loss: 14.583 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 21.036346912384033
Epoch: 10, Steps: 18 | Train Loss: 1.896 Vali Loss: 9.129 Vali Acc: 0.530 Test Loss: 9.129 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 23.06672215461731
Epoch: 11, Steps: 18 | Train Loss: 2.272 Vali Loss: 23.207 Vali Acc: 0.440 Test Loss: 23.207 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 15254018
model size : 77.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.67250156402588
Epoch: 1, Steps: 18 | Train Loss: 1.812 Vali Loss: 1.058 Vali Acc: 0.490 Test Loss: 1.058 Test Acc: 0.490
Validation loss decreased (inf --> -0.489989).  Saving model ...
Epoch: 2 cost time: 18.626948833465576
Epoch: 2, Steps: 18 | Train Loss: 1.428 Vali Loss: 6.102 Vali Acc: 0.500 Test Loss: 6.102 Test Acc: 0.500
Validation loss decreased (-0.489989 --> -0.499939).  Saving model ...
Epoch: 3 cost time: 22.874966621398926
Epoch: 3, Steps: 18 | Train Loss: 3.908 Vali Loss: 9.608 Vali Acc: 0.500 Test Loss: 9.608 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.05049753189087
Epoch: 4, Steps: 18 | Train Loss: 4.189 Vali Loss: 9.998 Vali Acc: 0.500 Test Loss: 9.998 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 24.336352586746216
Epoch: 5, Steps: 18 | Train Loss: 1.722 Vali Loss: 3.789 Vali Acc: 0.500 Test Loss: 3.789 Test Acc: 0.500
Validation loss decreased (-0.499939 --> -0.499962).  Saving model ...
Epoch: 6 cost time: 19.75870180130005
Epoch: 6, Steps: 18 | Train Loss: 0.678 Vali Loss: 4.554 Vali Acc: 0.510 Test Loss: 4.554 Test Acc: 0.510
Validation loss decreased (-0.499962 --> -0.509954).  Saving model ...
Epoch: 7 cost time: 19.270651817321777
Epoch: 7, Steps: 18 | Train Loss: 1.013 Vali Loss: 7.821 Vali Acc: 0.480 Test Loss: 7.821 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.498329639434814
Epoch: 8, Steps: 18 | Train Loss: 1.176 Vali Loss: 5.262 Vali Acc: 0.490 Test Loss: 5.262 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 21.02549982070923
Epoch: 9, Steps: 18 | Train Loss: 0.964 Vali Loss: 5.080 Vali Acc: 0.550 Test Loss: 5.080 Test Acc: 0.550
Validation loss decreased (-0.509954 --> -0.549949).  Saving model ...
Epoch: 10 cost time: 24.261154890060425
Epoch: 10, Steps: 18 | Train Loss: 1.100 Vali Loss: 3.546 Vali Acc: 0.560 Test Loss: 3.546 Test Acc: 0.560
Validation loss decreased (-0.549949 --> -0.559965).  Saving model ...
Epoch: 11 cost time: 19.832911014556885
Epoch: 11, Steps: 18 | Train Loss: 0.579 Vali Loss: 3.841 Vali Acc: 0.550 Test Loss: 3.841 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 19.84715485572815
Epoch: 12, Steps: 18 | Train Loss: 1.671 Vali Loss: 4.444 Vali Acc: 0.510 Test Loss: 4.444 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 22.98203206062317
Epoch: 13, Steps: 18 | Train Loss: 1.808 Vali Loss: 18.637 Vali Acc: 0.500 Test Loss: 18.637 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 21.884994506835938
Epoch: 14, Steps: 18 | Train Loss: 0.891 Vali Loss: 5.559 Vali Acc: 0.540 Test Loss: 5.559 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 22.99584984779358
Epoch: 15, Steps: 18 | Train Loss: 1.054 Vali Loss: 10.517 Vali Acc: 0.550 Test Loss: 10.517 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 21.997143745422363
Epoch: 16, Steps: 18 | Train Loss: 4.284 Vali Loss: 18.490 Vali Acc: 0.510 Test Loss: 18.490 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 17.940924167633057
Epoch: 17, Steps: 18 | Train Loss: 4.165 Vali Loss: 20.392 Vali Acc: 0.490 Test Loss: 20.392 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 23.563371181488037
Epoch: 18, Steps: 18 | Train Loss: 3.661 Vali Loss: 8.397 Vali Acc: 0.520 Test Loss: 8.397 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 22.128971338272095
Epoch: 19, Steps: 18 | Train Loss: 0.493 Vali Loss: 13.545 Vali Acc: 0.530 Test Loss: 13.545 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 22.12857985496521
Epoch: 20, Steps: 18 | Train Loss: 1.185 Vali Loss: 29.848 Vali Acc: 0.530 Test Loss: 29.848 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 15254018
model size : 77.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 101.1794810295105
Epoch: 1, Steps: 18 | Train Loss: 1.792 Vali Loss: 3.873 Vali Acc: 0.510 Test Loss: 3.873 Test Acc: 0.510
Validation loss decreased (inf --> -0.509961).  Saving model ...
Epoch: 2 cost time: 102.68277978897095
Epoch: 2, Steps: 18 | Train Loss: 4.412 Vali Loss: 5.076 Vali Acc: 0.550 Test Loss: 5.076 Test Acc: 0.550
Validation loss decreased (-0.509961 --> -0.549949).  Saving model ...
Epoch: 3 cost time: 102.24655890464783
Epoch: 3, Steps: 18 | Train Loss: 2.527 Vali Loss: 5.874 Vali Acc: 0.470 Test Loss: 5.874 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 112.68198728561401
Epoch: 4, Steps: 18 | Train Loss: 8.034 Vali Loss: 16.246 Vali Acc: 0.500 Test Loss: 16.246 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 120.28571844100952
Epoch: 5, Steps: 18 | Train Loss: 6.022 Vali Loss: 9.975 Vali Acc: 0.530 Test Loss: 9.975 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 110.78546690940857
Epoch: 6, Steps: 18 | Train Loss: 2.884 Vali Loss: 13.277 Vali Acc: 0.580 Test Loss: 13.277 Test Acc: 0.580
Validation loss decreased (-0.549949 --> -0.579867).  Saving model ...
Epoch: 7 cost time: 116.8926272392273
Epoch: 7, Steps: 18 | Train Loss: 2.507 Vali Loss: 10.776 Vali Acc: 0.530 Test Loss: 10.776 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 124.84272336959839
Epoch: 8, Steps: 18 | Train Loss: 7.805 Vali Loss: 19.448 Vali Acc: 0.550 Test Loss: 19.448 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 128.85579657554626
Epoch: 9, Steps: 18 | Train Loss: 5.490 Vali Loss: 22.924 Vali Acc: 0.510 Test Loss: 22.924 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 128.6683931350708
Epoch: 10, Steps: 18 | Train Loss: 5.487 Vali Loss: 41.648 Vali Acc: 0.480 Test Loss: 41.648 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 122.6603467464447
Epoch: 11, Steps: 18 | Train Loss: 10.860 Vali Loss: 41.605 Vali Acc: 0.500 Test Loss: 41.605 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 130.06717777252197
Epoch: 12, Steps: 18 | Train Loss: 2.562 Vali Loss: 26.728 Vali Acc: 0.530 Test Loss: 26.728 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 137.21351742744446
Epoch: 13, Steps: 18 | Train Loss: 3.121 Vali Loss: 15.610 Vali Acc: 0.540 Test Loss: 15.610 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 134.42213940620422
Epoch: 14, Steps: 18 | Train Loss: 1.975 Vali Loss: 43.281 Vali Acc: 0.470 Test Loss: 43.281 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 131.16620206832886
Epoch: 15, Steps: 18 | Train Loss: 2.613 Vali Loss: 40.606 Vali Acc: 0.560 Test Loss: 40.606 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 119.11855792999268
Epoch: 16, Steps: 18 | Train Loss: 3.645 Vali Loss: 26.727 Vali Acc: 0.530 Test Loss: 26.727 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 14467586
model size : 74.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 75.89690327644348
Epoch: 1, Steps: 18 | Train Loss: 2.146 Vali Loss: 8.327 Vali Acc: 0.490 Test Loss: 8.327 Test Acc: 0.490
Validation loss decreased (inf --> -0.489917).  Saving model ...
Epoch: 2 cost time: 79.68293023109436
Epoch: 2, Steps: 18 | Train Loss: 4.018 Vali Loss: 7.139 Vali Acc: 0.570 Test Loss: 7.139 Test Acc: 0.570
Validation loss decreased (-0.489917 --> -0.569929).  Saving model ...
Epoch: 3 cost time: 82.21686673164368
Epoch: 3, Steps: 18 | Train Loss: 3.460 Vali Loss: 4.933 Vali Acc: 0.530 Test Loss: 4.933 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 80.4595775604248
Epoch: 4, Steps: 18 | Train Loss: 2.737 Vali Loss: 8.614 Vali Acc: 0.490 Test Loss: 8.614 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 81.7494740486145
Epoch: 5, Steps: 18 | Train Loss: 3.274 Vali Loss: 9.947 Vali Acc: 0.490 Test Loss: 9.947 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 93.29228734970093
Epoch: 6, Steps: 18 | Train Loss: 3.747 Vali Loss: 26.149 Vali Acc: 0.420 Test Loss: 26.149 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 99.42952489852905
Epoch: 7, Steps: 18 | Train Loss: 9.320 Vali Loss: 28.435 Vali Acc: 0.510 Test Loss: 28.435 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 99.94682455062866
Epoch: 8, Steps: 18 | Train Loss: 6.866 Vali Loss: 15.843 Vali Acc: 0.540 Test Loss: 15.843 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 96.73980665206909
Epoch: 9, Steps: 18 | Train Loss: 2.343 Vali Loss: 19.589 Vali Acc: 0.490 Test Loss: 19.589 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 103.887779712677
Epoch: 10, Steps: 18 | Train Loss: 3.415 Vali Loss: 16.456 Vali Acc: 0.470 Test Loss: 16.456 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 99.06242227554321
Epoch: 11, Steps: 18 | Train Loss: 5.970 Vali Loss: 31.607 Vali Acc: 0.510 Test Loss: 31.607 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 103.42707252502441
Epoch: 12, Steps: 18 | Train Loss: 4.292 Vali Loss: 23.527 Vali Acc: 0.480 Test Loss: 23.527 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 14467586
model size : 74.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 59.56434345245361
Epoch: 1, Steps: 18 | Train Loss: 1.972 Vali Loss: 3.558 Vali Acc: 0.610 Test Loss: 3.558 Test Acc: 0.610
Validation loss decreased (inf --> -0.609964).  Saving model ...
Epoch: 2 cost time: 69.49085021018982
Epoch: 2, Steps: 18 | Train Loss: 4.804 Vali Loss: 7.865 Vali Acc: 0.530 Test Loss: 7.865 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 59.64964532852173
Epoch: 3, Steps: 18 | Train Loss: 4.403 Vali Loss: 13.633 Vali Acc: 0.500 Test Loss: 13.633 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 65.5717306137085
Epoch: 4, Steps: 18 | Train Loss: 2.348 Vali Loss: 8.600 Vali Acc: 0.530 Test Loss: 8.600 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 69.26940846443176
Epoch: 5, Steps: 18 | Train Loss: 4.105 Vali Loss: 10.458 Vali Acc: 0.490 Test Loss: 10.458 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 74.02173495292664
Epoch: 6, Steps: 18 | Train Loss: 4.099 Vali Loss: 27.035 Vali Acc: 0.480 Test Loss: 27.035 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 79.5433120727539
Epoch: 7, Steps: 18 | Train Loss: 2.785 Vali Loss: 13.950 Vali Acc: 0.500 Test Loss: 13.950 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 71.29456210136414
Epoch: 8, Steps: 18 | Train Loss: 3.922 Vali Loss: 13.743 Vali Acc: 0.540 Test Loss: 13.743 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 80.90576171875
Epoch: 9, Steps: 18 | Train Loss: 2.315 Vali Loss: 34.195 Vali Acc: 0.530 Test Loss: 34.195 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 81.11217594146729
Epoch: 10, Steps: 18 | Train Loss: 3.985 Vali Loss: 20.223 Vali Acc: 0.590 Test Loss: 20.223 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 77.00536060333252
Epoch: 11, Steps: 18 | Train Loss: 3.138 Vali Loss: 31.305 Vali Acc: 0.520 Test Loss: 31.305 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 14467586
model size : 74.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 48.96723198890686
Epoch: 1, Steps: 18 | Train Loss: 2.103 Vali Loss: 3.952 Vali Acc: 0.570 Test Loss: 3.952 Test Acc: 0.570
Validation loss decreased (inf --> -0.569960).  Saving model ...
Epoch: 2 cost time: 43.563090324401855
Epoch: 2, Steps: 18 | Train Loss: 5.562 Vali Loss: 14.294 Vali Acc: 0.500 Test Loss: 14.294 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 50.365875482559204
Epoch: 3, Steps: 18 | Train Loss: 2.883 Vali Loss: 4.579 Vali Acc: 0.490 Test Loss: 4.579 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 44.676095962524414
Epoch: 4, Steps: 18 | Train Loss: 2.249 Vali Loss: 6.447 Vali Acc: 0.540 Test Loss: 6.447 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 53.65616703033447
Epoch: 5, Steps: 18 | Train Loss: 2.759 Vali Loss: 11.426 Vali Acc: 0.530 Test Loss: 11.426 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 52.604363679885864
Epoch: 6, Steps: 18 | Train Loss: 3.024 Vali Loss: 10.390 Vali Acc: 0.580 Test Loss: 10.390 Test Acc: 0.580
Validation loss decreased (-0.569960 --> -0.579896).  Saving model ...
Epoch: 7 cost time: 54.77133297920227
Epoch: 7, Steps: 18 | Train Loss: 2.412 Vali Loss: 17.332 Vali Acc: 0.560 Test Loss: 17.332 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 57.05321168899536
Epoch: 8, Steps: 18 | Train Loss: 2.251 Vali Loss: 22.740 Vali Acc: 0.540 Test Loss: 22.740 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 57.07524561882019
Epoch: 9, Steps: 18 | Train Loss: 3.047 Vali Loss: 13.494 Vali Acc: 0.500 Test Loss: 13.494 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 60.36210250854492
Epoch: 10, Steps: 18 | Train Loss: 3.908 Vali Loss: 26.871 Vali Acc: 0.550 Test Loss: 26.871 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 60.88475799560547
Epoch: 11, Steps: 18 | Train Loss: 3.405 Vali Loss: 19.758 Vali Acc: 0.580 Test Loss: 19.758 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 60.58523201942444
Epoch: 12, Steps: 18 | Train Loss: 5.185 Vali Loss: 23.966 Vali Acc: 0.510 Test Loss: 23.966 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 63.54695415496826
Epoch: 13, Steps: 18 | Train Loss: 1.406 Vali Loss: 36.056 Vali Acc: 0.490 Test Loss: 36.056 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 61.0543007850647
Epoch: 14, Steps: 18 | Train Loss: 2.533 Vali Loss: 21.849 Vali Acc: 0.570 Test Loss: 21.849 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 63.289631843566895
Epoch: 15, Steps: 18 | Train Loss: 2.140 Vali Loss: 38.553 Vali Acc: 0.490 Test Loss: 38.553 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 62.4841685295105
Epoch: 16, Steps: 18 | Train Loss: 3.709 Vali Loss: 33.739 Vali Acc: 0.430 Test Loss: 33.739 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 14467586
model size : 74.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 28.675448417663574
Epoch: 1, Steps: 18 | Train Loss: 2.100 Vali Loss: 7.650 Vali Acc: 0.490 Test Loss: 7.650 Test Acc: 0.490
Validation loss decreased (inf --> -0.489924).  Saving model ...
Epoch: 2 cost time: 34.887760400772095
Epoch: 2, Steps: 18 | Train Loss: 3.594 Vali Loss: 4.593 Vali Acc: 0.560 Test Loss: 4.593 Test Acc: 0.560
Validation loss decreased (-0.489924 --> -0.559954).  Saving model ...
Epoch: 3 cost time: 34.57513999938965
Epoch: 3, Steps: 18 | Train Loss: 3.054 Vali Loss: 9.264 Vali Acc: 0.500 Test Loss: 9.264 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 32.41181492805481
Epoch: 4, Steps: 18 | Train Loss: 3.729 Vali Loss: 12.842 Vali Acc: 0.480 Test Loss: 12.842 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 37.49521613121033
Epoch: 5, Steps: 18 | Train Loss: 2.263 Vali Loss: 5.635 Vali Acc: 0.560 Test Loss: 5.635 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 38.67182207107544
Epoch: 6, Steps: 18 | Train Loss: 2.717 Vali Loss: 10.662 Vali Acc: 0.580 Test Loss: 10.662 Test Acc: 0.580
Validation loss decreased (-0.559954 --> -0.579893).  Saving model ...
Epoch: 7 cost time: 36.22817897796631
Epoch: 7, Steps: 18 | Train Loss: 2.271 Vali Loss: 18.232 Vali Acc: 0.520 Test Loss: 18.232 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 40.8967821598053
Epoch: 8, Steps: 18 | Train Loss: 5.076 Vali Loss: 33.675 Vali Acc: 0.520 Test Loss: 33.675 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 40.83958888053894
Epoch: 9, Steps: 18 | Train Loss: 5.324 Vali Loss: 11.472 Vali Acc: 0.590 Test Loss: 11.472 Test Acc: 0.590
Validation loss decreased (-0.579893 --> -0.589885).  Saving model ...
Epoch: 10 cost time: 36.528605699539185
Epoch: 10, Steps: 18 | Train Loss: 2.890 Vali Loss: 18.251 Vali Acc: 0.540 Test Loss: 18.251 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 41.60516858100891
Epoch: 11, Steps: 18 | Train Loss: 2.912 Vali Loss: 15.135 Vali Acc: 0.560 Test Loss: 15.135 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 41.13916802406311
Epoch: 12, Steps: 18 | Train Loss: 8.442 Vali Loss: 50.876 Vali Acc: 0.520 Test Loss: 50.876 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 37.12979197502136
Epoch: 13, Steps: 18 | Train Loss: 3.115 Vali Loss: 25.023 Vali Acc: 0.530 Test Loss: 25.023 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 43.14048790931702
Epoch: 14, Steps: 18 | Train Loss: 0.751 Vali Loss: 47.711 Vali Acc: 0.510 Test Loss: 47.711 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 41.34176468849182
Epoch: 15, Steps: 18 | Train Loss: 6.322 Vali Loss: 23.938 Vali Acc: 0.510 Test Loss: 23.938 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 37.596789836883545
Epoch: 16, Steps: 18 | Train Loss: 3.255 Vali Loss: 21.422 Vali Acc: 0.500 Test Loss: 21.422 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 44.16416525840759
Epoch: 17, Steps: 18 | Train Loss: 2.031 Vali Loss: 24.568 Vali Acc: 0.490 Test Loss: 24.568 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 38.74107074737549
Epoch: 18, Steps: 18 | Train Loss: 1.881 Vali Loss: 26.688 Vali Acc: 0.510 Test Loss: 26.688 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 36.3380970954895
Epoch: 19, Steps: 18 | Train Loss: 3.049 Vali Loss: 57.551 Vali Acc: 0.500 Test Loss: 57.551 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 14467586
model size : 74.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 27.851289749145508
Epoch: 1, Steps: 18 | Train Loss: 2.155 Vali Loss: 7.639 Vali Acc: 0.500 Test Loss: 7.639 Test Acc: 0.500
Validation loss decreased (inf --> -0.499924).  Saving model ...
Epoch: 2 cost time: 28.24999737739563
Epoch: 2, Steps: 18 | Train Loss: 3.379 Vali Loss: 3.005 Vali Acc: 0.580 Test Loss: 3.005 Test Acc: 0.580
Validation loss decreased (-0.499924 --> -0.579970).  Saving model ...
Epoch: 3 cost time: 23.043013095855713
Epoch: 3, Steps: 18 | Train Loss: 2.304 Vali Loss: 13.251 Vali Acc: 0.500 Test Loss: 13.251 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.2227144241333
Epoch: 4, Steps: 18 | Train Loss: 2.151 Vali Loss: 10.503 Vali Acc: 0.530 Test Loss: 10.503 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 28.45164680480957
Epoch: 5, Steps: 18 | Train Loss: 3.069 Vali Loss: 15.751 Vali Acc: 0.520 Test Loss: 15.751 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 30.811155319213867
Epoch: 6, Steps: 18 | Train Loss: 4.607 Vali Loss: 14.110 Vali Acc: 0.500 Test Loss: 14.110 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 26.920632123947144
Epoch: 7, Steps: 18 | Train Loss: 10.300 Vali Loss: 18.250 Vali Acc: 0.550 Test Loss: 18.250 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 28.976451635360718
Epoch: 8, Steps: 18 | Train Loss: 8.409 Vali Loss: 39.732 Vali Acc: 0.480 Test Loss: 39.732 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 30.139458417892456
Epoch: 9, Steps: 18 | Train Loss: 5.788 Vali Loss: 18.605 Vali Acc: 0.520 Test Loss: 18.605 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 31.186397075653076
Epoch: 10, Steps: 18 | Train Loss: 3.697 Vali Loss: 30.635 Vali Acc: 0.520 Test Loss: 30.635 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 28.797502517700195
Epoch: 11, Steps: 18 | Train Loss: 1.564 Vali Loss: 19.166 Vali Acc: 0.520 Test Loss: 19.166 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 29.943679332733154
Epoch: 12, Steps: 18 | Train Loss: 1.990 Vali Loss: 71.909 Vali Acc: 0.500 Test Loss: 71.909 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 14467586
model size : 74.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.82200789451599
Epoch: 1, Steps: 18 | Train Loss: 1.676 Vali Loss: 4.658 Vali Acc: 0.510 Test Loss: 4.658 Test Acc: 0.510
Validation loss decreased (inf --> -0.509953).  Saving model ...
Epoch: 2 cost time: 23.193945169448853
Epoch: 2, Steps: 18 | Train Loss: 1.682 Vali Loss: 2.986 Vali Acc: 0.520 Test Loss: 2.986 Test Acc: 0.520
Validation loss decreased (-0.509953 --> -0.519970).  Saving model ...
Epoch: 3 cost time: 20.26421618461609
Epoch: 3, Steps: 18 | Train Loss: 2.294 Vali Loss: 5.275 Vali Acc: 0.530 Test Loss: 5.275 Test Acc: 0.530
Validation loss decreased (-0.519970 --> -0.529947).  Saving model ...
Epoch: 4 cost time: 25.81146550178528
Epoch: 4, Steps: 18 | Train Loss: 2.164 Vali Loss: 5.455 Vali Acc: 0.490 Test Loss: 5.455 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.485738515853882
Epoch: 5, Steps: 18 | Train Loss: 1.648 Vali Loss: 9.201 Vali Acc: 0.510 Test Loss: 9.201 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.97527527809143
Epoch: 6, Steps: 18 | Train Loss: 2.079 Vali Loss: 7.944 Vali Acc: 0.520 Test Loss: 7.944 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 23.496734142303467
Epoch: 7, Steps: 18 | Train Loss: 3.775 Vali Loss: 15.702 Vali Acc: 0.520 Test Loss: 15.702 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 25.962372303009033
Epoch: 8, Steps: 18 | Train Loss: 2.682 Vali Loss: 11.911 Vali Acc: 0.500 Test Loss: 11.911 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 25.388688564300537
Epoch: 9, Steps: 18 | Train Loss: 1.267 Vali Loss: 19.789 Vali Acc: 0.460 Test Loss: 19.789 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 27.16469383239746
Epoch: 10, Steps: 18 | Train Loss: 4.132 Vali Loss: 25.365 Vali Acc: 0.480 Test Loss: 25.365 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 26.389150857925415
Epoch: 11, Steps: 18 | Train Loss: 3.712 Vali Loss: 20.734 Vali Acc: 0.520 Test Loss: 20.734 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 23.581971645355225
Epoch: 12, Steps: 18 | Train Loss: 1.223 Vali Loss: 22.425 Vali Acc: 0.490 Test Loss: 22.425 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 25.605818510055542
Epoch: 13, Steps: 18 | Train Loss: 2.219 Vali Loss: 25.642 Vali Acc: 0.460 Test Loss: 25.642 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 14467586
model size : 74.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.51667332649231
Epoch: 1, Steps: 18 | Train Loss: 1.766 Vali Loss: 8.226 Vali Acc: 0.500 Test Loss: 8.226 Test Acc: 0.500
Validation loss decreased (inf --> -0.499918).  Saving model ...
Epoch: 2 cost time: 23.66821837425232
Epoch: 2, Steps: 18 | Train Loss: 3.741 Vali Loss: 2.887 Vali Acc: 0.560 Test Loss: 2.887 Test Acc: 0.560
Validation loss decreased (-0.499918 --> -0.559971).  Saving model ...
Epoch: 3 cost time: 19.708362579345703
Epoch: 3, Steps: 18 | Train Loss: 2.034 Vali Loss: 5.775 Vali Acc: 0.570 Test Loss: 5.775 Test Acc: 0.570
Validation loss decreased (-0.559971 --> -0.569942).  Saving model ...
Epoch: 4 cost time: 23.32465362548828
Epoch: 4, Steps: 18 | Train Loss: 4.732 Vali Loss: 20.212 Vali Acc: 0.490 Test Loss: 20.212 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.084112644195557
Epoch: 5, Steps: 18 | Train Loss: 4.026 Vali Loss: 8.048 Vali Acc: 0.530 Test Loss: 8.048 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.681434869766235
Epoch: 6, Steps: 18 | Train Loss: 4.324 Vali Loss: 11.727 Vali Acc: 0.550 Test Loss: 11.727 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 23.35706615447998
Epoch: 7, Steps: 18 | Train Loss: 2.353 Vali Loss: 11.408 Vali Acc: 0.540 Test Loss: 11.408 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 22.009852409362793
Epoch: 8, Steps: 18 | Train Loss: 6.026 Vali Loss: 17.986 Vali Acc: 0.500 Test Loss: 17.986 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.130456686019897
Epoch: 9, Steps: 18 | Train Loss: 3.139 Vali Loss: 25.277 Vali Acc: 0.540 Test Loss: 25.277 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 26.862003564834595
Epoch: 10, Steps: 18 | Train Loss: 4.628 Vali Loss: 11.687 Vali Acc: 0.580 Test Loss: 11.687 Test Acc: 0.580
Validation loss decreased (-0.569942 --> -0.579883).  Saving model ...
Epoch: 11 cost time: 24.579797506332397
Epoch: 11, Steps: 18 | Train Loss: 0.932 Vali Loss: 9.846 Vali Acc: 0.610 Test Loss: 9.846 Test Acc: 0.610
Validation loss decreased (-0.579883 --> -0.609902).  Saving model ...
Epoch: 12 cost time: 19.995768547058105
Epoch: 12, Steps: 18 | Train Loss: 1.974 Vali Loss: 16.673 Vali Acc: 0.620 Test Loss: 16.673 Test Acc: 0.620
Validation loss decreased (-0.609902 --> -0.619833).  Saving model ...
Epoch: 13 cost time: 24.799013376235962
Epoch: 13, Steps: 18 | Train Loss: 0.568 Vali Loss: 25.538 Vali Acc: 0.570 Test Loss: 25.538 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.00293231010437
Epoch: 14, Steps: 18 | Train Loss: 2.466 Vali Loss: 28.593 Vali Acc: 0.550 Test Loss: 28.593 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 24.07439637184143
Epoch: 15, Steps: 18 | Train Loss: 3.410 Vali Loss: 22.611 Vali Acc: 0.510 Test Loss: 22.611 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 25.931476593017578
Epoch: 16, Steps: 18 | Train Loss: 1.416 Vali Loss: 37.053 Vali Acc: 0.500 Test Loss: 37.053 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 19.9042649269104
Epoch: 17, Steps: 18 | Train Loss: 2.308 Vali Loss: 20.244 Vali Acc: 0.590 Test Loss: 20.244 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 24.031091451644897
Epoch: 18, Steps: 18 | Train Loss: 2.451 Vali Loss: 29.618 Vali Acc: 0.570 Test Loss: 29.618 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 24.076406478881836
Epoch: 19, Steps: 18 | Train Loss: 1.481 Vali Loss: 48.228 Vali Acc: 0.510 Test Loss: 48.228 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 22.720062971115112
Epoch: 20, Steps: 18 | Train Loss: 2.719 Vali Loss: 35.332 Vali Acc: 0.540 Test Loss: 35.332 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 26.726917505264282
Epoch: 21, Steps: 18 | Train Loss: 0.768 Vali Loss: 46.968 Vali Acc: 0.580 Test Loss: 46.968 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 20.68972897529602
Epoch: 22, Steps: 18 | Train Loss: 5.085 Vali Loss: 73.582 Vali Acc: 0.500 Test Loss: 73.582 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 14467586
model size : 74.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.92718482017517
Epoch: 1, Steps: 18 | Train Loss: 1.650 Vali Loss: 3.562 Vali Acc: 0.500 Test Loss: 3.562 Test Acc: 0.500
Validation loss decreased (inf --> -0.499964).  Saving model ...
Epoch: 2 cost time: 18.682615041732788
Epoch: 2, Steps: 18 | Train Loss: 2.937 Vali Loss: 6.243 Vali Acc: 0.450 Test Loss: 6.243 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.971748113632202
Epoch: 3, Steps: 18 | Train Loss: 2.208 Vali Loss: 2.228 Vali Acc: 0.550 Test Loss: 2.228 Test Acc: 0.550
Validation loss decreased (-0.499964 --> -0.549978).  Saving model ...
Epoch: 4 cost time: 19.544076204299927
Epoch: 4, Steps: 18 | Train Loss: 3.953 Vali Loss: 12.402 Vali Acc: 0.510 Test Loss: 12.402 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.730648279190063
Epoch: 5, Steps: 18 | Train Loss: 4.313 Vali Loss: 15.586 Vali Acc: 0.460 Test Loss: 15.586 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.98340606689453
Epoch: 6, Steps: 18 | Train Loss: 2.768 Vali Loss: 5.502 Vali Acc: 0.570 Test Loss: 5.502 Test Acc: 0.570
Validation loss decreased (-0.549978 --> -0.569945).  Saving model ...
Epoch: 7 cost time: 19.945308208465576
Epoch: 7, Steps: 18 | Train Loss: 1.852 Vali Loss: 17.746 Vali Acc: 0.500 Test Loss: 17.746 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.33736562728882
Epoch: 8, Steps: 18 | Train Loss: 3.178 Vali Loss: 14.708 Vali Acc: 0.580 Test Loss: 14.708 Test Acc: 0.580
Validation loss decreased (-0.569945 --> -0.579853).  Saving model ...
Epoch: 9 cost time: 20.15510892868042
Epoch: 9, Steps: 18 | Train Loss: 4.428 Vali Loss: 12.109 Vali Acc: 0.460 Test Loss: 12.109 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 19.84056544303894
Epoch: 10, Steps: 18 | Train Loss: 2.276 Vali Loss: 19.078 Vali Acc: 0.420 Test Loss: 19.078 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 20.86443305015564
Epoch: 11, Steps: 18 | Train Loss: 1.229 Vali Loss: 26.098 Vali Acc: 0.440 Test Loss: 26.098 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.385372400283813
Epoch: 12, Steps: 18 | Train Loss: 2.372 Vali Loss: 18.668 Vali Acc: 0.420 Test Loss: 18.668 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 23.748701333999634
Epoch: 13, Steps: 18 | Train Loss: 1.676 Vali Loss: 25.759 Vali Acc: 0.540 Test Loss: 25.759 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 19.989437580108643
Epoch: 14, Steps: 18 | Train Loss: 3.171 Vali Loss: 45.045 Vali Acc: 0.480 Test Loss: 45.045 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 21.370312213897705
Epoch: 15, Steps: 18 | Train Loss: 9.342 Vali Loss: 14.308 Vali Acc: 0.520 Test Loss: 14.308 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 19.626893997192383
Epoch: 16, Steps: 18 | Train Loss: 3.686 Vali Loss: 20.143 Vali Acc: 0.460 Test Loss: 20.143 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 22.01452374458313
Epoch: 17, Steps: 18 | Train Loss: 0.600 Vali Loss: 12.514 Vali Acc: 0.440 Test Loss: 12.514 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 23.764155387878418
Epoch: 18, Steps: 18 | Train Loss: 0.994 Vali Loss: 36.208 Vali Acc: 0.570 Test Loss: 36.208 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 14467586
model size : 74.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.70238447189331
Epoch: 1, Steps: 18 | Train Loss: 1.079 Vali Loss: 1.490 Vali Acc: 0.500 Test Loss: 1.490 Test Acc: 0.500
Validation loss decreased (inf --> -0.499985).  Saving model ...
Epoch: 2 cost time: 17.506341457366943
Epoch: 2, Steps: 18 | Train Loss: 1.817 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
Validation loss decreased (-0.499985 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 21.64386534690857
Epoch: 3, Steps: 18 | Train Loss: 1.927 Vali Loss: 5.452 Vali Acc: 0.500 Test Loss: 5.452 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.87806463241577
Epoch: 4, Steps: 18 | Train Loss: 2.721 Vali Loss: 7.881 Vali Acc: 0.500 Test Loss: 7.881 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.541207551956177
Epoch: 5, Steps: 18 | Train Loss: 1.732 Vali Loss: 10.307 Vali Acc: 0.500 Test Loss: 10.307 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 23.172600984573364
Epoch: 6, Steps: 18 | Train Loss: 5.461 Vali Loss: 9.046 Vali Acc: 0.490 Test Loss: 9.046 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 16.309558153152466
Epoch: 7, Steps: 18 | Train Loss: 3.611 Vali Loss: 19.639 Vali Acc: 0.500 Test Loss: 19.639 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 22.389847993850708
Epoch: 8, Steps: 18 | Train Loss: 4.641 Vali Loss: 3.693 Vali Acc: 0.490 Test Loss: 3.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 19.97499418258667
Epoch: 9, Steps: 18 | Train Loss: 1.061 Vali Loss: 9.958 Vali Acc: 0.520 Test Loss: 9.958 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 21.79390859603882
Epoch: 10, Steps: 18 | Train Loss: 4.050 Vali Loss: 5.921 Vali Acc: 0.530 Test Loss: 5.921 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 23.190715074539185
Epoch: 11, Steps: 18 | Train Loss: 1.169 Vali Loss: 5.802 Vali Acc: 0.550 Test Loss: 5.802 Test Acc: 0.550
Validation loss decreased (-0.529991 --> -0.549942).  Saving model ...
Epoch: 12 cost time: 16.60640573501587
Epoch: 12, Steps: 18 | Train Loss: 1.529 Vali Loss: 19.024 Vali Acc: 0.500 Test Loss: 19.024 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 21.309662103652954
Epoch: 13, Steps: 18 | Train Loss: 1.379 Vali Loss: 4.492 Vali Acc: 0.520 Test Loss: 4.492 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 18.31728768348694
Epoch: 14, Steps: 18 | Train Loss: 0.935 Vali Loss: 26.858 Vali Acc: 0.500 Test Loss: 26.858 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 24.192071437835693
Epoch: 15, Steps: 18 | Train Loss: 2.588 Vali Loss: 8.250 Vali Acc: 0.510 Test Loss: 8.250 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 20.025144577026367
Epoch: 16, Steps: 18 | Train Loss: 0.481 Vali Loss: 11.337 Vali Acc: 0.540 Test Loss: 11.337 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 19.99721884727478
Epoch: 17, Steps: 18 | Train Loss: 0.438 Vali Loss: 9.463 Vali Acc: 0.490 Test Loss: 9.463 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 17.394315481185913
Epoch: 18, Steps: 18 | Train Loss: 3.073 Vali Loss: 9.396 Vali Acc: 0.510 Test Loss: 9.396 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 21.445971727371216
Epoch: 19, Steps: 18 | Train Loss: 0.497 Vali Loss: 14.294 Vali Acc: 0.490 Test Loss: 14.294 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 23.656447887420654
Epoch: 20, Steps: 18 | Train Loss: 2.438 Vali Loss: 29.763 Vali Acc: 0.500 Test Loss: 29.763 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 18.48823857307434
Epoch: 21, Steps: 18 | Train Loss: 2.014 Vali Loss: 11.509 Vali Acc: 0.520 Test Loss: 11.509 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 14467586
model size : 74.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 99.42924451828003
Epoch: 1, Steps: 18 | Train Loss: 2.972 Vali Loss: 6.839 Vali Acc: 0.510 Test Loss: 6.839 Test Acc: 0.510
Validation loss decreased (inf --> -0.509932).  Saving model ...
Epoch: 2 cost time: 100.20789670944214
Epoch: 2, Steps: 18 | Train Loss: 4.843 Vali Loss: 10.658 Vali Acc: 0.500 Test Loss: 10.658 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 104.9338767528534
Epoch: 3, Steps: 18 | Train Loss: 9.395 Vali Loss: 10.531 Vali Acc: 0.530 Test Loss: 10.531 Test Acc: 0.530
Validation loss decreased (-0.509932 --> -0.529895).  Saving model ...
Epoch: 4 cost time: 107.75717425346375
Epoch: 4, Steps: 18 | Train Loss: 3.793 Vali Loss: 21.270 Vali Acc: 0.510 Test Loss: 21.270 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 113.47668170928955
Epoch: 5, Steps: 18 | Train Loss: 4.773 Vali Loss: 24.335 Vali Acc: 0.510 Test Loss: 24.335 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 114.11944437026978
Epoch: 6, Steps: 18 | Train Loss: 4.984 Vali Loss: 14.906 Vali Acc: 0.520 Test Loss: 14.906 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 124.23782563209534
Epoch: 7, Steps: 18 | Train Loss: 5.671 Vali Loss: 16.865 Vali Acc: 0.550 Test Loss: 16.865 Test Acc: 0.550
Validation loss decreased (-0.529895 --> -0.549831).  Saving model ...
Epoch: 8 cost time: 124.36217379570007
Epoch: 8, Steps: 18 | Train Loss: 2.188 Vali Loss: 17.783 Vali Acc: 0.430 Test Loss: 17.783 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 134.18582272529602
Epoch: 9, Steps: 18 | Train Loss: 6.045 Vali Loss: 26.915 Vali Acc: 0.490 Test Loss: 26.915 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 129.08788752555847
Epoch: 10, Steps: 18 | Train Loss: 7.166 Vali Loss: 17.529 Vali Acc: 0.500 Test Loss: 17.529 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 139.53923082351685
Epoch: 11, Steps: 18 | Train Loss: 4.179 Vali Loss: 35.534 Vali Acc: 0.500 Test Loss: 35.534 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 139.88258385658264
Epoch: 12, Steps: 18 | Train Loss: 4.895 Vali Loss: 18.504 Vali Acc: 0.500 Test Loss: 18.504 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 133.6995542049408
Epoch: 13, Steps: 18 | Train Loss: 3.719 Vali Loss: 39.645 Vali Acc: 0.500 Test Loss: 39.645 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 139.12380456924438
Epoch: 14, Steps: 18 | Train Loss: 3.889 Vali Loss: 23.814 Vali Acc: 0.500 Test Loss: 23.814 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 136.28737616539001
Epoch: 15, Steps: 18 | Train Loss: 3.395 Vali Loss: 32.965 Vali Acc: 0.520 Test Loss: 32.965 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 133.6856997013092
Epoch: 16, Steps: 18 | Train Loss: 3.269 Vali Loss: 47.132 Vali Acc: 0.500 Test Loss: 47.132 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 135.24212741851807
Epoch: 17, Steps: 18 | Train Loss: 3.122 Vali Loss: 66.442 Vali Acc: 0.510 Test Loss: 66.442 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 14074370
model size : 73.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 81.11554265022278
Epoch: 1, Steps: 18 | Train Loss: 2.867 Vali Loss: 4.787 Vali Acc: 0.540 Test Loss: 4.787 Test Acc: 0.540
Validation loss decreased (inf --> -0.539952).  Saving model ...
Epoch: 2 cost time: 80.40281653404236
Epoch: 2, Steps: 18 | Train Loss: 4.959 Vali Loss: 12.505 Vali Acc: 0.450 Test Loss: 12.505 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 82.61673617362976
Epoch: 3, Steps: 18 | Train Loss: 5.057 Vali Loss: 8.224 Vali Acc: 0.530 Test Loss: 8.224 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 88.12544822692871
Epoch: 4, Steps: 18 | Train Loss: 4.989 Vali Loss: 21.715 Vali Acc: 0.510 Test Loss: 21.715 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 87.11506462097168
Epoch: 5, Steps: 18 | Train Loss: 4.602 Vali Loss: 8.754 Vali Acc: 0.540 Test Loss: 8.754 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 88.14921641349792
Epoch: 6, Steps: 18 | Train Loss: 3.822 Vali Loss: 11.358 Vali Acc: 0.540 Test Loss: 11.358 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 88.63180994987488
Epoch: 7, Steps: 18 | Train Loss: 6.706 Vali Loss: 13.877 Vali Acc: 0.550 Test Loss: 13.877 Test Acc: 0.550
Validation loss decreased (-0.539952 --> -0.549861).  Saving model ...
Epoch: 8 cost time: 98.19627499580383
Epoch: 8, Steps: 18 | Train Loss: 4.639 Vali Loss: 18.352 Vali Acc: 0.480 Test Loss: 18.352 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 105.01597428321838
Epoch: 9, Steps: 18 | Train Loss: 6.258 Vali Loss: 23.782 Vali Acc: 0.520 Test Loss: 23.782 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 102.85355162620544
Epoch: 10, Steps: 18 | Train Loss: 7.900 Vali Loss: 21.636 Vali Acc: 0.540 Test Loss: 21.636 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 102.58639693260193
Epoch: 11, Steps: 18 | Train Loss: 4.043 Vali Loss: 17.801 Vali Acc: 0.610 Test Loss: 17.801 Test Acc: 0.610
Validation loss decreased (-0.549861 --> -0.609822).  Saving model ...
Epoch: 12 cost time: 102.6693799495697
Epoch: 12, Steps: 18 | Train Loss: 5.102 Vali Loss: 29.620 Vali Acc: 0.500 Test Loss: 29.620 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 101.26799941062927
Epoch: 13, Steps: 18 | Train Loss: 4.882 Vali Loss: 24.407 Vali Acc: 0.490 Test Loss: 24.407 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 104.6142086982727
Epoch: 14, Steps: 18 | Train Loss: 3.021 Vali Loss: 24.020 Vali Acc: 0.480 Test Loss: 24.020 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 107.17579245567322
Epoch: 15, Steps: 18 | Train Loss: 2.669 Vali Loss: 25.014 Vali Acc: 0.550 Test Loss: 25.014 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 105.21312093734741
Epoch: 16, Steps: 18 | Train Loss: 2.924 Vali Loss: 43.446 Vali Acc: 0.510 Test Loss: 43.446 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 107.45462727546692
Epoch: 17, Steps: 18 | Train Loss: 1.821 Vali Loss: 33.044 Vali Acc: 0.560 Test Loss: 33.044 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 110.54652953147888
Epoch: 18, Steps: 18 | Train Loss: 3.297 Vali Loss: 31.496 Vali Acc: 0.480 Test Loss: 31.496 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 107.81193137168884
Epoch: 19, Steps: 18 | Train Loss: 4.263 Vali Loss: 38.288 Vali Acc: 0.530 Test Loss: 38.288 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 97.18721842765808
Epoch: 20, Steps: 18 | Train Loss: 1.410 Vali Loss: 54.952 Vali Acc: 0.520 Test Loss: 54.952 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 105.56035327911377
Epoch: 21, Steps: 18 | Train Loss: 1.519 Vali Loss: 43.796 Vali Acc: 0.560 Test Loss: 43.796 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 14074370
model size : 73.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 62.17516255378723
Epoch: 1, Steps: 18 | Train Loss: 3.154 Vali Loss: 4.532 Vali Acc: 0.500 Test Loss: 4.532 Test Acc: 0.500
Validation loss decreased (inf --> -0.499955).  Saving model ...
Epoch: 2 cost time: 68.44183921813965
Epoch: 2, Steps: 18 | Train Loss: 4.277 Vali Loss: 8.407 Vali Acc: 0.510 Test Loss: 8.407 Test Acc: 0.510
Validation loss decreased (-0.499955 --> -0.509916).  Saving model ...
Epoch: 3 cost time: 61.919888496398926
Epoch: 3, Steps: 18 | Train Loss: 6.143 Vali Loss: 17.349 Vali Acc: 0.430 Test Loss: 17.349 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 71.30584907531738
Epoch: 4, Steps: 18 | Train Loss: 6.842 Vali Loss: 6.114 Vali Acc: 0.560 Test Loss: 6.114 Test Acc: 0.560
Validation loss decreased (-0.509916 --> -0.559939).  Saving model ...
Epoch: 5 cost time: 70.86038255691528
Epoch: 5, Steps: 18 | Train Loss: 5.857 Vali Loss: 10.143 Vali Acc: 0.520 Test Loss: 10.143 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 72.631352186203
Epoch: 6, Steps: 18 | Train Loss: 3.883 Vali Loss: 10.454 Vali Acc: 0.550 Test Loss: 10.454 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 79.2385904788971
Epoch: 7, Steps: 18 | Train Loss: 5.007 Vali Loss: 24.600 Vali Acc: 0.520 Test Loss: 24.600 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 79.65079092979431
Epoch: 8, Steps: 18 | Train Loss: 5.776 Vali Loss: 10.867 Vali Acc: 0.550 Test Loss: 10.867 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 76.8343894481659
Epoch: 9, Steps: 18 | Train Loss: 3.006 Vali Loss: 15.432 Vali Acc: 0.520 Test Loss: 15.432 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 83.34434461593628
Epoch: 10, Steps: 18 | Train Loss: 4.166 Vali Loss: 26.152 Vali Acc: 0.500 Test Loss: 26.152 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 81.62802863121033
Epoch: 11, Steps: 18 | Train Loss: 8.634 Vali Loss: 29.067 Vali Acc: 0.530 Test Loss: 29.067 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 79.79129099845886
Epoch: 12, Steps: 18 | Train Loss: 12.665 Vali Loss: 18.376 Vali Acc: 0.500 Test Loss: 18.376 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 81.15650367736816
Epoch: 13, Steps: 18 | Train Loss: 5.184 Vali Loss: 18.690 Vali Acc: 0.540 Test Loss: 18.690 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 86.40834331512451
Epoch: 14, Steps: 18 | Train Loss: 1.561 Vali Loss: 18.060 Vali Acc: 0.560 Test Loss: 18.060 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 14074370
model size : 73.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 51.83746027946472
Epoch: 1, Steps: 18 | Train Loss: 3.129 Vali Loss: 5.436 Vali Acc: 0.490 Test Loss: 5.436 Test Acc: 0.490
Validation loss decreased (inf --> -0.489946).  Saving model ...
Epoch: 2 cost time: 49.17346119880676
Epoch: 2, Steps: 18 | Train Loss: 3.676 Vali Loss: 12.451 Vali Acc: 0.500 Test Loss: 12.451 Test Acc: 0.500
Validation loss decreased (-0.489946 --> -0.499875).  Saving model ...
Epoch: 3 cost time: 49.741228342056274
Epoch: 3, Steps: 18 | Train Loss: 5.050 Vali Loss: 12.421 Vali Acc: 0.520 Test Loss: 12.421 Test Acc: 0.520
Validation loss decreased (-0.499875 --> -0.519876).  Saving model ...
Epoch: 4 cost time: 52.65077543258667
Epoch: 4, Steps: 18 | Train Loss: 3.788 Vali Loss: 13.905 Vali Acc: 0.510 Test Loss: 13.905 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 49.31392955780029
Epoch: 5, Steps: 18 | Train Loss: 4.986 Vali Loss: 13.895 Vali Acc: 0.480 Test Loss: 13.895 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 58.603837728500366
Epoch: 6, Steps: 18 | Train Loss: 3.606 Vali Loss: 11.631 Vali Acc: 0.560 Test Loss: 11.631 Test Acc: 0.560
Validation loss decreased (-0.519876 --> -0.559884).  Saving model ...
Epoch: 7 cost time: 53.887489557266235
Epoch: 7, Steps: 18 | Train Loss: 5.332 Vali Loss: 22.515 Vali Acc: 0.480 Test Loss: 22.515 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 62.41892647743225
Epoch: 8, Steps: 18 | Train Loss: 9.707 Vali Loss: 14.411 Vali Acc: 0.560 Test Loss: 14.411 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 58.63768410682678
Epoch: 9, Steps: 18 | Train Loss: 5.679 Vali Loss: 44.928 Vali Acc: 0.500 Test Loss: 44.928 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 62.25176501274109
Epoch: 10, Steps: 18 | Train Loss: 4.099 Vali Loss: 27.333 Vali Acc: 0.510 Test Loss: 27.333 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 56.483832359313965
Epoch: 11, Steps: 18 | Train Loss: 7.450 Vali Loss: 20.703 Vali Acc: 0.490 Test Loss: 20.703 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 61.84523344039917
Epoch: 12, Steps: 18 | Train Loss: 4.576 Vali Loss: 14.381 Vali Acc: 0.530 Test Loss: 14.381 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 60.82864832878113
Epoch: 13, Steps: 18 | Train Loss: 2.029 Vali Loss: 24.106 Vali Acc: 0.520 Test Loss: 24.106 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 63.909940004348755
Epoch: 14, Steps: 18 | Train Loss: 1.680 Vali Loss: 18.686 Vali Acc: 0.590 Test Loss: 18.686 Test Acc: 0.590
Validation loss decreased (-0.559884 --> -0.589813).  Saving model ...
Epoch: 15 cost time: 57.865179777145386
Epoch: 15, Steps: 18 | Train Loss: 1.772 Vali Loss: 21.899 Vali Acc: 0.570 Test Loss: 21.899 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 61.18676018714905
Epoch: 16, Steps: 18 | Train Loss: 2.377 Vali Loss: 26.137 Vali Acc: 0.500 Test Loss: 26.137 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 61.9731125831604
Epoch: 17, Steps: 18 | Train Loss: 0.862 Vali Loss: 35.934 Vali Acc: 0.560 Test Loss: 35.934 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 62.42373967170715
Epoch: 18, Steps: 18 | Train Loss: 0.638 Vali Loss: 38.145 Vali Acc: 0.550 Test Loss: 38.145 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 62.794278621673584
Epoch: 19, Steps: 18 | Train Loss: 1.172 Vali Loss: 24.607 Vali Acc: 0.610 Test Loss: 24.607 Test Acc: 0.610
Validation loss decreased (-0.589813 --> -0.609754).  Saving model ...
Epoch: 20 cost time: 63.925501346588135
Epoch: 20, Steps: 18 | Train Loss: 0.688 Vali Loss: 27.683 Vali Acc: 0.550 Test Loss: 27.683 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 66.42109107971191
Epoch: 21, Steps: 18 | Train Loss: 1.582 Vali Loss: 28.491 Vali Acc: 0.550 Test Loss: 28.491 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 56.976945877075195
Epoch: 22, Steps: 18 | Train Loss: 1.888 Vali Loss: 39.330 Vali Acc: 0.530 Test Loss: 39.330 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 64.86110925674438
Epoch: 23, Steps: 18 | Train Loss: 6.087 Vali Loss: 68.104 Vali Acc: 0.530 Test Loss: 68.104 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 57.0443058013916
Epoch: 24, Steps: 18 | Train Loss: 4.971 Vali Loss: 77.572 Vali Acc: 0.510 Test Loss: 77.572 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 64.34661936759949
Epoch: 25, Steps: 18 | Train Loss: 4.304 Vali Loss: 47.721 Vali Acc: 0.540 Test Loss: 47.721 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 59.2752411365509
Epoch: 26, Steps: 18 | Train Loss: 4.888 Vali Loss: 85.305 Vali Acc: 0.470 Test Loss: 85.305 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 62.13944482803345
Epoch: 27, Steps: 18 | Train Loss: 2.239 Vali Loss: 51.361 Vali Acc: 0.470 Test Loss: 51.361 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 53.114086627960205
Epoch: 28, Steps: 18 | Train Loss: 3.929 Vali Loss: 54.983 Vali Acc: 0.510 Test Loss: 54.983 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 61.88484477996826
Epoch: 29, Steps: 18 | Train Loss: 1.849 Vali Loss: 43.553 Vali Acc: 0.490 Test Loss: 43.553 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 14074370
model size : 73.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 31.547667026519775
Epoch: 1, Steps: 18 | Train Loss: 3.245 Vali Loss: 6.497 Vali Acc: 0.500 Test Loss: 6.497 Test Acc: 0.500
Validation loss decreased (inf --> -0.499935).  Saving model ...
Epoch: 2 cost time: 32.6271812915802
Epoch: 2, Steps: 18 | Train Loss: 5.484 Vali Loss: 4.475 Vali Acc: 0.490 Test Loss: 4.475 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 33.00830030441284
Epoch: 3, Steps: 18 | Train Loss: 9.429 Vali Loss: 23.473 Vali Acc: 0.500 Test Loss: 23.473 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 32.9139609336853
Epoch: 4, Steps: 18 | Train Loss: 9.242 Vali Loss: 16.481 Vali Acc: 0.490 Test Loss: 16.481 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 33.19749879837036
Epoch: 5, Steps: 18 | Train Loss: 5.160 Vali Loss: 7.823 Vali Acc: 0.510 Test Loss: 7.823 Test Acc: 0.510
Validation loss decreased (-0.499935 --> -0.509922).  Saving model ...
Epoch: 6 cost time: 36.669878005981445
Epoch: 6, Steps: 18 | Train Loss: 4.408 Vali Loss: 14.783 Vali Acc: 0.540 Test Loss: 14.783 Test Acc: 0.540
Validation loss decreased (-0.509922 --> -0.539852).  Saving model ...
Epoch: 7 cost time: 35.98843240737915
Epoch: 7, Steps: 18 | Train Loss: 4.181 Vali Loss: 17.576 Vali Acc: 0.540 Test Loss: 17.576 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 34.94241714477539
Epoch: 8, Steps: 18 | Train Loss: 7.655 Vali Loss: 26.764 Vali Acc: 0.520 Test Loss: 26.764 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 42.031198263168335
Epoch: 9, Steps: 18 | Train Loss: 1.293 Vali Loss: 22.947 Vali Acc: 0.540 Test Loss: 22.947 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 38.234312772750854
Epoch: 10, Steps: 18 | Train Loss: 4.517 Vali Loss: 18.217 Vali Acc: 0.520 Test Loss: 18.217 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 41.1991913318634
Epoch: 11, Steps: 18 | Train Loss: 1.827 Vali Loss: 22.363 Vali Acc: 0.540 Test Loss: 22.363 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 42.786842823028564
Epoch: 12, Steps: 18 | Train Loss: 2.885 Vali Loss: 30.457 Vali Acc: 0.500 Test Loss: 30.457 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 36.982163190841675
Epoch: 13, Steps: 18 | Train Loss: 3.255 Vali Loss: 50.210 Vali Acc: 0.510 Test Loss: 50.210 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 39.96471691131592
Epoch: 14, Steps: 18 | Train Loss: 6.324 Vali Loss: 20.988 Vali Acc: 0.550 Test Loss: 20.988 Test Acc: 0.550
Validation loss decreased (-0.539852 --> -0.549790).  Saving model ...
Epoch: 15 cost time: 41.722651720047
Epoch: 15, Steps: 18 | Train Loss: 2.374 Vali Loss: 25.521 Vali Acc: 0.440 Test Loss: 25.521 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 35.695974349975586
Epoch: 16, Steps: 18 | Train Loss: 3.097 Vali Loss: 27.681 Vali Acc: 0.500 Test Loss: 27.681 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 41.310728311538696
Epoch: 17, Steps: 18 | Train Loss: 1.828 Vali Loss: 38.102 Vali Acc: 0.500 Test Loss: 38.102 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 40.96496295928955
Epoch: 18, Steps: 18 | Train Loss: 2.120 Vali Loss: 45.971 Vali Acc: 0.480 Test Loss: 45.971 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 36.15410017967224
Epoch: 19, Steps: 18 | Train Loss: 5.168 Vali Loss: 36.828 Vali Acc: 0.510 Test Loss: 36.828 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 41.40987730026245
Epoch: 20, Steps: 18 | Train Loss: 3.992 Vali Loss: 89.777 Vali Acc: 0.510 Test Loss: 89.777 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 39.618635177612305
Epoch: 21, Steps: 18 | Train Loss: 7.249 Vali Loss: 43.027 Vali Acc: 0.470 Test Loss: 43.027 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 39.25072908401489
Epoch: 22, Steps: 18 | Train Loss: 5.063 Vali Loss: 44.935 Vali Acc: 0.500 Test Loss: 44.935 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 42.06379747390747
Epoch: 23, Steps: 18 | Train Loss: 1.584 Vali Loss: 57.802 Vali Acc: 0.510 Test Loss: 57.802 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 38.577778816223145
Epoch: 24, Steps: 18 | Train Loss: 1.960 Vali Loss: 84.709 Vali Acc: 0.500 Test Loss: 84.709 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 14074370
model size : 73.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 28.056947469711304
Epoch: 1, Steps: 18 | Train Loss: 2.544 Vali Loss: 2.458 Vali Acc: 0.520 Test Loss: 2.458 Test Acc: 0.520
Validation loss decreased (inf --> -0.519975).  Saving model ...
Epoch: 2 cost time: 29.030365467071533
Epoch: 2, Steps: 18 | Train Loss: 3.199 Vali Loss: 5.239 Vali Acc: 0.480 Test Loss: 5.239 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.304064512252808
Epoch: 3, Steps: 18 | Train Loss: 7.039 Vali Loss: 14.917 Vali Acc: 0.510 Test Loss: 14.917 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 24.665578842163086
Epoch: 4, Steps: 18 | Train Loss: 3.231 Vali Loss: 11.352 Vali Acc: 0.520 Test Loss: 11.352 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 30.36746382713318
Epoch: 5, Steps: 18 | Train Loss: 4.148 Vali Loss: 6.467 Vali Acc: 0.520 Test Loss: 6.467 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 28.236820220947266
Epoch: 6, Steps: 18 | Train Loss: 3.152 Vali Loss: 25.794 Vali Acc: 0.510 Test Loss: 25.794 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 23.245738744735718
Epoch: 7, Steps: 18 | Train Loss: 4.157 Vali Loss: 9.957 Vali Acc: 0.490 Test Loss: 9.957 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 27.873005628585815
Epoch: 8, Steps: 18 | Train Loss: 2.067 Vali Loss: 17.855 Vali Acc: 0.510 Test Loss: 17.855 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 32.2777783870697
Epoch: 9, Steps: 18 | Train Loss: 3.610 Vali Loss: 26.340 Vali Acc: 0.520 Test Loss: 26.340 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 30.138740062713623
Epoch: 10, Steps: 18 | Train Loss: 3.127 Vali Loss: 36.726 Vali Acc: 0.510 Test Loss: 36.726 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 23.77254819869995
Epoch: 11, Steps: 18 | Train Loss: 5.485 Vali Loss: 26.100 Vali Acc: 0.550 Test Loss: 26.100 Test Acc: 0.550
Validation loss decreased (-0.519975 --> -0.549739).  Saving model ...
Epoch: 12 cost time: 29.00484323501587
Epoch: 12, Steps: 18 | Train Loss: 1.746 Vali Loss: 18.969 Vali Acc: 0.480 Test Loss: 18.969 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 33.32867479324341
Epoch: 13, Steps: 18 | Train Loss: 2.353 Vali Loss: 36.352 Vali Acc: 0.530 Test Loss: 36.352 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 32.4593346118927
Epoch: 14, Steps: 18 | Train Loss: 1.928 Vali Loss: 38.731 Vali Acc: 0.490 Test Loss: 38.731 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 26.225143909454346
Epoch: 15, Steps: 18 | Train Loss: 1.009 Vali Loss: 24.954 Vali Acc: 0.530 Test Loss: 24.954 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 29.5019748210907
Epoch: 16, Steps: 18 | Train Loss: 1.442 Vali Loss: 24.339 Vali Acc: 0.490 Test Loss: 24.339 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 30.477166414260864
Epoch: 17, Steps: 18 | Train Loss: 0.907 Vali Loss: 19.880 Vali Acc: 0.550 Test Loss: 19.880 Test Acc: 0.550
Validation loss decreased (-0.549739 --> -0.549801).  Saving model ...
Epoch: 18 cost time: 29.893965244293213
Epoch: 18, Steps: 18 | Train Loss: 3.048 Vali Loss: 33.873 Vali Acc: 0.480 Test Loss: 33.873 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 29.486512660980225
Epoch: 19, Steps: 18 | Train Loss: 1.341 Vali Loss: 25.500 Vali Acc: 0.530 Test Loss: 25.500 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 31.73297691345215
Epoch: 20, Steps: 18 | Train Loss: 1.021 Vali Loss: 30.792 Vali Acc: 0.540 Test Loss: 30.792 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 30.024213552474976
Epoch: 21, Steps: 18 | Train Loss: 1.589 Vali Loss: 41.340 Vali Acc: 0.520 Test Loss: 41.340 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 24.880045413970947
Epoch: 22, Steps: 18 | Train Loss: 0.803 Vali Loss: 31.376 Vali Acc: 0.500 Test Loss: 31.376 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 30.018560647964478
Epoch: 23, Steps: 18 | Train Loss: 2.249 Vali Loss: 119.050 Vali Acc: 0.500 Test Loss: 119.050 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 32.66401982307434
Epoch: 24, Steps: 18 | Train Loss: 6.377 Vali Loss: 40.818 Vali Acc: 0.520 Test Loss: 40.818 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 26.25920343399048
Epoch: 25, Steps: 18 | Train Loss: 4.736 Vali Loss: 94.770 Vali Acc: 0.490 Test Loss: 94.770 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 27.46605372428894
Epoch: 26, Steps: 18 | Train Loss: 2.762 Vali Loss: 39.632 Vali Acc: 0.460 Test Loss: 39.632 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 30.503499746322632
Epoch: 27, Steps: 18 | Train Loss: 0.504 Vali Loss: 33.999 Vali Acc: 0.460 Test Loss: 33.999 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 14074370
model size : 73.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.089727640151978
Epoch: 1, Steps: 18 | Train Loss: 3.036 Vali Loss: 8.695 Vali Acc: 0.500 Test Loss: 8.695 Test Acc: 0.500
Validation loss decreased (inf --> -0.499913).  Saving model ...
Epoch: 2 cost time: 21.904136657714844
Epoch: 2, Steps: 18 | Train Loss: 5.206 Vali Loss: 7.879 Vali Acc: 0.470 Test Loss: 7.879 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.82702112197876
Epoch: 3, Steps: 18 | Train Loss: 4.751 Vali Loss: 6.442 Vali Acc: 0.580 Test Loss: 6.442 Test Acc: 0.580
Validation loss decreased (-0.499913 --> -0.579936).  Saving model ...
Epoch: 4 cost time: 26.784048080444336
Epoch: 4, Steps: 18 | Train Loss: 1.834 Vali Loss: 6.625 Vali Acc: 0.490 Test Loss: 6.625 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.057703018188477
Epoch: 5, Steps: 18 | Train Loss: 2.548 Vali Loss: 13.146 Vali Acc: 0.510 Test Loss: 13.146 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.332196950912476
Epoch: 6, Steps: 18 | Train Loss: 2.795 Vali Loss: 11.427 Vali Acc: 0.570 Test Loss: 11.427 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 27.770021438598633
Epoch: 7, Steps: 18 | Train Loss: 2.679 Vali Loss: 10.901 Vali Acc: 0.530 Test Loss: 10.901 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 25.42897605895996
Epoch: 8, Steps: 18 | Train Loss: 2.218 Vali Loss: 18.975 Vali Acc: 0.450 Test Loss: 18.975 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.685433387756348
Epoch: 9, Steps: 18 | Train Loss: 2.102 Vali Loss: 16.157 Vali Acc: 0.510 Test Loss: 16.157 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 24.826034545898438
Epoch: 10, Steps: 18 | Train Loss: 2.053 Vali Loss: 19.247 Vali Acc: 0.540 Test Loss: 19.247 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 23.634591579437256
Epoch: 11, Steps: 18 | Train Loss: 2.310 Vali Loss: 24.022 Vali Acc: 0.530 Test Loss: 24.022 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 25.09197974205017
Epoch: 12, Steps: 18 | Train Loss: 1.110 Vali Loss: 27.988 Vali Acc: 0.480 Test Loss: 27.988 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 27.37717318534851
Epoch: 13, Steps: 18 | Train Loss: 1.130 Vali Loss: 16.870 Vali Acc: 0.570 Test Loss: 16.870 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 14074370
model size : 73.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.082332611083984
Epoch: 1, Steps: 18 | Train Loss: 2.942 Vali Loss: 4.052 Vali Acc: 0.490 Test Loss: 4.052 Test Acc: 0.490
Validation loss decreased (inf --> -0.489959).  Saving model ...
Epoch: 2 cost time: 21.404385089874268
Epoch: 2, Steps: 18 | Train Loss: 4.290 Vali Loss: 3.301 Vali Acc: 0.500 Test Loss: 3.301 Test Acc: 0.500
Validation loss decreased (-0.489959 --> -0.499967).  Saving model ...
Epoch: 3 cost time: 22.901708841323853
Epoch: 3, Steps: 18 | Train Loss: 2.429 Vali Loss: 6.366 Vali Acc: 0.490 Test Loss: 6.366 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.48537278175354
Epoch: 4, Steps: 18 | Train Loss: 3.983 Vali Loss: 10.929 Vali Acc: 0.530 Test Loss: 10.929 Test Acc: 0.530
Validation loss decreased (-0.499967 --> -0.529891).  Saving model ...
Epoch: 5 cost time: 18.276023864746094
Epoch: 5, Steps: 18 | Train Loss: 2.645 Vali Loss: 9.106 Vali Acc: 0.560 Test Loss: 9.106 Test Acc: 0.560
Validation loss decreased (-0.529891 --> -0.559909).  Saving model ...
Epoch: 6 cost time: 21.080478191375732
Epoch: 6, Steps: 18 | Train Loss: 2.560 Vali Loss: 9.017 Vali Acc: 0.570 Test Loss: 9.017 Test Acc: 0.570
Validation loss decreased (-0.559909 --> -0.569910).  Saving model ...
Epoch: 7 cost time: 17.935811042785645
Epoch: 7, Steps: 18 | Train Loss: 3.189 Vali Loss: 35.152 Vali Acc: 0.500 Test Loss: 35.152 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.90194821357727
Epoch: 8, Steps: 18 | Train Loss: 1.904 Vali Loss: 18.737 Vali Acc: 0.510 Test Loss: 18.737 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.82921314239502
Epoch: 9, Steps: 18 | Train Loss: 4.314 Vali Loss: 14.169 Vali Acc: 0.530 Test Loss: 14.169 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 21.761645555496216
Epoch: 10, Steps: 18 | Train Loss: 0.753 Vali Loss: 38.413 Vali Acc: 0.510 Test Loss: 38.413 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 25.08423900604248
Epoch: 11, Steps: 18 | Train Loss: 6.208 Vali Loss: 21.963 Vali Acc: 0.520 Test Loss: 21.963 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 20.60555648803711
Epoch: 12, Steps: 18 | Train Loss: 5.675 Vali Loss: 19.093 Vali Acc: 0.530 Test Loss: 19.093 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 21.156628131866455
Epoch: 13, Steps: 18 | Train Loss: 6.077 Vali Loss: 35.000 Vali Acc: 0.510 Test Loss: 35.000 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 25.823829650878906
Epoch: 14, Steps: 18 | Train Loss: 1.867 Vali Loss: 21.899 Vali Acc: 0.540 Test Loss: 21.899 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 22.73406434059143
Epoch: 15, Steps: 18 | Train Loss: 2.555 Vali Loss: 22.102 Vali Acc: 0.540 Test Loss: 22.102 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 23.87725520133972
Epoch: 16, Steps: 18 | Train Loss: 1.745 Vali Loss: 30.951 Vali Acc: 0.470 Test Loss: 30.951 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 14074370
model size : 73.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.90975260734558
Epoch: 1, Steps: 18 | Train Loss: 1.573 Vali Loss: 3.626 Vali Acc: 0.480 Test Loss: 3.626 Test Acc: 0.480
Validation loss decreased (inf --> -0.479964).  Saving model ...
Epoch: 2 cost time: 20.97916007041931
Epoch: 2, Steps: 18 | Train Loss: 1.684 Vali Loss: 7.989 Vali Acc: 0.540 Test Loss: 7.989 Test Acc: 0.540
Validation loss decreased (-0.479964 --> -0.539920).  Saving model ...
Epoch: 3 cost time: 19.773226737976074
Epoch: 3, Steps: 18 | Train Loss: 1.890 Vali Loss: 8.071 Vali Acc: 0.490 Test Loss: 8.071 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.70587658882141
Epoch: 4, Steps: 18 | Train Loss: 2.030 Vali Loss: 4.807 Vali Acc: 0.490 Test Loss: 4.807 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.97490692138672
Epoch: 5, Steps: 18 | Train Loss: 2.045 Vali Loss: 3.001 Vali Acc: 0.530 Test Loss: 3.001 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.6940016746521
Epoch: 6, Steps: 18 | Train Loss: 2.652 Vali Loss: 7.635 Vali Acc: 0.470 Test Loss: 7.635 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 20.438969612121582
Epoch: 7, Steps: 18 | Train Loss: 1.305 Vali Loss: 8.079 Vali Acc: 0.600 Test Loss: 8.079 Test Acc: 0.600
Validation loss decreased (-0.539920 --> -0.599919).  Saving model ...
Epoch: 8 cost time: 20.60863947868347
Epoch: 8, Steps: 18 | Train Loss: 2.452 Vali Loss: 7.448 Vali Acc: 0.510 Test Loss: 7.448 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.854875326156616
Epoch: 9, Steps: 18 | Train Loss: 3.343 Vali Loss: 17.665 Vali Acc: 0.520 Test Loss: 17.665 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.9876389503479
Epoch: 10, Steps: 18 | Train Loss: 2.586 Vali Loss: 17.046 Vali Acc: 0.500 Test Loss: 17.046 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 19.90059518814087
Epoch: 11, Steps: 18 | Train Loss: 1.507 Vali Loss: 26.215 Vali Acc: 0.440 Test Loss: 26.215 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 17.47609233856201
Epoch: 12, Steps: 18 | Train Loss: 1.780 Vali Loss: 18.550 Vali Acc: 0.510 Test Loss: 18.550 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 23.60429358482361
Epoch: 13, Steps: 18 | Train Loss: 2.369 Vali Loss: 12.262 Vali Acc: 0.610 Test Loss: 12.262 Test Acc: 0.610
Validation loss decreased (-0.599919 --> -0.609877).  Saving model ...
Epoch: 14 cost time: 18.86092519760132
Epoch: 14, Steps: 18 | Train Loss: 1.822 Vali Loss: 18.445 Vali Acc: 0.480 Test Loss: 18.445 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 22.002630949020386
Epoch: 15, Steps: 18 | Train Loss: 2.492 Vali Loss: 25.380 Vali Acc: 0.530 Test Loss: 25.380 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 20.370096921920776
Epoch: 16, Steps: 18 | Train Loss: 1.202 Vali Loss: 17.502 Vali Acc: 0.480 Test Loss: 17.502 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 18.066943645477295
Epoch: 17, Steps: 18 | Train Loss: 0.665 Vali Loss: 15.905 Vali Acc: 0.450 Test Loss: 15.905 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 22.451626539230347
Epoch: 18, Steps: 18 | Train Loss: 1.249 Vali Loss: 23.399 Vali Acc: 0.520 Test Loss: 23.399 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 19.395236253738403
Epoch: 19, Steps: 18 | Train Loss: 0.926 Vali Loss: 40.448 Vali Acc: 0.440 Test Loss: 40.448 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 24.579286575317383
Epoch: 20, Steps: 18 | Train Loss: 1.082 Vali Loss: 21.660 Vali Acc: 0.520 Test Loss: 21.660 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 20.78060293197632
Epoch: 21, Steps: 18 | Train Loss: 0.992 Vali Loss: 36.096 Vali Acc: 0.440 Test Loss: 36.096 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 19.04870057106018
Epoch: 22, Steps: 18 | Train Loss: 3.212 Vali Loss: 34.296 Vali Acc: 0.470 Test Loss: 34.296 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 21.10316252708435
Epoch: 23, Steps: 18 | Train Loss: 1.536 Vali Loss: 27.930 Vali Acc: 0.520 Test Loss: 27.930 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 14074370
model size : 73.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.64847993850708
Epoch: 1, Steps: 18 | Train Loss: 1.353 Vali Loss: 1.792 Vali Acc: 0.500 Test Loss: 1.792 Test Acc: 0.500
Validation loss decreased (inf --> -0.499982).  Saving model ...
Epoch: 2 cost time: 18.327301025390625
Epoch: 2, Steps: 18 | Train Loss: 1.299 Vali Loss: 2.930 Vali Acc: 0.500 Test Loss: 2.930 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.869836807250977
Epoch: 3, Steps: 18 | Train Loss: 1.601 Vali Loss: 6.002 Vali Acc: 0.500 Test Loss: 6.002 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.393073081970215
Epoch: 4, Steps: 18 | Train Loss: 2.443 Vali Loss: 13.804 Vali Acc: 0.500 Test Loss: 13.804 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 21.53933572769165
Epoch: 5, Steps: 18 | Train Loss: 3.441 Vali Loss: 2.061 Vali Acc: 0.550 Test Loss: 2.061 Test Acc: 0.550
Validation loss decreased (-0.499982 --> -0.549979).  Saving model ...
Epoch: 6 cost time: 20.397624492645264
Epoch: 6, Steps: 18 | Train Loss: 1.079 Vali Loss: 3.675 Vali Acc: 0.490 Test Loss: 3.675 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.591938495635986
Epoch: 7, Steps: 18 | Train Loss: 2.890 Vali Loss: 6.922 Vali Acc: 0.490 Test Loss: 6.922 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.978829860687256
Epoch: 8, Steps: 18 | Train Loss: 2.063 Vali Loss: 3.471 Vali Acc: 0.600 Test Loss: 3.471 Test Acc: 0.600
Validation loss decreased (-0.549979 --> -0.599965).  Saving model ...
Epoch: 9 cost time: 17.349595069885254
Epoch: 9, Steps: 18 | Train Loss: 7.038 Vali Loss: 26.969 Vali Acc: 0.500 Test Loss: 26.969 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 19.89764666557312
Epoch: 10, Steps: 18 | Train Loss: 13.471 Vali Loss: 43.208 Vali Acc: 0.500 Test Loss: 43.208 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 19.945363521575928
Epoch: 11, Steps: 18 | Train Loss: 7.695 Vali Loss: 20.719 Vali Acc: 0.500 Test Loss: 20.719 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.023024320602417
Epoch: 12, Steps: 18 | Train Loss: 5.322 Vali Loss: 5.643 Vali Acc: 0.610 Test Loss: 5.643 Test Acc: 0.610
Validation loss decreased (-0.599965 --> -0.609944).  Saving model ...
Epoch: 13 cost time: 19.43107795715332
Epoch: 13, Steps: 18 | Train Loss: 0.769 Vali Loss: 26.241 Vali Acc: 0.500 Test Loss: 26.241 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 18.712417602539062
Epoch: 14, Steps: 18 | Train Loss: 1.608 Vali Loss: 5.869 Vali Acc: 0.540 Test Loss: 5.869 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 17.763885498046875
Epoch: 15, Steps: 18 | Train Loss: 0.687 Vali Loss: 5.668 Vali Acc: 0.540 Test Loss: 5.668 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 20.44840955734253
Epoch: 16, Steps: 18 | Train Loss: 0.929 Vali Loss: 7.433 Vali Acc: 0.570 Test Loss: 7.433 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 21.366312980651855
Epoch: 17, Steps: 18 | Train Loss: 0.800 Vali Loss: 9.615 Vali Acc: 0.560 Test Loss: 9.615 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 18.828964710235596
Epoch: 18, Steps: 18 | Train Loss: 0.607 Vali Loss: 9.539 Vali Acc: 0.520 Test Loss: 9.539 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 21.01967477798462
Epoch: 19, Steps: 18 | Train Loss: 0.531 Vali Loss: 14.440 Vali Acc: 0.500 Test Loss: 14.440 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 16.474979877471924
Epoch: 20, Steps: 18 | Train Loss: 0.646 Vali Loss: 9.249 Vali Acc: 0.490 Test Loss: 9.249 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 20.915684700012207
Epoch: 21, Steps: 18 | Train Loss: 1.702 Vali Loss: 19.357 Vali Acc: 0.510 Test Loss: 19.357 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 18.824229955673218
Epoch: 22, Steps: 18 | Train Loss: 1.141 Vali Loss: 19.440 Vali Acc: 0.510 Test Loss: 19.440 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 14074370
model size : 73.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 46.97031211853027
Epoch: 1, Steps: 18 | Train Loss: 1.476 Vali Loss: 5.221 Vali Acc: 0.510 Test Loss: 5.221 Test Acc: 0.510
Validation loss decreased (inf --> -0.509948).  Saving model ...
Epoch: 2 cost time: 51.17840886116028
Epoch: 2, Steps: 18 | Train Loss: 1.696 Vali Loss: 4.440 Vali Acc: 0.460 Test Loss: 4.440 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 50.559268951416016
Epoch: 3, Steps: 18 | Train Loss: 1.905 Vali Loss: 2.620 Vali Acc: 0.540 Test Loss: 2.620 Test Acc: 0.540
Validation loss decreased (-0.509948 --> -0.539974).  Saving model ...
Epoch: 4 cost time: 49.0500922203064
Epoch: 4, Steps: 18 | Train Loss: 1.091 Vali Loss: 2.755 Vali Acc: 0.510 Test Loss: 2.755 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 53.107845067977905
Epoch: 5, Steps: 18 | Train Loss: 3.595 Vali Loss: 8.060 Vali Acc: 0.530 Test Loss: 8.060 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 47.62205719947815
Epoch: 6, Steps: 18 | Train Loss: 2.141 Vali Loss: 8.912 Vali Acc: 0.530 Test Loss: 8.912 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 53.465179681777954
Epoch: 7, Steps: 18 | Train Loss: 2.603 Vali Loss: 6.259 Vali Acc: 0.500 Test Loss: 6.259 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 41.79586100578308
Epoch: 8, Steps: 18 | Train Loss: 2.507 Vali Loss: 8.156 Vali Acc: 0.540 Test Loss: 8.156 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 57.22914505004883
Epoch: 9, Steps: 18 | Train Loss: 1.799 Vali Loss: 9.217 Vali Acc: 0.570 Test Loss: 9.217 Test Acc: 0.570
Validation loss decreased (-0.539974 --> -0.569908).  Saving model ...
Epoch: 10 cost time: 51.2164523601532
Epoch: 10, Steps: 18 | Train Loss: 2.411 Vali Loss: 12.882 Vali Acc: 0.450 Test Loss: 12.882 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 61.00726580619812
Epoch: 11, Steps: 18 | Train Loss: 2.129 Vali Loss: 14.846 Vali Acc: 0.500 Test Loss: 14.846 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 56.785457372665405
Epoch: 12, Steps: 18 | Train Loss: 2.510 Vali Loss: 15.635 Vali Acc: 0.520 Test Loss: 15.635 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 66.38153553009033
Epoch: 13, Steps: 18 | Train Loss: 2.291 Vali Loss: 14.602 Vali Acc: 0.540 Test Loss: 14.602 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 62.75912880897522
Epoch: 14, Steps: 18 | Train Loss: 0.611 Vali Loss: 22.967 Vali Acc: 0.530 Test Loss: 22.967 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 64.88743925094604
Epoch: 15, Steps: 18 | Train Loss: 5.103 Vali Loss: 34.495 Vali Acc: 0.550 Test Loss: 34.495 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 62.50029015541077
Epoch: 16, Steps: 18 | Train Loss: 3.698 Vali Loss: 16.736 Vali Acc: 0.520 Test Loss: 16.736 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 67.88001036643982
Epoch: 17, Steps: 18 | Train Loss: 1.220 Vali Loss: 41.483 Vali Acc: 0.520 Test Loss: 41.483 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 62.98612952232361
Epoch: 18, Steps: 18 | Train Loss: 1.495 Vali Loss: 31.499 Vali Acc: 0.490 Test Loss: 31.499 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 64.94905948638916
Epoch: 19, Steps: 18 | Train Loss: 2.571 Vali Loss: 21.240 Vali Acc: 0.490 Test Loss: 21.240 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 7364866
model size : 37.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 42.05944347381592
Epoch: 1, Steps: 18 | Train Loss: 1.608 Vali Loss: 4.142 Vali Acc: 0.500 Test Loss: 4.142 Test Acc: 0.500
Validation loss decreased (inf --> -0.499959).  Saving model ...
Epoch: 2 cost time: 42.59779906272888
Epoch: 2, Steps: 18 | Train Loss: 1.511 Vali Loss: 2.825 Vali Acc: 0.500 Test Loss: 2.825 Test Acc: 0.500
Validation loss decreased (-0.499959 --> -0.499972).  Saving model ...
Epoch: 3 cost time: 39.75117301940918
Epoch: 3, Steps: 18 | Train Loss: 1.898 Vali Loss: 4.032 Vali Acc: 0.500 Test Loss: 4.032 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 43.5749409198761
Epoch: 4, Steps: 18 | Train Loss: 2.010 Vali Loss: 4.824 Vali Acc: 0.490 Test Loss: 4.824 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 41.07366895675659
Epoch: 5, Steps: 18 | Train Loss: 1.928 Vali Loss: 9.557 Vali Acc: 0.470 Test Loss: 9.557 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 41.77854800224304
Epoch: 6, Steps: 18 | Train Loss: 6.543 Vali Loss: 14.994 Vali Acc: 0.500 Test Loss: 14.994 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 45.308021783828735
Epoch: 7, Steps: 18 | Train Loss: 3.049 Vali Loss: 20.042 Vali Acc: 0.520 Test Loss: 20.042 Test Acc: 0.520
Validation loss decreased (-0.499972 --> -0.519800).  Saving model ...
Epoch: 8 cost time: 41.92791533470154
Epoch: 8, Steps: 18 | Train Loss: 1.293 Vali Loss: 6.531 Vali Acc: 0.470 Test Loss: 6.531 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 45.13132619857788
Epoch: 9, Steps: 18 | Train Loss: 1.573 Vali Loss: 8.108 Vali Acc: 0.520 Test Loss: 8.108 Test Acc: 0.520
Validation loss decreased (-0.519800 --> -0.519919).  Saving model ...
Epoch: 10 cost time: 50.513774394989014
Epoch: 10, Steps: 18 | Train Loss: 3.540 Vali Loss: 12.193 Vali Acc: 0.520 Test Loss: 12.193 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 45.33277225494385
Epoch: 11, Steps: 18 | Train Loss: 3.279 Vali Loss: 33.903 Vali Acc: 0.500 Test Loss: 33.903 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 53.970335721969604
Epoch: 12, Steps: 18 | Train Loss: 6.940 Vali Loss: 30.282 Vali Acc: 0.520 Test Loss: 30.282 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 47.57022023200989
Epoch: 13, Steps: 18 | Train Loss: 9.211 Vali Loss: 21.187 Vali Acc: 0.540 Test Loss: 21.187 Test Acc: 0.540
Validation loss decreased (-0.519919 --> -0.539788).  Saving model ...
Epoch: 14 cost time: 56.803171157836914
Epoch: 14, Steps: 18 | Train Loss: 1.692 Vali Loss: 15.241 Vali Acc: 0.500 Test Loss: 15.241 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 53.818042278289795
Epoch: 15, Steps: 18 | Train Loss: 1.611 Vali Loss: 17.947 Vali Acc: 0.530 Test Loss: 17.947 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 57.0593364238739
Epoch: 16, Steps: 18 | Train Loss: 1.320 Vali Loss: 17.689 Vali Acc: 0.520 Test Loss: 17.689 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 54.383967876434326
Epoch: 17, Steps: 18 | Train Loss: 0.408 Vali Loss: 16.707 Vali Acc: 0.480 Test Loss: 16.707 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 54.715410232543945
Epoch: 18, Steps: 18 | Train Loss: 2.477 Vali Loss: 40.526 Vali Acc: 0.520 Test Loss: 40.526 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 54.04917311668396
Epoch: 19, Steps: 18 | Train Loss: 1.336 Vali Loss: 40.894 Vali Acc: 0.540 Test Loss: 40.894 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 55.57713794708252
Epoch: 20, Steps: 18 | Train Loss: 3.267 Vali Loss: 42.162 Vali Acc: 0.550 Test Loss: 42.162 Test Acc: 0.550
Validation loss decreased (-0.539788 --> -0.549578).  Saving model ...
Epoch: 21 cost time: 53.31363892555237
Epoch: 21, Steps: 18 | Train Loss: 2.650 Vali Loss: 27.542 Vali Acc: 0.530 Test Loss: 27.542 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 55.63702964782715
Epoch: 22, Steps: 18 | Train Loss: 1.651 Vali Loss: 68.903 Vali Acc: 0.520 Test Loss: 68.903 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 49.85081148147583
Epoch: 23, Steps: 18 | Train Loss: 5.928 Vali Loss: 27.186 Vali Acc: 0.570 Test Loss: 27.186 Test Acc: 0.570
Validation loss decreased (-0.549578 --> -0.569728).  Saving model ...
Epoch: 24 cost time: 48.52307677268982
Epoch: 24, Steps: 18 | Train Loss: 2.605 Vali Loss: 32.864 Vali Acc: 0.490 Test Loss: 32.864 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 42.48529577255249
Epoch: 25, Steps: 18 | Train Loss: 2.097 Vali Loss: 27.043 Vali Acc: 0.500 Test Loss: 27.043 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 57.46302008628845
Epoch: 26, Steps: 18 | Train Loss: 1.149 Vali Loss: 28.542 Vali Acc: 0.480 Test Loss: 28.542 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 54.256983041763306
Epoch: 27, Steps: 18 | Train Loss: 3.161 Vali Loss: 36.048 Vali Acc: 0.460 Test Loss: 36.048 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 53.77150082588196
Epoch: 28, Steps: 18 | Train Loss: 1.576 Vali Loss: 37.382 Vali Acc: 0.490 Test Loss: 37.382 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 58.18590188026428
Epoch: 29, Steps: 18 | Train Loss: 1.127 Vali Loss: 31.337 Vali Acc: 0.540 Test Loss: 31.337 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 55.63137078285217
Epoch: 30, Steps: 18 | Train Loss: 1.208 Vali Loss: 44.214 Vali Acc: 0.490 Test Loss: 44.214 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 57.38863277435303
Epoch: 31, Steps: 18 | Train Loss: 0.804 Vali Loss: 31.866 Vali Acc: 0.560 Test Loss: 31.866 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 54.621809005737305
Epoch: 32, Steps: 18 | Train Loss: 3.288 Vali Loss: 34.112 Vali Acc: 0.510 Test Loss: 34.112 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 56.65326690673828
Epoch: 33, Steps: 18 | Train Loss: 2.528 Vali Loss: 61.458 Vali Acc: 0.540 Test Loss: 61.458 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 7364866
model size : 37.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 35.00330686569214
Epoch: 1, Steps: 18 | Train Loss: 1.447 Vali Loss: 5.358 Vali Acc: 0.500 Test Loss: 5.358 Test Acc: 0.500
Validation loss decreased (inf --> -0.499946).  Saving model ...
Epoch: 2 cost time: 34.54870533943176
Epoch: 2, Steps: 18 | Train Loss: 1.764 Vali Loss: 4.824 Vali Acc: 0.520 Test Loss: 4.824 Test Acc: 0.520
Validation loss decreased (-0.499946 --> -0.519952).  Saving model ...
Epoch: 3 cost time: 32.64945435523987
Epoch: 3, Steps: 18 | Train Loss: 2.918 Vali Loss: 7.479 Vali Acc: 0.510 Test Loss: 7.479 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 30.96661114692688
Epoch: 4, Steps: 18 | Train Loss: 2.575 Vali Loss: 5.094 Vali Acc: 0.520 Test Loss: 5.094 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 34.6827917098999
Epoch: 5, Steps: 18 | Train Loss: 1.493 Vali Loss: 9.321 Vali Acc: 0.460 Test Loss: 9.321 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 34.93568277359009
Epoch: 6, Steps: 18 | Train Loss: 2.403 Vali Loss: 14.098 Vali Acc: 0.500 Test Loss: 14.098 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 32.613213300704956
Epoch: 7, Steps: 18 | Train Loss: 2.664 Vali Loss: 6.460 Vali Acc: 0.530 Test Loss: 6.460 Test Acc: 0.530
Validation loss decreased (-0.519952 --> -0.529935).  Saving model ...
Epoch: 8 cost time: 37.26015853881836
Epoch: 8, Steps: 18 | Train Loss: 1.823 Vali Loss: 10.903 Vali Acc: 0.480 Test Loss: 10.903 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 39.10097575187683
Epoch: 9, Steps: 18 | Train Loss: 2.415 Vali Loss: 9.403 Vali Acc: 0.570 Test Loss: 9.403 Test Acc: 0.570
Validation loss decreased (-0.529935 --> -0.569906).  Saving model ...
Epoch: 10 cost time: 37.228187799453735
Epoch: 10, Steps: 18 | Train Loss: 2.088 Vali Loss: 11.315 Vali Acc: 0.520 Test Loss: 11.315 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 42.46200919151306
Epoch: 11, Steps: 18 | Train Loss: 1.987 Vali Loss: 10.034 Vali Acc: 0.570 Test Loss: 10.034 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 44.245529890060425
Epoch: 12, Steps: 18 | Train Loss: 2.980 Vali Loss: 14.270 Vali Acc: 0.560 Test Loss: 14.270 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 40.9292528629303
Epoch: 13, Steps: 18 | Train Loss: 2.405 Vali Loss: 27.537 Vali Acc: 0.560 Test Loss: 27.537 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 45.315170764923096
Epoch: 14, Steps: 18 | Train Loss: 4.945 Vali Loss: 27.064 Vali Acc: 0.520 Test Loss: 27.064 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 44.51874136924744
Epoch: 15, Steps: 18 | Train Loss: 3.074 Vali Loss: 47.902 Vali Acc: 0.510 Test Loss: 47.902 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 41.3465051651001
Epoch: 16, Steps: 18 | Train Loss: 2.437 Vali Loss: 20.964 Vali Acc: 0.520 Test Loss: 20.964 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 45.76934790611267
Epoch: 17, Steps: 18 | Train Loss: 1.891 Vali Loss: 25.980 Vali Acc: 0.580 Test Loss: 25.980 Test Acc: 0.580
Validation loss decreased (-0.569906 --> -0.579740).  Saving model ...
Epoch: 18 cost time: 44.18107604980469
Epoch: 18, Steps: 18 | Train Loss: 1.354 Vali Loss: 26.791 Vali Acc: 0.480 Test Loss: 26.791 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 43.69737267494202
Epoch: 19, Steps: 18 | Train Loss: 0.603 Vali Loss: 21.370 Vali Acc: 0.550 Test Loss: 21.370 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 45.523391008377075
Epoch: 20, Steps: 18 | Train Loss: 2.583 Vali Loss: 34.212 Vali Acc: 0.510 Test Loss: 34.212 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 35.52787709236145
Epoch: 21, Steps: 18 | Train Loss: 3.992 Vali Loss: 41.521 Vali Acc: 0.540 Test Loss: 41.521 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 44.544734716415405
Epoch: 22, Steps: 18 | Train Loss: 3.363 Vali Loss: 47.975 Vali Acc: 0.530 Test Loss: 47.975 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 44.56730818748474
Epoch: 23, Steps: 18 | Train Loss: 1.687 Vali Loss: 41.126 Vali Acc: 0.500 Test Loss: 41.126 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 39.04391360282898
Epoch: 24, Steps: 18 | Train Loss: 3.431 Vali Loss: 49.245 Vali Acc: 0.470 Test Loss: 49.245 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 44.549498558044434
Epoch: 25, Steps: 18 | Train Loss: 2.954 Vali Loss: 30.191 Vali Acc: 0.590 Test Loss: 30.191 Test Acc: 0.590
Validation loss decreased (-0.579740 --> -0.589698).  Saving model ...
Epoch: 26 cost time: 45.78498387336731
Epoch: 26, Steps: 18 | Train Loss: 0.843 Vali Loss: 32.682 Vali Acc: 0.580 Test Loss: 32.682 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 41.65472197532654
Epoch: 27, Steps: 18 | Train Loss: 1.317 Vali Loss: 28.226 Vali Acc: 0.650 Test Loss: 28.226 Test Acc: 0.650
Validation loss decreased (-0.589698 --> -0.649718).  Saving model ...
Epoch: 28 cost time: 46.76066732406616
Epoch: 28, Steps: 18 | Train Loss: 0.323 Vali Loss: 31.742 Vali Acc: 0.600 Test Loss: 31.742 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 43.45475673675537
Epoch: 29, Steps: 18 | Train Loss: 0.660 Vali Loss: 33.700 Vali Acc: 0.570 Test Loss: 33.700 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 42.17136073112488
Epoch: 30, Steps: 18 | Train Loss: 5.149 Vali Loss: 52.269 Vali Acc: 0.510 Test Loss: 52.269 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 45.823548316955566
Epoch: 31, Steps: 18 | Train Loss: 4.381 Vali Loss: 54.302 Vali Acc: 0.510 Test Loss: 54.302 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 41.09630537033081
Epoch: 32, Steps: 18 | Train Loss: 5.447 Vali Loss: 65.409 Vali Acc: 0.540 Test Loss: 65.409 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 45.15559124946594
Epoch: 33, Steps: 18 | Train Loss: 4.940 Vali Loss: 45.451 Vali Acc: 0.600 Test Loss: 45.451 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 45.574889183044434
Epoch: 34, Steps: 18 | Train Loss: 2.085 Vali Loss: 54.672 Vali Acc: 0.530 Test Loss: 54.672 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 40.84274077415466
Epoch: 35, Steps: 18 | Train Loss: 3.452 Vali Loss: 47.115 Vali Acc: 0.490 Test Loss: 47.115 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 45.251524209976196
Epoch: 36, Steps: 18 | Train Loss: 0.806 Vali Loss: 48.710 Vali Acc: 0.510 Test Loss: 48.710 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 42.27470517158508
Epoch: 37, Steps: 18 | Train Loss: 1.247 Vali Loss: 86.337 Vali Acc: 0.500 Test Loss: 86.337 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 7364866
model size : 37.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 29.794549226760864
Epoch: 1, Steps: 18 | Train Loss: 1.337 Vali Loss: 2.103 Vali Acc: 0.510 Test Loss: 2.103 Test Acc: 0.510
Validation loss decreased (inf --> -0.509979).  Saving model ...
Epoch: 2 cost time: 28.94471573829651
Epoch: 2, Steps: 18 | Train Loss: 2.133 Vali Loss: 4.839 Vali Acc: 0.530 Test Loss: 4.839 Test Acc: 0.530
Validation loss decreased (-0.509979 --> -0.529952).  Saving model ...
Epoch: 3 cost time: 27.024086236953735
Epoch: 3, Steps: 18 | Train Loss: 1.616 Vali Loss: 3.038 Vali Acc: 0.490 Test Loss: 3.038 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.664185047149658
Epoch: 4, Steps: 18 | Train Loss: 2.956 Vali Loss: 6.201 Vali Acc: 0.510 Test Loss: 6.201 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 28.33846950531006
Epoch: 5, Steps: 18 | Train Loss: 4.430 Vali Loss: 22.455 Vali Acc: 0.490 Test Loss: 22.455 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 30.93417477607727
Epoch: 6, Steps: 18 | Train Loss: 6.423 Vali Loss: 4.691 Vali Acc: 0.570 Test Loss: 4.691 Test Acc: 0.570
Validation loss decreased (-0.529952 --> -0.569953).  Saving model ...
Epoch: 7 cost time: 29.731907844543457
Epoch: 7, Steps: 18 | Train Loss: 2.210 Vali Loss: 6.862 Vali Acc: 0.520 Test Loss: 6.862 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.460559606552124
Epoch: 8, Steps: 18 | Train Loss: 3.206 Vali Loss: 14.269 Vali Acc: 0.510 Test Loss: 14.269 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 29.010921001434326
Epoch: 9, Steps: 18 | Train Loss: 2.541 Vali Loss: 9.264 Vali Acc: 0.540 Test Loss: 9.264 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 31.7782564163208
Epoch: 10, Steps: 18 | Train Loss: 3.366 Vali Loss: 9.955 Vali Acc: 0.530 Test Loss: 9.955 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 32.52923655509949
Epoch: 11, Steps: 18 | Train Loss: 1.458 Vali Loss: 10.784 Vali Acc: 0.550 Test Loss: 10.784 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 29.82359027862549
Epoch: 12, Steps: 18 | Train Loss: 1.411 Vali Loss: 11.105 Vali Acc: 0.550 Test Loss: 11.105 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 34.88761568069458
Epoch: 13, Steps: 18 | Train Loss: 1.894 Vali Loss: 51.466 Vali Acc: 0.500 Test Loss: 51.466 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 35.098268032073975
Epoch: 14, Steps: 18 | Train Loss: 6.220 Vali Loss: 30.100 Vali Acc: 0.530 Test Loss: 30.100 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 31.079679489135742
Epoch: 15, Steps: 18 | Train Loss: 2.512 Vali Loss: 48.721 Vali Acc: 0.510 Test Loss: 48.721 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 33.69148778915405
Epoch: 16, Steps: 18 | Train Loss: 2.468 Vali Loss: 18.239 Vali Acc: 0.540 Test Loss: 18.239 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 7364866
model size : 37.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.793497562408447
Epoch: 1, Steps: 18 | Train Loss: 1.248 Vali Loss: 3.904 Vali Acc: 0.490 Test Loss: 3.904 Test Acc: 0.490
Validation loss decreased (inf --> -0.489961).  Saving model ...
Epoch: 2 cost time: 19.149173974990845
Epoch: 2, Steps: 18 | Train Loss: 1.473 Vali Loss: 5.810 Vali Acc: 0.510 Test Loss: 5.810 Test Acc: 0.510
Validation loss decreased (-0.489961 --> -0.509942).  Saving model ...
Epoch: 3 cost time: 18.085840225219727
Epoch: 3, Steps: 18 | Train Loss: 2.415 Vali Loss: 2.837 Vali Acc: 0.550 Test Loss: 2.837 Test Acc: 0.550
Validation loss decreased (-0.509942 --> -0.549972).  Saving model ...
Epoch: 4 cost time: 23.512096881866455
Epoch: 4, Steps: 18 | Train Loss: 1.772 Vali Loss: 2.796 Vali Acc: 0.510 Test Loss: 2.796 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.27390432357788
Epoch: 5, Steps: 18 | Train Loss: 1.447 Vali Loss: 4.917 Vali Acc: 0.570 Test Loss: 4.917 Test Acc: 0.570
Validation loss decreased (-0.549972 --> -0.569951).  Saving model ...
Epoch: 6 cost time: 22.720949172973633
Epoch: 6, Steps: 18 | Train Loss: 2.157 Vali Loss: 8.398 Vali Acc: 0.530 Test Loss: 8.398 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.590890645980835
Epoch: 7, Steps: 18 | Train Loss: 2.000 Vali Loss: 5.268 Vali Acc: 0.560 Test Loss: 5.268 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 18.54562282562256
Epoch: 8, Steps: 18 | Train Loss: 0.967 Vali Loss: 7.806 Vali Acc: 0.500 Test Loss: 7.806 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.17479109764099
Epoch: 9, Steps: 18 | Train Loss: 1.438 Vali Loss: 11.205 Vali Acc: 0.540 Test Loss: 11.205 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 20.55931258201599
Epoch: 10, Steps: 18 | Train Loss: 2.088 Vali Loss: 11.093 Vali Acc: 0.480 Test Loss: 11.093 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 22.494139194488525
Epoch: 11, Steps: 18 | Train Loss: 1.814 Vali Loss: 13.457 Vali Acc: 0.530 Test Loss: 13.457 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 23.20889115333557
Epoch: 12, Steps: 18 | Train Loss: 0.543 Vali Loss: 11.720 Vali Acc: 0.460 Test Loss: 11.720 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 19.426587343215942
Epoch: 13, Steps: 18 | Train Loss: 3.248 Vali Loss: 13.754 Vali Acc: 0.510 Test Loss: 13.754 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 20.89118528366089
Epoch: 14, Steps: 18 | Train Loss: 1.855 Vali Loss: 15.555 Vali Acc: 0.490 Test Loss: 15.555 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 18.28313446044922
Epoch: 15, Steps: 18 | Train Loss: 1.332 Vali Loss: 17.530 Vali Acc: 0.510 Test Loss: 17.530 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 7364866
model size : 37.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.749885320663452
Epoch: 1, Steps: 18 | Train Loss: 1.175 Vali Loss: 2.631 Vali Acc: 0.500 Test Loss: 2.631 Test Acc: 0.500
Validation loss decreased (inf --> -0.499974).  Saving model ...
Epoch: 2 cost time: 18.4279146194458
Epoch: 2, Steps: 18 | Train Loss: 1.579 Vali Loss: 3.636 Vali Acc: 0.510 Test Loss: 3.636 Test Acc: 0.510
Validation loss decreased (-0.499974 --> -0.509964).  Saving model ...
Epoch: 3 cost time: 14.657712459564209
Epoch: 3, Steps: 18 | Train Loss: 1.490 Vali Loss: 2.437 Vali Acc: 0.520 Test Loss: 2.437 Test Acc: 0.520
Validation loss decreased (-0.509964 --> -0.519976).  Saving model ...
Epoch: 4 cost time: 16.473806858062744
Epoch: 4, Steps: 18 | Train Loss: 1.957 Vali Loss: 9.609 Vali Acc: 0.510 Test Loss: 9.609 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.9824378490448
Epoch: 5, Steps: 18 | Train Loss: 1.804 Vali Loss: 5.859 Vali Acc: 0.450 Test Loss: 5.859 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 18.995072603225708
Epoch: 6, Steps: 18 | Train Loss: 1.516 Vali Loss: 6.202 Vali Acc: 0.520 Test Loss: 6.202 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.844854593276978
Epoch: 7, Steps: 18 | Train Loss: 0.938 Vali Loss: 5.950 Vali Acc: 0.470 Test Loss: 5.950 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 19.684449434280396
Epoch: 8, Steps: 18 | Train Loss: 2.436 Vali Loss: 10.301 Vali Acc: 0.540 Test Loss: 10.301 Test Acc: 0.540
Validation loss decreased (-0.519976 --> -0.539897).  Saving model ...
Epoch: 9 cost time: 15.864542722702026
Epoch: 9, Steps: 18 | Train Loss: 2.345 Vali Loss: 10.191 Vali Acc: 0.490 Test Loss: 10.191 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 17.211211442947388
Epoch: 10, Steps: 18 | Train Loss: 3.056 Vali Loss: 11.906 Vali Acc: 0.460 Test Loss: 11.906 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 15.875717878341675
Epoch: 11, Steps: 18 | Train Loss: 1.878 Vali Loss: 21.175 Vali Acc: 0.480 Test Loss: 21.175 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 19.53444528579712
Epoch: 12, Steps: 18 | Train Loss: 1.227 Vali Loss: 12.828 Vali Acc: 0.530 Test Loss: 12.828 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 17.33751344680786
Epoch: 13, Steps: 18 | Train Loss: 1.692 Vali Loss: 39.970 Vali Acc: 0.500 Test Loss: 39.970 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 19.24151301383972
Epoch: 14, Steps: 18 | Train Loss: 5.514 Vali Loss: 23.733 Vali Acc: 0.520 Test Loss: 23.733 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 18.611755847930908
Epoch: 15, Steps: 18 | Train Loss: 6.691 Vali Loss: 36.223 Vali Acc: 0.490 Test Loss: 36.223 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 16.9715416431427
Epoch: 16, Steps: 18 | Train Loss: 1.203 Vali Loss: 16.189 Vali Acc: 0.580 Test Loss: 16.189 Test Acc: 0.580
Validation loss decreased (-0.539897 --> -0.579838).  Saving model ...
Epoch: 17 cost time: 17.785625219345093
Epoch: 17, Steps: 18 | Train Loss: 1.629 Vali Loss: 29.436 Vali Acc: 0.520 Test Loss: 29.436 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 19.12113094329834
Epoch: 18, Steps: 18 | Train Loss: 1.241 Vali Loss: 21.288 Vali Acc: 0.470 Test Loss: 21.288 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 20.06615424156189
Epoch: 19, Steps: 18 | Train Loss: 0.784 Vali Loss: 15.809 Vali Acc: 0.490 Test Loss: 15.809 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 18.863719940185547
Epoch: 20, Steps: 18 | Train Loss: 2.275 Vali Loss: 23.468 Vali Acc: 0.520 Test Loss: 23.468 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 20.19601535797119
Epoch: 21, Steps: 18 | Train Loss: 1.492 Vali Loss: 35.825 Vali Acc: 0.490 Test Loss: 35.825 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 16.297348737716675
Epoch: 22, Steps: 18 | Train Loss: 1.257 Vali Loss: 34.888 Vali Acc: 0.530 Test Loss: 34.888 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 18.921630144119263
Epoch: 23, Steps: 18 | Train Loss: 1.386 Vali Loss: 21.943 Vali Acc: 0.510 Test Loss: 21.943 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 19.721521854400635
Epoch: 24, Steps: 18 | Train Loss: 1.535 Vali Loss: 38.901 Vali Acc: 0.440 Test Loss: 38.901 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 19.484344005584717
Epoch: 25, Steps: 18 | Train Loss: 1.266 Vali Loss: 27.658 Vali Acc: 0.490 Test Loss: 27.658 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 20.430984020233154
Epoch: 26, Steps: 18 | Train Loss: 0.481 Vali Loss: 32.701 Vali Acc: 0.460 Test Loss: 32.701 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 7364866
model size : 37.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.49394702911377
Epoch: 1, Steps: 18 | Train Loss: 1.026 Vali Loss: 3.556 Vali Acc: 0.510 Test Loss: 3.556 Test Acc: 0.510
Validation loss decreased (inf --> -0.509964).  Saving model ...
Epoch: 2 cost time: 15.90073823928833
Epoch: 2, Steps: 18 | Train Loss: 1.275 Vali Loss: 1.728 Vali Acc: 0.550 Test Loss: 1.728 Test Acc: 0.550
Validation loss decreased (-0.509964 --> -0.549983).  Saving model ...
Epoch: 3 cost time: 15.85548710823059
Epoch: 3, Steps: 18 | Train Loss: 1.070 Vali Loss: 2.751 Vali Acc: 0.550 Test Loss: 2.751 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.45739483833313
Epoch: 4, Steps: 18 | Train Loss: 2.152 Vali Loss: 8.066 Vali Acc: 0.470 Test Loss: 8.066 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.72298765182495
Epoch: 5, Steps: 18 | Train Loss: 1.195 Vali Loss: 6.402 Vali Acc: 0.480 Test Loss: 6.402 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.209589958190918
Epoch: 6, Steps: 18 | Train Loss: 2.215 Vali Loss: 6.886 Vali Acc: 0.480 Test Loss: 6.886 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.059834003448486
Epoch: 7, Steps: 18 | Train Loss: 1.495 Vali Loss: 7.674 Vali Acc: 0.530 Test Loss: 7.674 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.425937414169312
Epoch: 8, Steps: 18 | Train Loss: 2.096 Vali Loss: 14.839 Vali Acc: 0.500 Test Loss: 14.839 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 18.00464677810669
Epoch: 9, Steps: 18 | Train Loss: 1.902 Vali Loss: 19.800 Vali Acc: 0.460 Test Loss: 19.800 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 14.92141079902649
Epoch: 10, Steps: 18 | Train Loss: 1.853 Vali Loss: 14.190 Vali Acc: 0.500 Test Loss: 14.190 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 18.205798387527466
Epoch: 11, Steps: 18 | Train Loss: 2.196 Vali Loss: 12.835 Vali Acc: 0.460 Test Loss: 12.835 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 15.430707693099976
Epoch: 12, Steps: 18 | Train Loss: 1.612 Vali Loss: 13.234 Vali Acc: 0.540 Test Loss: 13.234 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 7364866
model size : 37.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.192156791687012
Epoch: 1, Steps: 18 | Train Loss: 1.149 Vali Loss: 3.772 Vali Acc: 0.500 Test Loss: 3.772 Test Acc: 0.500
Validation loss decreased (inf --> -0.499962).  Saving model ...
Epoch: 2 cost time: 15.06653380393982
Epoch: 2, Steps: 18 | Train Loss: 1.669 Vali Loss: 3.363 Vali Acc: 0.510 Test Loss: 3.363 Test Acc: 0.510
Validation loss decreased (-0.499962 --> -0.509966).  Saving model ...
Epoch: 3 cost time: 13.7883882522583
Epoch: 3, Steps: 18 | Train Loss: 1.009 Vali Loss: 10.059 Vali Acc: 0.500 Test Loss: 10.059 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.793957471847534
Epoch: 4, Steps: 18 | Train Loss: 3.363 Vali Loss: 6.542 Vali Acc: 0.460 Test Loss: 6.542 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.277680397033691
Epoch: 5, Steps: 18 | Train Loss: 1.713 Vali Loss: 4.175 Vali Acc: 0.550 Test Loss: 4.175 Test Acc: 0.550
Validation loss decreased (-0.509966 --> -0.549958).  Saving model ...
Epoch: 6 cost time: 15.107028007507324
Epoch: 6, Steps: 18 | Train Loss: 1.330 Vali Loss: 4.586 Vali Acc: 0.560 Test Loss: 4.586 Test Acc: 0.560
Validation loss decreased (-0.549958 --> -0.559954).  Saving model ...
Epoch: 7 cost time: 15.452625751495361
Epoch: 7, Steps: 18 | Train Loss: 2.046 Vali Loss: 6.189 Vali Acc: 0.580 Test Loss: 6.189 Test Acc: 0.580
Validation loss decreased (-0.559954 --> -0.579938).  Saving model ...
Epoch: 8 cost time: 12.142261266708374
Epoch: 8, Steps: 18 | Train Loss: 1.035 Vali Loss: 6.738 Vali Acc: 0.550 Test Loss: 6.738 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.603509426116943
Epoch: 9, Steps: 18 | Train Loss: 1.191 Vali Loss: 8.454 Vali Acc: 0.530 Test Loss: 8.454 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.09555435180664
Epoch: 10, Steps: 18 | Train Loss: 0.986 Vali Loss: 6.603 Vali Acc: 0.590 Test Loss: 6.603 Test Acc: 0.590
Validation loss decreased (-0.579938 --> -0.589934).  Saving model ...
Epoch: 11 cost time: 16.321991682052612
Epoch: 11, Steps: 18 | Train Loss: 2.094 Vali Loss: 24.076 Vali Acc: 0.500 Test Loss: 24.076 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.995373249053955
Epoch: 12, Steps: 18 | Train Loss: 2.463 Vali Loss: 30.247 Vali Acc: 0.510 Test Loss: 30.247 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.979581117630005
Epoch: 13, Steps: 18 | Train Loss: 1.695 Vali Loss: 22.183 Vali Acc: 0.530 Test Loss: 22.183 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 16.549658060073853
Epoch: 14, Steps: 18 | Train Loss: 3.474 Vali Loss: 25.573 Vali Acc: 0.510 Test Loss: 25.573 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 14.086867332458496
Epoch: 15, Steps: 18 | Train Loss: 4.820 Vali Loss: 25.021 Vali Acc: 0.520 Test Loss: 25.021 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 15.647501945495605
Epoch: 16, Steps: 18 | Train Loss: 1.646 Vali Loss: 13.608 Vali Acc: 0.530 Test Loss: 13.608 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 13.248651027679443
Epoch: 17, Steps: 18 | Train Loss: 1.288 Vali Loss: 17.291 Vali Acc: 0.490 Test Loss: 17.291 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 15.765212297439575
Epoch: 18, Steps: 18 | Train Loss: 2.980 Vali Loss: 55.999 Vali Acc: 0.500 Test Loss: 55.999 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 15.89155912399292
Epoch: 19, Steps: 18 | Train Loss: 3.424 Vali Loss: 28.784 Vali Acc: 0.470 Test Loss: 28.784 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 15.475093603134155
Epoch: 20, Steps: 18 | Train Loss: 1.302 Vali Loss: 20.825 Vali Acc: 0.520 Test Loss: 20.825 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 7364866
model size : 37.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.84163212776184
Epoch: 1, Steps: 18 | Train Loss: 1.257 Vali Loss: 1.388 Vali Acc: 0.540 Test Loss: 1.388 Test Acc: 0.540
Validation loss decreased (inf --> -0.539986).  Saving model ...
Epoch: 2 cost time: 12.835415601730347
Epoch: 2, Steps: 18 | Train Loss: 0.846 Vali Loss: 1.208 Vali Acc: 0.490 Test Loss: 1.208 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.904591798782349
Epoch: 3, Steps: 18 | Train Loss: 0.679 Vali Loss: 3.934 Vali Acc: 0.500 Test Loss: 3.934 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.62170696258545
Epoch: 4, Steps: 18 | Train Loss: 1.152 Vali Loss: 3.613 Vali Acc: 0.460 Test Loss: 3.613 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.285406112670898
Epoch: 5, Steps: 18 | Train Loss: 1.578 Vali Loss: 7.927 Vali Acc: 0.490 Test Loss: 7.927 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 15.94224500656128
Epoch: 6, Steps: 18 | Train Loss: 1.362 Vali Loss: 14.469 Vali Acc: 0.500 Test Loss: 14.469 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.961251735687256
Epoch: 7, Steps: 18 | Train Loss: 4.864 Vali Loss: 8.359 Vali Acc: 0.520 Test Loss: 8.359 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 16.08140993118286
Epoch: 8, Steps: 18 | Train Loss: 3.380 Vali Loss: 7.392 Vali Acc: 0.490 Test Loss: 7.392 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 13.05998182296753
Epoch: 9, Steps: 18 | Train Loss: 2.135 Vali Loss: 5.986 Vali Acc: 0.430 Test Loss: 5.986 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.274239301681519
Epoch: 10, Steps: 18 | Train Loss: 0.989 Vali Loss: 7.650 Vali Acc: 0.520 Test Loss: 7.650 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 15.277373552322388
Epoch: 11, Steps: 18 | Train Loss: 2.530 Vali Loss: 20.698 Vali Acc: 0.510 Test Loss: 20.698 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 7364866
model size : 37.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.601695775985718
Epoch: 1, Steps: 18 | Train Loss: 1.015 Vali Loss: 2.759 Vali Acc: 0.500 Test Loss: 2.759 Test Acc: 0.500
Validation loss decreased (inf --> -0.499972).  Saving model ...
Epoch: 2 cost time: 12.804903030395508
Epoch: 2, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.753 Vali Acc: 0.550 Test Loss: 0.753 Test Acc: 0.550
Validation loss decreased (-0.499972 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 12.88752269744873
Epoch: 3, Steps: 18 | Train Loss: 0.967 Vali Loss: 1.089 Vali Acc: 0.520 Test Loss: 1.089 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.343989133834839
Epoch: 4, Steps: 18 | Train Loss: 1.027 Vali Loss: 1.096 Vali Acc: 0.520 Test Loss: 1.096 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.124695062637329
Epoch: 5, Steps: 18 | Train Loss: 0.825 Vali Loss: 3.140 Vali Acc: 0.500 Test Loss: 3.140 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.403774738311768
Epoch: 6, Steps: 18 | Train Loss: 0.826 Vali Loss: 4.691 Vali Acc: 0.510 Test Loss: 4.691 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.25159478187561
Epoch: 7, Steps: 18 | Train Loss: 0.972 Vali Loss: 1.548 Vali Acc: 0.520 Test Loss: 1.548 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.618463516235352
Epoch: 8, Steps: 18 | Train Loss: 0.461 Vali Loss: 5.402 Vali Acc: 0.500 Test Loss: 5.402 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.146662712097168
Epoch: 9, Steps: 18 | Train Loss: 0.391 Vali Loss: 6.045 Vali Acc: 0.500 Test Loss: 6.045 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.096871376037598
Epoch: 10, Steps: 18 | Train Loss: 1.303 Vali Loss: 13.965 Vali Acc: 0.500 Test Loss: 13.965 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 13.12514042854309
Epoch: 11, Steps: 18 | Train Loss: 2.232 Vali Loss: 4.447 Vali Acc: 0.560 Test Loss: 4.447 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559956).  Saving model ...
Epoch: 12 cost time: 12.782910108566284
Epoch: 12, Steps: 18 | Train Loss: 1.201 Vali Loss: 11.394 Vali Acc: 0.510 Test Loss: 11.394 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.222678899765015
Epoch: 13, Steps: 18 | Train Loss: 0.688 Vali Loss: 15.190 Vali Acc: 0.500 Test Loss: 15.190 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.371275424957275
Epoch: 14, Steps: 18 | Train Loss: 2.485 Vali Loss: 8.902 Vali Acc: 0.550 Test Loss: 8.902 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.950557708740234
Epoch: 15, Steps: 18 | Train Loss: 2.031 Vali Loss: 9.997 Vali Acc: 0.540 Test Loss: 9.997 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 13.757213115692139
Epoch: 16, Steps: 18 | Train Loss: 0.490 Vali Loss: 10.383 Vali Acc: 0.560 Test Loss: 10.383 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.490742206573486
Epoch: 17, Steps: 18 | Train Loss: 0.595 Vali Loss: 10.053 Vali Acc: 0.530 Test Loss: 10.053 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 14.2095046043396
Epoch: 18, Steps: 18 | Train Loss: 1.406 Vali Loss: 31.574 Vali Acc: 0.500 Test Loss: 31.574 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 12.664920330047607
Epoch: 19, Steps: 18 | Train Loss: 1.453 Vali Loss: 14.179 Vali Acc: 0.530 Test Loss: 14.179 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.790945053100586
Epoch: 20, Steps: 18 | Train Loss: 0.590 Vali Loss: 11.714 Vali Acc: 0.560 Test Loss: 11.714 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 13.817800760269165
Epoch: 21, Steps: 18 | Train Loss: 1.273 Vali Loss: 12.232 Vali Acc: 0.520 Test Loss: 12.232 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 7364866
model size : 37.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 40.95126748085022
Epoch: 1, Steps: 18 | Train Loss: 1.089 Vali Loss: 1.255 Vali Acc: 0.550 Test Loss: 1.255 Test Acc: 0.550
Validation loss decreased (inf --> -0.549987).  Saving model ...
Epoch: 2 cost time: 43.31161117553711
Epoch: 2, Steps: 18 | Train Loss: 1.338 Vali Loss: 1.788 Vali Acc: 0.570 Test Loss: 1.788 Test Acc: 0.570
Validation loss decreased (-0.549987 --> -0.569982).  Saving model ...
Epoch: 3 cost time: 40.62689423561096
Epoch: 3, Steps: 18 | Train Loss: 1.780 Vali Loss: 3.409 Vali Acc: 0.480 Test Loss: 3.409 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 45.14886021614075
Epoch: 4, Steps: 18 | Train Loss: 1.174 Vali Loss: 3.564 Vali Acc: 0.540 Test Loss: 3.564 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 44.426204442977905
Epoch: 5, Steps: 18 | Train Loss: 2.423 Vali Loss: 17.365 Vali Acc: 0.500 Test Loss: 17.365 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 42.31537652015686
Epoch: 6, Steps: 18 | Train Loss: 3.751 Vali Loss: 20.472 Vali Acc: 0.500 Test Loss: 20.472 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 44.38623309135437
Epoch: 7, Steps: 18 | Train Loss: 1.833 Vali Loss: 11.792 Vali Acc: 0.510 Test Loss: 11.792 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 45.323922634124756
Epoch: 8, Steps: 18 | Train Loss: 1.810 Vali Loss: 8.636 Vali Acc: 0.500 Test Loss: 8.636 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 46.850547790527344
Epoch: 9, Steps: 18 | Train Loss: 2.576 Vali Loss: 8.742 Vali Acc: 0.570 Test Loss: 8.742 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 50.133798360824585
Epoch: 10, Steps: 18 | Train Loss: 1.301 Vali Loss: 16.086 Vali Acc: 0.510 Test Loss: 16.086 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 48.22360062599182
Epoch: 11, Steps: 18 | Train Loss: 2.883 Vali Loss: 18.391 Vali Acc: 0.570 Test Loss: 18.391 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 54.33706617355347
Epoch: 12, Steps: 18 | Train Loss: 2.966 Vali Loss: 26.659 Vali Acc: 0.510 Test Loss: 26.659 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5792002
model size : 31.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 34.5726478099823
Epoch: 1, Steps: 18 | Train Loss: 1.151 Vali Loss: 1.277 Vali Acc: 0.570 Test Loss: 1.277 Test Acc: 0.570
Validation loss decreased (inf --> -0.569987).  Saving model ...
Epoch: 2 cost time: 35.40348243713379
Epoch: 2, Steps: 18 | Train Loss: 1.500 Vali Loss: 2.598 Vali Acc: 0.530 Test Loss: 2.598 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 32.493226051330566
Epoch: 3, Steps: 18 | Train Loss: 2.262 Vali Loss: 5.709 Vali Acc: 0.580 Test Loss: 5.709 Test Acc: 0.580
Validation loss decreased (-0.569987 --> -0.579943).  Saving model ...
Epoch: 4 cost time: 35.905163526535034
Epoch: 4, Steps: 18 | Train Loss: 2.179 Vali Loss: 4.364 Vali Acc: 0.520 Test Loss: 4.364 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 35.911906719207764
Epoch: 5, Steps: 18 | Train Loss: 1.908 Vali Loss: 4.792 Vali Acc: 0.510 Test Loss: 4.792 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 34.87767195701599
Epoch: 6, Steps: 18 | Train Loss: 1.476 Vali Loss: 5.717 Vali Acc: 0.430 Test Loss: 5.717 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 34.741095304489136
Epoch: 7, Steps: 18 | Train Loss: 1.370 Vali Loss: 4.762 Vali Acc: 0.610 Test Loss: 4.762 Test Acc: 0.610
Validation loss decreased (-0.579943 --> -0.609952).  Saving model ...
Epoch: 8 cost time: 37.585121393203735
Epoch: 8, Steps: 18 | Train Loss: 1.351 Vali Loss: 7.224 Vali Acc: 0.530 Test Loss: 7.224 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 37.907573223114014
Epoch: 9, Steps: 18 | Train Loss: 1.297 Vali Loss: 7.726 Vali Acc: 0.520 Test Loss: 7.726 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 35.93491053581238
Epoch: 10, Steps: 18 | Train Loss: 2.431 Vali Loss: 9.538 Vali Acc: 0.490 Test Loss: 9.538 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 38.10513782501221
Epoch: 11, Steps: 18 | Train Loss: 1.875 Vali Loss: 11.339 Vali Acc: 0.580 Test Loss: 11.339 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 45.89282774925232
Epoch: 12, Steps: 18 | Train Loss: 3.563 Vali Loss: 19.113 Vali Acc: 0.530 Test Loss: 19.113 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 42.485392570495605
Epoch: 13, Steps: 18 | Train Loss: 2.874 Vali Loss: 21.520 Vali Acc: 0.500 Test Loss: 21.520 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 45.13027024269104
Epoch: 14, Steps: 18 | Train Loss: 0.829 Vali Loss: 25.260 Vali Acc: 0.510 Test Loss: 25.260 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 44.82506561279297
Epoch: 15, Steps: 18 | Train Loss: 3.409 Vali Loss: 17.114 Vali Acc: 0.580 Test Loss: 17.114 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 45.087790727615356
Epoch: 16, Steps: 18 | Train Loss: 0.985 Vali Loss: 12.647 Vali Acc: 0.630 Test Loss: 12.647 Test Acc: 0.630
Validation loss decreased (-0.609952 --> -0.629874).  Saving model ...
Epoch: 17 cost time: 40.862072706222534
Epoch: 17, Steps: 18 | Train Loss: 0.774 Vali Loss: 29.918 Vali Acc: 0.540 Test Loss: 29.918 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 38.53454327583313
Epoch: 18, Steps: 18 | Train Loss: 1.697 Vali Loss: 36.175 Vali Acc: 0.530 Test Loss: 36.175 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 48.53990077972412
Epoch: 19, Steps: 18 | Train Loss: 1.601 Vali Loss: 43.302 Vali Acc: 0.520 Test Loss: 43.302 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 44.17116856575012
Epoch: 20, Steps: 18 | Train Loss: 2.546 Vali Loss: 21.967 Vali Acc: 0.540 Test Loss: 21.967 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 44.24216413497925
Epoch: 21, Steps: 18 | Train Loss: 2.319 Vali Loss: 15.787 Vali Acc: 0.590 Test Loss: 15.787 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 47.210944175720215
Epoch: 22, Steps: 18 | Train Loss: 1.990 Vali Loss: 58.611 Vali Acc: 0.480 Test Loss: 58.611 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 44.95271921157837
Epoch: 23, Steps: 18 | Train Loss: 2.185 Vali Loss: 23.904 Vali Acc: 0.570 Test Loss: 23.904 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 45.43649864196777
Epoch: 24, Steps: 18 | Train Loss: 1.865 Vali Loss: 65.138 Vali Acc: 0.490 Test Loss: 65.138 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 45.362322092056274
Epoch: 25, Steps: 18 | Train Loss: 2.477 Vali Loss: 37.739 Vali Acc: 0.580 Test Loss: 37.739 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 45.21180558204651
Epoch: 26, Steps: 18 | Train Loss: 0.787 Vali Loss: 28.860 Vali Acc: 0.540 Test Loss: 28.860 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 5792002
model size : 31.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 29.828800201416016
Epoch: 1, Steps: 18 | Train Loss: 1.081 Vali Loss: 2.247 Vali Acc: 0.500 Test Loss: 2.247 Test Acc: 0.500
Validation loss decreased (inf --> -0.499978).  Saving model ...
Epoch: 2 cost time: 29.985142946243286
Epoch: 2, Steps: 18 | Train Loss: 1.645 Vali Loss: 1.532 Vali Acc: 0.480 Test Loss: 1.532 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.3434317111969
Epoch: 3, Steps: 18 | Train Loss: 1.561 Vali Loss: 4.378 Vali Acc: 0.530 Test Loss: 4.378 Test Acc: 0.530
Validation loss decreased (-0.499978 --> -0.529956).  Saving model ...
Epoch: 4 cost time: 27.54160189628601
Epoch: 4, Steps: 18 | Train Loss: 1.532 Vali Loss: 9.074 Vali Acc: 0.500 Test Loss: 9.074 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.54158854484558
Epoch: 5, Steps: 18 | Train Loss: 2.251 Vali Loss: 5.711 Vali Acc: 0.570 Test Loss: 5.711 Test Acc: 0.570
Validation loss decreased (-0.529956 --> -0.569943).  Saving model ...
Epoch: 6 cost time: 29.81182599067688
Epoch: 6, Steps: 18 | Train Loss: 2.846 Vali Loss: 7.425 Vali Acc: 0.570 Test Loss: 7.425 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 29.06973910331726
Epoch: 7, Steps: 18 | Train Loss: 2.995 Vali Loss: 5.698 Vali Acc: 0.540 Test Loss: 5.698 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 27.344991207122803
Epoch: 8, Steps: 18 | Train Loss: 0.998 Vali Loss: 5.637 Vali Acc: 0.550 Test Loss: 5.637 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 30.93756365776062
Epoch: 9, Steps: 18 | Train Loss: 2.799 Vali Loss: 17.518 Vali Acc: 0.450 Test Loss: 17.518 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 33.030415058135986
Epoch: 10, Steps: 18 | Train Loss: 2.268 Vali Loss: 12.436 Vali Acc: 0.470 Test Loss: 12.436 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 33.924105167388916
Epoch: 11, Steps: 18 | Train Loss: 2.074 Vali Loss: 13.394 Vali Acc: 0.600 Test Loss: 13.394 Test Acc: 0.600
Validation loss decreased (-0.569943 --> -0.599866).  Saving model ...
Epoch: 12 cost time: 31.96712040901184
Epoch: 12, Steps: 18 | Train Loss: 2.369 Vali Loss: 10.720 Vali Acc: 0.540 Test Loss: 10.720 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 35.56593728065491
Epoch: 13, Steps: 18 | Train Loss: 1.000 Vali Loss: 10.070 Vali Acc: 0.560 Test Loss: 10.070 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 36.874648332595825
Epoch: 14, Steps: 18 | Train Loss: 1.381 Vali Loss: 13.755 Vali Acc: 0.500 Test Loss: 13.755 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 34.776575803756714
Epoch: 15, Steps: 18 | Train Loss: 1.911 Vali Loss: 17.015 Vali Acc: 0.460 Test Loss: 17.015 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 33.243006229400635
Epoch: 16, Steps: 18 | Train Loss: 0.437 Vali Loss: 14.316 Vali Acc: 0.520 Test Loss: 14.316 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 37.34513974189758
Epoch: 17, Steps: 18 | Train Loss: 1.157 Vali Loss: 27.812 Vali Acc: 0.530 Test Loss: 27.812 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 37.822834730148315
Epoch: 18, Steps: 18 | Train Loss: 3.611 Vali Loss: 29.370 Vali Acc: 0.530 Test Loss: 29.370 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 35.29794120788574
Epoch: 19, Steps: 18 | Train Loss: 2.790 Vali Loss: 37.104 Vali Acc: 0.500 Test Loss: 37.104 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 37.8255672454834
Epoch: 20, Steps: 18 | Train Loss: 3.908 Vali Loss: 19.219 Vali Acc: 0.580 Test Loss: 19.219 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 38.24823021888733
Epoch: 21, Steps: 18 | Train Loss: 4.121 Vali Loss: 28.458 Vali Acc: 0.510 Test Loss: 28.458 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5792002
model size : 31.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.156172513961792
Epoch: 1, Steps: 18 | Train Loss: 1.004 Vali Loss: 1.851 Vali Acc: 0.470 Test Loss: 1.851 Test Acc: 0.470
Validation loss decreased (inf --> -0.469981).  Saving model ...
Epoch: 2 cost time: 21.56782341003418
Epoch: 2, Steps: 18 | Train Loss: 1.687 Vali Loss: 3.380 Vali Acc: 0.530 Test Loss: 3.380 Test Acc: 0.530
Validation loss decreased (-0.469981 --> -0.529966).  Saving model ...
Epoch: 3 cost time: 22.03681969642639
Epoch: 3, Steps: 18 | Train Loss: 2.469 Vali Loss: 6.459 Vali Acc: 0.490 Test Loss: 6.459 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.467318296432495
Epoch: 4, Steps: 18 | Train Loss: 1.267 Vali Loss: 3.386 Vali Acc: 0.540 Test Loss: 3.386 Test Acc: 0.540
Validation loss decreased (-0.529966 --> -0.539966).  Saving model ...
Epoch: 5 cost time: 23.087193250656128
Epoch: 5, Steps: 18 | Train Loss: 2.282 Vali Loss: 10.608 Vali Acc: 0.520 Test Loss: 10.608 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.18312168121338
Epoch: 6, Steps: 18 | Train Loss: 1.948 Vali Loss: 4.169 Vali Acc: 0.560 Test Loss: 4.169 Test Acc: 0.560
Validation loss decreased (-0.539966 --> -0.559958).  Saving model ...
Epoch: 7 cost time: 22.312840223312378
Epoch: 7, Steps: 18 | Train Loss: 2.966 Vali Loss: 8.928 Vali Acc: 0.510 Test Loss: 8.928 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.4195773601532
Epoch: 8, Steps: 18 | Train Loss: 2.315 Vali Loss: 7.907 Vali Acc: 0.500 Test Loss: 7.907 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.69029974937439
Epoch: 9, Steps: 18 | Train Loss: 2.877 Vali Loss: 21.310 Vali Acc: 0.470 Test Loss: 21.310 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 26.216503620147705
Epoch: 10, Steps: 18 | Train Loss: 2.450 Vali Loss: 9.185 Vali Acc: 0.510 Test Loss: 9.185 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 23.603833198547363
Epoch: 11, Steps: 18 | Train Loss: 1.538 Vali Loss: 9.793 Vali Acc: 0.540 Test Loss: 9.793 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 25.106160402297974
Epoch: 12, Steps: 18 | Train Loss: 2.209 Vali Loss: 11.714 Vali Acc: 0.540 Test Loss: 11.714 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 29.442060232162476
Epoch: 13, Steps: 18 | Train Loss: 1.165 Vali Loss: 13.310 Vali Acc: 0.580 Test Loss: 13.310 Test Acc: 0.580
Validation loss decreased (-0.559958 --> -0.579867).  Saving model ...
Epoch: 14 cost time: 28.59554648399353
Epoch: 14, Steps: 18 | Train Loss: 1.255 Vali Loss: 22.787 Vali Acc: 0.480 Test Loss: 22.787 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 26.979259967803955
Epoch: 15, Steps: 18 | Train Loss: 3.049 Vali Loss: 24.215 Vali Acc: 0.550 Test Loss: 24.215 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 25.411887407302856
Epoch: 16, Steps: 18 | Train Loss: 1.574 Vali Loss: 12.860 Vali Acc: 0.530 Test Loss: 12.860 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 27.095585823059082
Epoch: 17, Steps: 18 | Train Loss: 1.020 Vali Loss: 17.225 Vali Acc: 0.550 Test Loss: 17.225 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 29.304736614227295
Epoch: 18, Steps: 18 | Train Loss: 1.717 Vali Loss: 26.573 Vali Acc: 0.460 Test Loss: 26.573 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 29.90824055671692
Epoch: 19, Steps: 18 | Train Loss: 1.223 Vali Loss: 25.572 Vali Acc: 0.500 Test Loss: 25.572 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 25.670676708221436
Epoch: 20, Steps: 18 | Train Loss: 1.493 Vali Loss: 19.557 Vali Acc: 0.570 Test Loss: 19.557 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 28.157378435134888
Epoch: 21, Steps: 18 | Train Loss: 1.450 Vali Loss: 21.577 Vali Acc: 0.510 Test Loss: 21.577 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 30.150880575180054
Epoch: 22, Steps: 18 | Train Loss: 0.610 Vali Loss: 26.388 Vali Acc: 0.490 Test Loss: 26.388 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 29.79676914215088
Epoch: 23, Steps: 18 | Train Loss: 2.129 Vali Loss: 23.710 Vali Acc: 0.540 Test Loss: 23.710 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 5792002
model size : 31.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.834993600845337
Epoch: 1, Steps: 18 | Train Loss: 0.969 Vali Loss: 3.455 Vali Acc: 0.490 Test Loss: 3.455 Test Acc: 0.490
Validation loss decreased (inf --> -0.489965).  Saving model ...
Epoch: 2 cost time: 16.690796613693237
Epoch: 2, Steps: 18 | Train Loss: 2.345 Vali Loss: 2.006 Vali Acc: 0.540 Test Loss: 2.006 Test Acc: 0.540
Validation loss decreased (-0.489965 --> -0.539980).  Saving model ...
Epoch: 3 cost time: 16.304296731948853
Epoch: 3, Steps: 18 | Train Loss: 1.175 Vali Loss: 2.683 Vali Acc: 0.570 Test Loss: 2.683 Test Acc: 0.570
Validation loss decreased (-0.539980 --> -0.569973).  Saving model ...
Epoch: 4 cost time: 16.88414430618286
Epoch: 4, Steps: 18 | Train Loss: 2.542 Vali Loss: 6.986 Vali Acc: 0.530 Test Loss: 6.986 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.596221446990967
Epoch: 5, Steps: 18 | Train Loss: 3.066 Vali Loss: 6.732 Vali Acc: 0.540 Test Loss: 6.732 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.149821043014526
Epoch: 6, Steps: 18 | Train Loss: 1.278 Vali Loss: 9.285 Vali Acc: 0.500 Test Loss: 9.285 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.397850275039673
Epoch: 7, Steps: 18 | Train Loss: 1.442 Vali Loss: 4.868 Vali Acc: 0.610 Test Loss: 4.868 Test Acc: 0.610
Validation loss decreased (-0.569973 --> -0.609951).  Saving model ...
Epoch: 8 cost time: 14.88995623588562
Epoch: 8, Steps: 18 | Train Loss: 1.877 Vali Loss: 8.883 Vali Acc: 0.510 Test Loss: 8.883 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.234468936920166
Epoch: 9, Steps: 18 | Train Loss: 0.921 Vali Loss: 9.287 Vali Acc: 0.540 Test Loss: 9.287 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.64487648010254
Epoch: 10, Steps: 18 | Train Loss: 2.423 Vali Loss: 10.295 Vali Acc: 0.550 Test Loss: 10.295 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.709049940109253
Epoch: 11, Steps: 18 | Train Loss: 1.815 Vali Loss: 34.277 Vali Acc: 0.500 Test Loss: 34.277 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 17.947511434555054
Epoch: 12, Steps: 18 | Train Loss: 2.641 Vali Loss: 11.255 Vali Acc: 0.540 Test Loss: 11.255 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 19.591196298599243
Epoch: 13, Steps: 18 | Train Loss: 1.002 Vali Loss: 23.479 Vali Acc: 0.470 Test Loss: 23.479 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 16.220799446105957
Epoch: 14, Steps: 18 | Train Loss: 1.874 Vali Loss: 25.889 Vali Acc: 0.510 Test Loss: 25.889 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 17.700002670288086
Epoch: 15, Steps: 18 | Train Loss: 2.635 Vali Loss: 23.097 Vali Acc: 0.560 Test Loss: 23.097 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 18.234323501586914
Epoch: 16, Steps: 18 | Train Loss: 1.096 Vali Loss: 19.830 Vali Acc: 0.500 Test Loss: 19.830 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 20.444461345672607
Epoch: 17, Steps: 18 | Train Loss: 1.109 Vali Loss: 24.822 Vali Acc: 0.470 Test Loss: 24.822 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 5792002
model size : 31.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.012291193008423
Epoch: 1, Steps: 18 | Train Loss: 1.060 Vali Loss: 1.399 Vali Acc: 0.550 Test Loss: 1.399 Test Acc: 0.550
Validation loss decreased (inf --> -0.549986).  Saving model ...
Epoch: 2 cost time: 12.601446628570557
Epoch: 2, Steps: 18 | Train Loss: 1.231 Vali Loss: 1.850 Vali Acc: 0.450 Test Loss: 1.850 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.72539234161377
Epoch: 3, Steps: 18 | Train Loss: 1.042 Vali Loss: 2.801 Vali Acc: 0.570 Test Loss: 2.801 Test Acc: 0.570
Validation loss decreased (-0.549986 --> -0.569972).  Saving model ...
Epoch: 4 cost time: 12.44663119316101
Epoch: 4, Steps: 18 | Train Loss: 1.602 Vali Loss: 12.350 Vali Acc: 0.510 Test Loss: 12.350 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.31196641921997
Epoch: 5, Steps: 18 | Train Loss: 2.189 Vali Loss: 4.362 Vali Acc: 0.540 Test Loss: 4.362 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.767959594726562
Epoch: 6, Steps: 18 | Train Loss: 2.759 Vali Loss: 5.391 Vali Acc: 0.560 Test Loss: 5.391 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.722901105880737
Epoch: 7, Steps: 18 | Train Loss: 1.576 Vali Loss: 7.605 Vali Acc: 0.480 Test Loss: 7.605 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.642882347106934
Epoch: 8, Steps: 18 | Train Loss: 2.213 Vali Loss: 6.829 Vali Acc: 0.470 Test Loss: 6.829 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.94445252418518
Epoch: 9, Steps: 18 | Train Loss: 2.129 Vali Loss: 7.057 Vali Acc: 0.480 Test Loss: 7.057 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.073048114776611
Epoch: 10, Steps: 18 | Train Loss: 1.811 Vali Loss: 20.342 Vali Acc: 0.520 Test Loss: 20.342 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 14.000070095062256
Epoch: 11, Steps: 18 | Train Loss: 1.736 Vali Loss: 15.692 Vali Acc: 0.460 Test Loss: 15.692 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 15.178236484527588
Epoch: 12, Steps: 18 | Train Loss: 0.944 Vali Loss: 18.943 Vali Acc: 0.470 Test Loss: 18.943 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 14.192269563674927
Epoch: 13, Steps: 18 | Train Loss: 4.606 Vali Loss: 18.364 Vali Acc: 0.460 Test Loss: 18.364 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5792002
model size : 31.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.0058753490448
Epoch: 1, Steps: 18 | Train Loss: 0.927 Vali Loss: 1.501 Vali Acc: 0.540 Test Loss: 1.501 Test Acc: 0.540
Validation loss decreased (inf --> -0.539985).  Saving model ...
Epoch: 2 cost time: 11.120845317840576
Epoch: 2, Steps: 18 | Train Loss: 1.062 Vali Loss: 1.962 Vali Acc: 0.610 Test Loss: 1.962 Test Acc: 0.610
Validation loss decreased (-0.539985 --> -0.609980).  Saving model ...
Epoch: 3 cost time: 12.250793218612671
Epoch: 3, Steps: 18 | Train Loss: 0.821 Vali Loss: 2.815 Vali Acc: 0.500 Test Loss: 2.815 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.510985851287842
Epoch: 4, Steps: 18 | Train Loss: 1.263 Vali Loss: 4.073 Vali Acc: 0.540 Test Loss: 4.073 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.655951738357544
Epoch: 5, Steps: 18 | Train Loss: 2.223 Vali Loss: 9.760 Vali Acc: 0.510 Test Loss: 9.760 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.587553977966309
Epoch: 6, Steps: 18 | Train Loss: 1.904 Vali Loss: 11.003 Vali Acc: 0.510 Test Loss: 11.003 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.640990495681763
Epoch: 7, Steps: 18 | Train Loss: 2.533 Vali Loss: 18.205 Vali Acc: 0.510 Test Loss: 18.205 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.934364557266235
Epoch: 8, Steps: 18 | Train Loss: 3.818 Vali Loss: 8.136 Vali Acc: 0.530 Test Loss: 8.136 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.337223291397095
Epoch: 9, Steps: 18 | Train Loss: 1.454 Vali Loss: 11.265 Vali Acc: 0.480 Test Loss: 11.265 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.9098539352417
Epoch: 10, Steps: 18 | Train Loss: 1.178 Vali Loss: 9.853 Vali Acc: 0.540 Test Loss: 9.853 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.712420225143433
Epoch: 11, Steps: 18 | Train Loss: 0.587 Vali Loss: 11.368 Vali Acc: 0.550 Test Loss: 11.368 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 11.304191589355469
Epoch: 12, Steps: 18 | Train Loss: 0.753 Vali Loss: 16.400 Vali Acc: 0.550 Test Loss: 16.400 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 5792002
model size : 31.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.052325010299683
Epoch: 1, Steps: 18 | Train Loss: 0.935 Vali Loss: 0.816 Vali Acc: 0.620 Test Loss: 0.816 Test Acc: 0.620
Validation loss decreased (inf --> -0.619992).  Saving model ...
Epoch: 2 cost time: 11.612990379333496
Epoch: 2, Steps: 18 | Train Loss: 0.795 Vali Loss: 2.295 Vali Acc: 0.420 Test Loss: 2.295 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.963631868362427
Epoch: 3, Steps: 18 | Train Loss: 1.044 Vali Loss: 3.611 Vali Acc: 0.490 Test Loss: 3.611 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.657816648483276
Epoch: 4, Steps: 18 | Train Loss: 1.788 Vali Loss: 2.866 Vali Acc: 0.540 Test Loss: 2.866 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.1436607837677
Epoch: 5, Steps: 18 | Train Loss: 1.352 Vali Loss: 6.334 Vali Acc: 0.530 Test Loss: 6.334 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.641185522079468
Epoch: 6, Steps: 18 | Train Loss: 1.710 Vali Loss: 8.090 Vali Acc: 0.500 Test Loss: 8.090 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.357719898223877
Epoch: 7, Steps: 18 | Train Loss: 0.732 Vali Loss: 3.872 Vali Acc: 0.570 Test Loss: 3.872 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.6921865940094
Epoch: 8, Steps: 18 | Train Loss: 1.193 Vali Loss: 8.279 Vali Acc: 0.500 Test Loss: 8.279 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 11.18454122543335
Epoch: 9, Steps: 18 | Train Loss: 1.042 Vali Loss: 8.292 Vali Acc: 0.490 Test Loss: 8.292 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.27497673034668
Epoch: 10, Steps: 18 | Train Loss: 2.267 Vali Loss: 10.545 Vali Acc: 0.520 Test Loss: 10.545 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 12.589083194732666
Epoch: 11, Steps: 18 | Train Loss: 1.613 Vali Loss: 7.419 Vali Acc: 0.550 Test Loss: 7.419 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 5792002
model size : 31.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.465577125549316
Epoch: 1, Steps: 18 | Train Loss: 0.895 Vali Loss: 1.784 Vali Acc: 0.570 Test Loss: 1.784 Test Acc: 0.570
Validation loss decreased (inf --> -0.569982).  Saving model ...
Epoch: 2 cost time: 9.933146953582764
Epoch: 2, Steps: 18 | Train Loss: 0.755 Vali Loss: 2.353 Vali Acc: 0.490 Test Loss: 2.353 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.278966426849365
Epoch: 3, Steps: 18 | Train Loss: 0.951 Vali Loss: 3.714 Vali Acc: 0.520 Test Loss: 3.714 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.18058180809021
Epoch: 4, Steps: 18 | Train Loss: 0.891 Vali Loss: 6.104 Vali Acc: 0.500 Test Loss: 6.104 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.341575384140015
Epoch: 5, Steps: 18 | Train Loss: 1.136 Vali Loss: 5.670 Vali Acc: 0.540 Test Loss: 5.670 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.801036596298218
Epoch: 6, Steps: 18 | Train Loss: 0.732 Vali Loss: 4.227 Vali Acc: 0.500 Test Loss: 4.227 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.853803157806396
Epoch: 7, Steps: 18 | Train Loss: 1.242 Vali Loss: 5.969 Vali Acc: 0.540 Test Loss: 5.969 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.227732181549072
Epoch: 8, Steps: 18 | Train Loss: 1.440 Vali Loss: 8.242 Vali Acc: 0.520 Test Loss: 8.242 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.891181468963623
Epoch: 9, Steps: 18 | Train Loss: 1.200 Vali Loss: 7.120 Vali Acc: 0.480 Test Loss: 7.120 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.167002201080322
Epoch: 10, Steps: 18 | Train Loss: 1.189 Vali Loss: 7.112 Vali Acc: 0.400 Test Loss: 7.112 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.244171619415283
Epoch: 11, Steps: 18 | Train Loss: 0.913 Vali Loss: 12.551 Vali Acc: 0.500 Test Loss: 12.551 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5792002
model size : 31.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.230749368667603
Epoch: 1, Steps: 18 | Train Loss: 0.804 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 10.499444723129272
Epoch: 2, Steps: 18 | Train Loss: 0.584 Vali Loss: 0.838 Vali Acc: 0.600 Test Loss: 0.838 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 10.695963621139526
Epoch: 3, Steps: 18 | Train Loss: 0.766 Vali Loss: 0.890 Vali Acc: 0.570 Test Loss: 0.890 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.409015893936157
Epoch: 4, Steps: 18 | Train Loss: 1.263 Vali Loss: 7.396 Vali Acc: 0.500 Test Loss: 7.396 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.951531648635864
Epoch: 5, Steps: 18 | Train Loss: 1.379 Vali Loss: 8.502 Vali Acc: 0.500 Test Loss: 8.502 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.954774379730225
Epoch: 6, Steps: 18 | Train Loss: 2.228 Vali Loss: 4.085 Vali Acc: 0.510 Test Loss: 4.085 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.770648717880249
Epoch: 7, Steps: 18 | Train Loss: 1.082 Vali Loss: 1.694 Vali Acc: 0.570 Test Loss: 1.694 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.92262053489685
Epoch: 8, Steps: 18 | Train Loss: 0.800 Vali Loss: 4.973 Vali Acc: 0.500 Test Loss: 4.973 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.148283004760742
Epoch: 9, Steps: 18 | Train Loss: 1.426 Vali Loss: 4.719 Vali Acc: 0.530 Test Loss: 4.719 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.472511291503906
Epoch: 10, Steps: 18 | Train Loss: 1.641 Vali Loss: 2.899 Vali Acc: 0.510 Test Loss: 2.899 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 10.169034242630005
Epoch: 11, Steps: 18 | Train Loss: 0.428 Vali Loss: 5.382 Vali Acc: 0.530 Test Loss: 5.382 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 11.493460893630981
Epoch: 12, Steps: 18 | Train Loss: 0.339 Vali Loss: 2.978 Vali Acc: 0.520 Test Loss: 2.978 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5792002
model size : 31.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 40.832849740982056
Epoch: 1, Steps: 18 | Train Loss: 1.394 Vali Loss: 3.127 Vali Acc: 0.530 Test Loss: 3.127 Test Acc: 0.530
Validation loss decreased (inf --> -0.529969).  Saving model ...
Epoch: 2 cost time: 38.007720708847046
Epoch: 2, Steps: 18 | Train Loss: 2.161 Vali Loss: 3.571 Vali Acc: 0.540 Test Loss: 3.571 Test Acc: 0.540
Validation loss decreased (-0.529969 --> -0.539964).  Saving model ...
Epoch: 3 cost time: 40.34753131866455
Epoch: 3, Steps: 18 | Train Loss: 2.181 Vali Loss: 2.425 Vali Acc: 0.590 Test Loss: 2.425 Test Acc: 0.590
Validation loss decreased (-0.539964 --> -0.589976).  Saving model ...
Epoch: 4 cost time: 41.577858209609985
Epoch: 4, Steps: 18 | Train Loss: 1.807 Vali Loss: 6.454 Vali Acc: 0.500 Test Loss: 6.454 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 37.31938648223877
Epoch: 5, Steps: 18 | Train Loss: 1.532 Vali Loss: 14.099 Vali Acc: 0.520 Test Loss: 14.099 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 42.555485248565674
Epoch: 6, Steps: 18 | Train Loss: 2.996 Vali Loss: 11.169 Vali Acc: 0.450 Test Loss: 11.169 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 41.60698390007019
Epoch: 7, Steps: 18 | Train Loss: 2.005 Vali Loss: 18.990 Vali Acc: 0.500 Test Loss: 18.990 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 39.00457978248596
Epoch: 8, Steps: 18 | Train Loss: 2.451 Vali Loss: 7.454 Vali Acc: 0.530 Test Loss: 7.454 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 49.68107342720032
Epoch: 9, Steps: 18 | Train Loss: 4.505 Vali Loss: 13.488 Vali Acc: 0.500 Test Loss: 13.488 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 44.387547969818115
Epoch: 10, Steps: 18 | Train Loss: 1.651 Vali Loss: 17.223 Vali Acc: 0.520 Test Loss: 17.223 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 44.47394037246704
Epoch: 11, Steps: 18 | Train Loss: 1.795 Vali Loss: 10.916 Vali Acc: 0.490 Test Loss: 10.916 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 49.036590576171875
Epoch: 12, Steps: 18 | Train Loss: 2.458 Vali Loss: 16.473 Vali Acc: 0.470 Test Loss: 16.473 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 44.79704523086548
Epoch: 13, Steps: 18 | Train Loss: 2.008 Vali Loss: 21.456 Vali Acc: 0.530 Test Loss: 21.456 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 5005570
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 34.342897176742554
Epoch: 1, Steps: 18 | Train Loss: 1.366 Vali Loss: 2.223 Vali Acc: 0.500 Test Loss: 2.223 Test Acc: 0.500
Validation loss decreased (inf --> -0.499978).  Saving model ...
Epoch: 2 cost time: 33.97671437263489
Epoch: 2, Steps: 18 | Train Loss: 2.043 Vali Loss: 4.165 Vali Acc: 0.540 Test Loss: 4.165 Test Acc: 0.540
Validation loss decreased (-0.499978 --> -0.539958).  Saving model ...
Epoch: 3 cost time: 30.479997634887695
Epoch: 3, Steps: 18 | Train Loss: 1.536 Vali Loss: 6.948 Vali Acc: 0.500 Test Loss: 6.948 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 35.68148112297058
Epoch: 4, Steps: 18 | Train Loss: 2.704 Vali Loss: 4.387 Vali Acc: 0.490 Test Loss: 4.387 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 35.356980085372925
Epoch: 5, Steps: 18 | Train Loss: 1.303 Vali Loss: 5.436 Vali Acc: 0.520 Test Loss: 5.436 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 32.27314066886902
Epoch: 6, Steps: 18 | Train Loss: 2.662 Vali Loss: 6.772 Vali Acc: 0.640 Test Loss: 6.772 Test Acc: 0.640
Validation loss decreased (-0.539958 --> -0.639932).  Saving model ...
Epoch: 7 cost time: 36.73507642745972
Epoch: 7, Steps: 18 | Train Loss: 4.146 Vali Loss: 28.074 Vali Acc: 0.510 Test Loss: 28.074 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 37.4913694858551
Epoch: 8, Steps: 18 | Train Loss: 2.106 Vali Loss: 10.876 Vali Acc: 0.530 Test Loss: 10.876 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 38.37860441207886
Epoch: 9, Steps: 18 | Train Loss: 3.268 Vali Loss: 9.297 Vali Acc: 0.510 Test Loss: 9.297 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 39.55784845352173
Epoch: 10, Steps: 18 | Train Loss: 4.556 Vali Loss: 17.235 Vali Acc: 0.520 Test Loss: 17.235 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 40.78326177597046
Epoch: 11, Steps: 18 | Train Loss: 1.666 Vali Loss: 11.144 Vali Acc: 0.540 Test Loss: 11.144 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 39.57364249229431
Epoch: 12, Steps: 18 | Train Loss: 2.900 Vali Loss: 22.596 Vali Acc: 0.490 Test Loss: 22.596 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 41.0633430480957
Epoch: 13, Steps: 18 | Train Loss: 2.281 Vali Loss: 23.475 Vali Acc: 0.510 Test Loss: 23.475 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 44.53227734565735
Epoch: 14, Steps: 18 | Train Loss: 0.147 Vali Loss: 13.588 Vali Acc: 0.510 Test Loss: 13.588 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 43.27423930168152
Epoch: 15, Steps: 18 | Train Loss: 0.736 Vali Loss: 16.971 Vali Acc: 0.480 Test Loss: 16.971 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 43.92737054824829
Epoch: 16, Steps: 18 | Train Loss: 0.923 Vali Loss: 14.509 Vali Acc: 0.520 Test Loss: 14.509 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 5005570
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 28.019788026809692
Epoch: 1, Steps: 18 | Train Loss: 1.314 Vali Loss: 1.990 Vali Acc: 0.530 Test Loss: 1.990 Test Acc: 0.530
Validation loss decreased (inf --> -0.529980).  Saving model ...
Epoch: 2 cost time: 24.498392343521118
Epoch: 2, Steps: 18 | Train Loss: 1.558 Vali Loss: 1.746 Vali Acc: 0.520 Test Loss: 1.746 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.977574586868286
Epoch: 3, Steps: 18 | Train Loss: 1.325 Vali Loss: 5.939 Vali Acc: 0.510 Test Loss: 5.939 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 27.572628259658813
Epoch: 4, Steps: 18 | Train Loss: 2.638 Vali Loss: 5.414 Vali Acc: 0.560 Test Loss: 5.414 Test Acc: 0.560
Validation loss decreased (-0.529980 --> -0.559946).  Saving model ...
Epoch: 5 cost time: 29.178896188735962
Epoch: 5, Steps: 18 | Train Loss: 1.662 Vali Loss: 12.992 Vali Acc: 0.490 Test Loss: 12.992 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 26.460161447525024
Epoch: 6, Steps: 18 | Train Loss: 2.603 Vali Loss: 8.433 Vali Acc: 0.540 Test Loss: 8.433 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 26.572094678878784
Epoch: 7, Steps: 18 | Train Loss: 2.279 Vali Loss: 20.511 Vali Acc: 0.490 Test Loss: 20.511 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 30.575218439102173
Epoch: 8, Steps: 18 | Train Loss: 2.444 Vali Loss: 6.601 Vali Acc: 0.510 Test Loss: 6.601 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 32.740739583969116
Epoch: 9, Steps: 18 | Train Loss: 3.924 Vali Loss: 7.939 Vali Acc: 0.540 Test Loss: 7.939 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 30.397982835769653
Epoch: 10, Steps: 18 | Train Loss: 2.822 Vali Loss: 14.949 Vali Acc: 0.550 Test Loss: 14.949 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 31.585237503051758
Epoch: 11, Steps: 18 | Train Loss: 1.659 Vali Loss: 30.641 Vali Acc: 0.520 Test Loss: 30.641 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 35.31902527809143
Epoch: 12, Steps: 18 | Train Loss: 4.513 Vali Loss: 26.142 Vali Acc: 0.500 Test Loss: 26.142 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 34.58116865158081
Epoch: 13, Steps: 18 | Train Loss: 3.499 Vali Loss: 21.915 Vali Acc: 0.530 Test Loss: 21.915 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 33.246007204055786
Epoch: 14, Steps: 18 | Train Loss: 2.627 Vali Loss: 19.204 Vali Acc: 0.500 Test Loss: 19.204 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5005570
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.53551721572876
Epoch: 1, Steps: 18 | Train Loss: 1.316 Vali Loss: 1.026 Vali Acc: 0.530 Test Loss: 1.026 Test Acc: 0.530
Validation loss decreased (inf --> -0.529990).  Saving model ...
Epoch: 2 cost time: 22.925739288330078
Epoch: 2, Steps: 18 | Train Loss: 1.328 Vali Loss: 2.346 Vali Acc: 0.590 Test Loss: 2.346 Test Acc: 0.590
Validation loss decreased (-0.529990 --> -0.589977).  Saving model ...
Epoch: 3 cost time: 20.0050311088562
Epoch: 3, Steps: 18 | Train Loss: 1.152 Vali Loss: 6.860 Vali Acc: 0.500 Test Loss: 6.860 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.740159273147583
Epoch: 4, Steps: 18 | Train Loss: 1.390 Vali Loss: 8.616 Vali Acc: 0.470 Test Loss: 8.616 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.510466814041138
Epoch: 5, Steps: 18 | Train Loss: 1.743 Vali Loss: 7.231 Vali Acc: 0.430 Test Loss: 7.231 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.299618005752563
Epoch: 6, Steps: 18 | Train Loss: 1.166 Vali Loss: 8.736 Vali Acc: 0.480 Test Loss: 8.736 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 19.76845359802246
Epoch: 7, Steps: 18 | Train Loss: 1.531 Vali Loss: 13.258 Vali Acc: 0.510 Test Loss: 13.258 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 20.478774785995483
Epoch: 8, Steps: 18 | Train Loss: 1.546 Vali Loss: 4.787 Vali Acc: 0.570 Test Loss: 4.787 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 23.872908115386963
Epoch: 9, Steps: 18 | Train Loss: 1.259 Vali Loss: 4.805 Vali Acc: 0.560 Test Loss: 4.805 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 23.239781379699707
Epoch: 10, Steps: 18 | Train Loss: 1.789 Vali Loss: 19.495 Vali Acc: 0.520 Test Loss: 19.495 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 22.79776954650879
Epoch: 11, Steps: 18 | Train Loss: 2.487 Vali Loss: 27.295 Vali Acc: 0.510 Test Loss: 27.295 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 25.064173221588135
Epoch: 12, Steps: 18 | Train Loss: 1.879 Vali Loss: 8.744 Vali Acc: 0.520 Test Loss: 8.744 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 5005570
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.445701837539673
Epoch: 1, Steps: 18 | Train Loss: 1.433 Vali Loss: 1.308 Vali Acc: 0.520 Test Loss: 1.308 Test Acc: 0.520
Validation loss decreased (inf --> -0.519987).  Saving model ...
Epoch: 2 cost time: 16.23547911643982
Epoch: 2, Steps: 18 | Train Loss: 1.215 Vali Loss: 3.043 Vali Acc: 0.520 Test Loss: 3.043 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.234501838684082
Epoch: 3, Steps: 18 | Train Loss: 0.925 Vali Loss: 2.118 Vali Acc: 0.510 Test Loss: 2.118 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.475994110107422
Epoch: 4, Steps: 18 | Train Loss: 1.027 Vali Loss: 4.639 Vali Acc: 0.470 Test Loss: 4.639 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.41416335105896
Epoch: 5, Steps: 18 | Train Loss: 1.317 Vali Loss: 5.588 Vali Acc: 0.500 Test Loss: 5.588 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.45128870010376
Epoch: 6, Steps: 18 | Train Loss: 1.525 Vali Loss: 9.686 Vali Acc: 0.510 Test Loss: 9.686 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 17.490224599838257
Epoch: 7, Steps: 18 | Train Loss: 3.650 Vali Loss: 10.698 Vali Acc: 0.440 Test Loss: 10.698 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.590786218643188
Epoch: 8, Steps: 18 | Train Loss: 3.810 Vali Loss: 11.441 Vali Acc: 0.510 Test Loss: 11.441 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 17.521301746368408
Epoch: 9, Steps: 18 | Train Loss: 1.964 Vali Loss: 5.882 Vali Acc: 0.570 Test Loss: 5.882 Test Acc: 0.570
Validation loss decreased (-0.519987 --> -0.569941).  Saving model ...
Epoch: 10 cost time: 15.901607036590576
Epoch: 10, Steps: 18 | Train Loss: 1.471 Vali Loss: 26.899 Vali Acc: 0.500 Test Loss: 26.899 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.31935477256775
Epoch: 11, Steps: 18 | Train Loss: 1.125 Vali Loss: 15.944 Vali Acc: 0.500 Test Loss: 15.944 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.471324682235718
Epoch: 12, Steps: 18 | Train Loss: 1.527 Vali Loss: 10.233 Vali Acc: 0.510 Test Loss: 10.233 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 17.176045417785645
Epoch: 13, Steps: 18 | Train Loss: 2.448 Vali Loss: 28.460 Vali Acc: 0.510 Test Loss: 28.460 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 17.15919852256775
Epoch: 14, Steps: 18 | Train Loss: 1.214 Vali Loss: 23.407 Vali Acc: 0.520 Test Loss: 23.407 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 20.308300733566284
Epoch: 15, Steps: 18 | Train Loss: 1.047 Vali Loss: 28.269 Vali Acc: 0.460 Test Loss: 28.269 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 17.436232805252075
Epoch: 16, Steps: 18 | Train Loss: 2.201 Vali Loss: 18.788 Vali Acc: 0.530 Test Loss: 18.788 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 19.726384162902832
Epoch: 17, Steps: 18 | Train Loss: 1.073 Vali Loss: 16.077 Vali Acc: 0.550 Test Loss: 16.077 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 16.137882232666016
Epoch: 18, Steps: 18 | Train Loss: 0.873 Vali Loss: 13.368 Vali Acc: 0.540 Test Loss: 13.368 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 17.37685537338257
Epoch: 19, Steps: 18 | Train Loss: 0.622 Vali Loss: 25.243 Vali Acc: 0.540 Test Loss: 25.243 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5005570
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.297993421554565
Epoch: 1, Steps: 18 | Train Loss: 1.221 Vali Loss: 1.450 Vali Acc: 0.590 Test Loss: 1.450 Test Acc: 0.590
Validation loss decreased (inf --> -0.589985).  Saving model ...
Epoch: 2 cost time: 12.499773502349854
Epoch: 2, Steps: 18 | Train Loss: 1.851 Vali Loss: 2.950 Vali Acc: 0.540 Test Loss: 2.950 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.460149765014648
Epoch: 3, Steps: 18 | Train Loss: 1.941 Vali Loss: 5.423 Vali Acc: 0.520 Test Loss: 5.423 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.83310079574585
Epoch: 4, Steps: 18 | Train Loss: 1.298 Vali Loss: 3.295 Vali Acc: 0.540 Test Loss: 3.295 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.146308660507202
Epoch: 5, Steps: 18 | Train Loss: 1.254 Vali Loss: 6.032 Vali Acc: 0.450 Test Loss: 6.032 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.650120973587036
Epoch: 6, Steps: 18 | Train Loss: 1.904 Vali Loss: 4.054 Vali Acc: 0.470 Test Loss: 4.054 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.986958265304565
Epoch: 7, Steps: 18 | Train Loss: 0.677 Vali Loss: 5.484 Vali Acc: 0.520 Test Loss: 5.484 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.00783085823059
Epoch: 8, Steps: 18 | Train Loss: 0.902 Vali Loss: 12.153 Vali Acc: 0.500 Test Loss: 12.153 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.182931900024414
Epoch: 9, Steps: 18 | Train Loss: 1.397 Vali Loss: 14.327 Vali Acc: 0.520 Test Loss: 14.327 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.986568450927734
Epoch: 10, Steps: 18 | Train Loss: 1.956 Vali Loss: 10.804 Vali Acc: 0.580 Test Loss: 10.804 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 12.56194806098938
Epoch: 11, Steps: 18 | Train Loss: 1.757 Vali Loss: 16.894 Vali Acc: 0.500 Test Loss: 16.894 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 5005570
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.699265956878662
Epoch: 1, Steps: 18 | Train Loss: 1.131 Vali Loss: 2.008 Vali Acc: 0.510 Test Loss: 2.008 Test Acc: 0.510
Validation loss decreased (inf --> -0.509980).  Saving model ...
Epoch: 2 cost time: 10.760440349578857
Epoch: 2, Steps: 18 | Train Loss: 1.253 Vali Loss: 1.796 Vali Acc: 0.550 Test Loss: 1.796 Test Acc: 0.550
Validation loss decreased (-0.509980 --> -0.549982).  Saving model ...
Epoch: 3 cost time: 10.834978580474854
Epoch: 3, Steps: 18 | Train Loss: 0.888 Vali Loss: 3.016 Vali Acc: 0.520 Test Loss: 3.016 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.85035228729248
Epoch: 4, Steps: 18 | Train Loss: 1.146 Vali Loss: 2.584 Vali Acc: 0.560 Test Loss: 2.584 Test Acc: 0.560
Validation loss decreased (-0.549982 --> -0.559974).  Saving model ...
Epoch: 5 cost time: 10.467090368270874
Epoch: 5, Steps: 18 | Train Loss: 1.187 Vali Loss: 4.206 Vali Acc: 0.510 Test Loss: 4.206 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.169517517089844
Epoch: 6, Steps: 18 | Train Loss: 1.446 Vali Loss: 9.832 Vali Acc: 0.510 Test Loss: 9.832 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.703906297683716
Epoch: 7, Steps: 18 | Train Loss: 1.874 Vali Loss: 6.663 Vali Acc: 0.460 Test Loss: 6.663 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.912458419799805
Epoch: 8, Steps: 18 | Train Loss: 5.054 Vali Loss: 13.896 Vali Acc: 0.520 Test Loss: 13.896 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.88145661354065
Epoch: 9, Steps: 18 | Train Loss: 1.234 Vali Loss: 7.170 Vali Acc: 0.540 Test Loss: 7.170 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.793332815170288
Epoch: 10, Steps: 18 | Train Loss: 0.769 Vali Loss: 7.415 Vali Acc: 0.490 Test Loss: 7.415 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.759066104888916
Epoch: 11, Steps: 18 | Train Loss: 1.794 Vali Loss: 7.043 Vali Acc: 0.540 Test Loss: 7.043 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.429052829742432
Epoch: 12, Steps: 18 | Train Loss: 1.518 Vali Loss: 11.616 Vali Acc: 0.510 Test Loss: 11.616 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 9.638689994812012
Epoch: 13, Steps: 18 | Train Loss: 1.563 Vali Loss: 21.073 Vali Acc: 0.500 Test Loss: 21.073 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.240312576293945
Epoch: 14, Steps: 18 | Train Loss: 1.396 Vali Loss: 11.585 Vali Acc: 0.540 Test Loss: 11.585 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5005570
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.56943392753601
Epoch: 1, Steps: 18 | Train Loss: 1.136 Vali Loss: 1.555 Vali Acc: 0.500 Test Loss: 1.555 Test Acc: 0.500
Validation loss decreased (inf --> -0.499984).  Saving model ...
Epoch: 2 cost time: 11.044503450393677
Epoch: 2, Steps: 18 | Train Loss: 1.024 Vali Loss: 2.049 Vali Acc: 0.560 Test Loss: 2.049 Test Acc: 0.560
Validation loss decreased (-0.499984 --> -0.559980).  Saving model ...
Epoch: 3 cost time: 10.280922651290894
Epoch: 3, Steps: 18 | Train Loss: 0.862 Vali Loss: 2.258 Vali Acc: 0.500 Test Loss: 2.258 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.360958337783813
Epoch: 4, Steps: 18 | Train Loss: 0.572 Vali Loss: 2.311 Vali Acc: 0.570 Test Loss: 2.311 Test Acc: 0.570
Validation loss decreased (-0.559980 --> -0.569977).  Saving model ...
Epoch: 5 cost time: 10.744537591934204
Epoch: 5, Steps: 18 | Train Loss: 1.715 Vali Loss: 3.977 Vali Acc: 0.590 Test Loss: 3.977 Test Acc: 0.590
Validation loss decreased (-0.569977 --> -0.589960).  Saving model ...
Epoch: 6 cost time: 10.261482238769531
Epoch: 6, Steps: 18 | Train Loss: 1.291 Vali Loss: 3.904 Vali Acc: 0.480 Test Loss: 3.904 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.040655136108398
Epoch: 7, Steps: 18 | Train Loss: 2.484 Vali Loss: 5.274 Vali Acc: 0.550 Test Loss: 5.274 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.869424104690552
Epoch: 8, Steps: 18 | Train Loss: 0.957 Vali Loss: 8.540 Vali Acc: 0.550 Test Loss: 8.540 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.539480209350586
Epoch: 9, Steps: 18 | Train Loss: 2.185 Vali Loss: 15.671 Vali Acc: 0.490 Test Loss: 15.671 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.11871862411499
Epoch: 10, Steps: 18 | Train Loss: 2.670 Vali Loss: 16.493 Vali Acc: 0.510 Test Loss: 16.493 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.111693620681763
Epoch: 11, Steps: 18 | Train Loss: 3.037 Vali Loss: 15.511 Vali Acc: 0.460 Test Loss: 15.511 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.072270154953003
Epoch: 12, Steps: 18 | Train Loss: 1.753 Vali Loss: 14.071 Vali Acc: 0.480 Test Loss: 14.071 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.479785442352295
Epoch: 13, Steps: 18 | Train Loss: 0.909 Vali Loss: 15.858 Vali Acc: 0.540 Test Loss: 15.858 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.742409467697144
Epoch: 14, Steps: 18 | Train Loss: 0.500 Vali Loss: 8.044 Vali Acc: 0.560 Test Loss: 8.044 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.552462100982666
Epoch: 15, Steps: 18 | Train Loss: 0.975 Vali Loss: 10.974 Vali Acc: 0.560 Test Loss: 10.974 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 5005570
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.765461921691895
Epoch: 1, Steps: 18 | Train Loss: 1.170 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 9.02791953086853
Epoch: 2, Steps: 18 | Train Loss: 1.319 Vali Loss: 5.093 Vali Acc: 0.550 Test Loss: 5.093 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549949).  Saving model ...
Epoch: 3 cost time: 9.213403940200806
Epoch: 3, Steps: 18 | Train Loss: 1.397 Vali Loss: 1.953 Vali Acc: 0.590 Test Loss: 1.953 Test Acc: 0.590
Validation loss decreased (-0.549949 --> -0.589980).  Saving model ...
Epoch: 4 cost time: 9.306082725524902
Epoch: 4, Steps: 18 | Train Loss: 2.094 Vali Loss: 4.073 Vali Acc: 0.530 Test Loss: 4.073 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.008771181106567
Epoch: 5, Steps: 18 | Train Loss: 2.052 Vali Loss: 6.014 Vali Acc: 0.440 Test Loss: 6.014 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.693099737167358
Epoch: 6, Steps: 18 | Train Loss: 1.010 Vali Loss: 5.721 Vali Acc: 0.530 Test Loss: 5.721 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.256953239440918
Epoch: 7, Steps: 18 | Train Loss: 2.508 Vali Loss: 7.658 Vali Acc: 0.500 Test Loss: 7.658 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.364778518676758
Epoch: 8, Steps: 18 | Train Loss: 1.747 Vali Loss: 4.843 Vali Acc: 0.470 Test Loss: 4.843 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.912099599838257
Epoch: 9, Steps: 18 | Train Loss: 0.822 Vali Loss: 12.378 Vali Acc: 0.540 Test Loss: 12.378 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.97355031967163
Epoch: 10, Steps: 18 | Train Loss: 1.690 Vali Loss: 7.023 Vali Acc: 0.490 Test Loss: 7.023 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.084024429321289
Epoch: 11, Steps: 18 | Train Loss: 0.612 Vali Loss: 5.667 Vali Acc: 0.520 Test Loss: 5.667 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.152418851852417
Epoch: 12, Steps: 18 | Train Loss: 1.406 Vali Loss: 14.322 Vali Acc: 0.440 Test Loss: 14.322 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.00696349143982
Epoch: 13, Steps: 18 | Train Loss: 0.612 Vali Loss: 13.993 Vali Acc: 0.600 Test Loss: 13.993 Test Acc: 0.600
Validation loss decreased (-0.589980 --> -0.599860).  Saving model ...
Epoch: 14 cost time: 9.307839155197144
Epoch: 14, Steps: 18 | Train Loss: 1.393 Vali Loss: 15.901 Vali Acc: 0.510 Test Loss: 15.901 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.82988977432251
Epoch: 15, Steps: 18 | Train Loss: 2.065 Vali Loss: 16.475 Vali Acc: 0.530 Test Loss: 16.475 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.942808151245117
Epoch: 16, Steps: 18 | Train Loss: 0.835 Vali Loss: 7.759 Vali Acc: 0.540 Test Loss: 7.759 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.017714500427246
Epoch: 17, Steps: 18 | Train Loss: 1.038 Vali Loss: 18.503 Vali Acc: 0.490 Test Loss: 18.503 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.45548415184021
Epoch: 18, Steps: 18 | Train Loss: 0.540 Vali Loss: 14.419 Vali Acc: 0.600 Test Loss: 14.419 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.95449686050415
Epoch: 19, Steps: 18 | Train Loss: 0.681 Vali Loss: 11.324 Vali Acc: 0.540 Test Loss: 11.324 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.289472103118896
Epoch: 20, Steps: 18 | Train Loss: 0.549 Vali Loss: 8.728 Vali Acc: 0.550 Test Loss: 8.728 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.589910507202148
Epoch: 21, Steps: 18 | Train Loss: 0.415 Vali Loss: 11.560 Vali Acc: 0.560 Test Loss: 11.560 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.86381483078003
Epoch: 22, Steps: 18 | Train Loss: 0.361 Vali Loss: 7.149 Vali Acc: 0.530 Test Loss: 7.149 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.995738983154297
Epoch: 23, Steps: 18 | Train Loss: 0.572 Vali Loss: 25.357 Vali Acc: 0.570 Test Loss: 25.357 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5005570
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.748475790023804
Epoch: 1, Steps: 18 | Train Loss: 0.887 Vali Loss: 1.355 Vali Acc: 0.500 Test Loss: 1.355 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 10.363603115081787
Epoch: 2, Steps: 18 | Train Loss: 0.923 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 10.338192224502563
Epoch: 3, Steps: 18 | Train Loss: 0.770 Vali Loss: 0.835 Vali Acc: 0.550 Test Loss: 0.835 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 9.167760610580444
Epoch: 4, Steps: 18 | Train Loss: 1.009 Vali Loss: 0.960 Vali Acc: 0.540 Test Loss: 0.960 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.028447389602661
Epoch: 5, Steps: 18 | Train Loss: 0.828 Vali Loss: 1.493 Vali Acc: 0.520 Test Loss: 1.493 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.379160642623901
Epoch: 6, Steps: 18 | Train Loss: 0.417 Vali Loss: 2.214 Vali Acc: 0.550 Test Loss: 2.214 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.430825471878052
Epoch: 7, Steps: 18 | Train Loss: 1.056 Vali Loss: 1.200 Vali Acc: 0.570 Test Loss: 1.200 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569988).  Saving model ...
Epoch: 8 cost time: 9.780841827392578
Epoch: 8, Steps: 18 | Train Loss: 1.661 Vali Loss: 3.965 Vali Acc: 0.550 Test Loss: 3.965 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.596735954284668
Epoch: 9, Steps: 18 | Train Loss: 0.755 Vali Loss: 2.484 Vali Acc: 0.520 Test Loss: 2.484 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.96937870979309
Epoch: 10, Steps: 18 | Train Loss: 0.439 Vali Loss: 2.690 Vali Acc: 0.550 Test Loss: 2.690 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.663037538528442
Epoch: 11, Steps: 18 | Train Loss: 0.489 Vali Loss: 2.288 Vali Acc: 0.570 Test Loss: 2.288 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.28805422782898
Epoch: 12, Steps: 18 | Train Loss: 0.304 Vali Loss: 4.530 Vali Acc: 0.540 Test Loss: 4.530 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.85282039642334
Epoch: 13, Steps: 18 | Train Loss: 0.336 Vali Loss: 3.903 Vali Acc: 0.490 Test Loss: 3.903 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.490189790725708
Epoch: 14, Steps: 18 | Train Loss: 0.209 Vali Loss: 7.916 Vali Acc: 0.530 Test Loss: 7.916 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.320038080215454
Epoch: 15, Steps: 18 | Train Loss: 0.657 Vali Loss: 3.743 Vali Acc: 0.470 Test Loss: 3.743 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.288438081741333
Epoch: 16, Steps: 18 | Train Loss: 0.586 Vali Loss: 5.901 Vali Acc: 0.500 Test Loss: 5.901 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.440245628356934
Epoch: 17, Steps: 18 | Train Loss: 0.415 Vali Loss: 5.708 Vali Acc: 0.530 Test Loss: 5.708 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5005570
model size : 28.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 38.23830461502075
Epoch: 1, Steps: 18 | Train Loss: 1.171 Vali Loss: 1.803 Vali Acc: 0.550 Test Loss: 1.803 Test Acc: 0.550
Validation loss decreased (inf --> -0.549982).  Saving model ...
Epoch: 2 cost time: 39.40644812583923
Epoch: 2, Steps: 18 | Train Loss: 1.617 Vali Loss: 4.410 Vali Acc: 0.460 Test Loss: 4.410 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 40.04036498069763
Epoch: 3, Steps: 18 | Train Loss: 1.932 Vali Loss: 4.718 Vali Acc: 0.510 Test Loss: 4.718 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 38.0229127407074
Epoch: 4, Steps: 18 | Train Loss: 1.851 Vali Loss: 6.531 Vali Acc: 0.510 Test Loss: 6.531 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 38.38101077079773
Epoch: 5, Steps: 18 | Train Loss: 1.067 Vali Loss: 4.406 Vali Acc: 0.540 Test Loss: 4.406 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 39.7145836353302
Epoch: 6, Steps: 18 | Train Loss: 1.212 Vali Loss: 4.184 Vali Acc: 0.580 Test Loss: 4.184 Test Acc: 0.580
Validation loss decreased (-0.549982 --> -0.579958).  Saving model ...
Epoch: 7 cost time: 39.24684143066406
Epoch: 7, Steps: 18 | Train Loss: 1.354 Vali Loss: 20.697 Vali Acc: 0.480 Test Loss: 20.697 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 39.03962826728821
Epoch: 8, Steps: 18 | Train Loss: 1.289 Vali Loss: 11.067 Vali Acc: 0.510 Test Loss: 11.067 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 43.49692463874817
Epoch: 9, Steps: 18 | Train Loss: 2.129 Vali Loss: 10.420 Vali Acc: 0.550 Test Loss: 10.420 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 43.85405468940735
Epoch: 10, Steps: 18 | Train Loss: 2.616 Vali Loss: 11.072 Vali Acc: 0.550 Test Loss: 11.072 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 44.18920183181763
Epoch: 11, Steps: 18 | Train Loss: 1.517 Vali Loss: 17.257 Vali Acc: 0.500 Test Loss: 17.257 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 47.07584547996521
Epoch: 12, Steps: 18 | Train Loss: 1.829 Vali Loss: 12.966 Vali Acc: 0.530 Test Loss: 12.966 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 44.79812216758728
Epoch: 13, Steps: 18 | Train Loss: 0.472 Vali Loss: 14.445 Vali Acc: 0.500 Test Loss: 14.445 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 49.294291734695435
Epoch: 14, Steps: 18 | Train Loss: 0.885 Vali Loss: 27.656 Vali Acc: 0.500 Test Loss: 27.656 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 49.70493769645691
Epoch: 15, Steps: 18 | Train Loss: 2.041 Vali Loss: 19.768 Vali Acc: 0.530 Test Loss: 19.768 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 49.51727652549744
Epoch: 16, Steps: 18 | Train Loss: 2.921 Vali Loss: 24.790 Vali Acc: 0.520 Test Loss: 24.790 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4612354
model size : 27.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 32.26547336578369
Epoch: 1, Steps: 18 | Train Loss: 1.220 Vali Loss: 1.405 Vali Acc: 0.520 Test Loss: 1.405 Test Acc: 0.520
Validation loss decreased (inf --> -0.519986).  Saving model ...
Epoch: 2 cost time: 30.930780172348022
Epoch: 2, Steps: 18 | Train Loss: 1.574 Vali Loss: 4.659 Vali Acc: 0.500 Test Loss: 4.659 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 33.773749113082886
Epoch: 3, Steps: 18 | Train Loss: 1.639 Vali Loss: 2.658 Vali Acc: 0.640 Test Loss: 2.658 Test Acc: 0.640
Validation loss decreased (-0.519986 --> -0.639973).  Saving model ...
Epoch: 4 cost time: 33.01182675361633
Epoch: 4, Steps: 18 | Train Loss: 1.767 Vali Loss: 7.983 Vali Acc: 0.500 Test Loss: 7.983 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.081552743911743
Epoch: 5, Steps: 18 | Train Loss: 2.034 Vali Loss: 7.334 Vali Acc: 0.500 Test Loss: 7.334 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 32.90218782424927
Epoch: 6, Steps: 18 | Train Loss: 2.143 Vali Loss: 4.685 Vali Acc: 0.520 Test Loss: 4.685 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 33.047974586486816
Epoch: 7, Steps: 18 | Train Loss: 0.814 Vali Loss: 6.800 Vali Acc: 0.540 Test Loss: 6.800 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 32.905664682388306
Epoch: 8, Steps: 18 | Train Loss: 1.673 Vali Loss: 9.429 Vali Acc: 0.520 Test Loss: 9.429 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 33.233906984329224
Epoch: 9, Steps: 18 | Train Loss: 2.925 Vali Loss: 9.793 Vali Acc: 0.540 Test Loss: 9.793 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 37.741694927215576
Epoch: 10, Steps: 18 | Train Loss: 1.275 Vali Loss: 13.954 Vali Acc: 0.520 Test Loss: 13.954 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 38.15667486190796
Epoch: 11, Steps: 18 | Train Loss: 1.295 Vali Loss: 20.430 Vali Acc: 0.500 Test Loss: 20.430 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 36.1154305934906
Epoch: 12, Steps: 18 | Train Loss: 2.639 Vali Loss: 16.088 Vali Acc: 0.540 Test Loss: 16.088 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 41.21135354042053
Epoch: 13, Steps: 18 | Train Loss: 2.823 Vali Loss: 17.364 Vali Acc: 0.480 Test Loss: 17.364 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 4612354
model size : 27.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 25.89462637901306
Epoch: 1, Steps: 18 | Train Loss: 1.068 Vali Loss: 3.546 Vali Acc: 0.510 Test Loss: 3.546 Test Acc: 0.510
Validation loss decreased (inf --> -0.509965).  Saving model ...
Epoch: 2 cost time: 26.81600570678711
Epoch: 2, Steps: 18 | Train Loss: 2.585 Vali Loss: 4.649 Vali Acc: 0.520 Test Loss: 4.649 Test Acc: 0.520
Validation loss decreased (-0.509965 --> -0.519954).  Saving model ...
Epoch: 3 cost time: 26.916256189346313
Epoch: 3, Steps: 18 | Train Loss: 1.411 Vali Loss: 2.112 Vali Acc: 0.600 Test Loss: 2.112 Test Acc: 0.600
Validation loss decreased (-0.519954 --> -0.599979).  Saving model ...
Epoch: 4 cost time: 26.819472312927246
Epoch: 4, Steps: 18 | Train Loss: 2.586 Vali Loss: 18.577 Vali Acc: 0.500 Test Loss: 18.577 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.161068439483643
Epoch: 5, Steps: 18 | Train Loss: 3.495 Vali Loss: 9.900 Vali Acc: 0.520 Test Loss: 9.900 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 28.294133186340332
Epoch: 6, Steps: 18 | Train Loss: 1.944 Vali Loss: 9.866 Vali Acc: 0.570 Test Loss: 9.866 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 27.905333757400513
Epoch: 7, Steps: 18 | Train Loss: 2.356 Vali Loss: 6.528 Vali Acc: 0.570 Test Loss: 6.528 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 28.671865701675415
Epoch: 8, Steps: 18 | Train Loss: 2.880 Vali Loss: 11.060 Vali Acc: 0.510 Test Loss: 11.060 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 26.418028116226196
Epoch: 9, Steps: 18 | Train Loss: 1.074 Vali Loss: 6.886 Vali Acc: 0.500 Test Loss: 6.886 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 30.08177423477173
Epoch: 10, Steps: 18 | Train Loss: 2.158 Vali Loss: 17.426 Vali Acc: 0.520 Test Loss: 17.426 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 31.75567317008972
Epoch: 11, Steps: 18 | Train Loss: 1.168 Vali Loss: 9.743 Vali Acc: 0.530 Test Loss: 9.743 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 31.70181179046631
Epoch: 12, Steps: 18 | Train Loss: 1.714 Vali Loss: 7.419 Vali Acc: 0.550 Test Loss: 7.419 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 28.47434639930725
Epoch: 13, Steps: 18 | Train Loss: 1.414 Vali Loss: 13.783 Vali Acc: 0.490 Test Loss: 13.783 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4612354
model size : 27.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.929233074188232
Epoch: 1, Steps: 18 | Train Loss: 1.029 Vali Loss: 2.675 Vali Acc: 0.500 Test Loss: 2.675 Test Acc: 0.500
Validation loss decreased (inf --> -0.499973).  Saving model ...
Epoch: 2 cost time: 19.01600217819214
Epoch: 2, Steps: 18 | Train Loss: 1.375 Vali Loss: 8.526 Vali Acc: 0.500 Test Loss: 8.526 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.381712198257446
Epoch: 3, Steps: 18 | Train Loss: 2.294 Vali Loss: 8.466 Vali Acc: 0.520 Test Loss: 8.466 Test Acc: 0.520
Validation loss decreased (-0.499973 --> -0.519915).  Saving model ...
Epoch: 4 cost time: 18.538387775421143
Epoch: 4, Steps: 18 | Train Loss: 1.576 Vali Loss: 8.739 Vali Acc: 0.530 Test Loss: 8.739 Test Acc: 0.530
Validation loss decreased (-0.519915 --> -0.529913).  Saving model ...
Epoch: 5 cost time: 17.277021408081055
Epoch: 5, Steps: 18 | Train Loss: 1.423 Vali Loss: 12.393 Vali Acc: 0.500 Test Loss: 12.393 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.748587369918823
Epoch: 6, Steps: 18 | Train Loss: 1.409 Vali Loss: 7.701 Vali Acc: 0.550 Test Loss: 7.701 Test Acc: 0.550
Validation loss decreased (-0.529913 --> -0.549923).  Saving model ...
Epoch: 7 cost time: 17.398974418640137
Epoch: 7, Steps: 18 | Train Loss: 1.333 Vali Loss: 10.873 Vali Acc: 0.510 Test Loss: 10.873 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.32863426208496
Epoch: 8, Steps: 18 | Train Loss: 1.810 Vali Loss: 21.732 Vali Acc: 0.500 Test Loss: 21.732 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.831846475601196
Epoch: 9, Steps: 18 | Train Loss: 4.033 Vali Loss: 6.431 Vali Acc: 0.550 Test Loss: 6.431 Test Acc: 0.550
Validation loss decreased (-0.549923 --> -0.549936).  Saving model ...
Epoch: 10 cost time: 22.811875343322754
Epoch: 10, Steps: 18 | Train Loss: 1.582 Vali Loss: 7.391 Vali Acc: 0.530 Test Loss: 7.391 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.73125696182251
Epoch: 11, Steps: 18 | Train Loss: 3.586 Vali Loss: 15.102 Vali Acc: 0.510 Test Loss: 15.102 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 22.684556484222412
Epoch: 12, Steps: 18 | Train Loss: 3.929 Vali Loss: 17.781 Vali Acc: 0.530 Test Loss: 17.781 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 24.564780235290527
Epoch: 13, Steps: 18 | Train Loss: 2.166 Vali Loss: 13.642 Vali Acc: 0.540 Test Loss: 13.642 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 26.862348794937134
Epoch: 14, Steps: 18 | Train Loss: 3.117 Vali Loss: 22.081 Vali Acc: 0.540 Test Loss: 22.081 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 25.074440479278564
Epoch: 15, Steps: 18 | Train Loss: 1.342 Vali Loss: 13.880 Vali Acc: 0.550 Test Loss: 13.880 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 25.88449764251709
Epoch: 16, Steps: 18 | Train Loss: 1.314 Vali Loss: 22.440 Vali Acc: 0.500 Test Loss: 22.440 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 25.774280548095703
Epoch: 17, Steps: 18 | Train Loss: 0.625 Vali Loss: 13.894 Vali Acc: 0.510 Test Loss: 13.894 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 25.271785497665405
Epoch: 18, Steps: 18 | Train Loss: 1.886 Vali Loss: 30.777 Vali Acc: 0.540 Test Loss: 30.777 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 26.474435091018677
Epoch: 19, Steps: 18 | Train Loss: 0.510 Vali Loss: 23.440 Vali Acc: 0.510 Test Loss: 23.440 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 4612354
model size : 27.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.35888385772705
Epoch: 1, Steps: 18 | Train Loss: 1.122 Vali Loss: 2.122 Vali Acc: 0.510 Test Loss: 2.122 Test Acc: 0.510
Validation loss decreased (inf --> -0.509979).  Saving model ...
Epoch: 2 cost time: 12.81068468093872
Epoch: 2, Steps: 18 | Train Loss: 1.896 Vali Loss: 2.097 Vali Acc: 0.500 Test Loss: 2.097 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.01853609085083
Epoch: 3, Steps: 18 | Train Loss: 1.418 Vali Loss: 5.279 Vali Acc: 0.510 Test Loss: 5.279 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.088677406311035
Epoch: 4, Steps: 18 | Train Loss: 1.387 Vali Loss: 6.713 Vali Acc: 0.520 Test Loss: 6.713 Test Acc: 0.520
Validation loss decreased (-0.509979 --> -0.519933).  Saving model ...
Epoch: 5 cost time: 14.196584939956665
Epoch: 5, Steps: 18 | Train Loss: 3.554 Vali Loss: 6.379 Vali Acc: 0.510 Test Loss: 6.379 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.709192991256714
Epoch: 6, Steps: 18 | Train Loss: 1.971 Vali Loss: 4.766 Vali Acc: 0.590 Test Loss: 4.766 Test Acc: 0.590
Validation loss decreased (-0.519933 --> -0.589952).  Saving model ...
Epoch: 7 cost time: 14.045729160308838
Epoch: 7, Steps: 18 | Train Loss: 0.748 Vali Loss: 7.614 Vali Acc: 0.530 Test Loss: 7.614 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.213132619857788
Epoch: 8, Steps: 18 | Train Loss: 1.624 Vali Loss: 13.387 Vali Acc: 0.480 Test Loss: 13.387 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.643923282623291
Epoch: 9, Steps: 18 | Train Loss: 2.636 Vali Loss: 6.805 Vali Acc: 0.540 Test Loss: 6.805 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.5302734375
Epoch: 10, Steps: 18 | Train Loss: 1.255 Vali Loss: 18.285 Vali Acc: 0.500 Test Loss: 18.285 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 15.001060962677002
Epoch: 11, Steps: 18 | Train Loss: 1.612 Vali Loss: 9.164 Vali Acc: 0.580 Test Loss: 9.164 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.23402237892151
Epoch: 12, Steps: 18 | Train Loss: 1.215 Vali Loss: 11.652 Vali Acc: 0.550 Test Loss: 11.652 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 17.739936590194702
Epoch: 13, Steps: 18 | Train Loss: 3.485 Vali Loss: 7.824 Vali Acc: 0.580 Test Loss: 7.824 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 15.808046102523804
Epoch: 14, Steps: 18 | Train Loss: 0.755 Vali Loss: 18.435 Vali Acc: 0.520 Test Loss: 18.435 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 17.503867149353027
Epoch: 15, Steps: 18 | Train Loss: 1.264 Vali Loss: 12.607 Vali Acc: 0.570 Test Loss: 12.607 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 16.959396362304688
Epoch: 16, Steps: 18 | Train Loss: 1.433 Vali Loss: 14.831 Vali Acc: 0.510 Test Loss: 14.831 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 4612354
model size : 27.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.652939558029175
Epoch: 1, Steps: 18 | Train Loss: 1.258 Vali Loss: 1.868 Vali Acc: 0.560 Test Loss: 1.868 Test Acc: 0.560
Validation loss decreased (inf --> -0.559981).  Saving model ...
Epoch: 2 cost time: 13.145612716674805
Epoch: 2, Steps: 18 | Train Loss: 1.333 Vali Loss: 1.761 Vali Acc: 0.520 Test Loss: 1.761 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.035046100616455
Epoch: 3, Steps: 18 | Train Loss: 1.482 Vali Loss: 5.823 Vali Acc: 0.510 Test Loss: 5.823 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.049616813659668
Epoch: 4, Steps: 18 | Train Loss: 2.073 Vali Loss: 2.972 Vali Acc: 0.510 Test Loss: 2.972 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.863532543182373
Epoch: 5, Steps: 18 | Train Loss: 2.347 Vali Loss: 4.368 Vali Acc: 0.460 Test Loss: 4.368 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.681152582168579
Epoch: 6, Steps: 18 | Train Loss: 0.737 Vali Loss: 7.564 Vali Acc: 0.520 Test Loss: 7.564 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.126587152481079
Epoch: 7, Steps: 18 | Train Loss: 1.749 Vali Loss: 6.245 Vali Acc: 0.510 Test Loss: 6.245 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.666074991226196
Epoch: 8, Steps: 18 | Train Loss: 1.727 Vali Loss: 7.863 Vali Acc: 0.390 Test Loss: 7.863 Test Acc: 0.390
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.574259042739868
Epoch: 9, Steps: 18 | Train Loss: 1.486 Vali Loss: 19.275 Vali Acc: 0.500 Test Loss: 19.275 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.164467573165894
Epoch: 10, Steps: 18 | Train Loss: 1.487 Vali Loss: 15.707 Vali Acc: 0.510 Test Loss: 15.707 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 12.742260456085205
Epoch: 11, Steps: 18 | Train Loss: 1.188 Vali Loss: 10.832 Vali Acc: 0.470 Test Loss: 10.832 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 4612354
model size : 27.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.196803331375122
Epoch: 1, Steps: 18 | Train Loss: 1.093 Vali Loss: 1.409 Vali Acc: 0.500 Test Loss: 1.409 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 10.542661428451538
Epoch: 2, Steps: 18 | Train Loss: 1.125 Vali Loss: 5.718 Vali Acc: 0.510 Test Loss: 5.718 Test Acc: 0.510
Validation loss decreased (-0.499986 --> -0.509943).  Saving model ...
Epoch: 3 cost time: 9.773672819137573
Epoch: 3, Steps: 18 | Train Loss: 1.343 Vali Loss: 4.518 Vali Acc: 0.540 Test Loss: 4.518 Test Acc: 0.540
Validation loss decreased (-0.509943 --> -0.539955).  Saving model ...
Epoch: 4 cost time: 10.644357919692993
Epoch: 4, Steps: 18 | Train Loss: 1.285 Vali Loss: 4.014 Vali Acc: 0.540 Test Loss: 4.014 Test Acc: 0.540
Validation loss decreased (-0.539955 --> -0.539960).  Saving model ...
Epoch: 5 cost time: 9.985555410385132
Epoch: 5, Steps: 18 | Train Loss: 1.308 Vali Loss: 8.862 Vali Acc: 0.500 Test Loss: 8.862 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.585821628570557
Epoch: 6, Steps: 18 | Train Loss: 2.990 Vali Loss: 8.218 Vali Acc: 0.490 Test Loss: 8.218 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.947622299194336
Epoch: 7, Steps: 18 | Train Loss: 1.415 Vali Loss: 6.969 Vali Acc: 0.500 Test Loss: 6.969 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.871815919876099
Epoch: 8, Steps: 18 | Train Loss: 0.682 Vali Loss: 11.529 Vali Acc: 0.540 Test Loss: 11.529 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.534058094024658
Epoch: 9, Steps: 18 | Train Loss: 0.884 Vali Loss: 8.608 Vali Acc: 0.490 Test Loss: 8.608 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.160392045974731
Epoch: 10, Steps: 18 | Train Loss: 1.460 Vali Loss: 14.835 Vali Acc: 0.490 Test Loss: 14.835 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.428383827209473
Epoch: 11, Steps: 18 | Train Loss: 2.447 Vali Loss: 10.135 Vali Acc: 0.560 Test Loss: 10.135 Test Acc: 0.560
Validation loss decreased (-0.539960 --> -0.559899).  Saving model ...
Epoch: 12 cost time: 11.156745433807373
Epoch: 12, Steps: 18 | Train Loss: 1.556 Vali Loss: 9.820 Vali Acc: 0.510 Test Loss: 9.820 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.763415336608887
Epoch: 13, Steps: 18 | Train Loss: 2.626 Vali Loss: 13.318 Vali Acc: 0.540 Test Loss: 13.318 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.331811904907227
Epoch: 14, Steps: 18 | Train Loss: 0.853 Vali Loss: 10.607 Vali Acc: 0.590 Test Loss: 10.607 Test Acc: 0.590
Validation loss decreased (-0.559899 --> -0.589894).  Saving model ...
Epoch: 15 cost time: 10.62111496925354
Epoch: 15, Steps: 18 | Train Loss: 0.510 Vali Loss: 13.912 Vali Acc: 0.510 Test Loss: 13.912 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.694697141647339
Epoch: 16, Steps: 18 | Train Loss: 2.435 Vali Loss: 14.943 Vali Acc: 0.510 Test Loss: 14.943 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.60511040687561
Epoch: 17, Steps: 18 | Train Loss: 0.720 Vali Loss: 16.057 Vali Acc: 0.550 Test Loss: 16.057 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.120275735855103
Epoch: 18, Steps: 18 | Train Loss: 0.455 Vali Loss: 20.216 Vali Acc: 0.520 Test Loss: 20.216 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.561324834823608
Epoch: 19, Steps: 18 | Train Loss: 0.800 Vali Loss: 21.046 Vali Acc: 0.560 Test Loss: 21.046 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 11.637708902359009
Epoch: 20, Steps: 18 | Train Loss: 0.839 Vali Loss: 17.639 Vali Acc: 0.540 Test Loss: 17.639 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.682456970214844
Epoch: 21, Steps: 18 | Train Loss: 0.572 Vali Loss: 16.932 Vali Acc: 0.500 Test Loss: 16.932 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 11.858504295349121
Epoch: 22, Steps: 18 | Train Loss: 1.904 Vali Loss: 37.156 Vali Acc: 0.480 Test Loss: 37.156 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 12.065808057785034
Epoch: 23, Steps: 18 | Train Loss: 2.418 Vali Loss: 23.926 Vali Acc: 0.470 Test Loss: 23.926 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 11.225277662277222
Epoch: 24, Steps: 18 | Train Loss: 2.408 Vali Loss: 28.891 Vali Acc: 0.530 Test Loss: 28.891 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 4612354
model size : 27.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.263319253921509
Epoch: 1, Steps: 18 | Train Loss: 1.223 Vali Loss: 2.676 Vali Acc: 0.500 Test Loss: 2.676 Test Acc: 0.500
Validation loss decreased (inf --> -0.499973).  Saving model ...
Epoch: 2 cost time: 9.475019454956055
Epoch: 2, Steps: 18 | Train Loss: 1.590 Vali Loss: 9.181 Vali Acc: 0.500 Test Loss: 9.181 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.347596168518066
Epoch: 3, Steps: 18 | Train Loss: 1.595 Vali Loss: 3.824 Vali Acc: 0.450 Test Loss: 3.824 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.227238416671753
Epoch: 4, Steps: 18 | Train Loss: 1.472 Vali Loss: 2.925 Vali Acc: 0.550 Test Loss: 2.925 Test Acc: 0.550
Validation loss decreased (-0.499973 --> -0.549971).  Saving model ...
Epoch: 5 cost time: 9.869425296783447
Epoch: 5, Steps: 18 | Train Loss: 2.221 Vali Loss: 6.195 Vali Acc: 0.490 Test Loss: 6.195 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.782689332962036
Epoch: 6, Steps: 18 | Train Loss: 1.600 Vali Loss: 6.701 Vali Acc: 0.500 Test Loss: 6.701 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.306159496307373
Epoch: 7, Steps: 18 | Train Loss: 0.796 Vali Loss: 5.050 Vali Acc: 0.560 Test Loss: 5.050 Test Acc: 0.560
Validation loss decreased (-0.549971 --> -0.559949).  Saving model ...
Epoch: 8 cost time: 9.916000604629517
Epoch: 8, Steps: 18 | Train Loss: 1.381 Vali Loss: 4.947 Vali Acc: 0.520 Test Loss: 4.947 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.899134397506714
Epoch: 9, Steps: 18 | Train Loss: 1.206 Vali Loss: 10.155 Vali Acc: 0.480 Test Loss: 10.155 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.239295244216919
Epoch: 10, Steps: 18 | Train Loss: 1.012 Vali Loss: 6.483 Vali Acc: 0.480 Test Loss: 6.483 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.225757598876953
Epoch: 11, Steps: 18 | Train Loss: 0.504 Vali Loss: 8.249 Vali Acc: 0.480 Test Loss: 8.249 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.756798505783081
Epoch: 12, Steps: 18 | Train Loss: 0.646 Vali Loss: 14.773 Vali Acc: 0.470 Test Loss: 14.773 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.01629090309143
Epoch: 13, Steps: 18 | Train Loss: 2.790 Vali Loss: 11.461 Vali Acc: 0.540 Test Loss: 11.461 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.069424867630005
Epoch: 14, Steps: 18 | Train Loss: 0.753 Vali Loss: 12.361 Vali Acc: 0.520 Test Loss: 12.361 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.23899793624878
Epoch: 15, Steps: 18 | Train Loss: 0.360 Vali Loss: 11.557 Vali Acc: 0.550 Test Loss: 11.557 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.113136053085327
Epoch: 16, Steps: 18 | Train Loss: 0.270 Vali Loss: 9.428 Vali Acc: 0.620 Test Loss: 9.428 Test Acc: 0.620
Validation loss decreased (-0.559949 --> -0.619906).  Saving model ...
Epoch: 17 cost time: 10.377625465393066
Epoch: 17, Steps: 18 | Train Loss: 0.279 Vali Loss: 11.150 Vali Acc: 0.560 Test Loss: 11.150 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.260581254959106
Epoch: 18, Steps: 18 | Train Loss: 0.421 Vali Loss: 19.660 Vali Acc: 0.550 Test Loss: 19.660 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 11.593908548355103
Epoch: 19, Steps: 18 | Train Loss: 0.275 Vali Loss: 10.220 Vali Acc: 0.600 Test Loss: 10.220 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 10.871936798095703
Epoch: 20, Steps: 18 | Train Loss: 0.550 Vali Loss: 11.533 Vali Acc: 0.620 Test Loss: 11.533 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 9.791252613067627
Epoch: 21, Steps: 18 | Train Loss: 0.709 Vali Loss: 13.439 Vali Acc: 0.560 Test Loss: 13.439 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 10.315613269805908
Epoch: 22, Steps: 18 | Train Loss: 2.729 Vali Loss: 36.152 Vali Acc: 0.500 Test Loss: 36.152 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 10.012301921844482
Epoch: 23, Steps: 18 | Train Loss: 4.005 Vali Loss: 23.145 Vali Acc: 0.520 Test Loss: 23.145 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 9.34602427482605
Epoch: 24, Steps: 18 | Train Loss: 1.449 Vali Loss: 16.034 Vali Acc: 0.580 Test Loss: 16.034 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 11.198575496673584
Epoch: 25, Steps: 18 | Train Loss: 0.724 Vali Loss: 19.378 Vali Acc: 0.530 Test Loss: 19.378 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 11.52720046043396
Epoch: 26, Steps: 18 | Train Loss: 0.331 Vali Loss: 27.451 Vali Acc: 0.570 Test Loss: 27.451 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 4612354
model size : 27.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.184829950332642
Epoch: 1, Steps: 18 | Train Loss: 1.206 Vali Loss: 1.976 Vali Acc: 0.500 Test Loss: 1.976 Test Acc: 0.500
Validation loss decreased (inf --> -0.499980).  Saving model ...
Epoch: 2 cost time: 9.569600343704224
Epoch: 2, Steps: 18 | Train Loss: 1.601 Vali Loss: 5.600 Vali Acc: 0.500 Test Loss: 5.600 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.097450017929077
Epoch: 3, Steps: 18 | Train Loss: 1.152 Vali Loss: 2.644 Vali Acc: 0.590 Test Loss: 2.644 Test Acc: 0.590
Validation loss decreased (-0.499980 --> -0.589974).  Saving model ...
Epoch: 4 cost time: 9.394410133361816
Epoch: 4, Steps: 18 | Train Loss: 1.054 Vali Loss: 4.761 Vali Acc: 0.570 Test Loss: 4.761 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.811094284057617
Epoch: 5, Steps: 18 | Train Loss: 1.550 Vali Loss: 4.912 Vali Acc: 0.540 Test Loss: 4.912 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.22767972946167
Epoch: 6, Steps: 18 | Train Loss: 1.636 Vali Loss: 11.371 Vali Acc: 0.500 Test Loss: 11.371 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.672149181365967
Epoch: 7, Steps: 18 | Train Loss: 1.737 Vali Loss: 7.719 Vali Acc: 0.490 Test Loss: 7.719 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.256526470184326
Epoch: 8, Steps: 18 | Train Loss: 1.221 Vali Loss: 11.629 Vali Acc: 0.500 Test Loss: 11.629 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.68796420097351
Epoch: 9, Steps: 18 | Train Loss: 1.610 Vali Loss: 10.633 Vali Acc: 0.540 Test Loss: 10.633 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.123566150665283
Epoch: 10, Steps: 18 | Train Loss: 0.394 Vali Loss: 7.144 Vali Acc: 0.460 Test Loss: 7.144 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.383047580718994
Epoch: 11, Steps: 18 | Train Loss: 0.482 Vali Loss: 4.265 Vali Acc: 0.550 Test Loss: 4.265 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.582263946533203
Epoch: 12, Steps: 18 | Train Loss: 1.118 Vali Loss: 15.310 Vali Acc: 0.420 Test Loss: 15.310 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.946595430374146
Epoch: 13, Steps: 18 | Train Loss: 0.597 Vali Loss: 9.194 Vali Acc: 0.590 Test Loss: 9.194 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 4612354
model size : 27.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.976097583770752
Epoch: 1, Steps: 18 | Train Loss: 0.941 Vali Loss: 0.735 Vali Acc: 0.510 Test Loss: 0.735 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 8.903783321380615
Epoch: 2, Steps: 18 | Train Loss: 1.061 Vali Loss: 2.465 Vali Acc: 0.500 Test Loss: 2.465 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.340665102005005
Epoch: 3, Steps: 18 | Train Loss: 0.421 Vali Loss: 2.191 Vali Acc: 0.510 Test Loss: 2.191 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.119896650314331
Epoch: 4, Steps: 18 | Train Loss: 0.879 Vali Loss: 5.777 Vali Acc: 0.500 Test Loss: 5.777 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.533120155334473
Epoch: 5, Steps: 18 | Train Loss: 1.155 Vali Loss: 3.849 Vali Acc: 0.500 Test Loss: 3.849 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.573915958404541
Epoch: 6, Steps: 18 | Train Loss: 0.725 Vali Loss: 1.676 Vali Acc: 0.540 Test Loss: 1.676 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539983).  Saving model ...
Epoch: 7 cost time: 9.180116891860962
Epoch: 7, Steps: 18 | Train Loss: 0.329 Vali Loss: 2.181 Vali Acc: 0.490 Test Loss: 2.181 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.564562320709229
Epoch: 8, Steps: 18 | Train Loss: 1.288 Vali Loss: 4.251 Vali Acc: 0.520 Test Loss: 4.251 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.641793966293335
Epoch: 9, Steps: 18 | Train Loss: 0.894 Vali Loss: 6.748 Vali Acc: 0.490 Test Loss: 6.748 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.289039611816406
Epoch: 10, Steps: 18 | Train Loss: 0.623 Vali Loss: 2.255 Vali Acc: 0.530 Test Loss: 2.255 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.313220262527466
Epoch: 11, Steps: 18 | Train Loss: 1.113 Vali Loss: 8.717 Vali Acc: 0.500 Test Loss: 8.717 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.052940845489502
Epoch: 12, Steps: 18 | Train Loss: 0.863 Vali Loss: 4.232 Vali Acc: 0.520 Test Loss: 4.232 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.741477489471436
Epoch: 13, Steps: 18 | Train Loss: 0.797 Vali Loss: 11.180 Vali Acc: 0.500 Test Loss: 11.180 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.277196407318115
Epoch: 14, Steps: 18 | Train Loss: 0.483 Vali Loss: 8.701 Vali Acc: 0.500 Test Loss: 8.701 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.437268018722534
Epoch: 15, Steps: 18 | Train Loss: 0.210 Vali Loss: 3.108 Vali Acc: 0.430 Test Loss: 3.108 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.16822862625122
Epoch: 16, Steps: 18 | Train Loss: 0.168 Vali Loss: 5.541 Vali Acc: 0.540 Test Loss: 5.541 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 4612354
model size : 27.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 33.56470489501953
Epoch: 1, Steps: 18 | Train Loss: 1.687 Vali Loss: 2.988 Vali Acc: 0.510 Test Loss: 2.988 Test Acc: 0.510
Validation loss decreased (inf --> -0.509970).  Saving model ...
Epoch: 2 cost time: 38.17090964317322
Epoch: 2, Steps: 18 | Train Loss: 1.307 Vali Loss: 3.858 Vali Acc: 0.550 Test Loss: 3.858 Test Acc: 0.550
Validation loss decreased (-0.509970 --> -0.549961).  Saving model ...
Epoch: 3 cost time: 39.47765278816223
Epoch: 3, Steps: 18 | Train Loss: 2.558 Vali Loss: 6.133 Vali Acc: 0.580 Test Loss: 6.133 Test Acc: 0.580
Validation loss decreased (-0.549961 --> -0.579939).  Saving model ...
Epoch: 4 cost time: 35.55860090255737
Epoch: 4, Steps: 18 | Train Loss: 3.182 Vali Loss: 10.687 Vali Acc: 0.510 Test Loss: 10.687 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 38.853291511535645
Epoch: 5, Steps: 18 | Train Loss: 3.520 Vali Loss: 15.595 Vali Acc: 0.500 Test Loss: 15.595 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 39.69074773788452
Epoch: 6, Steps: 18 | Train Loss: 1.876 Vali Loss: 4.833 Vali Acc: 0.500 Test Loss: 4.833 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 36.742220401763916
Epoch: 7, Steps: 18 | Train Loss: 1.707 Vali Loss: 14.686 Vali Acc: 0.500 Test Loss: 14.686 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 41.08021688461304
Epoch: 8, Steps: 18 | Train Loss: 0.938 Vali Loss: 9.571 Vali Acc: 0.460 Test Loss: 9.571 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 42.34317898750305
Epoch: 9, Steps: 18 | Train Loss: 1.521 Vali Loss: 9.768 Vali Acc: 0.490 Test Loss: 9.768 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 40.28770971298218
Epoch: 10, Steps: 18 | Train Loss: 1.237 Vali Loss: 8.132 Vali Acc: 0.530 Test Loss: 8.132 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 37.580851554870605
Epoch: 11, Steps: 18 | Train Loss: 1.810 Vali Loss: 9.942 Vali Acc: 0.450 Test Loss: 9.942 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 36.83340239524841
Epoch: 12, Steps: 18 | Train Loss: 1.394 Vali Loss: 14.654 Vali Acc: 0.530 Test Loss: 14.654 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 50.14101266860962
Epoch: 13, Steps: 18 | Train Loss: 1.940 Vali Loss: 13.985 Vali Acc: 0.480 Test Loss: 13.985 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4415746
model size : 26.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 32.77155518531799
Epoch: 1, Steps: 18 | Train Loss: 1.527 Vali Loss: 4.448 Vali Acc: 0.500 Test Loss: 4.448 Test Acc: 0.500
Validation loss decreased (inf --> -0.499956).  Saving model ...
Epoch: 2 cost time: 33.15821433067322
Epoch: 2, Steps: 18 | Train Loss: 1.438 Vali Loss: 2.310 Vali Acc: 0.640 Test Loss: 2.310 Test Acc: 0.640
Validation loss decreased (-0.499956 --> -0.639977).  Saving model ...
Epoch: 3 cost time: 31.66233253479004
Epoch: 3, Steps: 18 | Train Loss: 1.582 Vali Loss: 3.229 Vali Acc: 0.530 Test Loss: 3.229 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 29.794959783554077
Epoch: 4, Steps: 18 | Train Loss: 1.598 Vali Loss: 7.773 Vali Acc: 0.490 Test Loss: 7.773 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 32.743486166000366
Epoch: 5, Steps: 18 | Train Loss: 1.992 Vali Loss: 8.559 Vali Acc: 0.530 Test Loss: 8.559 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 32.644967555999756
Epoch: 6, Steps: 18 | Train Loss: 1.307 Vali Loss: 4.712 Vali Acc: 0.540 Test Loss: 4.712 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 31.91170883178711
Epoch: 7, Steps: 18 | Train Loss: 2.006 Vali Loss: 15.433 Vali Acc: 0.510 Test Loss: 15.433 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 32.41878700256348
Epoch: 8, Steps: 18 | Train Loss: 2.293 Vali Loss: 11.791 Vali Acc: 0.500 Test Loss: 11.791 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 33.59404969215393
Epoch: 9, Steps: 18 | Train Loss: 1.808 Vali Loss: 9.422 Vali Acc: 0.500 Test Loss: 9.422 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 38.5193817615509
Epoch: 10, Steps: 18 | Train Loss: 2.412 Vali Loss: 12.415 Vali Acc: 0.530 Test Loss: 12.415 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 34.04927206039429
Epoch: 11, Steps: 18 | Train Loss: 1.354 Vali Loss: 11.326 Vali Acc: 0.490 Test Loss: 11.326 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 39.32441186904907
Epoch: 12, Steps: 18 | Train Loss: 1.810 Vali Loss: 8.703 Vali Acc: 0.550 Test Loss: 8.703 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 4415746
model size : 26.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.712345361709595
Epoch: 1, Steps: 18 | Train Loss: 1.629 Vali Loss: 3.275 Vali Acc: 0.500 Test Loss: 3.275 Test Acc: 0.500
Validation loss decreased (inf --> -0.499967).  Saving model ...
Epoch: 2 cost time: 25.580409049987793
Epoch: 2, Steps: 18 | Train Loss: 2.202 Vali Loss: 4.605 Vali Acc: 0.540 Test Loss: 4.605 Test Acc: 0.540
Validation loss decreased (-0.499967 --> -0.539954).  Saving model ...
Epoch: 3 cost time: 25.780298471450806
Epoch: 3, Steps: 18 | Train Loss: 3.453 Vali Loss: 11.219 Vali Acc: 0.500 Test Loss: 11.219 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.368000030517578
Epoch: 4, Steps: 18 | Train Loss: 1.735 Vali Loss: 6.924 Vali Acc: 0.540 Test Loss: 6.924 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 26.989656448364258
Epoch: 5, Steps: 18 | Train Loss: 2.694 Vali Loss: 6.053 Vali Acc: 0.560 Test Loss: 6.053 Test Acc: 0.560
Validation loss decreased (-0.539954 --> -0.559939).  Saving model ...
Epoch: 6 cost time: 24.425906896591187
Epoch: 6, Steps: 18 | Train Loss: 4.019 Vali Loss: 9.158 Vali Acc: 0.520 Test Loss: 9.158 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 27.034140586853027
Epoch: 7, Steps: 18 | Train Loss: 2.665 Vali Loss: 14.478 Vali Acc: 0.510 Test Loss: 14.478 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 27.001440286636353
Epoch: 8, Steps: 18 | Train Loss: 1.834 Vali Loss: 17.192 Vali Acc: 0.500 Test Loss: 17.192 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 31.533339262008667
Epoch: 9, Steps: 18 | Train Loss: 4.295 Vali Loss: 7.940 Vali Acc: 0.530 Test Loss: 7.940 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 28.765946865081787
Epoch: 10, Steps: 18 | Train Loss: 1.323 Vali Loss: 12.288 Vali Acc: 0.560 Test Loss: 12.288 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 31.010497093200684
Epoch: 11, Steps: 18 | Train Loss: 2.022 Vali Loss: 20.751 Vali Acc: 0.510 Test Loss: 20.751 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 33.320556640625
Epoch: 12, Steps: 18 | Train Loss: 1.185 Vali Loss: 8.788 Vali Acc: 0.590 Test Loss: 8.788 Test Acc: 0.590
Validation loss decreased (-0.559939 --> -0.589912).  Saving model ...
Epoch: 13 cost time: 31.63420057296753
Epoch: 13, Steps: 18 | Train Loss: 1.337 Vali Loss: 10.901 Vali Acc: 0.530 Test Loss: 10.901 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 29.965007543563843
Epoch: 14, Steps: 18 | Train Loss: 1.609 Vali Loss: 10.431 Vali Acc: 0.510 Test Loss: 10.431 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 34.61161184310913
Epoch: 15, Steps: 18 | Train Loss: 0.535 Vali Loss: 19.024 Vali Acc: 0.510 Test Loss: 19.024 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 34.334858655929565
Epoch: 16, Steps: 18 | Train Loss: 0.866 Vali Loss: 16.993 Vali Acc: 0.550 Test Loss: 16.993 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 32.70995020866394
Epoch: 17, Steps: 18 | Train Loss: 1.075 Vali Loss: 30.708 Vali Acc: 0.500 Test Loss: 30.708 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 33.83947253227234
Epoch: 18, Steps: 18 | Train Loss: 0.959 Vali Loss: 14.062 Vali Acc: 0.500 Test Loss: 14.062 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 34.90910029411316
Epoch: 19, Steps: 18 | Train Loss: 1.872 Vali Loss: 32.734 Vali Acc: 0.530 Test Loss: 32.734 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 36.008227586746216
Epoch: 20, Steps: 18 | Train Loss: 0.847 Vali Loss: 15.305 Vali Acc: 0.490 Test Loss: 15.305 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 33.07492804527283
Epoch: 21, Steps: 18 | Train Loss: 0.857 Vali Loss: 12.069 Vali Acc: 0.510 Test Loss: 12.069 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 35.994892835617065
Epoch: 22, Steps: 18 | Train Loss: 0.619 Vali Loss: 16.458 Vali Acc: 0.600 Test Loss: 16.458 Test Acc: 0.600
Validation loss decreased (-0.589912 --> -0.599835).  Saving model ...
Epoch: 23 cost time: 34.440146684646606
Epoch: 23, Steps: 18 | Train Loss: 4.197 Vali Loss: 33.123 Vali Acc: 0.520 Test Loss: 33.123 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 34.1523699760437
Epoch: 24, Steps: 18 | Train Loss: 1.433 Vali Loss: 27.474 Vali Acc: 0.480 Test Loss: 27.474 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 34.39114308357239
Epoch: 25, Steps: 18 | Train Loss: 1.385 Vali Loss: 23.126 Vali Acc: 0.590 Test Loss: 23.126 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 36.487128257751465
Epoch: 26, Steps: 18 | Train Loss: 1.437 Vali Loss: 25.706 Vali Acc: 0.510 Test Loss: 25.706 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 34.79518127441406
Epoch: 27, Steps: 18 | Train Loss: 2.492 Vali Loss: 19.334 Vali Acc: 0.520 Test Loss: 19.334 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 31.36979579925537
Epoch: 28, Steps: 18 | Train Loss: 0.668 Vali Loss: 29.797 Vali Acc: 0.550 Test Loss: 29.797 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 35.11084008216858
Epoch: 29, Steps: 18 | Train Loss: 0.632 Vali Loss: 21.061 Vali Acc: 0.550 Test Loss: 21.061 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 35.93195462226868
Epoch: 30, Steps: 18 | Train Loss: 0.560 Vali Loss: 30.470 Vali Acc: 0.480 Test Loss: 30.470 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 33.596248149871826
Epoch: 31, Steps: 18 | Train Loss: 1.521 Vali Loss: 23.810 Vali Acc: 0.490 Test Loss: 23.810 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 32.59560990333557
Epoch: 32, Steps: 18 | Train Loss: 1.696 Vali Loss: 27.384 Vali Acc: 0.550 Test Loss: 27.384 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4415746
model size : 26.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.502439737319946
Epoch: 1, Steps: 18 | Train Loss: 1.593 Vali Loss: 2.565 Vali Acc: 0.510 Test Loss: 2.565 Test Acc: 0.510
Validation loss decreased (inf --> -0.509974).  Saving model ...
Epoch: 2 cost time: 20.743780374526978
Epoch: 2, Steps: 18 | Train Loss: 1.476 Vali Loss: 1.727 Vali Acc: 0.540 Test Loss: 1.727 Test Acc: 0.540
Validation loss decreased (-0.509974 --> -0.539983).  Saving model ...
Epoch: 3 cost time: 17.915342807769775
Epoch: 3, Steps: 18 | Train Loss: 1.724 Vali Loss: 3.513 Vali Acc: 0.520 Test Loss: 3.513 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.345961809158325
Epoch: 4, Steps: 18 | Train Loss: 2.200 Vali Loss: 3.789 Vali Acc: 0.560 Test Loss: 3.789 Test Acc: 0.560
Validation loss decreased (-0.539983 --> -0.559962).  Saving model ...
Epoch: 5 cost time: 19.53521466255188
Epoch: 5, Steps: 18 | Train Loss: 2.383 Vali Loss: 10.066 Vali Acc: 0.530 Test Loss: 10.066 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.032334804534912
Epoch: 6, Steps: 18 | Train Loss: 4.559 Vali Loss: 5.774 Vali Acc: 0.470 Test Loss: 5.774 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.41933250427246
Epoch: 7, Steps: 18 | Train Loss: 2.458 Vali Loss: 15.736 Vali Acc: 0.480 Test Loss: 15.736 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 21.397483587265015
Epoch: 8, Steps: 18 | Train Loss: 3.587 Vali Loss: 5.452 Vali Acc: 0.550 Test Loss: 5.452 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 20.23810839653015
Epoch: 9, Steps: 18 | Train Loss: 1.729 Vali Loss: 9.587 Vali Acc: 0.530 Test Loss: 9.587 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 20.968761205673218
Epoch: 10, Steps: 18 | Train Loss: 0.899 Vali Loss: 10.067 Vali Acc: 0.500 Test Loss: 10.067 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 21.979336738586426
Epoch: 11, Steps: 18 | Train Loss: 1.392 Vali Loss: 10.662 Vali Acc: 0.490 Test Loss: 10.662 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 24.540674209594727
Epoch: 12, Steps: 18 | Train Loss: 1.665 Vali Loss: 12.699 Vali Acc: 0.520 Test Loss: 12.699 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 22.494653463363647
Epoch: 13, Steps: 18 | Train Loss: 1.172 Vali Loss: 15.717 Vali Acc: 0.490 Test Loss: 15.717 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 23.084421396255493
Epoch: 14, Steps: 18 | Train Loss: 0.889 Vali Loss: 10.777 Vali Acc: 0.540 Test Loss: 10.777 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 4415746
model size : 26.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.956352233886719
Epoch: 1, Steps: 18 | Train Loss: 1.704 Vali Loss: 1.379 Vali Acc: 0.480 Test Loss: 1.379 Test Acc: 0.480
Validation loss decreased (inf --> -0.479986).  Saving model ...
Epoch: 2 cost time: 15.054909467697144
Epoch: 2, Steps: 18 | Train Loss: 1.551 Vali Loss: 2.626 Vali Acc: 0.580 Test Loss: 2.626 Test Acc: 0.580
Validation loss decreased (-0.479986 --> -0.579974).  Saving model ...
Epoch: 3 cost time: 14.859981298446655
Epoch: 3, Steps: 18 | Train Loss: 1.279 Vali Loss: 4.054 Vali Acc: 0.550 Test Loss: 4.054 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.431892395019531
Epoch: 4, Steps: 18 | Train Loss: 1.799 Vali Loss: 1.648 Vali Acc: 0.600 Test Loss: 1.648 Test Acc: 0.600
Validation loss decreased (-0.579974 --> -0.599984).  Saving model ...
Epoch: 5 cost time: 15.50089430809021
Epoch: 5, Steps: 18 | Train Loss: 0.927 Vali Loss: 6.983 Vali Acc: 0.490 Test Loss: 6.983 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.174601554870605
Epoch: 6, Steps: 18 | Train Loss: 0.894 Vali Loss: 4.304 Vali Acc: 0.560 Test Loss: 4.304 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.877606630325317
Epoch: 7, Steps: 18 | Train Loss: 0.824 Vali Loss: 5.651 Vali Acc: 0.530 Test Loss: 5.651 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.76528024673462
Epoch: 8, Steps: 18 | Train Loss: 1.002 Vali Loss: 4.935 Vali Acc: 0.580 Test Loss: 4.935 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 15.5126371383667
Epoch: 9, Steps: 18 | Train Loss: 1.412 Vali Loss: 8.511 Vali Acc: 0.550 Test Loss: 8.511 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 15.682297706604004
Epoch: 10, Steps: 18 | Train Loss: 4.241 Vali Loss: 10.802 Vali Acc: 0.540 Test Loss: 10.802 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 16.49755597114563
Epoch: 11, Steps: 18 | Train Loss: 3.391 Vali Loss: 12.344 Vali Acc: 0.560 Test Loss: 12.344 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 16.12006187438965
Epoch: 12, Steps: 18 | Train Loss: 1.903 Vali Loss: 14.893 Vali Acc: 0.460 Test Loss: 14.893 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 15.50885272026062
Epoch: 13, Steps: 18 | Train Loss: 1.468 Vali Loss: 9.820 Vali Acc: 0.490 Test Loss: 9.820 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 15.264559745788574
Epoch: 14, Steps: 18 | Train Loss: 1.694 Vali Loss: 18.837 Vali Acc: 0.530 Test Loss: 18.837 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4415746
model size : 26.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.732036590576172
Epoch: 1, Steps: 18 | Train Loss: 1.259 Vali Loss: 2.437 Vali Acc: 0.480 Test Loss: 2.437 Test Acc: 0.480
Validation loss decreased (inf --> -0.479976).  Saving model ...
Epoch: 2 cost time: 9.391440629959106
Epoch: 2, Steps: 18 | Train Loss: 1.141 Vali Loss: 1.719 Vali Acc: 0.580 Test Loss: 1.719 Test Acc: 0.580
Validation loss decreased (-0.479976 --> -0.579983).  Saving model ...
Epoch: 3 cost time: 9.70290470123291
Epoch: 3, Steps: 18 | Train Loss: 1.167 Vali Loss: 5.494 Vali Acc: 0.510 Test Loss: 5.494 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.702247858047485
Epoch: 4, Steps: 18 | Train Loss: 1.336 Vali Loss: 3.493 Vali Acc: 0.500 Test Loss: 3.493 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.335305213928223
Epoch: 5, Steps: 18 | Train Loss: 2.007 Vali Loss: 4.518 Vali Acc: 0.540 Test Loss: 4.518 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.865741968154907
Epoch: 6, Steps: 18 | Train Loss: 1.629 Vali Loss: 3.565 Vali Acc: 0.500 Test Loss: 3.565 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.548013687133789
Epoch: 7, Steps: 18 | Train Loss: 2.145 Vali Loss: 13.790 Vali Acc: 0.510 Test Loss: 13.790 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.494168043136597
Epoch: 8, Steps: 18 | Train Loss: 2.317 Vali Loss: 19.593 Vali Acc: 0.510 Test Loss: 19.593 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.78771424293518
Epoch: 9, Steps: 18 | Train Loss: 2.484 Vali Loss: 6.826 Vali Acc: 0.500 Test Loss: 6.826 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.711275577545166
Epoch: 10, Steps: 18 | Train Loss: 0.915 Vali Loss: 8.495 Vali Acc: 0.470 Test Loss: 8.495 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.043259143829346
Epoch: 11, Steps: 18 | Train Loss: 0.972 Vali Loss: 11.061 Vali Acc: 0.510 Test Loss: 11.061 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 11.2317373752594
Epoch: 12, Steps: 18 | Train Loss: 1.192 Vali Loss: 21.954 Vali Acc: 0.510 Test Loss: 21.954 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4415746
model size : 26.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.456687688827515
Epoch: 1, Steps: 18 | Train Loss: 1.293 Vali Loss: 1.741 Vali Acc: 0.500 Test Loss: 1.741 Test Acc: 0.500
Validation loss decreased (inf --> -0.499983).  Saving model ...
Epoch: 2 cost time: 10.638895750045776
Epoch: 2, Steps: 18 | Train Loss: 1.425 Vali Loss: 1.702 Vali Acc: 0.540 Test Loss: 1.702 Test Acc: 0.540
Validation loss decreased (-0.499983 --> -0.539983).  Saving model ...
Epoch: 3 cost time: 10.887815237045288
Epoch: 3, Steps: 18 | Train Loss: 0.889 Vali Loss: 2.199 Vali Acc: 0.560 Test Loss: 2.199 Test Acc: 0.560
Validation loss decreased (-0.539983 --> -0.559978).  Saving model ...
Epoch: 4 cost time: 10.581505060195923
Epoch: 4, Steps: 18 | Train Loss: 1.491 Vali Loss: 3.458 Vali Acc: 0.500 Test Loss: 3.458 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.405736923217773
Epoch: 5, Steps: 18 | Train Loss: 1.720 Vali Loss: 6.042 Vali Acc: 0.480 Test Loss: 6.042 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.86984634399414
Epoch: 6, Steps: 18 | Train Loss: 1.302 Vali Loss: 6.637 Vali Acc: 0.500 Test Loss: 6.637 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.77985954284668
Epoch: 7, Steps: 18 | Train Loss: 1.561 Vali Loss: 8.226 Vali Acc: 0.460 Test Loss: 8.226 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.180002927780151
Epoch: 8, Steps: 18 | Train Loss: 0.935 Vali Loss: 6.447 Vali Acc: 0.530 Test Loss: 6.447 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.994062185287476
Epoch: 9, Steps: 18 | Train Loss: 1.382 Vali Loss: 12.240 Vali Acc: 0.490 Test Loss: 12.240 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.771047592163086
Epoch: 10, Steps: 18 | Train Loss: 0.805 Vali Loss: 11.056 Vali Acc: 0.510 Test Loss: 11.056 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.875300884246826
Epoch: 11, Steps: 18 | Train Loss: 1.356 Vali Loss: 14.795 Vali Acc: 0.490 Test Loss: 14.795 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 11.061271667480469
Epoch: 12, Steps: 18 | Train Loss: 2.897 Vali Loss: 25.315 Vali Acc: 0.490 Test Loss: 25.315 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.837260007858276
Epoch: 13, Steps: 18 | Train Loss: 2.411 Vali Loss: 13.415 Vali Acc: 0.500 Test Loss: 13.415 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 4415746
model size : 26.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.345777750015259
Epoch: 1, Steps: 18 | Train Loss: 1.258 Vali Loss: 1.954 Vali Acc: 0.490 Test Loss: 1.954 Test Acc: 0.490
Validation loss decreased (inf --> -0.489980).  Saving model ...
Epoch: 2 cost time: 9.63469672203064
Epoch: 2, Steps: 18 | Train Loss: 0.900 Vali Loss: 4.044 Vali Acc: 0.540 Test Loss: 4.044 Test Acc: 0.540
Validation loss decreased (-0.489980 --> -0.539960).  Saving model ...
Epoch: 3 cost time: 10.598724126815796
Epoch: 3, Steps: 18 | Train Loss: 1.026 Vali Loss: 2.783 Vali Acc: 0.560 Test Loss: 2.783 Test Acc: 0.560
Validation loss decreased (-0.539960 --> -0.559972).  Saving model ...
Epoch: 4 cost time: 9.782337427139282
Epoch: 4, Steps: 18 | Train Loss: 0.823 Vali Loss: 3.142 Vali Acc: 0.510 Test Loss: 3.142 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.981857061386108
Epoch: 5, Steps: 18 | Train Loss: 1.120 Vali Loss: 3.534 Vali Acc: 0.550 Test Loss: 3.534 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.72957181930542
Epoch: 6, Steps: 18 | Train Loss: 2.289 Vali Loss: 5.326 Vali Acc: 0.540 Test Loss: 5.326 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.78261399269104
Epoch: 7, Steps: 18 | Train Loss: 1.534 Vali Loss: 5.830 Vali Acc: 0.480 Test Loss: 5.830 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.828234672546387
Epoch: 8, Steps: 18 | Train Loss: 1.535 Vali Loss: 5.344 Vali Acc: 0.610 Test Loss: 5.344 Test Acc: 0.610
Validation loss decreased (-0.559972 --> -0.609947).  Saving model ...
Epoch: 9 cost time: 10.399474143981934
Epoch: 9, Steps: 18 | Train Loss: 1.007 Vali Loss: 9.341 Vali Acc: 0.580 Test Loss: 9.341 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.636255502700806
Epoch: 10, Steps: 18 | Train Loss: 1.568 Vali Loss: 9.836 Vali Acc: 0.530 Test Loss: 9.836 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.089122533798218
Epoch: 11, Steps: 18 | Train Loss: 2.115 Vali Loss: 11.085 Vali Acc: 0.550 Test Loss: 11.085 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.178215265274048
Epoch: 12, Steps: 18 | Train Loss: 0.811 Vali Loss: 9.477 Vali Acc: 0.600 Test Loss: 9.477 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.945639371871948
Epoch: 13, Steps: 18 | Train Loss: 0.777 Vali Loss: 13.045 Vali Acc: 0.500 Test Loss: 13.045 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.010715007781982
Epoch: 14, Steps: 18 | Train Loss: 0.334 Vali Loss: 14.122 Vali Acc: 0.500 Test Loss: 14.122 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.727112054824829
Epoch: 15, Steps: 18 | Train Loss: 1.073 Vali Loss: 15.556 Vali Acc: 0.530 Test Loss: 15.556 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.862403631210327
Epoch: 16, Steps: 18 | Train Loss: 0.309 Vali Loss: 9.713 Vali Acc: 0.550 Test Loss: 9.713 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.457456827163696
Epoch: 17, Steps: 18 | Train Loss: 0.543 Vali Loss: 16.277 Vali Acc: 0.520 Test Loss: 16.277 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.397205114364624
Epoch: 18, Steps: 18 | Train Loss: 2.084 Vali Loss: 15.328 Vali Acc: 0.500 Test Loss: 15.328 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 4415746
model size : 26.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.630685091018677
Epoch: 1, Steps: 18 | Train Loss: 1.199 Vali Loss: 2.196 Vali Acc: 0.500 Test Loss: 2.196 Test Acc: 0.500
Validation loss decreased (inf --> -0.499978).  Saving model ...
Epoch: 2 cost time: 9.769311428070068
Epoch: 2, Steps: 18 | Train Loss: 1.176 Vali Loss: 3.355 Vali Acc: 0.490 Test Loss: 3.355 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.455775499343872
Epoch: 3, Steps: 18 | Train Loss: 1.245 Vali Loss: 4.581 Vali Acc: 0.530 Test Loss: 4.581 Test Acc: 0.530
Validation loss decreased (-0.499978 --> -0.529954).  Saving model ...
Epoch: 4 cost time: 8.406935691833496
Epoch: 4, Steps: 18 | Train Loss: 1.378 Vali Loss: 5.438 Vali Acc: 0.400 Test Loss: 5.438 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.203351974487305
Epoch: 5, Steps: 18 | Train Loss: 1.948 Vali Loss: 9.742 Vali Acc: 0.560 Test Loss: 9.742 Test Acc: 0.560
Validation loss decreased (-0.529954 --> -0.559903).  Saving model ...
Epoch: 6 cost time: 9.256224632263184
Epoch: 6, Steps: 18 | Train Loss: 2.047 Vali Loss: 4.510 Vali Acc: 0.410 Test Loss: 4.510 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.319300413131714
Epoch: 7, Steps: 18 | Train Loss: 0.653 Vali Loss: 6.577 Vali Acc: 0.580 Test Loss: 6.577 Test Acc: 0.580
Validation loss decreased (-0.559903 --> -0.579934).  Saving model ...
Epoch: 8 cost time: 9.833600282669067
Epoch: 8, Steps: 18 | Train Loss: 1.182 Vali Loss: 5.522 Vali Acc: 0.490 Test Loss: 5.522 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.279222249984741
Epoch: 9, Steps: 18 | Train Loss: 0.969 Vali Loss: 3.770 Vali Acc: 0.560 Test Loss: 3.770 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.400915145874023
Epoch: 10, Steps: 18 | Train Loss: 1.476 Vali Loss: 4.055 Vali Acc: 0.490 Test Loss: 4.055 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.33116602897644
Epoch: 11, Steps: 18 | Train Loss: 2.045 Vali Loss: 7.339 Vali Acc: 0.490 Test Loss: 7.339 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.921897411346436
Epoch: 12, Steps: 18 | Train Loss: 0.428 Vali Loss: 14.547 Vali Acc: 0.460 Test Loss: 14.547 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.449609518051147
Epoch: 13, Steps: 18 | Train Loss: 0.559 Vali Loss: 12.462 Vali Acc: 0.570 Test Loss: 12.462 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.749094247817993
Epoch: 14, Steps: 18 | Train Loss: 1.195 Vali Loss: 8.977 Vali Acc: 0.490 Test Loss: 8.977 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.889876127243042
Epoch: 15, Steps: 18 | Train Loss: 0.429 Vali Loss: 5.744 Vali Acc: 0.560 Test Loss: 5.744 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.93626856803894
Epoch: 16, Steps: 18 | Train Loss: 1.755 Vali Loss: 16.529 Vali Acc: 0.600 Test Loss: 16.529 Test Acc: 0.600
Validation loss decreased (-0.579934 --> -0.599835).  Saving model ...
Epoch: 17 cost time: 9.261465787887573
Epoch: 17, Steps: 18 | Train Loss: 1.112 Vali Loss: 13.986 Vali Acc: 0.400 Test Loss: 13.986 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.821053981781006
Epoch: 18, Steps: 18 | Train Loss: 0.862 Vali Loss: 9.848 Vali Acc: 0.560 Test Loss: 9.848 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.875801801681519
Epoch: 19, Steps: 18 | Train Loss: 0.367 Vali Loss: 17.633 Vali Acc: 0.410 Test Loss: 17.633 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 9.851671934127808
Epoch: 20, Steps: 18 | Train Loss: 0.252 Vali Loss: 9.135 Vali Acc: 0.500 Test Loss: 9.135 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.11556363105774
Epoch: 21, Steps: 18 | Train Loss: 0.317 Vali Loss: 18.554 Vali Acc: 0.480 Test Loss: 18.554 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 9.857661485671997
Epoch: 22, Steps: 18 | Train Loss: 0.339 Vali Loss: 14.168 Vali Acc: 0.540 Test Loss: 14.168 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 9.680196046829224
Epoch: 23, Steps: 18 | Train Loss: 1.175 Vali Loss: 20.332 Vali Acc: 0.440 Test Loss: 20.332 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 10.422600269317627
Epoch: 24, Steps: 18 | Train Loss: 0.819 Vali Loss: 9.630 Vali Acc: 0.580 Test Loss: 9.630 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 9.19649624824524
Epoch: 25, Steps: 18 | Train Loss: 0.708 Vali Loss: 29.694 Vali Acc: 0.500 Test Loss: 29.694 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 8.977415800094604
Epoch: 26, Steps: 18 | Train Loss: 1.378 Vali Loss: 17.890 Vali Acc: 0.490 Test Loss: 17.890 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4415746
model size : 26.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.426114082336426
Epoch: 1, Steps: 18 | Train Loss: 1.110 Vali Loss: 2.837 Vali Acc: 0.500 Test Loss: 2.837 Test Acc: 0.500
Validation loss decreased (inf --> -0.499972).  Saving model ...
Epoch: 2 cost time: 9.533641338348389
Epoch: 2, Steps: 18 | Train Loss: 1.002 Vali Loss: 0.874 Vali Acc: 0.500 Test Loss: 0.874 Test Acc: 0.500
Validation loss decreased (-0.499972 --> -0.499991).  Saving model ...
Epoch: 3 cost time: 10.005959033966064
Epoch: 3, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.784 Vali Acc: 0.560 Test Loss: 0.784 Test Acc: 0.560
Validation loss decreased (-0.499991 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 9.70160722732544
Epoch: 4, Steps: 18 | Train Loss: 0.454 Vali Loss: 0.865 Vali Acc: 0.550 Test Loss: 0.865 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.918835639953613
Epoch: 5, Steps: 18 | Train Loss: 0.598 Vali Loss: 1.365 Vali Acc: 0.610 Test Loss: 1.365 Test Acc: 0.610
Validation loss decreased (-0.559992 --> -0.609986).  Saving model ...
Epoch: 6 cost time: 9.8216392993927
Epoch: 6, Steps: 18 | Train Loss: 0.772 Vali Loss: 1.232 Vali Acc: 0.600 Test Loss: 1.232 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.920969009399414
Epoch: 7, Steps: 18 | Train Loss: 0.670 Vali Loss: 2.267 Vali Acc: 0.480 Test Loss: 2.267 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.31261157989502
Epoch: 8, Steps: 18 | Train Loss: 0.813 Vali Loss: 3.773 Vali Acc: 0.490 Test Loss: 3.773 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.412739753723145
Epoch: 9, Steps: 18 | Train Loss: 0.275 Vali Loss: 1.824 Vali Acc: 0.570 Test Loss: 1.824 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.494558334350586
Epoch: 10, Steps: 18 | Train Loss: 0.285 Vali Loss: 3.279 Vali Acc: 0.490 Test Loss: 3.279 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.12532353401184
Epoch: 11, Steps: 18 | Train Loss: 0.411 Vali Loss: 10.051 Vali Acc: 0.500 Test Loss: 10.051 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.231167793273926
Epoch: 12, Steps: 18 | Train Loss: 0.403 Vali Loss: 5.480 Vali Acc: 0.500 Test Loss: 5.480 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.079072713851929
Epoch: 13, Steps: 18 | Train Loss: 0.437 Vali Loss: 6.226 Vali Acc: 0.500 Test Loss: 6.226 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.134671688079834
Epoch: 14, Steps: 18 | Train Loss: 0.620 Vali Loss: 7.659 Vali Acc: 0.510 Test Loss: 7.659 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.099555492401123
Epoch: 15, Steps: 18 | Train Loss: 0.343 Vali Loss: 8.331 Vali Acc: 0.500 Test Loss: 8.331 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 4415746
model size : 26.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.329100370407104
Epoch: 1, Steps: 18 | Train Loss: 0.916 Vali Loss: 1.247 Vali Acc: 0.540 Test Loss: 1.247 Test Acc: 0.540
Validation loss decreased (inf --> -0.539988).  Saving model ...
Epoch: 2 cost time: 22.4435133934021
Epoch: 2, Steps: 18 | Train Loss: 0.882 Vali Loss: 3.305 Vali Acc: 0.500 Test Loss: 3.305 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 23.324121713638306
Epoch: 3, Steps: 18 | Train Loss: 1.038 Vali Loss: 4.078 Vali Acc: 0.470 Test Loss: 4.078 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 22.35495924949646
Epoch: 4, Steps: 18 | Train Loss: 1.163 Vali Loss: 3.297 Vali Acc: 0.520 Test Loss: 3.297 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.035418033599854
Epoch: 5, Steps: 18 | Train Loss: 0.697 Vali Loss: 3.807 Vali Acc: 0.560 Test Loss: 3.807 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559962).  Saving model ...
Epoch: 6 cost time: 20.097245693206787
Epoch: 6, Steps: 18 | Train Loss: 2.187 Vali Loss: 4.078 Vali Acc: 0.610 Test Loss: 4.078 Test Acc: 0.610
Validation loss decreased (-0.559962 --> -0.609959).  Saving model ...
Epoch: 7 cost time: 22.33440637588501
Epoch: 7, Steps: 18 | Train Loss: 0.652 Vali Loss: 5.826 Vali Acc: 0.510 Test Loss: 5.826 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.316881895065308
Epoch: 8, Steps: 18 | Train Loss: 1.019 Vali Loss: 8.265 Vali Acc: 0.520 Test Loss: 8.265 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.843674898147583
Epoch: 9, Steps: 18 | Train Loss: 0.767 Vali Loss: 10.033 Vali Acc: 0.460 Test Loss: 10.033 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 22.980382919311523
Epoch: 10, Steps: 18 | Train Loss: 1.587 Vali Loss: 14.005 Vali Acc: 0.500 Test Loss: 14.005 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 21.622255086898804
Epoch: 11, Steps: 18 | Train Loss: 1.102 Vali Loss: 5.829 Vali Acc: 0.520 Test Loss: 5.829 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 23.825066566467285
Epoch: 12, Steps: 18 | Train Loss: 1.125 Vali Loss: 8.548 Vali Acc: 0.510 Test Loss: 8.548 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 24.873989582061768
Epoch: 13, Steps: 18 | Train Loss: 0.937 Vali Loss: 8.393 Vali Acc: 0.510 Test Loss: 8.393 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 25.55479907989502
Epoch: 14, Steps: 18 | Train Loss: 1.371 Vali Loss: 10.938 Vali Acc: 0.500 Test Loss: 10.938 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 23.316199779510498
Epoch: 15, Steps: 18 | Train Loss: 1.195 Vali Loss: 10.420 Vali Acc: 0.490 Test Loss: 10.420 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 24.208876132965088
Epoch: 16, Steps: 18 | Train Loss: 0.614 Vali Loss: 11.768 Vali Acc: 0.540 Test Loss: 11.768 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3027074
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.728289127349854
Epoch: 1, Steps: 18 | Train Loss: 0.920 Vali Loss: 1.281 Vali Acc: 0.530 Test Loss: 1.281 Test Acc: 0.530
Validation loss decreased (inf --> -0.529987).  Saving model ...
Epoch: 2 cost time: 19.95587420463562
Epoch: 2, Steps: 18 | Train Loss: 0.837 Vali Loss: 1.406 Vali Acc: 0.510 Test Loss: 1.406 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.96900248527527
Epoch: 3, Steps: 18 | Train Loss: 1.227 Vali Loss: 2.023 Vali Acc: 0.430 Test Loss: 2.023 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.34833073616028
Epoch: 4, Steps: 18 | Train Loss: 0.947 Vali Loss: 3.270 Vali Acc: 0.510 Test Loss: 3.270 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.713484048843384
Epoch: 5, Steps: 18 | Train Loss: 2.497 Vali Loss: 5.928 Vali Acc: 0.490 Test Loss: 5.928 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 20.188499212265015
Epoch: 6, Steps: 18 | Train Loss: 0.948 Vali Loss: 4.756 Vali Acc: 0.520 Test Loss: 4.756 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 18.90522313117981
Epoch: 7, Steps: 18 | Train Loss: 0.717 Vali Loss: 3.737 Vali Acc: 0.580 Test Loss: 3.737 Test Acc: 0.580
Validation loss decreased (-0.529987 --> -0.579963).  Saving model ...
Epoch: 8 cost time: 20.392622709274292
Epoch: 8, Steps: 18 | Train Loss: 0.493 Vali Loss: 4.610 Vali Acc: 0.460 Test Loss: 4.610 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.319602966308594
Epoch: 9, Steps: 18 | Train Loss: 0.928 Vali Loss: 6.162 Vali Acc: 0.520 Test Loss: 6.162 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.309054851531982
Epoch: 10, Steps: 18 | Train Loss: 1.067 Vali Loss: 10.549 Vali Acc: 0.520 Test Loss: 10.549 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 19.521475553512573
Epoch: 11, Steps: 18 | Train Loss: 0.917 Vali Loss: 12.270 Vali Acc: 0.510 Test Loss: 12.270 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 20.375199556350708
Epoch: 12, Steps: 18 | Train Loss: 1.039 Vali Loss: 7.611 Vali Acc: 0.520 Test Loss: 7.611 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 20.411945343017578
Epoch: 13, Steps: 18 | Train Loss: 1.417 Vali Loss: 5.338 Vali Acc: 0.510 Test Loss: 5.338 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 20.7025785446167
Epoch: 14, Steps: 18 | Train Loss: 0.514 Vali Loss: 8.336 Vali Acc: 0.530 Test Loss: 8.336 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 19.574832916259766
Epoch: 15, Steps: 18 | Train Loss: 1.064 Vali Loss: 13.677 Vali Acc: 0.530 Test Loss: 13.677 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 18.551376342773438
Epoch: 16, Steps: 18 | Train Loss: 0.875 Vali Loss: 7.644 Vali Acc: 0.540 Test Loss: 7.644 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 23.235597610473633
Epoch: 17, Steps: 18 | Train Loss: 0.847 Vali Loss: 13.623 Vali Acc: 0.580 Test Loss: 13.623 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3027074
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.54554319381714
Epoch: 1, Steps: 18 | Train Loss: 0.981 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 16.120152473449707
Epoch: 2, Steps: 18 | Train Loss: 0.814 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 15.489525556564331
Epoch: 3, Steps: 18 | Train Loss: 0.627 Vali Loss: 1.497 Vali Acc: 0.500 Test Loss: 1.497 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.718655347824097
Epoch: 4, Steps: 18 | Train Loss: 0.768 Vali Loss: 3.779 Vali Acc: 0.540 Test Loss: 3.779 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539962).  Saving model ...
Epoch: 5 cost time: 15.341674327850342
Epoch: 5, Steps: 18 | Train Loss: 1.002 Vali Loss: 4.699 Vali Acc: 0.520 Test Loss: 4.699 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.40139389038086
Epoch: 6, Steps: 18 | Train Loss: 2.925 Vali Loss: 11.309 Vali Acc: 0.510 Test Loss: 11.309 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 17.052321672439575
Epoch: 7, Steps: 18 | Train Loss: 1.715 Vali Loss: 3.907 Vali Acc: 0.540 Test Loss: 3.907 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 16.789956092834473
Epoch: 8, Steps: 18 | Train Loss: 0.953 Vali Loss: 9.180 Vali Acc: 0.510 Test Loss: 9.180 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 17.197368621826172
Epoch: 9, Steps: 18 | Train Loss: 1.276 Vali Loss: 5.762 Vali Acc: 0.490 Test Loss: 5.762 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.991940975189209
Epoch: 10, Steps: 18 | Train Loss: 0.741 Vali Loss: 10.639 Vali Acc: 0.520 Test Loss: 10.639 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 15.65281867980957
Epoch: 11, Steps: 18 | Train Loss: 0.775 Vali Loss: 4.015 Vali Acc: 0.640 Test Loss: 4.015 Test Acc: 0.640
Validation loss decreased (-0.539962 --> -0.639960).  Saving model ...
Epoch: 12 cost time: 15.845986127853394
Epoch: 12, Steps: 18 | Train Loss: 0.745 Vali Loss: 12.176 Vali Acc: 0.530 Test Loss: 12.176 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 17.922355890274048
Epoch: 13, Steps: 18 | Train Loss: 2.010 Vali Loss: 6.545 Vali Acc: 0.530 Test Loss: 6.545 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 17.111466884613037
Epoch: 14, Steps: 18 | Train Loss: 0.689 Vali Loss: 7.592 Vali Acc: 0.570 Test Loss: 7.592 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 17.695464372634888
Epoch: 15, Steps: 18 | Train Loss: 0.996 Vali Loss: 16.947 Vali Acc: 0.500 Test Loss: 16.947 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 18.707825422286987
Epoch: 16, Steps: 18 | Train Loss: 1.482 Vali Loss: 8.270 Vali Acc: 0.520 Test Loss: 8.270 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 17.08047842979431
Epoch: 17, Steps: 18 | Train Loss: 0.569 Vali Loss: 10.887 Vali Acc: 0.540 Test Loss: 10.887 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 17.714954376220703
Epoch: 18, Steps: 18 | Train Loss: 0.459 Vali Loss: 14.368 Vali Acc: 0.500 Test Loss: 14.368 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 19.26272225379944
Epoch: 19, Steps: 18 | Train Loss: 0.435 Vali Loss: 18.507 Vali Acc: 0.520 Test Loss: 18.507 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 19.128808975219727
Epoch: 20, Steps: 18 | Train Loss: 0.470 Vali Loss: 8.920 Vali Acc: 0.570 Test Loss: 8.920 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 20.4450945854187
Epoch: 21, Steps: 18 | Train Loss: 0.843 Vali Loss: 12.367 Vali Acc: 0.510 Test Loss: 12.367 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 3027074
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.477028369903564
Epoch: 1, Steps: 18 | Train Loss: 0.997 Vali Loss: 0.847 Vali Acc: 0.590 Test Loss: 0.847 Test Acc: 0.590
Validation loss decreased (inf --> -0.589992).  Saving model ...
Epoch: 2 cost time: 13.391424655914307
Epoch: 2, Steps: 18 | Train Loss: 1.023 Vali Loss: 1.505 Vali Acc: 0.500 Test Loss: 1.505 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.17422080039978
Epoch: 3, Steps: 18 | Train Loss: 0.934 Vali Loss: 1.789 Vali Acc: 0.510 Test Loss: 1.789 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.406002759933472
Epoch: 4, Steps: 18 | Train Loss: 0.947 Vali Loss: 3.641 Vali Acc: 0.510 Test Loss: 3.641 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.816859245300293
Epoch: 5, Steps: 18 | Train Loss: 1.556 Vali Loss: 2.696 Vali Acc: 0.540 Test Loss: 2.696 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.79737114906311
Epoch: 6, Steps: 18 | Train Loss: 1.252 Vali Loss: 3.206 Vali Acc: 0.590 Test Loss: 3.206 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 14.298502922058105
Epoch: 7, Steps: 18 | Train Loss: 0.778 Vali Loss: 4.152 Vali Acc: 0.530 Test Loss: 4.152 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 12.536949634552002
Epoch: 8, Steps: 18 | Train Loss: 0.851 Vali Loss: 3.850 Vali Acc: 0.540 Test Loss: 3.850 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.876081705093384
Epoch: 9, Steps: 18 | Train Loss: 0.813 Vali Loss: 7.250 Vali Acc: 0.520 Test Loss: 7.250 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.45134687423706
Epoch: 10, Steps: 18 | Train Loss: 1.255 Vali Loss: 5.620 Vali Acc: 0.470 Test Loss: 5.620 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 13.939444780349731
Epoch: 11, Steps: 18 | Train Loss: 0.892 Vali Loss: 7.896 Vali Acc: 0.510 Test Loss: 7.896 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3027074
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.017774820327759
Epoch: 1, Steps: 18 | Train Loss: 0.976 Vali Loss: 0.799 Vali Acc: 0.510 Test Loss: 0.799 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 10.971939325332642
Epoch: 2, Steps: 18 | Train Loss: 0.857 Vali Loss: 2.072 Vali Acc: 0.510 Test Loss: 2.072 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.817799806594849
Epoch: 3, Steps: 18 | Train Loss: 1.003 Vali Loss: 2.094 Vali Acc: 0.570 Test Loss: 2.094 Test Acc: 0.570
Validation loss decreased (-0.509992 --> -0.569979).  Saving model ...
Epoch: 4 cost time: 10.647391319274902
Epoch: 4, Steps: 18 | Train Loss: 1.012 Vali Loss: 3.437 Vali Acc: 0.520 Test Loss: 3.437 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.804257154464722
Epoch: 5, Steps: 18 | Train Loss: 0.838 Vali Loss: 3.404 Vali Acc: 0.440 Test Loss: 3.404 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.777114152908325
Epoch: 6, Steps: 18 | Train Loss: 1.057 Vali Loss: 3.179 Vali Acc: 0.500 Test Loss: 3.179 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.369393110275269
Epoch: 7, Steps: 18 | Train Loss: 1.010 Vali Loss: 7.283 Vali Acc: 0.520 Test Loss: 7.283 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.834455251693726
Epoch: 8, Steps: 18 | Train Loss: 1.746 Vali Loss: 4.372 Vali Acc: 0.500 Test Loss: 4.372 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.366322040557861
Epoch: 9, Steps: 18 | Train Loss: 0.948 Vali Loss: 4.260 Vali Acc: 0.540 Test Loss: 4.260 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.740431785583496
Epoch: 10, Steps: 18 | Train Loss: 0.599 Vali Loss: 6.365 Vali Acc: 0.500 Test Loss: 6.365 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.621832847595215
Epoch: 11, Steps: 18 | Train Loss: 0.862 Vali Loss: 17.129 Vali Acc: 0.500 Test Loss: 17.129 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.343212604522705
Epoch: 12, Steps: 18 | Train Loss: 2.335 Vali Loss: 17.100 Vali Acc: 0.500 Test Loss: 17.100 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.012002229690552
Epoch: 13, Steps: 18 | Train Loss: 1.413 Vali Loss: 7.878 Vali Acc: 0.470 Test Loss: 7.878 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3027074
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.659897565841675
Epoch: 1, Steps: 18 | Train Loss: 0.989 Vali Loss: 0.857 Vali Acc: 0.520 Test Loss: 0.857 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 9.31432580947876
Epoch: 2, Steps: 18 | Train Loss: 0.817 Vali Loss: 0.989 Vali Acc: 0.490 Test Loss: 0.989 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.31221342086792
Epoch: 3, Steps: 18 | Train Loss: 0.666 Vali Loss: 1.813 Vali Acc: 0.500 Test Loss: 1.813 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.13303017616272
Epoch: 4, Steps: 18 | Train Loss: 0.649 Vali Loss: 2.660 Vali Acc: 0.490 Test Loss: 2.660 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.63417100906372
Epoch: 5, Steps: 18 | Train Loss: 0.468 Vali Loss: 1.946 Vali Acc: 0.510 Test Loss: 1.946 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.968648672103882
Epoch: 6, Steps: 18 | Train Loss: 0.804 Vali Loss: 5.868 Vali Acc: 0.500 Test Loss: 5.868 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.139840602874756
Epoch: 7, Steps: 18 | Train Loss: 0.704 Vali Loss: 3.774 Vali Acc: 0.530 Test Loss: 3.774 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529962).  Saving model ...
Epoch: 8 cost time: 9.29220175743103
Epoch: 8, Steps: 18 | Train Loss: 0.463 Vali Loss: 3.619 Vali Acc: 0.460 Test Loss: 3.619 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.4324049949646
Epoch: 9, Steps: 18 | Train Loss: 0.427 Vali Loss: 5.599 Vali Acc: 0.490 Test Loss: 5.599 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.708070755004883
Epoch: 10, Steps: 18 | Train Loss: 0.908 Vali Loss: 4.647 Vali Acc: 0.460 Test Loss: 4.647 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.724900484085083
Epoch: 11, Steps: 18 | Train Loss: 0.623 Vali Loss: 4.983 Vali Acc: 0.570 Test Loss: 4.983 Test Acc: 0.570
Validation loss decreased (-0.529962 --> -0.569950).  Saving model ...
Epoch: 12 cost time: 9.091924667358398
Epoch: 12, Steps: 18 | Train Loss: 1.077 Vali Loss: 4.177 Vali Acc: 0.500 Test Loss: 4.177 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.978500604629517
Epoch: 13, Steps: 18 | Train Loss: 0.457 Vali Loss: 10.585 Vali Acc: 0.500 Test Loss: 10.585 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.638132333755493
Epoch: 14, Steps: 18 | Train Loss: 0.475 Vali Loss: 6.282 Vali Acc: 0.500 Test Loss: 6.282 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.90186333656311
Epoch: 15, Steps: 18 | Train Loss: 0.535 Vali Loss: 12.339 Vali Acc: 0.470 Test Loss: 12.339 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.83687448501587
Epoch: 16, Steps: 18 | Train Loss: 0.627 Vali Loss: 9.965 Vali Acc: 0.470 Test Loss: 9.965 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.242879629135132
Epoch: 17, Steps: 18 | Train Loss: 0.455 Vali Loss: 13.902 Vali Acc: 0.450 Test Loss: 13.902 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.033550262451172
Epoch: 18, Steps: 18 | Train Loss: 0.652 Vali Loss: 11.456 Vali Acc: 0.500 Test Loss: 11.456 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 10.573359966278076
Epoch: 19, Steps: 18 | Train Loss: 0.644 Vali Loss: 18.297 Vali Acc: 0.490 Test Loss: 18.297 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.739527702331543
Epoch: 20, Steps: 18 | Train Loss: 0.824 Vali Loss: 12.325 Vali Acc: 0.530 Test Loss: 12.325 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 9.941970109939575
Epoch: 21, Steps: 18 | Train Loss: 0.452 Vali Loss: 15.448 Vali Acc: 0.540 Test Loss: 15.448 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3027074
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.218513488769531
Epoch: 1, Steps: 18 | Train Loss: 0.867 Vali Loss: 0.784 Vali Acc: 0.590 Test Loss: 0.784 Test Acc: 0.590
Validation loss decreased (inf --> -0.589992).  Saving model ...
Epoch: 2 cost time: 9.100978136062622
Epoch: 2, Steps: 18 | Train Loss: 0.769 Vali Loss: 2.342 Vali Acc: 0.500 Test Loss: 2.342 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.430165767669678
Epoch: 3, Steps: 18 | Train Loss: 0.516 Vali Loss: 1.439 Vali Acc: 0.520 Test Loss: 1.439 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.459376573562622
Epoch: 4, Steps: 18 | Train Loss: 0.504 Vali Loss: 1.697 Vali Acc: 0.470 Test Loss: 1.697 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.361289501190186
Epoch: 5, Steps: 18 | Train Loss: 0.355 Vali Loss: 2.425 Vali Acc: 0.510 Test Loss: 2.425 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.38602590560913
Epoch: 6, Steps: 18 | Train Loss: 1.643 Vali Loss: 3.061 Vali Acc: 0.540 Test Loss: 3.061 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.639286518096924
Epoch: 7, Steps: 18 | Train Loss: 0.584 Vali Loss: 3.481 Vali Acc: 0.540 Test Loss: 3.481 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.4225013256073
Epoch: 8, Steps: 18 | Train Loss: 0.485 Vali Loss: 3.900 Vali Acc: 0.460 Test Loss: 3.900 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.10925555229187
Epoch: 9, Steps: 18 | Train Loss: 0.659 Vali Loss: 9.048 Vali Acc: 0.540 Test Loss: 9.048 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.16721248626709
Epoch: 10, Steps: 18 | Train Loss: 1.864 Vali Loss: 5.242 Vali Acc: 0.510 Test Loss: 5.242 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.118825674057007
Epoch: 11, Steps: 18 | Train Loss: 0.516 Vali Loss: 9.305 Vali Acc: 0.460 Test Loss: 9.305 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3027074
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.992552757263184
Epoch: 1, Steps: 18 | Train Loss: 0.849 Vali Loss: 0.702 Vali Acc: 0.570 Test Loss: 0.702 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 8.450225353240967
Epoch: 2, Steps: 18 | Train Loss: 0.847 Vali Loss: 2.214 Vali Acc: 0.470 Test Loss: 2.214 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.841713428497314
Epoch: 3, Steps: 18 | Train Loss: 0.761 Vali Loss: 1.216 Vali Acc: 0.520 Test Loss: 1.216 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.391520738601685
Epoch: 4, Steps: 18 | Train Loss: 0.442 Vali Loss: 1.540 Vali Acc: 0.560 Test Loss: 1.540 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.870806694030762
Epoch: 5, Steps: 18 | Train Loss: 0.395 Vali Loss: 2.608 Vali Acc: 0.590 Test Loss: 2.608 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589974).  Saving model ...
Epoch: 6 cost time: 8.021657943725586
Epoch: 6, Steps: 18 | Train Loss: 1.437 Vali Loss: 2.256 Vali Acc: 0.560 Test Loss: 2.256 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.091155290603638
Epoch: 7, Steps: 18 | Train Loss: 0.888 Vali Loss: 4.182 Vali Acc: 0.490 Test Loss: 4.182 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.685545206069946
Epoch: 8, Steps: 18 | Train Loss: 0.920 Vali Loss: 7.586 Vali Acc: 0.480 Test Loss: 7.586 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.456257104873657
Epoch: 9, Steps: 18 | Train Loss: 1.551 Vali Loss: 8.989 Vali Acc: 0.550 Test Loss: 8.989 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.811596155166626
Epoch: 10, Steps: 18 | Train Loss: 0.532 Vali Loss: 6.185 Vali Acc: 0.500 Test Loss: 6.185 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.760952949523926
Epoch: 11, Steps: 18 | Train Loss: 0.767 Vali Loss: 8.172 Vali Acc: 0.540 Test Loss: 8.172 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.22445273399353
Epoch: 12, Steps: 18 | Train Loss: 0.318 Vali Loss: 9.776 Vali Acc: 0.560 Test Loss: 9.776 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.818442583084106
Epoch: 13, Steps: 18 | Train Loss: 0.475 Vali Loss: 7.108 Vali Acc: 0.550 Test Loss: 7.108 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.772971630096436
Epoch: 14, Steps: 18 | Train Loss: 0.543 Vali Loss: 11.326 Vali Acc: 0.480 Test Loss: 11.326 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.418872356414795
Epoch: 15, Steps: 18 | Train Loss: 1.362 Vali Loss: 22.013 Vali Acc: 0.520 Test Loss: 22.013 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3027074
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.799131155014038
Epoch: 1, Steps: 18 | Train Loss: 0.882 Vali Loss: 0.720 Vali Acc: 0.550 Test Loss: 0.720 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 7.981028079986572
Epoch: 2, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.812 Vali Acc: 0.580 Test Loss: 0.812 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579992).  Saving model ...
Epoch: 3 cost time: 7.775278329849243
Epoch: 3, Steps: 18 | Train Loss: 0.958 Vali Loss: 2.007 Vali Acc: 0.510 Test Loss: 2.007 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.356905698776245
Epoch: 4, Steps: 18 | Train Loss: 0.479 Vali Loss: 2.581 Vali Acc: 0.500 Test Loss: 2.581 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.35053038597107
Epoch: 5, Steps: 18 | Train Loss: 0.710 Vali Loss: 3.889 Vali Acc: 0.430 Test Loss: 3.889 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.954976558685303
Epoch: 6, Steps: 18 | Train Loss: 1.193 Vali Loss: 2.987 Vali Acc: 0.490 Test Loss: 2.987 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.184456825256348
Epoch: 7, Steps: 18 | Train Loss: 0.677 Vali Loss: 5.320 Vali Acc: 0.540 Test Loss: 5.320 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.415653467178345
Epoch: 8, Steps: 18 | Train Loss: 0.876 Vali Loss: 3.787 Vali Acc: 0.380 Test Loss: 3.787 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.879008054733276
Epoch: 9, Steps: 18 | Train Loss: 0.386 Vali Loss: 4.062 Vali Acc: 0.540 Test Loss: 4.062 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.6204187870025635
Epoch: 10, Steps: 18 | Train Loss: 0.431 Vali Loss: 4.342 Vali Acc: 0.510 Test Loss: 4.342 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.727780342102051
Epoch: 11, Steps: 18 | Train Loss: 0.784 Vali Loss: 9.634 Vali Acc: 0.480 Test Loss: 9.634 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.8980512619018555
Epoch: 12, Steps: 18 | Train Loss: 0.728 Vali Loss: 2.785 Vali Acc: 0.640 Test Loss: 2.785 Test Acc: 0.640
Validation loss decreased (-0.579992 --> -0.639972).  Saving model ...
Epoch: 13 cost time: 8.318559169769287
Epoch: 13, Steps: 18 | Train Loss: 0.360 Vali Loss: 3.042 Vali Acc: 0.550 Test Loss: 3.042 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.024714231491089
Epoch: 14, Steps: 18 | Train Loss: 0.441 Vali Loss: 8.190 Vali Acc: 0.460 Test Loss: 8.190 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.206497192382812
Epoch: 15, Steps: 18 | Train Loss: 0.235 Vali Loss: 5.300 Vali Acc: 0.490 Test Loss: 5.300 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.584602117538452
Epoch: 16, Steps: 18 | Train Loss: 1.226 Vali Loss: 10.973 Vali Acc: 0.440 Test Loss: 10.973 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.329015970230103
Epoch: 17, Steps: 18 | Train Loss: 0.986 Vali Loss: 4.267 Vali Acc: 0.570 Test Loss: 4.267 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.079707860946655
Epoch: 18, Steps: 18 | Train Loss: 0.896 Vali Loss: 3.865 Vali Acc: 0.630 Test Loss: 3.865 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.417727947235107
Epoch: 19, Steps: 18 | Train Loss: 0.295 Vali Loss: 11.613 Vali Acc: 0.550 Test Loss: 11.613 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.381203413009644
Epoch: 20, Steps: 18 | Train Loss: 0.398 Vali Loss: 3.784 Vali Acc: 0.450 Test Loss: 3.784 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.391607999801636
Epoch: 21, Steps: 18 | Train Loss: 0.367 Vali Loss: 11.249 Vali Acc: 0.530 Test Loss: 11.249 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.407510042190552
Epoch: 22, Steps: 18 | Train Loss: 0.719 Vali Loss: 12.590 Vali Acc: 0.450 Test Loss: 12.590 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 3027074
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.120021343231201
Epoch: 1, Steps: 18 | Train Loss: 0.874 Vali Loss: 1.568 Vali Acc: 0.500 Test Loss: 1.568 Test Acc: 0.500
Validation loss decreased (inf --> -0.499984).  Saving model ...
Epoch: 2 cost time: 8.445158243179321
Epoch: 2, Steps: 18 | Train Loss: 0.715 Vali Loss: 2.019 Vali Acc: 0.500 Test Loss: 2.019 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.57154130935669
Epoch: 3, Steps: 18 | Train Loss: 0.750 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
Validation loss decreased (-0.499984 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 7.978934049606323
Epoch: 4, Steps: 18 | Train Loss: 1.174 Vali Loss: 0.894 Vali Acc: 0.530 Test Loss: 0.894 Test Acc: 0.530
Validation loss decreased (-0.499987 --> -0.529991).  Saving model ...
Epoch: 5 cost time: 8.293861865997314
Epoch: 5, Steps: 18 | Train Loss: 0.521 Vali Loss: 1.266 Vali Acc: 0.490 Test Loss: 1.266 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.638303518295288
Epoch: 6, Steps: 18 | Train Loss: 1.175 Vali Loss: 4.832 Vali Acc: 0.500 Test Loss: 4.832 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.110508680343628
Epoch: 7, Steps: 18 | Train Loss: 1.061 Vali Loss: 1.701 Vali Acc: 0.520 Test Loss: 1.701 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.284855842590332
Epoch: 8, Steps: 18 | Train Loss: 1.137 Vali Loss: 3.122 Vali Acc: 0.530 Test Loss: 3.122 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.9977500438690186
Epoch: 9, Steps: 18 | Train Loss: 0.811 Vali Loss: 1.885 Vali Acc: 0.470 Test Loss: 1.885 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.201814889907837
Epoch: 10, Steps: 18 | Train Loss: 0.857 Vali Loss: 2.818 Vali Acc: 0.460 Test Loss: 2.818 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.915003538131714
Epoch: 11, Steps: 18 | Train Loss: 0.335 Vali Loss: 2.306 Vali Acc: 0.490 Test Loss: 2.306 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.4858458042144775
Epoch: 12, Steps: 18 | Train Loss: 0.631 Vali Loss: 3.226 Vali Acc: 0.520 Test Loss: 3.226 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.921152114868164
Epoch: 13, Steps: 18 | Train Loss: 0.991 Vali Loss: 2.982 Vali Acc: 0.500 Test Loss: 2.982 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.523721694946289
Epoch: 14, Steps: 18 | Train Loss: 0.248 Vali Loss: 5.729 Vali Acc: 0.570 Test Loss: 5.729 Test Acc: 0.570
Validation loss decreased (-0.529991 --> -0.569943).  Saving model ...
Epoch: 15 cost time: 8.205784320831299
Epoch: 15, Steps: 18 | Train Loss: 0.218 Vali Loss: 3.690 Vali Acc: 0.560 Test Loss: 3.690 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.942662954330444
Epoch: 16, Steps: 18 | Train Loss: 0.524 Vali Loss: 6.217 Vali Acc: 0.570 Test Loss: 6.217 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.478315591812134
Epoch: 17, Steps: 18 | Train Loss: 0.444 Vali Loss: 6.320 Vali Acc: 0.570 Test Loss: 6.320 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.594193696975708
Epoch: 18, Steps: 18 | Train Loss: 0.404 Vali Loss: 5.846 Vali Acc: 0.540 Test Loss: 5.846 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.071919679641724
Epoch: 19, Steps: 18 | Train Loss: 0.173 Vali Loss: 5.123 Vali Acc: 0.520 Test Loss: 5.123 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.893604755401611
Epoch: 20, Steps: 18 | Train Loss: 0.420 Vali Loss: 4.850 Vali Acc: 0.490 Test Loss: 4.850 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.481760740280151
Epoch: 21, Steps: 18 | Train Loss: 0.187 Vali Loss: 5.762 Vali Acc: 0.510 Test Loss: 5.762 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.857787132263184
Epoch: 22, Steps: 18 | Train Loss: 0.739 Vali Loss: 16.554 Vali Acc: 0.490 Test Loss: 16.554 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.608339548110962
Epoch: 23, Steps: 18 | Train Loss: 1.324 Vali Loss: 7.355 Vali Acc: 0.500 Test Loss: 7.355 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.681639194488525
Epoch: 24, Steps: 18 | Train Loss: 1.256 Vali Loss: 8.962 Vali Acc: 0.480 Test Loss: 8.962 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3027074
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.160099744796753
Epoch: 1, Steps: 18 | Train Loss: 0.931 Vali Loss: 1.019 Vali Acc: 0.610 Test Loss: 1.019 Test Acc: 0.610
Validation loss decreased (inf --> -0.609990).  Saving model ...
Epoch: 2 cost time: 21.568424224853516
Epoch: 2, Steps: 18 | Train Loss: 1.234 Vali Loss: 1.539 Vali Acc: 0.560 Test Loss: 1.539 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.814345836639404
Epoch: 3, Steps: 18 | Train Loss: 1.404 Vali Loss: 1.634 Vali Acc: 0.520 Test Loss: 1.634 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.659433841705322
Epoch: 4, Steps: 18 | Train Loss: 0.447 Vali Loss: 2.214 Vali Acc: 0.540 Test Loss: 2.214 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.50366449356079
Epoch: 5, Steps: 18 | Train Loss: 0.773 Vali Loss: 3.375 Vali Acc: 0.480 Test Loss: 3.375 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 21.0188946723938
Epoch: 6, Steps: 18 | Train Loss: 0.655 Vali Loss: 2.901 Vali Acc: 0.520 Test Loss: 2.901 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 22.307596445083618
Epoch: 7, Steps: 18 | Train Loss: 1.105 Vali Loss: 3.578 Vali Acc: 0.520 Test Loss: 3.578 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 20.727724313735962
Epoch: 8, Steps: 18 | Train Loss: 0.706 Vali Loss: 4.164 Vali Acc: 0.490 Test Loss: 4.164 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 22.155851364135742
Epoch: 9, Steps: 18 | Train Loss: 1.665 Vali Loss: 14.521 Vali Acc: 0.500 Test Loss: 14.521 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 19.764015913009644
Epoch: 10, Steps: 18 | Train Loss: 1.327 Vali Loss: 8.794 Vali Acc: 0.480 Test Loss: 8.794 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 19.898570775985718
Epoch: 11, Steps: 18 | Train Loss: 0.435 Vali Loss: 5.413 Vali Acc: 0.510 Test Loss: 5.413 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2240642
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.112388610839844
Epoch: 1, Steps: 18 | Train Loss: 0.926 Vali Loss: 0.920 Vali Acc: 0.560 Test Loss: 0.920 Test Acc: 0.560
Validation loss decreased (inf --> -0.559991).  Saving model ...
Epoch: 2 cost time: 18.821003675460815
Epoch: 2, Steps: 18 | Train Loss: 1.007 Vali Loss: 1.321 Vali Acc: 0.570 Test Loss: 1.321 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569987).  Saving model ...
Epoch: 3 cost time: 18.142077445983887
Epoch: 3, Steps: 18 | Train Loss: 0.807 Vali Loss: 2.755 Vali Acc: 0.520 Test Loss: 2.755 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.409074544906616
Epoch: 4, Steps: 18 | Train Loss: 0.696 Vali Loss: 2.612 Vali Acc: 0.510 Test Loss: 2.612 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.50581979751587
Epoch: 5, Steps: 18 | Train Loss: 0.594 Vali Loss: 2.606 Vali Acc: 0.480 Test Loss: 2.606 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.395750045776367
Epoch: 6, Steps: 18 | Train Loss: 2.121 Vali Loss: 4.899 Vali Acc: 0.480 Test Loss: 4.899 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 18.966989278793335
Epoch: 7, Steps: 18 | Train Loss: 1.729 Vali Loss: 4.155 Vali Acc: 0.560 Test Loss: 4.155 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 18.983281135559082
Epoch: 8, Steps: 18 | Train Loss: 1.212 Vali Loss: 5.941 Vali Acc: 0.590 Test Loss: 5.941 Test Acc: 0.590
Validation loss decreased (-0.569987 --> -0.589941).  Saving model ...
Epoch: 9 cost time: 19.112759351730347
Epoch: 9, Steps: 18 | Train Loss: 0.699 Vali Loss: 4.455 Vali Acc: 0.570 Test Loss: 4.455 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 17.39096975326538
Epoch: 10, Steps: 18 | Train Loss: 1.619 Vali Loss: 7.264 Vali Acc: 0.510 Test Loss: 7.264 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 17.130045175552368
Epoch: 11, Steps: 18 | Train Loss: 0.636 Vali Loss: 14.136 Vali Acc: 0.500 Test Loss: 14.136 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 18.156916856765747
Epoch: 12, Steps: 18 | Train Loss: 0.553 Vali Loss: 4.187 Vali Acc: 0.550 Test Loss: 4.187 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 19.206526517868042
Epoch: 13, Steps: 18 | Train Loss: 0.278 Vali Loss: 5.907 Vali Acc: 0.510 Test Loss: 5.907 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 19.35435461997986
Epoch: 14, Steps: 18 | Train Loss: 1.436 Vali Loss: 8.264 Vali Acc: 0.540 Test Loss: 8.264 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 20.994930744171143
Epoch: 15, Steps: 18 | Train Loss: 1.391 Vali Loss: 15.597 Vali Acc: 0.520 Test Loss: 15.597 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 18.695592880249023
Epoch: 16, Steps: 18 | Train Loss: 0.766 Vali Loss: 8.512 Vali Acc: 0.500 Test Loss: 8.512 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 19.673407793045044
Epoch: 17, Steps: 18 | Train Loss: 0.191 Vali Loss: 10.713 Vali Acc: 0.550 Test Loss: 10.713 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 20.045978784561157
Epoch: 18, Steps: 18 | Train Loss: 0.764 Vali Loss: 7.353 Vali Acc: 0.560 Test Loss: 7.353 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2240642
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.790317296981812
Epoch: 1, Steps: 18 | Train Loss: 0.954 Vali Loss: 0.787 Vali Acc: 0.540 Test Loss: 0.787 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 16.72556209564209
Epoch: 2, Steps: 18 | Train Loss: 1.030 Vali Loss: 1.181 Vali Acc: 0.530 Test Loss: 1.181 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.53648328781128
Epoch: 3, Steps: 18 | Train Loss: 0.693 Vali Loss: 2.022 Vali Acc: 0.470 Test Loss: 2.022 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.486536264419556
Epoch: 4, Steps: 18 | Train Loss: 1.494 Vali Loss: 3.636 Vali Acc: 0.490 Test Loss: 3.636 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.21179485321045
Epoch: 5, Steps: 18 | Train Loss: 2.283 Vali Loss: 3.622 Vali Acc: 0.590 Test Loss: 3.622 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589964).  Saving model ...
Epoch: 6 cost time: 15.266743183135986
Epoch: 6, Steps: 18 | Train Loss: 1.366 Vali Loss: 3.677 Vali Acc: 0.570 Test Loss: 3.677 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.686893463134766
Epoch: 7, Steps: 18 | Train Loss: 1.096 Vali Loss: 5.266 Vali Acc: 0.540 Test Loss: 5.266 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.7816641330719
Epoch: 8, Steps: 18 | Train Loss: 0.623 Vali Loss: 8.056 Vali Acc: 0.520 Test Loss: 8.056 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.888594150543213
Epoch: 9, Steps: 18 | Train Loss: 1.464 Vali Loss: 7.146 Vali Acc: 0.500 Test Loss: 7.146 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 15.432694911956787
Epoch: 10, Steps: 18 | Train Loss: 1.323 Vali Loss: 17.538 Vali Acc: 0.520 Test Loss: 17.538 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 15.524442195892334
Epoch: 11, Steps: 18 | Train Loss: 1.167 Vali Loss: 5.816 Vali Acc: 0.530 Test Loss: 5.816 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.173282623291016
Epoch: 12, Steps: 18 | Train Loss: 0.585 Vali Loss: 6.225 Vali Acc: 0.540 Test Loss: 6.225 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 14.657300233840942
Epoch: 13, Steps: 18 | Train Loss: 0.874 Vali Loss: 12.639 Vali Acc: 0.520 Test Loss: 12.639 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 16.108299732208252
Epoch: 14, Steps: 18 | Train Loss: 1.006 Vali Loss: 6.456 Vali Acc: 0.540 Test Loss: 6.456 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 16.029558181762695
Epoch: 15, Steps: 18 | Train Loss: 0.615 Vali Loss: 17.627 Vali Acc: 0.500 Test Loss: 17.627 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2240642
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.238861083984375
Epoch: 1, Steps: 18 | Train Loss: 0.907 Vali Loss: 1.424 Vali Acc: 0.490 Test Loss: 1.424 Test Acc: 0.490
Validation loss decreased (inf --> -0.489986).  Saving model ...
Epoch: 2 cost time: 11.282232522964478
Epoch: 2, Steps: 18 | Train Loss: 0.825 Vali Loss: 1.691 Vali Acc: 0.520 Test Loss: 1.691 Test Acc: 0.520
Validation loss decreased (-0.489986 --> -0.519983).  Saving model ...
Epoch: 3 cost time: 11.746543645858765
Epoch: 3, Steps: 18 | Train Loss: 0.889 Vali Loss: 1.519 Vali Acc: 0.540 Test Loss: 1.519 Test Acc: 0.540
Validation loss decreased (-0.519983 --> -0.539985).  Saving model ...
Epoch: 4 cost time: 11.695837020874023
Epoch: 4, Steps: 18 | Train Loss: 1.132 Vali Loss: 2.042 Vali Acc: 0.560 Test Loss: 2.042 Test Acc: 0.560
Validation loss decreased (-0.539985 --> -0.559980).  Saving model ...
Epoch: 5 cost time: 13.189522743225098
Epoch: 5, Steps: 18 | Train Loss: 0.972 Vali Loss: 2.416 Vali Acc: 0.530 Test Loss: 2.416 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.485702753067017
Epoch: 6, Steps: 18 | Train Loss: 1.017 Vali Loss: 4.125 Vali Acc: 0.510 Test Loss: 4.125 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.429035425186157
Epoch: 7, Steps: 18 | Train Loss: 1.653 Vali Loss: 4.056 Vali Acc: 0.530 Test Loss: 4.056 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.603612422943115
Epoch: 8, Steps: 18 | Train Loss: 1.125 Vali Loss: 3.710 Vali Acc: 0.570 Test Loss: 3.710 Test Acc: 0.570
Validation loss decreased (-0.559980 --> -0.569963).  Saving model ...
Epoch: 9 cost time: 11.6371009349823
Epoch: 9, Steps: 18 | Train Loss: 1.477 Vali Loss: 6.095 Vali Acc: 0.480 Test Loss: 6.095 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.944052934646606
Epoch: 10, Steps: 18 | Train Loss: 0.586 Vali Loss: 7.481 Vali Acc: 0.500 Test Loss: 7.481 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.518892765045166
Epoch: 11, Steps: 18 | Train Loss: 0.579 Vali Loss: 5.987 Vali Acc: 0.450 Test Loss: 5.987 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.010525941848755
Epoch: 12, Steps: 18 | Train Loss: 0.854 Vali Loss: 4.825 Vali Acc: 0.520 Test Loss: 4.825 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.568290710449219
Epoch: 13, Steps: 18 | Train Loss: 0.493 Vali Loss: 5.503 Vali Acc: 0.620 Test Loss: 5.503 Test Acc: 0.620
Validation loss decreased (-0.569963 --> -0.619945).  Saving model ...
Epoch: 14 cost time: 13.418250322341919
Epoch: 14, Steps: 18 | Train Loss: 1.461 Vali Loss: 7.121 Vali Acc: 0.510 Test Loss: 7.121 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.316815614700317
Epoch: 15, Steps: 18 | Train Loss: 0.465 Vali Loss: 9.316 Vali Acc: 0.450 Test Loss: 9.316 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 13.253218173980713
Epoch: 16, Steps: 18 | Train Loss: 0.633 Vali Loss: 7.503 Vali Acc: 0.520 Test Loss: 7.503 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 13.66964316368103
Epoch: 17, Steps: 18 | Train Loss: 0.524 Vali Loss: 7.130 Vali Acc: 0.590 Test Loss: 7.130 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 13.285266399383545
Epoch: 18, Steps: 18 | Train Loss: 1.837 Vali Loss: 7.699 Vali Acc: 0.580 Test Loss: 7.699 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 13.14529299736023
Epoch: 19, Steps: 18 | Train Loss: 0.777 Vali Loss: 11.363 Vali Acc: 0.500 Test Loss: 11.363 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 12.8668212890625
Epoch: 20, Steps: 18 | Train Loss: 0.259 Vali Loss: 7.602 Vali Acc: 0.610 Test Loss: 7.602 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 12.487416744232178
Epoch: 21, Steps: 18 | Train Loss: 0.628 Vali Loss: 12.692 Vali Acc: 0.550 Test Loss: 12.692 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 15.604736328125
Epoch: 22, Steps: 18 | Train Loss: 3.126 Vali Loss: 11.004 Vali Acc: 0.570 Test Loss: 11.004 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 14.36676836013794
Epoch: 23, Steps: 18 | Train Loss: 2.028 Vali Loss: 21.857 Vali Acc: 0.570 Test Loss: 21.857 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2240642
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.641101360321045
Epoch: 1, Steps: 18 | Train Loss: 0.947 Vali Loss: 0.758 Vali Acc: 0.620 Test Loss: 0.758 Test Acc: 0.620
Validation loss decreased (inf --> -0.619992).  Saving model ...
Epoch: 2 cost time: 10.072715520858765
Epoch: 2, Steps: 18 | Train Loss: 0.816 Vali Loss: 2.157 Vali Acc: 0.490 Test Loss: 2.157 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.149786710739136
Epoch: 3, Steps: 18 | Train Loss: 1.998 Vali Loss: 1.603 Vali Acc: 0.560 Test Loss: 1.603 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.47220516204834
Epoch: 4, Steps: 18 | Train Loss: 0.751 Vali Loss: 3.234 Vali Acc: 0.510 Test Loss: 3.234 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.69109034538269
Epoch: 5, Steps: 18 | Train Loss: 0.899 Vali Loss: 3.117 Vali Acc: 0.540 Test Loss: 3.117 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.021068811416626
Epoch: 6, Steps: 18 | Train Loss: 1.151 Vali Loss: 2.105 Vali Acc: 0.510 Test Loss: 2.105 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.455955505371094
Epoch: 7, Steps: 18 | Train Loss: 0.692 Vali Loss: 5.063 Vali Acc: 0.570 Test Loss: 5.063 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.06150197982788
Epoch: 8, Steps: 18 | Train Loss: 1.481 Vali Loss: 8.301 Vali Acc: 0.520 Test Loss: 8.301 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.646547317504883
Epoch: 9, Steps: 18 | Train Loss: 0.609 Vali Loss: 4.000 Vali Acc: 0.560 Test Loss: 4.000 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.939493417739868
Epoch: 10, Steps: 18 | Train Loss: 1.918 Vali Loss: 6.827 Vali Acc: 0.540 Test Loss: 6.827 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.230702638626099
Epoch: 11, Steps: 18 | Train Loss: 0.801 Vali Loss: 9.937 Vali Acc: 0.500 Test Loss: 9.937 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2240642
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.05929160118103
Epoch: 1, Steps: 18 | Train Loss: 0.882 Vali Loss: 0.825 Vali Acc: 0.570 Test Loss: 0.825 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 7.699549913406372
Epoch: 2, Steps: 18 | Train Loss: 0.835 Vali Loss: 1.527 Vali Acc: 0.560 Test Loss: 1.527 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.764774560928345
Epoch: 3, Steps: 18 | Train Loss: 0.918 Vali Loss: 2.199 Vali Acc: 0.450 Test Loss: 2.199 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.697784900665283
Epoch: 4, Steps: 18 | Train Loss: 1.055 Vali Loss: 2.591 Vali Acc: 0.520 Test Loss: 2.591 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.491101980209351
Epoch: 5, Steps: 18 | Train Loss: 0.845 Vali Loss: 2.649 Vali Acc: 0.440 Test Loss: 2.649 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.246061563491821
Epoch: 6, Steps: 18 | Train Loss: 0.823 Vali Loss: 6.072 Vali Acc: 0.480 Test Loss: 6.072 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.16592025756836
Epoch: 7, Steps: 18 | Train Loss: 0.930 Vali Loss: 4.988 Vali Acc: 0.570 Test Loss: 4.988 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.486706495285034
Epoch: 8, Steps: 18 | Train Loss: 0.919 Vali Loss: 7.704 Vali Acc: 0.520 Test Loss: 7.704 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.90583610534668
Epoch: 9, Steps: 18 | Train Loss: 1.311 Vali Loss: 4.864 Vali Acc: 0.530 Test Loss: 4.864 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.820398807525635
Epoch: 10, Steps: 18 | Train Loss: 1.216 Vali Loss: 13.685 Vali Acc: 0.500 Test Loss: 13.685 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.63786792755127
Epoch: 11, Steps: 18 | Train Loss: 1.242 Vali Loss: 8.396 Vali Acc: 0.520 Test Loss: 8.396 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2240642
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.790505170822144
Epoch: 1, Steps: 18 | Train Loss: 0.885 Vali Loss: 0.783 Vali Acc: 0.570 Test Loss: 0.783 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 7.792832612991333
Epoch: 2, Steps: 18 | Train Loss: 0.937 Vali Loss: 2.327 Vali Acc: 0.510 Test Loss: 2.327 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.838123083114624
Epoch: 3, Steps: 18 | Train Loss: 0.825 Vali Loss: 3.267 Vali Acc: 0.490 Test Loss: 3.267 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.882785320281982
Epoch: 4, Steps: 18 | Train Loss: 0.527 Vali Loss: 2.872 Vali Acc: 0.520 Test Loss: 2.872 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.023660182952881
Epoch: 5, Steps: 18 | Train Loss: 0.892 Vali Loss: 4.132 Vali Acc: 0.450 Test Loss: 4.132 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.080286979675293
Epoch: 6, Steps: 18 | Train Loss: 0.969 Vali Loss: 2.997 Vali Acc: 0.480 Test Loss: 2.997 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.136702537536621
Epoch: 7, Steps: 18 | Train Loss: 0.606 Vali Loss: 4.500 Vali Acc: 0.520 Test Loss: 4.500 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.072084188461304
Epoch: 8, Steps: 18 | Train Loss: 0.439 Vali Loss: 4.213 Vali Acc: 0.490 Test Loss: 4.213 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.676147699356079
Epoch: 9, Steps: 18 | Train Loss: 0.467 Vali Loss: 7.211 Vali Acc: 0.530 Test Loss: 7.211 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.413837194442749
Epoch: 10, Steps: 18 | Train Loss: 0.449 Vali Loss: 5.494 Vali Acc: 0.490 Test Loss: 5.494 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.707321882247925
Epoch: 11, Steps: 18 | Train Loss: 0.228 Vali Loss: 4.654 Vali Acc: 0.520 Test Loss: 4.654 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2240642
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.746709108352661
Epoch: 1, Steps: 18 | Train Loss: 0.824 Vali Loss: 0.653 Vali Acc: 0.600 Test Loss: 0.653 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 7.633734226226807
Epoch: 2, Steps: 18 | Train Loss: 0.611 Vali Loss: 1.856 Vali Acc: 0.480 Test Loss: 1.856 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.3131842613220215
Epoch: 3, Steps: 18 | Train Loss: 0.669 Vali Loss: 2.212 Vali Acc: 0.500 Test Loss: 2.212 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.134327411651611
Epoch: 4, Steps: 18 | Train Loss: 0.472 Vali Loss: 1.998 Vali Acc: 0.490 Test Loss: 1.998 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.970398902893066
Epoch: 5, Steps: 18 | Train Loss: 1.290 Vali Loss: 4.589 Vali Acc: 0.540 Test Loss: 4.589 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.267114639282227
Epoch: 6, Steps: 18 | Train Loss: 0.988 Vali Loss: 2.588 Vali Acc: 0.540 Test Loss: 2.588 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.423933506011963
Epoch: 7, Steps: 18 | Train Loss: 0.263 Vali Loss: 3.102 Vali Acc: 0.490 Test Loss: 3.102 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.2696497440338135
Epoch: 8, Steps: 18 | Train Loss: 0.866 Vali Loss: 6.139 Vali Acc: 0.540 Test Loss: 6.139 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.301460027694702
Epoch: 9, Steps: 18 | Train Loss: 0.520 Vali Loss: 3.152 Vali Acc: 0.550 Test Loss: 3.152 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.231916189193726
Epoch: 10, Steps: 18 | Train Loss: 0.866 Vali Loss: 6.246 Vali Acc: 0.530 Test Loss: 6.246 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.104218482971191
Epoch: 11, Steps: 18 | Train Loss: 0.855 Vali Loss: 13.924 Vali Acc: 0.490 Test Loss: 13.924 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2240642
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.753402471542358
Epoch: 1, Steps: 18 | Train Loss: 0.843 Vali Loss: 0.908 Vali Acc: 0.430 Test Loss: 0.908 Test Acc: 0.430
Validation loss decreased (inf --> -0.429991).  Saving model ...
Epoch: 2 cost time: 6.775435209274292
Epoch: 2, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.848 Vali Acc: 0.540 Test Loss: 0.848 Test Acc: 0.540
Validation loss decreased (-0.429991 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 7.502582311630249
Epoch: 3, Steps: 18 | Train Loss: 0.499 Vali Loss: 1.396 Vali Acc: 0.430 Test Loss: 1.396 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.425100326538086
Epoch: 4, Steps: 18 | Train Loss: 0.915 Vali Loss: 2.196 Vali Acc: 0.560 Test Loss: 2.196 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559978).  Saving model ...
Epoch: 5 cost time: 7.2330567836761475
Epoch: 5, Steps: 18 | Train Loss: 0.575 Vali Loss: 3.098 Vali Acc: 0.440 Test Loss: 3.098 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.982732534408569
Epoch: 6, Steps: 18 | Train Loss: 0.486 Vali Loss: 3.534 Vali Acc: 0.450 Test Loss: 3.534 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.41089391708374
Epoch: 7, Steps: 18 | Train Loss: 0.365 Vali Loss: 5.836 Vali Acc: 0.450 Test Loss: 5.836 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.998975992202759
Epoch: 8, Steps: 18 | Train Loss: 0.481 Vali Loss: 5.200 Vali Acc: 0.450 Test Loss: 5.200 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.052031755447388
Epoch: 9, Steps: 18 | Train Loss: 0.296 Vali Loss: 2.533 Vali Acc: 0.470 Test Loss: 2.533 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.967766761779785
Epoch: 10, Steps: 18 | Train Loss: 0.338 Vali Loss: 3.271 Vali Acc: 0.460 Test Loss: 3.271 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.762120008468628
Epoch: 11, Steps: 18 | Train Loss: 0.780 Vali Loss: 3.483 Vali Acc: 0.410 Test Loss: 3.483 Test Acc: 0.410
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.938809871673584
Epoch: 12, Steps: 18 | Train Loss: 0.391 Vali Loss: 7.641 Vali Acc: 0.490 Test Loss: 7.641 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.221503257751465
Epoch: 13, Steps: 18 | Train Loss: 0.284 Vali Loss: 6.364 Vali Acc: 0.480 Test Loss: 6.364 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.859728574752808
Epoch: 14, Steps: 18 | Train Loss: 1.334 Vali Loss: 7.622 Vali Acc: 0.480 Test Loss: 7.622 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2240642
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.492189407348633
Epoch: 1, Steps: 18 | Train Loss: 0.790 Vali Loss: 0.782 Vali Acc: 0.500 Test Loss: 0.782 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 6.828977108001709
Epoch: 2, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.908 Vali Acc: 0.500 Test Loss: 0.908 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.162637710571289
Epoch: 3, Steps: 18 | Train Loss: 0.482 Vali Loss: 1.247 Vali Acc: 0.500 Test Loss: 1.247 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.212578773498535
Epoch: 4, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.588 Vali Acc: 0.490 Test Loss: 1.588 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.787755489349365
Epoch: 5, Steps: 18 | Train Loss: 0.623 Vali Loss: 2.593 Vali Acc: 0.500 Test Loss: 2.593 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.6579344272613525
Epoch: 6, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.229 Vali Acc: 0.470 Test Loss: 1.229 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.7520129680633545
Epoch: 7, Steps: 18 | Train Loss: 0.504 Vali Loss: 2.692 Vali Acc: 0.510 Test Loss: 2.692 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509973).  Saving model ...
Epoch: 8 cost time: 6.858114719390869
Epoch: 8, Steps: 18 | Train Loss: 0.280 Vali Loss: 1.704 Vali Acc: 0.520 Test Loss: 1.704 Test Acc: 0.520
Validation loss decreased (-0.509973 --> -0.519983).  Saving model ...
Epoch: 9 cost time: 6.56064248085022
Epoch: 9, Steps: 18 | Train Loss: 0.200 Vali Loss: 2.617 Vali Acc: 0.520 Test Loss: 2.617 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.84365177154541
Epoch: 10, Steps: 18 | Train Loss: 0.096 Vali Loss: 1.583 Vali Acc: 0.500 Test Loss: 1.583 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.199066400527954
Epoch: 11, Steps: 18 | Train Loss: 0.103 Vali Loss: 4.967 Vali Acc: 0.500 Test Loss: 4.967 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.231118679046631
Epoch: 12, Steps: 18 | Train Loss: 0.935 Vali Loss: 2.095 Vali Acc: 0.520 Test Loss: 2.095 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.137246608734131
Epoch: 13, Steps: 18 | Train Loss: 0.502 Vali Loss: 6.614 Vali Acc: 0.520 Test Loss: 6.614 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.773743391036987
Epoch: 14, Steps: 18 | Train Loss: 0.649 Vali Loss: 3.691 Vali Acc: 0.550 Test Loss: 3.691 Test Acc: 0.550
Validation loss decreased (-0.519983 --> -0.549963).  Saving model ...
Epoch: 15 cost time: 6.828835964202881
Epoch: 15, Steps: 18 | Train Loss: 0.526 Vali Loss: 4.679 Vali Acc: 0.540 Test Loss: 4.679 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.998342275619507
Epoch: 16, Steps: 18 | Train Loss: 0.151 Vali Loss: 4.819 Vali Acc: 0.560 Test Loss: 4.819 Test Acc: 0.560
Validation loss decreased (-0.549963 --> -0.559952).  Saving model ...
Epoch: 17 cost time: 7.116535425186157
Epoch: 17, Steps: 18 | Train Loss: 0.739 Vali Loss: 7.331 Vali Acc: 0.470 Test Loss: 7.331 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.825265645980835
Epoch: 18, Steps: 18 | Train Loss: 0.731 Vali Loss: 3.776 Vali Acc: 0.510 Test Loss: 3.776 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.897543907165527
Epoch: 19, Steps: 18 | Train Loss: 0.229 Vali Loss: 6.382 Vali Acc: 0.530 Test Loss: 6.382 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.52719521522522
Epoch: 20, Steps: 18 | Train Loss: 0.319 Vali Loss: 8.995 Vali Acc: 0.530 Test Loss: 8.995 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.965402603149414
Epoch: 21, Steps: 18 | Train Loss: 0.180 Vali Loss: 12.401 Vali Acc: 0.510 Test Loss: 12.401 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.937472343444824
Epoch: 22, Steps: 18 | Train Loss: 0.374 Vali Loss: 6.235 Vali Acc: 0.520 Test Loss: 6.235 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.628199815750122
Epoch: 23, Steps: 18 | Train Loss: 0.906 Vali Loss: 14.874 Vali Acc: 0.520 Test Loss: 14.874 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.695617198944092
Epoch: 24, Steps: 18 | Train Loss: 0.475 Vali Loss: 6.463 Vali Acc: 0.540 Test Loss: 6.463 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.143232345581055
Epoch: 25, Steps: 18 | Train Loss: 0.173 Vali Loss: 12.186 Vali Acc: 0.530 Test Loss: 12.186 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.335497856140137
Epoch: 26, Steps: 18 | Train Loss: 0.544 Vali Loss: 14.377 Vali Acc: 0.530 Test Loss: 14.377 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2240642
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.064404487609863
Epoch: 1, Steps: 18 | Train Loss: 0.944 Vali Loss: 2.124 Vali Acc: 0.510 Test Loss: 2.124 Test Acc: 0.510
Validation loss decreased (inf --> -0.509979).  Saving model ...
Epoch: 2 cost time: 21.18339991569519
Epoch: 2, Steps: 18 | Train Loss: 0.810 Vali Loss: 2.854 Vali Acc: 0.500 Test Loss: 2.854 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.17117691040039
Epoch: 3, Steps: 18 | Train Loss: 1.055 Vali Loss: 2.366 Vali Acc: 0.510 Test Loss: 2.366 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.728832244873047
Epoch: 4, Steps: 18 | Train Loss: 1.177 Vali Loss: 3.086 Vali Acc: 0.520 Test Loss: 3.086 Test Acc: 0.520
Validation loss decreased (-0.509979 --> -0.519969).  Saving model ...
Epoch: 5 cost time: 19.400402069091797
Epoch: 5, Steps: 18 | Train Loss: 1.106 Vali Loss: 7.712 Vali Acc: 0.500 Test Loss: 7.712 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.521031379699707
Epoch: 6, Steps: 18 | Train Loss: 1.291 Vali Loss: 3.461 Vali Acc: 0.440 Test Loss: 3.461 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.926757335662842
Epoch: 7, Steps: 18 | Train Loss: 0.866 Vali Loss: 5.321 Vali Acc: 0.540 Test Loss: 5.321 Test Acc: 0.540
Validation loss decreased (-0.519969 --> -0.539947).  Saving model ...
Epoch: 8 cost time: 20.117884397506714
Epoch: 8, Steps: 18 | Train Loss: 1.069 Vali Loss: 8.121 Vali Acc: 0.550 Test Loss: 8.121 Test Acc: 0.550
Validation loss decreased (-0.539947 --> -0.549919).  Saving model ...
Epoch: 9 cost time: 18.776198863983154
Epoch: 9, Steps: 18 | Train Loss: 1.223 Vali Loss: 5.672 Vali Acc: 0.540 Test Loss: 5.672 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 19.244197845458984
Epoch: 10, Steps: 18 | Train Loss: 1.083 Vali Loss: 7.634 Vali Acc: 0.480 Test Loss: 7.634 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 20.21580219268799
Epoch: 11, Steps: 18 | Train Loss: 1.363 Vali Loss: 18.592 Vali Acc: 0.500 Test Loss: 18.592 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 22.68583631515503
Epoch: 12, Steps: 18 | Train Loss: 2.262 Vali Loss: 13.989 Vali Acc: 0.500 Test Loss: 13.989 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 22.38479709625244
Epoch: 13, Steps: 18 | Train Loss: 2.356 Vali Loss: 11.475 Vali Acc: 0.520 Test Loss: 11.475 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 22.596794366836548
Epoch: 14, Steps: 18 | Train Loss: 1.120 Vali Loss: 9.989 Vali Acc: 0.510 Test Loss: 9.989 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 21.432326555252075
Epoch: 15, Steps: 18 | Train Loss: 1.006 Vali Loss: 20.433 Vali Acc: 0.470 Test Loss: 20.433 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 22.311487674713135
Epoch: 16, Steps: 18 | Train Loss: 0.517 Vali Loss: 12.988 Vali Acc: 0.520 Test Loss: 12.988 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 23.9554226398468
Epoch: 17, Steps: 18 | Train Loss: 0.721 Vali Loss: 6.480 Vali Acc: 0.530 Test Loss: 6.480 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 24.903895378112793
Epoch: 18, Steps: 18 | Train Loss: 1.342 Vali Loss: 16.710 Vali Acc: 0.490 Test Loss: 16.710 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1847426
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.624159812927246
Epoch: 1, Steps: 18 | Train Loss: 0.930 Vali Loss: 1.799 Vali Acc: 0.490 Test Loss: 1.799 Test Acc: 0.490
Validation loss decreased (inf --> -0.489982).  Saving model ...
Epoch: 2 cost time: 18.310012578964233
Epoch: 2, Steps: 18 | Train Loss: 0.889 Vali Loss: 1.898 Vali Acc: 0.500 Test Loss: 1.898 Test Acc: 0.500
Validation loss decreased (-0.489982 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 16.877495527267456
Epoch: 3, Steps: 18 | Train Loss: 1.020 Vali Loss: 2.806 Vali Acc: 0.510 Test Loss: 2.806 Test Acc: 0.510
Validation loss decreased (-0.499981 --> -0.509972).  Saving model ...
Epoch: 4 cost time: 18.54166030883789
Epoch: 4, Steps: 18 | Train Loss: 1.227 Vali Loss: 2.539 Vali Acc: 0.490 Test Loss: 2.539 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.79670023918152
Epoch: 5, Steps: 18 | Train Loss: 1.017 Vali Loss: 5.339 Vali Acc: 0.500 Test Loss: 5.339 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 18.16862177848816
Epoch: 6, Steps: 18 | Train Loss: 1.028 Vali Loss: 3.794 Vali Acc: 0.510 Test Loss: 3.794 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.53872299194336
Epoch: 7, Steps: 18 | Train Loss: 1.867 Vali Loss: 3.369 Vali Acc: 0.580 Test Loss: 3.369 Test Acc: 0.580
Validation loss decreased (-0.509972 --> -0.579966).  Saving model ...
Epoch: 8 cost time: 16.87406325340271
Epoch: 8, Steps: 18 | Train Loss: 1.243 Vali Loss: 5.618 Vali Acc: 0.490 Test Loss: 5.618 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.052621603012085
Epoch: 9, Steps: 18 | Train Loss: 0.780 Vali Loss: 4.837 Vali Acc: 0.560 Test Loss: 4.837 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.969892501831055
Epoch: 10, Steps: 18 | Train Loss: 1.030 Vali Loss: 6.130 Vali Acc: 0.500 Test Loss: 6.130 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 17.70769715309143
Epoch: 11, Steps: 18 | Train Loss: 1.612 Vali Loss: 7.904 Vali Acc: 0.510 Test Loss: 7.904 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 19.48929238319397
Epoch: 12, Steps: 18 | Train Loss: 2.206 Vali Loss: 12.520 Vali Acc: 0.480 Test Loss: 12.520 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 16.51536536216736
Epoch: 13, Steps: 18 | Train Loss: 0.673 Vali Loss: 12.274 Vali Acc: 0.480 Test Loss: 12.274 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 16.654457092285156
Epoch: 14, Steps: 18 | Train Loss: 0.351 Vali Loss: 13.607 Vali Acc: 0.500 Test Loss: 13.607 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 18.022982835769653
Epoch: 15, Steps: 18 | Train Loss: 0.545 Vali Loss: 8.879 Vali Acc: 0.530 Test Loss: 8.879 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 19.687159776687622
Epoch: 16, Steps: 18 | Train Loss: 0.762 Vali Loss: 12.738 Vali Acc: 0.510 Test Loss: 12.738 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 20.504409551620483
Epoch: 17, Steps: 18 | Train Loss: 0.874 Vali Loss: 9.244 Vali Acc: 0.560 Test Loss: 9.244 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1847426
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.644527912139893
Epoch: 1, Steps: 18 | Train Loss: 0.949 Vali Loss: 1.018 Vali Acc: 0.520 Test Loss: 1.018 Test Acc: 0.520
Validation loss decreased (inf --> -0.519990).  Saving model ...
Epoch: 2 cost time: 12.450015544891357
Epoch: 2, Steps: 18 | Train Loss: 0.872 Vali Loss: 1.346 Vali Acc: 0.510 Test Loss: 1.346 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.942523002624512
Epoch: 3, Steps: 18 | Train Loss: 1.310 Vali Loss: 2.635 Vali Acc: 0.470 Test Loss: 2.635 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.424842596054077
Epoch: 4, Steps: 18 | Train Loss: 1.546 Vali Loss: 4.722 Vali Acc: 0.520 Test Loss: 4.722 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.162240505218506
Epoch: 5, Steps: 18 | Train Loss: 0.733 Vali Loss: 3.025 Vali Acc: 0.540 Test Loss: 3.025 Test Acc: 0.540
Validation loss decreased (-0.519990 --> -0.539970).  Saving model ...
Epoch: 6 cost time: 14.86459994316101
Epoch: 6, Steps: 18 | Train Loss: 1.075 Vali Loss: 3.150 Vali Acc: 0.540 Test Loss: 3.150 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.390653133392334
Epoch: 7, Steps: 18 | Train Loss: 0.749 Vali Loss: 2.628 Vali Acc: 0.560 Test Loss: 2.628 Test Acc: 0.560
Validation loss decreased (-0.539970 --> -0.559974).  Saving model ...
Epoch: 8 cost time: 13.499614953994751
Epoch: 8, Steps: 18 | Train Loss: 1.022 Vali Loss: 5.729 Vali Acc: 0.530 Test Loss: 5.729 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.796083211898804
Epoch: 9, Steps: 18 | Train Loss: 1.064 Vali Loss: 4.816 Vali Acc: 0.490 Test Loss: 4.816 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.397775888442993
Epoch: 10, Steps: 18 | Train Loss: 0.739 Vali Loss: 7.174 Vali Acc: 0.510 Test Loss: 7.174 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.242053747177124
Epoch: 11, Steps: 18 | Train Loss: 0.889 Vali Loss: 8.956 Vali Acc: 0.540 Test Loss: 8.956 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 15.342002868652344
Epoch: 12, Steps: 18 | Train Loss: 1.029 Vali Loss: 16.826 Vali Acc: 0.520 Test Loss: 16.826 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 15.021591424942017
Epoch: 13, Steps: 18 | Train Loss: 1.330 Vali Loss: 16.083 Vali Acc: 0.530 Test Loss: 16.083 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 16.273690700531006
Epoch: 14, Steps: 18 | Train Loss: 1.455 Vali Loss: 7.424 Vali Acc: 0.610 Test Loss: 7.424 Test Acc: 0.610
Validation loss decreased (-0.559974 --> -0.609926).  Saving model ...
Epoch: 15 cost time: 14.666738510131836
Epoch: 15, Steps: 18 | Train Loss: 0.646 Vali Loss: 5.417 Vali Acc: 0.600 Test Loss: 5.417 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.809947490692139
Epoch: 16, Steps: 18 | Train Loss: 0.828 Vali Loss: 11.552 Vali Acc: 0.510 Test Loss: 11.552 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 14.482933282852173
Epoch: 17, Steps: 18 | Train Loss: 0.910 Vali Loss: 6.612 Vali Acc: 0.540 Test Loss: 6.612 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 17.079314947128296
Epoch: 18, Steps: 18 | Train Loss: 0.337 Vali Loss: 11.067 Vali Acc: 0.490 Test Loss: 11.067 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 16.28576111793518
Epoch: 19, Steps: 18 | Train Loss: 0.389 Vali Loss: 8.809 Vali Acc: 0.550 Test Loss: 8.809 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 17.54271364212036
Epoch: 20, Steps: 18 | Train Loss: 0.427 Vali Loss: 18.718 Vali Acc: 0.510 Test Loss: 18.718 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 17.55137586593628
Epoch: 21, Steps: 18 | Train Loss: 0.686 Vali Loss: 8.273 Vali Acc: 0.620 Test Loss: 8.273 Test Acc: 0.620
Validation loss decreased (-0.609926 --> -0.619917).  Saving model ...
Epoch: 22 cost time: 18.002975463867188
Epoch: 22, Steps: 18 | Train Loss: 1.701 Vali Loss: 20.585 Vali Acc: 0.530 Test Loss: 20.585 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 16.52836775779724
Epoch: 23, Steps: 18 | Train Loss: 1.290 Vali Loss: 11.761 Vali Acc: 0.560 Test Loss: 11.761 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 17.357251167297363
Epoch: 24, Steps: 18 | Train Loss: 0.440 Vali Loss: 9.341 Vali Acc: 0.580 Test Loss: 9.341 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 18.78082275390625
Epoch: 25, Steps: 18 | Train Loss: 0.443 Vali Loss: 17.039 Vali Acc: 0.560 Test Loss: 17.039 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 19.543017864227295
Epoch: 26, Steps: 18 | Train Loss: 0.291 Vali Loss: 9.358 Vali Acc: 0.580 Test Loss: 9.358 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 18.9476900100708
Epoch: 27, Steps: 18 | Train Loss: 0.332 Vali Loss: 12.625 Vali Acc: 0.550 Test Loss: 12.625 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 19.385404586791992
Epoch: 28, Steps: 18 | Train Loss: 1.040 Vali Loss: 12.430 Vali Acc: 0.580 Test Loss: 12.430 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 17.007519721984863
Epoch: 29, Steps: 18 | Train Loss: 0.872 Vali Loss: 19.522 Vali Acc: 0.520 Test Loss: 19.522 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 17.763019800186157
Epoch: 30, Steps: 18 | Train Loss: 0.178 Vali Loss: 22.173 Vali Acc: 0.460 Test Loss: 22.173 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 18.424463272094727
Epoch: 31, Steps: 18 | Train Loss: 0.648 Vali Loss: 55.568 Vali Acc: 0.510 Test Loss: 55.568 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1847426
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.525073528289795
Epoch: 1, Steps: 18 | Train Loss: 0.932 Vali Loss: 0.921 Vali Acc: 0.520 Test Loss: 0.921 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 12.253318071365356
Epoch: 2, Steps: 18 | Train Loss: 1.184 Vali Loss: 1.987 Vali Acc: 0.520 Test Loss: 1.987 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.438860654830933
Epoch: 3, Steps: 18 | Train Loss: 1.157 Vali Loss: 2.035 Vali Acc: 0.510 Test Loss: 2.035 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.031308889389038
Epoch: 4, Steps: 18 | Train Loss: 1.102 Vali Loss: 1.927 Vali Acc: 0.520 Test Loss: 1.927 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.037623167037964
Epoch: 5, Steps: 18 | Train Loss: 0.686 Vali Loss: 1.848 Vali Acc: 0.510 Test Loss: 1.848 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.861306190490723
Epoch: 6, Steps: 18 | Train Loss: 0.585 Vali Loss: 2.852 Vali Acc: 0.490 Test Loss: 2.852 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.418036699295044
Epoch: 7, Steps: 18 | Train Loss: 0.958 Vali Loss: 4.079 Vali Acc: 0.550 Test Loss: 4.079 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549959).  Saving model ...
Epoch: 8 cost time: 12.029207468032837
Epoch: 8, Steps: 18 | Train Loss: 1.801 Vali Loss: 5.560 Vali Acc: 0.470 Test Loss: 5.560 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.096021890640259
Epoch: 9, Steps: 18 | Train Loss: 1.590 Vali Loss: 8.654 Vali Acc: 0.550 Test Loss: 8.654 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.717334985733032
Epoch: 10, Steps: 18 | Train Loss: 0.667 Vali Loss: 4.392 Vali Acc: 0.550 Test Loss: 4.392 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.996784687042236
Epoch: 11, Steps: 18 | Train Loss: 0.552 Vali Loss: 5.788 Vali Acc: 0.510 Test Loss: 5.788 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.81818675994873
Epoch: 12, Steps: 18 | Train Loss: 0.555 Vali Loss: 6.807 Vali Acc: 0.510 Test Loss: 6.807 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.35514783859253
Epoch: 13, Steps: 18 | Train Loss: 1.518 Vali Loss: 19.838 Vali Acc: 0.510 Test Loss: 19.838 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.822241306304932
Epoch: 14, Steps: 18 | Train Loss: 1.147 Vali Loss: 9.994 Vali Acc: 0.550 Test Loss: 9.994 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.512130737304688
Epoch: 15, Steps: 18 | Train Loss: 0.831 Vali Loss: 9.213 Vali Acc: 0.540 Test Loss: 9.213 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.93569278717041
Epoch: 16, Steps: 18 | Train Loss: 0.452 Vali Loss: 10.259 Vali Acc: 0.560 Test Loss: 10.259 Test Acc: 0.560
Validation loss decreased (-0.549959 --> -0.559897).  Saving model ...
Epoch: 17 cost time: 13.055577039718628
Epoch: 17, Steps: 18 | Train Loss: 0.445 Vali Loss: 8.508 Vali Acc: 0.520 Test Loss: 8.508 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.329309940338135
Epoch: 18, Steps: 18 | Train Loss: 0.645 Vali Loss: 10.183 Vali Acc: 0.530 Test Loss: 10.183 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.687573671340942
Epoch: 19, Steps: 18 | Train Loss: 0.383 Vali Loss: 11.782 Vali Acc: 0.520 Test Loss: 11.782 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 13.797766923904419
Epoch: 20, Steps: 18 | Train Loss: 1.115 Vali Loss: 8.417 Vali Acc: 0.550 Test Loss: 8.417 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 12.834620714187622
Epoch: 21, Steps: 18 | Train Loss: 0.953 Vali Loss: 22.924 Vali Acc: 0.500 Test Loss: 22.924 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 13.354658126831055
Epoch: 22, Steps: 18 | Train Loss: 1.332 Vali Loss: 11.199 Vali Acc: 0.500 Test Loss: 11.199 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 13.157371044158936
Epoch: 23, Steps: 18 | Train Loss: 0.384 Vali Loss: 20.455 Vali Acc: 0.520 Test Loss: 20.455 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 13.711530447006226
Epoch: 24, Steps: 18 | Train Loss: 0.532 Vali Loss: 19.671 Vali Acc: 0.490 Test Loss: 19.671 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 15.057574033737183
Epoch: 25, Steps: 18 | Train Loss: 0.271 Vali Loss: 16.507 Vali Acc: 0.520 Test Loss: 16.507 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 13.83617901802063
Epoch: 26, Steps: 18 | Train Loss: 0.745 Vali Loss: 14.972 Vali Acc: 0.530 Test Loss: 14.972 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1847426
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.32932186126709
Epoch: 1, Steps: 18 | Train Loss: 0.908 Vali Loss: 1.167 Vali Acc: 0.480 Test Loss: 1.167 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 8.659921884536743
Epoch: 2, Steps: 18 | Train Loss: 0.870 Vali Loss: 1.588 Vali Acc: 0.520 Test Loss: 1.588 Test Acc: 0.520
Validation loss decreased (-0.479988 --> -0.519984).  Saving model ...
Epoch: 3 cost time: 8.567241907119751
Epoch: 3, Steps: 18 | Train Loss: 0.611 Vali Loss: 1.210 Vali Acc: 0.510 Test Loss: 1.210 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.435145378112793
Epoch: 4, Steps: 18 | Train Loss: 1.049 Vali Loss: 3.146 Vali Acc: 0.500 Test Loss: 3.146 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.240062952041626
Epoch: 5, Steps: 18 | Train Loss: 1.227 Vali Loss: 6.474 Vali Acc: 0.500 Test Loss: 6.474 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.9630701541900635
Epoch: 6, Steps: 18 | Train Loss: 0.464 Vali Loss: 3.832 Vali Acc: 0.440 Test Loss: 3.832 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.237558126449585
Epoch: 7, Steps: 18 | Train Loss: 0.434 Vali Loss: 2.985 Vali Acc: 0.470 Test Loss: 2.985 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.022218227386475
Epoch: 8, Steps: 18 | Train Loss: 1.060 Vali Loss: 9.170 Vali Acc: 0.500 Test Loss: 9.170 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.230000972747803
Epoch: 9, Steps: 18 | Train Loss: 1.049 Vali Loss: 5.438 Vali Acc: 0.500 Test Loss: 5.438 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.8813157081604
Epoch: 10, Steps: 18 | Train Loss: 0.677 Vali Loss: 4.966 Vali Acc: 0.450 Test Loss: 4.966 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.805171489715576
Epoch: 11, Steps: 18 | Train Loss: 0.720 Vali Loss: 4.898 Vali Acc: 0.490 Test Loss: 4.898 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 9.019906282424927
Epoch: 12, Steps: 18 | Train Loss: 0.682 Vali Loss: 7.502 Vali Acc: 0.540 Test Loss: 7.502 Test Acc: 0.540
Validation loss decreased (-0.519984 --> -0.539925).  Saving model ...
Epoch: 13 cost time: 9.419416666030884
Epoch: 13, Steps: 18 | Train Loss: 1.183 Vali Loss: 11.523 Vali Acc: 0.530 Test Loss: 11.523 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.071776151657104
Epoch: 14, Steps: 18 | Train Loss: 0.561 Vali Loss: 4.854 Vali Acc: 0.590 Test Loss: 4.854 Test Acc: 0.590
Validation loss decreased (-0.539925 --> -0.589951).  Saving model ...
Epoch: 15 cost time: 8.395357608795166
Epoch: 15, Steps: 18 | Train Loss: 0.416 Vali Loss: 6.272 Vali Acc: 0.590 Test Loss: 6.272 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.75571608543396
Epoch: 16, Steps: 18 | Train Loss: 0.604 Vali Loss: 8.578 Vali Acc: 0.560 Test Loss: 8.578 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.03459620475769
Epoch: 17, Steps: 18 | Train Loss: 0.417 Vali Loss: 9.764 Vali Acc: 0.540 Test Loss: 9.764 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.775023460388184
Epoch: 18, Steps: 18 | Train Loss: 1.232 Vali Loss: 8.518 Vali Acc: 0.570 Test Loss: 8.518 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.75322961807251
Epoch: 19, Steps: 18 | Train Loss: 0.832 Vali Loss: 8.085 Vali Acc: 0.520 Test Loss: 8.085 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.767308712005615
Epoch: 20, Steps: 18 | Train Loss: 0.415 Vali Loss: 15.902 Vali Acc: 0.500 Test Loss: 15.902 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.710583686828613
Epoch: 21, Steps: 18 | Train Loss: 0.387 Vali Loss: 11.059 Vali Acc: 0.500 Test Loss: 11.059 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.717031240463257
Epoch: 22, Steps: 18 | Train Loss: 0.346 Vali Loss: 13.309 Vali Acc: 0.490 Test Loss: 13.309 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 10.040131568908691
Epoch: 23, Steps: 18 | Train Loss: 0.214 Vali Loss: 17.657 Vali Acc: 0.470 Test Loss: 17.657 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 10.629158020019531
Epoch: 24, Steps: 18 | Train Loss: 0.259 Vali Loss: 10.042 Vali Acc: 0.540 Test Loss: 10.042 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1847426
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.687924861907959
Epoch: 1, Steps: 18 | Train Loss: 0.817 Vali Loss: 0.956 Vali Acc: 0.550 Test Loss: 0.956 Test Acc: 0.550
Validation loss decreased (inf --> -0.549990).  Saving model ...
Epoch: 2 cost time: 6.956909656524658
Epoch: 2, Steps: 18 | Train Loss: 0.561 Vali Loss: 1.220 Vali Acc: 0.450 Test Loss: 1.220 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.163529634475708
Epoch: 3, Steps: 18 | Train Loss: 0.495 Vali Loss: 1.359 Vali Acc: 0.490 Test Loss: 1.359 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.320037364959717
Epoch: 4, Steps: 18 | Train Loss: 0.454 Vali Loss: 7.352 Vali Acc: 0.500 Test Loss: 7.352 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.696284532546997
Epoch: 5, Steps: 18 | Train Loss: 1.319 Vali Loss: 7.416 Vali Acc: 0.500 Test Loss: 7.416 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.467944383621216
Epoch: 6, Steps: 18 | Train Loss: 0.759 Vali Loss: 2.818 Vali Acc: 0.480 Test Loss: 2.818 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.531156778335571
Epoch: 7, Steps: 18 | Train Loss: 0.374 Vali Loss: 4.863 Vali Acc: 0.520 Test Loss: 4.863 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.659805536270142
Epoch: 8, Steps: 18 | Train Loss: 0.468 Vali Loss: 4.185 Vali Acc: 0.560 Test Loss: 4.185 Test Acc: 0.560
Validation loss decreased (-0.549990 --> -0.559958).  Saving model ...
Epoch: 9 cost time: 7.8403000831604
Epoch: 9, Steps: 18 | Train Loss: 0.293 Vali Loss: 6.065 Vali Acc: 0.460 Test Loss: 6.065 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.525995492935181
Epoch: 10, Steps: 18 | Train Loss: 0.337 Vali Loss: 7.617 Vali Acc: 0.530 Test Loss: 7.617 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.524280548095703
Epoch: 11, Steps: 18 | Train Loss: 0.392 Vali Loss: 9.037 Vali Acc: 0.530 Test Loss: 9.037 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.881660461425781
Epoch: 12, Steps: 18 | Train Loss: 0.667 Vali Loss: 8.012 Vali Acc: 0.530 Test Loss: 8.012 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.72587513923645
Epoch: 13, Steps: 18 | Train Loss: 0.290 Vali Loss: 7.270 Vali Acc: 0.530 Test Loss: 7.270 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.314107418060303
Epoch: 14, Steps: 18 | Train Loss: 0.572 Vali Loss: 11.994 Vali Acc: 0.530 Test Loss: 11.994 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.240396976470947
Epoch: 15, Steps: 18 | Train Loss: 0.486 Vali Loss: 6.765 Vali Acc: 0.540 Test Loss: 6.765 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.147570610046387
Epoch: 16, Steps: 18 | Train Loss: 0.218 Vali Loss: 6.200 Vali Acc: 0.550 Test Loss: 6.200 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.209204196929932
Epoch: 17, Steps: 18 | Train Loss: 0.684 Vali Loss: 9.402 Vali Acc: 0.480 Test Loss: 9.402 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.351049184799194
Epoch: 18, Steps: 18 | Train Loss: 0.229 Vali Loss: 10.251 Vali Acc: 0.560 Test Loss: 10.251 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1847426
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.4259672164917
Epoch: 1, Steps: 18 | Train Loss: 0.865 Vali Loss: 0.823 Vali Acc: 0.600 Test Loss: 0.823 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 7.066694736480713
Epoch: 2, Steps: 18 | Train Loss: 0.525 Vali Loss: 1.639 Vali Acc: 0.480 Test Loss: 1.639 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.124627113342285
Epoch: 3, Steps: 18 | Train Loss: 0.657 Vali Loss: 1.562 Vali Acc: 0.570 Test Loss: 1.562 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.898400068283081
Epoch: 4, Steps: 18 | Train Loss: 0.554 Vali Loss: 5.895 Vali Acc: 0.500 Test Loss: 5.895 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.030726671218872
Epoch: 5, Steps: 18 | Train Loss: 1.439 Vali Loss: 2.403 Vali Acc: 0.550 Test Loss: 2.403 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.162700176239014
Epoch: 6, Steps: 18 | Train Loss: 0.456 Vali Loss: 2.282 Vali Acc: 0.520 Test Loss: 2.282 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.906516075134277
Epoch: 7, Steps: 18 | Train Loss: 0.439 Vali Loss: 4.414 Vali Acc: 0.560 Test Loss: 4.414 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.961575984954834
Epoch: 8, Steps: 18 | Train Loss: 0.605 Vali Loss: 4.340 Vali Acc: 0.590 Test Loss: 4.340 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.676995038986206
Epoch: 9, Steps: 18 | Train Loss: 0.448 Vali Loss: 4.110 Vali Acc: 0.530 Test Loss: 4.110 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.652109861373901
Epoch: 10, Steps: 18 | Train Loss: 0.372 Vali Loss: 4.787 Vali Acc: 0.450 Test Loss: 4.787 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.848292112350464
Epoch: 11, Steps: 18 | Train Loss: 0.764 Vali Loss: 7.820 Vali Acc: 0.490 Test Loss: 7.820 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1847426
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.837253570556641
Epoch: 1, Steps: 18 | Train Loss: 0.800 Vali Loss: 1.278 Vali Acc: 0.500 Test Loss: 1.278 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 6.2880637645721436
Epoch: 2, Steps: 18 | Train Loss: 0.612 Vali Loss: 1.127 Vali Acc: 0.490 Test Loss: 1.127 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.352197885513306
Epoch: 3, Steps: 18 | Train Loss: 0.493 Vali Loss: 2.215 Vali Acc: 0.500 Test Loss: 2.215 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.527844667434692
Epoch: 4, Steps: 18 | Train Loss: 1.229 Vali Loss: 2.427 Vali Acc: 0.460 Test Loss: 2.427 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.7906787395477295
Epoch: 5, Steps: 18 | Train Loss: 1.261 Vali Loss: 4.475 Vali Acc: 0.480 Test Loss: 4.475 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.812809944152832
Epoch: 6, Steps: 18 | Train Loss: 0.531 Vali Loss: 4.671 Vali Acc: 0.490 Test Loss: 4.671 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.824347257614136
Epoch: 7, Steps: 18 | Train Loss: 0.484 Vali Loss: 2.334 Vali Acc: 0.600 Test Loss: 2.334 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599977).  Saving model ...
Epoch: 8 cost time: 6.640805006027222
Epoch: 8, Steps: 18 | Train Loss: 0.667 Vali Loss: 9.446 Vali Acc: 0.490 Test Loss: 9.446 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.569336652755737
Epoch: 9, Steps: 18 | Train Loss: 1.358 Vali Loss: 4.661 Vali Acc: 0.530 Test Loss: 4.661 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.770903587341309
Epoch: 10, Steps: 18 | Train Loss: 0.223 Vali Loss: 7.992 Vali Acc: 0.500 Test Loss: 7.992 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.755667448043823
Epoch: 11, Steps: 18 | Train Loss: 0.919 Vali Loss: 5.402 Vali Acc: 0.480 Test Loss: 5.402 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.824386835098267
Epoch: 12, Steps: 18 | Train Loss: 0.318 Vali Loss: 7.941 Vali Acc: 0.480 Test Loss: 7.941 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.489804744720459
Epoch: 13, Steps: 18 | Train Loss: 0.266 Vali Loss: 5.582 Vali Acc: 0.540 Test Loss: 5.582 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.482095956802368
Epoch: 14, Steps: 18 | Train Loss: 0.381 Vali Loss: 5.053 Vali Acc: 0.530 Test Loss: 5.053 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.974782943725586
Epoch: 15, Steps: 18 | Train Loss: 0.455 Vali Loss: 7.490 Vali Acc: 0.520 Test Loss: 7.490 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.530292987823486
Epoch: 16, Steps: 18 | Train Loss: 1.053 Vali Loss: 6.408 Vali Acc: 0.580 Test Loss: 6.408 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.4287450313568115
Epoch: 17, Steps: 18 | Train Loss: 0.277 Vali Loss: 10.465 Vali Acc: 0.480 Test Loss: 10.465 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1847426
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.96887731552124
Epoch: 1, Steps: 18 | Train Loss: 0.820 Vali Loss: 1.307 Vali Acc: 0.490 Test Loss: 1.307 Test Acc: 0.490
Validation loss decreased (inf --> -0.489987).  Saving model ...
Epoch: 2 cost time: 6.651353120803833
Epoch: 2, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.924 Vali Acc: 0.550 Test Loss: 0.924 Test Acc: 0.550
Validation loss decreased (-0.489987 --> -0.549991).  Saving model ...
Epoch: 3 cost time: 6.675760746002197
Epoch: 3, Steps: 18 | Train Loss: 0.524 Vali Loss: 2.295 Vali Acc: 0.520 Test Loss: 2.295 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.458801507949829
Epoch: 4, Steps: 18 | Train Loss: 0.624 Vali Loss: 1.159 Vali Acc: 0.530 Test Loss: 1.159 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.511000156402588
Epoch: 5, Steps: 18 | Train Loss: 0.871 Vali Loss: 3.042 Vali Acc: 0.410 Test Loss: 3.042 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.761632680892944
Epoch: 6, Steps: 18 | Train Loss: 0.407 Vali Loss: 1.809 Vali Acc: 0.480 Test Loss: 1.809 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.48245644569397
Epoch: 7, Steps: 18 | Train Loss: 0.396 Vali Loss: 1.257 Vali Acc: 0.520 Test Loss: 1.257 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.580895185470581
Epoch: 8, Steps: 18 | Train Loss: 1.005 Vali Loss: 3.166 Vali Acc: 0.500 Test Loss: 3.166 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.527710437774658
Epoch: 9, Steps: 18 | Train Loss: 0.449 Vali Loss: 7.480 Vali Acc: 0.400 Test Loss: 7.480 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.465663909912109
Epoch: 10, Steps: 18 | Train Loss: 0.329 Vali Loss: 6.208 Vali Acc: 0.500 Test Loss: 6.208 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.559197902679443
Epoch: 11, Steps: 18 | Train Loss: 0.666 Vali Loss: 8.415 Vali Acc: 0.430 Test Loss: 8.415 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.265557527542114
Epoch: 12, Steps: 18 | Train Loss: 0.733 Vali Loss: 5.853 Vali Acc: 0.540 Test Loss: 5.853 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1847426
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.7775750160217285
Epoch: 1, Steps: 18 | Train Loss: 0.794 Vali Loss: 1.278 Vali Acc: 0.500 Test Loss: 1.278 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 6.649279356002808
Epoch: 2, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.911 Vali Acc: 0.500 Test Loss: 0.911 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499991).  Saving model ...
Epoch: 3 cost time: 6.753068923950195
Epoch: 3, Steps: 18 | Train Loss: 0.457 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
Validation loss decreased (-0.499991 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 6.621278762817383
Epoch: 4, Steps: 18 | Train Loss: 0.655 Vali Loss: 5.819 Vali Acc: 0.500 Test Loss: 5.819 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.7450878620147705
Epoch: 5, Steps: 18 | Train Loss: 1.818 Vali Loss: 2.911 Vali Acc: 0.500 Test Loss: 2.911 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.8063273429870605
Epoch: 6, Steps: 18 | Train Loss: 0.601 Vali Loss: 1.181 Vali Acc: 0.530 Test Loss: 1.181 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529988).  Saving model ...
Epoch: 7 cost time: 6.830454349517822
Epoch: 7, Steps: 18 | Train Loss: 0.236 Vali Loss: 1.195 Vali Acc: 0.550 Test Loss: 1.195 Test Acc: 0.550
Validation loss decreased (-0.529988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 6.350571632385254
Epoch: 8, Steps: 18 | Train Loss: 0.584 Vali Loss: 2.288 Vali Acc: 0.500 Test Loss: 2.288 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.481543302536011
Epoch: 9, Steps: 18 | Train Loss: 0.359 Vali Loss: 2.320 Vali Acc: 0.520 Test Loss: 2.320 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.3838372230529785
Epoch: 10, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.717 Vali Acc: 0.510 Test Loss: 1.717 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.445986032485962
Epoch: 11, Steps: 18 | Train Loss: 0.848 Vali Loss: 3.501 Vali Acc: 0.530 Test Loss: 3.501 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.585504770278931
Epoch: 12, Steps: 18 | Train Loss: 0.924 Vali Loss: 2.571 Vali Acc: 0.570 Test Loss: 2.571 Test Acc: 0.570
Validation loss decreased (-0.549988 --> -0.569974).  Saving model ...
Epoch: 13 cost time: 6.609520435333252
Epoch: 13, Steps: 18 | Train Loss: 0.255 Vali Loss: 8.010 Vali Acc: 0.500 Test Loss: 8.010 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.328150272369385
Epoch: 14, Steps: 18 | Train Loss: 0.190 Vali Loss: 4.308 Vali Acc: 0.510 Test Loss: 4.308 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.369110107421875
Epoch: 15, Steps: 18 | Train Loss: 0.245 Vali Loss: 5.744 Vali Acc: 0.510 Test Loss: 5.744 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.374398708343506
Epoch: 16, Steps: 18 | Train Loss: 0.085 Vali Loss: 2.778 Vali Acc: 0.580 Test Loss: 2.778 Test Acc: 0.580
Validation loss decreased (-0.569974 --> -0.579972).  Saving model ...
Epoch: 17 cost time: 6.60779881477356
Epoch: 17, Steps: 18 | Train Loss: 0.174 Vali Loss: 3.986 Vali Acc: 0.510 Test Loss: 3.986 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.712023735046387
Epoch: 18, Steps: 18 | Train Loss: 0.280 Vali Loss: 3.757 Vali Acc: 0.560 Test Loss: 3.757 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.143882513046265
Epoch: 19, Steps: 18 | Train Loss: 0.148 Vali Loss: 3.004 Vali Acc: 0.490 Test Loss: 3.004 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.490872144699097
Epoch: 20, Steps: 18 | Train Loss: 0.030 Vali Loss: 3.710 Vali Acc: 0.530 Test Loss: 3.710 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.4874725341796875
Epoch: 21, Steps: 18 | Train Loss: 0.153 Vali Loss: 4.518 Vali Acc: 0.550 Test Loss: 4.518 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.4022204875946045
Epoch: 22, Steps: 18 | Train Loss: 0.234 Vali Loss: 6.805 Vali Acc: 0.530 Test Loss: 6.805 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.822664260864258
Epoch: 23, Steps: 18 | Train Loss: 0.166 Vali Loss: 4.216 Vali Acc: 0.480 Test Loss: 4.216 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.553614616394043
Epoch: 24, Steps: 18 | Train Loss: 0.395 Vali Loss: 5.876 Vali Acc: 0.520 Test Loss: 5.876 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.1471943855285645
Epoch: 25, Steps: 18 | Train Loss: 0.297 Vali Loss: 8.682 Vali Acc: 0.520 Test Loss: 8.682 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.294560432434082
Epoch: 26, Steps: 18 | Train Loss: 0.110 Vali Loss: 8.535 Vali Acc: 0.530 Test Loss: 8.535 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1847426
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.136874675750732
Epoch: 1, Steps: 18 | Train Loss: 1.017 Vali Loss: 1.556 Vali Acc: 0.530 Test Loss: 1.556 Test Acc: 0.530
Validation loss decreased (inf --> -0.529984).  Saving model ...
Epoch: 2 cost time: 17.9764347076416
Epoch: 2, Steps: 18 | Train Loss: 0.841 Vali Loss: 1.479 Vali Acc: 0.510 Test Loss: 1.479 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.664467811584473
Epoch: 3, Steps: 18 | Train Loss: 0.641 Vali Loss: 1.931 Vali Acc: 0.480 Test Loss: 1.931 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 20.423994779586792
Epoch: 4, Steps: 18 | Train Loss: 1.032 Vali Loss: 2.300 Vali Acc: 0.470 Test Loss: 2.300 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.500832557678223
Epoch: 5, Steps: 18 | Train Loss: 0.739 Vali Loss: 4.698 Vali Acc: 0.500 Test Loss: 4.698 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 21.060579299926758
Epoch: 6, Steps: 18 | Train Loss: 1.084 Vali Loss: 2.623 Vali Acc: 0.500 Test Loss: 2.623 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 19.483336448669434
Epoch: 7, Steps: 18 | Train Loss: 1.233 Vali Loss: 2.313 Vali Acc: 0.540 Test Loss: 2.313 Test Acc: 0.540
Validation loss decreased (-0.529984 --> -0.539977).  Saving model ...
Epoch: 8 cost time: 19.398004293441772
Epoch: 8, Steps: 18 | Train Loss: 0.348 Vali Loss: 2.971 Vali Acc: 0.530 Test Loss: 2.971 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.643269538879395
Epoch: 9, Steps: 18 | Train Loss: 1.073 Vali Loss: 5.341 Vali Acc: 0.540 Test Loss: 5.341 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.303694009780884
Epoch: 10, Steps: 18 | Train Loss: 1.470 Vali Loss: 8.138 Vali Acc: 0.530 Test Loss: 8.138 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 21.683165788650513
Epoch: 11, Steps: 18 | Train Loss: 2.251 Vali Loss: 9.487 Vali Acc: 0.510 Test Loss: 9.487 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 20.058923721313477
Epoch: 12, Steps: 18 | Train Loss: 0.900 Vali Loss: 4.355 Vali Acc: 0.530 Test Loss: 4.355 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 21.0711030960083
Epoch: 13, Steps: 18 | Train Loss: 1.627 Vali Loss: 18.528 Vali Acc: 0.500 Test Loss: 18.528 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 20.295655727386475
Epoch: 14, Steps: 18 | Train Loss: 3.108 Vali Loss: 13.326 Vali Acc: 0.520 Test Loss: 13.326 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 21.20974612236023
Epoch: 15, Steps: 18 | Train Loss: 0.683 Vali Loss: 14.491 Vali Acc: 0.520 Test Loss: 14.491 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 22.5492205619812
Epoch: 16, Steps: 18 | Train Loss: 0.479 Vali Loss: 9.812 Vali Acc: 0.560 Test Loss: 9.812 Test Acc: 0.560
Validation loss decreased (-0.539977 --> -0.559902).  Saving model ...
Epoch: 17 cost time: 22.635468244552612
Epoch: 17, Steps: 18 | Train Loss: 0.204 Vali Loss: 7.260 Vali Acc: 0.500 Test Loss: 7.260 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 21.997777700424194
Epoch: 18, Steps: 18 | Train Loss: 0.382 Vali Loss: 7.783 Vali Acc: 0.590 Test Loss: 7.783 Test Acc: 0.590
Validation loss decreased (-0.559902 --> -0.589922).  Saving model ...
Epoch: 19 cost time: 22.0112726688385
Epoch: 19, Steps: 18 | Train Loss: 0.594 Vali Loss: 14.373 Vali Acc: 0.520 Test Loss: 14.373 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 22.688028812408447
Epoch: 20, Steps: 18 | Train Loss: 0.246 Vali Loss: 10.119 Vali Acc: 0.490 Test Loss: 10.119 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 23.630573511123657
Epoch: 21, Steps: 18 | Train Loss: 0.642 Vali Loss: 11.849 Vali Acc: 0.510 Test Loss: 11.849 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 25.11363196372986
Epoch: 22, Steps: 18 | Train Loss: 0.559 Vali Loss: 9.831 Vali Acc: 0.480 Test Loss: 9.831 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 23.82639479637146
Epoch: 23, Steps: 18 | Train Loss: 0.798 Vali Loss: 21.520 Vali Acc: 0.510 Test Loss: 21.520 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 22.71916890144348
Epoch: 24, Steps: 18 | Train Loss: 0.616 Vali Loss: 9.583 Vali Acc: 0.590 Test Loss: 9.583 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 26.452876329421997
Epoch: 25, Steps: 18 | Train Loss: 0.354 Vali Loss: 15.160 Vali Acc: 0.510 Test Loss: 15.160 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 27.64821147918701
Epoch: 26, Steps: 18 | Train Loss: 0.253 Vali Loss: 10.317 Vali Acc: 0.520 Test Loss: 10.317 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 25.451844930648804
Epoch: 27, Steps: 18 | Train Loss: 0.228 Vali Loss: 16.067 Vali Acc: 0.510 Test Loss: 16.067 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 25.621410608291626
Epoch: 28, Steps: 18 | Train Loss: 0.252 Vali Loss: 29.512 Vali Acc: 0.520 Test Loss: 29.512 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1650818
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.137226819992065
Epoch: 1, Steps: 18 | Train Loss: 1.065 Vali Loss: 1.138 Vali Acc: 0.570 Test Loss: 1.138 Test Acc: 0.570
Validation loss decreased (inf --> -0.569989).  Saving model ...
Epoch: 2 cost time: 16.6694073677063
Epoch: 2, Steps: 18 | Train Loss: 0.837 Vali Loss: 1.529 Vali Acc: 0.550 Test Loss: 1.529 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.023245334625244
Epoch: 3, Steps: 18 | Train Loss: 1.213 Vali Loss: 2.416 Vali Acc: 0.480 Test Loss: 2.416 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.369176626205444
Epoch: 4, Steps: 18 | Train Loss: 0.747 Vali Loss: 4.245 Vali Acc: 0.430 Test Loss: 4.245 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.038689374923706
Epoch: 5, Steps: 18 | Train Loss: 0.792 Vali Loss: 2.709 Vali Acc: 0.520 Test Loss: 2.709 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 16.68004536628723
Epoch: 6, Steps: 18 | Train Loss: 1.107 Vali Loss: 6.976 Vali Acc: 0.500 Test Loss: 6.976 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 17.841725826263428
Epoch: 7, Steps: 18 | Train Loss: 1.437 Vali Loss: 4.513 Vali Acc: 0.500 Test Loss: 4.513 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 16.427175521850586
Epoch: 8, Steps: 18 | Train Loss: 0.743 Vali Loss: 2.806 Vali Acc: 0.540 Test Loss: 2.806 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 18.65265154838562
Epoch: 9, Steps: 18 | Train Loss: 1.198 Vali Loss: 11.257 Vali Acc: 0.510 Test Loss: 11.257 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 16.437790155410767
Epoch: 10, Steps: 18 | Train Loss: 0.918 Vali Loss: 4.127 Vali Acc: 0.530 Test Loss: 4.127 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 16.35871696472168
Epoch: 11, Steps: 18 | Train Loss: 0.759 Vali Loss: 4.475 Vali Acc: 0.570 Test Loss: 4.475 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1650818
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.137750148773193
Epoch: 1, Steps: 18 | Train Loss: 1.132 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 14.98859429359436
Epoch: 2, Steps: 18 | Train Loss: 0.815 Vali Loss: 2.148 Vali Acc: 0.520 Test Loss: 2.148 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.81917691230774
Epoch: 3, Steps: 18 | Train Loss: 1.211 Vali Loss: 5.099 Vali Acc: 0.500 Test Loss: 5.099 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.590909957885742
Epoch: 4, Steps: 18 | Train Loss: 3.057 Vali Loss: 2.500 Vali Acc: 0.510 Test Loss: 2.500 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.46348524093628
Epoch: 5, Steps: 18 | Train Loss: 1.012 Vali Loss: 2.525 Vali Acc: 0.550 Test Loss: 2.525 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549975).  Saving model ...
Epoch: 6 cost time: 13.187665700912476
Epoch: 6, Steps: 18 | Train Loss: 0.797 Vali Loss: 4.698 Vali Acc: 0.530 Test Loss: 4.698 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.147005081176758
Epoch: 7, Steps: 18 | Train Loss: 0.585 Vali Loss: 2.458 Vali Acc: 0.580 Test Loss: 2.458 Test Acc: 0.580
Validation loss decreased (-0.549975 --> -0.579975).  Saving model ...
Epoch: 8 cost time: 14.443009614944458
Epoch: 8, Steps: 18 | Train Loss: 0.996 Vali Loss: 4.908 Vali Acc: 0.470 Test Loss: 4.908 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.256388902664185
Epoch: 9, Steps: 18 | Train Loss: 0.998 Vali Loss: 4.690 Vali Acc: 0.570 Test Loss: 4.690 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.727283239364624
Epoch: 10, Steps: 18 | Train Loss: 0.282 Vali Loss: 6.566 Vali Acc: 0.500 Test Loss: 6.566 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.773923635482788
Epoch: 11, Steps: 18 | Train Loss: 0.937 Vali Loss: 5.834 Vali Acc: 0.510 Test Loss: 5.834 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.340573072433472
Epoch: 12, Steps: 18 | Train Loss: 0.488 Vali Loss: 6.568 Vali Acc: 0.550 Test Loss: 6.568 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.231061458587646
Epoch: 13, Steps: 18 | Train Loss: 0.966 Vali Loss: 5.292 Vali Acc: 0.600 Test Loss: 5.292 Test Acc: 0.600
Validation loss decreased (-0.579975 --> -0.599947).  Saving model ...
Epoch: 14 cost time: 13.974708557128906
Epoch: 14, Steps: 18 | Train Loss: 0.605 Vali Loss: 6.870 Vali Acc: 0.550 Test Loss: 6.870 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 15.61946177482605
Epoch: 15, Steps: 18 | Train Loss: 0.996 Vali Loss: 18.975 Vali Acc: 0.510 Test Loss: 18.975 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 16.110015869140625
Epoch: 16, Steps: 18 | Train Loss: 0.735 Vali Loss: 7.958 Vali Acc: 0.600 Test Loss: 7.958 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 15.754234313964844
Epoch: 17, Steps: 18 | Train Loss: 0.529 Vali Loss: 7.343 Vali Acc: 0.570 Test Loss: 7.343 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 16.19092345237732
Epoch: 18, Steps: 18 | Train Loss: 0.259 Vali Loss: 10.232 Vali Acc: 0.560 Test Loss: 10.232 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 15.940864562988281
Epoch: 19, Steps: 18 | Train Loss: 0.519 Vali Loss: 13.706 Vali Acc: 0.480 Test Loss: 13.706 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 15.714664936065674
Epoch: 20, Steps: 18 | Train Loss: 0.329 Vali Loss: 21.346 Vali Acc: 0.510 Test Loss: 21.346 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 15.702132225036621
Epoch: 21, Steps: 18 | Train Loss: 1.444 Vali Loss: 14.755 Vali Acc: 0.510 Test Loss: 14.755 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 17.649131059646606
Epoch: 22, Steps: 18 | Train Loss: 1.399 Vali Loss: 11.565 Vali Acc: 0.520 Test Loss: 11.565 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 18.191564798355103
Epoch: 23, Steps: 18 | Train Loss: 0.521 Vali Loss: 10.700 Vali Acc: 0.530 Test Loss: 10.700 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1650818
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.305649757385254
Epoch: 1, Steps: 18 | Train Loss: 1.040 Vali Loss: 0.883 Vali Acc: 0.510 Test Loss: 0.883 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 10.15874195098877
Epoch: 2, Steps: 18 | Train Loss: 1.084 Vali Loss: 1.020 Vali Acc: 0.550 Test Loss: 1.020 Test Acc: 0.550
Validation loss decreased (-0.509991 --> -0.549990).  Saving model ...
Epoch: 3 cost time: 11.419254541397095
Epoch: 3, Steps: 18 | Train Loss: 0.814 Vali Loss: 1.686 Vali Acc: 0.530 Test Loss: 1.686 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.899576425552368
Epoch: 4, Steps: 18 | Train Loss: 1.199 Vali Loss: 3.023 Vali Acc: 0.490 Test Loss: 3.023 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.13249921798706
Epoch: 5, Steps: 18 | Train Loss: 0.549 Vali Loss: 5.721 Vali Acc: 0.530 Test Loss: 5.721 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.228065967559814
Epoch: 6, Steps: 18 | Train Loss: 0.880 Vali Loss: 2.103 Vali Acc: 0.570 Test Loss: 2.103 Test Acc: 0.570
Validation loss decreased (-0.549990 --> -0.569979).  Saving model ...
Epoch: 7 cost time: 11.866686344146729
Epoch: 7, Steps: 18 | Train Loss: 0.564 Vali Loss: 7.557 Vali Acc: 0.530 Test Loss: 7.557 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.18622350692749
Epoch: 8, Steps: 18 | Train Loss: 1.997 Vali Loss: 3.749 Vali Acc: 0.500 Test Loss: 3.749 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.288738489151001
Epoch: 9, Steps: 18 | Train Loss: 0.632 Vali Loss: 4.915 Vali Acc: 0.490 Test Loss: 4.915 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.733832836151123
Epoch: 10, Steps: 18 | Train Loss: 1.227 Vali Loss: 5.666 Vali Acc: 0.520 Test Loss: 5.666 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.549869775772095
Epoch: 11, Steps: 18 | Train Loss: 1.342 Vali Loss: 7.972 Vali Acc: 0.450 Test Loss: 7.972 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.763077020645142
Epoch: 12, Steps: 18 | Train Loss: 0.849 Vali Loss: 5.829 Vali Acc: 0.580 Test Loss: 5.829 Test Acc: 0.580
Validation loss decreased (-0.569979 --> -0.579942).  Saving model ...
Epoch: 13 cost time: 11.989573955535889
Epoch: 13, Steps: 18 | Train Loss: 0.669 Vali Loss: 7.876 Vali Acc: 0.520 Test Loss: 7.876 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.689401388168335
Epoch: 14, Steps: 18 | Train Loss: 0.233 Vali Loss: 13.405 Vali Acc: 0.480 Test Loss: 13.405 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.449564695358276
Epoch: 15, Steps: 18 | Train Loss: 0.816 Vali Loss: 5.925 Vali Acc: 0.600 Test Loss: 5.925 Test Acc: 0.600
Validation loss decreased (-0.579942 --> -0.599941).  Saving model ...
Epoch: 16 cost time: 11.927353382110596
Epoch: 16, Steps: 18 | Train Loss: 0.521 Vali Loss: 8.481 Vali Acc: 0.530 Test Loss: 8.481 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.056984186172485
Epoch: 17, Steps: 18 | Train Loss: 0.541 Vali Loss: 14.095 Vali Acc: 0.520 Test Loss: 14.095 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.182772397994995
Epoch: 18, Steps: 18 | Train Loss: 0.253 Vali Loss: 7.852 Vali Acc: 0.500 Test Loss: 7.852 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.882731676101685
Epoch: 19, Steps: 18 | Train Loss: 0.336 Vali Loss: 15.436 Vali Acc: 0.490 Test Loss: 15.436 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.49358582496643
Epoch: 20, Steps: 18 | Train Loss: 0.395 Vali Loss: 10.065 Vali Acc: 0.560 Test Loss: 10.065 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 12.087584495544434
Epoch: 21, Steps: 18 | Train Loss: 0.655 Vali Loss: 25.526 Vali Acc: 0.500 Test Loss: 25.526 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 14.077806234359741
Epoch: 22, Steps: 18 | Train Loss: 0.916 Vali Loss: 9.470 Vali Acc: 0.600 Test Loss: 9.470 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 13.270214319229126
Epoch: 23, Steps: 18 | Train Loss: 0.571 Vali Loss: 11.231 Vali Acc: 0.540 Test Loss: 11.231 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 14.354425430297852
Epoch: 24, Steps: 18 | Train Loss: 0.463 Vali Loss: 15.244 Vali Acc: 0.530 Test Loss: 15.244 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 13.73362135887146
Epoch: 25, Steps: 18 | Train Loss: 0.256 Vali Loss: 12.676 Vali Acc: 0.590 Test Loss: 12.676 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1650818
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.140296936035156
Epoch: 1, Steps: 18 | Train Loss: 1.029 Vali Loss: 0.855 Vali Acc: 0.470 Test Loss: 0.855 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 8.73272156715393
Epoch: 2, Steps: 18 | Train Loss: 0.842 Vali Loss: 3.450 Vali Acc: 0.490 Test Loss: 3.450 Test Acc: 0.490
Validation loss decreased (-0.469991 --> -0.489965).  Saving model ...
Epoch: 3 cost time: 9.481862783432007
Epoch: 3, Steps: 18 | Train Loss: 1.400 Vali Loss: 1.944 Vali Acc: 0.510 Test Loss: 1.944 Test Acc: 0.510
Validation loss decreased (-0.489965 --> -0.509981).  Saving model ...
Epoch: 4 cost time: 9.317397117614746
Epoch: 4, Steps: 18 | Train Loss: 0.653 Vali Loss: 2.094 Vali Acc: 0.600 Test Loss: 2.094 Test Acc: 0.600
Validation loss decreased (-0.509981 --> -0.599979).  Saving model ...
Epoch: 5 cost time: 8.832185983657837
Epoch: 5, Steps: 18 | Train Loss: 0.536 Vali Loss: 1.896 Vali Acc: 0.530 Test Loss: 1.896 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.003360509872437
Epoch: 6, Steps: 18 | Train Loss: 0.739 Vali Loss: 3.557 Vali Acc: 0.540 Test Loss: 3.557 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.237293004989624
Epoch: 7, Steps: 18 | Train Loss: 1.189 Vali Loss: 2.703 Vali Acc: 0.570 Test Loss: 2.703 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.68786358833313
Epoch: 8, Steps: 18 | Train Loss: 0.657 Vali Loss: 3.234 Vali Acc: 0.490 Test Loss: 3.234 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.259871482849121
Epoch: 9, Steps: 18 | Train Loss: 0.594 Vali Loss: 4.743 Vali Acc: 0.550 Test Loss: 4.743 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.503222465515137
Epoch: 10, Steps: 18 | Train Loss: 0.478 Vali Loss: 4.437 Vali Acc: 0.580 Test Loss: 4.437 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.573448419570923
Epoch: 11, Steps: 18 | Train Loss: 0.605 Vali Loss: 11.487 Vali Acc: 0.500 Test Loss: 11.487 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.471347093582153
Epoch: 12, Steps: 18 | Train Loss: 1.653 Vali Loss: 10.820 Vali Acc: 0.520 Test Loss: 10.820 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 9.120957851409912
Epoch: 13, Steps: 18 | Train Loss: 1.372 Vali Loss: 13.161 Vali Acc: 0.500 Test Loss: 13.161 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.483850240707397
Epoch: 14, Steps: 18 | Train Loss: 0.949 Vali Loss: 5.497 Vali Acc: 0.560 Test Loss: 5.497 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1650818
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.631824731826782
Epoch: 1, Steps: 18 | Train Loss: 1.024 Vali Loss: 0.843 Vali Acc: 0.560 Test Loss: 0.843 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 7.067890882492065
Epoch: 2, Steps: 18 | Train Loss: 0.701 Vali Loss: 2.787 Vali Acc: 0.500 Test Loss: 2.787 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.119218349456787
Epoch: 3, Steps: 18 | Train Loss: 0.559 Vali Loss: 3.060 Vali Acc: 0.510 Test Loss: 3.060 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.184065580368042
Epoch: 4, Steps: 18 | Train Loss: 0.628 Vali Loss: 1.589 Vali Acc: 0.490 Test Loss: 1.589 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.36824631690979
Epoch: 5, Steps: 18 | Train Loss: 0.328 Vali Loss: 4.307 Vali Acc: 0.510 Test Loss: 4.307 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.153733730316162
Epoch: 6, Steps: 18 | Train Loss: 0.847 Vali Loss: 2.056 Vali Acc: 0.540 Test Loss: 2.056 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.119393825531006
Epoch: 7, Steps: 18 | Train Loss: 0.800 Vali Loss: 2.742 Vali Acc: 0.580 Test Loss: 2.742 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579973).  Saving model ...
Epoch: 8 cost time: 6.953686237335205
Epoch: 8, Steps: 18 | Train Loss: 1.168 Vali Loss: 6.981 Vali Acc: 0.520 Test Loss: 6.981 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.4498374462127686
Epoch: 9, Steps: 18 | Train Loss: 1.584 Vali Loss: 13.208 Vali Acc: 0.500 Test Loss: 13.208 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.779341220855713
Epoch: 10, Steps: 18 | Train Loss: 0.737 Vali Loss: 5.859 Vali Acc: 0.520 Test Loss: 5.859 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.530384540557861
Epoch: 11, Steps: 18 | Train Loss: 0.641 Vali Loss: 4.181 Vali Acc: 0.520 Test Loss: 4.181 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.8583173751831055
Epoch: 12, Steps: 18 | Train Loss: 0.491 Vali Loss: 3.980 Vali Acc: 0.570 Test Loss: 3.980 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.099685192108154
Epoch: 13, Steps: 18 | Train Loss: 1.336 Vali Loss: 11.179 Vali Acc: 0.530 Test Loss: 11.179 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.826435327529907
Epoch: 14, Steps: 18 | Train Loss: 0.989 Vali Loss: 9.873 Vali Acc: 0.520 Test Loss: 9.873 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.4091784954071045
Epoch: 15, Steps: 18 | Train Loss: 0.354 Vali Loss: 6.104 Vali Acc: 0.560 Test Loss: 6.104 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.027159452438354
Epoch: 16, Steps: 18 | Train Loss: 0.119 Vali Loss: 6.564 Vali Acc: 0.560 Test Loss: 6.564 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.995917797088623
Epoch: 17, Steps: 18 | Train Loss: 0.651 Vali Loss: 12.468 Vali Acc: 0.540 Test Loss: 12.468 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1650818
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.247079610824585
Epoch: 1, Steps: 18 | Train Loss: 0.874 Vali Loss: 0.775 Vali Acc: 0.620 Test Loss: 0.775 Test Acc: 0.620
Validation loss decreased (inf --> -0.619992).  Saving model ...
Epoch: 2 cost time: 6.732208251953125
Epoch: 2, Steps: 18 | Train Loss: 0.777 Vali Loss: 1.121 Vali Acc: 0.510 Test Loss: 1.121 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.978663682937622
Epoch: 3, Steps: 18 | Train Loss: 0.547 Vali Loss: 3.002 Vali Acc: 0.520 Test Loss: 3.002 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.682772159576416
Epoch: 4, Steps: 18 | Train Loss: 0.819 Vali Loss: 1.864 Vali Acc: 0.550 Test Loss: 1.864 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.581469297409058
Epoch: 5, Steps: 18 | Train Loss: 1.180 Vali Loss: 3.670 Vali Acc: 0.450 Test Loss: 3.670 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.657243490219116
Epoch: 6, Steps: 18 | Train Loss: 0.828 Vali Loss: 4.887 Vali Acc: 0.460 Test Loss: 4.887 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.689223289489746
Epoch: 7, Steps: 18 | Train Loss: 1.019 Vali Loss: 3.228 Vali Acc: 0.500 Test Loss: 3.228 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.63972544670105
Epoch: 8, Steps: 18 | Train Loss: 0.788 Vali Loss: 2.637 Vali Acc: 0.550 Test Loss: 2.637 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.668359041213989
Epoch: 9, Steps: 18 | Train Loss: 0.588 Vali Loss: 3.509 Vali Acc: 0.490 Test Loss: 3.509 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.054504871368408
Epoch: 10, Steps: 18 | Train Loss: 0.303 Vali Loss: 7.391 Vali Acc: 0.490 Test Loss: 7.391 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.98459005355835
Epoch: 11, Steps: 18 | Train Loss: 1.184 Vali Loss: 4.428 Vali Acc: 0.620 Test Loss: 4.428 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1650818
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.9076619148254395
Epoch: 1, Steps: 18 | Train Loss: 0.874 Vali Loss: 1.004 Vali Acc: 0.500 Test Loss: 1.004 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 6.793881177902222
Epoch: 2, Steps: 18 | Train Loss: 0.852 Vali Loss: 1.079 Vali Acc: 0.530 Test Loss: 1.079 Test Acc: 0.530
Validation loss decreased (-0.499990 --> -0.529989).  Saving model ...
Epoch: 3 cost time: 7.034116506576538
Epoch: 3, Steps: 18 | Train Loss: 0.521 Vali Loss: 2.839 Vali Acc: 0.500 Test Loss: 2.839 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.752684116363525
Epoch: 4, Steps: 18 | Train Loss: 0.545 Vali Loss: 1.630 Vali Acc: 0.510 Test Loss: 1.630 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.9204323291778564
Epoch: 5, Steps: 18 | Train Loss: 0.405 Vali Loss: 1.559 Vali Acc: 0.590 Test Loss: 1.559 Test Acc: 0.590
Validation loss decreased (-0.529989 --> -0.589984).  Saving model ...
Epoch: 6 cost time: 7.160362005233765
Epoch: 6, Steps: 18 | Train Loss: 0.629 Vali Loss: 3.681 Vali Acc: 0.500 Test Loss: 3.681 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.86634635925293
Epoch: 7, Steps: 18 | Train Loss: 0.313 Vali Loss: 3.070 Vali Acc: 0.540 Test Loss: 3.070 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.348674774169922
Epoch: 8, Steps: 18 | Train Loss: 0.440 Vali Loss: 2.947 Vali Acc: 0.570 Test Loss: 2.947 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.924870014190674
Epoch: 9, Steps: 18 | Train Loss: 0.709 Vali Loss: 7.743 Vali Acc: 0.510 Test Loss: 7.743 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.696767807006836
Epoch: 10, Steps: 18 | Train Loss: 0.590 Vali Loss: 5.466 Vali Acc: 0.530 Test Loss: 5.466 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.732816934585571
Epoch: 11, Steps: 18 | Train Loss: 0.526 Vali Loss: 11.545 Vali Acc: 0.520 Test Loss: 11.545 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.873315095901489
Epoch: 12, Steps: 18 | Train Loss: 0.744 Vali Loss: 3.533 Vali Acc: 0.600 Test Loss: 3.533 Test Acc: 0.600
Validation loss decreased (-0.589984 --> -0.599965).  Saving model ...
Epoch: 13 cost time: 6.971628189086914
Epoch: 13, Steps: 18 | Train Loss: 0.493 Vali Loss: 13.476 Vali Acc: 0.480 Test Loss: 13.476 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.001387119293213
Epoch: 14, Steps: 18 | Train Loss: 1.458 Vali Loss: 4.245 Vali Acc: 0.570 Test Loss: 4.245 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.619922876358032
Epoch: 15, Steps: 18 | Train Loss: 0.434 Vali Loss: 6.588 Vali Acc: 0.540 Test Loss: 6.588 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.8069446086883545
Epoch: 16, Steps: 18 | Train Loss: 0.270 Vali Loss: 5.581 Vali Acc: 0.570 Test Loss: 5.581 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.277852535247803
Epoch: 17, Steps: 18 | Train Loss: 1.156 Vali Loss: 7.819 Vali Acc: 0.530 Test Loss: 7.819 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.596108436584473
Epoch: 18, Steps: 18 | Train Loss: 0.679 Vali Loss: 18.858 Vali Acc: 0.500 Test Loss: 18.858 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.043207168579102
Epoch: 19, Steps: 18 | Train Loss: 1.459 Vali Loss: 8.490 Vali Acc: 0.510 Test Loss: 8.490 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.194037199020386
Epoch: 20, Steps: 18 | Train Loss: 0.186 Vali Loss: 12.151 Vali Acc: 0.530 Test Loss: 12.151 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.711796760559082
Epoch: 21, Steps: 18 | Train Loss: 0.261 Vali Loss: 6.945 Vali Acc: 0.500 Test Loss: 6.945 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.025482416152954
Epoch: 22, Steps: 18 | Train Loss: 0.183 Vali Loss: 8.218 Vali Acc: 0.550 Test Loss: 8.218 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1650818
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.687853813171387
Epoch: 1, Steps: 18 | Train Loss: 0.881 Vali Loss: 1.060 Vali Acc: 0.410 Test Loss: 1.060 Test Acc: 0.410
Validation loss decreased (inf --> -0.409989).  Saving model ...
Epoch: 2 cost time: 6.67730450630188
Epoch: 2, Steps: 18 | Train Loss: 0.634 Vali Loss: 1.603 Vali Acc: 0.450 Test Loss: 1.603 Test Acc: 0.450
Validation loss decreased (-0.409989 --> -0.449984).  Saving model ...
Epoch: 3 cost time: 6.720874547958374
Epoch: 3, Steps: 18 | Train Loss: 0.552 Vali Loss: 3.669 Vali Acc: 0.480 Test Loss: 3.669 Test Acc: 0.480
Validation loss decreased (-0.449984 --> -0.479963).  Saving model ...
Epoch: 4 cost time: 6.655758619308472
Epoch: 4, Steps: 18 | Train Loss: 0.680 Vali Loss: 3.306 Vali Acc: 0.510 Test Loss: 3.306 Test Acc: 0.510
Validation loss decreased (-0.479963 --> -0.509967).  Saving model ...
Epoch: 5 cost time: 6.529940128326416
Epoch: 5, Steps: 18 | Train Loss: 0.820 Vali Loss: 2.980 Vali Acc: 0.510 Test Loss: 2.980 Test Acc: 0.510
Validation loss decreased (-0.509967 --> -0.509970).  Saving model ...
Epoch: 6 cost time: 6.796511173248291
Epoch: 6, Steps: 18 | Train Loss: 0.415 Vali Loss: 2.145 Vali Acc: 0.570 Test Loss: 2.145 Test Acc: 0.570
Validation loss decreased (-0.509970 --> -0.569979).  Saving model ...
Epoch: 7 cost time: 6.638331890106201
Epoch: 7, Steps: 18 | Train Loss: 0.462 Vali Loss: 3.986 Vali Acc: 0.460 Test Loss: 3.986 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.554981470108032
Epoch: 8, Steps: 18 | Train Loss: 0.773 Vali Loss: 4.611 Vali Acc: 0.420 Test Loss: 4.611 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.493598699569702
Epoch: 9, Steps: 18 | Train Loss: 0.465 Vali Loss: 2.095 Vali Acc: 0.480 Test Loss: 2.095 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.988077878952026
Epoch: 10, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.898 Vali Acc: 0.560 Test Loss: 1.898 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.7378575801849365
Epoch: 11, Steps: 18 | Train Loss: 0.505 Vali Loss: 9.337 Vali Acc: 0.440 Test Loss: 9.337 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.808243989944458
Epoch: 12, Steps: 18 | Train Loss: 0.306 Vali Loss: 5.174 Vali Acc: 0.520 Test Loss: 5.174 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.577351093292236
Epoch: 13, Steps: 18 | Train Loss: 0.318 Vali Loss: 4.913 Vali Acc: 0.520 Test Loss: 4.913 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.535167694091797
Epoch: 14, Steps: 18 | Train Loss: 0.376 Vali Loss: 4.290 Vali Acc: 0.540 Test Loss: 4.290 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.73764181137085
Epoch: 15, Steps: 18 | Train Loss: 0.220 Vali Loss: 10.509 Vali Acc: 0.480 Test Loss: 10.509 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.524407625198364
Epoch: 16, Steps: 18 | Train Loss: 0.843 Vali Loss: 9.113 Vali Acc: 0.500 Test Loss: 9.113 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1650818
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.990799903869629
Epoch: 1, Steps: 18 | Train Loss: 0.806 Vali Loss: 0.703 Vali Acc: 0.570 Test Loss: 0.703 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 6.456602334976196
Epoch: 2, Steps: 18 | Train Loss: 0.658 Vali Loss: 2.162 Vali Acc: 0.500 Test Loss: 2.162 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.725970983505249
Epoch: 3, Steps: 18 | Train Loss: 0.951 Vali Loss: 0.866 Vali Acc: 0.520 Test Loss: 0.866 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.85404634475708
Epoch: 4, Steps: 18 | Train Loss: 0.571 Vali Loss: 1.112 Vali Acc: 0.510 Test Loss: 1.112 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.3862926959991455
Epoch: 5, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.447 Vali Acc: 0.500 Test Loss: 1.447 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.554513216018677
Epoch: 6, Steps: 18 | Train Loss: 1.059 Vali Loss: 1.474 Vali Acc: 0.500 Test Loss: 1.474 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.526625871658325
Epoch: 7, Steps: 18 | Train Loss: 0.623 Vali Loss: 1.262 Vali Acc: 0.530 Test Loss: 1.262 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.487393617630005
Epoch: 8, Steps: 18 | Train Loss: 0.900 Vali Loss: 1.339 Vali Acc: 0.630 Test Loss: 1.339 Test Acc: 0.630
Validation loss decreased (-0.569993 --> -0.629987).  Saving model ...
Epoch: 9 cost time: 6.488131523132324
Epoch: 9, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.865 Vali Acc: 0.540 Test Loss: 1.865 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.309903383255005
Epoch: 10, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.316 Vali Acc: 0.500 Test Loss: 1.316 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.259693384170532
Epoch: 11, Steps: 18 | Train Loss: 0.336 Vali Loss: 4.253 Vali Acc: 0.510 Test Loss: 4.253 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.399127006530762
Epoch: 12, Steps: 18 | Train Loss: 0.645 Vali Loss: 2.394 Vali Acc: 0.550 Test Loss: 2.394 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.3600122928619385
Epoch: 13, Steps: 18 | Train Loss: 0.400 Vali Loss: 2.682 Vali Acc: 0.520 Test Loss: 2.682 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.348582029342651
Epoch: 14, Steps: 18 | Train Loss: 0.213 Vali Loss: 2.552 Vali Acc: 0.540 Test Loss: 2.552 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.525303363800049
Epoch: 15, Steps: 18 | Train Loss: 0.113 Vali Loss: 9.211 Vali Acc: 0.500 Test Loss: 9.211 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.486679315567017
Epoch: 16, Steps: 18 | Train Loss: 0.406 Vali Loss: 2.950 Vali Acc: 0.520 Test Loss: 2.950 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.504220247268677
Epoch: 17, Steps: 18 | Train Loss: 0.186 Vali Loss: 6.576 Vali Acc: 0.500 Test Loss: 6.576 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.4885687828063965
Epoch: 18, Steps: 18 | Train Loss: 0.100 Vali Loss: 4.726 Vali Acc: 0.500 Test Loss: 4.726 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1650818
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.298847675323486
Epoch: 1, Steps: 18 | Train Loss: 1.041 Vali Loss: 1.243 Vali Acc: 0.580 Test Loss: 1.243 Test Acc: 0.580
Validation loss decreased (inf --> -0.579988).  Saving model ...
Epoch: 2 cost time: 18.59125804901123
Epoch: 2, Steps: 18 | Train Loss: 1.044 Vali Loss: 1.144 Vali Acc: 0.550 Test Loss: 1.144 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.668002128601074
Epoch: 3, Steps: 18 | Train Loss: 0.718 Vali Loss: 1.664 Vali Acc: 0.500 Test Loss: 1.664 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 20.035576820373535
Epoch: 4, Steps: 18 | Train Loss: 1.117 Vali Loss: 1.897 Vali Acc: 0.620 Test Loss: 1.897 Test Acc: 0.620
Validation loss decreased (-0.579988 --> -0.619981).  Saving model ...
Epoch: 5 cost time: 20.516921043395996
Epoch: 5, Steps: 18 | Train Loss: 0.881 Vali Loss: 3.626 Vali Acc: 0.530 Test Loss: 3.626 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.17315411567688
Epoch: 6, Steps: 18 | Train Loss: 0.960 Vali Loss: 2.946 Vali Acc: 0.500 Test Loss: 2.946 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 18.230738401412964
Epoch: 7, Steps: 18 | Train Loss: 0.749 Vali Loss: 3.051 Vali Acc: 0.570 Test Loss: 3.051 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 20.017843008041382
Epoch: 8, Steps: 18 | Train Loss: 1.371 Vali Loss: 5.123 Vali Acc: 0.520 Test Loss: 5.123 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 19.474458932876587
Epoch: 9, Steps: 18 | Train Loss: 1.017 Vali Loss: 4.351 Vali Acc: 0.530 Test Loss: 4.351 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 21.618050575256348
Epoch: 10, Steps: 18 | Train Loss: 0.681 Vali Loss: 6.010 Vali Acc: 0.610 Test Loss: 6.010 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 19.559983253479004
Epoch: 11, Steps: 18 | Train Loss: 1.487 Vali Loss: 7.608 Vali Acc: 0.520 Test Loss: 7.608 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 19.646955490112305
Epoch: 12, Steps: 18 | Train Loss: 1.178 Vali Loss: 6.676 Vali Acc: 0.530 Test Loss: 6.676 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 18.561644792556763
Epoch: 13, Steps: 18 | Train Loss: 1.317 Vali Loss: 5.929 Vali Acc: 0.540 Test Loss: 5.929 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 20.75515389442444
Epoch: 14, Steps: 18 | Train Loss: 1.028 Vali Loss: 5.923 Vali Acc: 0.580 Test Loss: 5.923 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1552514
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.712117195129395
Epoch: 1, Steps: 18 | Train Loss: 1.062 Vali Loss: 1.096 Vali Acc: 0.590 Test Loss: 1.096 Test Acc: 0.590
Validation loss decreased (inf --> -0.589989).  Saving model ...
Epoch: 2 cost time: 15.678674936294556
Epoch: 2, Steps: 18 | Train Loss: 0.920 Vali Loss: 1.246 Vali Acc: 0.480 Test Loss: 1.246 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.618810176849365
Epoch: 3, Steps: 18 | Train Loss: 0.827 Vali Loss: 1.778 Vali Acc: 0.500 Test Loss: 1.778 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.737309455871582
Epoch: 4, Steps: 18 | Train Loss: 1.144 Vali Loss: 4.188 Vali Acc: 0.570 Test Loss: 4.188 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.47114062309265
Epoch: 5, Steps: 18 | Train Loss: 1.368 Vali Loss: 4.626 Vali Acc: 0.540 Test Loss: 4.626 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 16.80162811279297
Epoch: 6, Steps: 18 | Train Loss: 1.293 Vali Loss: 5.179 Vali Acc: 0.480 Test Loss: 5.179 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 17.595974683761597
Epoch: 7, Steps: 18 | Train Loss: 0.806 Vali Loss: 8.013 Vali Acc: 0.500 Test Loss: 8.013 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 16.84648609161377
Epoch: 8, Steps: 18 | Train Loss: 0.664 Vali Loss: 7.780 Vali Acc: 0.530 Test Loss: 7.780 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 16.048505783081055
Epoch: 9, Steps: 18 | Train Loss: 0.640 Vali Loss: 9.201 Vali Acc: 0.520 Test Loss: 9.201 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 15.490805864334106
Epoch: 10, Steps: 18 | Train Loss: 0.617 Vali Loss: 6.145 Vali Acc: 0.510 Test Loss: 6.145 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 16.83282446861267
Epoch: 11, Steps: 18 | Train Loss: 0.506 Vali Loss: 4.250 Vali Acc: 0.560 Test Loss: 4.250 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1552514
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.570486783981323
Epoch: 1, Steps: 18 | Train Loss: 1.088 Vali Loss: 1.004 Vali Acc: 0.520 Test Loss: 1.004 Test Acc: 0.520
Validation loss decreased (inf --> -0.519990).  Saving model ...
Epoch: 2 cost time: 14.042059421539307
Epoch: 2, Steps: 18 | Train Loss: 0.865 Vali Loss: 1.612 Vali Acc: 0.480 Test Loss: 1.612 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.91543698310852
Epoch: 3, Steps: 18 | Train Loss: 1.507 Vali Loss: 2.545 Vali Acc: 0.510 Test Loss: 2.545 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.830094337463379
Epoch: 4, Steps: 18 | Train Loss: 1.905 Vali Loss: 4.084 Vali Acc: 0.460 Test Loss: 4.084 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.39399790763855
Epoch: 5, Steps: 18 | Train Loss: 1.075 Vali Loss: 2.090 Vali Acc: 0.570 Test Loss: 2.090 Test Acc: 0.570
Validation loss decreased (-0.519990 --> -0.569979).  Saving model ...
Epoch: 6 cost time: 14.178940057754517
Epoch: 6, Steps: 18 | Train Loss: 1.157 Vali Loss: 8.958 Vali Acc: 0.510 Test Loss: 8.958 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.427124977111816
Epoch: 7, Steps: 18 | Train Loss: 2.003 Vali Loss: 6.469 Vali Acc: 0.510 Test Loss: 6.469 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.673290967941284
Epoch: 8, Steps: 18 | Train Loss: 0.568 Vali Loss: 4.249 Vali Acc: 0.490 Test Loss: 4.249 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.188848733901978
Epoch: 9, Steps: 18 | Train Loss: 0.916 Vali Loss: 5.076 Vali Acc: 0.490 Test Loss: 5.076 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.6348717212677
Epoch: 10, Steps: 18 | Train Loss: 0.743 Vali Loss: 5.166 Vali Acc: 0.540 Test Loss: 5.166 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.72010850906372
Epoch: 11, Steps: 18 | Train Loss: 1.019 Vali Loss: 9.724 Vali Acc: 0.590 Test Loss: 9.724 Test Acc: 0.590
Validation loss decreased (-0.569979 --> -0.589903).  Saving model ...
Epoch: 12 cost time: 13.577097177505493
Epoch: 12, Steps: 18 | Train Loss: 0.857 Vali Loss: 8.369 Vali Acc: 0.490 Test Loss: 8.369 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.529015064239502
Epoch: 13, Steps: 18 | Train Loss: 0.689 Vali Loss: 7.982 Vali Acc: 0.500 Test Loss: 7.982 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.5098237991333
Epoch: 14, Steps: 18 | Train Loss: 0.583 Vali Loss: 6.951 Vali Acc: 0.510 Test Loss: 6.951 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.082629919052124
Epoch: 15, Steps: 18 | Train Loss: 0.755 Vali Loss: 5.876 Vali Acc: 0.630 Test Loss: 5.876 Test Acc: 0.630
Validation loss decreased (-0.589903 --> -0.629941).  Saving model ...
Epoch: 16 cost time: 15.135556697845459
Epoch: 16, Steps: 18 | Train Loss: 0.179 Vali Loss: 5.884 Vali Acc: 0.490 Test Loss: 5.884 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.733675718307495
Epoch: 17, Steps: 18 | Train Loss: 0.114 Vali Loss: 12.865 Vali Acc: 0.480 Test Loss: 12.865 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.756635189056396
Epoch: 18, Steps: 18 | Train Loss: 0.946 Vali Loss: 18.624 Vali Acc: 0.500 Test Loss: 18.624 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 15.021054744720459
Epoch: 19, Steps: 18 | Train Loss: 1.028 Vali Loss: 9.326 Vali Acc: 0.460 Test Loss: 9.326 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 15.500673055648804
Epoch: 20, Steps: 18 | Train Loss: 0.352 Vali Loss: 17.414 Vali Acc: 0.500 Test Loss: 17.414 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 17.13038468360901
Epoch: 21, Steps: 18 | Train Loss: 0.412 Vali Loss: 19.509 Vali Acc: 0.510 Test Loss: 19.509 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 16.527377605438232
Epoch: 22, Steps: 18 | Train Loss: 0.475 Vali Loss: 9.259 Vali Acc: 0.550 Test Loss: 9.259 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 15.772526264190674
Epoch: 23, Steps: 18 | Train Loss: 0.537 Vali Loss: 10.481 Vali Acc: 0.500 Test Loss: 10.481 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 18.32870864868164
Epoch: 24, Steps: 18 | Train Loss: 0.455 Vali Loss: 15.625 Vali Acc: 0.530 Test Loss: 15.625 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 15.904685020446777
Epoch: 25, Steps: 18 | Train Loss: 0.858 Vali Loss: 9.530 Vali Acc: 0.550 Test Loss: 9.530 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1552514
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.024048566818237
Epoch: 1, Steps: 18 | Train Loss: 1.072 Vali Loss: 0.810 Vali Acc: 0.530 Test Loss: 0.810 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 10.844219446182251
Epoch: 2, Steps: 18 | Train Loss: 0.866 Vali Loss: 1.891 Vali Acc: 0.520 Test Loss: 1.891 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.821303844451904
Epoch: 3, Steps: 18 | Train Loss: 0.875 Vali Loss: 1.713 Vali Acc: 0.450 Test Loss: 1.713 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.859835863113403
Epoch: 4, Steps: 18 | Train Loss: 0.643 Vali Loss: 4.286 Vali Acc: 0.510 Test Loss: 4.286 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.228988647460938
Epoch: 5, Steps: 18 | Train Loss: 2.434 Vali Loss: 7.763 Vali Acc: 0.500 Test Loss: 7.763 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.799828290939331
Epoch: 6, Steps: 18 | Train Loss: 2.697 Vali Loss: 3.643 Vali Acc: 0.490 Test Loss: 3.643 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.380548477172852
Epoch: 7, Steps: 18 | Train Loss: 0.943 Vali Loss: 5.002 Vali Acc: 0.520 Test Loss: 5.002 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.4782133102417
Epoch: 8, Steps: 18 | Train Loss: 0.596 Vali Loss: 2.973 Vali Acc: 0.560 Test Loss: 2.973 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559970).  Saving model ...
Epoch: 9 cost time: 12.019888401031494
Epoch: 9, Steps: 18 | Train Loss: 0.702 Vali Loss: 6.549 Vali Acc: 0.470 Test Loss: 6.549 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.339732646942139
Epoch: 10, Steps: 18 | Train Loss: 0.558 Vali Loss: 6.014 Vali Acc: 0.480 Test Loss: 6.014 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.501668453216553
Epoch: 11, Steps: 18 | Train Loss: 1.111 Vali Loss: 6.096 Vali Acc: 0.530 Test Loss: 6.096 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.015007734298706
Epoch: 12, Steps: 18 | Train Loss: 1.298 Vali Loss: 4.785 Vali Acc: 0.530 Test Loss: 4.785 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.169793128967285
Epoch: 13, Steps: 18 | Train Loss: 0.528 Vali Loss: 6.818 Vali Acc: 0.510 Test Loss: 6.818 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.796212196350098
Epoch: 14, Steps: 18 | Train Loss: 0.461 Vali Loss: 6.082 Vali Acc: 0.510 Test Loss: 6.082 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.641255378723145
Epoch: 15, Steps: 18 | Train Loss: 0.185 Vali Loss: 9.080 Vali Acc: 0.490 Test Loss: 9.080 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.193368434906006
Epoch: 16, Steps: 18 | Train Loss: 0.048 Vali Loss: 7.440 Vali Acc: 0.490 Test Loss: 7.440 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.845961332321167
Epoch: 17, Steps: 18 | Train Loss: 0.180 Vali Loss: 7.232 Vali Acc: 0.510 Test Loss: 7.232 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 12.413871765136719
Epoch: 18, Steps: 18 | Train Loss: 1.152 Vali Loss: 7.308 Vali Acc: 0.550 Test Loss: 7.308 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1552514
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.937479734420776
Epoch: 1, Steps: 18 | Train Loss: 1.016 Vali Loss: 0.942 Vali Acc: 0.530 Test Loss: 0.942 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 8.747300148010254
Epoch: 2, Steps: 18 | Train Loss: 0.723 Vali Loss: 3.032 Vali Acc: 0.520 Test Loss: 3.032 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.982298851013184
Epoch: 3, Steps: 18 | Train Loss: 1.002 Vali Loss: 1.863 Vali Acc: 0.430 Test Loss: 1.863 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.12196683883667
Epoch: 4, Steps: 18 | Train Loss: 0.641 Vali Loss: 3.567 Vali Acc: 0.520 Test Loss: 3.567 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.797453165054321
Epoch: 5, Steps: 18 | Train Loss: 0.834 Vali Loss: 2.135 Vali Acc: 0.590 Test Loss: 2.135 Test Acc: 0.590
Validation loss decreased (-0.529991 --> -0.589979).  Saving model ...
Epoch: 6 cost time: 8.280596017837524
Epoch: 6, Steps: 18 | Train Loss: 0.318 Vali Loss: 2.554 Vali Acc: 0.510 Test Loss: 2.554 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.370166063308716
Epoch: 7, Steps: 18 | Train Loss: 1.934 Vali Loss: 9.351 Vali Acc: 0.480 Test Loss: 9.351 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.458574295043945
Epoch: 8, Steps: 18 | Train Loss: 0.939 Vali Loss: 4.838 Vali Acc: 0.530 Test Loss: 4.838 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.65890908241272
Epoch: 9, Steps: 18 | Train Loss: 2.443 Vali Loss: 4.770 Vali Acc: 0.570 Test Loss: 4.770 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.044509172439575
Epoch: 10, Steps: 18 | Train Loss: 2.635 Vali Loss: 17.011 Vali Acc: 0.500 Test Loss: 17.011 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.879913330078125
Epoch: 11, Steps: 18 | Train Loss: 3.302 Vali Loss: 6.298 Vali Acc: 0.580 Test Loss: 6.298 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.139512300491333
Epoch: 12, Steps: 18 | Train Loss: 0.600 Vali Loss: 4.875 Vali Acc: 0.550 Test Loss: 4.875 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.224893569946289
Epoch: 13, Steps: 18 | Train Loss: 0.761 Vali Loss: 6.861 Vali Acc: 0.560 Test Loss: 6.861 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.403262853622437
Epoch: 14, Steps: 18 | Train Loss: 0.572 Vali Loss: 9.566 Vali Acc: 0.510 Test Loss: 9.566 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.599035263061523
Epoch: 15, Steps: 18 | Train Loss: 0.560 Vali Loss: 9.001 Vali Acc: 0.570 Test Loss: 9.001 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1552514
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.328600883483887
Epoch: 1, Steps: 18 | Train Loss: 1.013 Vali Loss: 0.879 Vali Acc: 0.520 Test Loss: 0.879 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 7.358706712722778
Epoch: 2, Steps: 18 | Train Loss: 0.738 Vali Loss: 2.198 Vali Acc: 0.500 Test Loss: 2.198 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.430032968521118
Epoch: 3, Steps: 18 | Train Loss: 0.526 Vali Loss: 1.202 Vali Acc: 0.510 Test Loss: 1.202 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.29241943359375
Epoch: 4, Steps: 18 | Train Loss: 0.482 Vali Loss: 2.337 Vali Acc: 0.530 Test Loss: 2.337 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529977).  Saving model ...
Epoch: 5 cost time: 6.986069679260254
Epoch: 5, Steps: 18 | Train Loss: 0.657 Vali Loss: 2.630 Vali Acc: 0.530 Test Loss: 2.630 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.389238119125366
Epoch: 6, Steps: 18 | Train Loss: 1.263 Vali Loss: 7.901 Vali Acc: 0.500 Test Loss: 7.901 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.426304578781128
Epoch: 7, Steps: 18 | Train Loss: 0.637 Vali Loss: 6.903 Vali Acc: 0.510 Test Loss: 6.903 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.408153295516968
Epoch: 8, Steps: 18 | Train Loss: 0.614 Vali Loss: 6.865 Vali Acc: 0.520 Test Loss: 6.865 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.180734157562256
Epoch: 9, Steps: 18 | Train Loss: 0.616 Vali Loss: 4.912 Vali Acc: 0.540 Test Loss: 4.912 Test Acc: 0.540
Validation loss decreased (-0.529977 --> -0.539951).  Saving model ...
Epoch: 10 cost time: 7.049956560134888
Epoch: 10, Steps: 18 | Train Loss: 0.802 Vali Loss: 5.937 Vali Acc: 0.530 Test Loss: 5.937 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.4709227085113525
Epoch: 11, Steps: 18 | Train Loss: 0.870 Vali Loss: 3.948 Vali Acc: 0.530 Test Loss: 3.948 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.29158353805542
Epoch: 12, Steps: 18 | Train Loss: 1.738 Vali Loss: 10.681 Vali Acc: 0.510 Test Loss: 10.681 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.397342205047607
Epoch: 13, Steps: 18 | Train Loss: 0.493 Vali Loss: 4.607 Vali Acc: 0.510 Test Loss: 4.607 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.275830268859863
Epoch: 14, Steps: 18 | Train Loss: 0.347 Vali Loss: 7.192 Vali Acc: 0.480 Test Loss: 7.192 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.187135934829712
Epoch: 15, Steps: 18 | Train Loss: 0.202 Vali Loss: 7.909 Vali Acc: 0.470 Test Loss: 7.909 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.492882966995239
Epoch: 16, Steps: 18 | Train Loss: 0.677 Vali Loss: 14.781 Vali Acc: 0.520 Test Loss: 14.781 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.222621440887451
Epoch: 17, Steps: 18 | Train Loss: 0.319 Vali Loss: 7.664 Vali Acc: 0.420 Test Loss: 7.664 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.731236696243286
Epoch: 18, Steps: 18 | Train Loss: 0.991 Vali Loss: 11.012 Vali Acc: 0.510 Test Loss: 11.012 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.530071973800659
Epoch: 19, Steps: 18 | Train Loss: 0.377 Vali Loss: 9.954 Vali Acc: 0.500 Test Loss: 9.954 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1552514
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.371250629425049
Epoch: 1, Steps: 18 | Train Loss: 0.954 Vali Loss: 0.840 Vali Acc: 0.550 Test Loss: 0.840 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 6.8816304206848145
Epoch: 2, Steps: 18 | Train Loss: 0.657 Vali Loss: 1.245 Vali Acc: 0.590 Test Loss: 1.245 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589988).  Saving model ...
Epoch: 3 cost time: 6.983477830886841
Epoch: 3, Steps: 18 | Train Loss: 0.449 Vali Loss: 2.590 Vali Acc: 0.530 Test Loss: 2.590 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.77664041519165
Epoch: 4, Steps: 18 | Train Loss: 0.506 Vali Loss: 2.657 Vali Acc: 0.450 Test Loss: 2.657 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.903582572937012
Epoch: 5, Steps: 18 | Train Loss: 0.662 Vali Loss: 2.699 Vali Acc: 0.530 Test Loss: 2.699 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.919517517089844
Epoch: 6, Steps: 18 | Train Loss: 0.339 Vali Loss: 3.886 Vali Acc: 0.470 Test Loss: 3.886 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.916471004486084
Epoch: 7, Steps: 18 | Train Loss: 0.304 Vali Loss: 2.707 Vali Acc: 0.560 Test Loss: 2.707 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.561133146286011
Epoch: 8, Steps: 18 | Train Loss: 1.065 Vali Loss: 4.325 Vali Acc: 0.530 Test Loss: 4.325 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.260466575622559
Epoch: 9, Steps: 18 | Train Loss: 1.785 Vali Loss: 5.039 Vali Acc: 0.510 Test Loss: 5.039 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.635987281799316
Epoch: 10, Steps: 18 | Train Loss: 0.331 Vali Loss: 4.430 Vali Acc: 0.530 Test Loss: 4.430 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.579405307769775
Epoch: 11, Steps: 18 | Train Loss: 0.580 Vali Loss: 8.100 Vali Acc: 0.510 Test Loss: 8.100 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.023273468017578
Epoch: 12, Steps: 18 | Train Loss: 1.932 Vali Loss: 12.374 Vali Acc: 0.500 Test Loss: 12.374 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1552514
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.644424438476562
Epoch: 1, Steps: 18 | Train Loss: 0.944 Vali Loss: 0.637 Vali Acc: 0.640 Test Loss: 0.637 Test Acc: 0.640
Validation loss decreased (inf --> -0.639994).  Saving model ...
Epoch: 2 cost time: 7.281843423843384
Epoch: 2, Steps: 18 | Train Loss: 0.701 Vali Loss: 1.094 Vali Acc: 0.520 Test Loss: 1.094 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.077748775482178
Epoch: 3, Steps: 18 | Train Loss: 0.501 Vali Loss: 3.323 Vali Acc: 0.500 Test Loss: 3.323 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.13815712928772
Epoch: 4, Steps: 18 | Train Loss: 0.544 Vali Loss: 2.266 Vali Acc: 0.450 Test Loss: 2.266 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.193108797073364
Epoch: 5, Steps: 18 | Train Loss: 1.065 Vali Loss: 2.854 Vali Acc: 0.500 Test Loss: 2.854 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.032009601593018
Epoch: 6, Steps: 18 | Train Loss: 0.927 Vali Loss: 3.089 Vali Acc: 0.520 Test Loss: 3.089 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.734174013137817
Epoch: 7, Steps: 18 | Train Loss: 0.887 Vali Loss: 3.299 Vali Acc: 0.550 Test Loss: 3.299 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.123688220977783
Epoch: 8, Steps: 18 | Train Loss: 0.215 Vali Loss: 6.313 Vali Acc: 0.520 Test Loss: 6.313 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.996408462524414
Epoch: 9, Steps: 18 | Train Loss: 0.195 Vali Loss: 3.638 Vali Acc: 0.490 Test Loss: 3.638 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.70577335357666
Epoch: 10, Steps: 18 | Train Loss: 0.217 Vali Loss: 2.897 Vali Acc: 0.500 Test Loss: 2.897 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.828476190567017
Epoch: 11, Steps: 18 | Train Loss: 0.845 Vali Loss: 6.619 Vali Acc: 0.550 Test Loss: 6.619 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 1552514
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.720632791519165
Epoch: 1, Steps: 18 | Train Loss: 0.932 Vali Loss: 1.206 Vali Acc: 0.550 Test Loss: 1.206 Test Acc: 0.550
Validation loss decreased (inf --> -0.549988).  Saving model ...
Epoch: 2 cost time: 6.278754472732544
Epoch: 2, Steps: 18 | Train Loss: 0.907 Vali Loss: 2.171 Vali Acc: 0.450 Test Loss: 2.171 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.263977527618408
Epoch: 3, Steps: 18 | Train Loss: 1.204 Vali Loss: 1.639 Vali Acc: 0.480 Test Loss: 1.639 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.413393497467041
Epoch: 4, Steps: 18 | Train Loss: 0.630 Vali Loss: 1.973 Vali Acc: 0.520 Test Loss: 1.973 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.012465715408325
Epoch: 5, Steps: 18 | Train Loss: 0.937 Vali Loss: 5.119 Vali Acc: 0.490 Test Loss: 5.119 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.0514726638793945
Epoch: 6, Steps: 18 | Train Loss: 1.020 Vali Loss: 2.233 Vali Acc: 0.490 Test Loss: 2.233 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.979368686676025
Epoch: 7, Steps: 18 | Train Loss: 0.387 Vali Loss: 2.835 Vali Acc: 0.570 Test Loss: 2.835 Test Acc: 0.570
Validation loss decreased (-0.549988 --> -0.569972).  Saving model ...
Epoch: 8 cost time: 5.966620683670044
Epoch: 8, Steps: 18 | Train Loss: 0.805 Vali Loss: 2.707 Vali Acc: 0.430 Test Loss: 2.707 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.618168592453003
Epoch: 9, Steps: 18 | Train Loss: 0.438 Vali Loss: 7.067 Vali Acc: 0.570 Test Loss: 7.067 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.356572866439819
Epoch: 10, Steps: 18 | Train Loss: 0.470 Vali Loss: 3.446 Vali Acc: 0.550 Test Loss: 3.446 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.003728866577148
Epoch: 11, Steps: 18 | Train Loss: 0.833 Vali Loss: 3.808 Vali Acc: 0.500 Test Loss: 3.808 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.0437963008880615
Epoch: 12, Steps: 18 | Train Loss: 0.484 Vali Loss: 4.303 Vali Acc: 0.540 Test Loss: 4.303 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.20032262802124
Epoch: 13, Steps: 18 | Train Loss: 0.545 Vali Loss: 7.070 Vali Acc: 0.430 Test Loss: 7.070 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.715144634246826
Epoch: 14, Steps: 18 | Train Loss: 1.121 Vali Loss: 5.183 Vali Acc: 0.530 Test Loss: 5.183 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.330460071563721
Epoch: 15, Steps: 18 | Train Loss: 2.821 Vali Loss: 8.010 Vali Acc: 0.520 Test Loss: 8.010 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.373778820037842
Epoch: 16, Steps: 18 | Train Loss: 0.851 Vali Loss: 9.381 Vali Acc: 0.520 Test Loss: 9.381 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.467780828475952
Epoch: 17, Steps: 18 | Train Loss: 1.185 Vali Loss: 5.435 Vali Acc: 0.490 Test Loss: 5.435 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1552514
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.490099668502808
Epoch: 1, Steps: 18 | Train Loss: 0.871 Vali Loss: 0.679 Vali Acc: 0.540 Test Loss: 0.679 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 6.0437188148498535
Epoch: 2, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.702 Vali Acc: 0.540 Test Loss: 0.702 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.612349033355713
Epoch: 3, Steps: 18 | Train Loss: 0.829 Vali Loss: 1.770 Vali Acc: 0.500 Test Loss: 1.770 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.5853376388549805
Epoch: 4, Steps: 18 | Train Loss: 0.632 Vali Loss: 3.406 Vali Acc: 0.500 Test Loss: 3.406 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.306957483291626
Epoch: 5, Steps: 18 | Train Loss: 1.387 Vali Loss: 3.119 Vali Acc: 0.500 Test Loss: 3.119 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.3919525146484375
Epoch: 6, Steps: 18 | Train Loss: 0.638 Vali Loss: 1.691 Vali Acc: 0.500 Test Loss: 1.691 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.547552824020386
Epoch: 7, Steps: 18 | Train Loss: 0.620 Vali Loss: 1.428 Vali Acc: 0.530 Test Loss: 1.428 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.317309379577637
Epoch: 8, Steps: 18 | Train Loss: 0.419 Vali Loss: 1.680 Vali Acc: 0.520 Test Loss: 1.680 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.716915130615234
Epoch: 9, Steps: 18 | Train Loss: 0.185 Vali Loss: 2.259 Vali Acc: 0.510 Test Loss: 2.259 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.9871461391448975
Epoch: 10, Steps: 18 | Train Loss: 0.362 Vali Loss: 1.219 Vali Acc: 0.530 Test Loss: 1.219 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.564882278442383
Epoch: 11, Steps: 18 | Train Loss: 0.197 Vali Loss: 2.420 Vali Acc: 0.500 Test Loss: 2.420 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1552514
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.548182964324951
Epoch: 1, Steps: 18 | Train Loss: 0.851 Vali Loss: 0.886 Vali Acc: 0.480 Test Loss: 0.886 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 13.046669483184814
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.896 Vali Acc: 0.580 Test Loss: 0.896 Test Acc: 0.580
Validation loss decreased (-0.479991 --> -0.579991).  Saving model ...
Epoch: 3 cost time: 13.613831520080566
Epoch: 3, Steps: 18 | Train Loss: 0.523 Vali Loss: 1.586 Vali Acc: 0.490 Test Loss: 1.586 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.537100076675415
Epoch: 4, Steps: 18 | Train Loss: 0.527 Vali Loss: 1.573 Vali Acc: 0.510 Test Loss: 1.573 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.786431550979614
Epoch: 5, Steps: 18 | Train Loss: 0.507 Vali Loss: 3.929 Vali Acc: 0.500 Test Loss: 3.929 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.944064140319824
Epoch: 6, Steps: 18 | Train Loss: 0.616 Vali Loss: 1.713 Vali Acc: 0.470 Test Loss: 1.713 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.086278438568115
Epoch: 7, Steps: 18 | Train Loss: 0.436 Vali Loss: 2.921 Vali Acc: 0.560 Test Loss: 2.921 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.255414485931396
Epoch: 8, Steps: 18 | Train Loss: 0.336 Vali Loss: 3.098 Vali Acc: 0.490 Test Loss: 3.098 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.238961219787598
Epoch: 9, Steps: 18 | Train Loss: 0.624 Vali Loss: 2.461 Vali Acc: 0.520 Test Loss: 2.461 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.859991073608398
Epoch: 10, Steps: 18 | Train Loss: 0.205 Vali Loss: 3.354 Vali Acc: 0.560 Test Loss: 3.354 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 13.401992797851562
Epoch: 11, Steps: 18 | Train Loss: 0.805 Vali Loss: 5.819 Vali Acc: 0.510 Test Loss: 5.819 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.921318054199219
Epoch: 12, Steps: 18 | Train Loss: 0.592 Vali Loss: 5.302 Vali Acc: 0.510 Test Loss: 5.302 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1349698
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.59758472442627
Epoch: 1, Steps: 18 | Train Loss: 0.849 Vali Loss: 0.954 Vali Acc: 0.470 Test Loss: 0.954 Test Acc: 0.470
Validation loss decreased (inf --> -0.469990).  Saving model ...
Epoch: 2 cost time: 11.994461297988892
Epoch: 2, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.916 Vali Acc: 0.510 Test Loss: 0.916 Test Acc: 0.510
Validation loss decreased (-0.469990 --> -0.509991).  Saving model ...
Epoch: 3 cost time: 11.27198576927185
Epoch: 3, Steps: 18 | Train Loss: 0.564 Vali Loss: 1.201 Vali Acc: 0.530 Test Loss: 1.201 Test Acc: 0.530
Validation loss decreased (-0.509991 --> -0.529988).  Saving model ...
Epoch: 4 cost time: 12.446212530136108
Epoch: 4, Steps: 18 | Train Loss: 0.384 Vali Loss: 1.366 Vali Acc: 0.500 Test Loss: 1.366 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.642436265945435
Epoch: 5, Steps: 18 | Train Loss: 0.383 Vali Loss: 2.704 Vali Acc: 0.500 Test Loss: 2.704 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.85619854927063
Epoch: 6, Steps: 18 | Train Loss: 0.468 Vali Loss: 2.282 Vali Acc: 0.510 Test Loss: 2.282 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.714082479476929
Epoch: 7, Steps: 18 | Train Loss: 0.512 Vali Loss: 2.648 Vali Acc: 0.510 Test Loss: 2.648 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.05308198928833
Epoch: 8, Steps: 18 | Train Loss: 0.308 Vali Loss: 2.972 Vali Acc: 0.480 Test Loss: 2.972 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.234083414077759
Epoch: 9, Steps: 18 | Train Loss: 0.307 Vali Loss: 3.530 Vali Acc: 0.530 Test Loss: 3.530 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.783688306808472
Epoch: 10, Steps: 18 | Train Loss: 0.509 Vali Loss: 2.609 Vali Acc: 0.480 Test Loss: 2.609 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 11.941208124160767
Epoch: 11, Steps: 18 | Train Loss: 0.272 Vali Loss: 5.742 Vali Acc: 0.520 Test Loss: 5.742 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 11.945694208145142
Epoch: 12, Steps: 18 | Train Loss: 0.445 Vali Loss: 5.571 Vali Acc: 0.500 Test Loss: 5.571 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 12.711791038513184
Epoch: 13, Steps: 18 | Train Loss: 0.747 Vali Loss: 4.781 Vali Acc: 0.520 Test Loss: 4.781 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 1349698
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.933685541152954
Epoch: 1, Steps: 18 | Train Loss: 0.808 Vali Loss: 0.786 Vali Acc: 0.550 Test Loss: 0.786 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 10.00823426246643
Epoch: 2, Steps: 18 | Train Loss: 0.644 Vali Loss: 1.590 Vali Acc: 0.500 Test Loss: 1.590 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.659294366836548
Epoch: 3, Steps: 18 | Train Loss: 0.616 Vali Loss: 1.565 Vali Acc: 0.510 Test Loss: 1.565 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.365090370178223
Epoch: 4, Steps: 18 | Train Loss: 0.421 Vali Loss: 1.051 Vali Acc: 0.560 Test Loss: 1.051 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559989).  Saving model ...
Epoch: 5 cost time: 10.578940868377686
Epoch: 5, Steps: 18 | Train Loss: 0.692 Vali Loss: 4.154 Vali Acc: 0.510 Test Loss: 4.154 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.495593070983887
Epoch: 6, Steps: 18 | Train Loss: 1.136 Vali Loss: 1.909 Vali Acc: 0.550 Test Loss: 1.909 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.367147207260132
Epoch: 7, Steps: 18 | Train Loss: 0.400 Vali Loss: 2.421 Vali Acc: 0.510 Test Loss: 2.421 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.731889009475708
Epoch: 8, Steps: 18 | Train Loss: 0.397 Vali Loss: 4.156 Vali Acc: 0.520 Test Loss: 4.156 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.865360736846924
Epoch: 9, Steps: 18 | Train Loss: 0.429 Vali Loss: 2.645 Vali Acc: 0.550 Test Loss: 2.645 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.251354217529297
Epoch: 10, Steps: 18 | Train Loss: 0.482 Vali Loss: 5.363 Vali Acc: 0.540 Test Loss: 5.363 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.074594020843506
Epoch: 11, Steps: 18 | Train Loss: 0.885 Vali Loss: 4.653 Vali Acc: 0.530 Test Loss: 4.653 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.061890840530396
Epoch: 12, Steps: 18 | Train Loss: 0.505 Vali Loss: 9.008 Vali Acc: 0.500 Test Loss: 9.008 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 9.937703371047974
Epoch: 13, Steps: 18 | Train Loss: 0.512 Vali Loss: 2.718 Vali Acc: 0.570 Test Loss: 2.718 Test Acc: 0.570
Validation loss decreased (-0.559989 --> -0.569973).  Saving model ...
Epoch: 14 cost time: 10.434121131896973
Epoch: 14, Steps: 18 | Train Loss: 0.641 Vali Loss: 4.181 Vali Acc: 0.530 Test Loss: 4.181 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.895984888076782
Epoch: 15, Steps: 18 | Train Loss: 0.359 Vali Loss: 7.728 Vali Acc: 0.510 Test Loss: 7.728 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.657607793807983
Epoch: 16, Steps: 18 | Train Loss: 0.213 Vali Loss: 6.977 Vali Acc: 0.540 Test Loss: 6.977 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.783038854598999
Epoch: 17, Steps: 18 | Train Loss: 0.307 Vali Loss: 4.207 Vali Acc: 0.520 Test Loss: 4.207 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.864786863327026
Epoch: 18, Steps: 18 | Train Loss: 0.482 Vali Loss: 6.129 Vali Acc: 0.560 Test Loss: 6.129 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.295737028121948
Epoch: 19, Steps: 18 | Train Loss: 0.281 Vali Loss: 9.118 Vali Acc: 0.490 Test Loss: 9.118 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.854675054550171
Epoch: 20, Steps: 18 | Train Loss: 0.267 Vali Loss: 4.703 Vali Acc: 0.600 Test Loss: 4.703 Test Acc: 0.600
Validation loss decreased (-0.569973 --> -0.599953).  Saving model ...
Epoch: 21 cost time: 10.768949031829834
Epoch: 21, Steps: 18 | Train Loss: 0.146 Vali Loss: 7.550 Vali Acc: 0.480 Test Loss: 7.550 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 9.651666402816772
Epoch: 22, Steps: 18 | Train Loss: 1.194 Vali Loss: 13.283 Vali Acc: 0.530 Test Loss: 13.283 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 9.936834812164307
Epoch: 23, Steps: 18 | Train Loss: 0.537 Vali Loss: 5.033 Vali Acc: 0.500 Test Loss: 5.033 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 10.210211992263794
Epoch: 24, Steps: 18 | Train Loss: 0.690 Vali Loss: 8.604 Vali Acc: 0.610 Test Loss: 8.604 Test Acc: 0.610
Validation loss decreased (-0.599953 --> -0.609914).  Saving model ...
Epoch: 25 cost time: 10.69462537765503
Epoch: 25, Steps: 18 | Train Loss: 0.266 Vali Loss: 6.389 Vali Acc: 0.580 Test Loss: 6.389 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 10.705422163009644
Epoch: 26, Steps: 18 | Train Loss: 0.070 Vali Loss: 7.353 Vali Acc: 0.530 Test Loss: 7.353 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 11.378298997879028
Epoch: 27, Steps: 18 | Train Loss: 0.460 Vali Loss: 6.790 Vali Acc: 0.570 Test Loss: 6.790 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 11.010093450546265
Epoch: 28, Steps: 18 | Train Loss: 0.426 Vali Loss: 6.888 Vali Acc: 0.530 Test Loss: 6.888 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 11.559885740280151
Epoch: 29, Steps: 18 | Train Loss: 0.394 Vali Loss: 9.643 Vali Acc: 0.510 Test Loss: 9.643 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 11.507564544677734
Epoch: 30, Steps: 18 | Train Loss: 0.406 Vali Loss: 8.499 Vali Acc: 0.550 Test Loss: 8.499 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 11.13857126235962
Epoch: 31, Steps: 18 | Train Loss: 0.408 Vali Loss: 19.448 Vali Acc: 0.480 Test Loss: 19.448 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 10.6185302734375
Epoch: 32, Steps: 18 | Train Loss: 0.457 Vali Loss: 8.620 Vali Acc: 0.520 Test Loss: 8.620 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 10.992741346359253
Epoch: 33, Steps: 18 | Train Loss: 0.180 Vali Loss: 12.210 Vali Acc: 0.480 Test Loss: 12.210 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 11.0546133518219
Epoch: 34, Steps: 18 | Train Loss: 0.323 Vali Loss: 13.170 Vali Acc: 0.470 Test Loss: 13.170 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1349698
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.464733600616455
Epoch: 1, Steps: 18 | Train Loss: 0.826 Vali Loss: 0.904 Vali Acc: 0.470 Test Loss: 0.904 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 9.128412008285522
Epoch: 2, Steps: 18 | Train Loss: 0.643 Vali Loss: 1.470 Vali Acc: 0.490 Test Loss: 1.470 Test Acc: 0.490
Validation loss decreased (-0.469991 --> -0.489985).  Saving model ...
Epoch: 3 cost time: 9.859179735183716
Epoch: 3, Steps: 18 | Train Loss: 0.695 Vali Loss: 2.590 Vali Acc: 0.510 Test Loss: 2.590 Test Acc: 0.510
Validation loss decreased (-0.489985 --> -0.509974).  Saving model ...
Epoch: 4 cost time: 9.653160572052002
Epoch: 4, Steps: 18 | Train Loss: 0.622 Vali Loss: 1.105 Vali Acc: 0.490 Test Loss: 1.105 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.570091962814331
Epoch: 5, Steps: 18 | Train Loss: 0.307 Vali Loss: 3.969 Vali Acc: 0.510 Test Loss: 3.969 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.026420593261719
Epoch: 6, Steps: 18 | Train Loss: 0.403 Vali Loss: 3.501 Vali Acc: 0.510 Test Loss: 3.501 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.169549703598022
Epoch: 7, Steps: 18 | Train Loss: 0.228 Vali Loss: 2.241 Vali Acc: 0.490 Test Loss: 2.241 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.213667631149292
Epoch: 8, Steps: 18 | Train Loss: 0.357 Vali Loss: 1.754 Vali Acc: 0.580 Test Loss: 1.754 Test Acc: 0.580
Validation loss decreased (-0.509974 --> -0.579982).  Saving model ...
Epoch: 9 cost time: 8.786393165588379
Epoch: 9, Steps: 18 | Train Loss: 0.586 Vali Loss: 4.489 Vali Acc: 0.480 Test Loss: 4.489 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.965152025222778
Epoch: 10, Steps: 18 | Train Loss: 0.679 Vali Loss: 2.768 Vali Acc: 0.500 Test Loss: 2.768 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.871033668518066
Epoch: 11, Steps: 18 | Train Loss: 0.204 Vali Loss: 4.028 Vali Acc: 0.500 Test Loss: 4.028 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.338079690933228
Epoch: 12, Steps: 18 | Train Loss: 0.173 Vali Loss: 4.193 Vali Acc: 0.500 Test Loss: 4.193 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.474043846130371
Epoch: 13, Steps: 18 | Train Loss: 0.290 Vali Loss: 5.538 Vali Acc: 0.540 Test Loss: 5.538 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.892894983291626
Epoch: 14, Steps: 18 | Train Loss: 0.256 Vali Loss: 7.333 Vali Acc: 0.490 Test Loss: 7.333 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.675411939620972
Epoch: 15, Steps: 18 | Train Loss: 0.766 Vali Loss: 6.076 Vali Acc: 0.530 Test Loss: 6.076 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.02030611038208
Epoch: 16, Steps: 18 | Train Loss: 0.724 Vali Loss: 6.754 Vali Acc: 0.490 Test Loss: 6.754 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.435088396072388
Epoch: 17, Steps: 18 | Train Loss: 0.468 Vali Loss: 5.361 Vali Acc: 0.540 Test Loss: 5.361 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.448354244232178
Epoch: 18, Steps: 18 | Train Loss: 0.270 Vali Loss: 5.347 Vali Acc: 0.560 Test Loss: 5.347 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1349698
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.081710577011108
Epoch: 1, Steps: 18 | Train Loss: 0.792 Vali Loss: 0.859 Vali Acc: 0.450 Test Loss: 0.859 Test Acc: 0.450
Validation loss decreased (inf --> -0.449991).  Saving model ...
Epoch: 2 cost time: 7.876267194747925
Epoch: 2, Steps: 18 | Train Loss: 0.604 Vali Loss: 1.034 Vali Acc: 0.490 Test Loss: 1.034 Test Acc: 0.490
Validation loss decreased (-0.449991 --> -0.489990).  Saving model ...
Epoch: 3 cost time: 7.646122932434082
Epoch: 3, Steps: 18 | Train Loss: 0.495 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
Validation loss decreased (-0.489990 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 7.992143392562866
Epoch: 4, Steps: 18 | Train Loss: 0.392 Vali Loss: 1.204 Vali Acc: 0.580 Test Loss: 1.204 Test Acc: 0.580
Validation loss decreased (-0.499987 --> -0.579988).  Saving model ...
Epoch: 5 cost time: 7.7699244022369385
Epoch: 5, Steps: 18 | Train Loss: 0.358 Vali Loss: 1.444 Vali Acc: 0.530 Test Loss: 1.444 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.01836609840393
Epoch: 6, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.572 Vali Acc: 0.530 Test Loss: 1.572 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.766384124755859
Epoch: 7, Steps: 18 | Train Loss: 0.299 Vali Loss: 2.792 Vali Acc: 0.530 Test Loss: 2.792 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.96383810043335
Epoch: 8, Steps: 18 | Train Loss: 0.534 Vali Loss: 3.796 Vali Acc: 0.510 Test Loss: 3.796 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.109298706054688
Epoch: 9, Steps: 18 | Train Loss: 0.386 Vali Loss: 2.998 Vali Acc: 0.550 Test Loss: 2.998 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.854186534881592
Epoch: 10, Steps: 18 | Train Loss: 0.606 Vali Loss: 3.565 Vali Acc: 0.520 Test Loss: 3.565 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.352418422698975
Epoch: 11, Steps: 18 | Train Loss: 0.570 Vali Loss: 2.720 Vali Acc: 0.560 Test Loss: 2.720 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.453017473220825
Epoch: 12, Steps: 18 | Train Loss: 1.127 Vali Loss: 4.564 Vali Acc: 0.530 Test Loss: 4.564 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.73761510848999
Epoch: 13, Steps: 18 | Train Loss: 0.566 Vali Loss: 3.028 Vali Acc: 0.560 Test Loss: 3.028 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.504467248916626
Epoch: 14, Steps: 18 | Train Loss: 0.187 Vali Loss: 5.079 Vali Acc: 0.520 Test Loss: 5.079 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1349698
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.74899411201477
Epoch: 1, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 7.305772542953491
Epoch: 2, Steps: 18 | Train Loss: 0.553 Vali Loss: 1.030 Vali Acc: 0.500 Test Loss: 1.030 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.258189916610718
Epoch: 3, Steps: 18 | Train Loss: 0.464 Vali Loss: 1.159 Vali Acc: 0.520 Test Loss: 1.159 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.3610498905181885
Epoch: 4, Steps: 18 | Train Loss: 0.416 Vali Loss: 1.633 Vali Acc: 0.480 Test Loss: 1.633 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.441113710403442
Epoch: 5, Steps: 18 | Train Loss: 0.230 Vali Loss: 1.234 Vali Acc: 0.460 Test Loss: 1.234 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.302649974822998
Epoch: 6, Steps: 18 | Train Loss: 0.492 Vali Loss: 1.635 Vali Acc: 0.490 Test Loss: 1.635 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.117790937423706
Epoch: 7, Steps: 18 | Train Loss: 0.624 Vali Loss: 6.095 Vali Acc: 0.500 Test Loss: 6.095 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.105772018432617
Epoch: 8, Steps: 18 | Train Loss: 0.268 Vali Loss: 2.099 Vali Acc: 0.560 Test Loss: 2.099 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559979).  Saving model ...
Epoch: 9 cost time: 6.856722116470337
Epoch: 9, Steps: 18 | Train Loss: 0.687 Vali Loss: 6.750 Vali Acc: 0.500 Test Loss: 6.750 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.987179279327393
Epoch: 10, Steps: 18 | Train Loss: 1.780 Vali Loss: 8.340 Vali Acc: 0.510 Test Loss: 8.340 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.0916149616241455
Epoch: 11, Steps: 18 | Train Loss: 0.617 Vali Loss: 3.332 Vali Acc: 0.470 Test Loss: 3.332 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.339689254760742
Epoch: 12, Steps: 18 | Train Loss: 0.204 Vali Loss: 10.953 Vali Acc: 0.500 Test Loss: 10.953 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.608224153518677
Epoch: 13, Steps: 18 | Train Loss: 1.224 Vali Loss: 4.167 Vali Acc: 0.490 Test Loss: 4.167 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.636291265487671
Epoch: 14, Steps: 18 | Train Loss: 0.428 Vali Loss: 5.513 Vali Acc: 0.540 Test Loss: 5.513 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.4911768436431885
Epoch: 15, Steps: 18 | Train Loss: 0.236 Vali Loss: 7.728 Vali Acc: 0.510 Test Loss: 7.728 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.334513187408447
Epoch: 16, Steps: 18 | Train Loss: 0.232 Vali Loss: 4.227 Vali Acc: 0.520 Test Loss: 4.227 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.2065675258636475
Epoch: 17, Steps: 18 | Train Loss: 0.175 Vali Loss: 5.907 Vali Acc: 0.500 Test Loss: 5.907 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.372793197631836
Epoch: 18, Steps: 18 | Train Loss: 0.191 Vali Loss: 7.444 Vali Acc: 0.500 Test Loss: 7.444 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1349698
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.296939373016357
Epoch: 1, Steps: 18 | Train Loss: 0.804 Vali Loss: 0.950 Vali Acc: 0.480 Test Loss: 0.950 Test Acc: 0.480
Validation loss decreased (inf --> -0.479990).  Saving model ...
Epoch: 2 cost time: 6.807433366775513
Epoch: 2, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.826 Vali Acc: 0.580 Test Loss: 0.826 Test Acc: 0.580
Validation loss decreased (-0.479990 --> -0.579992).  Saving model ...
Epoch: 3 cost time: 6.634035587310791
Epoch: 3, Steps: 18 | Train Loss: 0.512 Vali Loss: 0.870 Vali Acc: 0.570 Test Loss: 0.870 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.793999195098877
Epoch: 4, Steps: 18 | Train Loss: 0.368 Vali Loss: 1.270 Vali Acc: 0.560 Test Loss: 1.270 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.703422784805298
Epoch: 5, Steps: 18 | Train Loss: 0.464 Vali Loss: 1.500 Vali Acc: 0.560 Test Loss: 1.500 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.042989492416382
Epoch: 6, Steps: 18 | Train Loss: 0.373 Vali Loss: 2.869 Vali Acc: 0.520 Test Loss: 2.869 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.921142816543579
Epoch: 7, Steps: 18 | Train Loss: 0.550 Vali Loss: 3.486 Vali Acc: 0.500 Test Loss: 3.486 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.251514196395874
Epoch: 8, Steps: 18 | Train Loss: 0.344 Vali Loss: 2.604 Vali Acc: 0.500 Test Loss: 2.604 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.276811122894287
Epoch: 9, Steps: 18 | Train Loss: 0.392 Vali Loss: 4.824 Vali Acc: 0.510 Test Loss: 4.824 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.243796348571777
Epoch: 10, Steps: 18 | Train Loss: 0.401 Vali Loss: 3.211 Vali Acc: 0.520 Test Loss: 3.211 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.916414260864258
Epoch: 11, Steps: 18 | Train Loss: 0.427 Vali Loss: 3.343 Vali Acc: 0.550 Test Loss: 3.343 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.2748026847839355
Epoch: 12, Steps: 18 | Train Loss: 0.172 Vali Loss: 4.837 Vali Acc: 0.550 Test Loss: 4.837 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1349698
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.449321508407593
Epoch: 1, Steps: 18 | Train Loss: 0.777 Vali Loss: 0.692 Vali Acc: 0.560 Test Loss: 0.692 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 6.5403077602386475
Epoch: 2, Steps: 18 | Train Loss: 0.585 Vali Loss: 1.127 Vali Acc: 0.510 Test Loss: 1.127 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.544219017028809
Epoch: 3, Steps: 18 | Train Loss: 0.475 Vali Loss: 1.102 Vali Acc: 0.550 Test Loss: 1.102 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.5611231327056885
Epoch: 4, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.096 Vali Acc: 0.510 Test Loss: 1.096 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.1551008224487305
Epoch: 5, Steps: 18 | Train Loss: 0.265 Vali Loss: 1.278 Vali Acc: 0.480 Test Loss: 1.278 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.214057445526123
Epoch: 6, Steps: 18 | Train Loss: 0.475 Vali Loss: 1.885 Vali Acc: 0.450 Test Loss: 1.885 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.08884334564209
Epoch: 7, Steps: 18 | Train Loss: 0.441 Vali Loss: 1.338 Vali Acc: 0.610 Test Loss: 1.338 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609987).  Saving model ...
Epoch: 8 cost time: 7.218252182006836
Epoch: 8, Steps: 18 | Train Loss: 0.278 Vali Loss: 2.150 Vali Acc: 0.580 Test Loss: 2.150 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.120683431625366
Epoch: 9, Steps: 18 | Train Loss: 0.171 Vali Loss: 2.439 Vali Acc: 0.530 Test Loss: 2.439 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.03007960319519
Epoch: 10, Steps: 18 | Train Loss: 0.343 Vali Loss: 4.635 Vali Acc: 0.530 Test Loss: 4.635 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.03743577003479
Epoch: 11, Steps: 18 | Train Loss: 0.116 Vali Loss: 3.161 Vali Acc: 0.540 Test Loss: 3.161 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.8275933265686035
Epoch: 12, Steps: 18 | Train Loss: 0.113 Vali Loss: 6.406 Vali Acc: 0.520 Test Loss: 6.406 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.920038461685181
Epoch: 13, Steps: 18 | Train Loss: 0.717 Vali Loss: 3.304 Vali Acc: 0.580 Test Loss: 3.304 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.744104862213135
Epoch: 14, Steps: 18 | Train Loss: 0.185 Vali Loss: 3.277 Vali Acc: 0.580 Test Loss: 3.277 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.975529193878174
Epoch: 15, Steps: 18 | Train Loss: 0.168 Vali Loss: 3.576 Vali Acc: 0.510 Test Loss: 3.576 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.901316165924072
Epoch: 16, Steps: 18 | Train Loss: 0.187 Vali Loss: 5.444 Vali Acc: 0.460 Test Loss: 5.444 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.2855446338653564
Epoch: 17, Steps: 18 | Train Loss: 0.152 Vali Loss: 5.555 Vali Acc: 0.470 Test Loss: 5.555 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1349698
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.946695566177368
Epoch: 1, Steps: 18 | Train Loss: 0.825 Vali Loss: 0.902 Vali Acc: 0.450 Test Loss: 0.902 Test Acc: 0.450
Validation loss decreased (inf --> -0.449991).  Saving model ...
Epoch: 2 cost time: 6.7160484790802
Epoch: 2, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.838 Vali Acc: 0.550 Test Loss: 0.838 Test Acc: 0.550
Validation loss decreased (-0.449991 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 6.649782180786133
Epoch: 3, Steps: 18 | Train Loss: 0.511 Vali Loss: 1.625 Vali Acc: 0.510 Test Loss: 1.625 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.602618455886841
Epoch: 4, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.868 Vali Acc: 0.630 Test Loss: 0.868 Test Acc: 0.630
Validation loss decreased (-0.549992 --> -0.629991).  Saving model ...
Epoch: 5 cost time: 6.727283000946045
Epoch: 5, Steps: 18 | Train Loss: 0.613 Vali Loss: 3.379 Vali Acc: 0.490 Test Loss: 3.379 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.894731521606445
Epoch: 6, Steps: 18 | Train Loss: 0.507 Vali Loss: 1.800 Vali Acc: 0.470 Test Loss: 1.800 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.582556247711182
Epoch: 7, Steps: 18 | Train Loss: 0.282 Vali Loss: 1.706 Vali Acc: 0.480 Test Loss: 1.706 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.680652379989624
Epoch: 8, Steps: 18 | Train Loss: 0.206 Vali Loss: 2.801 Vali Acc: 0.470 Test Loss: 2.801 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.09184718132019
Epoch: 9, Steps: 18 | Train Loss: 0.163 Vali Loss: 5.844 Vali Acc: 0.500 Test Loss: 5.844 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.643000602722168
Epoch: 10, Steps: 18 | Train Loss: 0.749 Vali Loss: 2.274 Vali Acc: 0.500 Test Loss: 2.274 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.598917484283447
Epoch: 11, Steps: 18 | Train Loss: 0.267 Vali Loss: 5.494 Vali Acc: 0.440 Test Loss: 5.494 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.5419909954071045
Epoch: 12, Steps: 18 | Train Loss: 0.361 Vali Loss: 2.202 Vali Acc: 0.510 Test Loss: 2.202 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.5180559158325195
Epoch: 13, Steps: 18 | Train Loss: 0.349 Vali Loss: 4.305 Vali Acc: 0.430 Test Loss: 4.305 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.457672119140625
Epoch: 14, Steps: 18 | Train Loss: 0.304 Vali Loss: 3.307 Vali Acc: 0.510 Test Loss: 3.307 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1349698
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.310145378112793
Epoch: 1, Steps: 18 | Train Loss: 0.783 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.744110584259033
Epoch: 2, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.745 Vali Acc: 0.490 Test Loss: 0.745 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.6837286949157715
Epoch: 3, Steps: 18 | Train Loss: 0.527 Vali Loss: 0.706 Vali Acc: 0.550 Test Loss: 0.706 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 6.5191943645477295
Epoch: 4, Steps: 18 | Train Loss: 0.457 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.4070165157318115
Epoch: 5, Steps: 18 | Train Loss: 0.615 Vali Loss: 2.380 Vali Acc: 0.500 Test Loss: 2.380 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.821617841720581
Epoch: 6, Steps: 18 | Train Loss: 0.486 Vali Loss: 0.924 Vali Acc: 0.570 Test Loss: 0.924 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569991).  Saving model ...
Epoch: 7 cost time: 6.661717653274536
Epoch: 7, Steps: 18 | Train Loss: 0.284 Vali Loss: 2.060 Vali Acc: 0.490 Test Loss: 2.060 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.593725204467773
Epoch: 8, Steps: 18 | Train Loss: 0.312 Vali Loss: 1.721 Vali Acc: 0.500 Test Loss: 1.721 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.180188894271851
Epoch: 9, Steps: 18 | Train Loss: 0.513 Vali Loss: 2.165 Vali Acc: 0.480 Test Loss: 2.165 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.415508508682251
Epoch: 10, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.635 Vali Acc: 0.520 Test Loss: 1.635 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.6337220668792725
Epoch: 11, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.895 Vali Acc: 0.530 Test Loss: 1.895 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.404737949371338
Epoch: 12, Steps: 18 | Train Loss: 0.244 Vali Loss: 5.130 Vali Acc: 0.510 Test Loss: 5.130 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.20805549621582
Epoch: 13, Steps: 18 | Train Loss: 0.766 Vali Loss: 2.772 Vali Acc: 0.530 Test Loss: 2.772 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.280858755111694
Epoch: 14, Steps: 18 | Train Loss: 0.131 Vali Loss: 2.566 Vali Acc: 0.500 Test Loss: 2.566 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.492964267730713
Epoch: 15, Steps: 18 | Train Loss: 0.066 Vali Loss: 4.323 Vali Acc: 0.530 Test Loss: 4.323 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.421838998794556
Epoch: 16, Steps: 18 | Train Loss: 0.369 Vali Loss: 3.823 Vali Acc: 0.510 Test Loss: 3.823 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1349698
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.6497483253479
Epoch: 1, Steps: 18 | Train Loss: 0.855 Vali Loss: 0.936 Vali Acc: 0.540 Test Loss: 0.936 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 12.223344802856445
Epoch: 2, Steps: 18 | Train Loss: 1.189 Vali Loss: 1.974 Vali Acc: 0.490 Test Loss: 1.974 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.654092788696289
Epoch: 3, Steps: 18 | Train Loss: 0.771 Vali Loss: 0.848 Vali Acc: 0.590 Test Loss: 0.848 Test Acc: 0.590
Validation loss decreased (-0.539991 --> -0.589992).  Saving model ...
Epoch: 4 cost time: 11.92234492301941
Epoch: 4, Steps: 18 | Train Loss: 0.778 Vali Loss: 2.242 Vali Acc: 0.570 Test Loss: 2.242 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.330962896347046
Epoch: 5, Steps: 18 | Train Loss: 0.608 Vali Loss: 3.497 Vali Acc: 0.500 Test Loss: 3.497 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.18656849861145
Epoch: 6, Steps: 18 | Train Loss: 0.557 Vali Loss: 1.656 Vali Acc: 0.540 Test Loss: 1.656 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.693280458450317
Epoch: 7, Steps: 18 | Train Loss: 0.439 Vali Loss: 3.158 Vali Acc: 0.540 Test Loss: 3.158 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.003305435180664
Epoch: 8, Steps: 18 | Train Loss: 0.659 Vali Loss: 2.093 Vali Acc: 0.530 Test Loss: 2.093 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.901902198791504
Epoch: 9, Steps: 18 | Train Loss: 0.601 Vali Loss: 4.644 Vali Acc: 0.520 Test Loss: 4.644 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.18456768989563
Epoch: 10, Steps: 18 | Train Loss: 0.192 Vali Loss: 2.651 Vali Acc: 0.550 Test Loss: 2.651 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.337380409240723
Epoch: 11, Steps: 18 | Train Loss: 0.668 Vali Loss: 2.582 Vali Acc: 0.530 Test Loss: 2.582 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 11.808837413787842
Epoch: 12, Steps: 18 | Train Loss: 0.287 Vali Loss: 2.054 Vali Acc: 0.530 Test Loss: 2.054 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.789417505264282
Epoch: 13, Steps: 18 | Train Loss: 0.242 Vali Loss: 6.078 Vali Acc: 0.530 Test Loss: 6.078 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 956482
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.230605840682983
Epoch: 1, Steps: 18 | Train Loss: 0.827 Vali Loss: 0.824 Vali Acc: 0.530 Test Loss: 0.824 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 11.209494829177856
Epoch: 2, Steps: 18 | Train Loss: 1.045 Vali Loss: 1.905 Vali Acc: 0.500 Test Loss: 1.905 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.13045620918274
Epoch: 3, Steps: 18 | Train Loss: 0.638 Vali Loss: 1.875 Vali Acc: 0.530 Test Loss: 1.875 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.912187576293945
Epoch: 4, Steps: 18 | Train Loss: 0.809 Vali Loss: 1.132 Vali Acc: 0.530 Test Loss: 1.132 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.145836353302002
Epoch: 5, Steps: 18 | Train Loss: 0.310 Vali Loss: 2.603 Vali Acc: 0.510 Test Loss: 2.603 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.94589900970459
Epoch: 6, Steps: 18 | Train Loss: 0.506 Vali Loss: 2.236 Vali Acc: 0.510 Test Loss: 2.236 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.095077514648438
Epoch: 7, Steps: 18 | Train Loss: 0.706 Vali Loss: 1.991 Vali Acc: 0.500 Test Loss: 1.991 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.391028881072998
Epoch: 8, Steps: 18 | Train Loss: 0.365 Vali Loss: 2.375 Vali Acc: 0.530 Test Loss: 2.375 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.547278642654419
Epoch: 9, Steps: 18 | Train Loss: 0.255 Vali Loss: 5.753 Vali Acc: 0.500 Test Loss: 5.753 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 10.955476760864258
Epoch: 10, Steps: 18 | Train Loss: 0.953 Vali Loss: 2.636 Vali Acc: 0.490 Test Loss: 2.636 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.295068502426147
Epoch: 11, Steps: 18 | Train Loss: 0.565 Vali Loss: 2.860 Vali Acc: 0.540 Test Loss: 2.860 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539971).  Saving model ...
Epoch: 12 cost time: 11.163492441177368
Epoch: 12, Steps: 18 | Train Loss: 0.347 Vali Loss: 2.513 Vali Acc: 0.550 Test Loss: 2.513 Test Acc: 0.550
Validation loss decreased (-0.539971 --> -0.549975).  Saving model ...
Epoch: 13 cost time: 11.401029825210571
Epoch: 13, Steps: 18 | Train Loss: 0.175 Vali Loss: 4.680 Vali Acc: 0.520 Test Loss: 4.680 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.86939525604248
Epoch: 14, Steps: 18 | Train Loss: 0.311 Vali Loss: 4.767 Vali Acc: 0.550 Test Loss: 4.767 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.837661981582642
Epoch: 15, Steps: 18 | Train Loss: 0.304 Vali Loss: 7.335 Vali Acc: 0.500 Test Loss: 7.335 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.986501932144165
Epoch: 16, Steps: 18 | Train Loss: 0.429 Vali Loss: 6.447 Vali Acc: 0.510 Test Loss: 6.447 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.873019218444824
Epoch: 17, Steps: 18 | Train Loss: 0.167 Vali Loss: 4.091 Vali Acc: 0.550 Test Loss: 4.091 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.515571117401123
Epoch: 18, Steps: 18 | Train Loss: 0.242 Vali Loss: 6.377 Vali Acc: 0.480 Test Loss: 6.377 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 11.655884742736816
Epoch: 19, Steps: 18 | Train Loss: 0.476 Vali Loss: 4.828 Vali Acc: 0.530 Test Loss: 4.828 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.684224128723145
Epoch: 20, Steps: 18 | Train Loss: 0.120 Vali Loss: 4.447 Vali Acc: 0.560 Test Loss: 4.447 Test Acc: 0.560
Validation loss decreased (-0.549975 --> -0.559956).  Saving model ...
Epoch: 21 cost time: 10.776583671569824
Epoch: 21, Steps: 18 | Train Loss: 0.021 Vali Loss: 6.180 Vali Acc: 0.470 Test Loss: 6.180 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 11.925025224685669
Epoch: 22, Steps: 18 | Train Loss: 0.153 Vali Loss: 4.801 Vali Acc: 0.530 Test Loss: 4.801 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 11.112213611602783
Epoch: 23, Steps: 18 | Train Loss: 0.298 Vali Loss: 5.575 Vali Acc: 0.530 Test Loss: 5.575 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 11.151769638061523
Epoch: 24, Steps: 18 | Train Loss: 0.213 Vali Loss: 6.480 Vali Acc: 0.550 Test Loss: 6.480 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 12.069231986999512
Epoch: 25, Steps: 18 | Train Loss: 0.321 Vali Loss: 5.830 Vali Acc: 0.490 Test Loss: 5.830 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 11.063827991485596
Epoch: 26, Steps: 18 | Train Loss: 0.909 Vali Loss: 18.462 Vali Acc: 0.530 Test Loss: 18.462 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 10.716664791107178
Epoch: 27, Steps: 18 | Train Loss: 0.237 Vali Loss: 6.562 Vali Acc: 0.530 Test Loss: 6.562 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 10.933813333511353
Epoch: 28, Steps: 18 | Train Loss: 0.155 Vali Loss: 8.329 Vali Acc: 0.500 Test Loss: 8.329 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 11.287152767181396
Epoch: 29, Steps: 18 | Train Loss: 0.179 Vali Loss: 14.001 Vali Acc: 0.530 Test Loss: 14.001 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 10.401673316955566
Epoch: 30, Steps: 18 | Train Loss: 0.558 Vali Loss: 10.780 Vali Acc: 0.500 Test Loss: 10.780 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 956482
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.26833963394165
Epoch: 1, Steps: 18 | Train Loss: 0.824 Vali Loss: 0.737 Vali Acc: 0.540 Test Loss: 0.737 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 10.070236921310425
Epoch: 2, Steps: 18 | Train Loss: 0.884 Vali Loss: 1.447 Vali Acc: 0.450 Test Loss: 1.447 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.807847499847412
Epoch: 3, Steps: 18 | Train Loss: 0.759 Vali Loss: 1.048 Vali Acc: 0.540 Test Loss: 1.048 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.552342414855957
Epoch: 4, Steps: 18 | Train Loss: 0.473 Vali Loss: 1.456 Vali Acc: 0.530 Test Loss: 1.456 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.790154933929443
Epoch: 5, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.180 Vali Acc: 0.540 Test Loss: 1.180 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.717184066772461
Epoch: 6, Steps: 18 | Train Loss: 0.201 Vali Loss: 2.359 Vali Acc: 0.540 Test Loss: 2.359 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.766153812408447
Epoch: 7, Steps: 18 | Train Loss: 0.521 Vali Loss: 2.796 Vali Acc: 0.520 Test Loss: 2.796 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.528721332550049
Epoch: 8, Steps: 18 | Train Loss: 0.871 Vali Loss: 2.083 Vali Acc: 0.490 Test Loss: 2.083 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.027105808258057
Epoch: 9, Steps: 18 | Train Loss: 0.489 Vali Loss: 3.766 Vali Acc: 0.500 Test Loss: 3.766 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.045683860778809
Epoch: 10, Steps: 18 | Train Loss: 0.548 Vali Loss: 2.962 Vali Acc: 0.540 Test Loss: 2.962 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.89162540435791
Epoch: 11, Steps: 18 | Train Loss: 1.342 Vali Loss: 3.552 Vali Acc: 0.500 Test Loss: 3.552 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 956482
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.998907804489136
Epoch: 1, Steps: 18 | Train Loss: 0.889 Vali Loss: 0.960 Vali Acc: 0.450 Test Loss: 0.960 Test Acc: 0.450
Validation loss decreased (inf --> -0.449990).  Saving model ...
Epoch: 2 cost time: 8.5771484375
Epoch: 2, Steps: 18 | Train Loss: 0.656 Vali Loss: 1.769 Vali Acc: 0.490 Test Loss: 1.769 Test Acc: 0.490
Validation loss decreased (-0.449990 --> -0.489982).  Saving model ...
Epoch: 3 cost time: 8.368377208709717
Epoch: 3, Steps: 18 | Train Loss: 0.494 Vali Loss: 2.036 Vali Acc: 0.500 Test Loss: 2.036 Test Acc: 0.500
Validation loss decreased (-0.489982 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 8.644695281982422
Epoch: 4, Steps: 18 | Train Loss: 0.522 Vali Loss: 2.409 Vali Acc: 0.540 Test Loss: 2.409 Test Acc: 0.540
Validation loss decreased (-0.499980 --> -0.539976).  Saving model ...
Epoch: 5 cost time: 7.985808849334717
Epoch: 5, Steps: 18 | Train Loss: 0.496 Vali Loss: 2.165 Vali Acc: 0.460 Test Loss: 2.165 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.739773273468018
Epoch: 6, Steps: 18 | Train Loss: 0.362 Vali Loss: 2.439 Vali Acc: 0.580 Test Loss: 2.439 Test Acc: 0.580
Validation loss decreased (-0.539976 --> -0.579976).  Saving model ...
Epoch: 7 cost time: 7.929935693740845
Epoch: 7, Steps: 18 | Train Loss: 0.321 Vali Loss: 1.878 Vali Acc: 0.550 Test Loss: 1.878 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.7651145458221436
Epoch: 8, Steps: 18 | Train Loss: 0.415 Vali Loss: 2.748 Vali Acc: 0.470 Test Loss: 2.748 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.645867109298706
Epoch: 9, Steps: 18 | Train Loss: 0.306 Vali Loss: 5.706 Vali Acc: 0.520 Test Loss: 5.706 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.913243532180786
Epoch: 10, Steps: 18 | Train Loss: 0.243 Vali Loss: 2.460 Vali Acc: 0.520 Test Loss: 2.460 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.3561429977417
Epoch: 11, Steps: 18 | Train Loss: 0.359 Vali Loss: 4.373 Vali Acc: 0.560 Test Loss: 4.373 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.3881676197052
Epoch: 12, Steps: 18 | Train Loss: 0.432 Vali Loss: 3.655 Vali Acc: 0.560 Test Loss: 3.655 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.557814121246338
Epoch: 13, Steps: 18 | Train Loss: 0.313 Vali Loss: 4.076 Vali Acc: 0.460 Test Loss: 4.076 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.573879718780518
Epoch: 14, Steps: 18 | Train Loss: 0.862 Vali Loss: 4.287 Vali Acc: 0.550 Test Loss: 4.287 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.300353527069092
Epoch: 15, Steps: 18 | Train Loss: 0.364 Vali Loss: 8.010 Vali Acc: 0.510 Test Loss: 8.010 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.295870304107666
Epoch: 16, Steps: 18 | Train Loss: 0.248 Vali Loss: 5.952 Vali Acc: 0.520 Test Loss: 5.952 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 956482
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.033211469650269
Epoch: 1, Steps: 18 | Train Loss: 0.842 Vali Loss: 0.968 Vali Acc: 0.430 Test Loss: 0.968 Test Acc: 0.430
Validation loss decreased (inf --> -0.429990).  Saving model ...
Epoch: 2 cost time: 6.733320951461792
Epoch: 2, Steps: 18 | Train Loss: 0.726 Vali Loss: 0.951 Vali Acc: 0.520 Test Loss: 0.951 Test Acc: 0.520
Validation loss decreased (-0.429990 --> -0.519990).  Saving model ...
Epoch: 3 cost time: 6.6269636154174805
Epoch: 3, Steps: 18 | Train Loss: 0.579 Vali Loss: 1.646 Vali Acc: 0.490 Test Loss: 1.646 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.902404546737671
Epoch: 4, Steps: 18 | Train Loss: 0.561 Vali Loss: 1.155 Vali Acc: 0.530 Test Loss: 1.155 Test Acc: 0.530
Validation loss decreased (-0.519990 --> -0.529988).  Saving model ...
Epoch: 5 cost time: 7.0874152183532715
Epoch: 5, Steps: 18 | Train Loss: 0.396 Vali Loss: 1.673 Vali Acc: 0.520 Test Loss: 1.673 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.983179569244385
Epoch: 6, Steps: 18 | Train Loss: 0.247 Vali Loss: 2.028 Vali Acc: 0.540 Test Loss: 2.028 Test Acc: 0.540
Validation loss decreased (-0.529988 --> -0.539980).  Saving model ...
Epoch: 7 cost time: 6.956886053085327
Epoch: 7, Steps: 18 | Train Loss: 0.328 Vali Loss: 1.949 Vali Acc: 0.460 Test Loss: 1.949 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.042088985443115
Epoch: 8, Steps: 18 | Train Loss: 0.527 Vali Loss: 2.912 Vali Acc: 0.450 Test Loss: 2.912 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.958621501922607
Epoch: 9, Steps: 18 | Train Loss: 0.367 Vali Loss: 3.031 Vali Acc: 0.510 Test Loss: 3.031 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.036370515823364
Epoch: 10, Steps: 18 | Train Loss: 0.355 Vali Loss: 2.290 Vali Acc: 0.550 Test Loss: 2.290 Test Acc: 0.550
Validation loss decreased (-0.539980 --> -0.549977).  Saving model ...
Epoch: 11 cost time: 7.076297283172607
Epoch: 11, Steps: 18 | Train Loss: 0.726 Vali Loss: 4.316 Vali Acc: 0.470 Test Loss: 4.316 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.1332831382751465
Epoch: 12, Steps: 18 | Train Loss: 0.625 Vali Loss: 4.232 Vali Acc: 0.550 Test Loss: 4.232 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.096569299697876
Epoch: 13, Steps: 18 | Train Loss: 0.521 Vali Loss: 4.615 Vali Acc: 0.510 Test Loss: 4.615 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.874832630157471
Epoch: 14, Steps: 18 | Train Loss: 0.312 Vali Loss: 6.211 Vali Acc: 0.480 Test Loss: 6.211 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.854483366012573
Epoch: 15, Steps: 18 | Train Loss: 0.606 Vali Loss: 5.196 Vali Acc: 0.520 Test Loss: 5.196 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.824010610580444
Epoch: 16, Steps: 18 | Train Loss: 0.334 Vali Loss: 5.320 Vali Acc: 0.520 Test Loss: 5.320 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.695511817932129
Epoch: 17, Steps: 18 | Train Loss: 0.132 Vali Loss: 6.469 Vali Acc: 0.510 Test Loss: 6.469 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.6409077644348145
Epoch: 18, Steps: 18 | Train Loss: 0.675 Vali Loss: 6.263 Vali Acc: 0.610 Test Loss: 6.263 Test Acc: 0.610
Validation loss decreased (-0.549977 --> -0.609937).  Saving model ...
Epoch: 19 cost time: 6.821866273880005
Epoch: 19, Steps: 18 | Train Loss: 0.280 Vali Loss: 4.960 Vali Acc: 0.500 Test Loss: 4.960 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.217487573623657
Epoch: 20, Steps: 18 | Train Loss: 0.253 Vali Loss: 8.112 Vali Acc: 0.530 Test Loss: 8.112 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.7719855308532715
Epoch: 21, Steps: 18 | Train Loss: 0.470 Vali Loss: 5.853 Vali Acc: 0.520 Test Loss: 5.853 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.851102352142334
Epoch: 22, Steps: 18 | Train Loss: 0.279 Vali Loss: 6.577 Vali Acc: 0.520 Test Loss: 6.577 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.121031045913696
Epoch: 23, Steps: 18 | Train Loss: 0.238 Vali Loss: 6.180 Vali Acc: 0.500 Test Loss: 6.180 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.183591604232788
Epoch: 24, Steps: 18 | Train Loss: 0.156 Vali Loss: 7.092 Vali Acc: 0.520 Test Loss: 7.092 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.854590654373169
Epoch: 25, Steps: 18 | Train Loss: 0.035 Vali Loss: 10.403 Vali Acc: 0.540 Test Loss: 10.403 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.085899114608765
Epoch: 26, Steps: 18 | Train Loss: 0.236 Vali Loss: 7.851 Vali Acc: 0.520 Test Loss: 7.851 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.236908912658691
Epoch: 27, Steps: 18 | Train Loss: 0.222 Vali Loss: 8.096 Vali Acc: 0.520 Test Loss: 8.096 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.021838665008545
Epoch: 28, Steps: 18 | Train Loss: 0.283 Vali Loss: 8.355 Vali Acc: 0.530 Test Loss: 8.355 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 956482
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.350507497787476
Epoch: 1, Steps: 18 | Train Loss: 0.837 Vali Loss: 0.963 Vali Acc: 0.490 Test Loss: 0.963 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 6.204207897186279
Epoch: 2, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.844 Vali Acc: 0.590 Test Loss: 0.844 Test Acc: 0.590
Validation loss decreased (-0.489990 --> -0.589992).  Saving model ...
Epoch: 3 cost time: 6.074025869369507
Epoch: 3, Steps: 18 | Train Loss: 0.420 Vali Loss: 1.057 Vali Acc: 0.460 Test Loss: 1.057 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.0760743618011475
Epoch: 4, Steps: 18 | Train Loss: 0.279 Vali Loss: 1.780 Vali Acc: 0.510 Test Loss: 1.780 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.983809232711792
Epoch: 5, Steps: 18 | Train Loss: 0.310 Vali Loss: 1.360 Vali Acc: 0.560 Test Loss: 1.360 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.428215980529785
Epoch: 6, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.613 Vali Acc: 0.470 Test Loss: 1.613 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.238029479980469
Epoch: 7, Steps: 18 | Train Loss: 0.225 Vali Loss: 2.595 Vali Acc: 0.530 Test Loss: 2.595 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.2138426303863525
Epoch: 8, Steps: 18 | Train Loss: 0.321 Vali Loss: 5.108 Vali Acc: 0.490 Test Loss: 5.108 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.310204029083252
Epoch: 9, Steps: 18 | Train Loss: 0.448 Vali Loss: 5.640 Vali Acc: 0.530 Test Loss: 5.640 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.21415376663208
Epoch: 10, Steps: 18 | Train Loss: 0.475 Vali Loss: 4.007 Vali Acc: 0.550 Test Loss: 4.007 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.008204221725464
Epoch: 11, Steps: 18 | Train Loss: 0.458 Vali Loss: 4.916 Vali Acc: 0.520 Test Loss: 4.916 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.02129340171814
Epoch: 12, Steps: 18 | Train Loss: 0.671 Vali Loss: 4.366 Vali Acc: 0.470 Test Loss: 4.366 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 956482
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.5919835567474365
Epoch: 1, Steps: 18 | Train Loss: 0.760 Vali Loss: 1.068 Vali Acc: 0.520 Test Loss: 1.068 Test Acc: 0.520
Validation loss decreased (inf --> -0.519989).  Saving model ...
Epoch: 2 cost time: 6.252266883850098
Epoch: 2, Steps: 18 | Train Loss: 0.592 Vali Loss: 1.028 Vali Acc: 0.560 Test Loss: 1.028 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559990).  Saving model ...
Epoch: 3 cost time: 6.046343564987183
Epoch: 3, Steps: 18 | Train Loss: 0.364 Vali Loss: 0.990 Vali Acc: 0.560 Test Loss: 0.990 Test Acc: 0.560
Validation loss decreased (-0.559990 --> -0.559990).  Saving model ...
Epoch: 4 cost time: 6.270174264907837
Epoch: 4, Steps: 18 | Train Loss: 0.612 Vali Loss: 1.275 Vali Acc: 0.530 Test Loss: 1.275 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.928016424179077
Epoch: 5, Steps: 18 | Train Loss: 0.312 Vali Loss: 2.740 Vali Acc: 0.450 Test Loss: 2.740 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.1720404624938965
Epoch: 6, Steps: 18 | Train Loss: 0.271 Vali Loss: 1.593 Vali Acc: 0.530 Test Loss: 1.593 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.324654817581177
Epoch: 7, Steps: 18 | Train Loss: 0.277 Vali Loss: 2.392 Vali Acc: 0.540 Test Loss: 2.392 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.27496075630188
Epoch: 8, Steps: 18 | Train Loss: 0.097 Vali Loss: 2.663 Vali Acc: 0.530 Test Loss: 2.663 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.001980304718018
Epoch: 9, Steps: 18 | Train Loss: 0.181 Vali Loss: 4.399 Vali Acc: 0.490 Test Loss: 4.399 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.1235291957855225
Epoch: 10, Steps: 18 | Train Loss: 0.171 Vali Loss: 2.637 Vali Acc: 0.580 Test Loss: 2.637 Test Acc: 0.580
Validation loss decreased (-0.559990 --> -0.579974).  Saving model ...
Epoch: 11 cost time: 6.14700722694397
Epoch: 11, Steps: 18 | Train Loss: 0.194 Vali Loss: 4.006 Vali Acc: 0.520 Test Loss: 4.006 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.816348314285278
Epoch: 12, Steps: 18 | Train Loss: 0.206 Vali Loss: 4.863 Vali Acc: 0.570 Test Loss: 4.863 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.156452178955078
Epoch: 13, Steps: 18 | Train Loss: 0.270 Vali Loss: 4.344 Vali Acc: 0.520 Test Loss: 4.344 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.256157159805298
Epoch: 14, Steps: 18 | Train Loss: 0.172 Vali Loss: 5.250 Vali Acc: 0.510 Test Loss: 5.250 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.506234407424927
Epoch: 15, Steps: 18 | Train Loss: 0.064 Vali Loss: 6.019 Vali Acc: 0.500 Test Loss: 6.019 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.676249265670776
Epoch: 16, Steps: 18 | Train Loss: 0.181 Vali Loss: 5.899 Vali Acc: 0.540 Test Loss: 5.899 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.385176420211792
Epoch: 17, Steps: 18 | Train Loss: 0.095 Vali Loss: 5.970 Vali Acc: 0.520 Test Loss: 5.970 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.185125112533569
Epoch: 18, Steps: 18 | Train Loss: 0.060 Vali Loss: 6.556 Vali Acc: 0.490 Test Loss: 6.556 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.953492164611816
Epoch: 19, Steps: 18 | Train Loss: 0.060 Vali Loss: 5.921 Vali Acc: 0.530 Test Loss: 5.921 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.4050140380859375
Epoch: 20, Steps: 18 | Train Loss: 0.102 Vali Loss: 6.717 Vali Acc: 0.530 Test Loss: 6.717 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 956482
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.160554647445679
Epoch: 1, Steps: 18 | Train Loss: 0.765 Vali Loss: 0.977 Vali Acc: 0.510 Test Loss: 0.977 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 6.089399099349976
Epoch: 2, Steps: 18 | Train Loss: 0.671 Vali Loss: 1.582 Vali Acc: 0.500 Test Loss: 1.582 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.947815895080566
Epoch: 3, Steps: 18 | Train Loss: 0.561 Vali Loss: 1.003 Vali Acc: 0.560 Test Loss: 1.003 Test Acc: 0.560
Validation loss decreased (-0.509990 --> -0.559990).  Saving model ...
Epoch: 4 cost time: 5.792616367340088
Epoch: 4, Steps: 18 | Train Loss: 0.328 Vali Loss: 0.981 Vali Acc: 0.490 Test Loss: 0.981 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.671142816543579
Epoch: 5, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.351 Vali Acc: 0.590 Test Loss: 1.351 Test Acc: 0.590
Validation loss decreased (-0.559990 --> -0.589986).  Saving model ...
Epoch: 6 cost time: 5.791579484939575
Epoch: 6, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.405 Vali Acc: 0.570 Test Loss: 1.405 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.742140293121338
Epoch: 7, Steps: 18 | Train Loss: 0.208 Vali Loss: 2.938 Vali Acc: 0.510 Test Loss: 2.938 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.956753492355347
Epoch: 8, Steps: 18 | Train Loss: 0.111 Vali Loss: 2.200 Vali Acc: 0.440 Test Loss: 2.200 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.578645944595337
Epoch: 9, Steps: 18 | Train Loss: 0.120 Vali Loss: 1.825 Vali Acc: 0.550 Test Loss: 1.825 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.981378555297852
Epoch: 10, Steps: 18 | Train Loss: 0.145 Vali Loss: 3.757 Vali Acc: 0.490 Test Loss: 3.757 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.877190589904785
Epoch: 11, Steps: 18 | Train Loss: 0.472 Vali Loss: 4.640 Vali Acc: 0.480 Test Loss: 4.640 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.882206201553345
Epoch: 12, Steps: 18 | Train Loss: 0.165 Vali Loss: 4.055 Vali Acc: 0.510 Test Loss: 4.055 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.82909369468689
Epoch: 13, Steps: 18 | Train Loss: 0.297 Vali Loss: 3.107 Vali Acc: 0.570 Test Loss: 3.107 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.062239408493042
Epoch: 14, Steps: 18 | Train Loss: 0.238 Vali Loss: 4.302 Vali Acc: 0.630 Test Loss: 4.302 Test Acc: 0.630
Validation loss decreased (-0.589986 --> -0.629957).  Saving model ...
Epoch: 15 cost time: 6.021173715591431
Epoch: 15, Steps: 18 | Train Loss: 0.153 Vali Loss: 5.769 Vali Acc: 0.600 Test Loss: 5.769 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.115666627883911
Epoch: 16, Steps: 18 | Train Loss: 0.174 Vali Loss: 4.402 Vali Acc: 0.550 Test Loss: 4.402 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.949976205825806
Epoch: 17, Steps: 18 | Train Loss: 0.164 Vali Loss: 6.401 Vali Acc: 0.500 Test Loss: 6.401 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.714297771453857
Epoch: 18, Steps: 18 | Train Loss: 0.455 Vali Loss: 4.223 Vali Acc: 0.520 Test Loss: 4.223 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.043997049331665
Epoch: 19, Steps: 18 | Train Loss: 0.845 Vali Loss: 6.465 Vali Acc: 0.540 Test Loss: 6.465 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.122268438339233
Epoch: 20, Steps: 18 | Train Loss: 0.256 Vali Loss: 6.376 Vali Acc: 0.460 Test Loss: 6.376 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.079436779022217
Epoch: 21, Steps: 18 | Train Loss: 0.138 Vali Loss: 7.285 Vali Acc: 0.520 Test Loss: 7.285 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.012314796447754
Epoch: 22, Steps: 18 | Train Loss: 0.094 Vali Loss: 9.757 Vali Acc: 0.510 Test Loss: 9.757 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.791764736175537
Epoch: 23, Steps: 18 | Train Loss: 0.179 Vali Loss: 8.372 Vali Acc: 0.540 Test Loss: 8.372 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.807796239852905
Epoch: 24, Steps: 18 | Train Loss: 0.061 Vali Loss: 7.877 Vali Acc: 0.520 Test Loss: 7.877 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 956482
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.379897832870483
Epoch: 1, Steps: 18 | Train Loss: 0.775 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 6.287106037139893
Epoch: 2, Steps: 18 | Train Loss: 0.626 Vali Loss: 1.126 Vali Acc: 0.440 Test Loss: 1.126 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.0463643074035645
Epoch: 3, Steps: 18 | Train Loss: 0.566 Vali Loss: 1.738 Vali Acc: 0.470 Test Loss: 1.738 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.153598785400391
Epoch: 4, Steps: 18 | Train Loss: 0.642 Vali Loss: 1.363 Vali Acc: 0.500 Test Loss: 1.363 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.024702787399292
Epoch: 5, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.312 Vali Acc: 0.420 Test Loss: 1.312 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.071475028991699
Epoch: 6, Steps: 18 | Train Loss: 0.379 Vali Loss: 1.384 Vali Acc: 0.500 Test Loss: 1.384 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.300204277038574
Epoch: 7, Steps: 18 | Train Loss: 0.407 Vali Loss: 2.471 Vali Acc: 0.510 Test Loss: 2.471 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509975).  Saving model ...
Epoch: 8 cost time: 5.986159086227417
Epoch: 8, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.805 Vali Acc: 0.530 Test Loss: 1.805 Test Acc: 0.530
Validation loss decreased (-0.509975 --> -0.529982).  Saving model ...
Epoch: 9 cost time: 6.217332601547241
Epoch: 9, Steps: 18 | Train Loss: 0.246 Vali Loss: 2.474 Vali Acc: 0.460 Test Loss: 2.474 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.18840479850769
Epoch: 10, Steps: 18 | Train Loss: 0.269 Vali Loss: 4.071 Vali Acc: 0.530 Test Loss: 4.071 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.249718904495239
Epoch: 11, Steps: 18 | Train Loss: 0.467 Vali Loss: 2.902 Vali Acc: 0.500 Test Loss: 2.902 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.911463499069214
Epoch: 12, Steps: 18 | Train Loss: 0.209 Vali Loss: 1.875 Vali Acc: 0.570 Test Loss: 1.875 Test Acc: 0.570
Validation loss decreased (-0.529982 --> -0.569981).  Saving model ...
Epoch: 13 cost time: 6.576539516448975
Epoch: 13, Steps: 18 | Train Loss: 0.261 Vali Loss: 7.039 Vali Acc: 0.460 Test Loss: 7.039 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.473793983459473
Epoch: 14, Steps: 18 | Train Loss: 0.746 Vali Loss: 4.826 Vali Acc: 0.450 Test Loss: 4.826 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.2173011302948
Epoch: 15, Steps: 18 | Train Loss: 0.306 Vali Loss: 6.232 Vali Acc: 0.540 Test Loss: 6.232 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.111745834350586
Epoch: 16, Steps: 18 | Train Loss: 0.238 Vali Loss: 3.888 Vali Acc: 0.500 Test Loss: 3.888 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.902787446975708
Epoch: 17, Steps: 18 | Train Loss: 0.163 Vali Loss: 5.161 Vali Acc: 0.580 Test Loss: 5.161 Test Acc: 0.580
Validation loss decreased (-0.569981 --> -0.579948).  Saving model ...
Epoch: 18 cost time: 6.178699731826782
Epoch: 18, Steps: 18 | Train Loss: 0.597 Vali Loss: 9.046 Vali Acc: 0.500 Test Loss: 9.046 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.111898422241211
Epoch: 19, Steps: 18 | Train Loss: 0.483 Vali Loss: 6.182 Vali Acc: 0.500 Test Loss: 6.182 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.2173027992248535
Epoch: 20, Steps: 18 | Train Loss: 0.095 Vali Loss: 7.849 Vali Acc: 0.440 Test Loss: 7.849 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.205257415771484
Epoch: 21, Steps: 18 | Train Loss: 0.088 Vali Loss: 4.294 Vali Acc: 0.590 Test Loss: 4.294 Test Acc: 0.590
Validation loss decreased (-0.579948 --> -0.589957).  Saving model ...
Epoch: 22 cost time: 6.2644805908203125
Epoch: 22, Steps: 18 | Train Loss: 0.227 Vali Loss: 7.170 Vali Acc: 0.440 Test Loss: 7.170 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.0737550258636475
Epoch: 23, Steps: 18 | Train Loss: 0.141 Vali Loss: 2.466 Vali Acc: 0.460 Test Loss: 2.466 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.215444564819336
Epoch: 24, Steps: 18 | Train Loss: 0.131 Vali Loss: 9.430 Vali Acc: 0.500 Test Loss: 9.430 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.9455156326293945
Epoch: 25, Steps: 18 | Train Loss: 0.125 Vali Loss: 6.096 Vali Acc: 0.440 Test Loss: 6.096 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.9561896324157715
Epoch: 26, Steps: 18 | Train Loss: 0.075 Vali Loss: 7.447 Vali Acc: 0.460 Test Loss: 7.447 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.740138530731201
Epoch: 27, Steps: 18 | Train Loss: 0.286 Vali Loss: 9.098 Vali Acc: 0.510 Test Loss: 9.098 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 6.337141513824463
Epoch: 28, Steps: 18 | Train Loss: 0.110 Vali Loss: 9.972 Vali Acc: 0.500 Test Loss: 9.972 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.423623561859131
Epoch: 29, Steps: 18 | Train Loss: 0.182 Vali Loss: 8.050 Vali Acc: 0.470 Test Loss: 8.050 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.644070386886597
Epoch: 30, Steps: 18 | Train Loss: 0.043 Vali Loss: 3.857 Vali Acc: 0.460 Test Loss: 3.857 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 6.330140829086304
Epoch: 31, Steps: 18 | Train Loss: 0.295 Vali Loss: 6.544 Vali Acc: 0.550 Test Loss: 6.544 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 956482
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.799567222595215
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 1.056 Vali Acc: 0.500 Test Loss: 1.056 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 5.950453281402588
Epoch: 2, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 6.054327726364136
Epoch: 3, Steps: 18 | Train Loss: 0.550 Vali Loss: 0.694 Vali Acc: 0.600 Test Loss: 0.694 Test Acc: 0.600
Validation loss decreased (-0.499993 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 5.598880767822266
Epoch: 4, Steps: 18 | Train Loss: 0.413 Vali Loss: 2.417 Vali Acc: 0.500 Test Loss: 2.417 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.015496730804443
Epoch: 5, Steps: 18 | Train Loss: 0.833 Vali Loss: 1.123 Vali Acc: 0.490 Test Loss: 1.123 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.25533390045166
Epoch: 6, Steps: 18 | Train Loss: 0.388 Vali Loss: 1.030 Vali Acc: 0.550 Test Loss: 1.030 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.061275482177734
Epoch: 7, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.147 Vali Acc: 0.510 Test Loss: 1.147 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.078699350357056
Epoch: 8, Steps: 18 | Train Loss: 0.402 Vali Loss: 1.197 Vali Acc: 0.550 Test Loss: 1.197 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.955533981323242
Epoch: 9, Steps: 18 | Train Loss: 0.190 Vali Loss: 1.518 Vali Acc: 0.510 Test Loss: 1.518 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.037603139877319
Epoch: 10, Steps: 18 | Train Loss: 0.137 Vali Loss: 1.315 Vali Acc: 0.500 Test Loss: 1.315 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.2168378829956055
Epoch: 11, Steps: 18 | Train Loss: 0.108 Vali Loss: 1.370 Vali Acc: 0.520 Test Loss: 1.370 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.943176507949829
Epoch: 12, Steps: 18 | Train Loss: 0.135 Vali Loss: 5.498 Vali Acc: 0.500 Test Loss: 5.498 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.879438877105713
Epoch: 13, Steps: 18 | Train Loss: 0.601 Vali Loss: 2.083 Vali Acc: 0.490 Test Loss: 2.083 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 956482
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.709361791610718
Epoch: 1, Steps: 18 | Train Loss: 0.903 Vali Loss: 1.039 Vali Acc: 0.490 Test Loss: 1.039 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 12.268714666366577
Epoch: 2, Steps: 18 | Train Loss: 0.845 Vali Loss: 1.107 Vali Acc: 0.560 Test Loss: 1.107 Test Acc: 0.560
Validation loss decreased (-0.489990 --> -0.559989).  Saving model ...
Epoch: 3 cost time: 11.742820262908936
Epoch: 3, Steps: 18 | Train Loss: 0.787 Vali Loss: 1.124 Vali Acc: 0.520 Test Loss: 1.124 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.605573415756226
Epoch: 4, Steps: 18 | Train Loss: 0.653 Vali Loss: 1.188 Vali Acc: 0.520 Test Loss: 1.188 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.878938436508179
Epoch: 5, Steps: 18 | Train Loss: 0.594 Vali Loss: 2.185 Vali Acc: 0.520 Test Loss: 2.185 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.249042272567749
Epoch: 6, Steps: 18 | Train Loss: 0.451 Vali Loss: 1.602 Vali Acc: 0.540 Test Loss: 1.602 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.393823385238647
Epoch: 7, Steps: 18 | Train Loss: 0.388 Vali Loss: 2.292 Vali Acc: 0.550 Test Loss: 2.292 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.128705501556396
Epoch: 8, Steps: 18 | Train Loss: 0.545 Vali Loss: 1.671 Vali Acc: 0.530 Test Loss: 1.671 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.427205085754395
Epoch: 9, Steps: 18 | Train Loss: 0.321 Vali Loss: 2.070 Vali Acc: 0.520 Test Loss: 2.070 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.157431364059448
Epoch: 10, Steps: 18 | Train Loss: 0.265 Vali Loss: 2.562 Vali Acc: 0.530 Test Loss: 2.562 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.698609113693237
Epoch: 11, Steps: 18 | Train Loss: 0.385 Vali Loss: 3.127 Vali Acc: 0.590 Test Loss: 3.127 Test Acc: 0.590
Validation loss decreased (-0.559989 --> -0.589969).  Saving model ...
Epoch: 12 cost time: 12.278185606002808
Epoch: 12, Steps: 18 | Train Loss: 0.781 Vali Loss: 2.801 Vali Acc: 0.480 Test Loss: 2.801 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.020957231521606
Epoch: 13, Steps: 18 | Train Loss: 0.738 Vali Loss: 5.858 Vali Acc: 0.490 Test Loss: 5.858 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.842554569244385
Epoch: 14, Steps: 18 | Train Loss: 0.605 Vali Loss: 4.209 Vali Acc: 0.600 Test Loss: 4.209 Test Acc: 0.600
Validation loss decreased (-0.589969 --> -0.599958).  Saving model ...
Epoch: 15 cost time: 11.475868463516235
Epoch: 15, Steps: 18 | Train Loss: 0.577 Vali Loss: 4.257 Vali Acc: 0.540 Test Loss: 4.257 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.10289192199707
Epoch: 16, Steps: 18 | Train Loss: 0.436 Vali Loss: 8.208 Vali Acc: 0.510 Test Loss: 8.208 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.474679708480835
Epoch: 17, Steps: 18 | Train Loss: 0.327 Vali Loss: 5.898 Vali Acc: 0.530 Test Loss: 5.898 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.497052669525146
Epoch: 18, Steps: 18 | Train Loss: 0.607 Vali Loss: 7.085 Vali Acc: 0.490 Test Loss: 7.085 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.829283952713013
Epoch: 19, Steps: 18 | Train Loss: 0.195 Vali Loss: 7.976 Vali Acc: 0.530 Test Loss: 7.976 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.817970514297485
Epoch: 20, Steps: 18 | Train Loss: 0.088 Vali Loss: 5.332 Vali Acc: 0.460 Test Loss: 5.332 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 12.237758159637451
Epoch: 21, Steps: 18 | Train Loss: 0.089 Vali Loss: 5.117 Vali Acc: 0.500 Test Loss: 5.117 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 11.897268295288086
Epoch: 22, Steps: 18 | Train Loss: 0.141 Vali Loss: 5.171 Vali Acc: 0.470 Test Loss: 5.171 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 12.416385412216187
Epoch: 23, Steps: 18 | Train Loss: 0.200 Vali Loss: 5.072 Vali Acc: 0.560 Test Loss: 5.072 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 11.281880617141724
Epoch: 24, Steps: 18 | Train Loss: 0.579 Vali Loss: 10.491 Vali Acc: 0.520 Test Loss: 10.491 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 759874
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.83697247505188
Epoch: 1, Steps: 18 | Train Loss: 0.886 Vali Loss: 0.974 Vali Acc: 0.500 Test Loss: 0.974 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 10.071752071380615
Epoch: 2, Steps: 18 | Train Loss: 0.856 Vali Loss: 1.260 Vali Acc: 0.530 Test Loss: 1.260 Test Acc: 0.530
Validation loss decreased (-0.499990 --> -0.529987).  Saving model ...
Epoch: 3 cost time: 10.644450187683105
Epoch: 3, Steps: 18 | Train Loss: 0.632 Vali Loss: 0.984 Vali Acc: 0.550 Test Loss: 0.984 Test Acc: 0.550
Validation loss decreased (-0.529987 --> -0.549990).  Saving model ...
Epoch: 4 cost time: 10.25748085975647
Epoch: 4, Steps: 18 | Train Loss: 0.578 Vali Loss: 1.230 Vali Acc: 0.540 Test Loss: 1.230 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.530121564865112
Epoch: 5, Steps: 18 | Train Loss: 0.717 Vali Loss: 1.865 Vali Acc: 0.530 Test Loss: 1.865 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.230254411697388
Epoch: 6, Steps: 18 | Train Loss: 0.582 Vali Loss: 1.471 Vali Acc: 0.570 Test Loss: 1.471 Test Acc: 0.570
Validation loss decreased (-0.549990 --> -0.569985).  Saving model ...
Epoch: 7 cost time: 10.476801633834839
Epoch: 7, Steps: 18 | Train Loss: 0.795 Vali Loss: 2.142 Vali Acc: 0.550 Test Loss: 2.142 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.810028314590454
Epoch: 8, Steps: 18 | Train Loss: 0.966 Vali Loss: 4.610 Vali Acc: 0.520 Test Loss: 4.610 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.554325103759766
Epoch: 9, Steps: 18 | Train Loss: 0.415 Vali Loss: 4.036 Vali Acc: 0.510 Test Loss: 4.036 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.09019923210144
Epoch: 10, Steps: 18 | Train Loss: 0.612 Vali Loss: 2.909 Vali Acc: 0.520 Test Loss: 2.909 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.746827840805054
Epoch: 11, Steps: 18 | Train Loss: 0.440 Vali Loss: 4.024 Vali Acc: 0.510 Test Loss: 4.024 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.215757608413696
Epoch: 12, Steps: 18 | Train Loss: 0.469 Vali Loss: 5.001 Vali Acc: 0.520 Test Loss: 5.001 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.908150672912598
Epoch: 13, Steps: 18 | Train Loss: 0.229 Vali Loss: 3.813 Vali Acc: 0.580 Test Loss: 3.813 Test Acc: 0.580
Validation loss decreased (-0.569985 --> -0.579962).  Saving model ...
Epoch: 14 cost time: 10.624880075454712
Epoch: 14, Steps: 18 | Train Loss: 0.304 Vali Loss: 3.600 Vali Acc: 0.560 Test Loss: 3.600 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.638973712921143
Epoch: 15, Steps: 18 | Train Loss: 0.357 Vali Loss: 3.722 Vali Acc: 0.600 Test Loss: 3.722 Test Acc: 0.600
Validation loss decreased (-0.579962 --> -0.599963).  Saving model ...
Epoch: 16 cost time: 10.211801767349243
Epoch: 16, Steps: 18 | Train Loss: 0.203 Vali Loss: 7.738 Vali Acc: 0.540 Test Loss: 7.738 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.102365016937256
Epoch: 17, Steps: 18 | Train Loss: 0.762 Vali Loss: 8.686 Vali Acc: 0.530 Test Loss: 8.686 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.70728349685669
Epoch: 18, Steps: 18 | Train Loss: 1.081 Vali Loss: 6.189 Vali Acc: 0.520 Test Loss: 6.189 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.36737608909607
Epoch: 19, Steps: 18 | Train Loss: 0.320 Vali Loss: 5.255 Vali Acc: 0.510 Test Loss: 5.255 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.018863201141357
Epoch: 20, Steps: 18 | Train Loss: 0.127 Vali Loss: 6.348 Vali Acc: 0.500 Test Loss: 6.348 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.776663780212402
Epoch: 21, Steps: 18 | Train Loss: 0.188 Vali Loss: 9.330 Vali Acc: 0.540 Test Loss: 9.330 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.781622886657715
Epoch: 22, Steps: 18 | Train Loss: 0.497 Vali Loss: 5.877 Vali Acc: 0.470 Test Loss: 5.877 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 10.377797842025757
Epoch: 23, Steps: 18 | Train Loss: 0.202 Vali Loss: 7.262 Vali Acc: 0.500 Test Loss: 7.262 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 10.639584064483643
Epoch: 24, Steps: 18 | Train Loss: 0.336 Vali Loss: 6.715 Vali Acc: 0.480 Test Loss: 6.715 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 10.969184160232544
Epoch: 25, Steps: 18 | Train Loss: 0.871 Vali Loss: 10.007 Vali Acc: 0.550 Test Loss: 10.007 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 759874
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.27110505104065
Epoch: 1, Steps: 18 | Train Loss: 0.901 Vali Loss: 0.891 Vali Acc: 0.460 Test Loss: 0.891 Test Acc: 0.460
Validation loss decreased (inf --> -0.459991).  Saving model ...
Epoch: 2 cost time: 9.298730611801147
Epoch: 2, Steps: 18 | Train Loss: 0.903 Vali Loss: 2.987 Vali Acc: 0.500 Test Loss: 2.987 Test Acc: 0.500
Validation loss decreased (-0.459991 --> -0.499970).  Saving model ...
Epoch: 3 cost time: 9.274570226669312
Epoch: 3, Steps: 18 | Train Loss: 0.842 Vali Loss: 1.811 Vali Acc: 0.510 Test Loss: 1.811 Test Acc: 0.510
Validation loss decreased (-0.499970 --> -0.509982).  Saving model ...
Epoch: 4 cost time: 9.179744720458984
Epoch: 4, Steps: 18 | Train Loss: 0.489 Vali Loss: 1.386 Vali Acc: 0.510 Test Loss: 1.386 Test Acc: 0.510
Validation loss decreased (-0.509982 --> -0.509986).  Saving model ...
Epoch: 5 cost time: 8.436697959899902
Epoch: 5, Steps: 18 | Train Loss: 0.429 Vali Loss: 1.421 Vali Acc: 0.560 Test Loss: 1.421 Test Acc: 0.560
Validation loss decreased (-0.509986 --> -0.559986).  Saving model ...
Epoch: 6 cost time: 8.718793869018555
Epoch: 6, Steps: 18 | Train Loss: 0.405 Vali Loss: 2.164 Vali Acc: 0.520 Test Loss: 2.164 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.700100183486938
Epoch: 7, Steps: 18 | Train Loss: 0.309 Vali Loss: 2.043 Vali Acc: 0.520 Test Loss: 2.043 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.982394218444824
Epoch: 8, Steps: 18 | Train Loss: 0.560 Vali Loss: 2.497 Vali Acc: 0.510 Test Loss: 2.497 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.391992092132568
Epoch: 9, Steps: 18 | Train Loss: 0.506 Vali Loss: 4.216 Vali Acc: 0.560 Test Loss: 4.216 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.637876987457275
Epoch: 10, Steps: 18 | Train Loss: 0.645 Vali Loss: 2.991 Vali Acc: 0.540 Test Loss: 2.991 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.233829498291016
Epoch: 11, Steps: 18 | Train Loss: 0.848 Vali Loss: 5.564 Vali Acc: 0.470 Test Loss: 5.564 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.161389112472534
Epoch: 12, Steps: 18 | Train Loss: 0.189 Vali Loss: 3.295 Vali Acc: 0.520 Test Loss: 3.295 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.722550392150879
Epoch: 13, Steps: 18 | Train Loss: 0.913 Vali Loss: 5.779 Vali Acc: 0.550 Test Loss: 5.779 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.417632102966309
Epoch: 14, Steps: 18 | Train Loss: 0.376 Vali Loss: 4.240 Vali Acc: 0.550 Test Loss: 4.240 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.82284688949585
Epoch: 15, Steps: 18 | Train Loss: 0.160 Vali Loss: 5.236 Vali Acc: 0.590 Test Loss: 5.236 Test Acc: 0.590
Validation loss decreased (-0.559986 --> -0.589948).  Saving model ...
Epoch: 16 cost time: 8.637463569641113
Epoch: 16, Steps: 18 | Train Loss: 0.382 Vali Loss: 4.761 Vali Acc: 0.540 Test Loss: 4.761 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.074541330337524
Epoch: 17, Steps: 18 | Train Loss: 0.408 Vali Loss: 9.619 Vali Acc: 0.510 Test Loss: 9.619 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.476076602935791
Epoch: 18, Steps: 18 | Train Loss: 0.729 Vali Loss: 6.725 Vali Acc: 0.570 Test Loss: 6.725 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.842331886291504
Epoch: 19, Steps: 18 | Train Loss: 0.407 Vali Loss: 13.889 Vali Acc: 0.510 Test Loss: 13.889 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.793298244476318
Epoch: 20, Steps: 18 | Train Loss: 0.260 Vali Loss: 4.988 Vali Acc: 0.550 Test Loss: 4.988 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.23606538772583
Epoch: 21, Steps: 18 | Train Loss: 0.132 Vali Loss: 11.169 Vali Acc: 0.530 Test Loss: 11.169 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.699142694473267
Epoch: 22, Steps: 18 | Train Loss: 0.242 Vali Loss: 8.423 Vali Acc: 0.540 Test Loss: 8.423 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 9.72556447982788
Epoch: 23, Steps: 18 | Train Loss: 0.114 Vali Loss: 6.422 Vali Acc: 0.550 Test Loss: 6.422 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 9.432975053787231
Epoch: 24, Steps: 18 | Train Loss: 0.229 Vali Loss: 8.629 Vali Acc: 0.540 Test Loss: 8.629 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.934242010116577
Epoch: 25, Steps: 18 | Train Loss: 0.232 Vali Loss: 7.976 Vali Acc: 0.500 Test Loss: 7.976 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 759874
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.77050256729126
Epoch: 1, Steps: 18 | Train Loss: 0.861 Vali Loss: 0.893 Vali Acc: 0.460 Test Loss: 0.893 Test Acc: 0.460
Validation loss decreased (inf --> -0.459991).  Saving model ...
Epoch: 2 cost time: 7.44986891746521
Epoch: 2, Steps: 18 | Train Loss: 0.768 Vali Loss: 1.286 Vali Acc: 0.520 Test Loss: 1.286 Test Acc: 0.520
Validation loss decreased (-0.459991 --> -0.519987).  Saving model ...
Epoch: 3 cost time: 7.481898546218872
Epoch: 3, Steps: 18 | Train Loss: 0.582 Vali Loss: 1.173 Vali Acc: 0.570 Test Loss: 1.173 Test Acc: 0.570
Validation loss decreased (-0.519987 --> -0.569988).  Saving model ...
Epoch: 4 cost time: 7.923223972320557
Epoch: 4, Steps: 18 | Train Loss: 0.538 Vali Loss: 1.484 Vali Acc: 0.550 Test Loss: 1.484 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.976867198944092
Epoch: 5, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.700 Vali Acc: 0.540 Test Loss: 1.700 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.735989093780518
Epoch: 6, Steps: 18 | Train Loss: 0.456 Vali Loss: 1.539 Vali Acc: 0.540 Test Loss: 1.539 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.816467523574829
Epoch: 7, Steps: 18 | Train Loss: 0.651 Vali Loss: 1.638 Vali Acc: 0.520 Test Loss: 1.638 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.076396465301514
Epoch: 8, Steps: 18 | Train Loss: 0.576 Vali Loss: 2.446 Vali Acc: 0.500 Test Loss: 2.446 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.045883893966675
Epoch: 9, Steps: 18 | Train Loss: 0.288 Vali Loss: 2.867 Vali Acc: 0.480 Test Loss: 2.867 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.778679132461548
Epoch: 10, Steps: 18 | Train Loss: 0.525 Vali Loss: 2.487 Vali Acc: 0.500 Test Loss: 2.487 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.854794025421143
Epoch: 11, Steps: 18 | Train Loss: 0.705 Vali Loss: 3.541 Vali Acc: 0.550 Test Loss: 3.541 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.836665391921997
Epoch: 12, Steps: 18 | Train Loss: 1.249 Vali Loss: 2.844 Vali Acc: 0.550 Test Loss: 2.844 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.441890716552734
Epoch: 13, Steps: 18 | Train Loss: 0.744 Vali Loss: 3.430 Vali Acc: 0.530 Test Loss: 3.430 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 759874
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.082407712936401
Epoch: 1, Steps: 18 | Train Loss: 0.869 Vali Loss: 0.872 Vali Acc: 0.460 Test Loss: 0.872 Test Acc: 0.460
Validation loss decreased (inf --> -0.459991).  Saving model ...
Epoch: 2 cost time: 6.44261360168457
Epoch: 2, Steps: 18 | Train Loss: 0.804 Vali Loss: 1.900 Vali Acc: 0.490 Test Loss: 1.900 Test Acc: 0.490
Validation loss decreased (-0.459991 --> -0.489981).  Saving model ...
Epoch: 3 cost time: 6.238945960998535
Epoch: 3, Steps: 18 | Train Loss: 0.757 Vali Loss: 1.825 Vali Acc: 0.520 Test Loss: 1.825 Test Acc: 0.520
Validation loss decreased (-0.489981 --> -0.519982).  Saving model ...
Epoch: 4 cost time: 6.511657953262329
Epoch: 4, Steps: 18 | Train Loss: 0.558 Vali Loss: 1.873 Vali Acc: 0.500 Test Loss: 1.873 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.483149766921997
Epoch: 5, Steps: 18 | Train Loss: 0.519 Vali Loss: 1.532 Vali Acc: 0.570 Test Loss: 1.532 Test Acc: 0.570
Validation loss decreased (-0.519982 --> -0.569985).  Saving model ...
Epoch: 6 cost time: 6.3641932010650635
Epoch: 6, Steps: 18 | Train Loss: 0.449 Vali Loss: 2.255 Vali Acc: 0.510 Test Loss: 2.255 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.413611650466919
Epoch: 7, Steps: 18 | Train Loss: 0.398 Vali Loss: 1.624 Vali Acc: 0.490 Test Loss: 1.624 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.698239803314209
Epoch: 8, Steps: 18 | Train Loss: 1.605 Vali Loss: 2.088 Vali Acc: 0.550 Test Loss: 2.088 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.526077747344971
Epoch: 9, Steps: 18 | Train Loss: 0.499 Vali Loss: 2.439 Vali Acc: 0.550 Test Loss: 2.439 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.5482707023620605
Epoch: 10, Steps: 18 | Train Loss: 0.310 Vali Loss: 1.902 Vali Acc: 0.570 Test Loss: 1.902 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.729283571243286
Epoch: 11, Steps: 18 | Train Loss: 0.181 Vali Loss: 3.038 Vali Acc: 0.480 Test Loss: 3.038 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.479165554046631
Epoch: 12, Steps: 18 | Train Loss: 0.251 Vali Loss: 3.544 Vali Acc: 0.510 Test Loss: 3.544 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.354687213897705
Epoch: 13, Steps: 18 | Train Loss: 0.303 Vali Loss: 2.794 Vali Acc: 0.540 Test Loss: 2.794 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.474529027938843
Epoch: 14, Steps: 18 | Train Loss: 0.366 Vali Loss: 4.191 Vali Acc: 0.540 Test Loss: 4.191 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.2349700927734375
Epoch: 15, Steps: 18 | Train Loss: 0.350 Vali Loss: 3.994 Vali Acc: 0.570 Test Loss: 3.994 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 759874
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.2684221267700195
Epoch: 1, Steps: 18 | Train Loss: 0.816 Vali Loss: 0.846 Vali Acc: 0.500 Test Loss: 0.846 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 6.1339476108551025
Epoch: 2, Steps: 18 | Train Loss: 0.797 Vali Loss: 1.025 Vali Acc: 0.540 Test Loss: 1.025 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539990).  Saving model ...
Epoch: 3 cost time: 6.113922595977783
Epoch: 3, Steps: 18 | Train Loss: 1.044 Vali Loss: 2.051 Vali Acc: 0.510 Test Loss: 2.051 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.806276798248291
Epoch: 4, Steps: 18 | Train Loss: 0.921 Vali Loss: 4.148 Vali Acc: 0.500 Test Loss: 4.148 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.739070892333984
Epoch: 5, Steps: 18 | Train Loss: 1.144 Vali Loss: 2.010 Vali Acc: 0.510 Test Loss: 2.010 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.922332286834717
Epoch: 6, Steps: 18 | Train Loss: 0.570 Vali Loss: 1.604 Vali Acc: 0.440 Test Loss: 1.604 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.097347974777222
Epoch: 7, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.397 Vali Acc: 0.520 Test Loss: 1.397 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.251796245574951
Epoch: 8, Steps: 18 | Train Loss: 0.194 Vali Loss: 1.717 Vali Acc: 0.500 Test Loss: 1.717 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.781473159790039
Epoch: 9, Steps: 18 | Train Loss: 0.260 Vali Loss: 2.728 Vali Acc: 0.440 Test Loss: 2.728 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.951044321060181
Epoch: 10, Steps: 18 | Train Loss: 0.195 Vali Loss: 4.633 Vali Acc: 0.520 Test Loss: 4.633 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.868781328201294
Epoch: 11, Steps: 18 | Train Loss: 0.081 Vali Loss: 3.733 Vali Acc: 0.490 Test Loss: 3.733 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.523147106170654
Epoch: 12, Steps: 18 | Train Loss: 0.295 Vali Loss: 3.801 Vali Acc: 0.510 Test Loss: 3.801 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 759874
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.969061851501465
Epoch: 1, Steps: 18 | Train Loss: 0.799 Vali Loss: 0.812 Vali Acc: 0.550 Test Loss: 0.812 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 5.805431842803955
Epoch: 2, Steps: 18 | Train Loss: 0.748 Vali Loss: 1.705 Vali Acc: 0.510 Test Loss: 1.705 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.2369115352630615
Epoch: 3, Steps: 18 | Train Loss: 0.664 Vali Loss: 1.246 Vali Acc: 0.520 Test Loss: 1.246 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.742029428482056
Epoch: 4, Steps: 18 | Train Loss: 0.399 Vali Loss: 1.386 Vali Acc: 0.470 Test Loss: 1.386 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.716706037521362
Epoch: 5, Steps: 18 | Train Loss: 0.612 Vali Loss: 4.090 Vali Acc: 0.510 Test Loss: 4.090 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.070386171340942
Epoch: 6, Steps: 18 | Train Loss: 0.606 Vali Loss: 3.056 Vali Acc: 0.520 Test Loss: 3.056 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.090444803237915
Epoch: 7, Steps: 18 | Train Loss: 0.365 Vali Loss: 2.456 Vali Acc: 0.560 Test Loss: 2.456 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559975).  Saving model ...
Epoch: 8 cost time: 6.025778770446777
Epoch: 8, Steps: 18 | Train Loss: 0.287 Vali Loss: 3.030 Vali Acc: 0.570 Test Loss: 3.030 Test Acc: 0.570
Validation loss decreased (-0.559975 --> -0.569970).  Saving model ...
Epoch: 9 cost time: 6.2326202392578125
Epoch: 9, Steps: 18 | Train Loss: 0.241 Vali Loss: 2.685 Vali Acc: 0.520 Test Loss: 2.685 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.4377830028533936
Epoch: 10, Steps: 18 | Train Loss: 0.248 Vali Loss: 2.617 Vali Acc: 0.500 Test Loss: 2.617 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.621183156967163
Epoch: 11, Steps: 18 | Train Loss: 0.436 Vali Loss: 4.172 Vali Acc: 0.570 Test Loss: 4.172 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.579895734786987
Epoch: 12, Steps: 18 | Train Loss: 0.394 Vali Loss: 4.906 Vali Acc: 0.550 Test Loss: 4.906 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.675677299499512
Epoch: 13, Steps: 18 | Train Loss: 0.247 Vali Loss: 4.557 Vali Acc: 0.520 Test Loss: 4.557 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.11137843132019
Epoch: 14, Steps: 18 | Train Loss: 0.254 Vali Loss: 5.320 Vali Acc: 0.500 Test Loss: 5.320 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.785285234451294
Epoch: 15, Steps: 18 | Train Loss: 0.113 Vali Loss: 5.063 Vali Acc: 0.520 Test Loss: 5.063 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.17113184928894
Epoch: 16, Steps: 18 | Train Loss: 0.065 Vali Loss: 4.876 Vali Acc: 0.560 Test Loss: 4.876 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.922826290130615
Epoch: 17, Steps: 18 | Train Loss: 0.102 Vali Loss: 5.661 Vali Acc: 0.530 Test Loss: 5.661 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.840420722961426
Epoch: 18, Steps: 18 | Train Loss: 0.122 Vali Loss: 6.931 Vali Acc: 0.510 Test Loss: 6.931 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 759874
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.191186189651489
Epoch: 1, Steps: 18 | Train Loss: 0.794 Vali Loss: 0.807 Vali Acc: 0.510 Test Loss: 0.807 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 5.808403968811035
Epoch: 2, Steps: 18 | Train Loss: 0.806 Vali Loss: 2.820 Vali Acc: 0.500 Test Loss: 2.820 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.592499732971191
Epoch: 3, Steps: 18 | Train Loss: 1.281 Vali Loss: 2.302 Vali Acc: 0.490 Test Loss: 2.302 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.012590408325195
Epoch: 4, Steps: 18 | Train Loss: 0.910 Vali Loss: 2.374 Vali Acc: 0.480 Test Loss: 2.374 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.843378305435181
Epoch: 5, Steps: 18 | Train Loss: 0.809 Vali Loss: 1.322 Vali Acc: 0.560 Test Loss: 1.322 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559987).  Saving model ...
Epoch: 6 cost time: 5.816208124160767
Epoch: 6, Steps: 18 | Train Loss: 0.615 Vali Loss: 2.669 Vali Acc: 0.480 Test Loss: 2.669 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.808544635772705
Epoch: 7, Steps: 18 | Train Loss: 0.665 Vali Loss: 2.096 Vali Acc: 0.570 Test Loss: 2.096 Test Acc: 0.570
Validation loss decreased (-0.559987 --> -0.569979).  Saving model ...
Epoch: 8 cost time: 5.9705727100372314
Epoch: 8, Steps: 18 | Train Loss: 0.407 Vali Loss: 2.583 Vali Acc: 0.470 Test Loss: 2.583 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.915350437164307
Epoch: 9, Steps: 18 | Train Loss: 0.218 Vali Loss: 2.640 Vali Acc: 0.530 Test Loss: 2.640 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.749780178070068
Epoch: 10, Steps: 18 | Train Loss: 0.156 Vali Loss: 2.663 Vali Acc: 0.570 Test Loss: 2.663 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.894250392913818
Epoch: 11, Steps: 18 | Train Loss: 0.142 Vali Loss: 3.739 Vali Acc: 0.550 Test Loss: 3.739 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.852923154830933
Epoch: 12, Steps: 18 | Train Loss: 0.144 Vali Loss: 3.340 Vali Acc: 0.560 Test Loss: 3.340 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.8386757373809814
Epoch: 13, Steps: 18 | Train Loss: 0.162 Vali Loss: 5.240 Vali Acc: 0.480 Test Loss: 5.240 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.610580205917358
Epoch: 14, Steps: 18 | Train Loss: 0.404 Vali Loss: 3.070 Vali Acc: 0.550 Test Loss: 3.070 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.892814636230469
Epoch: 15, Steps: 18 | Train Loss: 0.261 Vali Loss: 4.537 Vali Acc: 0.520 Test Loss: 4.537 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.082935094833374
Epoch: 16, Steps: 18 | Train Loss: 0.210 Vali Loss: 4.151 Vali Acc: 0.460 Test Loss: 4.151 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.828512191772461
Epoch: 17, Steps: 18 | Train Loss: 0.034 Vali Loss: 4.448 Vali Acc: 0.590 Test Loss: 4.448 Test Acc: 0.590
Validation loss decreased (-0.569979 --> -0.589956).  Saving model ...
Epoch: 18 cost time: 5.849735260009766
Epoch: 18, Steps: 18 | Train Loss: 0.123 Vali Loss: 8.304 Vali Acc: 0.500 Test Loss: 8.304 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.620862722396851
Epoch: 19, Steps: 18 | Train Loss: 0.048 Vali Loss: 7.189 Vali Acc: 0.550 Test Loss: 7.189 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.885364294052124
Epoch: 20, Steps: 18 | Train Loss: 0.064 Vali Loss: 6.750 Vali Acc: 0.480 Test Loss: 6.750 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.840569019317627
Epoch: 21, Steps: 18 | Train Loss: 0.071 Vali Loss: 6.724 Vali Acc: 0.540 Test Loss: 6.724 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.603116273880005
Epoch: 22, Steps: 18 | Train Loss: 0.262 Vali Loss: 7.135 Vali Acc: 0.530 Test Loss: 7.135 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.813682556152344
Epoch: 23, Steps: 18 | Train Loss: 0.110 Vali Loss: 5.677 Vali Acc: 0.490 Test Loss: 5.677 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.731105327606201
Epoch: 24, Steps: 18 | Train Loss: 0.072 Vali Loss: 5.143 Vali Acc: 0.540 Test Loss: 5.143 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.971203804016113
Epoch: 25, Steps: 18 | Train Loss: 0.086 Vali Loss: 6.463 Vali Acc: 0.560 Test Loss: 6.463 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.0341925621032715
Epoch: 26, Steps: 18 | Train Loss: 0.082 Vali Loss: 7.122 Vali Acc: 0.500 Test Loss: 7.122 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.736911773681641
Epoch: 27, Steps: 18 | Train Loss: 0.077 Vali Loss: 10.306 Vali Acc: 0.460 Test Loss: 10.306 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 759874
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.401293754577637
Epoch: 1, Steps: 18 | Train Loss: 0.823 Vali Loss: 0.756 Vali Acc: 0.580 Test Loss: 0.756 Test Acc: 0.580
Validation loss decreased (inf --> -0.579992).  Saving model ...
Epoch: 2 cost time: 5.4594645500183105
Epoch: 2, Steps: 18 | Train Loss: 0.778 Vali Loss: 1.449 Vali Acc: 0.510 Test Loss: 1.449 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.906534671783447
Epoch: 3, Steps: 18 | Train Loss: 0.769 Vali Loss: 1.572 Vali Acc: 0.530 Test Loss: 1.572 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.971719026565552
Epoch: 4, Steps: 18 | Train Loss: 0.608 Vali Loss: 1.026 Vali Acc: 0.540 Test Loss: 1.026 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.818662643432617
Epoch: 5, Steps: 18 | Train Loss: 0.531 Vali Loss: 1.845 Vali Acc: 0.520 Test Loss: 1.845 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.437941312789917
Epoch: 6, Steps: 18 | Train Loss: 0.363 Vali Loss: 1.538 Vali Acc: 0.530 Test Loss: 1.538 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.8784966468811035
Epoch: 7, Steps: 18 | Train Loss: 0.347 Vali Loss: 1.413 Vali Acc: 0.480 Test Loss: 1.413 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.906079292297363
Epoch: 8, Steps: 18 | Train Loss: 0.420 Vali Loss: 2.121 Vali Acc: 0.440 Test Loss: 2.121 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.704586744308472
Epoch: 9, Steps: 18 | Train Loss: 0.275 Vali Loss: 1.903 Vali Acc: 0.490 Test Loss: 1.903 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.6811487674713135
Epoch: 10, Steps: 18 | Train Loss: 0.367 Vali Loss: 4.108 Vali Acc: 0.440 Test Loss: 4.108 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.739477634429932
Epoch: 11, Steps: 18 | Train Loss: 0.245 Vali Loss: 3.473 Vali Acc: 0.520 Test Loss: 3.473 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 759874
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.527203321456909
Epoch: 1, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.709 Vali Acc: 0.550 Test Loss: 0.709 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 5.9262261390686035
Epoch: 2, Steps: 18 | Train Loss: 0.759 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.308202743530273
Epoch: 3, Steps: 18 | Train Loss: 0.757 Vali Loss: 1.315 Vali Acc: 0.500 Test Loss: 1.315 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.547818422317505
Epoch: 4, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.062518358230591
Epoch: 5, Steps: 18 | Train Loss: 0.395 Vali Loss: 0.732 Vali Acc: 0.570 Test Loss: 0.732 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 6.007768630981445
Epoch: 6, Steps: 18 | Train Loss: 0.322 Vali Loss: 0.951 Vali Acc: 0.530 Test Loss: 0.951 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.909263372421265
Epoch: 7, Steps: 18 | Train Loss: 0.243 Vali Loss: 1.069 Vali Acc: 0.540 Test Loss: 1.069 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.961226463317871
Epoch: 8, Steps: 18 | Train Loss: 0.424 Vali Loss: 1.872 Vali Acc: 0.490 Test Loss: 1.872 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.312866926193237
Epoch: 9, Steps: 18 | Train Loss: 0.396 Vali Loss: 1.034 Vali Acc: 0.560 Test Loss: 1.034 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.179713726043701
Epoch: 10, Steps: 18 | Train Loss: 0.157 Vali Loss: 2.306 Vali Acc: 0.520 Test Loss: 2.306 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.1424241065979
Epoch: 11, Steps: 18 | Train Loss: 0.106 Vali Loss: 1.330 Vali Acc: 0.550 Test Loss: 1.330 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.846497058868408
Epoch: 12, Steps: 18 | Train Loss: 0.196 Vali Loss: 1.422 Vali Acc: 0.500 Test Loss: 1.422 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.033097505569458
Epoch: 13, Steps: 18 | Train Loss: 0.126 Vali Loss: 1.661 Vali Acc: 0.470 Test Loss: 1.661 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.870018482208252
Epoch: 14, Steps: 18 | Train Loss: 0.260 Vali Loss: 2.714 Vali Acc: 0.510 Test Loss: 2.714 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.098434686660767
Epoch: 15, Steps: 18 | Train Loss: 0.178 Vali Loss: 1.685 Vali Acc: 0.550 Test Loss: 1.685 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 759874
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.106167793273926
Epoch: 1, Steps: 18 | Train Loss: 0.880 Vali Loss: 0.800 Vali Acc: 0.590 Test Loss: 0.800 Test Acc: 0.590
Validation loss decreased (inf --> -0.589992).  Saving model ...
Epoch: 2 cost time: 12.247146129608154
Epoch: 2, Steps: 18 | Train Loss: 0.655 Vali Loss: 1.940 Vali Acc: 0.490 Test Loss: 1.940 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.628422021865845
Epoch: 3, Steps: 18 | Train Loss: 0.573 Vali Loss: 0.969 Vali Acc: 0.540 Test Loss: 0.969 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.040642023086548
Epoch: 4, Steps: 18 | Train Loss: 0.382 Vali Loss: 1.465 Vali Acc: 0.510 Test Loss: 1.465 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.366820096969604
Epoch: 5, Steps: 18 | Train Loss: 0.353 Vali Loss: 1.244 Vali Acc: 0.550 Test Loss: 1.244 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.473659992218018
Epoch: 6, Steps: 18 | Train Loss: 0.322 Vali Loss: 1.649 Vali Acc: 0.530 Test Loss: 1.649 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.625732183456421
Epoch: 7, Steps: 18 | Train Loss: 0.734 Vali Loss: 1.949 Vali Acc: 0.540 Test Loss: 1.949 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.920125484466553
Epoch: 8, Steps: 18 | Train Loss: 0.827 Vali Loss: 1.522 Vali Acc: 0.590 Test Loss: 1.522 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.973392963409424
Epoch: 9, Steps: 18 | Train Loss: 0.432 Vali Loss: 1.880 Vali Acc: 0.570 Test Loss: 1.880 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.288050651550293
Epoch: 10, Steps: 18 | Train Loss: 0.344 Vali Loss: 2.542 Vali Acc: 0.550 Test Loss: 2.542 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.628824472427368
Epoch: 11, Steps: 18 | Train Loss: 0.354 Vali Loss: 3.934 Vali Acc: 0.540 Test Loss: 3.934 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 661570
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.42947006225586
Epoch: 1, Steps: 18 | Train Loss: 0.862 Vali Loss: 0.728 Vali Acc: 0.610 Test Loss: 0.728 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 9.770238637924194
Epoch: 2, Steps: 18 | Train Loss: 0.677 Vali Loss: 1.933 Vali Acc: 0.520 Test Loss: 1.933 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.609760522842407
Epoch: 3, Steps: 18 | Train Loss: 0.710 Vali Loss: 1.244 Vali Acc: 0.600 Test Loss: 1.244 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.282169580459595
Epoch: 4, Steps: 18 | Train Loss: 0.613 Vali Loss: 1.179 Vali Acc: 0.540 Test Loss: 1.179 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.349668025970459
Epoch: 5, Steps: 18 | Train Loss: 0.366 Vali Loss: 1.432 Vali Acc: 0.450 Test Loss: 1.432 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.93722152709961
Epoch: 6, Steps: 18 | Train Loss: 0.455 Vali Loss: 1.833 Vali Acc: 0.500 Test Loss: 1.833 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.3209228515625
Epoch: 7, Steps: 18 | Train Loss: 0.286 Vali Loss: 2.443 Vali Acc: 0.500 Test Loss: 2.443 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.111673831939697
Epoch: 8, Steps: 18 | Train Loss: 0.566 Vali Loss: 3.548 Vali Acc: 0.520 Test Loss: 3.548 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.362114906311035
Epoch: 9, Steps: 18 | Train Loss: 0.203 Vali Loss: 2.817 Vali Acc: 0.500 Test Loss: 2.817 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 10.311895370483398
Epoch: 10, Steps: 18 | Train Loss: 0.704 Vali Loss: 2.801 Vali Acc: 0.540 Test Loss: 2.801 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.97883915901184
Epoch: 11, Steps: 18 | Train Loss: 0.261 Vali Loss: 3.138 Vali Acc: 0.540 Test Loss: 3.138 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 661570
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.957902193069458
Epoch: 1, Steps: 18 | Train Loss: 0.839 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 8.409136056900024
Epoch: 2, Steps: 18 | Train Loss: 0.642 Vali Loss: 1.558 Vali Acc: 0.530 Test Loss: 1.558 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529984).  Saving model ...
Epoch: 3 cost time: 8.252027988433838
Epoch: 3, Steps: 18 | Train Loss: 0.479 Vali Loss: 1.237 Vali Acc: 0.540 Test Loss: 1.237 Test Acc: 0.540
Validation loss decreased (-0.529984 --> -0.539988).  Saving model ...
Epoch: 4 cost time: 8.693793773651123
Epoch: 4, Steps: 18 | Train Loss: 0.487 Vali Loss: 1.640 Vali Acc: 0.530 Test Loss: 1.640 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.65335750579834
Epoch: 5, Steps: 18 | Train Loss: 0.406 Vali Loss: 1.518 Vali Acc: 0.550 Test Loss: 1.518 Test Acc: 0.550
Validation loss decreased (-0.539988 --> -0.549985).  Saving model ...
Epoch: 6 cost time: 8.670212268829346
Epoch: 6, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.553 Vali Acc: 0.530 Test Loss: 1.553 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.999618530273438
Epoch: 7, Steps: 18 | Train Loss: 0.650 Vali Loss: 2.859 Vali Acc: 0.500 Test Loss: 2.859 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.74468469619751
Epoch: 8, Steps: 18 | Train Loss: 0.300 Vali Loss: 4.300 Vali Acc: 0.510 Test Loss: 4.300 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.665241003036499
Epoch: 9, Steps: 18 | Train Loss: 0.458 Vali Loss: 2.927 Vali Acc: 0.550 Test Loss: 2.927 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.183337688446045
Epoch: 10, Steps: 18 | Train Loss: 0.108 Vali Loss: 2.852 Vali Acc: 0.560 Test Loss: 2.852 Test Acc: 0.560
Validation loss decreased (-0.549985 --> -0.559971).  Saving model ...
Epoch: 11 cost time: 8.806371688842773
Epoch: 11, Steps: 18 | Train Loss: 0.150 Vali Loss: 2.560 Vali Acc: 0.550 Test Loss: 2.560 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.768009424209595
Epoch: 12, Steps: 18 | Train Loss: 0.114 Vali Loss: 2.994 Vali Acc: 0.570 Test Loss: 2.994 Test Acc: 0.570
Validation loss decreased (-0.559971 --> -0.569970).  Saving model ...
Epoch: 13 cost time: 8.299417734146118
Epoch: 13, Steps: 18 | Train Loss: 0.136 Vali Loss: 4.316 Vali Acc: 0.540 Test Loss: 4.316 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.450050354003906
Epoch: 14, Steps: 18 | Train Loss: 0.436 Vali Loss: 3.042 Vali Acc: 0.510 Test Loss: 3.042 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.600260734558105
Epoch: 15, Steps: 18 | Train Loss: 0.422 Vali Loss: 3.754 Vali Acc: 0.550 Test Loss: 3.754 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.355746507644653
Epoch: 16, Steps: 18 | Train Loss: 0.236 Vali Loss: 4.051 Vali Acc: 0.520 Test Loss: 4.051 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.771750211715698
Epoch: 17, Steps: 18 | Train Loss: 0.266 Vali Loss: 4.490 Vali Acc: 0.550 Test Loss: 4.490 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.134413957595825
Epoch: 18, Steps: 18 | Train Loss: 0.229 Vali Loss: 5.045 Vali Acc: 0.520 Test Loss: 5.045 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.233961343765259
Epoch: 19, Steps: 18 | Train Loss: 0.331 Vali Loss: 7.907 Vali Acc: 0.530 Test Loss: 7.907 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.24075961112976
Epoch: 20, Steps: 18 | Train Loss: 0.250 Vali Loss: 5.025 Vali Acc: 0.540 Test Loss: 5.025 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.552246570587158
Epoch: 21, Steps: 18 | Train Loss: 0.201 Vali Loss: 11.764 Vali Acc: 0.540 Test Loss: 11.764 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.163586378097534
Epoch: 22, Steps: 18 | Train Loss: 0.096 Vali Loss: 6.858 Vali Acc: 0.530 Test Loss: 6.858 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 661570
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.49922227859497
Epoch: 1, Steps: 18 | Train Loss: 0.827 Vali Loss: 0.827 Vali Acc: 0.490 Test Loss: 0.827 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 7.4813008308410645
Epoch: 2, Steps: 18 | Train Loss: 0.594 Vali Loss: 1.097 Vali Acc: 0.530 Test Loss: 1.097 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529989).  Saving model ...
Epoch: 3 cost time: 7.322964906692505
Epoch: 3, Steps: 18 | Train Loss: 0.441 Vali Loss: 1.091 Vali Acc: 0.520 Test Loss: 1.091 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.268116474151611
Epoch: 4, Steps: 18 | Train Loss: 0.525 Vali Loss: 3.535 Vali Acc: 0.500 Test Loss: 3.535 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.545378684997559
Epoch: 5, Steps: 18 | Train Loss: 0.595 Vali Loss: 1.071 Vali Acc: 0.590 Test Loss: 1.071 Test Acc: 0.590
Validation loss decreased (-0.529989 --> -0.589989).  Saving model ...
Epoch: 6 cost time: 7.816101551055908
Epoch: 6, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.546 Vali Acc: 0.510 Test Loss: 1.546 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.678479909896851
Epoch: 7, Steps: 18 | Train Loss: 0.456 Vali Loss: 1.989 Vali Acc: 0.480 Test Loss: 1.989 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.9404497146606445
Epoch: 8, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.862 Vali Acc: 0.550 Test Loss: 1.862 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.77220606803894
Epoch: 9, Steps: 18 | Train Loss: 0.279 Vali Loss: 2.882 Vali Acc: 0.480 Test Loss: 2.882 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.830288887023926
Epoch: 10, Steps: 18 | Train Loss: 0.321 Vali Loss: 3.370 Vali Acc: 0.480 Test Loss: 3.370 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.719456672668457
Epoch: 11, Steps: 18 | Train Loss: 0.309 Vali Loss: 3.441 Vali Acc: 0.520 Test Loss: 3.441 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.749709129333496
Epoch: 12, Steps: 18 | Train Loss: 0.508 Vali Loss: 2.695 Vali Acc: 0.550 Test Loss: 2.695 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.432359457015991
Epoch: 13, Steps: 18 | Train Loss: 0.166 Vali Loss: 2.843 Vali Acc: 0.520 Test Loss: 2.843 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.496736764907837
Epoch: 14, Steps: 18 | Train Loss: 0.130 Vali Loss: 3.893 Vali Acc: 0.470 Test Loss: 3.893 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.3758885860443115
Epoch: 15, Steps: 18 | Train Loss: 0.150 Vali Loss: 3.176 Vali Acc: 0.540 Test Loss: 3.176 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 661570
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.816103219985962
Epoch: 1, Steps: 18 | Train Loss: 0.832 Vali Loss: 0.911 Vali Acc: 0.550 Test Loss: 0.911 Test Acc: 0.550
Validation loss decreased (inf --> -0.549991).  Saving model ...
Epoch: 2 cost time: 6.4943461418151855
Epoch: 2, Steps: 18 | Train Loss: 0.706 Vali Loss: 0.788 Vali Acc: 0.510 Test Loss: 0.788 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.494352102279663
Epoch: 3, Steps: 18 | Train Loss: 0.482 Vali Loss: 1.187 Vali Acc: 0.540 Test Loss: 1.187 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.693573713302612
Epoch: 4, Steps: 18 | Train Loss: 0.436 Vali Loss: 1.005 Vali Acc: 0.550 Test Loss: 1.005 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.326974391937256
Epoch: 5, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.260 Vali Acc: 0.630 Test Loss: 1.260 Test Acc: 0.630
Validation loss decreased (-0.549991 --> -0.629987).  Saving model ...
Epoch: 6 cost time: 6.317239046096802
Epoch: 6, Steps: 18 | Train Loss: 0.249 Vali Loss: 2.222 Vali Acc: 0.520 Test Loss: 2.222 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.68916392326355
Epoch: 7, Steps: 18 | Train Loss: 0.258 Vali Loss: 2.239 Vali Acc: 0.530 Test Loss: 2.239 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.525761365890503
Epoch: 8, Steps: 18 | Train Loss: 0.427 Vali Loss: 2.291 Vali Acc: 0.440 Test Loss: 2.291 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.219573974609375
Epoch: 9, Steps: 18 | Train Loss: 0.316 Vali Loss: 2.287 Vali Acc: 0.560 Test Loss: 2.287 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.156484127044678
Epoch: 10, Steps: 18 | Train Loss: 0.302 Vali Loss: 2.915 Vali Acc: 0.450 Test Loss: 2.915 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.4218361377716064
Epoch: 11, Steps: 18 | Train Loss: 0.155 Vali Loss: 2.574 Vali Acc: 0.520 Test Loss: 2.574 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.3837339878082275
Epoch: 12, Steps: 18 | Train Loss: 0.143 Vali Loss: 3.808 Vali Acc: 0.490 Test Loss: 3.808 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.215853691101074
Epoch: 13, Steps: 18 | Train Loss: 1.117 Vali Loss: 3.792 Vali Acc: 0.530 Test Loss: 3.792 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.5185980796813965
Epoch: 14, Steps: 18 | Train Loss: 0.455 Vali Loss: 4.662 Vali Acc: 0.580 Test Loss: 4.662 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.403503179550171
Epoch: 15, Steps: 18 | Train Loss: 0.304 Vali Loss: 2.887 Vali Acc: 0.600 Test Loss: 2.887 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 661570
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.772733211517334
Epoch: 1, Steps: 18 | Train Loss: 0.825 Vali Loss: 0.716 Vali Acc: 0.440 Test Loss: 0.716 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 6.729871988296509
Epoch: 2, Steps: 18 | Train Loss: 0.675 Vali Loss: 0.741 Vali Acc: 0.590 Test Loss: 0.741 Test Acc: 0.590
Validation loss decreased (-0.439993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 6.055965185165405
Epoch: 3, Steps: 18 | Train Loss: 0.661 Vali Loss: 1.594 Vali Acc: 0.510 Test Loss: 1.594 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.36541223526001
Epoch: 4, Steps: 18 | Train Loss: 0.381 Vali Loss: 1.528 Vali Acc: 0.500 Test Loss: 1.528 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.142865180969238
Epoch: 5, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.683 Vali Acc: 0.500 Test Loss: 1.683 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.3228559494018555
Epoch: 6, Steps: 18 | Train Loss: 0.407 Vali Loss: 1.544 Vali Acc: 0.520 Test Loss: 1.544 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.243920803070068
Epoch: 7, Steps: 18 | Train Loss: 0.283 Vali Loss: 3.193 Vali Acc: 0.500 Test Loss: 3.193 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.26929497718811
Epoch: 8, Steps: 18 | Train Loss: 0.861 Vali Loss: 2.069 Vali Acc: 0.540 Test Loss: 2.069 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.4886322021484375
Epoch: 9, Steps: 18 | Train Loss: 0.275 Vali Loss: 3.111 Vali Acc: 0.490 Test Loss: 3.111 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.328615427017212
Epoch: 10, Steps: 18 | Train Loss: 0.661 Vali Loss: 2.273 Vali Acc: 0.540 Test Loss: 2.273 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.529867649078369
Epoch: 11, Steps: 18 | Train Loss: 0.666 Vali Loss: 2.697 Vali Acc: 0.530 Test Loss: 2.697 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.676092863082886
Epoch: 12, Steps: 18 | Train Loss: 0.199 Vali Loss: 2.747 Vali Acc: 0.510 Test Loss: 2.747 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 661570
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.995002031326294
Epoch: 1, Steps: 18 | Train Loss: 0.822 Vali Loss: 0.698 Vali Acc: 0.550 Test Loss: 0.698 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 5.625426530838013
Epoch: 2, Steps: 18 | Train Loss: 0.632 Vali Loss: 1.032 Vali Acc: 0.500 Test Loss: 1.032 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.830716848373413
Epoch: 3, Steps: 18 | Train Loss: 0.485 Vali Loss: 0.990 Vali Acc: 0.530 Test Loss: 0.990 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.75061297416687
Epoch: 4, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.717 Vali Acc: 0.530 Test Loss: 1.717 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.713421106338501
Epoch: 5, Steps: 18 | Train Loss: 0.414 Vali Loss: 1.679 Vali Acc: 0.490 Test Loss: 1.679 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.554720163345337
Epoch: 6, Steps: 18 | Train Loss: 0.392 Vali Loss: 2.463 Vali Acc: 0.500 Test Loss: 2.463 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.815134048461914
Epoch: 7, Steps: 18 | Train Loss: 0.404 Vali Loss: 2.531 Vali Acc: 0.520 Test Loss: 2.531 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.908247232437134
Epoch: 8, Steps: 18 | Train Loss: 0.183 Vali Loss: 1.937 Vali Acc: 0.550 Test Loss: 1.937 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.226536273956299
Epoch: 9, Steps: 18 | Train Loss: 0.271 Vali Loss: 2.716 Vali Acc: 0.550 Test Loss: 2.716 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.958028316497803
Epoch: 10, Steps: 18 | Train Loss: 0.089 Vali Loss: 3.043 Vali Acc: 0.530 Test Loss: 3.043 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.856201887130737
Epoch: 11, Steps: 18 | Train Loss: 0.162 Vali Loss: 3.072 Vali Acc: 0.540 Test Loss: 3.072 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 661570
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.676449537277222
Epoch: 1, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.680 Vali Acc: 0.580 Test Loss: 0.680 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 6.008172988891602
Epoch: 2, Steps: 18 | Train Loss: 0.597 Vali Loss: 1.115 Vali Acc: 0.490 Test Loss: 1.115 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.920376300811768
Epoch: 3, Steps: 18 | Train Loss: 0.464 Vali Loss: 1.161 Vali Acc: 0.470 Test Loss: 1.161 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.554986476898193
Epoch: 4, Steps: 18 | Train Loss: 0.376 Vali Loss: 2.091 Vali Acc: 0.500 Test Loss: 2.091 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.869276762008667
Epoch: 5, Steps: 18 | Train Loss: 0.474 Vali Loss: 1.394 Vali Acc: 0.530 Test Loss: 1.394 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.123448371887207
Epoch: 6, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.385 Vali Acc: 0.520 Test Loss: 1.385 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.702481508255005
Epoch: 7, Steps: 18 | Train Loss: 0.404 Vali Loss: 1.801 Vali Acc: 0.630 Test Loss: 1.801 Test Acc: 0.630
Validation loss decreased (-0.579993 --> -0.629982).  Saving model ...
Epoch: 8 cost time: 5.641091585159302
Epoch: 8, Steps: 18 | Train Loss: 0.279 Vali Loss: 2.011 Vali Acc: 0.480 Test Loss: 2.011 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.646753787994385
Epoch: 9, Steps: 18 | Train Loss: 0.230 Vali Loss: 2.011 Vali Acc: 0.490 Test Loss: 2.011 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.0583086013793945
Epoch: 10, Steps: 18 | Train Loss: 0.240 Vali Loss: 2.086 Vali Acc: 0.590 Test Loss: 2.086 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.037291526794434
Epoch: 11, Steps: 18 | Train Loss: 0.144 Vali Loss: 3.222 Vali Acc: 0.470 Test Loss: 3.222 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.786210775375366
Epoch: 12, Steps: 18 | Train Loss: 0.693 Vali Loss: 3.902 Vali Acc: 0.510 Test Loss: 3.902 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.828734397888184
Epoch: 13, Steps: 18 | Train Loss: 0.093 Vali Loss: 4.787 Vali Acc: 0.500 Test Loss: 4.787 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.917451620101929
Epoch: 14, Steps: 18 | Train Loss: 0.596 Vali Loss: 4.432 Vali Acc: 0.580 Test Loss: 4.432 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.029830694198608
Epoch: 15, Steps: 18 | Train Loss: 0.120 Vali Loss: 2.817 Vali Acc: 0.500 Test Loss: 2.817 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.685356616973877
Epoch: 16, Steps: 18 | Train Loss: 0.162 Vali Loss: 2.902 Vali Acc: 0.580 Test Loss: 2.902 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.571142911911011
Epoch: 17, Steps: 18 | Train Loss: 0.133 Vali Loss: 5.074 Vali Acc: 0.610 Test Loss: 5.074 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 661570
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.9862823486328125
Epoch: 1, Steps: 18 | Train Loss: 0.822 Vali Loss: 0.874 Vali Acc: 0.470 Test Loss: 0.874 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 6.0519700050354
Epoch: 2, Steps: 18 | Train Loss: 0.660 Vali Loss: 1.004 Vali Acc: 0.500 Test Loss: 1.004 Test Acc: 0.500
Validation loss decreased (-0.469991 --> -0.499990).  Saving model ...
Epoch: 3 cost time: 6.2415900230407715
Epoch: 3, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.975 Vali Acc: 0.610 Test Loss: 0.975 Test Acc: 0.610
Validation loss decreased (-0.499990 --> -0.609990).  Saving model ...
Epoch: 4 cost time: 5.721611022949219
Epoch: 4, Steps: 18 | Train Loss: 0.394 Vali Loss: 1.226 Vali Acc: 0.500 Test Loss: 1.226 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.58713173866272
Epoch: 5, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.754 Vali Acc: 0.400 Test Loss: 1.754 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.601872444152832
Epoch: 6, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.876 Vali Acc: 0.480 Test Loss: 1.876 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.962356090545654
Epoch: 7, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.092 Vali Acc: 0.440 Test Loss: 1.092 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.367933750152588
Epoch: 8, Steps: 18 | Train Loss: 0.262 Vali Loss: 2.270 Vali Acc: 0.450 Test Loss: 2.270 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.670961618423462
Epoch: 9, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.206 Vali Acc: 0.470 Test Loss: 1.206 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.909611463546753
Epoch: 10, Steps: 18 | Train Loss: 0.755 Vali Loss: 5.460 Vali Acc: 0.510 Test Loss: 5.460 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.822922706604004
Epoch: 11, Steps: 18 | Train Loss: 0.512 Vali Loss: 4.310 Vali Acc: 0.530 Test Loss: 4.310 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.611248254776001
Epoch: 12, Steps: 18 | Train Loss: 0.300 Vali Loss: 1.667 Vali Acc: 0.500 Test Loss: 1.667 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.312729358673096
Epoch: 13, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.605 Vali Acc: 0.530 Test Loss: 1.605 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 661570
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.73566198348999
Epoch: 1, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.701 Vali Acc: 0.510 Test Loss: 0.701 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 5.447588682174683
Epoch: 2, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.343942403793335
Epoch: 3, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.946 Vali Acc: 0.500 Test Loss: 0.946 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.52782130241394
Epoch: 4, Steps: 18 | Train Loss: 0.562 Vali Loss: 1.647 Vali Acc: 0.500 Test Loss: 1.647 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.772037744522095
Epoch: 5, Steps: 18 | Train Loss: 0.767 Vali Loss: 1.372 Vali Acc: 0.500 Test Loss: 1.372 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.8790342807769775
Epoch: 6, Steps: 18 | Train Loss: 0.487 Vali Loss: 0.745 Vali Acc: 0.550 Test Loss: 0.745 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 5.83064079284668
Epoch: 7, Steps: 18 | Train Loss: 0.350 Vali Loss: 2.166 Vali Acc: 0.500 Test Loss: 2.166 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.757695913314819
Epoch: 8, Steps: 18 | Train Loss: 0.487 Vali Loss: 0.913 Vali Acc: 0.540 Test Loss: 0.913 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.8374621868133545
Epoch: 9, Steps: 18 | Train Loss: 0.278 Vali Loss: 2.855 Vali Acc: 0.500 Test Loss: 2.855 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.158764600753784
Epoch: 10, Steps: 18 | Train Loss: 0.352 Vali Loss: 2.453 Vali Acc: 0.500 Test Loss: 2.453 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.720781326293945
Epoch: 11, Steps: 18 | Train Loss: 0.549 Vali Loss: 1.505 Vali Acc: 0.530 Test Loss: 1.505 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.82651162147522
Epoch: 12, Steps: 18 | Train Loss: 0.144 Vali Loss: 2.872 Vali Acc: 0.500 Test Loss: 2.872 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.780473947525024
Epoch: 13, Steps: 18 | Train Loss: 0.142 Vali Loss: 1.436 Vali Acc: 0.550 Test Loss: 1.436 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.718383550643921
Epoch: 14, Steps: 18 | Train Loss: 0.109 Vali Loss: 2.583 Vali Acc: 0.540 Test Loss: 2.583 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.678671360015869
Epoch: 15, Steps: 18 | Train Loss: 0.118 Vali Loss: 3.765 Vali Acc: 0.520 Test Loss: 3.765 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.946136713027954
Epoch: 16, Steps: 18 | Train Loss: 0.129 Vali Loss: 2.340 Vali Acc: 0.530 Test Loss: 2.340 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 661570
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.300413370132446
Epoch: 1, Steps: 18 | Train Loss: 0.900 Vali Loss: 1.068 Vali Acc: 0.500 Test Loss: 1.068 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 11.974371671676636
Epoch: 2, Steps: 18 | Train Loss: 0.719 Vali Loss: 1.524 Vali Acc: 0.520 Test Loss: 1.524 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519985).  Saving model ...
Epoch: 3 cost time: 11.492870330810547
Epoch: 3, Steps: 18 | Train Loss: 0.854 Vali Loss: 1.961 Vali Acc: 0.510 Test Loss: 1.961 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.696268796920776
Epoch: 4, Steps: 18 | Train Loss: 0.625 Vali Loss: 1.231 Vali Acc: 0.530 Test Loss: 1.231 Test Acc: 0.530
Validation loss decreased (-0.519985 --> -0.529988).  Saving model ...
Epoch: 5 cost time: 11.48659348487854
Epoch: 5, Steps: 18 | Train Loss: 0.492 Vali Loss: 1.270 Vali Acc: 0.570 Test Loss: 1.270 Test Acc: 0.570
Validation loss decreased (-0.529988 --> -0.569987).  Saving model ...
Epoch: 6 cost time: 10.377689599990845
Epoch: 6, Steps: 18 | Train Loss: 0.382 Vali Loss: 4.847 Vali Acc: 0.510 Test Loss: 4.847 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.146512508392334
Epoch: 7, Steps: 18 | Train Loss: 0.482 Vali Loss: 1.429 Vali Acc: 0.580 Test Loss: 1.429 Test Acc: 0.580
Validation loss decreased (-0.569987 --> -0.579986).  Saving model ...
Epoch: 8 cost time: 11.91092824935913
Epoch: 8, Steps: 18 | Train Loss: 0.309 Vali Loss: 3.832 Vali Acc: 0.520 Test Loss: 3.832 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.586092472076416
Epoch: 9, Steps: 18 | Train Loss: 0.496 Vali Loss: 2.596 Vali Acc: 0.560 Test Loss: 2.596 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.858337879180908
Epoch: 10, Steps: 18 | Train Loss: 0.399 Vali Loss: 3.475 Vali Acc: 0.560 Test Loss: 3.475 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.324049234390259
Epoch: 11, Steps: 18 | Train Loss: 0.229 Vali Loss: 3.257 Vali Acc: 0.610 Test Loss: 3.257 Test Acc: 0.610
Validation loss decreased (-0.579986 --> -0.609967).  Saving model ...
Epoch: 12 cost time: 12.054891347885132
Epoch: 12, Steps: 18 | Train Loss: 0.312 Vali Loss: 4.100 Vali Acc: 0.540 Test Loss: 4.100 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.78459906578064
Epoch: 13, Steps: 18 | Train Loss: 0.345 Vali Loss: 2.380 Vali Acc: 0.550 Test Loss: 2.380 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.44464659690857
Epoch: 14, Steps: 18 | Train Loss: 0.399 Vali Loss: 4.340 Vali Acc: 0.550 Test Loss: 4.340 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.169666290283203
Epoch: 15, Steps: 18 | Train Loss: 0.233 Vali Loss: 2.672 Vali Acc: 0.550 Test Loss: 2.672 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.730679750442505
Epoch: 16, Steps: 18 | Train Loss: 0.205 Vali Loss: 4.182 Vali Acc: 0.520 Test Loss: 4.182 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.559288501739502
Epoch: 17, Steps: 18 | Train Loss: 0.250 Vali Loss: 3.998 Vali Acc: 0.550 Test Loss: 3.998 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.36708927154541
Epoch: 18, Steps: 18 | Train Loss: 0.569 Vali Loss: 5.929 Vali Acc: 0.510 Test Loss: 5.929 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 12.164592742919922
Epoch: 19, Steps: 18 | Train Loss: 1.431 Vali Loss: 4.584 Vali Acc: 0.480 Test Loss: 4.584 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.889803409576416
Epoch: 20, Steps: 18 | Train Loss: 0.381 Vali Loss: 5.115 Vali Acc: 0.520 Test Loss: 5.115 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.660589218139648
Epoch: 21, Steps: 18 | Train Loss: 0.683 Vali Loss: 3.498 Vali Acc: 0.560 Test Loss: 3.498 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 612418
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.22262167930603
Epoch: 1, Steps: 18 | Train Loss: 0.898 Vali Loss: 0.889 Vali Acc: 0.510 Test Loss: 0.889 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 9.577484607696533
Epoch: 2, Steps: 18 | Train Loss: 0.721 Vali Loss: 1.510 Vali Acc: 0.510 Test Loss: 1.510 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.59987998008728
Epoch: 3, Steps: 18 | Train Loss: 0.824 Vali Loss: 1.753 Vali Acc: 0.500 Test Loss: 1.753 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.430896520614624
Epoch: 4, Steps: 18 | Train Loss: 0.769 Vali Loss: 1.409 Vali Acc: 0.550 Test Loss: 1.409 Test Acc: 0.550
Validation loss decreased (-0.509991 --> -0.549986).  Saving model ...
Epoch: 5 cost time: 10.145843029022217
Epoch: 5, Steps: 18 | Train Loss: 0.523 Vali Loss: 1.268 Vali Acc: 0.540 Test Loss: 1.268 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.338003873825073
Epoch: 6, Steps: 18 | Train Loss: 0.409 Vali Loss: 2.109 Vali Acc: 0.530 Test Loss: 2.109 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.988869667053223
Epoch: 7, Steps: 18 | Train Loss: 0.566 Vali Loss: 2.245 Vali Acc: 0.500 Test Loss: 2.245 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.83821439743042
Epoch: 8, Steps: 18 | Train Loss: 0.694 Vali Loss: 2.074 Vali Acc: 0.580 Test Loss: 2.074 Test Acc: 0.580
Validation loss decreased (-0.549986 --> -0.579979).  Saving model ...
Epoch: 9 cost time: 10.794713973999023
Epoch: 9, Steps: 18 | Train Loss: 0.601 Vali Loss: 3.006 Vali Acc: 0.550 Test Loss: 3.006 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.461313724517822
Epoch: 10, Steps: 18 | Train Loss: 0.633 Vali Loss: 2.896 Vali Acc: 0.510 Test Loss: 2.896 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.815240144729614
Epoch: 11, Steps: 18 | Train Loss: 0.303 Vali Loss: 3.576 Vali Acc: 0.530 Test Loss: 3.576 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.196235656738281
Epoch: 12, Steps: 18 | Train Loss: 0.466 Vali Loss: 5.873 Vali Acc: 0.500 Test Loss: 5.873 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.671632528305054
Epoch: 13, Steps: 18 | Train Loss: 0.528 Vali Loss: 2.227 Vali Acc: 0.590 Test Loss: 2.227 Test Acc: 0.590
Validation loss decreased (-0.579979 --> -0.589978).  Saving model ...
Epoch: 14 cost time: 9.50993800163269
Epoch: 14, Steps: 18 | Train Loss: 0.273 Vali Loss: 4.620 Vali Acc: 0.510 Test Loss: 4.620 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.741303443908691
Epoch: 15, Steps: 18 | Train Loss: 0.592 Vali Loss: 6.197 Vali Acc: 0.520 Test Loss: 6.197 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.642320394515991
Epoch: 16, Steps: 18 | Train Loss: 0.879 Vali Loss: 3.142 Vali Acc: 0.550 Test Loss: 3.142 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.391483783721924
Epoch: 17, Steps: 18 | Train Loss: 0.146 Vali Loss: 3.036 Vali Acc: 0.600 Test Loss: 3.036 Test Acc: 0.600
Validation loss decreased (-0.589978 --> -0.599970).  Saving model ...
Epoch: 18 cost time: 9.943160057067871
Epoch: 18, Steps: 18 | Train Loss: 0.087 Vali Loss: 2.979 Vali Acc: 0.540 Test Loss: 2.979 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.432796001434326
Epoch: 19, Steps: 18 | Train Loss: 0.120 Vali Loss: 10.575 Vali Acc: 0.500 Test Loss: 10.575 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 10.201906442642212
Epoch: 20, Steps: 18 | Train Loss: 0.124 Vali Loss: 5.406 Vali Acc: 0.530 Test Loss: 5.406 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.02729058265686
Epoch: 21, Steps: 18 | Train Loss: 0.141 Vali Loss: 5.438 Vali Acc: 0.530 Test Loss: 5.438 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 10.042766094207764
Epoch: 22, Steps: 18 | Train Loss: 0.425 Vali Loss: 4.995 Vali Acc: 0.490 Test Loss: 4.995 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 9.624217510223389
Epoch: 23, Steps: 18 | Train Loss: 0.336 Vali Loss: 6.151 Vali Acc: 0.550 Test Loss: 6.151 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 9.304556369781494
Epoch: 24, Steps: 18 | Train Loss: 0.348 Vali Loss: 7.189 Vali Acc: 0.550 Test Loss: 7.189 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 9.98973560333252
Epoch: 25, Steps: 18 | Train Loss: 0.174 Vali Loss: 8.119 Vali Acc: 0.530 Test Loss: 8.119 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 10.51567006111145
Epoch: 26, Steps: 18 | Train Loss: 0.081 Vali Loss: 9.094 Vali Acc: 0.490 Test Loss: 9.094 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 9.870103120803833
Epoch: 27, Steps: 18 | Train Loss: 0.080 Vali Loss: 6.553 Vali Acc: 0.520 Test Loss: 6.553 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 612418
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.160094261169434
Epoch: 1, Steps: 18 | Train Loss: 0.883 Vali Loss: 0.758 Vali Acc: 0.460 Test Loss: 0.758 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 8.622410535812378
Epoch: 2, Steps: 18 | Train Loss: 0.633 Vali Loss: 1.035 Vali Acc: 0.560 Test Loss: 1.035 Test Acc: 0.560
Validation loss decreased (-0.459992 --> -0.559990).  Saving model ...
Epoch: 3 cost time: 9.024627923965454
Epoch: 3, Steps: 18 | Train Loss: 0.560 Vali Loss: 0.989 Vali Acc: 0.540 Test Loss: 0.989 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.24571442604065
Epoch: 4, Steps: 18 | Train Loss: 0.665 Vali Loss: 1.011 Vali Acc: 0.620 Test Loss: 1.011 Test Acc: 0.620
Validation loss decreased (-0.559990 --> -0.619990).  Saving model ...
Epoch: 5 cost time: 7.942873477935791
Epoch: 5, Steps: 18 | Train Loss: 0.470 Vali Loss: 1.032 Vali Acc: 0.550 Test Loss: 1.032 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.277223110198975
Epoch: 6, Steps: 18 | Train Loss: 0.461 Vali Loss: 3.455 Vali Acc: 0.500 Test Loss: 3.455 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.382227182388306
Epoch: 7, Steps: 18 | Train Loss: 0.465 Vali Loss: 1.833 Vali Acc: 0.560 Test Loss: 1.833 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.701228618621826
Epoch: 8, Steps: 18 | Train Loss: 0.483 Vali Loss: 2.295 Vali Acc: 0.540 Test Loss: 2.295 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.281939029693604
Epoch: 9, Steps: 18 | Train Loss: 0.404 Vali Loss: 4.658 Vali Acc: 0.510 Test Loss: 4.658 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.128844499588013
Epoch: 10, Steps: 18 | Train Loss: 0.428 Vali Loss: 6.796 Vali Acc: 0.500 Test Loss: 6.796 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.900996446609497
Epoch: 11, Steps: 18 | Train Loss: 0.370 Vali Loss: 2.180 Vali Acc: 0.530 Test Loss: 2.180 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.700241088867188
Epoch: 12, Steps: 18 | Train Loss: 0.255 Vali Loss: 2.536 Vali Acc: 0.530 Test Loss: 2.536 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.626336097717285
Epoch: 13, Steps: 18 | Train Loss: 0.290 Vali Loss: 2.486 Vali Acc: 0.600 Test Loss: 2.486 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.157013416290283
Epoch: 14, Steps: 18 | Train Loss: 0.146 Vali Loss: 2.902 Vali Acc: 0.500 Test Loss: 2.902 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 612418
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.234757423400879
Epoch: 1, Steps: 18 | Train Loss: 0.885 Vali Loss: 0.885 Vali Acc: 0.490 Test Loss: 0.885 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 7.38032078742981
Epoch: 2, Steps: 18 | Train Loss: 0.613 Vali Loss: 0.809 Vali Acc: 0.550 Test Loss: 0.809 Test Acc: 0.550
Validation loss decreased (-0.489991 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 7.218438625335693
Epoch: 3, Steps: 18 | Train Loss: 0.578 Vali Loss: 1.047 Vali Acc: 0.520 Test Loss: 1.047 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.429489374160767
Epoch: 4, Steps: 18 | Train Loss: 0.499 Vali Loss: 1.196 Vali Acc: 0.520 Test Loss: 1.196 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.704898834228516
Epoch: 5, Steps: 18 | Train Loss: 0.534 Vali Loss: 2.498 Vali Acc: 0.510 Test Loss: 2.498 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.494100093841553
Epoch: 6, Steps: 18 | Train Loss: 0.274 Vali Loss: 1.976 Vali Acc: 0.570 Test Loss: 1.976 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569980).  Saving model ...
Epoch: 7 cost time: 7.561298847198486
Epoch: 7, Steps: 18 | Train Loss: 0.394 Vali Loss: 2.014 Vali Acc: 0.480 Test Loss: 2.014 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.401679754257202
Epoch: 8, Steps: 18 | Train Loss: 0.275 Vali Loss: 2.546 Vali Acc: 0.530 Test Loss: 2.546 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.226814270019531
Epoch: 9, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.742 Vali Acc: 0.570 Test Loss: 1.742 Test Acc: 0.570
Validation loss decreased (-0.569980 --> -0.569983).  Saving model ...
Epoch: 10 cost time: 7.4563822746276855
Epoch: 10, Steps: 18 | Train Loss: 0.231 Vali Loss: 2.347 Vali Acc: 0.580 Test Loss: 2.347 Test Acc: 0.580
Validation loss decreased (-0.569983 --> -0.579977).  Saving model ...
Epoch: 11 cost time: 7.508004903793335
Epoch: 11, Steps: 18 | Train Loss: 0.964 Vali Loss: 2.284 Vali Acc: 0.560 Test Loss: 2.284 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.954148054122925
Epoch: 12, Steps: 18 | Train Loss: 0.229 Vali Loss: 4.556 Vali Acc: 0.470 Test Loss: 4.556 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.138371706008911
Epoch: 13, Steps: 18 | Train Loss: 0.099 Vali Loss: 2.506 Vali Acc: 0.580 Test Loss: 2.506 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.084315776824951
Epoch: 14, Steps: 18 | Train Loss: 0.171 Vali Loss: 4.457 Vali Acc: 0.520 Test Loss: 4.457 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.184460639953613
Epoch: 15, Steps: 18 | Train Loss: 0.488 Vali Loss: 6.555 Vali Acc: 0.500 Test Loss: 6.555 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.028783082962036
Epoch: 16, Steps: 18 | Train Loss: 0.534 Vali Loss: 3.855 Vali Acc: 0.530 Test Loss: 3.855 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.417952060699463
Epoch: 17, Steps: 18 | Train Loss: 0.114 Vali Loss: 3.101 Vali Acc: 0.600 Test Loss: 3.101 Test Acc: 0.600
Validation loss decreased (-0.579977 --> -0.599969).  Saving model ...
Epoch: 18 cost time: 7.356428861618042
Epoch: 18, Steps: 18 | Train Loss: 0.319 Vali Loss: 4.737 Vali Acc: 0.530 Test Loss: 4.737 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.712806463241577
Epoch: 19, Steps: 18 | Train Loss: 0.204 Vali Loss: 4.997 Vali Acc: 0.480 Test Loss: 4.997 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.381031036376953
Epoch: 20, Steps: 18 | Train Loss: 0.336 Vali Loss: 5.910 Vali Acc: 0.520 Test Loss: 5.910 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.179468870162964
Epoch: 21, Steps: 18 | Train Loss: 0.061 Vali Loss: 5.099 Vali Acc: 0.550 Test Loss: 5.099 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.579308271408081
Epoch: 22, Steps: 18 | Train Loss: 0.190 Vali Loss: 4.541 Vali Acc: 0.630 Test Loss: 4.541 Test Acc: 0.630
Validation loss decreased (-0.599969 --> -0.629955).  Saving model ...
Epoch: 23 cost time: 7.532380819320679
Epoch: 23, Steps: 18 | Train Loss: 0.321 Vali Loss: 4.525 Vali Acc: 0.610 Test Loss: 4.525 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.994971752166748
Epoch: 24, Steps: 18 | Train Loss: 0.119 Vali Loss: 7.596 Vali Acc: 0.500 Test Loss: 7.596 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.318337917327881
Epoch: 25, Steps: 18 | Train Loss: 0.139 Vali Loss: 4.798 Vali Acc: 0.520 Test Loss: 4.798 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.0432398319244385
Epoch: 26, Steps: 18 | Train Loss: 0.068 Vali Loss: 15.833 Vali Acc: 0.520 Test Loss: 15.833 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.154465436935425
Epoch: 27, Steps: 18 | Train Loss: 0.318 Vali Loss: 5.028 Vali Acc: 0.550 Test Loss: 5.028 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.948941230773926
Epoch: 28, Steps: 18 | Train Loss: 0.434 Vali Loss: 7.759 Vali Acc: 0.500 Test Loss: 7.759 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.169996976852417
Epoch: 29, Steps: 18 | Train Loss: 0.434 Vali Loss: 8.001 Vali Acc: 0.560 Test Loss: 8.001 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.629025459289551
Epoch: 30, Steps: 18 | Train Loss: 0.263 Vali Loss: 9.623 Vali Acc: 0.550 Test Loss: 9.623 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 7.876373529434204
Epoch: 31, Steps: 18 | Train Loss: 0.305 Vali Loss: 8.605 Vali Acc: 0.500 Test Loss: 8.605 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 7.476954460144043
Epoch: 32, Steps: 18 | Train Loss: 0.398 Vali Loss: 9.006 Vali Acc: 0.560 Test Loss: 9.006 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 612418
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.823583364486694
Epoch: 1, Steps: 18 | Train Loss: 0.890 Vali Loss: 0.909 Vali Acc: 0.490 Test Loss: 0.909 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 6.743133306503296
Epoch: 2, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.987 Vali Acc: 0.510 Test Loss: 0.987 Test Acc: 0.510
Validation loss decreased (-0.489991 --> -0.509990).  Saving model ...
Epoch: 3 cost time: 6.1619744300842285
Epoch: 3, Steps: 18 | Train Loss: 0.670 Vali Loss: 0.887 Vali Acc: 0.600 Test Loss: 0.887 Test Acc: 0.600
Validation loss decreased (-0.509990 --> -0.599991).  Saving model ...
Epoch: 4 cost time: 6.068809747695923
Epoch: 4, Steps: 18 | Train Loss: 0.430 Vali Loss: 2.206 Vali Acc: 0.490 Test Loss: 2.206 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.949889183044434
Epoch: 5, Steps: 18 | Train Loss: 0.238 Vali Loss: 1.759 Vali Acc: 0.480 Test Loss: 1.759 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.928251504898071
Epoch: 6, Steps: 18 | Train Loss: 0.485 Vali Loss: 1.799 Vali Acc: 0.490 Test Loss: 1.799 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.310919523239136
Epoch: 7, Steps: 18 | Train Loss: 0.343 Vali Loss: 1.772 Vali Acc: 0.510 Test Loss: 1.772 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.041988372802734
Epoch: 8, Steps: 18 | Train Loss: 0.330 Vali Loss: 2.140 Vali Acc: 0.590 Test Loss: 2.140 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.0965611934661865
Epoch: 9, Steps: 18 | Train Loss: 0.423 Vali Loss: 2.869 Vali Acc: 0.550 Test Loss: 2.869 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.05633020401001
Epoch: 10, Steps: 18 | Train Loss: 0.193 Vali Loss: 3.243 Vali Acc: 0.530 Test Loss: 3.243 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.0705437660217285
Epoch: 11, Steps: 18 | Train Loss: 0.128 Vali Loss: 2.830 Vali Acc: 0.570 Test Loss: 2.830 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.908564329147339
Epoch: 12, Steps: 18 | Train Loss: 0.061 Vali Loss: 3.005 Vali Acc: 0.530 Test Loss: 3.005 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.245927572250366
Epoch: 13, Steps: 18 | Train Loss: 0.119 Vali Loss: 5.746 Vali Acc: 0.520 Test Loss: 5.746 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 612418
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.046451568603516
Epoch: 1, Steps: 18 | Train Loss: 0.877 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 5.61339545249939
Epoch: 2, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.957 Vali Acc: 0.520 Test Loss: 0.957 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519990).  Saving model ...
Epoch: 3 cost time: 5.96582555770874
Epoch: 3, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.877 Vali Acc: 0.510 Test Loss: 0.877 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.786051034927368
Epoch: 4, Steps: 18 | Train Loss: 0.355 Vali Loss: 2.499 Vali Acc: 0.510 Test Loss: 2.499 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.6691575050354
Epoch: 5, Steps: 18 | Train Loss: 0.417 Vali Loss: 1.175 Vali Acc: 0.510 Test Loss: 1.175 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.588667869567871
Epoch: 6, Steps: 18 | Train Loss: 0.277 Vali Loss: 3.304 Vali Acc: 0.500 Test Loss: 3.304 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.789319276809692
Epoch: 7, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.571 Vali Acc: 0.480 Test Loss: 1.571 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.717251777648926
Epoch: 8, Steps: 18 | Train Loss: 0.301 Vali Loss: 3.168 Vali Acc: 0.500 Test Loss: 3.168 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.947994709014893
Epoch: 9, Steps: 18 | Train Loss: 0.145 Vali Loss: 2.559 Vali Acc: 0.510 Test Loss: 2.559 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.029140949249268
Epoch: 10, Steps: 18 | Train Loss: 0.289 Vali Loss: 2.905 Vali Acc: 0.570 Test Loss: 2.905 Test Acc: 0.570
Validation loss decreased (-0.519990 --> -0.569971).  Saving model ...
Epoch: 11 cost time: 5.923640966415405
Epoch: 11, Steps: 18 | Train Loss: 0.197 Vali Loss: 3.011 Vali Acc: 0.490 Test Loss: 3.011 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.829652786254883
Epoch: 12, Steps: 18 | Train Loss: 0.406 Vali Loss: 2.177 Vali Acc: 0.480 Test Loss: 2.177 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.243756055831909
Epoch: 13, Steps: 18 | Train Loss: 0.498 Vali Loss: 3.339 Vali Acc: 0.530 Test Loss: 3.339 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.991666078567505
Epoch: 14, Steps: 18 | Train Loss: 0.136 Vali Loss: 2.883 Vali Acc: 0.480 Test Loss: 2.883 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.926729202270508
Epoch: 15, Steps: 18 | Train Loss: 0.085 Vali Loss: 6.472 Vali Acc: 0.550 Test Loss: 6.472 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.6227662563323975
Epoch: 16, Steps: 18 | Train Loss: 0.225 Vali Loss: 3.476 Vali Acc: 0.540 Test Loss: 3.476 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.794675350189209
Epoch: 17, Steps: 18 | Train Loss: 0.346 Vali Loss: 8.875 Vali Acc: 0.530 Test Loss: 8.875 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.312259197235107
Epoch: 18, Steps: 18 | Train Loss: 0.241 Vali Loss: 3.713 Vali Acc: 0.500 Test Loss: 3.713 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.681826114654541
Epoch: 19, Steps: 18 | Train Loss: 0.317 Vali Loss: 3.750 Vali Acc: 0.500 Test Loss: 3.750 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.726422071456909
Epoch: 20, Steps: 18 | Train Loss: 0.087 Vali Loss: 7.393 Vali Acc: 0.540 Test Loss: 7.393 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 612418
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.747013330459595
Epoch: 1, Steps: 18 | Train Loss: 0.835 Vali Loss: 0.682 Vali Acc: 0.550 Test Loss: 0.682 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 6.2425525188446045
Epoch: 2, Steps: 18 | Train Loss: 0.557 Vali Loss: 0.828 Vali Acc: 0.540 Test Loss: 0.828 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.21029806137085
Epoch: 3, Steps: 18 | Train Loss: 0.716 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.882887363433838
Epoch: 4, Steps: 18 | Train Loss: 0.446 Vali Loss: 1.804 Vali Acc: 0.500 Test Loss: 1.804 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.597785949707031
Epoch: 5, Steps: 18 | Train Loss: 0.319 Vali Loss: 1.258 Vali Acc: 0.600 Test Loss: 1.258 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 5.798274755477905
Epoch: 6, Steps: 18 | Train Loss: 0.286 Vali Loss: 1.836 Vali Acc: 0.520 Test Loss: 1.836 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.935727596282959
Epoch: 7, Steps: 18 | Train Loss: 0.339 Vali Loss: 1.797 Vali Acc: 0.550 Test Loss: 1.797 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.423523187637329
Epoch: 8, Steps: 18 | Train Loss: 0.696 Vali Loss: 3.638 Vali Acc: 0.520 Test Loss: 3.638 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.610782146453857
Epoch: 9, Steps: 18 | Train Loss: 0.251 Vali Loss: 2.278 Vali Acc: 0.590 Test Loss: 2.278 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.5260138511657715
Epoch: 10, Steps: 18 | Train Loss: 0.189 Vali Loss: 2.597 Vali Acc: 0.550 Test Loss: 2.597 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.127851247787476
Epoch: 11, Steps: 18 | Train Loss: 0.209 Vali Loss: 2.868 Vali Acc: 0.550 Test Loss: 2.868 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.070132255554199
Epoch: 12, Steps: 18 | Train Loss: 0.104 Vali Loss: 2.351 Vali Acc: 0.530 Test Loss: 2.351 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.593828201293945
Epoch: 13, Steps: 18 | Train Loss: 0.090 Vali Loss: 3.336 Vali Acc: 0.550 Test Loss: 3.336 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.560567140579224
Epoch: 14, Steps: 18 | Train Loss: 0.275 Vali Loss: 4.012 Vali Acc: 0.550 Test Loss: 4.012 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.507274627685547
Epoch: 15, Steps: 18 | Train Loss: 0.269 Vali Loss: 4.295 Vali Acc: 0.500 Test Loss: 4.295 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 612418
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.539718151092529
Epoch: 1, Steps: 18 | Train Loss: 0.855 Vali Loss: 0.659 Vali Acc: 0.550 Test Loss: 0.659 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 6.000450372695923
Epoch: 2, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.914 Vali Acc: 0.560 Test Loss: 0.914 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559991).  Saving model ...
Epoch: 3 cost time: 5.811310052871704
Epoch: 3, Steps: 18 | Train Loss: 0.495 Vali Loss: 0.882 Vali Acc: 0.590 Test Loss: 0.882 Test Acc: 0.590
Validation loss decreased (-0.559991 --> -0.589991).  Saving model ...
Epoch: 4 cost time: 6.11899209022522
Epoch: 4, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.533 Vali Acc: 0.490 Test Loss: 1.533 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.775287866592407
Epoch: 5, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.634 Vali Acc: 0.520 Test Loss: 1.634 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.303865909576416
Epoch: 6, Steps: 18 | Train Loss: 0.363 Vali Loss: 1.207 Vali Acc: 0.570 Test Loss: 1.207 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.68662428855896
Epoch: 7, Steps: 18 | Train Loss: 0.172 Vali Loss: 2.051 Vali Acc: 0.500 Test Loss: 2.051 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.051202297210693
Epoch: 8, Steps: 18 | Train Loss: 0.150 Vali Loss: 2.014 Vali Acc: 0.490 Test Loss: 2.014 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.294262409210205
Epoch: 9, Steps: 18 | Train Loss: 0.143 Vali Loss: 4.540 Vali Acc: 0.500 Test Loss: 4.540 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.050321102142334
Epoch: 10, Steps: 18 | Train Loss: 0.223 Vali Loss: 4.230 Vali Acc: 0.510 Test Loss: 4.230 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.779759883880615
Epoch: 11, Steps: 18 | Train Loss: 0.323 Vali Loss: 4.315 Vali Acc: 0.500 Test Loss: 4.315 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.968914031982422
Epoch: 12, Steps: 18 | Train Loss: 0.216 Vali Loss: 2.276 Vali Acc: 0.610 Test Loss: 2.276 Test Acc: 0.610
Validation loss decreased (-0.589991 --> -0.609977).  Saving model ...
Epoch: 13 cost time: 5.590043783187866
Epoch: 13, Steps: 18 | Train Loss: 0.171 Vali Loss: 3.171 Vali Acc: 0.580 Test Loss: 3.171 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.27421760559082
Epoch: 14, Steps: 18 | Train Loss: 0.195 Vali Loss: 4.934 Vali Acc: 0.470 Test Loss: 4.934 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.516986608505249
Epoch: 15, Steps: 18 | Train Loss: 0.244 Vali Loss: 2.875 Vali Acc: 0.590 Test Loss: 2.875 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.593694686889648
Epoch: 16, Steps: 18 | Train Loss: 0.144 Vali Loss: 3.109 Vali Acc: 0.520 Test Loss: 3.109 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.41898775100708
Epoch: 17, Steps: 18 | Train Loss: 0.211 Vali Loss: 3.320 Vali Acc: 0.600 Test Loss: 3.320 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.003389120101929
Epoch: 18, Steps: 18 | Train Loss: 0.034 Vali Loss: 3.303 Vali Acc: 0.600 Test Loss: 3.303 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.200521469116211
Epoch: 19, Steps: 18 | Train Loss: 0.061 Vali Loss: 2.953 Vali Acc: 0.590 Test Loss: 2.953 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.58685827255249
Epoch: 20, Steps: 18 | Train Loss: 0.097 Vali Loss: 8.270 Vali Acc: 0.500 Test Loss: 8.270 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.410735368728638
Epoch: 21, Steps: 18 | Train Loss: 0.312 Vali Loss: 4.442 Vali Acc: 0.540 Test Loss: 4.442 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.0403969287872314
Epoch: 22, Steps: 18 | Train Loss: 0.569 Vali Loss: 11.315 Vali Acc: 0.490 Test Loss: 11.315 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 612418
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.903519153594971
Epoch: 1, Steps: 18 | Train Loss: 0.833 Vali Loss: 0.784 Vali Acc: 0.520 Test Loss: 0.784 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 5.508704900741577
Epoch: 2, Steps: 18 | Train Loss: 0.670 Vali Loss: 0.850 Vali Acc: 0.520 Test Loss: 0.850 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.461526155471802
Epoch: 3, Steps: 18 | Train Loss: 0.689 Vali Loss: 1.774 Vali Acc: 0.440 Test Loss: 1.774 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.262283563613892
Epoch: 4, Steps: 18 | Train Loss: 0.797 Vali Loss: 1.043 Vali Acc: 0.450 Test Loss: 1.043 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.218926429748535
Epoch: 5, Steps: 18 | Train Loss: 0.442 Vali Loss: 1.229 Vali Acc: 0.460 Test Loss: 1.229 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.869617938995361
Epoch: 6, Steps: 18 | Train Loss: 0.343 Vali Loss: 1.584 Vali Acc: 0.560 Test Loss: 1.584 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559984).  Saving model ...
Epoch: 7 cost time: 5.9629433155059814
Epoch: 7, Steps: 18 | Train Loss: 0.244 Vali Loss: 2.331 Vali Acc: 0.430 Test Loss: 2.331 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.217495679855347
Epoch: 8, Steps: 18 | Train Loss: 0.290 Vali Loss: 2.723 Vali Acc: 0.490 Test Loss: 2.723 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.466235399246216
Epoch: 9, Steps: 18 | Train Loss: 0.288 Vali Loss: 1.620 Vali Acc: 0.440 Test Loss: 1.620 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.894629716873169
Epoch: 10, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.286 Vali Acc: 0.480 Test Loss: 1.286 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.406104803085327
Epoch: 11, Steps: 18 | Train Loss: 0.342 Vali Loss: 3.417 Vali Acc: 0.510 Test Loss: 3.417 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.7194273471832275
Epoch: 12, Steps: 18 | Train Loss: 0.305 Vali Loss: 3.393 Vali Acc: 0.530 Test Loss: 3.393 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.219113111495972
Epoch: 13, Steps: 18 | Train Loss: 0.264 Vali Loss: 2.437 Vali Acc: 0.500 Test Loss: 2.437 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.343860864639282
Epoch: 14, Steps: 18 | Train Loss: 0.113 Vali Loss: 1.774 Vali Acc: 0.400 Test Loss: 1.774 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.867040634155273
Epoch: 15, Steps: 18 | Train Loss: 0.247 Vali Loss: 1.628 Vali Acc: 0.530 Test Loss: 1.628 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.754287004470825
Epoch: 16, Steps: 18 | Train Loss: 0.125 Vali Loss: 4.075 Vali Acc: 0.450 Test Loss: 4.075 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 612418
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.1028501987457275
Epoch: 1, Steps: 18 | Train Loss: 0.801 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 5.38627028465271
Epoch: 2, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 5.545923709869385
Epoch: 3, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.922 Vali Acc: 0.500 Test Loss: 0.922 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.308191776275635
Epoch: 4, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.48923134803772
Epoch: 5, Steps: 18 | Train Loss: 0.444 Vali Loss: 1.437 Vali Acc: 0.500 Test Loss: 1.437 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.735652208328247
Epoch: 6, Steps: 18 | Train Loss: 0.493 Vali Loss: 1.778 Vali Acc: 0.500 Test Loss: 1.778 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.568472146987915
Epoch: 7, Steps: 18 | Train Loss: 0.394 Vali Loss: 0.949 Vali Acc: 0.480 Test Loss: 0.949 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.622707843780518
Epoch: 8, Steps: 18 | Train Loss: 0.443 Vali Loss: 2.212 Vali Acc: 0.500 Test Loss: 2.212 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.446171045303345
Epoch: 9, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.268 Vali Acc: 0.520 Test Loss: 1.268 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519987).  Saving model ...
Epoch: 10 cost time: 5.9009411334991455
Epoch: 10, Steps: 18 | Train Loss: 0.315 Vali Loss: 0.898 Vali Acc: 0.560 Test Loss: 0.898 Test Acc: 0.560
Validation loss decreased (-0.519987 --> -0.559991).  Saving model ...
Epoch: 11 cost time: 6.301161766052246
Epoch: 11, Steps: 18 | Train Loss: 0.132 Vali Loss: 1.957 Vali Acc: 0.520 Test Loss: 1.957 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.273149728775024
Epoch: 12, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.632 Vali Acc: 0.530 Test Loss: 1.632 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.061478137969971
Epoch: 13, Steps: 18 | Train Loss: 0.108 Vali Loss: 1.437 Vali Acc: 0.520 Test Loss: 1.437 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.856566905975342
Epoch: 14, Steps: 18 | Train Loss: 0.044 Vali Loss: 1.350 Vali Acc: 0.530 Test Loss: 1.350 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.138740539550781
Epoch: 15, Steps: 18 | Train Loss: 0.102 Vali Loss: 2.341 Vali Acc: 0.530 Test Loss: 2.341 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.820232629776001
Epoch: 16, Steps: 18 | Train Loss: 0.077 Vali Loss: 1.900 Vali Acc: 0.550 Test Loss: 1.900 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.163063049316406
Epoch: 17, Steps: 18 | Train Loss: 0.075 Vali Loss: 1.333 Vali Acc: 0.480 Test Loss: 1.333 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.36626935005188
Epoch: 18, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.703 Vali Acc: 0.530 Test Loss: 1.703 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.52691388130188
Epoch: 19, Steps: 18 | Train Loss: 0.088 Vali Loss: 1.698 Vali Acc: 0.480 Test Loss: 1.698 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.862996578216553
Epoch: 20, Steps: 18 | Train Loss: 0.083 Vali Loss: 3.827 Vali Acc: 0.520 Test Loss: 3.827 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 612418
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.310395002365112
Epoch: 1, Steps: 18 | Train Loss: 0.768 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 8.82919979095459
Epoch: 2, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.735 Vali Acc: 0.560 Test Loss: 0.735 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 8.384673357009888
Epoch: 3, Steps: 18 | Train Loss: 0.503 Vali Loss: 1.628 Vali Acc: 0.500 Test Loss: 1.628 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.895822048187256
Epoch: 4, Steps: 18 | Train Loss: 0.415 Vali Loss: 0.904 Vali Acc: 0.580 Test Loss: 0.904 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579991).  Saving model ...
Epoch: 5 cost time: 8.986841201782227
Epoch: 5, Steps: 18 | Train Loss: 0.396 Vali Loss: 1.881 Vali Acc: 0.520 Test Loss: 1.881 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.862224102020264
Epoch: 6, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.487 Vali Acc: 0.470 Test Loss: 1.487 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.265739917755127
Epoch: 7, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.254 Vali Acc: 0.530 Test Loss: 1.254 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.085627794265747
Epoch: 8, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.949 Vali Acc: 0.490 Test Loss: 1.949 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.034045457839966
Epoch: 9, Steps: 18 | Train Loss: 0.222 Vali Loss: 2.702 Vali Acc: 0.480 Test Loss: 2.702 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.841732501983643
Epoch: 10, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.551 Vali Acc: 0.550 Test Loss: 1.551 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.153696298599243
Epoch: 11, Steps: 18 | Train Loss: 0.253 Vali Loss: 3.186 Vali Acc: 0.540 Test Loss: 3.186 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.86107873916626
Epoch: 12, Steps: 18 | Train Loss: 0.135 Vali Loss: 3.125 Vali Acc: 0.540 Test Loss: 3.125 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.696754693984985
Epoch: 13, Steps: 18 | Train Loss: 0.180 Vali Loss: 2.511 Vali Acc: 0.460 Test Loss: 2.511 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.679478168487549
Epoch: 14, Steps: 18 | Train Loss: 0.350 Vali Loss: 2.148 Vali Acc: 0.520 Test Loss: 2.148 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 633890
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.355412006378174
Epoch: 1, Steps: 18 | Train Loss: 0.769 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 8.263144969940186
Epoch: 2, Steps: 18 | Train Loss: 0.627 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
Validation loss decreased (-0.459993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 8.447477340698242
Epoch: 3, Steps: 18 | Train Loss: 0.494 Vali Loss: 1.391 Vali Acc: 0.530 Test Loss: 1.391 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.215861082077026
Epoch: 4, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.770 Vali Acc: 0.600 Test Loss: 0.770 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599992).  Saving model ...
Epoch: 5 cost time: 8.322365522384644
Epoch: 5, Steps: 18 | Train Loss: 0.324 Vali Loss: 1.791 Vali Acc: 0.500 Test Loss: 1.791 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.499905347824097
Epoch: 6, Steps: 18 | Train Loss: 0.371 Vali Loss: 0.979 Vali Acc: 0.540 Test Loss: 0.979 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.444908380508423
Epoch: 7, Steps: 18 | Train Loss: 0.356 Vali Loss: 1.103 Vali Acc: 0.550 Test Loss: 1.103 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.252941846847534
Epoch: 8, Steps: 18 | Train Loss: 0.382 Vali Loss: 2.409 Vali Acc: 0.540 Test Loss: 2.409 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.02693796157837
Epoch: 9, Steps: 18 | Train Loss: 0.256 Vali Loss: 2.927 Vali Acc: 0.490 Test Loss: 2.927 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.315366744995117
Epoch: 10, Steps: 18 | Train Loss: 0.148 Vali Loss: 1.274 Vali Acc: 0.560 Test Loss: 1.274 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.381883144378662
Epoch: 11, Steps: 18 | Train Loss: 0.138 Vali Loss: 1.868 Vali Acc: 0.560 Test Loss: 1.868 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.8929126262664795
Epoch: 12, Steps: 18 | Train Loss: 0.171 Vali Loss: 2.129 Vali Acc: 0.530 Test Loss: 2.129 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.759788990020752
Epoch: 13, Steps: 18 | Train Loss: 0.119 Vali Loss: 1.540 Vali Acc: 0.550 Test Loss: 1.540 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.257276058197021
Epoch: 14, Steps: 18 | Train Loss: 0.109 Vali Loss: 2.988 Vali Acc: 0.520 Test Loss: 2.988 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 633890
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.930651187896729
Epoch: 1, Steps: 18 | Train Loss: 0.770 Vali Loss: 0.712 Vali Acc: 0.490 Test Loss: 0.712 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 8.096525430679321
Epoch: 2, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.885 Vali Acc: 0.550 Test Loss: 0.885 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549991).  Saving model ...
Epoch: 3 cost time: 7.813681602478027
Epoch: 3, Steps: 18 | Train Loss: 0.502 Vali Loss: 1.500 Vali Acc: 0.510 Test Loss: 1.500 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.658198118209839
Epoch: 4, Steps: 18 | Train Loss: 0.425 Vali Loss: 0.802 Vali Acc: 0.550 Test Loss: 0.802 Test Acc: 0.550
Validation loss decreased (-0.549991 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 8.188244342803955
Epoch: 5, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.174 Vali Acc: 0.590 Test Loss: 1.174 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589988).  Saving model ...
Epoch: 6 cost time: 8.079025983810425
Epoch: 6, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.116 Vali Acc: 0.540 Test Loss: 1.116 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.8445587158203125
Epoch: 7, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.521 Vali Acc: 0.560 Test Loss: 1.521 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.027245283126831
Epoch: 8, Steps: 18 | Train Loss: 0.158 Vali Loss: 2.075 Vali Acc: 0.550 Test Loss: 2.075 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.8653223514556885
Epoch: 9, Steps: 18 | Train Loss: 0.103 Vali Loss: 1.523 Vali Acc: 0.570 Test Loss: 1.523 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.147874116897583
Epoch: 10, Steps: 18 | Train Loss: 0.155 Vali Loss: 1.934 Vali Acc: 0.530 Test Loss: 1.934 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.6571362018585205
Epoch: 11, Steps: 18 | Train Loss: 0.155 Vali Loss: 2.006 Vali Acc: 0.480 Test Loss: 2.006 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.680105447769165
Epoch: 12, Steps: 18 | Train Loss: 0.086 Vali Loss: 2.730 Vali Acc: 0.500 Test Loss: 2.730 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.231786251068115
Epoch: 13, Steps: 18 | Train Loss: 0.083 Vali Loss: 2.718 Vali Acc: 0.550 Test Loss: 2.718 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.216662883758545
Epoch: 14, Steps: 18 | Train Loss: 0.175 Vali Loss: 2.692 Vali Acc: 0.530 Test Loss: 2.692 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.862254858016968
Epoch: 15, Steps: 18 | Train Loss: 0.324 Vali Loss: 3.401 Vali Acc: 0.550 Test Loss: 3.401 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 633890
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.612910509109497
Epoch: 1, Steps: 18 | Train Loss: 0.794 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 6.644726276397705
Epoch: 2, Steps: 18 | Train Loss: 0.665 Vali Loss: 1.089 Vali Acc: 0.510 Test Loss: 1.089 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509989).  Saving model ...
Epoch: 3 cost time: 6.985880136489868
Epoch: 3, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.962 Vali Acc: 0.500 Test Loss: 0.962 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.96877121925354
Epoch: 4, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.824 Vali Acc: 0.570 Test Loss: 0.824 Test Acc: 0.570
Validation loss decreased (-0.509989 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 7.235679864883423
Epoch: 5, Steps: 18 | Train Loss: 0.356 Vali Loss: 1.392 Vali Acc: 0.560 Test Loss: 1.392 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.094899415969849
Epoch: 6, Steps: 18 | Train Loss: 0.271 Vali Loss: 1.131 Vali Acc: 0.510 Test Loss: 1.131 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.935032844543457
Epoch: 7, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.316 Vali Acc: 0.510 Test Loss: 1.316 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.142775774002075
Epoch: 8, Steps: 18 | Train Loss: 0.190 Vali Loss: 2.067 Vali Acc: 0.530 Test Loss: 2.067 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.858405590057373
Epoch: 9, Steps: 18 | Train Loss: 0.137 Vali Loss: 4.091 Vali Acc: 0.510 Test Loss: 4.091 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.567660093307495
Epoch: 10, Steps: 18 | Train Loss: 0.183 Vali Loss: 1.761 Vali Acc: 0.530 Test Loss: 1.761 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.900601863861084
Epoch: 11, Steps: 18 | Train Loss: 0.072 Vali Loss: 1.881 Vali Acc: 0.530 Test Loss: 1.881 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.999663829803467
Epoch: 12, Steps: 18 | Train Loss: 0.118 Vali Loss: 2.144 Vali Acc: 0.530 Test Loss: 2.144 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.935235023498535
Epoch: 13, Steps: 18 | Train Loss: 0.207 Vali Loss: 2.021 Vali Acc: 0.520 Test Loss: 2.021 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.155167102813721
Epoch: 14, Steps: 18 | Train Loss: 0.122 Vali Loss: 2.206 Vali Acc: 0.520 Test Loss: 2.206 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 633890
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.168960809707642
Epoch: 1, Steps: 18 | Train Loss: 0.756 Vali Loss: 0.758 Vali Acc: 0.490 Test Loss: 0.758 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 6.059775352478027
Epoch: 2, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.910 Vali Acc: 0.530 Test Loss: 0.910 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 5.938945293426514
Epoch: 3, Steps: 18 | Train Loss: 0.490 Vali Loss: 0.921 Vali Acc: 0.500 Test Loss: 0.921 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.203308820724487
Epoch: 4, Steps: 18 | Train Loss: 0.339 Vali Loss: 0.907 Vali Acc: 0.570 Test Loss: 0.907 Test Acc: 0.570
Validation loss decreased (-0.529991 --> -0.569991).  Saving model ...
Epoch: 5 cost time: 6.149779796600342
Epoch: 5, Steps: 18 | Train Loss: 0.303 Vali Loss: 0.918 Vali Acc: 0.580 Test Loss: 0.918 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579991).  Saving model ...
Epoch: 6 cost time: 6.030219554901123
Epoch: 6, Steps: 18 | Train Loss: 0.194 Vali Loss: 1.183 Vali Acc: 0.530 Test Loss: 1.183 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.707123756408691
Epoch: 7, Steps: 18 | Train Loss: 0.118 Vali Loss: 1.109 Vali Acc: 0.520 Test Loss: 1.109 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.932420015335083
Epoch: 8, Steps: 18 | Train Loss: 0.226 Vali Loss: 1.470 Vali Acc: 0.510 Test Loss: 1.470 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.955684185028076
Epoch: 9, Steps: 18 | Train Loss: 0.095 Vali Loss: 2.369 Vali Acc: 0.520 Test Loss: 2.369 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.251314163208008
Epoch: 10, Steps: 18 | Train Loss: 0.170 Vali Loss: 2.574 Vali Acc: 0.530 Test Loss: 2.574 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.180516242980957
Epoch: 11, Steps: 18 | Train Loss: 0.257 Vali Loss: 3.553 Vali Acc: 0.530 Test Loss: 3.553 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.074239492416382
Epoch: 12, Steps: 18 | Train Loss: 0.194 Vali Loss: 2.007 Vali Acc: 0.470 Test Loss: 2.007 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.010155439376831
Epoch: 13, Steps: 18 | Train Loss: 0.112 Vali Loss: 1.805 Vali Acc: 0.540 Test Loss: 1.805 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.907851457595825
Epoch: 14, Steps: 18 | Train Loss: 0.328 Vali Loss: 3.687 Vali Acc: 0.480 Test Loss: 3.687 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.908533573150635
Epoch: 15, Steps: 18 | Train Loss: 0.246 Vali Loss: 1.971 Vali Acc: 0.520 Test Loss: 1.971 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 633890
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.581543445587158
Epoch: 1, Steps: 18 | Train Loss: 0.738 Vali Loss: 0.733 Vali Acc: 0.510 Test Loss: 0.733 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 5.6063783168792725
Epoch: 2, Steps: 18 | Train Loss: 0.626 Vali Loss: 0.844 Vali Acc: 0.450 Test Loss: 0.844 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.703497648239136
Epoch: 3, Steps: 18 | Train Loss: 0.458 Vali Loss: 0.948 Vali Acc: 0.420 Test Loss: 0.948 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.820802211761475
Epoch: 4, Steps: 18 | Train Loss: 0.344 Vali Loss: 0.850 Vali Acc: 0.540 Test Loss: 0.850 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 5.863942384719849
Epoch: 5, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.557 Vali Acc: 0.540 Test Loss: 1.557 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.860783576965332
Epoch: 6, Steps: 18 | Train Loss: 0.212 Vali Loss: 1.387 Vali Acc: 0.470 Test Loss: 1.387 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.676706790924072
Epoch: 7, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.959 Vali Acc: 0.520 Test Loss: 0.959 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.540059566497803
Epoch: 8, Steps: 18 | Train Loss: 0.257 Vali Loss: 2.256 Vali Acc: 0.450 Test Loss: 2.256 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.668272495269775
Epoch: 9, Steps: 18 | Train Loss: 0.108 Vali Loss: 1.168 Vali Acc: 0.560 Test Loss: 1.168 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559988).  Saving model ...
Epoch: 10 cost time: 5.645817756652832
Epoch: 10, Steps: 18 | Train Loss: 0.101 Vali Loss: 1.903 Vali Acc: 0.490 Test Loss: 1.903 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.457626819610596
Epoch: 11, Steps: 18 | Train Loss: 0.089 Vali Loss: 3.246 Vali Acc: 0.480 Test Loss: 3.246 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.292136907577515
Epoch: 12, Steps: 18 | Train Loss: 0.098 Vali Loss: 2.215 Vali Acc: 0.510 Test Loss: 2.215 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.561063766479492
Epoch: 13, Steps: 18 | Train Loss: 0.054 Vali Loss: 2.219 Vali Acc: 0.450 Test Loss: 2.219 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.605465412139893
Epoch: 14, Steps: 18 | Train Loss: 0.029 Vali Loss: 2.544 Vali Acc: 0.430 Test Loss: 2.544 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.559536933898926
Epoch: 15, Steps: 18 | Train Loss: 0.058 Vali Loss: 3.183 Vali Acc: 0.470 Test Loss: 3.183 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.36604905128479
Epoch: 16, Steps: 18 | Train Loss: 0.081 Vali Loss: 2.261 Vali Acc: 0.510 Test Loss: 2.261 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.69846248626709
Epoch: 17, Steps: 18 | Train Loss: 0.043 Vali Loss: 2.161 Vali Acc: 0.490 Test Loss: 2.161 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.644642353057861
Epoch: 18, Steps: 18 | Train Loss: 0.045 Vali Loss: 3.284 Vali Acc: 0.420 Test Loss: 3.284 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.778067350387573
Epoch: 19, Steps: 18 | Train Loss: 0.028 Vali Loss: 4.040 Vali Acc: 0.500 Test Loss: 4.040 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 633890
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.022625684738159
Epoch: 1, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.723 Vali Acc: 0.540 Test Loss: 0.723 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 5.992365837097168
Epoch: 2, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 5.720522403717041
Epoch: 3, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.968 Vali Acc: 0.470 Test Loss: 0.968 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.346738338470459
Epoch: 4, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.206 Vali Acc: 0.520 Test Loss: 1.206 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.106177806854248
Epoch: 5, Steps: 18 | Train Loss: 0.301 Vali Loss: 1.829 Vali Acc: 0.520 Test Loss: 1.829 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.656628847122192
Epoch: 6, Steps: 18 | Train Loss: 0.309 Vali Loss: 1.872 Vali Acc: 0.490 Test Loss: 1.872 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.789602518081665
Epoch: 7, Steps: 18 | Train Loss: 0.148 Vali Loss: 1.469 Vali Acc: 0.500 Test Loss: 1.469 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.80318546295166
Epoch: 8, Steps: 18 | Train Loss: 0.205 Vali Loss: 1.922 Vali Acc: 0.530 Test Loss: 1.922 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.596621036529541
Epoch: 9, Steps: 18 | Train Loss: 0.097 Vali Loss: 1.949 Vali Acc: 0.580 Test Loss: 1.949 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579981).  Saving model ...
Epoch: 10 cost time: 5.5679755210876465
Epoch: 10, Steps: 18 | Train Loss: 0.121 Vali Loss: 2.130 Vali Acc: 0.520 Test Loss: 2.130 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.633335113525391
Epoch: 11, Steps: 18 | Train Loss: 0.072 Vali Loss: 2.698 Vali Acc: 0.510 Test Loss: 2.698 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.595185041427612
Epoch: 12, Steps: 18 | Train Loss: 0.057 Vali Loss: 2.725 Vali Acc: 0.510 Test Loss: 2.725 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.734163761138916
Epoch: 13, Steps: 18 | Train Loss: 0.038 Vali Loss: 3.362 Vali Acc: 0.470 Test Loss: 3.362 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.922750949859619
Epoch: 14, Steps: 18 | Train Loss: 0.071 Vali Loss: 4.353 Vali Acc: 0.510 Test Loss: 4.353 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.845818996429443
Epoch: 15, Steps: 18 | Train Loss: 0.088 Vali Loss: 3.340 Vali Acc: 0.540 Test Loss: 3.340 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.787189245223999
Epoch: 16, Steps: 18 | Train Loss: 0.032 Vali Loss: 3.871 Vali Acc: 0.500 Test Loss: 3.871 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.765317916870117
Epoch: 17, Steps: 18 | Train Loss: 0.026 Vali Loss: 4.385 Vali Acc: 0.500 Test Loss: 4.385 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.603322267532349
Epoch: 18, Steps: 18 | Train Loss: 0.031 Vali Loss: 4.359 Vali Acc: 0.460 Test Loss: 4.359 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.702337741851807
Epoch: 19, Steps: 18 | Train Loss: 0.031 Vali Loss: 4.335 Vali Acc: 0.490 Test Loss: 4.335 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 633890
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.886119842529297
Epoch: 1, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.703 Vali Acc: 0.530 Test Loss: 0.703 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 5.644709348678589
Epoch: 2, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.688 Vali Acc: 0.580 Test Loss: 0.688 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 5.400737524032593
Epoch: 3, Steps: 18 | Train Loss: 0.493 Vali Loss: 0.979 Vali Acc: 0.520 Test Loss: 0.979 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.970043420791626
Epoch: 4, Steps: 18 | Train Loss: 0.344 Vali Loss: 0.886 Vali Acc: 0.560 Test Loss: 0.886 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.559253931045532
Epoch: 5, Steps: 18 | Train Loss: 0.266 Vali Loss: 1.235 Vali Acc: 0.540 Test Loss: 1.235 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.021562814712524
Epoch: 6, Steps: 18 | Train Loss: 0.271 Vali Loss: 1.805 Vali Acc: 0.530 Test Loss: 1.805 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.901922941207886
Epoch: 7, Steps: 18 | Train Loss: 0.180 Vali Loss: 1.332 Vali Acc: 0.510 Test Loss: 1.332 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.988446235656738
Epoch: 8, Steps: 18 | Train Loss: 0.149 Vali Loss: 1.472 Vali Acc: 0.480 Test Loss: 1.472 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.007216930389404
Epoch: 9, Steps: 18 | Train Loss: 0.064 Vali Loss: 2.944 Vali Acc: 0.500 Test Loss: 2.944 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.909970283508301
Epoch: 10, Steps: 18 | Train Loss: 0.228 Vali Loss: 2.190 Vali Acc: 0.550 Test Loss: 2.190 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.86514949798584
Epoch: 11, Steps: 18 | Train Loss: 0.192 Vali Loss: 2.790 Vali Acc: 0.500 Test Loss: 2.790 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.986548185348511
Epoch: 12, Steps: 18 | Train Loss: 0.084 Vali Loss: 2.669 Vali Acc: 0.480 Test Loss: 2.669 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 633890
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.9493567943573
Epoch: 1, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.733 Vali Acc: 0.430 Test Loss: 0.733 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 6.278962850570679
Epoch: 2, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
Validation loss decreased (-0.429993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 6.054237127304077
Epoch: 3, Steps: 18 | Train Loss: 0.557 Vali Loss: 0.851 Vali Acc: 0.520 Test Loss: 0.851 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.891836881637573
Epoch: 4, Steps: 18 | Train Loss: 0.431 Vali Loss: 1.307 Vali Acc: 0.510 Test Loss: 1.307 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.726142168045044
Epoch: 5, Steps: 18 | Train Loss: 0.377 Vali Loss: 0.940 Vali Acc: 0.460 Test Loss: 0.940 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.8571178913116455
Epoch: 6, Steps: 18 | Train Loss: 0.321 Vali Loss: 0.974 Vali Acc: 0.500 Test Loss: 0.974 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.636097431182861
Epoch: 7, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.393 Vali Acc: 0.590 Test Loss: 1.393 Test Acc: 0.590
Validation loss decreased (-0.519993 --> -0.589986).  Saving model ...
Epoch: 8 cost time: 5.76029372215271
Epoch: 8, Steps: 18 | Train Loss: 0.275 Vali Loss: 1.231 Vali Acc: 0.470 Test Loss: 1.231 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.698226451873779
Epoch: 9, Steps: 18 | Train Loss: 0.286 Vali Loss: 2.380 Vali Acc: 0.590 Test Loss: 2.380 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.6214659214019775
Epoch: 10, Steps: 18 | Train Loss: 0.230 Vali Loss: 1.996 Vali Acc: 0.490 Test Loss: 1.996 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.552916765213013
Epoch: 11, Steps: 18 | Train Loss: 0.210 Vali Loss: 2.698 Vali Acc: 0.430 Test Loss: 2.698 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.931767702102661
Epoch: 12, Steps: 18 | Train Loss: 0.117 Vali Loss: 2.405 Vali Acc: 0.520 Test Loss: 2.405 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.570325613021851
Epoch: 13, Steps: 18 | Train Loss: 0.064 Vali Loss: 1.610 Vali Acc: 0.440 Test Loss: 1.610 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.77992844581604
Epoch: 14, Steps: 18 | Train Loss: 0.127 Vali Loss: 2.279 Vali Acc: 0.430 Test Loss: 2.279 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.7722249031066895
Epoch: 15, Steps: 18 | Train Loss: 0.077 Vali Loss: 1.503 Vali Acc: 0.540 Test Loss: 1.503 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.832221508026123
Epoch: 16, Steps: 18 | Train Loss: 0.043 Vali Loss: 2.636 Vali Acc: 0.540 Test Loss: 2.636 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.084285736083984
Epoch: 17, Steps: 18 | Train Loss: 0.050 Vali Loss: 1.750 Vali Acc: 0.600 Test Loss: 1.750 Test Acc: 0.600
Validation loss decreased (-0.589986 --> -0.599983).  Saving model ...
Epoch: 18 cost time: 5.996378421783447
Epoch: 18, Steps: 18 | Train Loss: 0.090 Vali Loss: 1.461 Vali Acc: 0.550 Test Loss: 1.461 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.788281202316284
Epoch: 19, Steps: 18 | Train Loss: 0.091 Vali Loss: 4.268 Vali Acc: 0.470 Test Loss: 4.268 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.773737192153931
Epoch: 20, Steps: 18 | Train Loss: 0.102 Vali Loss: 1.637 Vali Acc: 0.560 Test Loss: 1.637 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.8597917556762695
Epoch: 21, Steps: 18 | Train Loss: 0.040 Vali Loss: 4.121 Vali Acc: 0.480 Test Loss: 4.121 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.944990158081055
Epoch: 22, Steps: 18 | Train Loss: 0.068 Vali Loss: 2.688 Vali Acc: 0.530 Test Loss: 2.688 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.747689247131348
Epoch: 23, Steps: 18 | Train Loss: 0.031 Vali Loss: 1.957 Vali Acc: 0.430 Test Loss: 1.957 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.988551139831543
Epoch: 24, Steps: 18 | Train Loss: 0.043 Vali Loss: 2.334 Vali Acc: 0.440 Test Loss: 2.334 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.045882225036621
Epoch: 25, Steps: 18 | Train Loss: 0.029 Vali Loss: 3.034 Vali Acc: 0.500 Test Loss: 3.034 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.274691104888916
Epoch: 26, Steps: 18 | Train Loss: 0.104 Vali Loss: 3.719 Vali Acc: 0.530 Test Loss: 3.719 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.245725870132446
Epoch: 27, Steps: 18 | Train Loss: 0.097 Vali Loss: 4.618 Vali Acc: 0.410 Test Loss: 4.618 Test Acc: 0.410
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 633890
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.393422365188599
Epoch: 1, Steps: 18 | Train Loss: 0.721 Vali Loss: 0.709 Vali Acc: 0.450 Test Loss: 0.709 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 6.173681020736694
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.829 Vali Acc: 0.500 Test Loss: 0.829 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 6.473237752914429
Epoch: 3, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.981 Vali Acc: 0.500 Test Loss: 0.981 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.819504022598267
Epoch: 4, Steps: 18 | Train Loss: 0.496 Vali Loss: 1.000 Vali Acc: 0.500 Test Loss: 1.000 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.535944938659668
Epoch: 5, Steps: 18 | Train Loss: 0.441 Vali Loss: 0.917 Vali Acc: 0.500 Test Loss: 0.917 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.593483209609985
Epoch: 6, Steps: 18 | Train Loss: 0.379 Vali Loss: 0.883 Vali Acc: 0.520 Test Loss: 0.883 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519991).  Saving model ...
Epoch: 7 cost time: 6.467633008956909
Epoch: 7, Steps: 18 | Train Loss: 0.479 Vali Loss: 1.056 Vali Acc: 0.520 Test Loss: 1.056 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.397485733032227
Epoch: 8, Steps: 18 | Train Loss: 0.346 Vali Loss: 2.002 Vali Acc: 0.490 Test Loss: 2.002 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.102501392364502
Epoch: 9, Steps: 18 | Train Loss: 0.200 Vali Loss: 1.157 Vali Acc: 0.580 Test Loss: 1.157 Test Acc: 0.580
Validation loss decreased (-0.519991 --> -0.579988).  Saving model ...
Epoch: 10 cost time: 6.1187217235565186
Epoch: 10, Steps: 18 | Train Loss: 0.155 Vali Loss: 1.327 Vali Acc: 0.560 Test Loss: 1.327 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.96770167350769
Epoch: 11, Steps: 18 | Train Loss: 0.157 Vali Loss: 1.694 Vali Acc: 0.500 Test Loss: 1.694 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.36401104927063
Epoch: 12, Steps: 18 | Train Loss: 0.142 Vali Loss: 1.484 Vali Acc: 0.540 Test Loss: 1.484 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.897136211395264
Epoch: 13, Steps: 18 | Train Loss: 0.162 Vali Loss: 1.365 Vali Acc: 0.500 Test Loss: 1.365 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.449978590011597
Epoch: 14, Steps: 18 | Train Loss: 0.119 Vali Loss: 1.586 Vali Acc: 0.500 Test Loss: 1.586 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.292773962020874
Epoch: 15, Steps: 18 | Train Loss: 0.285 Vali Loss: 2.209 Vali Acc: 0.550 Test Loss: 2.209 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.4278364181518555
Epoch: 16, Steps: 18 | Train Loss: 0.212 Vali Loss: 2.011 Vali Acc: 0.540 Test Loss: 2.011 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.915593147277832
Epoch: 17, Steps: 18 | Train Loss: 0.121 Vali Loss: 1.623 Vali Acc: 0.490 Test Loss: 1.623 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.7185986042022705
Epoch: 18, Steps: 18 | Train Loss: 0.071 Vali Loss: 1.989 Vali Acc: 0.530 Test Loss: 1.989 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.796561002731323
Epoch: 19, Steps: 18 | Train Loss: 0.186 Vali Loss: 3.294 Vali Acc: 0.520 Test Loss: 3.294 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 633890
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.135912418365479
Epoch: 1, Steps: 18 | Train Loss: 0.872 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 7.585797071456909
Epoch: 2, Steps: 18 | Train Loss: 0.786 Vali Loss: 1.281 Vali Acc: 0.500 Test Loss: 1.281 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.831700086593628
Epoch: 3, Steps: 18 | Train Loss: 0.669 Vali Loss: 1.107 Vali Acc: 0.530 Test Loss: 1.107 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529989).  Saving model ...
Epoch: 4 cost time: 7.990364074707031
Epoch: 4, Steps: 18 | Train Loss: 0.518 Vali Loss: 0.898 Vali Acc: 0.480 Test Loss: 0.898 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.849040985107422
Epoch: 5, Steps: 18 | Train Loss: 0.394 Vali Loss: 2.089 Vali Acc: 0.510 Test Loss: 2.089 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.023384809494019
Epoch: 6, Steps: 18 | Train Loss: 0.431 Vali Loss: 1.833 Vali Acc: 0.500 Test Loss: 1.833 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.096347093582153
Epoch: 7, Steps: 18 | Train Loss: 0.154 Vali Loss: 1.801 Vali Acc: 0.520 Test Loss: 1.801 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.003915309906006
Epoch: 8, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.160 Vali Acc: 0.530 Test Loss: 1.160 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.299040079116821
Epoch: 9, Steps: 18 | Train Loss: 0.273 Vali Loss: 1.741 Vali Acc: 0.550 Test Loss: 1.741 Test Acc: 0.550
Validation loss decreased (-0.529989 --> -0.549983).  Saving model ...
Epoch: 10 cost time: 7.786024332046509
Epoch: 10, Steps: 18 | Train Loss: 0.162 Vali Loss: 2.056 Vali Acc: 0.520 Test Loss: 2.056 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.092611074447632
Epoch: 11, Steps: 18 | Train Loss: 0.193 Vali Loss: 2.679 Vali Acc: 0.520 Test Loss: 2.679 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.746755838394165
Epoch: 12, Steps: 18 | Train Loss: 0.315 Vali Loss: 3.145 Vali Acc: 0.540 Test Loss: 3.145 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.632443904876709
Epoch: 13, Steps: 18 | Train Loss: 0.137 Vali Loss: 2.735 Vali Acc: 0.520 Test Loss: 2.735 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.675705194473267
Epoch: 14, Steps: 18 | Train Loss: 0.088 Vali Loss: 2.067 Vali Acc: 0.520 Test Loss: 2.067 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.878647327423096
Epoch: 15, Steps: 18 | Train Loss: 0.067 Vali Loss: 5.550 Vali Acc: 0.480 Test Loss: 5.550 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.060079336166382
Epoch: 16, Steps: 18 | Train Loss: 0.225 Vali Loss: 5.991 Vali Acc: 0.480 Test Loss: 5.991 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.750167608261108
Epoch: 17, Steps: 18 | Train Loss: 0.053 Vali Loss: 3.116 Vali Acc: 0.490 Test Loss: 3.116 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.9809675216674805
Epoch: 18, Steps: 18 | Train Loss: 0.070 Vali Loss: 2.711 Vali Acc: 0.500 Test Loss: 2.711 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.170163631439209
Epoch: 19, Steps: 18 | Train Loss: 0.202 Vali Loss: 2.912 Vali Acc: 0.490 Test Loss: 2.912 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 437282
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.24794602394104
Epoch: 1, Steps: 18 | Train Loss: 0.857 Vali Loss: 0.835 Vali Acc: 0.490 Test Loss: 0.835 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 7.224356651306152
Epoch: 2, Steps: 18 | Train Loss: 0.806 Vali Loss: 1.718 Vali Acc: 0.510 Test Loss: 1.718 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509983).  Saving model ...
Epoch: 3 cost time: 7.019138336181641
Epoch: 3, Steps: 18 | Train Loss: 0.895 Vali Loss: 1.524 Vali Acc: 0.530 Test Loss: 1.524 Test Acc: 0.530
Validation loss decreased (-0.509983 --> -0.529985).  Saving model ...
Epoch: 4 cost time: 7.096247434616089
Epoch: 4, Steps: 18 | Train Loss: 0.639 Vali Loss: 1.236 Vali Acc: 0.540 Test Loss: 1.236 Test Acc: 0.540
Validation loss decreased (-0.529985 --> -0.539988).  Saving model ...
Epoch: 5 cost time: 7.043397426605225
Epoch: 5, Steps: 18 | Train Loss: 0.379 Vali Loss: 0.935 Vali Acc: 0.520 Test Loss: 0.935 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.213748931884766
Epoch: 6, Steps: 18 | Train Loss: 0.344 Vali Loss: 1.610 Vali Acc: 0.500 Test Loss: 1.610 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.918565511703491
Epoch: 7, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.976 Vali Acc: 0.510 Test Loss: 0.976 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.171758651733398
Epoch: 8, Steps: 18 | Train Loss: 0.182 Vali Loss: 1.144 Vali Acc: 0.560 Test Loss: 1.144 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559989).  Saving model ...
Epoch: 9 cost time: 7.166167259216309
Epoch: 9, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.231 Vali Acc: 0.560 Test Loss: 1.231 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.17933464050293
Epoch: 10, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.717 Vali Acc: 0.510 Test Loss: 1.717 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.1164140701293945
Epoch: 11, Steps: 18 | Train Loss: 0.139 Vali Loss: 2.119 Vali Acc: 0.470 Test Loss: 2.119 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.313274145126343
Epoch: 12, Steps: 18 | Train Loss: 0.499 Vali Loss: 4.498 Vali Acc: 0.510 Test Loss: 4.498 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.336297988891602
Epoch: 13, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.755 Vali Acc: 0.550 Test Loss: 1.755 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.347238063812256
Epoch: 14, Steps: 18 | Train Loss: 0.103 Vali Loss: 1.934 Vali Acc: 0.510 Test Loss: 1.934 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.129420042037964
Epoch: 15, Steps: 18 | Train Loss: 0.128 Vali Loss: 2.674 Vali Acc: 0.520 Test Loss: 2.674 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.264605760574341
Epoch: 16, Steps: 18 | Train Loss: 0.103 Vali Loss: 2.009 Vali Acc: 0.560 Test Loss: 2.009 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.440150499343872
Epoch: 17, Steps: 18 | Train Loss: 0.065 Vali Loss: 2.338 Vali Acc: 0.510 Test Loss: 2.338 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.211481094360352
Epoch: 18, Steps: 18 | Train Loss: 0.113 Vali Loss: 4.350 Vali Acc: 0.510 Test Loss: 4.350 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 437282
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.046117305755615
Epoch: 1, Steps: 18 | Train Loss: 0.854 Vali Loss: 0.799 Vali Acc: 0.450 Test Loss: 0.799 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 6.9765989780426025
Epoch: 2, Steps: 18 | Train Loss: 0.815 Vali Loss: 1.394 Vali Acc: 0.500 Test Loss: 1.394 Test Acc: 0.500
Validation loss decreased (-0.449992 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 6.927696943283081
Epoch: 3, Steps: 18 | Train Loss: 0.808 Vali Loss: 1.236 Vali Acc: 0.510 Test Loss: 1.236 Test Acc: 0.510
Validation loss decreased (-0.499986 --> -0.509988).  Saving model ...
Epoch: 4 cost time: 7.509261846542358
Epoch: 4, Steps: 18 | Train Loss: 0.617 Vali Loss: 2.026 Vali Acc: 0.510 Test Loss: 2.026 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.061287879943848
Epoch: 5, Steps: 18 | Train Loss: 0.666 Vali Loss: 1.420 Vali Acc: 0.540 Test Loss: 1.420 Test Acc: 0.540
Validation loss decreased (-0.509988 --> -0.539986).  Saving model ...
Epoch: 6 cost time: 6.879891872406006
Epoch: 6, Steps: 18 | Train Loss: 0.427 Vali Loss: 1.031 Vali Acc: 0.530 Test Loss: 1.031 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.976577997207642
Epoch: 7, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.109 Vali Acc: 0.540 Test Loss: 1.109 Test Acc: 0.540
Validation loss decreased (-0.539986 --> -0.539989).  Saving model ...
Epoch: 8 cost time: 7.042688369750977
Epoch: 8, Steps: 18 | Train Loss: 0.135 Vali Loss: 1.093 Vali Acc: 0.550 Test Loss: 1.093 Test Acc: 0.550
Validation loss decreased (-0.539989 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 7.023487091064453
Epoch: 9, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.956 Vali Acc: 0.560 Test Loss: 1.956 Test Acc: 0.560
Validation loss decreased (-0.549989 --> -0.559980).  Saving model ...
Epoch: 10 cost time: 6.730657577514648
Epoch: 10, Steps: 18 | Train Loss: 0.412 Vali Loss: 2.196 Vali Acc: 0.500 Test Loss: 2.196 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.603541851043701
Epoch: 11, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.891 Vali Acc: 0.500 Test Loss: 1.891 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.843637228012085
Epoch: 12, Steps: 18 | Train Loss: 0.178 Vali Loss: 2.198 Vali Acc: 0.470 Test Loss: 2.198 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.936697244644165
Epoch: 13, Steps: 18 | Train Loss: 0.169 Vali Loss: 2.833 Vali Acc: 0.530 Test Loss: 2.833 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.7684831619262695
Epoch: 14, Steps: 18 | Train Loss: 0.250 Vali Loss: 2.680 Vali Acc: 0.580 Test Loss: 2.680 Test Acc: 0.580
Validation loss decreased (-0.559980 --> -0.579973).  Saving model ...
Epoch: 15 cost time: 6.633519172668457
Epoch: 15, Steps: 18 | Train Loss: 0.081 Vali Loss: 1.896 Vali Acc: 0.500 Test Loss: 1.896 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.586414813995361
Epoch: 16, Steps: 18 | Train Loss: 0.050 Vali Loss: 1.981 Vali Acc: 0.570 Test Loss: 1.981 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.087576866149902
Epoch: 17, Steps: 18 | Train Loss: 0.078 Vali Loss: 2.884 Vali Acc: 0.540 Test Loss: 2.884 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.2164366245269775
Epoch: 18, Steps: 18 | Train Loss: 0.048 Vali Loss: 2.431 Vali Acc: 0.530 Test Loss: 2.431 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.806687831878662
Epoch: 19, Steps: 18 | Train Loss: 0.075 Vali Loss: 3.317 Vali Acc: 0.510 Test Loss: 3.317 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.056019067764282
Epoch: 20, Steps: 18 | Train Loss: 0.096 Vali Loss: 3.174 Vali Acc: 0.540 Test Loss: 3.174 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.241908073425293
Epoch: 21, Steps: 18 | Train Loss: 0.035 Vali Loss: 3.991 Vali Acc: 0.510 Test Loss: 3.991 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.087556838989258
Epoch: 22, Steps: 18 | Train Loss: 0.034 Vali Loss: 3.334 Vali Acc: 0.480 Test Loss: 3.334 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.966236114501953
Epoch: 23, Steps: 18 | Train Loss: 0.251 Vali Loss: 4.626 Vali Acc: 0.550 Test Loss: 4.626 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.1304521560668945
Epoch: 24, Steps: 18 | Train Loss: 0.019 Vali Loss: 4.146 Vali Acc: 0.510 Test Loss: 4.146 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 437282
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.645841360092163
Epoch: 1, Steps: 18 | Train Loss: 0.874 Vali Loss: 0.780 Vali Acc: 0.480 Test Loss: 0.780 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 6.69913387298584
Epoch: 2, Steps: 18 | Train Loss: 0.777 Vali Loss: 1.298 Vali Acc: 0.520 Test Loss: 1.298 Test Acc: 0.520
Validation loss decreased (-0.479992 --> -0.519987).  Saving model ...
Epoch: 3 cost time: 6.053029775619507
Epoch: 3, Steps: 18 | Train Loss: 0.831 Vali Loss: 1.483 Vali Acc: 0.490 Test Loss: 1.483 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.155665397644043
Epoch: 4, Steps: 18 | Train Loss: 0.577 Vali Loss: 1.366 Vali Acc: 0.510 Test Loss: 1.366 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.240780830383301
Epoch: 5, Steps: 18 | Train Loss: 0.394 Vali Loss: 0.860 Vali Acc: 0.540 Test Loss: 0.860 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539991).  Saving model ...
Epoch: 6 cost time: 6.270658731460571
Epoch: 6, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.093 Vali Acc: 0.430 Test Loss: 1.093 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.000679016113281
Epoch: 7, Steps: 18 | Train Loss: 0.219 Vali Loss: 1.485 Vali Acc: 0.490 Test Loss: 1.485 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.352049350738525
Epoch: 8, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.350 Vali Acc: 0.490 Test Loss: 1.350 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.040359258651733
Epoch: 9, Steps: 18 | Train Loss: 0.135 Vali Loss: 1.253 Vali Acc: 0.480 Test Loss: 1.253 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.896393299102783
Epoch: 10, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.858 Vali Acc: 0.500 Test Loss: 1.858 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.837166786193848
Epoch: 11, Steps: 18 | Train Loss: 0.063 Vali Loss: 1.528 Vali Acc: 0.530 Test Loss: 1.528 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.104619264602661
Epoch: 12, Steps: 18 | Train Loss: 0.084 Vali Loss: 2.239 Vali Acc: 0.460 Test Loss: 2.239 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.002978086471558
Epoch: 13, Steps: 18 | Train Loss: 0.143 Vali Loss: 3.960 Vali Acc: 0.520 Test Loss: 3.960 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.066418647766113
Epoch: 14, Steps: 18 | Train Loss: 0.530 Vali Loss: 3.217 Vali Acc: 0.530 Test Loss: 3.217 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.0748937129974365
Epoch: 15, Steps: 18 | Train Loss: 0.229 Vali Loss: 5.026 Vali Acc: 0.500 Test Loss: 5.026 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 437282
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.452559232711792
Epoch: 1, Steps: 18 | Train Loss: 0.847 Vali Loss: 0.810 Vali Acc: 0.420 Test Loss: 0.810 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 5.652145147323608
Epoch: 2, Steps: 18 | Train Loss: 0.728 Vali Loss: 1.342 Vali Acc: 0.500 Test Loss: 1.342 Test Acc: 0.500
Validation loss decreased (-0.419992 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 5.4424684047698975
Epoch: 3, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.728 Vali Acc: 0.550 Test Loss: 0.728 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 5.3824782371521
Epoch: 4, Steps: 18 | Train Loss: 0.394 Vali Loss: 0.855 Vali Acc: 0.520 Test Loss: 0.855 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.646090984344482
Epoch: 5, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.447 Vali Acc: 0.510 Test Loss: 1.447 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.047145843505859
Epoch: 6, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.681351900100708
Epoch: 7, Steps: 18 | Train Loss: 0.151 Vali Loss: 1.111 Vali Acc: 0.620 Test Loss: 1.111 Test Acc: 0.620
Validation loss decreased (-0.549993 --> -0.619989).  Saving model ...
Epoch: 8 cost time: 5.784307956695557
Epoch: 8, Steps: 18 | Train Loss: 0.155 Vali Loss: 1.323 Vali Acc: 0.550 Test Loss: 1.323 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.995962858200073
Epoch: 9, Steps: 18 | Train Loss: 0.156 Vali Loss: 2.785 Vali Acc: 0.500 Test Loss: 2.785 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.901852369308472
Epoch: 10, Steps: 18 | Train Loss: 0.139 Vali Loss: 1.789 Vali Acc: 0.510 Test Loss: 1.789 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.092509031295776
Epoch: 11, Steps: 18 | Train Loss: 0.141 Vali Loss: 3.525 Vali Acc: 0.450 Test Loss: 3.525 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.001000881195068
Epoch: 12, Steps: 18 | Train Loss: 0.153 Vali Loss: 2.160 Vali Acc: 0.530 Test Loss: 2.160 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.452098608016968
Epoch: 13, Steps: 18 | Train Loss: 0.066 Vali Loss: 2.618 Vali Acc: 0.460 Test Loss: 2.618 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.370136260986328
Epoch: 14, Steps: 18 | Train Loss: 0.053 Vali Loss: 2.337 Vali Acc: 0.500 Test Loss: 2.337 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.768547773361206
Epoch: 15, Steps: 18 | Train Loss: 0.080 Vali Loss: 2.002 Vali Acc: 0.570 Test Loss: 2.002 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.2832932472229
Epoch: 16, Steps: 18 | Train Loss: 0.108 Vali Loss: 2.210 Vali Acc: 0.540 Test Loss: 2.210 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.261929035186768
Epoch: 17, Steps: 18 | Train Loss: 0.040 Vali Loss: 2.254 Vali Acc: 0.490 Test Loss: 2.254 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 437282
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.094106912612915
Epoch: 1, Steps: 18 | Train Loss: 0.865 Vali Loss: 0.797 Vali Acc: 0.480 Test Loss: 0.797 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 6.320584058761597
Epoch: 2, Steps: 18 | Train Loss: 0.887 Vali Loss: 1.038 Vali Acc: 0.500 Test Loss: 1.038 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499990).  Saving model ...
Epoch: 3 cost time: 5.909163236618042
Epoch: 3, Steps: 18 | Train Loss: 0.738 Vali Loss: 0.887 Vali Acc: 0.480 Test Loss: 0.887 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.194639682769775
Epoch: 4, Steps: 18 | Train Loss: 0.662 Vali Loss: 1.062 Vali Acc: 0.520 Test Loss: 1.062 Test Acc: 0.520
Validation loss decreased (-0.499990 --> -0.519989).  Saving model ...
Epoch: 5 cost time: 5.855562686920166
Epoch: 5, Steps: 18 | Train Loss: 0.371 Vali Loss: 0.857 Vali Acc: 0.460 Test Loss: 0.857 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.7329261302948
Epoch: 6, Steps: 18 | Train Loss: 0.323 Vali Loss: 0.940 Vali Acc: 0.490 Test Loss: 0.940 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.846961975097656
Epoch: 7, Steps: 18 | Train Loss: 0.146 Vali Loss: 1.198 Vali Acc: 0.530 Test Loss: 1.198 Test Acc: 0.530
Validation loss decreased (-0.519989 --> -0.529988).  Saving model ...
Epoch: 8 cost time: 5.5628838539123535
Epoch: 8, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.328 Vali Acc: 0.500 Test Loss: 1.328 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.689266681671143
Epoch: 9, Steps: 18 | Train Loss: 0.091 Vali Loss: 1.697 Vali Acc: 0.470 Test Loss: 1.697 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.012160539627075
Epoch: 10, Steps: 18 | Train Loss: 0.109 Vali Loss: 1.453 Vali Acc: 0.480 Test Loss: 1.453 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.85273814201355
Epoch: 11, Steps: 18 | Train Loss: 0.127 Vali Loss: 1.929 Vali Acc: 0.490 Test Loss: 1.929 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.009031534194946
Epoch: 12, Steps: 18 | Train Loss: 0.078 Vali Loss: 3.263 Vali Acc: 0.540 Test Loss: 3.263 Test Acc: 0.540
Validation loss decreased (-0.529988 --> -0.539967).  Saving model ...
Epoch: 13 cost time: 6.021967172622681
Epoch: 13, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.903 Vali Acc: 0.560 Test Loss: 1.903 Test Acc: 0.560
Validation loss decreased (-0.539967 --> -0.559981).  Saving model ...
Epoch: 14 cost time: 5.722230434417725
Epoch: 14, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.784 Vali Acc: 0.530 Test Loss: 1.784 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.671619415283203
Epoch: 15, Steps: 18 | Train Loss: 0.038 Vali Loss: 2.866 Vali Acc: 0.510 Test Loss: 2.866 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.017754793167114
Epoch: 16, Steps: 18 | Train Loss: 0.020 Vali Loss: 3.312 Vali Acc: 0.490 Test Loss: 3.312 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.439351320266724
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 3.552 Vali Acc: 0.430 Test Loss: 3.552 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.7085723876953125
Epoch: 18, Steps: 18 | Train Loss: 0.036 Vali Loss: 3.175 Vali Acc: 0.460 Test Loss: 3.175 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.7268664836883545
Epoch: 19, Steps: 18 | Train Loss: 0.035 Vali Loss: 3.370 Vali Acc: 0.530 Test Loss: 3.370 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.915330410003662
Epoch: 20, Steps: 18 | Train Loss: 0.035 Vali Loss: 3.239 Vali Acc: 0.440 Test Loss: 3.239 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.821225881576538
Epoch: 21, Steps: 18 | Train Loss: 0.079 Vali Loss: 5.161 Vali Acc: 0.510 Test Loss: 5.161 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.768017292022705
Epoch: 22, Steps: 18 | Train Loss: 0.206 Vali Loss: 3.004 Vali Acc: 0.480 Test Loss: 3.004 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.21847677230835
Epoch: 23, Steps: 18 | Train Loss: 0.122 Vali Loss: 3.525 Vali Acc: 0.510 Test Loss: 3.525 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 437282
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.260450839996338
Epoch: 1, Steps: 18 | Train Loss: 0.830 Vali Loss: 0.730 Vali Acc: 0.450 Test Loss: 0.730 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 5.997796535491943
Epoch: 2, Steps: 18 | Train Loss: 0.772 Vali Loss: 1.531 Vali Acc: 0.500 Test Loss: 1.531 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 5.737467288970947
Epoch: 3, Steps: 18 | Train Loss: 0.730 Vali Loss: 0.785 Vali Acc: 0.580 Test Loss: 0.785 Test Acc: 0.580
Validation loss decreased (-0.499985 --> -0.579992).  Saving model ...
Epoch: 4 cost time: 5.860686302185059
Epoch: 4, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.922 Vali Acc: 0.490 Test Loss: 0.922 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.956725120544434
Epoch: 5, Steps: 18 | Train Loss: 0.300 Vali Loss: 1.102 Vali Acc: 0.590 Test Loss: 1.102 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589989).  Saving model ...
Epoch: 6 cost time: 5.459537506103516
Epoch: 6, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.355 Vali Acc: 0.510 Test Loss: 1.355 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.908177614212036
Epoch: 7, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.434 Vali Acc: 0.540 Test Loss: 1.434 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.707194566726685
Epoch: 8, Steps: 18 | Train Loss: 0.101 Vali Loss: 1.387 Vali Acc: 0.600 Test Loss: 1.387 Test Acc: 0.600
Validation loss decreased (-0.589989 --> -0.599986).  Saving model ...
Epoch: 9 cost time: 5.5174689292907715
Epoch: 9, Steps: 18 | Train Loss: 0.076 Vali Loss: 2.752 Vali Acc: 0.460 Test Loss: 2.752 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.439979553222656
Epoch: 10, Steps: 18 | Train Loss: 0.113 Vali Loss: 2.654 Vali Acc: 0.500 Test Loss: 2.654 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.726511478424072
Epoch: 11, Steps: 18 | Train Loss: 0.049 Vali Loss: 2.163 Vali Acc: 0.550 Test Loss: 2.163 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.55397629737854
Epoch: 12, Steps: 18 | Train Loss: 0.045 Vali Loss: 2.807 Vali Acc: 0.490 Test Loss: 2.807 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.389237403869629
Epoch: 13, Steps: 18 | Train Loss: 0.030 Vali Loss: 3.187 Vali Acc: 0.510 Test Loss: 3.187 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.209567308425903
Epoch: 14, Steps: 18 | Train Loss: 0.039 Vali Loss: 2.784 Vali Acc: 0.530 Test Loss: 2.784 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.294154167175293
Epoch: 15, Steps: 18 | Train Loss: 0.046 Vali Loss: 3.366 Vali Acc: 0.560 Test Loss: 3.366 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.113168954849243
Epoch: 16, Steps: 18 | Train Loss: 0.038 Vali Loss: 3.832 Vali Acc: 0.540 Test Loss: 3.832 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.3773839473724365
Epoch: 17, Steps: 18 | Train Loss: 0.125 Vali Loss: 4.162 Vali Acc: 0.460 Test Loss: 4.162 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.40486478805542
Epoch: 18, Steps: 18 | Train Loss: 0.065 Vali Loss: 3.830 Vali Acc: 0.450 Test Loss: 3.830 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 437282
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.617930889129639
Epoch: 1, Steps: 18 | Train Loss: 0.877 Vali Loss: 0.731 Vali Acc: 0.530 Test Loss: 0.731 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 5.617210626602173
Epoch: 2, Steps: 18 | Train Loss: 0.825 Vali Loss: 1.428 Vali Acc: 0.500 Test Loss: 1.428 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.105939626693726
Epoch: 3, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.699 Vali Acc: 0.640 Test Loss: 0.699 Test Acc: 0.640
Validation loss decreased (-0.529993 --> -0.639993).  Saving model ...
Epoch: 4 cost time: 5.3403167724609375
Epoch: 4, Steps: 18 | Train Loss: 0.586 Vali Loss: 1.629 Vali Acc: 0.500 Test Loss: 1.629 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.322590351104736
Epoch: 5, Steps: 18 | Train Loss: 0.417 Vali Loss: 1.057 Vali Acc: 0.540 Test Loss: 1.057 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.63986611366272
Epoch: 6, Steps: 18 | Train Loss: 0.350 Vali Loss: 1.181 Vali Acc: 0.510 Test Loss: 1.181 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.509657621383667
Epoch: 7, Steps: 18 | Train Loss: 0.178 Vali Loss: 1.554 Vali Acc: 0.570 Test Loss: 1.554 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.431370973587036
Epoch: 8, Steps: 18 | Train Loss: 0.139 Vali Loss: 1.220 Vali Acc: 0.520 Test Loss: 1.220 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.54753041267395
Epoch: 9, Steps: 18 | Train Loss: 0.102 Vali Loss: 1.793 Vali Acc: 0.550 Test Loss: 1.793 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.638115882873535
Epoch: 10, Steps: 18 | Train Loss: 0.095 Vali Loss: 2.423 Vali Acc: 0.560 Test Loss: 2.423 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.703608989715576
Epoch: 11, Steps: 18 | Train Loss: 0.115 Vali Loss: 1.942 Vali Acc: 0.620 Test Loss: 1.942 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.74294376373291
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 2.194 Vali Acc: 0.530 Test Loss: 2.194 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.642040252685547
Epoch: 13, Steps: 18 | Train Loss: 0.075 Vali Loss: 2.650 Vali Acc: 0.510 Test Loss: 2.650 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 437282
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.883242607116699
Epoch: 1, Steps: 18 | Train Loss: 0.835 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 5.660441637039185
Epoch: 2, Steps: 18 | Train Loss: 0.830 Vali Loss: 1.063 Vali Acc: 0.500 Test Loss: 1.063 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 5.4479079246521
Epoch: 3, Steps: 18 | Train Loss: 0.755 Vali Loss: 0.898 Vali Acc: 0.500 Test Loss: 0.898 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 5.477101802825928
Epoch: 4, Steps: 18 | Train Loss: 0.596 Vali Loss: 1.173 Vali Acc: 0.580 Test Loss: 1.173 Test Acc: 0.580
Validation loss decreased (-0.499991 --> -0.579988).  Saving model ...
Epoch: 5 cost time: 5.328258991241455
Epoch: 5, Steps: 18 | Train Loss: 0.533 Vali Loss: 0.794 Vali Acc: 0.570 Test Loss: 0.794 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.602555751800537
Epoch: 6, Steps: 18 | Train Loss: 0.347 Vali Loss: 1.092 Vali Acc: 0.570 Test Loss: 1.092 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.854304790496826
Epoch: 7, Steps: 18 | Train Loss: 0.409 Vali Loss: 2.187 Vali Acc: 0.440 Test Loss: 2.187 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.511132001876831
Epoch: 8, Steps: 18 | Train Loss: 0.328 Vali Loss: 2.272 Vali Acc: 0.480 Test Loss: 2.272 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.432406425476074
Epoch: 9, Steps: 18 | Train Loss: 0.411 Vali Loss: 1.085 Vali Acc: 0.570 Test Loss: 1.085 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.578542232513428
Epoch: 10, Steps: 18 | Train Loss: 0.195 Vali Loss: 2.440 Vali Acc: 0.440 Test Loss: 2.440 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.3702232837677
Epoch: 11, Steps: 18 | Train Loss: 0.142 Vali Loss: 2.235 Vali Acc: 0.440 Test Loss: 2.235 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.627490282058716
Epoch: 12, Steps: 18 | Train Loss: 0.125 Vali Loss: 3.318 Vali Acc: 0.580 Test Loss: 3.318 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.661942720413208
Epoch: 13, Steps: 18 | Train Loss: 0.298 Vali Loss: 3.044 Vali Acc: 0.520 Test Loss: 3.044 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.744584560394287
Epoch: 14, Steps: 18 | Train Loss: 0.273 Vali Loss: 2.645 Vali Acc: 0.440 Test Loss: 2.645 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 437282
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.037728309631348
Epoch: 1, Steps: 18 | Train Loss: 0.803 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 5.37284779548645
Epoch: 2, Steps: 18 | Train Loss: 0.817 Vali Loss: 1.506 Vali Acc: 0.500 Test Loss: 1.506 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.735275506973267
Epoch: 3, Steps: 18 | Train Loss: 0.759 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.50324559211731
Epoch: 4, Steps: 18 | Train Loss: 0.811 Vali Loss: 0.744 Vali Acc: 0.490 Test Loss: 0.744 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.819070339202881
Epoch: 5, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.739 Vali Acc: 0.560 Test Loss: 0.739 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 5.676873207092285
Epoch: 6, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.843 Vali Acc: 0.500 Test Loss: 0.843 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.608377456665039
Epoch: 7, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.078 Vali Acc: 0.530 Test Loss: 1.078 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.633157730102539
Epoch: 8, Steps: 18 | Train Loss: 0.288 Vali Loss: 1.404 Vali Acc: 0.550 Test Loss: 1.404 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.045500993728638
Epoch: 9, Steps: 18 | Train Loss: 0.294 Vali Loss: 1.030 Vali Acc: 0.490 Test Loss: 1.030 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.633399248123169
Epoch: 10, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.063 Vali Acc: 0.500 Test Loss: 1.063 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.051665306091309
Epoch: 11, Steps: 18 | Train Loss: 0.146 Vali Loss: 1.166 Vali Acc: 0.550 Test Loss: 1.166 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.603975534439087
Epoch: 12, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.399 Vali Acc: 0.500 Test Loss: 1.399 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.514001369476318
Epoch: 13, Steps: 18 | Train Loss: 0.101 Vali Loss: 2.964 Vali Acc: 0.500 Test Loss: 2.964 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.733504295349121
Epoch: 14, Steps: 18 | Train Loss: 0.134 Vali Loss: 1.920 Vali Acc: 0.550 Test Loss: 1.920 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.7217698097229
Epoch: 15, Steps: 18 | Train Loss: 0.112 Vali Loss: 1.713 Vali Acc: 0.480 Test Loss: 1.713 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 437282
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.954580307006836
Epoch: 1, Steps: 18 | Train Loss: 0.742 Vali Loss: 0.802 Vali Acc: 0.500 Test Loss: 0.802 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 7.677675008773804
Epoch: 2, Steps: 18 | Train Loss: 0.585 Vali Loss: 1.294 Vali Acc: 0.480 Test Loss: 1.294 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.646025657653809
Epoch: 3, Steps: 18 | Train Loss: 0.532 Vali Loss: 1.204 Vali Acc: 0.470 Test Loss: 1.204 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.661045074462891
Epoch: 4, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.919 Vali Acc: 0.570 Test Loss: 0.919 Test Acc: 0.570
Validation loss decreased (-0.499992 --> -0.569991).  Saving model ...
Epoch: 5 cost time: 7.770655393600464
Epoch: 5, Steps: 18 | Train Loss: 0.330 Vali Loss: 0.869 Vali Acc: 0.630 Test Loss: 0.869 Test Acc: 0.630
Validation loss decreased (-0.569991 --> -0.629991).  Saving model ...
Epoch: 6 cost time: 7.554410696029663
Epoch: 6, Steps: 18 | Train Loss: 0.275 Vali Loss: 0.859 Vali Acc: 0.520 Test Loss: 0.859 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.232713937759399
Epoch: 7, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.321 Vali Acc: 0.520 Test Loss: 1.321 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.473889350891113
Epoch: 8, Steps: 18 | Train Loss: 0.285 Vali Loss: 1.515 Vali Acc: 0.520 Test Loss: 1.515 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.3578362464904785
Epoch: 9, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.332 Vali Acc: 0.580 Test Loss: 1.332 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.338673830032349
Epoch: 10, Steps: 18 | Train Loss: 0.075 Vali Loss: 1.314 Vali Acc: 0.520 Test Loss: 1.314 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.349632978439331
Epoch: 11, Steps: 18 | Train Loss: 0.060 Vali Loss: 1.567 Vali Acc: 0.520 Test Loss: 1.567 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.790166139602661
Epoch: 12, Steps: 18 | Train Loss: 0.142 Vali Loss: 1.745 Vali Acc: 0.510 Test Loss: 1.745 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.839482069015503
Epoch: 13, Steps: 18 | Train Loss: 0.070 Vali Loss: 2.475 Vali Acc: 0.540 Test Loss: 2.475 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.364400386810303
Epoch: 14, Steps: 18 | Train Loss: 0.125 Vali Loss: 3.290 Vali Acc: 0.510 Test Loss: 3.290 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.593875885009766
Epoch: 15, Steps: 18 | Train Loss: 0.062 Vali Loss: 2.401 Vali Acc: 0.530 Test Loss: 2.401 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 338978
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.054600477218628
Epoch: 1, Steps: 18 | Train Loss: 0.744 Vali Loss: 0.882 Vali Acc: 0.500 Test Loss: 0.882 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 6.545744895935059
Epoch: 2, Steps: 18 | Train Loss: 0.596 Vali Loss: 1.169 Vali Acc: 0.490 Test Loss: 1.169 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.440979242324829
Epoch: 3, Steps: 18 | Train Loss: 0.509 Vali Loss: 0.980 Vali Acc: 0.510 Test Loss: 0.980 Test Acc: 0.510
Validation loss decreased (-0.499991 --> -0.509990).  Saving model ...
Epoch: 4 cost time: 6.668056011199951
Epoch: 4, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.787 Vali Acc: 0.560 Test Loss: 0.787 Test Acc: 0.560
Validation loss decreased (-0.509990 --> -0.559992).  Saving model ...
Epoch: 5 cost time: 6.799432039260864
Epoch: 5, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.891 Vali Acc: 0.590 Test Loss: 0.891 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589991).  Saving model ...
Epoch: 6 cost time: 6.630062580108643
Epoch: 6, Steps: 18 | Train Loss: 0.292 Vali Loss: 2.308 Vali Acc: 0.510 Test Loss: 2.308 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.633256435394287
Epoch: 7, Steps: 18 | Train Loss: 0.784 Vali Loss: 2.472 Vali Acc: 0.510 Test Loss: 2.472 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.608770847320557
Epoch: 8, Steps: 18 | Train Loss: 0.413 Vali Loss: 1.269 Vali Acc: 0.560 Test Loss: 1.269 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.653325319290161
Epoch: 9, Steps: 18 | Train Loss: 0.195 Vali Loss: 1.802 Vali Acc: 0.540 Test Loss: 1.802 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.691264390945435
Epoch: 10, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.445 Vali Acc: 0.540 Test Loss: 1.445 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.832239151000977
Epoch: 11, Steps: 18 | Train Loss: 0.272 Vali Loss: 1.312 Vali Acc: 0.530 Test Loss: 1.312 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.888190269470215
Epoch: 12, Steps: 18 | Train Loss: 0.139 Vali Loss: 1.941 Vali Acc: 0.560 Test Loss: 1.941 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.165569067001343
Epoch: 13, Steps: 18 | Train Loss: 0.047 Vali Loss: 2.149 Vali Acc: 0.510 Test Loss: 2.149 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.003732681274414
Epoch: 14, Steps: 18 | Train Loss: 0.154 Vali Loss: 1.943 Vali Acc: 0.510 Test Loss: 1.943 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.777204990386963
Epoch: 15, Steps: 18 | Train Loss: 0.064 Vali Loss: 2.003 Vali Acc: 0.530 Test Loss: 2.003 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 338978
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.220877885818481
Epoch: 1, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.798 Vali Acc: 0.520 Test Loss: 0.798 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 6.6224730014801025
Epoch: 2, Steps: 18 | Train Loss: 0.581 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.6794867515563965
Epoch: 3, Steps: 18 | Train Loss: 0.535 Vali Loss: 1.376 Vali Acc: 0.520 Test Loss: 1.376 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.863698720932007
Epoch: 4, Steps: 18 | Train Loss: 0.351 Vali Loss: 0.954 Vali Acc: 0.530 Test Loss: 0.954 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529990).  Saving model ...
Epoch: 5 cost time: 6.6586387157440186
Epoch: 5, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.055 Vali Acc: 0.580 Test Loss: 1.055 Test Acc: 0.580
Validation loss decreased (-0.529990 --> -0.579989).  Saving model ...
Epoch: 6 cost time: 6.7189857959747314
Epoch: 6, Steps: 18 | Train Loss: 0.231 Vali Loss: 1.131 Vali Acc: 0.550 Test Loss: 1.131 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.461367607116699
Epoch: 7, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.102 Vali Acc: 0.550 Test Loss: 1.102 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.384775638580322
Epoch: 8, Steps: 18 | Train Loss: 0.163 Vali Loss: 1.455 Vali Acc: 0.550 Test Loss: 1.455 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.992261171340942
Epoch: 9, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.798 Vali Acc: 0.560 Test Loss: 1.798 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.3232550621032715
Epoch: 10, Steps: 18 | Train Loss: 0.142 Vali Loss: 1.512 Vali Acc: 0.520 Test Loss: 1.512 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.560710191726685
Epoch: 11, Steps: 18 | Train Loss: 0.085 Vali Loss: 1.654 Vali Acc: 0.530 Test Loss: 1.654 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.634730815887451
Epoch: 12, Steps: 18 | Train Loss: 0.056 Vali Loss: 1.693 Vali Acc: 0.550 Test Loss: 1.693 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.407670497894287
Epoch: 13, Steps: 18 | Train Loss: 0.053 Vali Loss: 2.985 Vali Acc: 0.550 Test Loss: 2.985 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.468735933303833
Epoch: 14, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.867 Vali Acc: 0.540 Test Loss: 1.867 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.85342812538147
Epoch: 15, Steps: 18 | Train Loss: 0.120 Vali Loss: 1.932 Vali Acc: 0.560 Test Loss: 1.932 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 338978
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.095997095108032
Epoch: 1, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.853 Vali Acc: 0.500 Test Loss: 0.853 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 5.797269821166992
Epoch: 2, Steps: 18 | Train Loss: 0.566 Vali Loss: 1.242 Vali Acc: 0.490 Test Loss: 1.242 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.825226068496704
Epoch: 3, Steps: 18 | Train Loss: 0.574 Vali Loss: 1.031 Vali Acc: 0.490 Test Loss: 1.031 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.921803712844849
Epoch: 4, Steps: 18 | Train Loss: 0.352 Vali Loss: 1.113 Vali Acc: 0.530 Test Loss: 1.113 Test Acc: 0.530
Validation loss decreased (-0.499991 --> -0.529989).  Saving model ...
Epoch: 5 cost time: 5.982837915420532
Epoch: 5, Steps: 18 | Train Loss: 0.313 Vali Loss: 0.962 Vali Acc: 0.600 Test Loss: 0.962 Test Acc: 0.600
Validation loss decreased (-0.529989 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 5.6844611167907715
Epoch: 6, Steps: 18 | Train Loss: 0.265 Vali Loss: 1.575 Vali Acc: 0.500 Test Loss: 1.575 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.703829050064087
Epoch: 7, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.087458610534668
Epoch: 8, Steps: 18 | Train Loss: 0.147 Vali Loss: 2.167 Vali Acc: 0.520 Test Loss: 2.167 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.095035552978516
Epoch: 9, Steps: 18 | Train Loss: 0.167 Vali Loss: 2.420 Vali Acc: 0.480 Test Loss: 2.420 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.147955656051636
Epoch: 10, Steps: 18 | Train Loss: 0.111 Vali Loss: 1.462 Vali Acc: 0.460 Test Loss: 1.462 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.957360506057739
Epoch: 11, Steps: 18 | Train Loss: 0.146 Vali Loss: 1.960 Vali Acc: 0.530 Test Loss: 1.960 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.921799421310425
Epoch: 12, Steps: 18 | Train Loss: 0.119 Vali Loss: 1.759 Vali Acc: 0.480 Test Loss: 1.759 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.951460123062134
Epoch: 13, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.907 Vali Acc: 0.490 Test Loss: 1.907 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.853161811828613
Epoch: 14, Steps: 18 | Train Loss: 0.121 Vali Loss: 2.785 Vali Acc: 0.470 Test Loss: 2.785 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.01471734046936
Epoch: 15, Steps: 18 | Train Loss: 0.064 Vali Loss: 1.939 Vali Acc: 0.500 Test Loss: 1.939 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 338978
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.698951005935669
Epoch: 1, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.886 Vali Acc: 0.510 Test Loss: 0.886 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 6.282537221908569
Epoch: 2, Steps: 18 | Train Loss: 0.618 Vali Loss: 1.164 Vali Acc: 0.510 Test Loss: 1.164 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.147987604141235
Epoch: 3, Steps: 18 | Train Loss: 0.509 Vali Loss: 0.819 Vali Acc: 0.520 Test Loss: 0.819 Test Acc: 0.520
Validation loss decreased (-0.509991 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 5.735497951507568
Epoch: 4, Steps: 18 | Train Loss: 0.420 Vali Loss: 1.015 Vali Acc: 0.530 Test Loss: 1.015 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529990).  Saving model ...
Epoch: 5 cost time: 5.852822303771973
Epoch: 5, Steps: 18 | Train Loss: 0.354 Vali Loss: 0.925 Vali Acc: 0.530 Test Loss: 0.925 Test Acc: 0.530
Validation loss decreased (-0.529990 --> -0.529991).  Saving model ...
Epoch: 6 cost time: 5.5193939208984375
Epoch: 6, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.387 Vali Acc: 0.520 Test Loss: 1.387 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.7236363887786865
Epoch: 7, Steps: 18 | Train Loss: 0.241 Vali Loss: 2.210 Vali Acc: 0.490 Test Loss: 2.210 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.123121976852417
Epoch: 8, Steps: 18 | Train Loss: 0.174 Vali Loss: 2.029 Vali Acc: 0.510 Test Loss: 2.029 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.334653377532959
Epoch: 9, Steps: 18 | Train Loss: 0.187 Vali Loss: 1.278 Vali Acc: 0.630 Test Loss: 1.278 Test Acc: 0.630
Validation loss decreased (-0.529991 --> -0.629987).  Saving model ...
Epoch: 10 cost time: 6.238229513168335
Epoch: 10, Steps: 18 | Train Loss: 0.183 Vali Loss: 1.495 Vali Acc: 0.560 Test Loss: 1.495 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.916951894760132
Epoch: 11, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.486 Vali Acc: 0.520 Test Loss: 1.486 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.168527603149414
Epoch: 12, Steps: 18 | Train Loss: 0.056 Vali Loss: 2.241 Vali Acc: 0.460 Test Loss: 2.241 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.061006546020508
Epoch: 13, Steps: 18 | Train Loss: 0.059 Vali Loss: 1.696 Vali Acc: 0.560 Test Loss: 1.696 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.239075660705566
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.896 Vali Acc: 0.550 Test Loss: 1.896 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.339799642562866
Epoch: 15, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.725 Vali Acc: 0.550 Test Loss: 1.725 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.309529781341553
Epoch: 16, Steps: 18 | Train Loss: 0.037 Vali Loss: 3.233 Vali Acc: 0.480 Test Loss: 3.233 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.090719938278198
Epoch: 17, Steps: 18 | Train Loss: 0.065 Vali Loss: 2.556 Vali Acc: 0.570 Test Loss: 2.556 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.971383810043335
Epoch: 18, Steps: 18 | Train Loss: 0.047 Vali Loss: 3.168 Vali Acc: 0.540 Test Loss: 3.168 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.841151475906372
Epoch: 19, Steps: 18 | Train Loss: 0.075 Vali Loss: 5.112 Vali Acc: 0.510 Test Loss: 5.112 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 338978
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.737612724304199
Epoch: 1, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 6.426861763000488
Epoch: 2, Steps: 18 | Train Loss: 0.618 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.5294249057769775
Epoch: 3, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
Validation loss decreased (-0.499991 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 5.987759590148926
Epoch: 4, Steps: 18 | Train Loss: 0.666 Vali Loss: 1.102 Vali Acc: 0.500 Test Loss: 1.102 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.915570497512817
Epoch: 5, Steps: 18 | Train Loss: 0.400 Vali Loss: 1.537 Vali Acc: 0.480 Test Loss: 1.537 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.279722213745117
Epoch: 6, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.962 Vali Acc: 0.530 Test Loss: 0.962 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.357579946517944
Epoch: 7, Steps: 18 | Train Loss: 0.319 Vali Loss: 2.279 Vali Acc: 0.500 Test Loss: 2.279 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.507018089294434
Epoch: 8, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.788 Vali Acc: 0.490 Test Loss: 1.788 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.063030242919922
Epoch: 9, Steps: 18 | Train Loss: 0.126 Vali Loss: 1.677 Vali Acc: 0.470 Test Loss: 1.677 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.150361061096191
Epoch: 10, Steps: 18 | Train Loss: 0.061 Vali Loss: 1.793 Vali Acc: 0.510 Test Loss: 1.793 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.961607933044434
Epoch: 11, Steps: 18 | Train Loss: 0.122 Vali Loss: 2.477 Vali Acc: 0.510 Test Loss: 2.477 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.893173933029175
Epoch: 12, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.510 Vali Acc: 0.520 Test Loss: 1.510 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.540868759155273
Epoch: 13, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.936 Vali Acc: 0.490 Test Loss: 1.936 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 338978
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.178783416748047
Epoch: 1, Steps: 18 | Train Loss: 0.720 Vali Loss: 0.815 Vali Acc: 0.510 Test Loss: 0.815 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 5.48313307762146
Epoch: 2, Steps: 18 | Train Loss: 0.573 Vali Loss: 0.785 Vali Acc: 0.550 Test Loss: 0.785 Test Acc: 0.550
Validation loss decreased (-0.509992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 5.463229656219482
Epoch: 3, Steps: 18 | Train Loss: 0.470 Vali Loss: 0.756 Vali Acc: 0.600 Test Loss: 0.756 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599992).  Saving model ...
Epoch: 4 cost time: 5.602205991744995
Epoch: 4, Steps: 18 | Train Loss: 0.333 Vali Loss: 0.891 Vali Acc: 0.570 Test Loss: 0.891 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.3735671043396
Epoch: 5, Steps: 18 | Train Loss: 0.252 Vali Loss: 1.003 Vali Acc: 0.570 Test Loss: 1.003 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.56038498878479
Epoch: 6, Steps: 18 | Train Loss: 0.200 Vali Loss: 1.225 Vali Acc: 0.570 Test Loss: 1.225 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.486664533615112
Epoch: 7, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.441 Vali Acc: 0.530 Test Loss: 1.441 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.283604860305786
Epoch: 8, Steps: 18 | Train Loss: 0.096 Vali Loss: 2.361 Vali Acc: 0.520 Test Loss: 2.361 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.997115612030029
Epoch: 9, Steps: 18 | Train Loss: 0.193 Vali Loss: 2.080 Vali Acc: 0.520 Test Loss: 2.080 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.116912841796875
Epoch: 10, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.551 Vali Acc: 0.550 Test Loss: 1.551 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.556806325912476
Epoch: 11, Steps: 18 | Train Loss: 0.031 Vali Loss: 2.041 Vali Acc: 0.590 Test Loss: 2.041 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.369681358337402
Epoch: 12, Steps: 18 | Train Loss: 0.040 Vali Loss: 2.739 Vali Acc: 0.530 Test Loss: 2.739 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.268176794052124
Epoch: 13, Steps: 18 | Train Loss: 0.045 Vali Loss: 2.987 Vali Acc: 0.500 Test Loss: 2.987 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 338978
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.610371351242065
Epoch: 1, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.898 Vali Acc: 0.500 Test Loss: 0.898 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 6.216241121292114
Epoch: 2, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.677 Vali Acc: 0.590 Test Loss: 0.677 Test Acc: 0.590
Validation loss decreased (-0.499991 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 6.277263879776001
Epoch: 3, Steps: 18 | Train Loss: 0.492 Vali Loss: 0.744 Vali Acc: 0.510 Test Loss: 0.744 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.29694128036499
Epoch: 4, Steps: 18 | Train Loss: 0.500 Vali Loss: 0.959 Vali Acc: 0.490 Test Loss: 0.959 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.229795217514038
Epoch: 5, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.916 Vali Acc: 0.620 Test Loss: 0.916 Test Acc: 0.620
Validation loss decreased (-0.589993 --> -0.619991).  Saving model ...
Epoch: 6 cost time: 6.449926853179932
Epoch: 6, Steps: 18 | Train Loss: 0.298 Vali Loss: 1.133 Vali Acc: 0.510 Test Loss: 1.133 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.681040048599243
Epoch: 7, Steps: 18 | Train Loss: 0.230 Vali Loss: 1.707 Vali Acc: 0.530 Test Loss: 1.707 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.778020143508911
Epoch: 8, Steps: 18 | Train Loss: 0.169 Vali Loss: 1.350 Vali Acc: 0.510 Test Loss: 1.350 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.892988681793213
Epoch: 9, Steps: 18 | Train Loss: 0.118 Vali Loss: 1.477 Vali Acc: 0.480 Test Loss: 1.477 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.4215638637542725
Epoch: 10, Steps: 18 | Train Loss: 0.101 Vali Loss: 2.574 Vali Acc: 0.560 Test Loss: 2.574 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.176019668579102
Epoch: 11, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.993 Vali Acc: 0.540 Test Loss: 1.993 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.0990684032440186
Epoch: 12, Steps: 18 | Train Loss: 0.046 Vali Loss: 3.478 Vali Acc: 0.480 Test Loss: 3.478 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.56185245513916
Epoch: 13, Steps: 18 | Train Loss: 0.048 Vali Loss: 2.447 Vali Acc: 0.530 Test Loss: 2.447 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.847064018249512
Epoch: 14, Steps: 18 | Train Loss: 0.026 Vali Loss: 2.385 Vali Acc: 0.520 Test Loss: 2.385 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.3540990352630615
Epoch: 15, Steps: 18 | Train Loss: 0.030 Vali Loss: 2.420 Vali Acc: 0.510 Test Loss: 2.420 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 338978
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.206692218780518
Epoch: 1, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.888 Vali Acc: 0.500 Test Loss: 0.888 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 6.216309070587158
Epoch: 2, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.994 Vali Acc: 0.550 Test Loss: 0.994 Test Acc: 0.550
Validation loss decreased (-0.499991 --> -0.549990).  Saving model ...
Epoch: 3 cost time: 6.534326553344727
Epoch: 3, Steps: 18 | Train Loss: 0.526 Vali Loss: 0.863 Vali Acc: 0.530 Test Loss: 0.863 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.892456531524658
Epoch: 4, Steps: 18 | Train Loss: 0.564 Vali Loss: 1.324 Vali Acc: 0.450 Test Loss: 1.324 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.671122074127197
Epoch: 5, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.845 Vali Acc: 0.490 Test Loss: 0.845 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.787008762359619
Epoch: 6, Steps: 18 | Train Loss: 0.399 Vali Loss: 1.095 Vali Acc: 0.520 Test Loss: 1.095 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.872821807861328
Epoch: 7, Steps: 18 | Train Loss: 0.334 Vali Loss: 2.677 Vali Acc: 0.450 Test Loss: 2.677 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.184309244155884
Epoch: 8, Steps: 18 | Train Loss: 0.285 Vali Loss: 1.848 Vali Acc: 0.510 Test Loss: 1.848 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.062836170196533
Epoch: 9, Steps: 18 | Train Loss: 0.200 Vali Loss: 1.505 Vali Acc: 0.500 Test Loss: 1.505 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.144050359725952
Epoch: 10, Steps: 18 | Train Loss: 0.160 Vali Loss: 2.111 Vali Acc: 0.410 Test Loss: 2.111 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.657293796539307
Epoch: 11, Steps: 18 | Train Loss: 0.113 Vali Loss: 2.037 Vali Acc: 0.510 Test Loss: 2.037 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.343042850494385
Epoch: 12, Steps: 18 | Train Loss: 0.172 Vali Loss: 4.005 Vali Acc: 0.490 Test Loss: 4.005 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 338978
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.134936332702637
Epoch: 1, Steps: 18 | Train Loss: 0.751 Vali Loss: 0.938 Vali Acc: 0.500 Test Loss: 0.938 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 6.077270030975342
Epoch: 2, Steps: 18 | Train Loss: 0.677 Vali Loss: 0.806 Vali Acc: 0.500 Test Loss: 0.806 Test Acc: 0.500
Validation loss decreased (-0.499991 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 6.09481954574585
Epoch: 3, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.901 Vali Acc: 0.500 Test Loss: 0.901 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.076964616775513
Epoch: 4, Steps: 18 | Train Loss: 0.745 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 5.913660049438477
Epoch: 5, Steps: 18 | Train Loss: 0.571 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.03752589225769
Epoch: 6, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.783 Vali Acc: 0.490 Test Loss: 0.783 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.7597901821136475
Epoch: 7, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.514220476150513
Epoch: 8, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.296 Vali Acc: 0.520 Test Loss: 1.296 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.610189437866211
Epoch: 9, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.506 Vali Acc: 0.500 Test Loss: 1.506 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.771855592727661
Epoch: 10, Steps: 18 | Train Loss: 0.366 Vali Loss: 1.344 Vali Acc: 0.460 Test Loss: 1.344 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.458688259124756
Epoch: 11, Steps: 18 | Train Loss: 0.382 Vali Loss: 1.080 Vali Acc: 0.590 Test Loss: 1.080 Test Acc: 0.590
Validation loss decreased (-0.539993 --> -0.589989).  Saving model ...
Epoch: 12 cost time: 5.8194420337677
Epoch: 12, Steps: 18 | Train Loss: 0.146 Vali Loss: 1.202 Vali Acc: 0.520 Test Loss: 1.202 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.427657127380371
Epoch: 13, Steps: 18 | Train Loss: 0.143 Vali Loss: 1.451 Vali Acc: 0.450 Test Loss: 1.451 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.844852924346924
Epoch: 14, Steps: 18 | Train Loss: 0.152 Vali Loss: 2.495 Vali Acc: 0.540 Test Loss: 2.495 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.571946859359741
Epoch: 15, Steps: 18 | Train Loss: 0.151 Vali Loss: 2.065 Vali Acc: 0.580 Test Loss: 2.065 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.654718399047852
Epoch: 16, Steps: 18 | Train Loss: 0.142 Vali Loss: 3.699 Vali Acc: 0.510 Test Loss: 3.699 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.4398884773254395
Epoch: 17, Steps: 18 | Train Loss: 0.188 Vali Loss: 2.388 Vali Acc: 0.560 Test Loss: 2.388 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.4614644050598145
Epoch: 18, Steps: 18 | Train Loss: 0.243 Vali Loss: 2.014 Vali Acc: 0.530 Test Loss: 2.014 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.4406304359436035
Epoch: 19, Steps: 18 | Train Loss: 0.090 Vali Loss: 2.365 Vali Acc: 0.560 Test Loss: 2.365 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.526352167129517
Epoch: 20, Steps: 18 | Train Loss: 0.119 Vali Loss: 4.748 Vali Acc: 0.530 Test Loss: 4.748 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.7073423862457275
Epoch: 21, Steps: 18 | Train Loss: 0.211 Vali Loss: 3.314 Vali Acc: 0.540 Test Loss: 3.314 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 338978
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.513341665267944
Epoch: 1, Steps: 18 | Train Loss: 0.779 Vali Loss: 0.731 Vali Acc: 0.560 Test Loss: 0.731 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 7.115213394165039
Epoch: 2, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.793 Vali Acc: 0.550 Test Loss: 0.793 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.990889310836792
Epoch: 3, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.854 Vali Acc: 0.530 Test Loss: 0.854 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.413347959518433
Epoch: 4, Steps: 18 | Train Loss: 0.440 Vali Loss: 1.528 Vali Acc: 0.520 Test Loss: 1.528 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.225770950317383
Epoch: 5, Steps: 18 | Train Loss: 0.566 Vali Loss: 1.501 Vali Acc: 0.520 Test Loss: 1.501 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.4666547775268555
Epoch: 6, Steps: 18 | Train Loss: 0.327 Vali Loss: 1.279 Vali Acc: 0.540 Test Loss: 1.279 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.2789483070373535
Epoch: 7, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.958 Vali Acc: 0.620 Test Loss: 0.958 Test Acc: 0.620
Validation loss decreased (-0.559993 --> -0.619990).  Saving model ...
Epoch: 8 cost time: 7.413918733596802
Epoch: 8, Steps: 18 | Train Loss: 0.300 Vali Loss: 1.496 Vali Acc: 0.530 Test Loss: 1.496 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.164576053619385
Epoch: 9, Steps: 18 | Train Loss: 0.345 Vali Loss: 2.491 Vali Acc: 0.530 Test Loss: 2.491 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.093197345733643
Epoch: 10, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.444 Vali Acc: 0.470 Test Loss: 1.444 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.2039430141448975
Epoch: 11, Steps: 18 | Train Loss: 0.322 Vali Loss: 2.260 Vali Acc: 0.510 Test Loss: 2.260 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.210353136062622
Epoch: 12, Steps: 18 | Train Loss: 0.346 Vali Loss: 1.975 Vali Acc: 0.570 Test Loss: 1.975 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.500356674194336
Epoch: 13, Steps: 18 | Train Loss: 0.229 Vali Loss: 2.383 Vali Acc: 0.480 Test Loss: 2.383 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.307861089706421
Epoch: 14, Steps: 18 | Train Loss: 0.198 Vali Loss: 3.375 Vali Acc: 0.490 Test Loss: 3.375 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.167705297470093
Epoch: 15, Steps: 18 | Train Loss: 0.565 Vali Loss: 1.839 Vali Acc: 0.540 Test Loss: 1.839 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.128632307052612
Epoch: 16, Steps: 18 | Train Loss: 0.082 Vali Loss: 3.229 Vali Acc: 0.550 Test Loss: 3.229 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.27440619468689
Epoch: 17, Steps: 18 | Train Loss: 0.057 Vali Loss: 2.675 Vali Acc: 0.520 Test Loss: 2.675 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 289826
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.961068153381348
Epoch: 1, Steps: 18 | Train Loss: 0.796 Vali Loss: 0.708 Vali Acc: 0.570 Test Loss: 0.708 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 6.882659912109375
Epoch: 2, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.772 Vali Acc: 0.550 Test Loss: 0.772 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.441950082778931
Epoch: 3, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.957 Vali Acc: 0.530 Test Loss: 0.957 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.5287415981292725
Epoch: 4, Steps: 18 | Train Loss: 0.430 Vali Loss: 1.209 Vali Acc: 0.520 Test Loss: 1.209 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.351972579956055
Epoch: 5, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.898 Vali Acc: 0.550 Test Loss: 0.898 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.446009397506714
Epoch: 6, Steps: 18 | Train Loss: 0.289 Vali Loss: 0.850 Vali Acc: 0.590 Test Loss: 0.850 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589991).  Saving model ...
Epoch: 7 cost time: 6.5243144035339355
Epoch: 7, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.365 Vali Acc: 0.570 Test Loss: 1.365 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.30329704284668
Epoch: 8, Steps: 18 | Train Loss: 0.166 Vali Loss: 1.133 Vali Acc: 0.570 Test Loss: 1.133 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.602792024612427
Epoch: 9, Steps: 18 | Train Loss: 0.149 Vali Loss: 1.240 Vali Acc: 0.510 Test Loss: 1.240 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.640440940856934
Epoch: 10, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.161 Vali Acc: 0.570 Test Loss: 1.161 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.372900009155273
Epoch: 11, Steps: 18 | Train Loss: 0.110 Vali Loss: 1.126 Vali Acc: 0.600 Test Loss: 1.126 Test Acc: 0.600
Validation loss decreased (-0.589991 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 6.399983882904053
Epoch: 12, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.457 Vali Acc: 0.610 Test Loss: 1.457 Test Acc: 0.610
Validation loss decreased (-0.599989 --> -0.609985).  Saving model ...
Epoch: 13 cost time: 6.702125787734985
Epoch: 13, Steps: 18 | Train Loss: 0.076 Vali Loss: 2.296 Vali Acc: 0.560 Test Loss: 2.296 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.6433563232421875
Epoch: 14, Steps: 18 | Train Loss: 0.152 Vali Loss: 2.500 Vali Acc: 0.550 Test Loss: 2.500 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.663249731063843
Epoch: 15, Steps: 18 | Train Loss: 0.203 Vali Loss: 3.175 Vali Acc: 0.500 Test Loss: 3.175 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.718479156494141
Epoch: 16, Steps: 18 | Train Loss: 0.080 Vali Loss: 4.172 Vali Acc: 0.510 Test Loss: 4.172 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.515666723251343
Epoch: 17, Steps: 18 | Train Loss: 0.193 Vali Loss: 3.072 Vali Acc: 0.500 Test Loss: 3.072 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.572997331619263
Epoch: 18, Steps: 18 | Train Loss: 0.135 Vali Loss: 4.104 Vali Acc: 0.540 Test Loss: 4.104 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.649537801742554
Epoch: 19, Steps: 18 | Train Loss: 0.047 Vali Loss: 3.420 Vali Acc: 0.540 Test Loss: 3.420 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.691242456436157
Epoch: 20, Steps: 18 | Train Loss: 0.027 Vali Loss: 3.291 Vali Acc: 0.530 Test Loss: 3.291 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.569077014923096
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.895 Vali Acc: 0.560 Test Loss: 2.895 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.425953149795532
Epoch: 22, Steps: 18 | Train Loss: 0.079 Vali Loss: 2.685 Vali Acc: 0.520 Test Loss: 2.685 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 289826
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.004175901412964
Epoch: 1, Steps: 18 | Train Loss: 0.800 Vali Loss: 0.755 Vali Acc: 0.520 Test Loss: 0.755 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 5.953477382659912
Epoch: 2, Steps: 18 | Train Loss: 0.671 Vali Loss: 1.378 Vali Acc: 0.500 Test Loss: 1.378 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.350184202194214
Epoch: 3, Steps: 18 | Train Loss: 0.902 Vali Loss: 1.082 Vali Acc: 0.530 Test Loss: 1.082 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529989).  Saving model ...
Epoch: 4 cost time: 6.271419286727905
Epoch: 4, Steps: 18 | Train Loss: 0.409 Vali Loss: 1.049 Vali Acc: 0.520 Test Loss: 1.049 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.186760187149048
Epoch: 5, Steps: 18 | Train Loss: 0.354 Vali Loss: 1.088 Vali Acc: 0.510 Test Loss: 1.088 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.15984320640564
Epoch: 6, Steps: 18 | Train Loss: 0.276 Vali Loss: 0.949 Vali Acc: 0.580 Test Loss: 0.949 Test Acc: 0.580
Validation loss decreased (-0.529989 --> -0.579991).  Saving model ...
Epoch: 7 cost time: 6.19833779335022
Epoch: 7, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
Validation loss decreased (-0.579991 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 6.0323755741119385
Epoch: 8, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.160 Vali Acc: 0.580 Test Loss: 1.160 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.353677988052368
Epoch: 9, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.599 Vali Acc: 0.550 Test Loss: 1.599 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.1389782428741455
Epoch: 10, Steps: 18 | Train Loss: 0.079 Vali Loss: 1.646 Vali Acc: 0.580 Test Loss: 1.646 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.190971612930298
Epoch: 11, Steps: 18 | Train Loss: 0.137 Vali Loss: 1.444 Vali Acc: 0.550 Test Loss: 1.444 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.245782375335693
Epoch: 12, Steps: 18 | Train Loss: 0.088 Vali Loss: 2.373 Vali Acc: 0.560 Test Loss: 2.373 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.376316070556641
Epoch: 13, Steps: 18 | Train Loss: 0.198 Vali Loss: 2.398 Vali Acc: 0.550 Test Loss: 2.398 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.299903869628906
Epoch: 14, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.824 Vali Acc: 0.550 Test Loss: 1.824 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.2017433643341064
Epoch: 15, Steps: 18 | Train Loss: 0.108 Vali Loss: 3.692 Vali Acc: 0.520 Test Loss: 3.692 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.302744626998901
Epoch: 16, Steps: 18 | Train Loss: 0.104 Vali Loss: 1.865 Vali Acc: 0.550 Test Loss: 1.865 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.518763303756714
Epoch: 17, Steps: 18 | Train Loss: 0.088 Vali Loss: 2.160 Vali Acc: 0.570 Test Loss: 2.160 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 289826
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.460508823394775
Epoch: 1, Steps: 18 | Train Loss: 0.790 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 6.020219087600708
Epoch: 2, Steps: 18 | Train Loss: 0.654 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.244601726531982
Epoch: 3, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.882 Vali Acc: 0.510 Test Loss: 0.882 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.048354625701904
Epoch: 4, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.447 Vali Acc: 0.520 Test Loss: 1.447 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.372608423233032
Epoch: 5, Steps: 18 | Train Loss: 0.341 Vali Loss: 2.422 Vali Acc: 0.500 Test Loss: 2.422 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.229928731918335
Epoch: 6, Steps: 18 | Train Loss: 0.277 Vali Loss: 0.969 Vali Acc: 0.540 Test Loss: 0.969 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539990).  Saving model ...
Epoch: 7 cost time: 6.170272588729858
Epoch: 7, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.240 Vali Acc: 0.540 Test Loss: 1.240 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.233804702758789
Epoch: 8, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.671 Vali Acc: 0.530 Test Loss: 1.671 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.126021862030029
Epoch: 9, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.218 Vali Acc: 0.530 Test Loss: 1.218 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.132879257202148
Epoch: 10, Steps: 18 | Train Loss: 0.162 Vali Loss: 1.969 Vali Acc: 0.500 Test Loss: 1.969 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.0264153480529785
Epoch: 11, Steps: 18 | Train Loss: 0.215 Vali Loss: 2.385 Vali Acc: 0.510 Test Loss: 2.385 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.602920770645142
Epoch: 12, Steps: 18 | Train Loss: 0.098 Vali Loss: 2.667 Vali Acc: 0.500 Test Loss: 2.667 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.518689393997192
Epoch: 13, Steps: 18 | Train Loss: 0.300 Vali Loss: 2.369 Vali Acc: 0.510 Test Loss: 2.369 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.714346408843994
Epoch: 14, Steps: 18 | Train Loss: 0.120 Vali Loss: 2.370 Vali Acc: 0.470 Test Loss: 2.370 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.946416854858398
Epoch: 15, Steps: 18 | Train Loss: 0.341 Vali Loss: 4.026 Vali Acc: 0.500 Test Loss: 4.026 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.835662364959717
Epoch: 16, Steps: 18 | Train Loss: 0.293 Vali Loss: 2.574 Vali Acc: 0.550 Test Loss: 2.574 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549974).  Saving model ...
Epoch: 17 cost time: 5.715689182281494
Epoch: 17, Steps: 18 | Train Loss: 0.111 Vali Loss: 3.490 Vali Acc: 0.510 Test Loss: 3.490 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.847320556640625
Epoch: 18, Steps: 18 | Train Loss: 0.038 Vali Loss: 2.432 Vali Acc: 0.520 Test Loss: 2.432 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.805299997329712
Epoch: 19, Steps: 18 | Train Loss: 0.069 Vali Loss: 3.380 Vali Acc: 0.490 Test Loss: 3.380 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.272101640701294
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.863 Vali Acc: 0.480 Test Loss: 2.863 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.940061569213867
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 3.906 Vali Acc: 0.490 Test Loss: 3.906 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.827979803085327
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 3.667 Vali Acc: 0.500 Test Loss: 3.667 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.001274347305298
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 3.206 Vali Acc: 0.470 Test Loss: 3.206 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.764963388442993
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 3.612 Vali Acc: 0.510 Test Loss: 3.612 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.865411281585693
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 3.064 Vali Acc: 0.470 Test Loss: 3.064 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.697474479675293
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 3.170 Vali Acc: 0.480 Test Loss: 3.170 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 289826
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.866382122039795
Epoch: 1, Steps: 18 | Train Loss: 0.801 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 6.124881982803345
Epoch: 2, Steps: 18 | Train Loss: 0.739 Vali Loss: 1.039 Vali Acc: 0.520 Test Loss: 1.039 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519990).  Saving model ...
Epoch: 3 cost time: 6.1369922161102295
Epoch: 3, Steps: 18 | Train Loss: 0.653 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.71668267250061
Epoch: 4, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.791 Vali Acc: 0.530 Test Loss: 0.791 Test Acc: 0.530
Validation loss decreased (-0.519990 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 5.722399473190308
Epoch: 5, Steps: 18 | Train Loss: 0.319 Vali Loss: 0.991 Vali Acc: 0.540 Test Loss: 0.991 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539990).  Saving model ...
Epoch: 6 cost time: 5.85921049118042
Epoch: 6, Steps: 18 | Train Loss: 0.235 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.808074951171875
Epoch: 7, Steps: 18 | Train Loss: 0.318 Vali Loss: 1.224 Vali Acc: 0.550 Test Loss: 1.224 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 6.007035255432129
Epoch: 8, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.081 Vali Acc: 0.520 Test Loss: 1.081 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.388087272644043
Epoch: 9, Steps: 18 | Train Loss: 0.093 Vali Loss: 1.742 Vali Acc: 0.530 Test Loss: 1.742 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.018472671508789
Epoch: 10, Steps: 18 | Train Loss: 0.132 Vali Loss: 2.020 Vali Acc: 0.540 Test Loss: 2.020 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.110187768936157
Epoch: 11, Steps: 18 | Train Loss: 0.123 Vali Loss: 2.049 Vali Acc: 0.620 Test Loss: 2.049 Test Acc: 0.620
Validation loss decreased (-0.549988 --> -0.619980).  Saving model ...
Epoch: 12 cost time: 6.672196865081787
Epoch: 12, Steps: 18 | Train Loss: 0.083 Vali Loss: 1.488 Vali Acc: 0.590 Test Loss: 1.488 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.845155954360962
Epoch: 13, Steps: 18 | Train Loss: 0.084 Vali Loss: 2.070 Vali Acc: 0.480 Test Loss: 2.070 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.953421354293823
Epoch: 14, Steps: 18 | Train Loss: 0.048 Vali Loss: 2.910 Vali Acc: 0.500 Test Loss: 2.910 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.671157360076904
Epoch: 15, Steps: 18 | Train Loss: 0.154 Vali Loss: 1.881 Vali Acc: 0.520 Test Loss: 1.881 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.250438451766968
Epoch: 16, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.768 Vali Acc: 0.570 Test Loss: 1.768 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.077089548110962
Epoch: 17, Steps: 18 | Train Loss: 0.047 Vali Loss: 3.035 Vali Acc: 0.550 Test Loss: 3.035 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.629642486572266
Epoch: 18, Steps: 18 | Train Loss: 0.040 Vali Loss: 2.174 Vali Acc: 0.520 Test Loss: 2.174 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.480173110961914
Epoch: 19, Steps: 18 | Train Loss: 0.015 Vali Loss: 2.403 Vali Acc: 0.510 Test Loss: 2.403 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.5843706130981445
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.601 Vali Acc: 0.520 Test Loss: 2.601 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.827372789382935
Epoch: 21, Steps: 18 | Train Loss: 0.034 Vali Loss: 2.706 Vali Acc: 0.570 Test Loss: 2.706 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 289826
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.367011308670044
Epoch: 1, Steps: 18 | Train Loss: 0.853 Vali Loss: 0.883 Vali Acc: 0.500 Test Loss: 0.883 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 5.644094467163086
Epoch: 2, Steps: 18 | Train Loss: 0.728 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.5789475440979
Epoch: 3, Steps: 18 | Train Loss: 0.792 Vali Loss: 1.081 Vali Acc: 0.520 Test Loss: 1.081 Test Acc: 0.520
Validation loss decreased (-0.499991 --> -0.519989).  Saving model ...
Epoch: 4 cost time: 5.575679779052734
Epoch: 4, Steps: 18 | Train Loss: 0.448 Vali Loss: 0.782 Vali Acc: 0.530 Test Loss: 0.782 Test Acc: 0.530
Validation loss decreased (-0.519989 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 5.701841354370117
Epoch: 5, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.083 Vali Acc: 0.530 Test Loss: 1.083 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.493283271789551
Epoch: 6, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.072 Vali Acc: 0.500 Test Loss: 1.072 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.151397228240967
Epoch: 7, Steps: 18 | Train Loss: 0.170 Vali Loss: 1.251 Vali Acc: 0.490 Test Loss: 1.251 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.447712421417236
Epoch: 8, Steps: 18 | Train Loss: 0.130 Vali Loss: 1.416 Vali Acc: 0.520 Test Loss: 1.416 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.79386568069458
Epoch: 9, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.348 Vali Acc: 0.480 Test Loss: 1.348 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.760867595672607
Epoch: 10, Steps: 18 | Train Loss: 0.049 Vali Loss: 1.501 Vali Acc: 0.500 Test Loss: 1.501 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.405333518981934
Epoch: 11, Steps: 18 | Train Loss: 0.052 Vali Loss: 1.502 Vali Acc: 0.510 Test Loss: 1.502 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.726924657821655
Epoch: 12, Steps: 18 | Train Loss: 0.081 Vali Loss: 3.057 Vali Acc: 0.510 Test Loss: 3.057 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.512774229049683
Epoch: 13, Steps: 18 | Train Loss: 0.086 Vali Loss: 2.537 Vali Acc: 0.510 Test Loss: 2.537 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.394115209579468
Epoch: 14, Steps: 18 | Train Loss: 0.046 Vali Loss: 1.825 Vali Acc: 0.450 Test Loss: 1.825 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 289826
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.577720642089844
Epoch: 1, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.781 Vali Acc: 0.550 Test Loss: 0.781 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 5.771233797073364
Epoch: 2, Steps: 18 | Train Loss: 0.669 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.854515314102173
Epoch: 3, Steps: 18 | Train Loss: 0.689 Vali Loss: 1.389 Vali Acc: 0.510 Test Loss: 1.389 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.424899578094482
Epoch: 4, Steps: 18 | Train Loss: 0.463 Vali Loss: 1.500 Vali Acc: 0.500 Test Loss: 1.500 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.859299182891846
Epoch: 5, Steps: 18 | Train Loss: 0.435 Vali Loss: 1.669 Vali Acc: 0.500 Test Loss: 1.669 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.717184543609619
Epoch: 6, Steps: 18 | Train Loss: 0.243 Vali Loss: 0.982 Vali Acc: 0.540 Test Loss: 0.982 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.7724926471710205
Epoch: 7, Steps: 18 | Train Loss: 0.173 Vali Loss: 1.886 Vali Acc: 0.490 Test Loss: 1.886 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.760912179946899
Epoch: 8, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.802 Vali Acc: 0.530 Test Loss: 1.802 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.644251108169556
Epoch: 9, Steps: 18 | Train Loss: 0.104 Vali Loss: 1.570 Vali Acc: 0.490 Test Loss: 1.570 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.545321464538574
Epoch: 10, Steps: 18 | Train Loss: 0.154 Vali Loss: 2.186 Vali Acc: 0.450 Test Loss: 2.186 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.812697410583496
Epoch: 11, Steps: 18 | Train Loss: 0.150 Vali Loss: 2.405 Vali Acc: 0.450 Test Loss: 2.405 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 289826
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.733126401901245
Epoch: 1, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 5.627166271209717
Epoch: 2, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.839 Vali Acc: 0.510 Test Loss: 0.839 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.973931074142456
Epoch: 3, Steps: 18 | Train Loss: 0.579 Vali Loss: 0.714 Vali Acc: 0.580 Test Loss: 0.714 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 6.339200258255005
Epoch: 4, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.950 Vali Acc: 0.530 Test Loss: 0.950 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.359540224075317
Epoch: 5, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.633 Vali Acc: 0.510 Test Loss: 1.633 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.9529194831848145
Epoch: 6, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.5334312915802
Epoch: 7, Steps: 18 | Train Loss: 0.170 Vali Loss: 1.300 Vali Acc: 0.540 Test Loss: 1.300 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.7938573360443115
Epoch: 8, Steps: 18 | Train Loss: 0.130 Vali Loss: 1.205 Vali Acc: 0.530 Test Loss: 1.205 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.725642919540405
Epoch: 9, Steps: 18 | Train Loss: 0.110 Vali Loss: 1.507 Vali Acc: 0.490 Test Loss: 1.507 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.092185735702515
Epoch: 10, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.487 Vali Acc: 0.520 Test Loss: 1.487 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.721076965332031
Epoch: 11, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.564 Vali Acc: 0.540 Test Loss: 1.564 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.738441228866577
Epoch: 12, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.810 Vali Acc: 0.480 Test Loss: 1.810 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.083585739135742
Epoch: 13, Steps: 18 | Train Loss: 0.022 Vali Loss: 2.197 Vali Acc: 0.470 Test Loss: 2.197 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 289826
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.085350751876831
Epoch: 1, Steps: 18 | Train Loss: 0.793 Vali Loss: 0.928 Vali Acc: 0.510 Test Loss: 0.928 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 6.307811260223389
Epoch: 2, Steps: 18 | Train Loss: 0.749 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.9839794635772705
Epoch: 3, Steps: 18 | Train Loss: 0.822 Vali Loss: 0.894 Vali Acc: 0.490 Test Loss: 0.894 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.587691068649292
Epoch: 4, Steps: 18 | Train Loss: 0.520 Vali Loss: 0.834 Vali Acc: 0.510 Test Loss: 0.834 Test Acc: 0.510
Validation loss decreased (-0.509991 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 5.487087965011597
Epoch: 5, Steps: 18 | Train Loss: 0.416 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.701950550079346
Epoch: 6, Steps: 18 | Train Loss: 0.315 Vali Loss: 2.007 Vali Acc: 0.440 Test Loss: 2.007 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.019515514373779
Epoch: 7, Steps: 18 | Train Loss: 0.399 Vali Loss: 1.615 Vali Acc: 0.550 Test Loss: 1.615 Test Acc: 0.550
Validation loss decreased (-0.509992 --> -0.549984).  Saving model ...
Epoch: 8 cost time: 5.452331304550171
Epoch: 8, Steps: 18 | Train Loss: 0.553 Vali Loss: 1.455 Vali Acc: 0.520 Test Loss: 1.455 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.922881364822388
Epoch: 9, Steps: 18 | Train Loss: 0.307 Vali Loss: 0.964 Vali Acc: 0.560 Test Loss: 0.964 Test Acc: 0.560
Validation loss decreased (-0.549984 --> -0.559990).  Saving model ...
Epoch: 10 cost time: 5.693202972412109
Epoch: 10, Steps: 18 | Train Loss: 0.265 Vali Loss: 1.324 Vali Acc: 0.530 Test Loss: 1.324 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.900288820266724
Epoch: 11, Steps: 18 | Train Loss: 0.147 Vali Loss: 2.614 Vali Acc: 0.430 Test Loss: 2.614 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.047786712646484
Epoch: 12, Steps: 18 | Train Loss: 0.105 Vali Loss: 2.454 Vali Acc: 0.430 Test Loss: 2.454 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.786352634429932
Epoch: 13, Steps: 18 | Train Loss: 0.085 Vali Loss: 2.904 Vali Acc: 0.520 Test Loss: 2.904 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.770771265029907
Epoch: 14, Steps: 18 | Train Loss: 0.046 Vali Loss: 1.301 Vali Acc: 0.520 Test Loss: 1.301 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.604342460632324
Epoch: 15, Steps: 18 | Train Loss: 0.066 Vali Loss: 1.966 Vali Acc: 0.490 Test Loss: 1.966 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.0345299243927
Epoch: 16, Steps: 18 | Train Loss: 0.082 Vali Loss: 2.147 Vali Acc: 0.510 Test Loss: 2.147 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.371263265609741
Epoch: 17, Steps: 18 | Train Loss: 0.060 Vali Loss: 3.270 Vali Acc: 0.500 Test Loss: 3.270 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.4636359214782715
Epoch: 18, Steps: 18 | Train Loss: 0.024 Vali Loss: 3.352 Vali Acc: 0.440 Test Loss: 3.352 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.55334210395813
Epoch: 19, Steps: 18 | Train Loss: 0.056 Vali Loss: 2.458 Vali Acc: 0.530 Test Loss: 2.458 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 289826
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.125086784362793
Epoch: 1, Steps: 18 | Train Loss: 0.769 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 5.533886194229126
Epoch: 2, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 5.640443563461304
Epoch: 3, Steps: 18 | Train Loss: 0.833 Vali Loss: 0.995 Vali Acc: 0.500 Test Loss: 0.995 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.837836742401123
Epoch: 4, Steps: 18 | Train Loss: 0.555 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.542139053344727
Epoch: 5, Steps: 18 | Train Loss: 0.577 Vali Loss: 1.072 Vali Acc: 0.500 Test Loss: 1.072 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.085205078125
Epoch: 6, Steps: 18 | Train Loss: 0.406 Vali Loss: 0.896 Vali Acc: 0.500 Test Loss: 0.896 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.0055012702941895
Epoch: 7, Steps: 18 | Train Loss: 0.366 Vali Loss: 0.786 Vali Acc: 0.540 Test Loss: 0.786 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 5.84828519821167
Epoch: 8, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.202 Vali Acc: 0.490 Test Loss: 1.202 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.9984540939331055
Epoch: 9, Steps: 18 | Train Loss: 0.548 Vali Loss: 0.934 Vali Acc: 0.530 Test Loss: 0.934 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.830092668533325
Epoch: 10, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.457 Vali Acc: 0.510 Test Loss: 1.457 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.869440317153931
Epoch: 11, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.553 Vali Acc: 0.500 Test Loss: 1.553 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.009465217590332
Epoch: 12, Steps: 18 | Train Loss: 0.185 Vali Loss: 0.968 Vali Acc: 0.500 Test Loss: 0.968 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.249965190887451
Epoch: 13, Steps: 18 | Train Loss: 0.125 Vali Loss: 1.133 Vali Acc: 0.520 Test Loss: 1.133 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.358089208602905
Epoch: 14, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.276 Vali Acc: 0.540 Test Loss: 1.276 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.965458393096924
Epoch: 15, Steps: 18 | Train Loss: 0.118 Vali Loss: 2.108 Vali Acc: 0.510 Test Loss: 2.108 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.800219774246216
Epoch: 16, Steps: 18 | Train Loss: 0.100 Vali Loss: 2.607 Vali Acc: 0.520 Test Loss: 2.607 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.717449426651001
Epoch: 17, Steps: 18 | Train Loss: 0.103 Vali Loss: 2.604 Vali Acc: 0.530 Test Loss: 2.604 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 289826
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1500                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.366325616836548
Epoch: 1, Steps: 18 | Train Loss: 0.809 Vali Loss: 0.987 Vali Acc: 0.500 Test Loss: 0.987 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 7.356324672698975
Epoch: 2, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.925 Vali Acc: 0.470 Test Loss: 0.925 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.11162257194519
Epoch: 3, Steps: 18 | Train Loss: 0.657 Vali Loss: 1.297 Vali Acc: 0.510 Test Loss: 1.297 Test Acc: 0.510
Validation loss decreased (-0.499990 --> -0.509987).  Saving model ...
Epoch: 4 cost time: 7.292328119277954
Epoch: 4, Steps: 18 | Train Loss: 0.406 Vali Loss: 1.069 Vali Acc: 0.480 Test Loss: 1.069 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.135719537734985
Epoch: 5, Steps: 18 | Train Loss: 0.399 Vali Loss: 1.342 Vali Acc: 0.480 Test Loss: 1.342 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.9676713943481445
Epoch: 6, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.604 Vali Acc: 0.510 Test Loss: 1.604 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.211947441101074
Epoch: 7, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.005 Vali Acc: 0.580 Test Loss: 1.005 Test Acc: 0.580
Validation loss decreased (-0.509987 --> -0.579990).  Saving model ...
Epoch: 8 cost time: 7.31570029258728
Epoch: 8, Steps: 18 | Train Loss: 0.178 Vali Loss: 2.000 Vali Acc: 0.530 Test Loss: 2.000 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.192152500152588
Epoch: 9, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.938 Vali Acc: 0.530 Test Loss: 1.938 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.2722368240356445
Epoch: 10, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.386 Vali Acc: 0.520 Test Loss: 1.386 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.7457311153411865
Epoch: 11, Steps: 18 | Train Loss: 0.154 Vali Loss: 1.813 Vali Acc: 0.520 Test Loss: 1.813 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.589163541793823
Epoch: 12, Steps: 18 | Train Loss: 0.060 Vali Loss: 2.549 Vali Acc: 0.510 Test Loss: 2.549 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.671492099761963
Epoch: 13, Steps: 18 | Train Loss: 0.258 Vali Loss: 3.180 Vali Acc: 0.550 Test Loss: 3.180 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.468208074569702
Epoch: 14, Steps: 18 | Train Loss: 0.256 Vali Loss: 1.507 Vali Acc: 0.500 Test Loss: 1.507 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.479019641876221
Epoch: 15, Steps: 18 | Train Loss: 0.058 Vali Loss: 1.636 Vali Acc: 0.570 Test Loss: 1.636 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.521503686904907
Epoch: 16, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.884 Vali Acc: 0.560 Test Loss: 1.884 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.249050617218018
Epoch: 17, Steps: 18 | Train Loss: 0.058 Vali Loss: 3.478 Vali Acc: 0.510 Test Loss: 3.478 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 265250
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1200                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.961702585220337
Epoch: 1, Steps: 18 | Train Loss: 0.811 Vali Loss: 0.950 Vali Acc: 0.510 Test Loss: 0.950 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 7.184869050979614
Epoch: 2, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.879 Vali Acc: 0.490 Test Loss: 0.879 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.863961935043335
Epoch: 3, Steps: 18 | Train Loss: 0.561 Vali Loss: 0.834 Vali Acc: 0.550 Test Loss: 0.834 Test Acc: 0.550
Validation loss decreased (-0.509990 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 6.592862844467163
Epoch: 4, Steps: 18 | Train Loss: 0.478 Vali Loss: 1.238 Vali Acc: 0.540 Test Loss: 1.238 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.959104776382446
Epoch: 5, Steps: 18 | Train Loss: 0.321 Vali Loss: 1.359 Vali Acc: 0.540 Test Loss: 1.359 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.158177614212036
Epoch: 6, Steps: 18 | Train Loss: 0.272 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 7.115405797958374
Epoch: 7, Steps: 18 | Train Loss: 0.227 Vali Loss: 1.009 Vali Acc: 0.540 Test Loss: 1.009 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.964039325714111
Epoch: 8, Steps: 18 | Train Loss: 0.176 Vali Loss: 1.870 Vali Acc: 0.490 Test Loss: 1.870 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.329718828201294
Epoch: 9, Steps: 18 | Train Loss: 0.235 Vali Loss: 1.477 Vali Acc: 0.570 Test Loss: 1.477 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.244971990585327
Epoch: 10, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.439 Vali Acc: 0.530 Test Loss: 1.439 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.095961570739746
Epoch: 11, Steps: 18 | Train Loss: 0.209 Vali Loss: 1.639 Vali Acc: 0.580 Test Loss: 1.639 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.893990516662598
Epoch: 12, Steps: 18 | Train Loss: 0.129 Vali Loss: 2.010 Vali Acc: 0.520 Test Loss: 2.010 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.826889276504517
Epoch: 13, Steps: 18 | Train Loss: 0.120 Vali Loss: 2.115 Vali Acc: 0.560 Test Loss: 2.115 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.8530824184417725
Epoch: 14, Steps: 18 | Train Loss: 0.093 Vali Loss: 5.612 Vali Acc: 0.510 Test Loss: 5.612 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.606459140777588
Epoch: 15, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.959 Vali Acc: 0.500 Test Loss: 1.959 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.927252769470215
Epoch: 16, Steps: 18 | Train Loss: 0.089 Vali Loss: 2.147 Vali Acc: 0.580 Test Loss: 2.147 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 265250
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.249763250350952
Epoch: 1, Steps: 18 | Train Loss: 0.809 Vali Loss: 1.014 Vali Acc: 0.500 Test Loss: 1.014 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 6.252776622772217
Epoch: 2, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.898 Vali Acc: 0.490 Test Loss: 0.898 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.276082515716553
Epoch: 3, Steps: 18 | Train Loss: 0.462 Vali Loss: 1.045 Vali Acc: 0.540 Test Loss: 1.045 Test Acc: 0.540
Validation loss decreased (-0.499990 --> -0.539990).  Saving model ...
Epoch: 4 cost time: 6.2276787757873535
Epoch: 4, Steps: 18 | Train Loss: 0.472 Vali Loss: 1.398 Vali Acc: 0.490 Test Loss: 1.398 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.281148910522461
Epoch: 5, Steps: 18 | Train Loss: 0.378 Vali Loss: 1.108 Vali Acc: 0.530 Test Loss: 1.108 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.369105577468872
Epoch: 6, Steps: 18 | Train Loss: 0.364 Vali Loss: 1.083 Vali Acc: 0.580 Test Loss: 1.083 Test Acc: 0.580
Validation loss decreased (-0.539990 --> -0.579989).  Saving model ...
Epoch: 7 cost time: 6.411953449249268
Epoch: 7, Steps: 18 | Train Loss: 0.434 Vali Loss: 1.516 Vali Acc: 0.520 Test Loss: 1.516 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.343057155609131
Epoch: 8, Steps: 18 | Train Loss: 0.282 Vali Loss: 1.247 Vali Acc: 0.520 Test Loss: 1.247 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.1956892013549805
Epoch: 9, Steps: 18 | Train Loss: 0.286 Vali Loss: 2.437 Vali Acc: 0.530 Test Loss: 2.437 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.235978603363037
Epoch: 10, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.455 Vali Acc: 0.570 Test Loss: 1.455 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.083536624908447
Epoch: 11, Steps: 18 | Train Loss: 0.152 Vali Loss: 3.210 Vali Acc: 0.500 Test Loss: 3.210 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.239258766174316
Epoch: 12, Steps: 18 | Train Loss: 0.489 Vali Loss: 2.871 Vali Acc: 0.530 Test Loss: 2.871 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.2974534034729
Epoch: 13, Steps: 18 | Train Loss: 0.086 Vali Loss: 2.002 Vali Acc: 0.570 Test Loss: 2.002 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.157013654708862
Epoch: 14, Steps: 18 | Train Loss: 0.080 Vali Loss: 2.342 Vali Acc: 0.540 Test Loss: 2.342 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.021434307098389
Epoch: 15, Steps: 18 | Train Loss: 0.100 Vali Loss: 2.343 Vali Acc: 0.520 Test Loss: 2.343 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.087477207183838
Epoch: 16, Steps: 18 | Train Loss: 0.112 Vali Loss: 2.108 Vali Acc: 0.520 Test Loss: 2.108 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 265250
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         600                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.045560359954834
Epoch: 1, Steps: 18 | Train Loss: 0.796 Vali Loss: 0.995 Vali Acc: 0.500 Test Loss: 0.995 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 5.723984718322754
Epoch: 2, Steps: 18 | Train Loss: 0.653 Vali Loss: 1.277 Vali Acc: 0.490 Test Loss: 1.277 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.7575459480285645
Epoch: 3, Steps: 18 | Train Loss: 0.469 Vali Loss: 0.969 Vali Acc: 0.540 Test Loss: 0.969 Test Acc: 0.540
Validation loss decreased (-0.499990 --> -0.539990).  Saving model ...
Epoch: 4 cost time: 5.737421274185181
Epoch: 4, Steps: 18 | Train Loss: 0.533 Vali Loss: 0.922 Vali Acc: 0.500 Test Loss: 0.922 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.218071460723877
Epoch: 5, Steps: 18 | Train Loss: 0.394 Vali Loss: 1.464 Vali Acc: 0.480 Test Loss: 1.464 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.885047674179077
Epoch: 6, Steps: 18 | Train Loss: 0.324 Vali Loss: 1.697 Vali Acc: 0.530 Test Loss: 1.697 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.849012136459351
Epoch: 7, Steps: 18 | Train Loss: 0.165 Vali Loss: 2.244 Vali Acc: 0.530 Test Loss: 2.244 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.837053298950195
Epoch: 8, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.864 Vali Acc: 0.470 Test Loss: 1.864 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.088678598403931
Epoch: 9, Steps: 18 | Train Loss: 0.126 Vali Loss: 1.400 Vali Acc: 0.510 Test Loss: 1.400 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.028035640716553
Epoch: 10, Steps: 18 | Train Loss: 0.189 Vali Loss: 3.654 Vali Acc: 0.510 Test Loss: 3.654 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.026702165603638
Epoch: 11, Steps: 18 | Train Loss: 0.244 Vali Loss: 2.061 Vali Acc: 0.510 Test Loss: 2.061 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.899409294128418
Epoch: 12, Steps: 18 | Train Loss: 0.083 Vali Loss: 1.831 Vali Acc: 0.520 Test Loss: 1.831 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.900432109832764
Epoch: 13, Steps: 18 | Train Loss: 0.065 Vali Loss: 1.468 Vali Acc: 0.510 Test Loss: 1.468 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 265250
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         300                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.583796262741089
Epoch: 1, Steps: 18 | Train Loss: 0.796 Vali Loss: 0.925 Vali Acc: 0.500 Test Loss: 0.925 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 6.465835332870483
Epoch: 2, Steps: 18 | Train Loss: 0.639 Vali Loss: 1.197 Vali Acc: 0.510 Test Loss: 1.197 Test Acc: 0.510
Validation loss decreased (-0.499991 --> -0.509988).  Saving model ...
Epoch: 3 cost time: 5.448265075683594
Epoch: 3, Steps: 18 | Train Loss: 0.465 Vali Loss: 1.496 Vali Acc: 0.520 Test Loss: 1.496 Test Acc: 0.520
Validation loss decreased (-0.509988 --> -0.519985).  Saving model ...
Epoch: 4 cost time: 5.9078545570373535
Epoch: 4, Steps: 18 | Train Loss: 0.520 Vali Loss: 0.836 Vali Acc: 0.540 Test Loss: 0.836 Test Acc: 0.540
Validation loss decreased (-0.519985 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 6.189101457595825
Epoch: 5, Steps: 18 | Train Loss: 0.319 Vali Loss: 1.211 Vali Acc: 0.510 Test Loss: 1.211 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.074061393737793
Epoch: 6, Steps: 18 | Train Loss: 0.282 Vali Loss: 1.096 Vali Acc: 0.550 Test Loss: 1.096 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 5.863762140274048
Epoch: 7, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.474 Vali Acc: 0.530 Test Loss: 1.474 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.033924579620361
Epoch: 8, Steps: 18 | Train Loss: 0.133 Vali Loss: 1.260 Vali Acc: 0.530 Test Loss: 1.260 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.924514532089233
Epoch: 9, Steps: 18 | Train Loss: 0.145 Vali Loss: 1.944 Vali Acc: 0.490 Test Loss: 1.944 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.900379419326782
Epoch: 10, Steps: 18 | Train Loss: 0.099 Vali Loss: 1.692 Vali Acc: 0.620 Test Loss: 1.692 Test Acc: 0.620
Validation loss decreased (-0.549989 --> -0.619983).  Saving model ...
Epoch: 11 cost time: 5.58251690864563
Epoch: 11, Steps: 18 | Train Loss: 0.145 Vali Loss: 1.741 Vali Acc: 0.490 Test Loss: 1.741 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.654638290405273
Epoch: 12, Steps: 18 | Train Loss: 0.218 Vali Loss: 2.977 Vali Acc: 0.540 Test Loss: 2.977 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.617119073867798
Epoch: 13, Steps: 18 | Train Loss: 0.228 Vali Loss: 2.279 Vali Acc: 0.480 Test Loss: 2.279 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.825411796569824
Epoch: 14, Steps: 18 | Train Loss: 0.133 Vali Loss: 2.272 Vali Acc: 0.550 Test Loss: 2.272 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.827146291732788
Epoch: 15, Steps: 18 | Train Loss: 0.053 Vali Loss: 1.714 Vali Acc: 0.530 Test Loss: 1.714 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.632825613021851
Epoch: 16, Steps: 18 | Train Loss: 0.027 Vali Loss: 2.238 Vali Acc: 0.560 Test Loss: 2.238 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.656139850616455
Epoch: 17, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.914 Vali Acc: 0.560 Test Loss: 1.914 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.760857343673706
Epoch: 18, Steps: 18 | Train Loss: 0.054 Vali Loss: 1.978 Vali Acc: 0.530 Test Loss: 1.978 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.753106117248535
Epoch: 19, Steps: 18 | Train Loss: 0.023 Vali Loss: 2.181 Vali Acc: 0.540 Test Loss: 2.181 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.858930349349976
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.468 Vali Acc: 0.560 Test Loss: 2.468 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 265250
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         150                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.887497425079346
Epoch: 1, Steps: 18 | Train Loss: 0.782 Vali Loss: 0.856 Vali Acc: 0.500 Test Loss: 0.856 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 6.290525913238525
Epoch: 2, Steps: 18 | Train Loss: 0.669 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.114097356796265
Epoch: 3, Steps: 18 | Train Loss: 0.475 Vali Loss: 1.019 Vali Acc: 0.500 Test Loss: 1.019 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.378014087677002
Epoch: 4, Steps: 18 | Train Loss: 0.431 Vali Loss: 0.880 Vali Acc: 0.500 Test Loss: 0.880 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.399272918701172
Epoch: 5, Steps: 18 | Train Loss: 0.357 Vali Loss: 1.130 Vali Acc: 0.470 Test Loss: 1.130 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.495562791824341
Epoch: 6, Steps: 18 | Train Loss: 0.315 Vali Loss: 0.941 Vali Acc: 0.490 Test Loss: 0.941 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.3225367069244385
Epoch: 7, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.948 Vali Acc: 0.520 Test Loss: 1.948 Test Acc: 0.520
Validation loss decreased (-0.499991 --> -0.519981).  Saving model ...
Epoch: 8 cost time: 6.201868295669556
Epoch: 8, Steps: 18 | Train Loss: 0.125 Vali Loss: 1.348 Vali Acc: 0.470 Test Loss: 1.348 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.442727327346802
Epoch: 9, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.180 Vali Acc: 0.530 Test Loss: 1.180 Test Acc: 0.530
Validation loss decreased (-0.519981 --> -0.529988).  Saving model ...
Epoch: 10 cost time: 6.076653003692627
Epoch: 10, Steps: 18 | Train Loss: 0.083 Vali Loss: 1.132 Vali Acc: 0.530 Test Loss: 1.132 Test Acc: 0.530
Validation loss decreased (-0.529988 --> -0.529989).  Saving model ...
Epoch: 11 cost time: 5.881436824798584
Epoch: 11, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.931 Vali Acc: 0.480 Test Loss: 1.931 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.2673234939575195
Epoch: 12, Steps: 18 | Train Loss: 0.261 Vali Loss: 2.540 Vali Acc: 0.540 Test Loss: 2.540 Test Acc: 0.540
Validation loss decreased (-0.529989 --> -0.539975).  Saving model ...
Epoch: 13 cost time: 6.022929668426514
Epoch: 13, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.776 Vali Acc: 0.490 Test Loss: 1.776 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.368869066238403
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 2.141 Vali Acc: 0.500 Test Loss: 2.141 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.957481145858765
Epoch: 15, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.869 Vali Acc: 0.480 Test Loss: 1.869 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.674879550933838
Epoch: 16, Steps: 18 | Train Loss: 0.035 Vali Loss: 2.808 Vali Acc: 0.460 Test Loss: 2.808 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.8059470653533936
Epoch: 17, Steps: 18 | Train Loss: 0.122 Vali Loss: 3.627 Vali Acc: 0.500 Test Loss: 3.627 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.141246318817139
Epoch: 18, Steps: 18 | Train Loss: 0.073 Vali Loss: 3.175 Vali Acc: 0.490 Test Loss: 3.175 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.078082799911499
Epoch: 19, Steps: 18 | Train Loss: 0.052 Vali Loss: 2.590 Vali Acc: 0.470 Test Loss: 2.590 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.791626453399658
Epoch: 20, Steps: 18 | Train Loss: 0.066 Vali Loss: 3.344 Vali Acc: 0.500 Test Loss: 3.344 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.831338405609131
Epoch: 21, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.713 Vali Acc: 0.510 Test Loss: 2.713 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.158463954925537
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.550 Vali Acc: 0.500 Test Loss: 2.550 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 265250
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.97894024848938
Epoch: 1, Steps: 18 | Train Loss: 0.755 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 5.695114374160767
Epoch: 2, Steps: 18 | Train Loss: 0.584 Vali Loss: 1.125 Vali Acc: 0.520 Test Loss: 1.125 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519989).  Saving model ...
Epoch: 3 cost time: 5.486388206481934
Epoch: 3, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.834 Vali Acc: 0.550 Test Loss: 0.834 Test Acc: 0.550
Validation loss decreased (-0.519989 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 5.779410123825073
Epoch: 4, Steps: 18 | Train Loss: 0.373 Vali Loss: 0.898 Vali Acc: 0.530 Test Loss: 0.898 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.7737157344818115
Epoch: 5, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.040 Vali Acc: 0.510 Test Loss: 1.040 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.858736991882324
Epoch: 6, Steps: 18 | Train Loss: 0.175 Vali Loss: 1.265 Vali Acc: 0.550 Test Loss: 1.265 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.950328826904297
Epoch: 7, Steps: 18 | Train Loss: 0.175 Vali Loss: 1.417 Vali Acc: 0.500 Test Loss: 1.417 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.494270324707031
Epoch: 8, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.579 Vali Acc: 0.490 Test Loss: 1.579 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.560544729232788
Epoch: 9, Steps: 18 | Train Loss: 0.154 Vali Loss: 1.710 Vali Acc: 0.500 Test Loss: 1.710 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.282339334487915
Epoch: 10, Steps: 18 | Train Loss: 0.053 Vali Loss: 1.809 Vali Acc: 0.510 Test Loss: 1.809 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.491549730300903
Epoch: 11, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.217 Vali Acc: 0.570 Test Loss: 2.217 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569978).  Saving model ...
Epoch: 12 cost time: 5.275940895080566
Epoch: 12, Steps: 18 | Train Loss: 0.027 Vali Loss: 2.359 Vali Acc: 0.500 Test Loss: 2.359 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.454671621322632
Epoch: 13, Steps: 18 | Train Loss: 0.026 Vali Loss: 2.191 Vali Acc: 0.540 Test Loss: 2.191 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.8615076541900635
Epoch: 14, Steps: 18 | Train Loss: 0.058 Vali Loss: 2.964 Vali Acc: 0.550 Test Loss: 2.964 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.715065956115723
Epoch: 15, Steps: 18 | Train Loss: 0.071 Vali Loss: 3.072 Vali Acc: 0.500 Test Loss: 3.072 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.414727687835693
Epoch: 16, Steps: 18 | Train Loss: 0.024 Vali Loss: 3.393 Vali Acc: 0.520 Test Loss: 3.393 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.842700958251953
Epoch: 17, Steps: 18 | Train Loss: 0.077 Vali Loss: 3.002 Vali Acc: 0.500 Test Loss: 3.002 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.737468004226685
Epoch: 18, Steps: 18 | Train Loss: 0.061 Vali Loss: 3.555 Vali Acc: 0.550 Test Loss: 3.555 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.708214282989502
Epoch: 19, Steps: 18 | Train Loss: 0.015 Vali Loss: 3.741 Vali Acc: 0.470 Test Loss: 3.741 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.48887825012207
Epoch: 20, Steps: 18 | Train Loss: 0.044 Vali Loss: 3.875 Vali Acc: 0.470 Test Loss: 3.875 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.4114837646484375
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 3.402 Vali Acc: 0.540 Test Loss: 3.402 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 265250
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.639349460601807
Epoch: 1, Steps: 18 | Train Loss: 0.778 Vali Loss: 0.805 Vali Acc: 0.510 Test Loss: 0.805 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 5.7982072830200195
Epoch: 2, Steps: 18 | Train Loss: 0.669 Vali Loss: 1.569 Vali Acc: 0.510 Test Loss: 1.569 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.270318269729614
Epoch: 3, Steps: 18 | Train Loss: 0.559 Vali Loss: 0.858 Vali Acc: 0.500 Test Loss: 0.858 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.308456659317017
Epoch: 4, Steps: 18 | Train Loss: 0.431 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.31139063835144
Epoch: 5, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.000 Vali Acc: 0.510 Test Loss: 1.000 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.544993877410889
Epoch: 6, Steps: 18 | Train Loss: 0.221 Vali Loss: 1.317 Vali Acc: 0.540 Test Loss: 1.317 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539987).  Saving model ...
Epoch: 7 cost time: 6.211000204086304
Epoch: 7, Steps: 18 | Train Loss: 0.250 Vali Loss: 1.643 Vali Acc: 0.510 Test Loss: 1.643 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.596647024154663
Epoch: 8, Steps: 18 | Train Loss: 0.107 Vali Loss: 2.047 Vali Acc: 0.470 Test Loss: 2.047 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.892604827880859
Epoch: 9, Steps: 18 | Train Loss: 0.290 Vali Loss: 2.162 Vali Acc: 0.510 Test Loss: 2.162 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.51747989654541
Epoch: 10, Steps: 18 | Train Loss: 0.227 Vali Loss: 2.403 Vali Acc: 0.510 Test Loss: 2.403 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.908881664276123
Epoch: 11, Steps: 18 | Train Loss: 0.139 Vali Loss: 2.203 Vali Acc: 0.480 Test Loss: 2.203 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.704425573348999
Epoch: 12, Steps: 18 | Train Loss: 0.075 Vali Loss: 1.929 Vali Acc: 0.480 Test Loss: 1.929 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.797991752624512
Epoch: 13, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.745 Vali Acc: 0.520 Test Loss: 1.745 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.429429531097412
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 3.025 Vali Acc: 0.510 Test Loss: 3.025 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.912541389465332
Epoch: 15, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.934 Vali Acc: 0.550 Test Loss: 1.934 Test Acc: 0.550
Validation loss decreased (-0.539987 --> -0.549981).  Saving model ...
Epoch: 16 cost time: 5.550292491912842
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.296 Vali Acc: 0.480 Test Loss: 2.296 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.267196178436279
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 2.624 Vali Acc: 0.470 Test Loss: 2.624 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.664278268814087
Epoch: 18, Steps: 18 | Train Loss: 0.034 Vali Loss: 2.947 Vali Acc: 0.530 Test Loss: 2.947 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.421128749847412
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 3.275 Vali Acc: 0.530 Test Loss: 3.275 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.304608106613159
Epoch: 20, Steps: 18 | Train Loss: 0.018 Vali Loss: 2.188 Vali Acc: 0.530 Test Loss: 2.188 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.6318464279174805
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 2.771 Vali Acc: 0.500 Test Loss: 2.771 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.714594841003418
Epoch: 22, Steps: 18 | Train Loss: 0.014 Vali Loss: 3.554 Vali Acc: 0.540 Test Loss: 3.554 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.609681129455566
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 3.838 Vali Acc: 0.530 Test Loss: 3.838 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.622742176055908
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 3.049 Vali Acc: 0.540 Test Loss: 3.049 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.58266806602478
Epoch: 25, Steps: 18 | Train Loss: 0.012 Vali Loss: 3.683 Vali Acc: 0.500 Test Loss: 3.683 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 265250
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.775172710418701
Epoch: 1, Steps: 18 | Train Loss: 0.801 Vali Loss: 0.753 Vali Acc: 0.560 Test Loss: 0.753 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 5.933882713317871
Epoch: 2, Steps: 18 | Train Loss: 0.717 Vali Loss: 1.154 Vali Acc: 0.490 Test Loss: 1.154 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.633842706680298
Epoch: 3, Steps: 18 | Train Loss: 0.632 Vali Loss: 1.510 Vali Acc: 0.440 Test Loss: 1.510 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.750308036804199
Epoch: 4, Steps: 18 | Train Loss: 0.659 Vali Loss: 1.550 Vali Acc: 0.450 Test Loss: 1.550 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.0224597454071045
Epoch: 5, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.952 Vali Acc: 0.420 Test Loss: 0.952 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.8387770652771
Epoch: 6, Steps: 18 | Train Loss: 0.298 Vali Loss: 1.391 Vali Acc: 0.500 Test Loss: 1.391 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.788273096084595
Epoch: 7, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.770 Vali Acc: 0.470 Test Loss: 0.770 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.735229253768921
Epoch: 8, Steps: 18 | Train Loss: 0.247 Vali Loss: 1.664 Vali Acc: 0.450 Test Loss: 1.664 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.687680721282959
Epoch: 9, Steps: 18 | Train Loss: 0.282 Vali Loss: 1.564 Vali Acc: 0.530 Test Loss: 1.564 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.365288257598877
Epoch: 10, Steps: 18 | Train Loss: 0.154 Vali Loss: 1.696 Vali Acc: 0.430 Test Loss: 1.696 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.315726280212402
Epoch: 11, Steps: 18 | Train Loss: 0.175 Vali Loss: 1.592 Vali Acc: 0.430 Test Loss: 1.592 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 265250
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
fourier enhanced block used!
modes=32, index=[124, 181, 193, 250, 256, 271, 280, 319, 332, 333, 375, 380, 422, 506, 522, 529, 623, 741, 920, 951, 1033, 1050, 1053, 1076, 1117, 1148, 1180, 1228, 1278, 1330, 1341, 1451]
fourier enhanced block used!
modes=32, index=[22, 49, 56, 119, 124, 129, 197, 205, 209, 233, 249, 264, 360, 362, 386, 398, 405, 416, 432, 440, 442, 445, 451, 472, 507, 513, 594, 617, 619, 650, 653, 714]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 18, 19, 47, 63, 109, 111, 122, 130, 153, 158, 219, 235, 243, 313, 347, 375, 392, 395, 412, 445, 523, 529, 536, 541, 586, 592, 613, 621, 627, 632, 715]
modes_kv=32, index_kv=[0, 82, 98, 100, 124, 161, 169, 287, 302, 324, 330, 438, 484, 588, 660, 700, 704, 737, 744, 745, 817, 829, 875, 885, 931, 945, 1009, 1240, 1269, 1272, 1274, 1339]
>>>>>>>start training : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.379303932189941
Epoch: 1, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.880 Vali Acc: 0.500 Test Loss: 0.880 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 5.741730213165283
Epoch: 2, Steps: 18 | Train Loss: 0.719 Vali Loss: 1.478 Vali Acc: 0.500 Test Loss: 1.478 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.567840337753296
Epoch: 3, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.820 Vali Acc: 0.500 Test Loss: 0.820 Test Acc: 0.500
Validation loss decreased (-0.499991 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 5.658846616744995
Epoch: 4, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 5.931907415390015
Epoch: 5, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.892 Vali Acc: 0.500 Test Loss: 0.892 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.032052755355835
Epoch: 6, Steps: 18 | Train Loss: 0.383 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.25331974029541
Epoch: 7, Steps: 18 | Train Loss: 0.347 Vali Loss: 0.932 Vali Acc: 0.510 Test Loss: 0.932 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.243069410324097
Epoch: 8, Steps: 18 | Train Loss: 0.236 Vali Loss: 1.016 Vali Acc: 0.530 Test Loss: 1.016 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.938874959945679
Epoch: 9, Steps: 18 | Train Loss: 0.268 Vali Loss: 0.844 Vali Acc: 0.530 Test Loss: 0.844 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.8711676597595215
Epoch: 10, Steps: 18 | Train Loss: 0.167 Vali Loss: 0.815 Vali Acc: 0.570 Test Loss: 0.815 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 11 cost time: 6.084207773208618
Epoch: 11, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.473 Vali Acc: 0.520 Test Loss: 1.473 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.167915105819702
Epoch: 12, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.088 Vali Acc: 0.530 Test Loss: 1.088 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.8405601978302
Epoch: 13, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.320 Vali Acc: 0.510 Test Loss: 1.320 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.18265438079834
Epoch: 14, Steps: 18 | Train Loss: 0.081 Vali Loss: 1.105 Vali Acc: 0.550 Test Loss: 1.105 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.106367111206055
Epoch: 15, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.170 Vali Acc: 0.520 Test Loss: 1.170 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.571713209152222
Epoch: 16, Steps: 18 | Train Loss: 0.073 Vali Loss: 2.232 Vali Acc: 0.500 Test Loss: 2.232 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.522872686386108
Epoch: 17, Steps: 18 | Train Loss: 0.049 Vali Loss: 2.357 Vali Acc: 0.520 Test Loss: 2.357 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.627236366271973
Epoch: 18, Steps: 18 | Train Loss: 0.101 Vali Loss: 1.545 Vali Acc: 0.510 Test Loss: 1.545 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.924592018127441
Epoch: 19, Steps: 18 | Train Loss: 0.133 Vali Loss: 1.728 Vali Acc: 0.510 Test Loss: 1.728 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.511616468429565
Epoch: 20, Steps: 18 | Train Loss: 0.169 Vali Loss: 1.685 Vali Acc: 0.470 Test Loss: 1.685 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_FEDformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 265250
model size : 2.26MB
